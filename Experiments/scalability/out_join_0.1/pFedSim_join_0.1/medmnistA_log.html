==================== ALGORITHM: pFedSim_join_0.1 ====================          
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.1874 -> 1.3061   acc: 0.00% -> 48.73%              
client [81] (test)  loss: 3.4375 -> 0.5560   acc: 0.00% -> 87.96%              
client [21] (test)  loss: 2.3655 -> 0.5592   acc: 0.31% -> 78.05%              
client [68] (test)  loss: 3.5427 -> 0.6140   acc: 0.00% -> 87.13%              
client [93] (test)  loss: 2.7016 -> 0.3929   acc: 0.00% -> 91.57%              
client [31] (test)  loss: 2.1159 -> 0.5745   acc: 0.00% -> 84.42%              
client [20] (test)  loss: 0.9053 -> 0.3738   acc: 73.19% -> 90.58%             
client [59] (test)  loss: 2.0910 -> 0.2772   acc: 17.95% -> 88.14%             
client [48] (test)  loss: 2.5977 -> 0.2676   acc: 0.00% -> 94.88%              
client [34] (test)  loss: 1.4284 -> 0.4238   acc: 56.22% -> 89.27%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.0541 -> 0.0235   acc: 32.93% -> 99.40%             
client [99] (test)  loss: 2.5865 -> 0.6747   acc: 31.48% -> 76.85%             
client [67] (test)  loss: 2.0066 -> 1.4280   acc: 20.69% -> 72.41%             
client [0] (test)  loss: 4.2969 -> 0.0629   acc: 0.84% -> 97.91%               
client [76] (test)  loss: 2.1599 -> 0.4007   acc: 11.32% -> 88.05%             
client [41] (test)  loss: 3.0754 -> 0.2215   acc: 0.00% -> 98.31%              
client [62] (test)  loss: 2.6347 -> 0.5470   acc: 0.00% -> 72.67%              
client [2] (test)  loss: 2.6427 -> 0.1567   acc: 4.68% -> 94.30%               
client [14] (test)  loss: 1.3962 -> 0.3077   acc: 48.80% -> 92.80%             
client [46] (test)  loss: 3.1173 -> 0.1822   acc: 18.69% -> 95.33%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.8662 -> 0.1006   acc: 20.00% -> 97.33%             
client [68] (test)  loss: 1.5553 -> 0.1865   acc: 35.64% -> 93.40%             
client [57] (test)  loss: 2.0898 -> 0.2470   acc: 20.21% -> 93.62%             
client [17] (test)  loss: 3.0391 -> 0.1526   acc: 5.01% -> 95.58%              
client [54] (test)  loss: 2.8916 -> 0.0110   acc: 4.99% -> 99.79%              
client [23] (test)  loss: 2.6004 -> 0.6897   acc: 19.51% -> 74.39%             
client [35] (test)  loss: 1.4915 -> 0.4949   acc: 41.07% -> 82.14%             
client [59] (test)  loss: 2.7577 -> 0.1487   acc: 14.42% -> 94.87%             
client [31] (test)  loss: 2.8192 -> 0.4302   acc: 6.49% -> 87.01%              
client [9] (test)  loss: 0.9055 -> 0.0159   acc: 72.46% -> 99.51%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5421 -> 0.1007   acc: 7.46% -> 97.14%              
client [33] (test)  loss: 1.4099 -> 0.4861   acc: 57.69% -> 81.25%             
client [16] (test)  loss: 3.0446 -> 1.1796   acc: 5.88% -> 68.63%              
client [44] (test)  loss: 0.5393 -> 0.0337   acc: 82.42% -> 98.94%             
client [8] (test)  loss: 0.6696 -> 0.3535   acc: 79.19% -> 88.59%              
client [31] (test)  loss: 2.2220 -> 0.3970   acc: 29.87% -> 89.61%             
client [47] (test)  loss: 2.3308 -> 0.4801   acc: 36.84% -> 85.38%             
client [36] (test)  loss: 1.7109 -> 0.1156   acc: 33.11% -> 98.68%             
client [20] (test)  loss: 0.5319 -> 0.1708   acc: 74.64% -> 93.48%             
client [56] (test)  loss: 1.2136 -> 0.5658   acc: 60.47% -> 86.05%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.4076 -> 0.0360   acc: 16.67% -> 99.12%              
client [60] (test)  loss: 4.1201 -> 0.0723   acc: 19.35% -> 98.30%             
client [28] (test)  loss: 5.7400 -> 0.2247   acc: 5.94% -> 93.61%              
client [25] (test)  loss: 1.3279 -> 0.0727   acc: 56.10% -> 98.78%             
client [58] (test)  loss: 0.6093 -> 0.2295   acc: 74.79% -> 94.12%             
client [44] (test)  loss: 1.3968 -> 0.0256   acc: 50.74% -> 99.15%             
client [39] (test)  loss: 1.3689 -> 0.5162   acc: 47.92% -> 77.08%             
client [29] (test)  loss: 3.7281 -> 0.3346   acc: 13.55% -> 87.19%             
client [3] (test)  loss: 1.1103 -> 0.0841   acc: 61.22% -> 96.94%              
client [84] (test)  loss: 6.3515 -> 0.0154   acc: 0.00% -> 100.00%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.7173 -> 0.2775   acc: 37.09% -> 91.65%             
client [84] (test)  loss: 2.5012 -> 0.0232   acc: 24.66% -> 100.00%            
client [10] (test)  loss: 5.5259 -> 0.1084   acc: 5.19% -> 97.40%              
client [36] (test)  loss: 3.2075 -> 0.0886   acc: 27.15% -> 98.01%             
client [65] (test)  loss: 0.2316 -> 0.1780   acc: 93.55% -> 94.53%             
client [81] (test)  loss: 0.5506 -> 0.2514   acc: 77.78% -> 93.52%             
client [79] (test)  loss: 3.3539 -> 0.4199   acc: 18.29% -> 84.76%             
client [42] (test)  loss: 1.9194 -> 0.1928   acc: 38.22% -> 94.98%             
client [11] (test)  loss: 1.5868 -> 0.1849   acc: 52.84% -> 93.43%             
client [96] (test)  loss: 2.7287 -> 0.1767   acc: 34.11% -> 92.64%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.5702 -> 0.2660   acc: 52.35% -> 91.28%              
client [53] (test)  loss: 0.7767 -> 0.0053   acc: 69.42% -> 99.85%             
client [52] (test)  loss: 3.1729 -> 0.1261   acc: 16.30% -> 96.20%             
client [42] (test)  loss: 2.0045 -> 0.1963   acc: 42.86% -> 96.53%             
client [69] (test)  loss: 1.4269 -> 0.0043   acc: 51.00% -> 100.00%            
client [59] (test)  loss: 1.8291 -> 0.1123   acc: 40.71% -> 96.47%             
client [7] (test)  loss: 3.0293 -> 0.0137   acc: 22.78% -> 99.68%              
client [26] (test)  loss: 2.1285 -> 0.0881   acc: 44.44% -> 97.62%             
client [49] (test)  loss: 1.1318 -> 0.0677   acc: 56.25% -> 98.30%             
client [98] (test)  loss: 1.8308 -> 0.1337   acc: 41.37% -> 94.86%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2070 -> 0.1303   acc: 62.48% -> 95.44%             
client [47] (test)  loss: 2.4525 -> 0.3549   acc: 35.67% -> 90.64%             
client [21] (test)  loss: 1.1966 -> 0.2729   acc: 60.59% -> 91.65%             
client [77] (test)  loss: 2.0908 -> 0.8493   acc: 34.18% -> 67.09%             
client [95] (test)  loss: 1.3794 -> 0.0540   acc: 45.31% -> 98.36%             
client [91] (test)  loss: 1.1853 -> 0.0313   acc: 56.37% -> 99.68%             
client [14] (test)  loss: 0.2940 -> 0.1840   acc: 92.80% -> 92.80%             
client [99] (test)  loss: 1.1856 -> 0.4880   acc: 60.19% -> 80.56%             
client [20] (test)  loss: 0.9878 -> 0.1022   acc: 62.32% -> 95.65%             
client [39] (test)  loss: 0.8264 -> 0.2448   acc: 72.92% -> 89.58%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.1974 -> 0.1037   acc: 9.51% -> 96.47%              
client [62] (test)  loss: 2.1319 -> 0.2762   acc: 34.67% -> 89.67%             
client [71] (test)  loss: 1.5755 -> 0.0886   acc: 55.46% -> 96.64%             
client [97] (test)  loss: 5.4510 -> 0.6292   acc: 12.14% -> 77.14%             
client [30] (test)  loss: 1.0041 -> 0.3402   acc: 57.95% -> 92.05%             
client [88] (test)  loss: 1.1941 -> 0.1182   acc: 63.28% -> 95.48%             
client [60] (test)  loss: 0.4162 -> 0.0586   acc: 87.46% -> 98.45%             
client [82] (test)  loss: 2.6073 -> 0.3585   acc: 31.39% -> 86.13%             
client [91] (test)  loss: 1.0380 -> 0.0304   acc: 65.29% -> 99.68%             
client [57] (test)  loss: 1.2158 -> 0.2008   acc: 62.77% -> 95.74%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.0897 -> 0.3112   acc: 36.36% -> 92.21%             
client [15] (test)  loss: 3.6907 -> 0.1510   acc: 25.41% -> 96.04%             
client [71] (test)  loss: 0.3351 -> 0.0809   acc: 89.08% -> 97.76%             
client [97] (test)  loss: 7.8440 -> 0.6404   acc: 7.86% -> 77.14%              
client [53] (test)  loss: 1.9590 -> 0.0059   acc: 21.25% -> 99.69%             
client [77] (test)  loss: 5.1485 -> 0.7390   acc: 9.49% -> 72.15%              
client [76] (test)  loss: 0.8388 -> 0.1090   acc: 69.18% -> 95.60%             
client [79] (test)  loss: 2.1408 -> 0.3463   acc: 40.85% -> 87.80%             
client [28] (test)  loss: 4.6951 -> 0.1530   acc: 9.36% -> 95.21%              
client [99] (test)  loss: 2.1726 -> 0.4486   acc: 32.41% -> 82.41%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 1.6588 -> 0.6159   acc: 50.71% -> 79.29%             
client [86] (test)  loss: 0.7318 -> 0.5186   acc: 77.69% -> 85.12%             
client [34] (test)  loss: 0.3490 -> 0.1626   acc: 87.98% -> 95.71%             
client [73] (test)  loss: 0.8582 -> 0.0361   acc: 73.45% -> 98.67%             
client [5] (test)  loss: 0.5525 -> 0.4435   acc: 83.42% -> 84.92%              
client [96] (test)  loss: 1.9726 -> 0.1648   acc: 46.49% -> 94.65%             
client [22] (test)  loss: 0.2510 -> 0.0969   acc: 92.75% -> 96.38%             
client [60] (test)  loss: 0.2401 -> 0.0532   acc: 92.72% -> 98.45%             
client [66] (test)  loss: 0.1006 -> 0.0013   acc: 96.80% -> 100.00%            
client [83] (test)  loss: 1.7806 -> 0.0004   acc: 26.51% -> 100.00%            
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.1383 -> 0.0725   acc: 95.60% -> 98.11%             
client [65] (test)  loss: 0.2637 -> 0.1502   acc: 90.23% -> 94.14%             
client [95] (test)  loss: 0.3614 -> 0.0390   acc: 86.85% -> 99.30%             
client [17] (test)  loss: 0.8465 -> 0.0840   acc: 73.45% -> 97.64%             
client [8] (test)  loss: 1.3540 -> 0.2326   acc: 61.07% -> 91.95%              
client [35] (test)  loss: 0.4118 -> 0.2663   acc: 87.50% -> 89.29%             
client [98] (test)  loss: 0.2102 -> 0.1263   acc: 92.58% -> 95.29%             
client [53] (test)  loss: 0.0281 -> 0.0043   acc: 99.85% -> 99.85%             
client [43] (test)  loss: 0.9674 -> 0.4235   acc: 70.74% -> 85.15%             
client [64] (test)  loss: 0.1846 -> 0.0858   acc: 94.60% -> 97.46%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.4154 -> 0.2677   acc: 87.02% -> 91.65%             
client [88] (test)  loss: 0.1469 -> 0.0925   acc: 96.05% -> 96.61%             
client [38] (test)  loss: 0.1927 -> 0.1250   acc: 94.55% -> 95.54%             
client [3] (test)  loss: 0.2101 -> 0.0487   acc: 92.86% -> 98.98%              
client [5] (test)  loss: 0.4148 -> 0.4377   acc: 86.43% -> 84.92%              
client [41] (test)  loss: 0.0175 -> 0.0049   acc: 100.00% -> 100.00%           
client [7] (test)  loss: 0.0501 -> 0.0115   acc: 98.73% -> 99.53%              
client [37] (test)  loss: 0.2130 -> 0.1402   acc: 95.20% -> 97.18%             
client [45] (test)  loss: 2.5163 -> 0.1608   acc: 29.79% -> 95.14%             
client [47] (test)  loss: 0.6660 -> 0.2920   acc: 74.27% -> 90.64%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.4631 -> 0.7717   acc: 80.39% -> 74.51%             
client [11] (test)  loss: 0.1975 -> 0.1408   acc: 92.24% -> 94.93%             
client [37] (test)  loss: 0.2917 -> 0.1441   acc: 93.37% -> 97.32%             
client [41] (test)  loss: 0.0113 -> 0.0045   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.1743 -> 0.0368   acc: 92.72% -> 99.06%             
client [53] (test)  loss: 0.0172 -> 0.0050   acc: 99.85% -> 99.85%             
client [22] (test)  loss: 0.2297 -> 0.0990   acc: 92.75% -> 96.38%             
client [25] (test)  loss: 0.1840 -> 0.0444   acc: 93.09% -> 98.78%             
client [69] (test)  loss: 0.0482 -> 0.0029   acc: 98.19% -> 100.00%            
client [46] (test)  loss: 0.1959 -> 0.1287   acc: 93.86% -> 96.26%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2924 -> 0.2897   acc: 91.23% -> 91.23%             
client [69] (test)  loss: 0.0397 -> 0.0028   acc: 98.19% -> 100.00%            
client [82] (test)  loss: 0.4042 -> 0.3177   acc: 89.78% -> 87.59%             
client [45] (test)  loss: 0.3026 -> 0.1627   acc: 89.67% -> 94.83%             
client [7] (test)  loss: 0.0640 -> 0.0115   acc: 98.10% -> 99.53%              
client [50] (test)  loss: 0.4069 -> 0.4485   acc: 84.31% -> 86.27%             
client [35] (test)  loss: 0.3208 -> 0.2626   acc: 91.07% -> 87.50%             
client [24] (test)  loss: 0.1396 -> 0.0404   acc: 96.00% -> 98.67%             
client [15] (test)  loss: 0.2379 -> 0.1369   acc: 91.42% -> 95.71%             
client [58] (test)  loss: 0.3256 -> 0.1424   acc: 87.39% -> 94.12%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.1193 -> 0.0470   acc: 95.90% -> 98.29%             
client [76] (test)  loss: 0.1057 -> 0.0674   acc: 96.23% -> 98.11%             
client [67] (test)  loss: 0.1055 -> 0.0703   acc: 96.55% -> 100.00%            
client [37] (test)  loss: 0.3305 -> 0.1462   acc: 92.81% -> 97.18%             
client [58] (test)  loss: 0.3217 -> 0.1433   acc: 87.39% -> 94.12%             
client [64] (test)  loss: 0.0843 -> 0.0845   acc: 97.78% -> 97.46%             
client [77] (test)  loss: 0.8375 -> 0.7283   acc: 70.25% -> 73.42%             
client [55] (test)  loss: 0.0506 -> 0.0444   acc: 99.04% -> 99.24%             
client [12] (test)  loss: 0.3768 -> 0.3172   acc: 87.06% -> 87.06%             
client [89] (test)  loss: 0.1171 -> 0.0802   acc: 96.71% -> 97.87%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.0150 -> 0.0078   acc: 100.00% -> 100.00%           
client [51] (test)  loss: 0.2700 -> 0.1263   acc: 90.76% -> 95.86%             
client [8] (test)  loss: 0.2481 -> 0.2543   acc: 91.28% -> 91.28%              
client [18] (test)  loss: 0.4337 -> 0.2441   acc: 84.51% -> 92.02%             
client [94] (test)  loss: 0.3770 -> 0.2646   acc: 85.37% -> 90.24%             
client [81] (test)  loss: 0.2802 -> 0.2033   acc: 87.96% -> 94.44%             
client [3] (test)  loss: 0.0734 -> 0.0308   acc: 97.96% -> 98.98%              
client [11] (test)  loss: 0.1779 -> 0.1379   acc: 91.94% -> 94.93%             
client [95] (test)  loss: 0.1064 -> 0.0365   acc: 96.24% -> 98.83%             
client [67] (test)  loss: 0.0946 -> 0.0631   acc: 96.55% -> 100.00%            
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.2440 -> 0.2691   acc: 93.04% -> 91.50%             
client [79] (test)  loss: 0.3926 -> 0.3662   acc: 84.15% -> 86.59%             
client [58] (test)  loss: 0.3085 -> 0.1460   acc: 89.08% -> 94.96%             
client [88] (test)  loss: 0.0869 -> 0.0831   acc: 96.61% -> 96.61%             
client [46] (test)  loss: 0.1388 -> 0.1280   acc: 95.46% -> 96.40%             
client [11] (test)  loss: 0.1759 -> 0.1366   acc: 92.24% -> 95.22%             
client [55] (test)  loss: 0.0465 -> 0.0450   acc: 99.24% -> 99.24%             
client [13] (test)  loss: 0.3184 -> 0.1513   acc: 85.19% -> 95.56%             
client [31] (test)  loss: 0.2868 -> 0.3108   acc: 89.61% -> 93.51%             
client [75] (test)  loss: 0.2281 -> 0.1537   acc: 86.79% -> 90.57%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.2039 -> 0.0988   acc: 93.36% -> 96.15%             
client [7] (test)  loss: 0.0394 -> 0.0106   acc: 98.73% -> 99.53%              
client [57] (test)  loss: 0.1801 -> 0.1447   acc: 94.68% -> 96.81%             
client [13] (test)  loss: 0.3032 -> 0.1496   acc: 85.93% -> 95.56%             
client [43] (test)  loss: 0.5186 -> 0.3957   acc: 79.91% -> 84.72%             
client [91] (test)  loss: 0.1741 -> 0.0258   acc: 94.27% -> 99.68%             
client [10] (test)  loss: 0.0764 -> 0.0885   acc: 97.40% -> 96.10%             
client [64] (test)  loss: 0.0845 -> 0.0841   acc: 97.62% -> 97.46%             
client [82] (test)  loss: 0.3829 -> 0.3189   acc: 90.51% -> 87.59%             
client [22] (test)  loss: 0.1616 -> 0.0959   acc: 94.20% -> 96.38%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.0944 -> 0.0767   acc: 96.38% -> 97.10%             
client [23] (test)  loss: 0.5780 -> 0.1998   acc: 78.66% -> 94.51%             
client [88] (test)  loss: 0.0858 -> 0.0802   acc: 97.18% -> 96.61%             
client [98] (test)  loss: 0.1352 -> 0.1274   acc: 95.58% -> 95.44%             
client [79] (test)  loss: 0.4174 -> 0.3735   acc: 82.32% -> 86.59%             
client [21] (test)  loss: 0.2303 -> 0.2727   acc: 92.89% -> 91.34%             
client [92] (test)  loss: 0.4439 -> 0.8206   acc: 80.95% -> 80.95%             
client [56] (test)  loss: 0.2792 -> 0.2932   acc: 90.70% -> 88.37%             
client [5] (test)  loss: 0.3870 -> 0.4157   acc: 86.43% -> 85.43%              
client [52] (test)  loss: 0.0880 -> 0.0847   acc: 97.28% -> 96.74%             
==================== pFedSim_join_0.1 TEST RESULTS: ====================       
{                                                                              
    100: {'loss': '2.0370 -> 0.0000', 'accuracy': '49.13% -> 0.00%'},          
    200: {'loss': '0.1188 -> 0.0000', 'accuracy': '96.19% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_join_0.1 achieved 10.0%(12.33%) at epoch: 2                            
pFedSim_join_0.1 achieved 20.0%(20.86%) at epoch: 4                            
pFedSim_join_0.1 achieved 40.0%(45.95%) at epoch: 11                           
pFedSim_join_0.1 achieved 50.0%(50.64%) at epoch: 25                           
pFedSim_join_0.1 achieved 60.0%(68.29%) at epoch: 44                           
pFedSim_join_0.1 achieved 70.0%(74.17%) at epoch: 86                           
pFedSim_join_0.1 achieved 80.0%(86.90%) at epoch: 104                          
pFedSim_join_0.1 achieved 90.0%(91.91%) at epoch: 120                          
Convergence (test_after):                                                      
pFedSim_join_0.1 achieved 70.0%(76.17%) at epoch: 0                            
pFedSim_join_0.1 achieved 80.0%(81.14%) at epoch: 1                            
pFedSim_join_0.1 achieved 90.0%(92.05%) at epoch: 2                            
