==================== ALGORITHM: FedRep_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9991 -> 0.8185   acc: 75.65% -> 75.65%             
client [81] (test)  loss: 2.1470 -> 1.9853   acc: 47.83% -> 47.83%             
client [21] (test)  loss: 2.5405 -> 2.4159   acc: 0.00% -> 0.00%               
client [68] (test)  loss: 0.4991 -> 0.3777   acc: 89.80% -> 89.80%             
client [93] (test)  loss: 1.9318 -> 1.2075   acc: 81.32% -> 81.32%             
client [31] (test)  loss: 2.0111 -> 0.8168   acc: 86.67% -> 86.67%             
client [20] (test)  loss: 0.9853 -> 0.8193   acc: 68.70% -> 68.70%             
client [59] (test)  loss: 2.3382 -> 0.5030   acc: 1.64% -> 93.44%              
client [48] (test)  loss: 0.8900 -> 0.7747   acc: 57.26% -> 70.09%             
client [34] (test)  loss: 1.8223 -> 1.4250   acc: 46.34% -> 50.41%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.9851 -> 0.3642   acc: 84.65% -> 84.65%             
client [99] (test)  loss: 0.3750 -> 0.2698   acc: 95.31% -> 95.31%             
client [67] (test)  loss: 1.0798 -> 0.3226   acc: 97.80% -> 97.80%             
client [0] (test)  loss: 1.7958 -> 1.5397   acc: 33.90% -> 33.90%              
client [76] (test)  loss: 1.6623 -> 1.4579   acc: 36.11% -> 52.78%             
client [41] (test)  loss: 0.7828 -> 0.6604   acc: 85.44% -> 85.44%             
client [62] (test)  loss: 2.5029 -> 0.2849   acc: 0.00% -> 100.00%             
client [2] (test)  loss: 2.3429 -> 1.0009   acc: 6.16% -> 78.08%               
client [14] (test)  loss: 1.1584 -> 1.1153   acc: 60.56% -> 60.56%             
client [46] (test)  loss: 1.2471 -> 1.1859   acc: 50.63% -> 49.37%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6720 -> 0.5911   acc: 75.81% -> 83.87%             
client [68] (test)  loss: 0.3093 -> 0.2978   acc: 89.80% -> 89.80%             
client [57] (test)  loss: 1.0213 -> 0.8880   acc: 72.03% -> 72.03%             
client [17] (test)  loss: 1.2408 -> 1.1243   acc: 58.51% -> 65.96%             
client [54] (test)  loss: 1.3072 -> 1.2574   acc: 53.04% -> 56.52%             
client [23] (test)  loss: 2.3196 -> 1.8672   acc: 12.96% -> 61.11%             
client [35] (test)  loss: 1.6476 -> 1.3897   acc: 53.57% -> 53.57%             
client [59] (test)  loss: 0.2186 -> 0.1550   acc: 93.44% -> 93.44%             
client [31] (test)  loss: 0.6166 -> 0.6049   acc: 86.67% -> 86.67%             
client [9] (test)  loss: 1.0041 -> 0.8280   acc: 54.76% -> 73.81%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7170 -> 0.6100   acc: 87.72% -> 91.23%             
client [33] (test)  loss: 1.0506 -> 0.9993   acc: 74.58% -> 77.97%             
client [16] (test)  loss: 0.9483 -> 0.9282   acc: 72.97% -> 72.97%             
client [44] (test)  loss: 0.9203 -> 0.5419   acc: 79.23% -> 79.23%             
client [8] (test)  loss: 0.9952 -> 0.9528   acc: 46.58% -> 43.84%              
client [31] (test)  loss: 0.5873 -> 0.5820   acc: 86.67% -> 86.67%             
client [47] (test)  loss: 0.4988 -> 0.4848   acc: 77.33% -> 77.33%             
client [36] (test)  loss: 0.9340 -> 0.7857   acc: 72.00% -> 72.00%             
client [20] (test)  loss: 0.6147 -> 0.5823   acc: 84.35% -> 84.35%             
client [56] (test)  loss: 0.9119 -> 0.6721   acc: 72.09% -> 76.74%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1089 -> 0.8599   acc: 73.08% -> 73.08%              
client [60] (test)  loss: 1.1681 -> 0.9642   acc: 57.78% -> 64.44%             
client [28] (test)  loss: 1.3549 -> 1.2324   acc: 52.00% -> 64.00%             
client [25] (test)  loss: 1.2644 -> 1.1980   acc: 65.52% -> 65.52%             
client [58] (test)  loss: 0.3333 -> 0.3177   acc: 96.30% -> 96.30%             
client [44] (test)  loss: 0.5563 -> 0.5070   acc: 79.23% -> 79.23%             
client [39] (test)  loss: 1.2367 -> 1.1678   acc: 43.20% -> 46.40%             
client [29] (test)  loss: 1.0817 -> 1.0211   acc: 57.14% -> 57.14%             
client [3] (test)  loss: 0.3438 -> 0.2911   acc: 94.31% -> 94.31%              
client [84] (test)  loss: 1.4284 -> 1.3879   acc: 70.73% -> 68.29%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.8608 -> 1.6449   acc: 41.38% -> 41.38%             
client [84] (test)  loss: 1.3868 -> 1.3257   acc: 73.17% -> 70.73%             
client [10] (test)  loss: 0.9888 -> 0.9112   acc: 63.16% -> 69.47%             
client [36] (test)  loss: 0.6990 -> 0.6274   acc: 72.00% -> 72.00%             
client [65] (test)  loss: 0.4320 -> 0.3967   acc: 84.17% -> 84.17%             
client [81] (test)  loss: 1.4824 -> 1.4397   acc: 47.83% -> 39.13%             
client [79] (test)  loss: 0.3742 -> 0.2995   acc: 86.24% -> 92.62%             
client [42] (test)  loss: 0.6623 -> 0.6179   acc: 77.36% -> 80.38%             
client [11] (test)  loss: 0.7407 -> 0.6980   acc: 74.47% -> 76.60%             
client [96] (test)  loss: 0.5604 -> 0.5136   acc: 85.29% -> 85.29%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9262 -> 0.8746   acc: 47.95% -> 58.90%              
client [53] (test)  loss: 0.5103 -> 0.4258   acc: 85.51% -> 86.96%             
client [52] (test)  loss: 0.9238 -> 0.8899   acc: 69.23% -> 69.23%             
client [42] (test)  loss: 0.6413 -> 0.5875   acc: 80.00% -> 81.13%             
client [69] (test)  loss: 0.2443 -> 0.2219   acc: 93.09% -> 93.09%             
client [59] (test)  loss: 0.0919 -> 0.0706   acc: 97.54% -> 97.54%             
client [7] (test)  loss: 1.1144 -> 0.9975   acc: 57.47% -> 57.47%              
client [26] (test)  loss: 0.3831 -> 0.4060   acc: 86.90% -> 80.00%             
client [49] (test)  loss: 0.2533 -> 0.2256   acc: 88.76% -> 89.81%             
client [98] (test)  loss: 0.4585 -> 0.4207   acc: 90.54% -> 90.54%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4131 -> 0.3823   acc: 93.24% -> 90.54%             
client [47] (test)  loss: 0.3632 -> 0.3454   acc: 89.33% -> 92.00%             
client [21] (test)  loss: 1.4725 -> 1.3796   acc: 41.38% -> 44.83%             
client [77] (test)  loss: 0.6975 -> 0.6905   acc: 75.65% -> 75.65%             
client [95] (test)  loss: 0.3761 -> 0.3733   acc: 90.48% -> 90.48%             
client [91] (test)  loss: 1.5419 -> 1.4860   acc: 43.75% -> 42.36%             
client [14] (test)  loss: 0.9067 -> 0.9187   acc: 60.56% -> 61.97%             
client [99] (test)  loss: 0.2642 -> 0.2638   acc: 95.31% -> 95.31%             
client [20] (test)  loss: 0.4880 -> 0.4619   acc: 81.74% -> 84.35%             
client [39] (test)  loss: 1.0005 -> 0.9660   acc: 56.00% -> 62.40%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8716 -> 0.8492   acc: 69.23% -> 69.23%             
client [62] (test)  loss: 0.0030 -> 0.0030   acc: 100.00% -> 100.00%           
client [71] (test)  loss: 0.1212 -> 0.1208   acc: 98.37% -> 98.37%             
client [97] (test)  loss: 1.1071 -> 1.0210   acc: 57.86% -> 62.26%             
client [30] (test)  loss: 0.3215 -> 0.3179   acc: 92.51% -> 92.51%             
client [88] (test)  loss: 1.2299 -> 1.1865   acc: 62.50% -> 63.54%             
client [60] (test)  loss: 0.8506 -> 0.8084   acc: 64.44% -> 71.11%             
client [82] (test)  loss: 0.0572 -> 0.0364   acc: 98.85% -> 100.00%            
client [91] (test)  loss: 1.4676 -> 1.4157   acc: 41.67% -> 43.06%             
client [57] (test)  loss: 0.6451 -> 0.6186   acc: 74.58% -> 81.36%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4744 -> 0.4679   acc: 87.78% -> 86.67%             
client [15] (test)  loss: 0.5475 -> 0.5065   acc: 77.91% -> 79.07%             
client [71] (test)  loss: 0.1180 -> 0.1187   acc: 98.37% -> 98.37%             
client [97] (test)  loss: 0.9875 -> 0.9245   acc: 64.15% -> 64.78%             
client [53] (test)  loss: 0.3503 -> 0.3137   acc: 88.41% -> 92.75%             
client [77] (test)  loss: 0.6880 -> 0.6770   acc: 75.65% -> 75.65%             
client [76] (test)  loss: 0.7682 -> 0.7409   acc: 69.44% -> 69.44%             
client [79] (test)  loss: 0.3084 -> 0.2233   acc: 89.26% -> 93.96%             
client [28] (test)  loss: 0.7670 -> 0.7531   acc: 84.00% -> 84.00%             
client [99] (test)  loss: 0.2676 -> 0.2642   acc: 95.31% -> 95.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.9072 -> 0.8694   acc: 64.78% -> 67.92%             
client [86] (test)  loss: 0.4570 -> 0.4357   acc: 83.91% -> 83.33%             
client [34] (test)  loss: 0.9726 -> 0.8957   acc: 66.67% -> 72.36%             
client [73] (test)  loss: 0.7677 -> 0.7474   acc: 69.84% -> 71.43%             
client [5] (test)  loss: 1.4652 -> 1.3463   acc: 54.29% -> 57.14%              
client [96] (test)  loss: 0.3767 -> 0.3565   acc: 94.12% -> 94.12%             
client [22] (test)  loss: 0.8787 -> 0.8667   acc: 71.19% -> 72.88%             
client [60] (test)  loss: 0.7604 -> 0.7198   acc: 77.78% -> 73.33%             
client [66] (test)  loss: 1.1822 -> 1.0936   acc: 45.71% -> 48.57%             
client [83] (test)  loss: 0.0007 -> 0.0007   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6745 -> 0.6342   acc: 69.44% -> 69.44%             
client [65] (test)  loss: 0.2880 -> 0.2798   acc: 91.67% -> 91.67%             
client [95] (test)  loss: 0.3436 -> 0.3398   acc: 90.48% -> 90.48%             
client [17] (test)  loss: 0.7387 -> 0.6854   acc: 68.09% -> 70.21%             
client [8] (test)  loss: 0.8060 -> 0.7758   acc: 60.27% -> 69.86%              
client [35] (test)  loss: 0.2890 -> 0.3624   acc: 96.43% -> 96.43%             
client [98] (test)  loss: 0.3240 -> 0.3100   acc: 91.89% -> 93.24%             
client [53] (test)  loss: 0.3057 -> 0.3105   acc: 94.20% -> 92.75%             
client [43] (test)  loss: 0.5534 -> 0.5605   acc: 90.00% -> 90.00%             
client [64] (test)  loss: 0.3066 -> 0.2878   acc: 94.74% -> 94.74%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.2316 -> 1.2647   acc: 62.07% -> 55.17%             
client [88] (test)  loss: 1.0559 -> 1.0370   acc: 57.29% -> 58.33%             
client [38] (test)  loss: 0.0961 -> 0.0785   acc: 99.19% -> 99.19%             
client [3] (test)  loss: 0.1526 -> 0.1504   acc: 94.31% -> 94.31%              
client [5] (test)  loss: 1.4819 -> 1.3522   acc: 54.29% -> 57.14%              
client [41] (test)  loss: 0.4650 -> 0.4394   acc: 85.44% -> 85.44%             
client [7] (test)  loss: 0.9025 -> 0.7812   acc: 62.07% -> 72.41%              
client [37] (test)  loss: 0.1987 -> 0.1898   acc: 95.22% -> 95.22%             
client [45] (test)  loss: 0.4465 -> 0.4035   acc: 77.97% -> 81.50%             
client [47] (test)  loss: 0.2501 -> 0.2308   acc: 94.67% -> 97.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8862 -> 0.8746   acc: 72.97% -> 72.97%             
client [11] (test)  loss: 0.5562 -> 0.5369   acc: 82.98% -> 80.85%             
client [37] (test)  loss: 0.1899 -> 0.1840   acc: 95.22% -> 95.22%             
client [41] (test)  loss: 0.4495 -> 0.4256   acc: 85.44% -> 85.44%             
client [95] (test)  loss: 0.3197 -> 0.3173   acc: 90.48% -> 90.48%             
client [53] (test)  loss: 0.2969 -> 0.2900   acc: 94.20% -> 95.65%             
client [22] (test)  loss: 0.8333 -> 0.8166   acc: 74.58% -> 72.88%             
client [25] (test)  loss: 0.9459 -> 0.9163   acc: 72.41% -> 73.56%             
client [69] (test)  loss: 0.2223 -> 0.2000   acc: 93.61% -> 93.35%             
client [46] (test)  loss: 0.6326 -> 0.5763   acc: 86.08% -> 87.34%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1812 -> 0.1867   acc: 97.33% -> 93.33%             
client [69] (test)  loss: 0.2044 -> 0.1923   acc: 93.09% -> 93.86%             
client [82] (test)  loss: 0.1030 -> 0.0303   acc: 96.55% -> 99.43%             
client [45] (test)  loss: 0.3762 -> 0.3532   acc: 83.70% -> 85.02%             
client [7] (test)  loss: 0.8368 -> 0.7418   acc: 66.67% -> 72.41%              
client [50] (test)  loss: 0.4866 -> 0.5023   acc: 90.83% -> 92.50%             
client [35] (test)  loss: 0.2894 -> 0.4186   acc: 96.43% -> 96.43%             
client [24] (test)  loss: 0.2568 -> 0.2335   acc: 90.32% -> 91.94%             
client [15] (test)  loss: 0.4552 -> 0.4328   acc: 79.07% -> 79.07%             
client [58] (test)  loss: 0.3689 -> 0.3755   acc: 96.30% -> 96.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4457 -> 0.4014   acc: 85.47% -> 88.89%             
client [76] (test)  loss: 0.5462 -> 0.5035   acc: 86.11% -> 88.89%             
client [67] (test)  loss: 0.3593 -> 0.3476   acc: 97.80% -> 97.80%             
client [37] (test)  loss: 0.1978 -> 0.1805   acc: 95.22% -> 95.22%             
client [58] (test)  loss: 0.3734 -> 0.3744   acc: 96.30% -> 96.30%             
client [64] (test)  loss: 0.2608 -> 0.2536   acc: 94.74% -> 92.98%             
client [77] (test)  loss: 0.6171 -> 0.6005   acc: 79.13% -> 79.13%             
client [55] (test)  loss: 0.6018 -> 0.6049   acc: 79.59% -> 81.63%             
client [12] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%           
client [89] (test)  loss: 0.8445 -> 0.9005   acc: 71.93% -> 66.67%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9171 -> 0.9274   acc: 75.61% -> 75.61%             
client [51] (test)  loss: 0.4973 -> 0.4954   acc: 90.48% -> 90.48%             
client [8] (test)  loss: 0.7478 -> 0.7064   acc: 65.75% -> 72.60%              
client [18] (test)  loss: 0.5994 -> 0.5702   acc: 73.81% -> 73.81%             
client [94] (test)  loss: 0.7210 -> 0.6740   acc: 77.27% -> 79.55%             
client [81] (test)  loss: 1.2464 -> 1.2335   acc: 43.48% -> 47.83%             
client [3] (test)  loss: 0.1268 -> 0.1241   acc: 97.56% -> 98.37%              
client [11] (test)  loss: 0.4981 -> 0.4948   acc: 82.98% -> 78.72%             
client [95] (test)  loss: 0.2941 -> 0.2942   acc: 92.86% -> 95.24%             
client [67] (test)  loss: 0.3590 -> 0.3585   acc: 97.80% -> 97.80%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.0903 -> 1.1205   acc: 65.52% -> 62.07%             
client [79] (test)  loss: 0.1562 -> 0.1549   acc: 95.97% -> 95.30%             
client [58] (test)  loss: 0.3720 -> 0.3787   acc: 96.30% -> 96.30%             
client [88] (test)  loss: 0.9695 -> 0.9559   acc: 58.33% -> 60.42%             
client [46] (test)  loss: 0.4981 -> 0.4692   acc: 89.87% -> 89.87%             
client [11] (test)  loss: 0.4907 -> 0.4842   acc: 80.85% -> 80.85%             
client [55] (test)  loss: 0.5723 -> 0.5756   acc: 81.63% -> 81.63%             
client [13] (test)  loss: 0.3754 -> 0.3592   acc: 82.98% -> 85.11%             
client [31] (test)  loss: 0.4280 -> 0.4185   acc: 88.89% -> 90.00%             
client [75] (test)  loss: 0.4888 -> 0.4540   acc: 84.54% -> 89.69%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.8332 -> 0.8430   acc: 67.74% -> 69.35%             
client [7] (test)  loss: 0.8334 -> 0.7002   acc: 71.26% -> 75.86%              
client [57] (test)  loss: 0.4703 -> 0.4586   acc: 87.29% -> 87.29%             
client [13] (test)  loss: 0.3641 -> 0.3539   acc: 85.11% -> 85.11%             
client [43] (test)  loss: 0.5772 -> 0.5701   acc: 90.00% -> 90.00%             
client [91] (test)  loss: 1.1756 -> 1.1262   acc: 47.22% -> 53.47%             
client [10] (test)  loss: 0.5978 -> 0.5715   acc: 86.32% -> 86.32%             
client [64] (test)  loss: 0.2248 -> 0.2215   acc: 96.49% -> 94.74%             
client [82] (test)  loss: 0.0646 -> 0.0317   acc: 98.28% -> 98.85%             
client [22] (test)  loss: 0.7364 -> 0.7243   acc: 76.27% -> 76.27%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3402 -> 0.3178   acc: 88.70% -> 90.43%             
client [23] (test)  loss: 0.7813 -> 0.7282   acc: 81.48% -> 83.33%             
client [88] (test)  loss: 0.9602 -> 0.9248   acc: 60.42% -> 61.46%             
client [98] (test)  loss: 0.2515 -> 0.2416   acc: 90.54% -> 93.24%             
client [79] (test)  loss: 0.1380 -> 0.1377   acc: 96.31% -> 96.31%             
client [21] (test)  loss: 1.1023 -> 1.4629   acc: 65.52% -> 48.28%             
client [92] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [56] (test)  loss: 0.2740 -> 0.2604   acc: 90.70% -> 95.35%             
client [5] (test)  loss: 1.2850 -> 1.2164   acc: 62.86% -> 65.71%              
client [52] (test)  loss: 0.8684 -> 0.8657   acc: 69.23% -> 69.23%             
==================== FedRep_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '0.4918 -> 0.0000', 'accuracy': '83.36% -> 0.00%'},          
    200: {'loss': '0.3754 -> 0.0000', 'accuracy': '87.90% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_join_0.1 achieved 10.0%(11.82%) at epoch: 0                             
FedRep_join_0.1 achieved 30.0%(32.34%) at epoch: 1                             
FedRep_join_0.1 achieved 70.0%(77.06%) at epoch: 7                             
FedRep_join_0.1 achieved 80.0%(85.11%) at epoch: 26                            
FedRep_join_0.1 achieved 90.0%(91.53%) at epoch: 113                           
Convergence (test_after):                                                      
FedRep_join_0.1 achieved 50.0%(59.74%) at epoch: 0                             
FedRep_join_0.1 achieved 60.0%(66.88%) at epoch: 1                             
FedRep_join_0.1 achieved 70.0%(72.90%) at epoch: 2                             
FedRep_join_0.1 achieved 80.0%(82.32%) at epoch: 5                             
FedRep_join_0.1 achieved 90.0%(90.18%) at epoch: 72                            
