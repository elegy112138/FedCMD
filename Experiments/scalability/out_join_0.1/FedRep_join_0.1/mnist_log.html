==================== ALGORITHM: FedRep_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0036 -> 0.0022   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.5228 -> 0.4200   acc: 91.18% -> 91.18%             
client [21] (test)  loss: 55.9341 -> 0.0514   acc: 0.00% -> 99.35%             
client [68] (test)  loss: 1.5085 -> 1.3643   acc: 49.67% -> 49.67%             
client [93] (test)  loss: 1.1131 -> 0.7723   acc: 57.70% -> 77.38%             
client [31] (test)  loss: 1.4278 -> 0.9543   acc: 65.14% -> 65.14%             
client [20] (test)  loss: 0.5645 -> 0.4847   acc: 86.11% -> 86.11%             
client [59] (test)  loss: 35.5411 -> 0.8852   acc: 35.85% -> 70.00%            
client [48] (test)  loss: 1.3822 -> 1.2533   acc: 63.18% -> 74.03%             
client [34] (test)  loss: 0.5874 -> 0.4645   acc: 83.33% -> 83.33%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4137 -> 0.5060   acc: 57.78% -> 90.83%             
client [99] (test)  loss: 0.0913 -> 0.0850   acc: 98.95% -> 98.95%             
client [67] (test)  loss: 1.0657 -> 0.9021   acc: 76.55% -> 77.88%             
client [0] (test)  loss: 0.0799 -> 0.0623   acc: 98.84% -> 98.84%              
client [76] (test)  loss: 0.3681 -> 0.3457   acc: 94.44% -> 94.44%             
client [41] (test)  loss: 0.3425 -> 0.2143   acc: 90.59% -> 91.53%             
client [62] (test)  loss: 93.2519 -> 0.7399   acc: 0.56% -> 71.15%             
client [2] (test)  loss: 165.6413 -> 0.2827   acc: 1.16% -> 94.96%             
client [14] (test)  loss: 0.5568 -> 0.4959   acc: 78.69% -> 78.69%             
client [46] (test)  loss: 0.6688 -> 0.5371   acc: 77.17% -> 82.95%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8610 -> 0.8052   acc: 66.00% -> 70.00%             
client [68] (test)  loss: 1.0446 -> 0.9539   acc: 53.59% -> 67.32%             
client [57] (test)  loss: 0.2203 -> 0.1566   acc: 95.52% -> 98.15%             
client [17] (test)  loss: 0.5062 -> 0.5013   acc: 91.11% -> 91.11%             
client [54] (test)  loss: 0.3569 -> 0.3376   acc: 87.68% -> 89.13%             
client [23] (test)  loss: 66.9762 -> 1.0478   acc: 38.46% -> 64.62%            
client [35] (test)  loss: 0.9749 -> 0.8138   acc: 70.13% -> 80.09%             
client [59] (test)  loss: 0.2738 -> 0.1956   acc: 94.15% -> 96.10%             
client [31] (test)  loss: 0.5822 -> 0.5198   acc: 80.73% -> 82.57%             
client [9] (test)  loss: 0.3713 -> 0.3118   acc: 88.77% -> 92.31%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [33] (test)  loss: 0.3610 -> 0.2538   acc: 89.00% -> 93.47%             
client [16] (test)  loss: 0.1538 -> 0.1320   acc: 96.45% -> 96.72%             
client [44] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.5682 -> 0.5103   acc: 85.96% -> 87.08%              
client [31] (test)  loss: 0.4659 -> 0.4140   acc: 83.94% -> 88.07%             
client [47] (test)  loss: 0.0262 -> 0.0209   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 0.4487 -> 0.2110   acc: 100.00% -> 100.00%           
client [20] (test)  loss: 0.3274 -> 0.3141   acc: 95.83% -> 95.83%             
client [56] (test)  loss: 0.2800 -> 0.2371   acc: 93.75% -> 93.75%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0069 -> 0.0074   acc: 99.79% -> 99.79%              
client [60] (test)  loss: 0.0021 -> 0.0016   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.1440 -> 0.1450   acc: 92.86% -> 97.62%             
client [25] (test)  loss: 0.4957 -> 0.3206   acc: 84.10% -> 90.20%             
client [58] (test)  loss: 0.3566 -> 0.3246   acc: 89.08% -> 89.64%             
client [44] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 0.4868 -> 0.4135   acc: 85.84% -> 86.28%             
client [29] (test)  loss: 0.1077 -> 0.0833   acc: 97.09% -> 98.31%             
client [3] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [84] (test)  loss: 0.0189 -> 0.0173   acc: 99.57% -> 99.57%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0336 -> 0.0221   acc: 99.35% -> 99.35%             
client [84] (test)  loss: 0.0159 -> 0.0139   acc: 99.57% -> 99.57%             
client [10] (test)  loss: 0.3250 -> 0.2905   acc: 88.00% -> 88.00%             
client [36] (test)  loss: 0.0548 -> 0.0348   acc: 100.00% -> 100.00%           
client [65] (test)  loss: 0.2293 -> 0.2044   acc: 92.09% -> 94.35%             
client [81] (test)  loss: 0.2814 -> 0.2392   acc: 91.18% -> 91.18%             
client [79] (test)  loss: 0.2244 -> 0.1987   acc: 94.51% -> 94.51%             
client [42] (test)  loss: 0.3793 -> 0.3354   acc: 94.19% -> 94.19%             
client [11] (test)  loss: 0.3861 -> 0.2960   acc: 87.97% -> 92.78%             
client [96] (test)  loss: 0.2799 -> 0.2244   acc: 93.41% -> 93.98%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3792 -> 0.3499   acc: 87.64% -> 89.04%              
client [53] (test)  loss: 0.4581 -> 0.4225   acc: 88.52% -> 89.47%             
client [52] (test)  loss: 0.1919 -> 0.1732   acc: 96.10% -> 97.40%             
client [42] (test)  loss: 0.2900 -> 0.2605   acc: 95.35% -> 96.51%             
client [69] (test)  loss: 0.1276 -> 0.1153   acc: 96.94% -> 96.94%             
client [59] (test)  loss: 0.0623 -> 0.0551   acc: 99.27% -> 99.51%             
client [7] (test)  loss: 0.0731 -> 0.0437   acc: 99.03% -> 98.61%              
client [26] (test)  loss: 0.1298 -> 0.1094   acc: 97.37% -> 97.61%             
client [49] (test)  loss: 0.2449 -> 0.2284   acc: 95.25% -> 94.41%             
client [98] (test)  loss: 0.6478 -> 0.6275   acc: 79.41% -> 79.41%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6107 -> 0.5929   acc: 79.41% -> 79.41%             
client [47] (test)  loss: 0.0046 -> 0.0078   acc: 100.00% -> 99.72%            
client [21] (test)  loss: 0.0162 -> 0.0133   acc: 99.35% -> 99.35%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.0495 -> 0.0443   acc: 98.16% -> 98.49%             
client [91] (test)  loss: 0.3415 -> 0.3054   acc: 89.92% -> 89.92%             
client [14] (test)  loss: 0.1816 -> 0.1626   acc: 93.03% -> 94.26%             
client [99] (test)  loss: 0.0735 -> 0.0709   acc: 98.95% -> 98.95%             
client [20] (test)  loss: 0.2607 -> 0.2590   acc: 97.22% -> 97.22%             
client [39] (test)  loss: 0.3247 -> 0.2865   acc: 89.38% -> 89.38%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1524 -> 0.1319   acc: 97.40% -> 97.40%             
client [62] (test)  loss: 0.1700 -> 0.1568   acc: 96.08% -> 96.36%             
client [71] (test)  loss: 0.0963 -> 0.0888   acc: 96.73% -> 97.23%             
client [97] (test)  loss: 0.0933 -> 0.0671   acc: 96.25% -> 97.86%             
client [30] (test)  loss: 0.3359 -> 0.3145   acc: 87.50% -> 89.06%             
client [88] (test)  loss: 0.0929 -> 0.0804   acc: 98.08% -> 98.08%             
client [60] (test)  loss: 0.0006 -> 0.0005   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.2730 -> 0.2738   acc: 95.10% -> 95.10%             
client [91] (test)  loss: 0.2850 -> 0.2625   acc: 90.76% -> 90.76%             
client [57] (test)  loss: 0.0920 -> 0.0862   acc: 98.92% -> 98.92%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1673 -> 0.1522   acc: 97.25% -> 98.17%             
client [15] (test)  loss: 0.2980 -> 0.2870   acc: 95.24% -> 95.24%             
client [71] (test)  loss: 0.0873 -> 0.0821   acc: 97.10% -> 97.23%             
client [97] (test)  loss: 0.0504 -> 0.0401   acc: 98.93% -> 98.93%             
client [53] (test)  loss: 0.3233 -> 0.3501   acc: 90.91% -> 89.95%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.3342 -> 0.3337   acc: 94.44% -> 94.44%             
client [79] (test)  loss: 0.1921 -> 0.1618   acc: 94.26% -> 94.76%             
client [28] (test)  loss: 0.0884 -> 0.0951   acc: 98.81% -> 98.81%             
client [99] (test)  loss: 0.0694 -> 0.0660   acc: 98.95% -> 98.95%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0359 -> 0.0296   acc: 99.20% -> 99.73%             
client [86] (test)  loss: 0.0128 -> 0.0122   acc: 100.00% -> 100.00%           
client [34] (test)  loss: 0.0550 -> 0.0540   acc: 99.02% -> 99.02%             
client [73] (test)  loss: 0.1435 -> 0.1425   acc: 95.49% -> 95.77%             
client [5] (test)  loss: 0.2348 -> 0.2136   acc: 92.56% -> 93.95%              
client [96] (test)  loss: 0.1451 -> 0.1361   acc: 94.56% -> 95.13%             
client [22] (test)  loss: 0.0236 -> 0.0188   acc: 99.26% -> 99.56%             
client [60] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.4954 -> 0.4724   acc: 88.54% -> 89.58%             
client [83] (test)  loss: 0.1275 -> 0.1370   acc: 96.95% -> 96.95%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3396 -> 0.3348   acc: 94.44% -> 94.44%             
client [65] (test)  loss: 0.1033 -> 0.0994   acc: 97.74% -> 97.74%             
client [95] (test)  loss: 0.0297 -> 0.0289   acc: 99.50% -> 99.67%             
client [17] (test)  loss: 0.4467 -> 0.4278   acc: 91.11% -> 91.11%             
client [8] (test)  loss: 0.2412 -> 0.2343   acc: 92.42% -> 92.70%              
client [35] (test)  loss: 0.2360 -> 0.2225   acc: 90.91% -> 91.34%             
client [98] (test)  loss: 0.5170 -> 0.5127   acc: 82.35% -> 79.41%             
client [53] (test)  loss: 0.2789 -> 0.3031   acc: 91.39% -> 91.87%             
client [43] (test)  loss: 0.0984 -> 0.0932   acc: 98.16% -> 97.24%             
client [64] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0093 -> 0.0085   acc: 99.61% -> 99.74%             
client [88] (test)  loss: 0.0456 -> 0.0433   acc: 98.63% -> 98.90%             
client [38] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [5] (test)  loss: 0.1929 -> 0.1784   acc: 95.35% -> 94.88%              
client [41] (test)  loss: 0.0338 -> 0.0313   acc: 99.29% -> 99.53%             
client [7] (test)  loss: 0.0217 -> 0.0189   acc: 99.58% -> 99.58%              
client [37] (test)  loss: 0.3852 -> 0.3746   acc: 89.47% -> 89.47%             
client [45] (test)  loss: 0.0289 -> 0.0254   acc: 99.73% -> 99.73%             
client [47] (test)  loss: 0.0043 -> 0.0056   acc: 100.00% -> 99.72%            
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0461 -> 0.0456   acc: 98.63% -> 98.63%             
client [11] (test)  loss: 0.1449 -> 0.1432   acc: 95.45% -> 94.92%             
client [37] (test)  loss: 0.3590 -> 0.3528   acc: 89.47% -> 89.47%             
client [41] (test)  loss: 0.0298 -> 0.0282   acc: 99.53% -> 99.53%             
client [95] (test)  loss: 0.0240 -> 0.0245   acc: 99.50% -> 99.67%             
client [53] (test)  loss: 0.2640 -> 0.3029   acc: 92.34% -> 90.43%             
client [22] (test)  loss: 0.0167 -> 0.0142   acc: 99.41% -> 99.56%             
client [25] (test)  loss: 0.1121 -> 0.1042   acc: 97.04% -> 97.04%             
client [69] (test)  loss: 0.0474 -> 0.0467   acc: 98.33% -> 98.33%             
client [46] (test)  loss: 0.1142 -> 0.1057   acc: 96.24% -> 96.82%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0044 -> 0.0049   acc: 99.72% -> 99.72%             
client [69] (test)  loss: 0.0468 -> 0.0430   acc: 98.33% -> 98.61%             
client [82] (test)  loss: 0.2914 -> 0.2940   acc: 95.10% -> 95.10%             
client [45] (test)  loss: 0.0211 -> 0.0192   acc: 99.45% -> 99.73%             
client [7] (test)  loss: 0.0185 -> 0.0162   acc: 99.58% -> 99.58%              
client [50] (test)  loss: 0.0937 -> 0.0773   acc: 98.12% -> 98.50%             
client [35] (test)  loss: 0.1907 -> 0.1849   acc: 92.21% -> 92.64%             
client [24] (test)  loss: 0.2807 -> 0.2740   acc: 94.00% -> 92.00%             
client [15] (test)  loss: 0.2371 -> 0.2331   acc: 95.24% -> 95.24%             
client [58] (test)  loss: 0.2116 -> 0.2073   acc: 94.68% -> 94.68%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1826 -> 0.1766   acc: 93.80% -> 94.57%             
client [76] (test)  loss: 0.3324 -> 0.3341   acc: 94.44% -> 94.44%             
client [67] (test)  loss: 0.2082 -> 0.2189   acc: 93.36% -> 93.81%             
client [37] (test)  loss: 0.3313 -> 0.3280   acc: 90.79% -> 90.79%             
client [58] (test)  loss: 0.2060 -> 0.2032   acc: 94.96% -> 95.52%             
client [64] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.0864 -> 0.0824   acc: 97.74% -> 97.24%             
client [12] (test)  loss: 0.1605 -> 0.1484   acc: 95.70% -> 94.62%             
client [89] (test)  loss: 0.0663 -> 0.0641   acc: 97.56% -> 97.80%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0039 -> 0.0037   acc: 99.79% -> 99.79%             
client [51] (test)  loss: 0.0764 -> 0.0886   acc: 97.69% -> 96.92%             
client [8] (test)  loss: 0.1743 -> 0.1820   acc: 95.22% -> 93.82%              
client [18] (test)  loss: 0.1992 -> 0.1914   acc: 93.94% -> 93.94%             
client [94] (test)  loss: 0.1498 -> 0.1456   acc: 97.55% -> 97.14%             
client [81] (test)  loss: 0.0695 -> 0.0688   acc: 97.06% -> 97.06%             
client [3] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [11] (test)  loss: 0.1297 -> 0.1296   acc: 96.26% -> 95.72%             
client [95] (test)  loss: 0.0181 -> 0.0198   acc: 99.67% -> 99.67%             
client [67] (test)  loss: 0.2040 -> 0.2149   acc: 92.48% -> 93.36%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0065 -> 0.0061   acc: 99.87% -> 99.87%             
client [79] (test)  loss: 0.1323 -> 0.1260   acc: 95.01% -> 95.51%             
client [58] (test)  loss: 0.2026 -> 0.1997   acc: 95.52% -> 95.52%             
client [88] (test)  loss: 0.0321 -> 0.0315   acc: 99.45% -> 99.18%             
client [46] (test)  loss: 0.0803 -> 0.0756   acc: 98.27% -> 97.69%             
client [11] (test)  loss: 0.1242 -> 0.1261   acc: 96.26% -> 95.72%             
client [55] (test)  loss: 0.0728 -> 0.0704   acc: 97.49% -> 97.49%             
client [13] (test)  loss: 0.0459 -> 0.0451   acc: 98.78% -> 98.78%             
client [31] (test)  loss: 0.0940 -> 0.0885   acc: 99.08% -> 99.08%             
client [75] (test)  loss: 0.1604 -> 0.1743   acc: 96.25% -> 96.25%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0622 -> 0.0589   acc: 98.43% -> 98.43%             
client [7] (test)  loss: 0.0127 -> 0.0117   acc: 99.72% -> 99.72%              
client [57] (test)  loss: 0.0411 -> 0.0382   acc: 98.92% -> 98.92%             
client [13] (test)  loss: 0.0424 -> 0.0425   acc: 99.39% -> 98.98%             
client [43] (test)  loss: 0.0637 -> 0.0617   acc: 98.16% -> 98.16%             
client [91] (test)  loss: 0.1740 -> 0.1688   acc: 95.80% -> 95.80%             
client [10] (test)  loss: 0.0935 -> 0.0947   acc: 97.33% -> 97.33%             
client [64] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.3074 -> 0.3077   acc: 95.10% -> 95.10%             
client [22] (test)  loss: 0.0101 -> 0.0094   acc: 99.56% -> 99.56%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2690 -> 0.2699   acc: 97.22% -> 97.22%             
client [23] (test)  loss: 0.2271 -> 0.2232   acc: 93.85% -> 93.85%             
client [88] (test)  loss: 0.0300 -> 0.0293   acc: 99.45% -> 99.45%             
client [98] (test)  loss: 0.4875 -> 0.4860   acc: 82.35% -> 82.35%             
client [79] (test)  loss: 0.1285 -> 0.1232   acc: 95.26% -> 95.51%             
client [21] (test)  loss: 0.0057 -> 0.0056   acc: 99.87% -> 99.87%             
client [92] (test)  loss: 0.0758 -> 0.0707   acc: 97.78% -> 97.87%             
client [56] (test)  loss: 0.0302 -> 0.0292   acc: 98.44% -> 98.44%             
client [5] (test)  loss: 0.1267 -> 0.1212   acc: 97.21% -> 97.67%              
client [52] (test)  loss: 0.0593 -> 0.0570   acc: 98.70% -> 98.70%             
==================== FedRep_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '0.1064 -> 0.0000', 'accuracy': '97.13% -> 0.00%'},          
    200: {'loss': '0.0643 -> 0.0000', 'accuracy': '98.27% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_join_0.1 achieved 10.0%(17.35%) at epoch: 1                             
FedRep_join_0.1 achieved 30.0%(34.12%) at epoch: 2                             
FedRep_join_0.1 achieved 40.0%(48.48%) at epoch: 4                             
FedRep_join_0.1 achieved 70.0%(72.72%) at epoch: 7                             
FedRep_join_0.1 achieved 90.0%(91.19%) at epoch: 24                            
Convergence (test_after):                                                      
FedRep_join_0.1 achieved 70.0%(73.76%) at epoch: 0                             
FedRep_join_0.1 achieved 80.0%(83.21%) at epoch: 1                             
FedRep_join_0.1 achieved 90.0%(91.87%) at epoch: 17                            
