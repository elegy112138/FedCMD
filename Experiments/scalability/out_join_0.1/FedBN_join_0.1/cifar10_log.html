==================== ALGORITHM: FedBN ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.5631 -> 0.7582   acc: 10.13% -> 75.33%             
client [81] (test)  loss: 1.9760 -> 1.3980   acc: 0.00% -> 43.30%              
client [21] (test)  loss: 24.0116 -> 0.5926   acc: 1.40% -> 80.84%             
client [68] (test)  loss: 1.9907 -> 0.7803   acc: 0.00% -> 72.65%              
client [93] (test)  loss: 3.3847 -> 0.5335   acc: 10.68% -> 86.35%             
client [31] (test)  loss: 2.6152 -> 1.2955   acc: 0.00% -> 57.39%              
client [20] (test)  loss: 2.7153 -> 0.2662   acc: 0.00% -> 93.33%              
client [59] (test)  loss: 29.4320 -> 0.2223   acc: 1.01% -> 96.80%             
client [48] (test)  loss: 1.8258 -> 0.8175   acc: 3.49% -> 63.95%              
client [34] (test)  loss: 1.4000 -> 0.6330   acc: 68.40% -> 82.29%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4863 -> 2.5923   acc: 59.48% -> 26.02%             
client [99] (test)  loss: 2.1502 -> 2.4960   acc: 22.35% -> 23.53%             
client [67] (test)  loss: 3.0906 -> 1.2535   acc: 9.76% -> 60.98%              
client [0] (test)  loss: 1.7334 -> 0.6468   acc: 1.77% -> 79.08%               
client [76] (test)  loss: 2.3095 -> 0.5077   acc: 45.06% -> 76.09%             
client [41] (test)  loss: 2.5986 -> 0.9390   acc: 6.97% -> 65.51%              
client [62] (test)  loss: 57.2876 -> 0.7756   acc: 0.00% -> 62.70%             
client [2] (test)  loss: 52.0865 -> 1.1221   acc: 0.00% -> 67.50%              
client [14] (test)  loss: 1.0827 -> 0.1292   acc: 63.78% -> 97.11%             
client [46] (test)  loss: 3.3782 -> 0.3529   acc: 1.42% -> 86.26%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3164 -> 0.8143   acc: 43.10% -> 73.04%             
client [68] (test)  loss: 2.9217 -> 0.5943   acc: 6.84% -> 80.34%              
client [57] (test)  loss: 1.5531 -> 0.5256   acc: 35.58% -> 76.84%             
client [17] (test)  loss: 2.2499 -> 0.2187   acc: 2.20% -> 93.96%              
client [54] (test)  loss: 2.9042 -> 0.8590   acc: 4.14% -> 62.42%              
client [23] (test)  loss: 126.6473 -> 1.3205   acc: 5.71% -> 57.14%            
client [35] (test)  loss: 3.4947 -> 0.5726   acc: 1.41% -> 85.92%              
client [59] (test)  loss: 4.6188 -> 0.1576   acc: 0.67% -> 96.80%              
client [31] (test)  loss: 3.9436 -> 1.0250   acc: 0.00% -> 57.39%              
client [9] (test)  loss: 4.0698 -> 0.2148   acc: 0.20% -> 94.01%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.9226 -> 0.8781   acc: 3.70% -> 70.37%              
client [33] (test)  loss: 3.2702 -> 0.5226   acc: 0.00% -> 87.58%              
client [16] (test)  loss: 4.9407 -> 0.4156   acc: 0.00% -> 88.27%              
client [44] (test)  loss: 8.9840 -> 0.0917   acc: 0.37% -> 98.66%              
client [8] (test)  loss: 1.7844 -> 0.0013   acc: 0.57% -> 100.00%              
client [31] (test)  loss: 6.1002 -> 1.0193   acc: 0.00% -> 57.95%              
client [47] (test)  loss: 0.6906 -> 0.5116   acc: 76.34% -> 84.59%             
client [36] (test)  loss: 2.2372 -> 0.3921   acc: 16.52% -> 87.83%             
client [20] (test)  loss: 3.1634 -> 0.2361   acc: 0.51% -> 95.38%              
client [56] (test)  loss: 3.1758 -> 0.3072   acc: 2.27% -> 92.61%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.8726 -> 0.3947   acc: 10.22% -> 88.44%              
client [60] (test)  loss: 3.6339 -> 0.2690   acc: 3.75% -> 90.83%              
client [28] (test)  loss: 3.6940 -> 0.8533   acc: 3.21% -> 71.12%              
client [25] (test)  loss: 1.6644 -> 0.6146   acc: 35.56% -> 78.10%             
client [58] (test)  loss: 4.8239 -> 0.7550   acc: 2.79% -> 72.07%              
client [44] (test)  loss: 4.8525 -> 0.0961   acc: 0.00% -> 98.66%              
client [39] (test)  loss: 2.5577 -> 0.3672   acc: 4.26% -> 84.50%              
client [29] (test)  loss: 4.1644 -> 0.4762   acc: 4.76% -> 86.67%              
client [3] (test)  loss: 2.5732 -> 0.2762   acc: 24.52% -> 90.65%              
client [84] (test)  loss: 1.5663 -> 0.7958   acc: 42.94% -> 75.71%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.7484 -> 0.7897   acc: 1.40% -> 76.64%              
client [84] (test)  loss: 2.2348 -> 0.8880   acc: 28.81% -> 70.62%             
client [10] (test)  loss: 3.2809 -> 0.5120   acc: 10.40% -> 79.38%             
client [36] (test)  loss: 2.1932 -> 0.3547   acc: 10.43% -> 87.83%             
client [65] (test)  loss: 1.2313 -> 0.3316   acc: 52.16% -> 87.06%             
client [81] (test)  loss: 2.5435 -> 1.2143   acc: 34.82% -> 52.68%             
client [79] (test)  loss: 1.7392 -> 0.7901   acc: 32.16% -> 73.68%             
client [42] (test)  loss: 3.4486 -> 0.0937   acc: 2.35% -> 97.12%              
client [11] (test)  loss: 6.8564 -> 0.7563   acc: 0.00% -> 67.09%              
client [96] (test)  loss: 1.9286 -> 0.8121   acc: 41.35% -> 69.23%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3393 -> 0.0009   acc: 94.87% -> 100.00%             
client [53] (test)  loss: 3.1769 -> 0.1886   acc: 20.56% -> 93.46%             
client [52] (test)  loss: 1.3652 -> 0.3385   acc: 39.63% -> 87.31%             
client [42] (test)  loss: 3.0932 -> 0.0834   acc: 2.67% -> 97.76%              
client [69] (test)  loss: 2.3626 -> 0.7505   acc: 14.50% -> 79.55%             
client [59] (test)  loss: 5.5505 -> 0.1638   acc: 0.34% -> 95.96%              
client [7] (test)  loss: 1.3837 -> 1.0514   acc: 44.44% -> 66.67%              
client [26] (test)  loss: 1.8505 -> 0.5694   acc: 34.21% -> 82.89%             
client [49] (test)  loss: 1.0984 -> 0.0313   acc: 36.49% -> 99.64%             
client [98] (test)  loss: 1.8291 -> 0.9783   acc: 34.33% -> 68.66%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.3339 -> 0.9221   acc: 34.33% -> 68.66%             
client [47] (test)  loss: 3.4159 -> 0.5212   acc: 11.47% -> 82.08%             
client [21] (test)  loss: 3.8527 -> 0.7404   acc: 1.40% -> 76.17%              
client [77] (test)  loss: 4.7919 -> 0.7444   acc: 0.44% -> 76.65%              
client [95] (test)  loss: 1.4184 -> 0.4608   acc: 66.78% -> 84.41%             
client [91] (test)  loss: 2.1830 -> 0.4954   acc: 6.67% -> 82.67%              
client [14] (test)  loss: 1.0823 -> 0.0568   acc: 64.63% -> 98.47%             
client [99] (test)  loss: 1.8057 -> 2.0293   acc: 37.06% -> 35.88%             
client [20] (test)  loss: 2.0087 -> 0.2081   acc: 35.38% -> 95.38%             
client [39] (test)  loss: 1.5445 -> 0.4013   acc: 18.24% -> 84.50%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.1991 -> 0.3538   acc: 24.46% -> 86.84%             
client [62] (test)  loss: 2.9810 -> 0.1861   acc: 7.86% -> 94.35%              
client [71] (test)  loss: 2.5729 -> 0.1098   acc: 28.46% -> 97.97%             
client [97] (test)  loss: 1.4400 -> 0.0010   acc: 56.75% -> 100.00%            
client [30] (test)  loss: 2.0235 -> 1.1576   acc: 16.00% -> 68.00%             
client [88] (test)  loss: 6.9167 -> 0.6077   acc: 2.90% -> 82.61%              
client [60] (test)  loss: 3.2001 -> 0.2415   acc: 7.08% -> 91.67%              
client [82] (test)  loss: 2.2449 -> 0.9762   acc: 30.34% -> 66.29%             
client [91] (test)  loss: 4.9437 -> 0.5012   acc: 5.33% -> 81.33%              
client [57] (test)  loss: 2.1781 -> 0.5693   acc: 42.74% -> 73.47%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.6861 -> 1.4616   acc: 33.52% -> 61.36%             
client [15] (test)  loss: 1.8477 -> 0.5673   acc: 12.05% -> 78.31%             
client [71] (test)  loss: 3.9319 -> 0.1296   acc: 9.35% -> 97.97%              
client [97] (test)  loss: 2.6057 -> 0.0011   acc: 12.20% -> 100.00%            
client [53] (test)  loss: 2.8107 -> 0.1429   acc: 20.56% -> 93.46%             
client [77] (test)  loss: 6.5960 -> 0.6442   acc: 0.44% -> 82.38%              
client [76] (test)  loss: 1.4655 -> 0.5169   acc: 50.34% -> 77.93%             
client [79] (test)  loss: 2.0058 -> 0.7736   acc: 33.92% -> 74.27%             
client [28] (test)  loss: 2.5451 -> 0.8359   acc: 17.11% -> 70.05%             
client [99] (test)  loss: 1.5438 -> 1.6264   acc: 43.53% -> 45.88%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.4721 -> 0.0013   acc: 25.82% -> 100.00%            
client [86] (test)  loss: 2.1723 -> 0.8372   acc: 19.90% -> 73.30%             
client [34] (test)  loss: 2.0005 -> 0.4641   acc: 36.11% -> 85.42%             
client [73] (test)  loss: 1.8409 -> 1.1112   acc: 25.00% -> 63.64%             
client [5] (test)  loss: 3.1436 -> 0.5616   acc: 2.15% -> 82.80%               
client [96] (test)  loss: 2.6044 -> 0.7611   acc: 17.31% -> 69.23%             
client [22] (test)  loss: 2.5462 -> 0.2841   acc: 25.56% -> 90.23%             
client [60] (test)  loss: 1.3972 -> 0.2158   acc: 50.42% -> 92.92%             
client [66] (test)  loss: 2.4838 -> 0.3098   acc: 3.14% -> 90.77%              
client [83] (test)  loss: 0.1247 -> 0.0020   acc: 98.41% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.6102 -> 0.4215   acc: 14.02% -> 82.30%             
client [65] (test)  loss: 1.4694 -> 0.3626   acc: 45.10% -> 86.67%             
client [95] (test)  loss: 1.8154 -> 0.5050   acc: 49.83% -> 85.42%             
client [17] (test)  loss: 3.6712 -> 0.1348   acc: 5.77% -> 95.19%              
client [8] (test)  loss: 0.0729 -> 0.0012   acc: 98.67% -> 100.00%             
client [35] (test)  loss: 1.8108 -> 0.6589   acc: 32.39% -> 74.65%             
client [98] (test)  loss: 1.1183 -> 0.8262   acc: 50.75% -> 70.15%             
client [53] (test)  loss: 0.9442 -> 0.1178   acc: 68.22% -> 95.33%             
client [43] (test)  loss: 4.3590 -> 1.0912   acc: 16.94% -> 61.57%             
client [64] (test)  loss: 1.9833 -> 0.8289   acc: 33.33% -> 74.07%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.0356 -> 0.5019   acc: 19.63% -> 82.71%             
client [88] (test)  loss: 4.3564 -> 0.7458   acc: 1.45% -> 79.71%              
client [38] (test)  loss: 2.1741 -> 2.5508   acc: 42.86% -> 40.00%             
client [3] (test)  loss: 6.0315 -> 0.2754   acc: 19.35% -> 89.68%              
client [5] (test)  loss: 3.6194 -> 0.7126   acc: 2.15% -> 80.65%               
client [41] (test)  loss: 1.8786 -> 0.8069   acc: 25.78% -> 70.73%             
client [7] (test)  loss: 4.2017 -> 0.7481   acc: 13.89% -> 73.61%              
client [37] (test)  loss: 4.4917 -> 0.9380   acc: 1.58% -> 72.63%              
client [45] (test)  loss: 3.9536 -> 0.3033   acc: 3.77% -> 91.94%              
client [47] (test)  loss: 3.9470 -> 0.5562   acc: 13.26% -> 81.72%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.0284 -> 0.3605   acc: 13.41% -> 85.47%             
client [11] (test)  loss: 2.1442 -> 0.6869   acc: 37.47% -> 77.72%             
client [37] (test)  loss: 3.8928 -> 0.9326   acc: 17.37% -> 72.11%             
client [41] (test)  loss: 1.3570 -> 0.7836   acc: 47.04% -> 71.78%             
client [95] (test)  loss: 2.0255 -> 0.5217   acc: 47.46% -> 85.08%             
client [53] (test)  loss: 2.3460 -> 0.1046   acc: 29.91% -> 96.26%             
client [22] (test)  loss: 3.1614 -> 0.2644   acc: 20.30% -> 93.98%             
client [25] (test)  loss: 4.5288 -> 0.5854   acc: 6.83% -> 79.52%              
client [69] (test)  loss: 1.3722 -> 0.6366   acc: 52.42% -> 79.18%             
client [46] (test)  loss: 1.0159 -> 0.2262   acc: 65.40% -> 93.84%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9754 -> 0.5180   acc: 66.31% -> 84.95%             
client [69] (test)  loss: 2.2980 -> 0.6255   acc: 39.78% -> 81.78%             
client [82] (test)  loss: 2.8013 -> 0.9314   acc: 18.54% -> 73.60%             
client [45] (test)  loss: 4.7778 -> 0.2988   acc: 2.40% -> 91.60%              
client [7] (test)  loss: 4.5203 -> 0.7248   acc: 0.00% -> 75.00%               
client [50] (test)  loss: 4.7145 -> 0.3010   acc: 10.91% -> 90.27%             
client [35] (test)  loss: 1.8166 -> 0.5654   acc: 21.13% -> 73.24%             
client [24] (test)  loss: 3.6821 -> 0.6923   acc: 16.77% -> 80.09%             
client [15] (test)  loss: 2.2604 -> 0.8722   acc: 31.33% -> 74.70%             
client [58] (test)  loss: 3.6947 -> 0.8091   acc: 19.55% -> 69.83%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.0309 -> 0.6465   acc: 58.14% -> 77.91%             
client [76] (test)  loss: 1.6065 -> 0.4691   acc: 40.23% -> 82.30%             
client [67] (test)  loss: 2.5315 -> 1.2892   acc: 29.27% -> 58.54%             
client [37] (test)  loss: 3.2903 -> 0.8032   acc: 15.79% -> 72.11%             
client [58] (test)  loss: 1.9138 -> 0.7925   acc: 25.14% -> 70.39%             
client [64] (test)  loss: 4.0645 -> 0.8833   acc: 18.52% -> 74.07%             
client [77] (test)  loss: 4.9226 -> 0.6394   acc: 11.45% -> 85.46%             
client [55] (test)  loss: 3.7892 -> 1.0432   acc: 17.46% -> 61.90%             
client [12] (test)  loss: 3.3262 -> 0.6781   acc: 11.11% -> 76.19%             
client [89] (test)  loss: 4.7244 -> 0.4598   acc: 21.82% -> 89.09%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.2922 -> 0.9616   acc: 40.11% -> 75.71%             
client [51] (test)  loss: 1.9269 -> 0.0017   acc: 34.30% -> 100.00%            
client [8] (test)  loss: 0.5032 -> 0.0012   acc: 77.00% -> 100.00%             
client [18] (test)  loss: 1.8378 -> 1.2355   acc: 40.22% -> 58.15%             
client [94] (test)  loss: 3.6596 -> 0.4822   acc: 19.23% -> 84.62%             
client [81] (test)  loss: 1.2866 -> 1.1137   acc: 53.12% -> 59.38%             
client [3] (test)  loss: 2.4721 -> 0.3010   acc: 36.77% -> 90.00%              
client [11] (test)  loss: 2.4458 -> 0.7755   acc: 24.05% -> 77.22%             
client [95] (test)  loss: 3.1469 -> 0.6033   acc: 40.00% -> 85.42%             
client [67] (test)  loss: 2.3276 -> 1.3513   acc: 29.27% -> 58.54%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.6532 -> 0.6009   acc: 11.68% -> 81.78%             
client [79] (test)  loss: 3.6225 -> 0.8392   acc: 17.54% -> 71.93%             
client [58] (test)  loss: 1.6388 -> 0.8221   acc: 41.90% -> 70.95%             
client [88] (test)  loss: 2.5086 -> 0.7603   acc: 11.59% -> 81.16%             
client [46] (test)  loss: 1.7023 -> 0.2058   acc: 52.13% -> 94.79%             
client [11] (test)  loss: 2.6066 -> 0.7593   acc: 21.77% -> 78.23%             
client [55] (test)  loss: 2.0958 -> 0.9761   acc: 31.75% -> 55.56%             
client [13] (test)  loss: 1.0835 -> 0.9529   acc: 60.40% -> 61.27%             
client [31] (test)  loss: 1.8879 -> 0.7954   acc: 19.32% -> 70.45%             
client [75] (test)  loss: 1.9905 -> 0.2383   acc: 41.18% -> 92.84%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.2601 -> 0.5522   acc: 17.09% -> 84.62%             
client [7] (test)  loss: 4.2138 -> 0.7848   acc: 37.50% -> 75.00%              
client [57] (test)  loss: 0.8998 -> 0.8774   acc: 69.47% -> 69.26%             
client [13] (test)  loss: 1.2098 -> 1.0092   acc: 62.14% -> 56.94%             
client [43] (test)  loss: 2.0864 -> 0.7395   acc: 40.50% -> 75.21%             
client [91] (test)  loss: 2.7574 -> 0.5408   acc: 27.33% -> 84.00%             
client [10] (test)  loss: 4.9511 -> 0.4719   acc: 4.05% -> 85.16%              
client [64] (test)  loss: 2.5180 -> 0.9625   acc: 37.04% -> 62.96%             
client [82] (test)  loss: 1.9071 -> 1.0560   acc: 36.52% -> 70.79%             
client [22] (test)  loss: 1.7302 -> 0.3073   acc: 43.61% -> 93.23%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0888 -> 0.2023   acc: 49.74% -> 93.85%             
client [23] (test)  loss: 3.4884 -> 1.3401   acc: 8.57% -> 74.29%              
client [88] (test)  loss: 5.0144 -> 0.7325   acc: 1.45% -> 81.16%              
client [98] (test)  loss: 0.9474 -> 0.7378   acc: 62.69% -> 71.64%             
client [79] (test)  loss: 2.9528 -> 0.8101   acc: 22.81% -> 76.02%             
client [21] (test)  loss: 2.1580 -> 0.4082   acc: 44.39% -> 85.51%             
client [92] (test)  loss: 1.9183 -> 0.0643   acc: 32.66% -> 99.07%             
client [56] (test)  loss: 0.3145 -> 0.2478   acc: 92.05% -> 92.61%             
client [5] (test)  loss: 2.1389 -> 0.7010   acc: 40.86% -> 79.57%              
client [52] (test)  loss: 1.2179 -> 0.4780   acc: 50.77% -> 84.83%             
==================== FedBN TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '2.6238 -> 0.0000', 'accuracy': '24.33% -> 0.00%'},          
    200: {'loss': '2.0286 -> 0.0000', 'accuracy': '41.77% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN achieved 10.0%(17.79%) at epoch: 0                                       
FedBN achieved 20.0%(23.90%) at epoch: 4                                       
FedBN achieved 30.0%(32.76%) at epoch: 18                                      
FedBN achieved 50.0%(53.15%) at epoch: 40                                      
FedBN achieved 60.0%(61.77%) at epoch: 194                                     
Convergence (test_after):                                                      
FedBN achieved 70.0%(75.11%) at epoch: 0                                       
FedBN achieved 80.0%(86.52%) at epoch: 4                                       
FedBN achieved 90.0%(92.85%) at epoch: 11                                      
