==================== ALGORITHM: FedBN_join_0.1 ====================            
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.8532 -> 0.1401   acc: 32.14% -> 95.72%             
client [81] (test)  loss: 1.6458 -> 0.2085   acc: 43.13% -> 92.23%             
client [21] (test)  loss: 164.7251 -> 0.0933   acc: 8.74% -> 97.48%            
client [68] (test)  loss: 2.7041 -> 0.3824   acc: 38.56% -> 88.84%             
client [93] (test)  loss: 0.7467 -> 0.0461   acc: 80.85% -> 98.61%             
client [31] (test)  loss: 3.8750 -> 0.1718   acc: 7.40% -> 94.02%              
client [20] (test)  loss: 2.3847 -> 0.1866   acc: 23.25% -> 94.84%             
client [59] (test)  loss: 137.2436 -> 0.3254   acc: 15.00% -> 87.97%           
client [48] (test)  loss: 4.2280 -> 0.6370   acc: 14.18% -> 80.12%             
client [34] (test)  loss: 2.2776 -> 0.1255   acc: 17.43% -> 96.54%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.4988 -> 0.3135   acc: 18.93% -> 90.05%             
client [99] (test)  loss: 0.5515 -> 0.0420   acc: 84.19% -> 98.91%             
client [67] (test)  loss: 0.9500 -> 0.3531   acc: 76.45% -> 87.30%             
client [0] (test)  loss: 0.9818 -> 0.1627   acc: 77.06% -> 95.05%              
client [76] (test)  loss: 1.9551 -> 0.2246   acc: 40.63% -> 93.36%             
client [41] (test)  loss: 1.6034 -> 0.3204   acc: 47.17% -> 88.44%             
client [62] (test)  loss: 57.4884 -> 0.1117   acc: 52.33% -> 96.90%            
client [2] (test)  loss: 144.1278 -> 0.1573   acc: 35.17% -> 95.53%            
client [14] (test)  loss: 1.3533 -> 0.1958   acc: 56.14% -> 94.33%             
client [46] (test)  loss: 1.4083 -> 0.0249   acc: 28.71% -> 99.26%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8132 -> 0.1927   acc: 72.07% -> 93.70%             
client [68] (test)  loss: 1.5933 -> 0.2816   acc: 51.83% -> 91.08%             
client [57] (test)  loss: 1.0928 -> 0.1309   acc: 66.97% -> 96.70%             
client [17] (test)  loss: 2.0401 -> 0.1623   acc: 47.93% -> 94.22%             
client [54] (test)  loss: 1.4915 -> 0.2484   acc: 55.46% -> 93.22%             
client [23] (test)  loss: 198.8631 -> 0.1045   acc: 41.17% -> 96.64%           
client [35] (test)  loss: 0.3314 -> 0.0127   acc: 90.81% -> 99.62%             
client [59] (test)  loss: 0.7342 -> 0.2526   acc: 77.97% -> 90.15%             
client [31] (test)  loss: 0.9393 -> 0.1269   acc: 74.28% -> 95.62%             
client [9] (test)  loss: 1.5673 -> 0.1771   acc: 54.35% -> 94.19%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8775 -> 0.2913   acc: 77.36% -> 90.77%             
client [33] (test)  loss: 0.7800 -> 0.0641   acc: 67.22% -> 98.27%             
client [16] (test)  loss: 1.1603 -> 0.2740   acc: 57.72% -> 91.32%             
client [44] (test)  loss: 3.4138 -> 0.3816   acc: 35.97% -> 87.50%             
client [8] (test)  loss: 1.6455 -> 0.4345   acc: 58.76% -> 83.85%              
client [31] (test)  loss: 0.6148 -> 0.1243   acc: 79.10% -> 95.81%             
client [47] (test)  loss: 1.4243 -> 0.2196   acc: 58.80% -> 93.53%             
client [36] (test)  loss: 1.9407 -> 0.1740   acc: 38.46% -> 95.41%             
client [20] (test)  loss: 1.6857 -> 0.0981   acc: 39.49% -> 97.22%             
client [56] (test)  loss: 0.9788 -> 0.0333   acc: 60.38% -> 99.13%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.4552 -> 0.3364   acc: 61.93% -> 86.09%              
client [60] (test)  loss: 1.0225 -> 0.1182   acc: 71.38% -> 96.80%             
client [28] (test)  loss: 0.5251 -> 0.0037   acc: 85.46% -> 99.89%             
client [25] (test)  loss: 1.9719 -> 0.1415   acc: 49.37% -> 95.74%             
client [58] (test)  loss: 0.1413 -> 0.0073   acc: 96.23% -> 99.72%             
client [44] (test)  loss: 1.5002 -> 0.3642   acc: 54.34% -> 88.10%             
client [39] (test)  loss: 1.1268 -> 0.1169   acc: 59.94% -> 96.96%             
client [29] (test)  loss: 1.0556 -> 0.2022   acc: 68.18% -> 93.15%             
client [3] (test)  loss: 0.1730 -> 0.0126   acc: 95.86% -> 99.61%              
client [84] (test)  loss: 1.2406 -> 0.1679   acc: 66.77% -> 94.51%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3448 -> 0.0465   acc: 90.31% -> 98.59%             
client [84] (test)  loss: 1.0641 -> 0.1696   acc: 67.45% -> 94.40%             
client [10] (test)  loss: 0.9716 -> 0.3061   acc: 71.13% -> 86.39%             
client [36] (test)  loss: 2.1278 -> 0.1682   acc: 38.95% -> 95.56%             
client [65] (test)  loss: 0.7875 -> 0.3105   acc: 68.40% -> 89.40%             
client [81] (test)  loss: 0.4343 -> 0.1583   acc: 82.35% -> 93.60%             
client [79] (test)  loss: 1.3327 -> 0.2598   acc: 60.55% -> 91.97%             
client [42] (test)  loss: 0.9249 -> 0.2408   acc: 73.78% -> 92.91%             
client [11] (test)  loss: 0.4329 -> 0.0800   acc: 88.72% -> 97.82%             
client [96] (test)  loss: 0.7250 -> 0.1182   acc: 79.61% -> 96.51%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.9849 -> 0.3544   acc: 53.05% -> 86.82%              
client [53] (test)  loss: 1.8391 -> 0.0487   acc: 36.29% -> 98.70%             
client [52] (test)  loss: 1.2002 -> 0.3059   acc: 60.58% -> 88.24%             
client [42] (test)  loss: 0.7170 -> 0.2372   acc: 80.73% -> 93.10%             
client [69] (test)  loss: 1.4039 -> 0.2141   acc: 62.50% -> 93.26%             
client [59] (test)  loss: 0.7774 -> 0.2316   acc: 74.06% -> 90.66%             
client [7] (test)  loss: 0.8603 -> 0.2373   acc: 79.90% -> 93.06%              
client [26] (test)  loss: 0.7766 -> 0.1657   acc: 65.53% -> 94.71%             
client [49] (test)  loss: 0.1683 -> 0.0005   acc: 95.29% -> 99.98%             
client [98] (test)  loss: 0.8550 -> 0.0491   acc: 66.25% -> 99.20%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8836 -> 0.0494   acc: 65.85% -> 99.10%             
client [47] (test)  loss: 1.2259 -> 0.2110   acc: 60.09% -> 93.80%             
client [21] (test)  loss: 0.6275 -> 0.0428   acc: 82.08% -> 98.64%             
client [77] (test)  loss: 1.1730 -> 0.0875   acc: 66.11% -> 97.50%             
client [95] (test)  loss: 1.1980 -> 0.1012   acc: 45.75% -> 97.19%             
client [91] (test)  loss: 1.1116 -> 0.0637   acc: 62.86% -> 98.13%             
client [14] (test)  loss: 0.6752 -> 0.1686   acc: 73.08% -> 95.35%             
client [99] (test)  loss: 0.1951 -> 0.0330   acc: 95.32% -> 99.01%             
client [20] (test)  loss: 1.2374 -> 0.0896   acc: 49.62% -> 97.60%             
client [39] (test)  loss: 1.2044 -> 0.1078   acc: 59.45% -> 97.08%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.4006 -> 0.3041   acc: 56.90% -> 88.19%             
client [62] (test)  loss: 0.2323 -> 0.0817   acc: 93.47% -> 97.98%             
client [71] (test)  loss: 0.2046 -> 0.0080   acc: 94.30% -> 99.78%             
client [97] (test)  loss: 0.4700 -> 0.0096   acc: 85.83% -> 99.66%             
client [30] (test)  loss: 1.2660 -> 0.1214   acc: 51.20% -> 96.58%             
client [88] (test)  loss: 0.9288 -> 0.2499   acc: 70.44% -> 90.56%             
client [60] (test)  loss: 0.7104 -> 0.1085   acc: 77.10% -> 97.61%             
client [82] (test)  loss: 1.5741 -> 0.5489   acc: 45.26% -> 71.93%             
client [91] (test)  loss: 0.9306 -> 0.0641   acc: 65.90% -> 98.06%             
client [57] (test)  loss: 0.8180 -> 0.1119   acc: 73.04% -> 97.35%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2392 -> 0.1058   acc: 90.54% -> 96.25%             
client [15] (test)  loss: 1.0087 -> 0.0213   acc: 71.53% -> 99.40%             
client [71] (test)  loss: 0.2628 -> 0.0079   acc: 92.88% -> 99.78%             
client [97] (test)  loss: 1.1147 -> 0.0088   acc: 69.88% -> 99.68%             
client [53] (test)  loss: 1.2033 -> 0.0475   acc: 65.20% -> 98.86%             
client [77] (test)  loss: 1.6057 -> 0.0870   acc: 52.28% -> 97.45%             
client [76] (test)  loss: 1.3283 -> 0.1734   acc: 56.73% -> 94.67%             
client [79] (test)  loss: 1.4310 -> 0.2386   acc: 66.00% -> 92.56%             
client [28] (test)  loss: 0.2434 -> 0.0045   acc: 92.72% -> 99.88%             
client [99] (test)  loss: 0.2800 -> 0.0316   acc: 91.90% -> 99.05%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1760 -> 0.0088   acc: 94.28% -> 99.66%             
client [86] (test)  loss: 1.0033 -> 0.3100   acc: 69.06% -> 88.92%             
client [34] (test)  loss: 0.4904 -> 0.0806   acc: 84.53% -> 97.62%             
client [73] (test)  loss: 0.6029 -> 0.2450   acc: 82.48% -> 91.30%             
client [5] (test)  loss: 0.7666 -> 0.1189   acc: 78.54% -> 96.59%              
client [96] (test)  loss: 0.9321 -> 0.1185   acc: 77.55% -> 96.47%             
client [22] (test)  loss: 0.9387 -> 0.1332   acc: 74.01% -> 95.31%             
client [60] (test)  loss: 0.7061 -> 0.1054   acc: 74.77% -> 97.71%             
client [66] (test)  loss: 1.2021 -> 0.1678   acc: 50.42% -> 95.14%             
client [83] (test)  loss: 0.4753 -> 0.1062   acc: 87.17% -> 96.89%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.9765 -> 0.1713   acc: 68.73% -> 94.81%             
client [65] (test)  loss: 1.0191 -> 0.3073   acc: 64.45% -> 89.83%             
client [95] (test)  loss: 1.5065 -> 0.1004   acc: 41.79% -> 97.36%             
client [17] (test)  loss: 0.7833 -> 0.1357   acc: 75.18% -> 95.48%             
client [8] (test)  loss: 1.4735 -> 0.3136   acc: 61.01% -> 88.31%              
client [35] (test)  loss: 0.1716 -> 0.0094   acc: 94.99% -> 99.73%             
client [98] (test)  loss: 0.3793 -> 0.0482   acc: 88.82% -> 99.22%             
client [53] (test)  loss: 0.7284 -> 0.0462   acc: 75.87% -> 98.95%             
client [43] (test)  loss: 1.4301 -> 0.2854   acc: 53.72% -> 89.94%             
client [64] (test)  loss: 1.4184 -> 0.2600   acc: 59.69% -> 91.98%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5907 -> 0.0421   acc: 82.98% -> 98.74%             
client [88] (test)  loss: 1.0286 -> 0.2425   acc: 59.18% -> 91.13%             
client [38] (test)  loss: 1.5686 -> 0.2024   acc: 62.24% -> 94.61%             
client [3] (test)  loss: 0.2913 -> 0.0129   acc: 91.00% -> 99.67%              
client [5] (test)  loss: 1.0950 -> 0.1176   acc: 67.39% -> 96.75%              
client [41] (test)  loss: 0.9969 -> 0.2664   acc: 65.70% -> 90.38%             
client [7] (test)  loss: 1.0523 -> 0.2283   acc: 62.73% -> 93.17%              
client [37] (test)  loss: 0.2644 -> 0.0251   acc: 91.36% -> 99.33%             
client [45] (test)  loss: 1.2816 -> 0.3427   acc: 60.49% -> 87.92%             
client [47] (test)  loss: 1.3118 -> 0.2124   acc: 54.45% -> 93.74%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0902 -> 0.2591   acc: 62.47% -> 91.95%             
client [11] (test)  loss: 0.5257 -> 0.0761   acc: 86.14% -> 98.06%             
client [37] (test)  loss: 0.1487 -> 0.0245   acc: 95.54% -> 99.31%             
client [41] (test)  loss: 1.1510 -> 0.2696   acc: 63.92% -> 90.22%             
client [95] (test)  loss: 1.2763 -> 0.0978   acc: 46.05% -> 97.52%             
client [53] (test)  loss: 0.8402 -> 0.0444   acc: 79.62% -> 98.92%             
client [22] (test)  loss: 1.1988 -> 0.1324   acc: 69.99% -> 95.23%             
client [25] (test)  loss: 0.7743 -> 0.1178   acc: 79.36% -> 96.31%             
client [69] (test)  loss: 1.6105 -> 0.1881   acc: 59.72% -> 94.40%             
client [46] (test)  loss: 0.4686 -> 0.0173   acc: 83.66% -> 99.49%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9494 -> 0.2161   acc: 63.44% -> 93.77%             
client [69] (test)  loss: 1.2414 -> 0.1880   acc: 66.93% -> 94.44%             
client [82] (test)  loss: 1.2711 -> 0.5426   acc: 56.00% -> 72.19%             
client [45] (test)  loss: 0.9508 -> 0.3360   acc: 69.16% -> 88.20%             
client [7] (test)  loss: 1.0492 -> 0.2271   acc: 66.62% -> 93.32%              
client [50] (test)  loss: 0.9961 -> 0.0880   acc: 72.16% -> 97.72%             
client [35] (test)  loss: 0.1260 -> 0.0098   acc: 96.62% -> 99.77%             
client [24] (test)  loss: 0.8342 -> 0.1824   acc: 72.44% -> 93.95%             
client [15] (test)  loss: 0.2414 -> 0.0191   acc: 94.05% -> 99.37%             
client [58] (test)  loss: 0.2151 -> 0.0105   acc: 93.50% -> 99.59%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.4050 -> 0.4964   acc: 36.80% -> 84.21%             
client [76] (test)  loss: 0.7072 -> 0.1654   acc: 79.61% -> 95.08%             
client [67] (test)  loss: 0.5703 -> 0.2693   acc: 79.32% -> 89.90%             
client [37] (test)  loss: 0.4018 -> 0.0257   acc: 86.79% -> 99.24%             
client [58] (test)  loss: 0.1008 -> 0.0104   acc: 97.14% -> 99.70%             
client [64] (test)  loss: 1.0045 -> 0.2508   acc: 66.29% -> 92.48%             
client [77] (test)  loss: 0.2863 -> 0.0835   acc: 92.09% -> 97.70%             
client [55] (test)  loss: 0.5828 -> 0.0788   acc: 84.27% -> 97.77%             
client [12] (test)  loss: 1.0243 -> 0.3247   acc: 71.75% -> 91.08%             
client [89] (test)  loss: 0.7468 -> 0.2508   acc: 71.54% -> 89.73%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.0070 -> 0.1526   acc: 73.78% -> 95.34%             
client [51] (test)  loss: 0.8008 -> 0.2506   acc: 76.80% -> 92.57%             
client [8] (test)  loss: 1.4622 -> 0.3060   acc: 61.91% -> 88.70%              
client [18] (test)  loss: 0.2424 -> 0.0266   acc: 93.88% -> 99.32%             
client [94] (test)  loss: 0.3792 -> 0.0017   acc: 90.83% -> 99.96%             
client [81] (test)  loss: 1.2381 -> 0.1406   acc: 62.45% -> 93.78%             
client [3] (test)  loss: 0.1127 -> 0.0126   acc: 96.95% -> 99.68%              
client [11] (test)  loss: 0.4762 -> 0.0782   acc: 86.96% -> 98.06%             
client [95] (test)  loss: 2.3812 -> 0.0981   acc: 34.96% -> 97.64%             
client [67] (test)  loss: 0.9341 -> 0.2650   acc: 70.65% -> 89.83%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2305 -> 0.0409   acc: 93.42% -> 98.81%             
client [79] (test)  loss: 1.0245 -> 0.2292   acc: 67.53% -> 93.03%             
client [58] (test)  loss: 0.1804 -> 0.0111   acc: 94.79% -> 99.59%             
client [88] (test)  loss: 0.9972 -> 0.2375   acc: 64.58% -> 90.91%             
client [46] (test)  loss: 0.4595 -> 0.0175   acc: 86.17% -> 99.58%             
client [11] (test)  loss: 0.4855 -> 0.0779   acc: 87.03% -> 98.11%             
client [55] (test)  loss: 0.6346 -> 0.0806   acc: 76.40% -> 97.68%             
client [13] (test)  loss: 0.3334 -> 0.0619   acc: 88.43% -> 98.54%             
client [31] (test)  loss: 0.2540 -> 0.1037   acc: 90.85% -> 96.27%             
client [75] (test)  loss: 0.8898 -> 0.2026   acc: 76.39% -> 94.77%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4434 -> 0.0537   acc: 88.26% -> 98.69%             
client [7] (test)  loss: 0.6864 -> 0.2279   acc: 80.62% -> 93.48%              
client [57] (test)  loss: 0.7551 -> 0.0997   acc: 74.23% -> 97.73%             
client [13] (test)  loss: 0.5114 -> 0.0624   acc: 84.43% -> 98.57%             
client [43] (test)  loss: 1.1581 -> 0.2832   acc: 65.54% -> 90.21%             
client [91] (test)  loss: 0.7097 -> 0.0604   acc: 73.34% -> 98.21%             
client [10] (test)  loss: 0.9396 -> 0.2696   acc: 62.63% -> 88.20%             
client [64] (test)  loss: 0.8821 -> 0.2562   acc: 73.31% -> 92.33%             
client [82] (test)  loss: 1.5743 -> 0.5377   acc: 47.17% -> 72.50%             
client [22] (test)  loss: 0.7768 -> 0.1343   acc: 79.47% -> 95.31%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4041 -> 0.0980   acc: 90.78% -> 97.53%             
client [23] (test)  loss: 0.4171 -> 0.0885   acc: 86.26% -> 97.34%             
client [88] (test)  loss: 0.8668 -> 0.2370   acc: 59.73% -> 91.21%             
client [98] (test)  loss: 0.2624 -> 0.0506   acc: 94.85% -> 99.20%             
client [79] (test)  loss: 0.6949 -> 0.2283   acc: 74.84% -> 93.03%             
client [21] (test)  loss: 0.5920 -> 0.0441   acc: 81.69% -> 98.74%             
client [92] (test)  loss: 1.2482 -> 0.0592   acc: 51.78% -> 98.63%             
client [56] (test)  loss: 0.7109 -> 0.0270   acc: 74.05% -> 99.29%             
client [5] (test)  loss: 0.7778 -> 0.1182   acc: 77.61% -> 96.88%              
client [52] (test)  loss: 0.8034 -> 0.3071   acc: 67.73% -> 87.66%             
==================== FedBN_join_0.1 TEST RESULTS: ====================         
{                                                                              
    100: {'loss': '0.8770 -> 0.0000', 'accuracy': '74.28% -> 0.00%'},          
    200: {'loss': '0.6701 -> 0.0000', 'accuracy': '77.79% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_join_0.1 achieved 30.0%(31.26%) at epoch: 2                              
FedBN_join_0.1 achieved 40.0%(45.09%) at epoch: 7                              
FedBN_join_0.1 achieved 50.0%(53.75%) at epoch: 10                             
FedBN_join_0.1 achieved 60.0%(62.88%) at epoch: 20                             
FedBN_join_0.1 achieved 70.0%(71.75%) at epoch: 24                             
FedBN_join_0.1 achieved 80.0%(80.21%) at epoch: 44                             
Convergence (test_after):                                                      
FedBN_join_0.1 achieved 90.0%(91.30%) at epoch: 0                              
