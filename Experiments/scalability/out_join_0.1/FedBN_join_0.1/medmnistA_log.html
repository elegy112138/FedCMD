==================== ALGORITHM: FedBN_join_0.1 ====================            
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.0406 -> 1.3275   acc: 0.00% -> 48.10%              
client [81] (test)  loss: 3.3800 -> 0.5724   acc: 0.00% -> 87.04%              
client [21] (test)  loss: 2.3757 -> 0.5737   acc: 0.15% -> 77.90%              
client [68] (test)  loss: 3.5139 -> 0.6327   acc: 0.00% -> 85.48%              
client [93] (test)  loss: 2.6648 -> 0.4098   acc: 0.00% -> 91.57%              
client [31] (test)  loss: 2.1202 -> 0.5948   acc: 0.00% -> 84.42%              
client [20] (test)  loss: 0.9207 -> 0.3972   acc: 73.19% -> 88.41%             
client [59] (test)  loss: 2.1312 -> 0.2828   acc: 21.47% -> 87.82%             
client [48] (test)  loss: 2.6440 -> 0.2704   acc: 0.00% -> 94.20%              
client [34] (test)  loss: 1.4399 -> 0.4417   acc: 56.22% -> 89.27%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.1118 -> 0.0250   acc: 30.12% -> 99.20%             
client [99] (test)  loss: 2.5331 -> 0.6859   acc: 31.48% -> 77.78%             
client [67] (test)  loss: 2.0579 -> 1.5157   acc: 10.34% -> 68.97%             
client [0] (test)  loss: 4.3377 -> 0.0656   acc: 0.84% -> 97.91%               
client [76] (test)  loss: 2.1695 -> 0.4270   acc: 8.81% -> 86.79%              
client [41] (test)  loss: 2.9925 -> 0.2857   acc: 0.00% -> 98.31%              
client [62] (test)  loss: 2.5760 -> 0.5631   acc: 0.00% -> 72.33%              
client [2] (test)  loss: 2.6214 -> 0.1652   acc: 4.68% -> 93.92%               
client [14] (test)  loss: 1.4167 -> 0.3273   acc: 48.80% -> 92.80%             
client [46] (test)  loss: 3.0479 -> 0.1864   acc: 17.62% -> 95.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.9989 -> 0.1067   acc: 16.33% -> 97.00%             
client [68] (test)  loss: 1.6511 -> 0.2000   acc: 35.31% -> 93.40%             
client [57] (test)  loss: 2.0742 -> 0.2642   acc: 20.21% -> 94.68%             
client [17] (test)  loss: 3.0199 -> 0.1584   acc: 4.72% -> 95.28%              
client [54] (test)  loss: 2.7339 -> 0.0115   acc: 4.78% -> 99.58%              
client [23] (test)  loss: 2.4911 -> 0.7062   acc: 19.51% -> 73.78%             
client [35] (test)  loss: 1.4797 -> 0.5265   acc: 46.43% -> 82.14%             
client [59] (test)  loss: 2.6894 -> 0.1562   acc: 14.42% -> 94.55%             
client [31] (test)  loss: 2.6703 -> 0.4427   acc: 6.49% -> 85.71%              
client [9] (test)  loss: 0.8325 -> 0.0163   acc: 76.64% -> 99.51%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.3571 -> 0.0994   acc: 7.46% -> 97.14%              
client [33] (test)  loss: 1.4060 -> 0.4736   acc: 56.25% -> 81.25%             
client [16] (test)  loss: 2.9067 -> 1.0963   acc: 3.92% -> 68.63%              
client [44] (test)  loss: 0.5286 -> 0.0351   acc: 84.43% -> 98.83%             
client [8] (test)  loss: 0.6318 -> 0.3651   acc: 78.52% -> 88.59%              
client [31] (test)  loss: 2.0519 -> 0.3999   acc: 32.47% -> 90.91%             
client [47] (test)  loss: 2.2911 -> 0.4861   acc: 36.84% -> 84.80%             
client [36] (test)  loss: 1.8941 -> 0.1262   acc: 21.19% -> 98.68%             
client [20] (test)  loss: 0.5221 -> 0.1762   acc: 75.36% -> 93.48%             
client [56] (test)  loss: 1.3357 -> 0.5758   acc: 55.81% -> 86.05%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.1532 -> 0.0389   acc: 20.18% -> 99.12%              
client [60] (test)  loss: 4.0341 -> 0.0746   acc: 17.65% -> 98.30%             
client [28] (test)  loss: 5.5968 -> 0.2351   acc: 5.71% -> 93.38%              
client [25] (test)  loss: 1.4013 -> 0.0824   acc: 49.19% -> 98.37%             
client [58] (test)  loss: 0.6456 -> 0.2391   acc: 71.43% -> 93.28%             
client [44] (test)  loss: 1.3903 -> 0.0263   acc: 51.06% -> 99.36%             
client [39] (test)  loss: 1.4912 -> 0.6031   acc: 37.50% -> 70.83%             
client [29] (test)  loss: 3.8041 -> 0.3325   acc: 12.81% -> 86.95%             
client [3] (test)  loss: 1.1942 -> 0.0796   acc: 53.06% -> 97.96%              
client [84] (test)  loss: 4.9488 -> 0.0199   acc: 0.00% -> 100.00%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.7136 -> 0.2894   acc: 34.93% -> 91.19%             
client [84] (test)  loss: 1.7374 -> 0.0264   acc: 41.10% -> 100.00%            
client [10] (test)  loss: 5.2087 -> 0.1154   acc: 2.60% -> 97.40%              
client [36] (test)  loss: 3.1996 -> 0.0979   acc: 27.15% -> 98.01%             
client [65] (test)  loss: 0.2438 -> 0.1840   acc: 93.95% -> 94.53%             
client [81] (test)  loss: 0.5266 -> 0.2604   acc: 81.48% -> 93.52%             
client [79] (test)  loss: 3.2224 -> 0.4276   acc: 18.29% -> 84.15%             
client [42] (test)  loss: 1.8153 -> 0.1889   acc: 38.22% -> 95.75%             
client [11] (test)  loss: 1.4427 -> 0.1983   acc: 54.63% -> 93.73%             
client [96] (test)  loss: 2.6473 -> 0.1917   acc: 36.12% -> 92.31%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.1966 -> 0.2713   acc: 61.74% -> 91.28%              
client [53] (test)  loss: 0.6686 -> 0.0062   acc: 73.85% -> 99.85%             
client [52] (test)  loss: 2.8819 -> 0.1247   acc: 18.75% -> 96.20%             
client [42] (test)  loss: 2.0897 -> 0.1883   acc: 40.54% -> 96.14%             
client [69] (test)  loss: 1.0539 -> 0.0041   acc: 60.64% -> 100.00%            
client [59] (test)  loss: 1.7289 -> 0.1130   acc: 37.18% -> 96.79%             
client [7] (test)  loss: 3.1006 -> 0.0146   acc: 20.09% -> 99.84%              
client [26] (test)  loss: 1.5061 -> 0.0880   acc: 57.14% -> 97.62%             
client [49] (test)  loss: 0.9458 -> 0.0746   acc: 68.75% -> 98.30%             
client [98] (test)  loss: 1.5115 -> 0.1402   acc: 51.64% -> 94.15%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.0068 -> 0.1337   acc: 69.19% -> 95.01%             
client [47] (test)  loss: 2.3914 -> 0.3589   acc: 36.84% -> 90.64%             
client [21] (test)  loss: 1.1903 -> 0.2742   acc: 60.12% -> 91.34%             
client [77] (test)  loss: 2.1751 -> 0.8428   acc: 34.81% -> 73.42%             
client [95] (test)  loss: 1.5586 -> 0.0598   acc: 36.85% -> 98.12%             
client [91] (test)  loss: 1.0514 -> 0.0331   acc: 60.83% -> 99.68%             
client [14] (test)  loss: 0.2588 -> 0.1861   acc: 93.60% -> 93.60%             
client [99] (test)  loss: 1.1786 -> 0.4795   acc: 60.19% -> 78.70%             
client [20] (test)  loss: 0.9473 -> 0.1181   acc: 60.14% -> 94.93%             
client [39] (test)  loss: 0.9998 -> 0.2790   acc: 58.33% -> 87.50%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.6550 -> 0.1026   acc: 11.68% -> 97.01%             
client [62] (test)  loss: 1.8118 -> 0.2667   acc: 42.33% -> 89.67%             
client [71] (test)  loss: 1.0983 -> 0.0907   acc: 65.55% -> 96.64%             
client [97] (test)  loss: 4.9235 -> 0.6296   acc: 14.29% -> 78.57%             
client [30] (test)  loss: 0.9520 -> 0.3362   acc: 57.95% -> 90.91%             
client [88] (test)  loss: 1.1342 -> 0.1210   acc: 63.28% -> 96.05%             
client [60] (test)  loss: 0.4318 -> 0.0575   acc: 86.07% -> 98.76%             
client [82] (test)  loss: 2.2736 -> 0.3621   acc: 32.85% -> 86.86%             
client [91] (test)  loss: 1.0996 -> 0.0299   acc: 64.65% -> 99.68%             
client [57] (test)  loss: 1.0392 -> 0.2151   acc: 63.83% -> 94.68%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2839 -> 0.2889   acc: 55.84% -> 92.21%             
client [15] (test)  loss: 3.4969 -> 0.1583   acc: 20.79% -> 95.71%             
client [71] (test)  loss: 0.3539 -> 0.0796   acc: 89.36% -> 96.92%             
client [97] (test)  loss: 5.7997 -> 0.6477   acc: 10.00% -> 79.29%             
client [53] (test)  loss: 2.0086 -> 0.0065   acc: 17.43% -> 99.69%             
client [77] (test)  loss: 4.4848 -> 0.7656   acc: 13.29% -> 71.52%             
client [76] (test)  loss: 0.7318 -> 0.1103   acc: 71.07% -> 96.23%             
client [79] (test)  loss: 1.3678 -> 0.3604   acc: 49.39% -> 87.20%             
client [28] (test)  loss: 3.9560 -> 0.1568   acc: 13.01% -> 95.43%             
client [99] (test)  loss: 1.6293 -> 0.4433   acc: 50.00% -> 81.48%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.0587 -> 0.6509   acc: 24.29% -> 78.57%             
client [86] (test)  loss: 0.9908 -> 0.5340   acc: 59.50% -> 85.95%             
client [34] (test)  loss: 0.5294 -> 0.1679   acc: 81.97% -> 95.28%             
client [73] (test)  loss: 1.7303 -> 0.0382   acc: 54.87% -> 99.12%             
client [5] (test)  loss: 1.6539 -> 0.4416   acc: 44.22% -> 84.42%              
client [96] (test)  loss: 2.5480 -> 0.1764   acc: 38.80% -> 93.65%             
client [22] (test)  loss: 0.1899 -> 0.0854   acc: 96.38% -> 97.10%             
client [60] (test)  loss: 0.5630 -> 0.0500   acc: 82.97% -> 98.61%             
client [66] (test)  loss: 1.6093 -> 0.0018   acc: 52.65% -> 100.00%            
client [83] (test)  loss: 1.5521 -> 0.0006   acc: 51.78% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2917 -> 0.0849   acc: 91.82% -> 97.48%             
client [65] (test)  loss: 1.0089 -> 0.1479   acc: 66.99% -> 94.73%             
client [95] (test)  loss: 0.9543 -> 0.0390   acc: 65.73% -> 99.06%             
client [17] (test)  loss: 2.6019 -> 0.0768   acc: 13.57% -> 97.64%             
client [8] (test)  loss: 0.5592 -> 0.2298   acc: 79.87% -> 89.93%              
client [35] (test)  loss: 0.6625 -> 0.2756   acc: 76.79% -> 91.07%             
client [98] (test)  loss: 1.0923 -> 0.1325   acc: 66.62% -> 95.58%             
client [53] (test)  loss: 0.2622 -> 0.0035   acc: 90.67% -> 100.00%            
client [43] (test)  loss: 1.3135 -> 0.4421   acc: 58.08% -> 84.72%             
client [64] (test)  loss: 1.1003 -> 0.0784   acc: 63.02% -> 97.94%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.1834 -> 0.2635   acc: 54.10% -> 92.27%             
client [88] (test)  loss: 0.6737 -> 0.1008   acc: 80.23% -> 96.05%             
client [38] (test)  loss: 0.5059 -> 0.1107   acc: 80.69% -> 97.03%             
client [3] (test)  loss: 1.7441 -> 0.0545   acc: 60.20% -> 97.96%              
client [5] (test)  loss: 1.5130 -> 0.4226   acc: 30.15% -> 85.43%              
client [41] (test)  loss: 1.8101 -> 0.0058   acc: 35.59% -> 100.00%            
client [7] (test)  loss: 0.6178 -> 0.0110   acc: 76.11% -> 99.53%              
client [37] (test)  loss: 0.6632 -> 0.1468   acc: 72.64% -> 97.32%             
client [45] (test)  loss: 3.0597 -> 0.1549   acc: 24.32% -> 94.83%             
client [47] (test)  loss: 0.7283 -> 0.3004   acc: 74.27% -> 91.81%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0600 -> 0.7598   acc: 52.94% -> 74.51%             
client [11] (test)  loss: 0.6606 -> 0.1509   acc: 77.01% -> 95.52%             
client [37] (test)  loss: 1.0002 -> 0.1499   acc: 57.97% -> 96.90%             
client [41] (test)  loss: 1.5148 -> 0.0012   acc: 47.46% -> 100.00%            
client [95] (test)  loss: 1.2132 -> 0.0343   acc: 63.62% -> 99.30%             
client [53] (test)  loss: 0.3468 -> 0.0048   acc: 88.23% -> 99.85%             
client [22] (test)  loss: 1.0252 -> 0.0841   acc: 65.22% -> 97.10%             
client [25] (test)  loss: 1.2251 -> 0.0531   acc: 58.54% -> 97.97%             
client [69] (test)  loss: 0.8516 -> 0.0028   acc: 73.90% -> 100.00%            
client [46] (test)  loss: 0.4562 -> 0.1359   acc: 83.31% -> 96.53%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.6430 -> 0.2954   acc: 43.86% -> 92.40%             
client [69] (test)  loss: 0.1938 -> 0.0022   acc: 93.57% -> 100.00%            
client [82] (test)  loss: 1.0972 -> 0.2931   acc: 53.28% -> 90.51%             
client [45] (test)  loss: 0.9772 -> 0.1626   acc: 72.04% -> 95.14%             
client [7] (test)  loss: 0.2033 -> 0.0112   acc: 91.46% -> 99.53%              
client [50] (test)  loss: 1.2260 -> 0.4463   acc: 62.09% -> 86.93%             
client [35] (test)  loss: 0.9270 -> 0.2454   acc: 66.07% -> 92.86%             
client [24] (test)  loss: 0.3524 -> 0.0389   acc: 88.33% -> 98.33%             
client [15] (test)  loss: 2.4535 -> 0.1364   acc: 28.38% -> 95.38%             
client [58] (test)  loss: 0.8378 -> 0.1495   acc: 72.27% -> 94.12%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0776 -> 0.0412   acc: 60.75% -> 98.98%             
client [76] (test)  loss: 0.2997 -> 0.0780   acc: 90.57% -> 98.11%             
client [67] (test)  loss: 0.2020 -> 0.0505   acc: 93.10% -> 100.00%            
client [37] (test)  loss: 0.6351 -> 0.1497   acc: 73.62% -> 97.32%             
client [58] (test)  loss: 1.0265 -> 0.1477   acc: 66.39% -> 94.96%             
client [64] (test)  loss: 1.5155 -> 0.0774   acc: 38.89% -> 97.78%             
client [77] (test)  loss: 1.4451 -> 0.7124   acc: 49.37% -> 71.52%             
client [55] (test)  loss: 0.6640 -> 0.0425   acc: 75.72% -> 99.24%             
client [12] (test)  loss: 0.9677 -> 0.3201   acc: 69.41% -> 85.88%             
client [89] (test)  loss: 0.6538 -> 0.0837   acc: 81.24% -> 98.07%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.0729 -> 0.0405   acc: 61.64% -> 98.63%             
client [51] (test)  loss: 0.3019 -> 0.1033   acc: 91.72% -> 96.82%             
client [8] (test)  loss: 0.4673 -> 0.2013   acc: 86.58% -> 89.93%              
client [18] (test)  loss: 0.7937 -> 0.2085   acc: 68.54% -> 93.90%             
client [94] (test)  loss: 2.2010 -> 0.2423   acc: 46.34% -> 92.68%             
client [81] (test)  loss: 1.7166 -> 0.1963   acc: 48.15% -> 94.44%             
client [3] (test)  loss: 0.1497 -> 0.0371   acc: 95.92% -> 98.98%              
client [11] (test)  loss: 0.6264 -> 0.1389   acc: 80.90% -> 96.12%             
client [95] (test)  loss: 0.6939 -> 0.0418   acc: 75.59% -> 99.06%             
client [67] (test)  loss: 0.2743 -> 0.0471   acc: 89.66% -> 100.00%            
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.9761 -> 0.2504   acc: 41.27% -> 92.58%             
client [79] (test)  loss: 0.7613 -> 0.3195   acc: 68.29% -> 90.85%             
client [58] (test)  loss: 1.2941 -> 0.1440   acc: 65.55% -> 95.80%             
client [88] (test)  loss: 1.7708 -> 0.0802   acc: 62.15% -> 97.18%             
client [46] (test)  loss: 1.2062 -> 0.1394   acc: 59.28% -> 96.53%             
client [11] (test)  loss: 0.3077 -> 0.1385   acc: 88.66% -> 95.82%             
client [55] (test)  loss: 1.1760 -> 0.0442   acc: 62.72% -> 99.24%             
client [13] (test)  loss: 0.2892 -> 0.1369   acc: 89.63% -> 94.07%             
client [31] (test)  loss: 0.6374 -> 0.2946   acc: 76.62% -> 92.21%             
client [75] (test)  loss: 0.7129 -> 0.1469   acc: 75.47% -> 94.34%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.4446 -> 0.0678   acc: 55.89% -> 97.22%             
client [7] (test)  loss: 0.3780 -> 0.0084   acc: 84.81% -> 99.53%              
client [57] (test)  loss: 1.7215 -> 0.1662   acc: 46.81% -> 96.81%             
client [13] (test)  loss: 1.0024 -> 0.1313   acc: 62.96% -> 95.56%             
client [43] (test)  loss: 1.9714 -> 0.3720   acc: 44.54% -> 87.77%             
client [91] (test)  loss: 0.2308 -> 0.0253   acc: 91.40% -> 99.68%             
client [10] (test)  loss: 2.0970 -> 0.0899   acc: 42.86% -> 96.10%             
client [64] (test)  loss: 0.0990 -> 0.0761   acc: 97.14% -> 97.62%             
client [82] (test)  loss: 0.4992 -> 0.2903   acc: 82.48% -> 89.05%             
client [22] (test)  loss: 0.3335 -> 0.0539   acc: 89.13% -> 98.55%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2830 -> 0.0509   acc: 89.13% -> 98.55%             
client [23] (test)  loss: 1.0911 -> 0.1535   acc: 69.51% -> 95.12%             
client [88] (test)  loss: 0.7562 -> 0.0753   acc: 77.40% -> 97.18%             
client [98] (test)  loss: 0.2864 -> 0.1183   acc: 91.30% -> 96.15%             
client [79] (test)  loss: 1.1787 -> 0.3204   acc: 59.76% -> 89.63%             
client [21] (test)  loss: 0.7217 -> 0.2417   acc: 75.43% -> 93.04%             
client [92] (test)  loss: 0.7060 -> 0.9425   acc: 71.43% -> 80.95%             
client [56] (test)  loss: 0.2833 -> 0.2471   acc: 95.35% -> 90.70%             
client [5] (test)  loss: 1.4732 -> 0.4017   acc: 44.72% -> 86.93%              
client [52] (test)  loss: 0.9653 -> 0.0701   acc: 68.75% -> 97.83%             
==================== FedBN_join_0.1 TEST RESULTS: ====================         
{                                                                              
    100: {'loss': '1.7000 -> 0.0000', 'accuracy': '52.39% -> 0.00%'},          
    200: {'loss': '0.7993 -> 0.0000', 'accuracy': '73.96% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_join_0.1 achieved 10.0%(11.21%) at epoch: 2                              
FedBN_join_0.1 achieved 20.0%(20.86%) at epoch: 4                              
FedBN_join_0.1 achieved 40.0%(44.69%) at epoch: 11                             
FedBN_join_0.1 achieved 50.0%(51.83%) at epoch: 39                             
FedBN_join_0.1 achieved 70.0%(71.76%) at epoch: 44                             
FedBN_join_0.1 achieved 80.0%(80.48%) at epoch: 178                            
Convergence (test_after):                                                      
FedBN_join_0.1 achieved 70.0%(76.17%) at epoch: 0                              
FedBN_join_0.1 achieved 80.0%(81.00%) at epoch: 1                              
FedBN_join_0.1 achieved 90.0%(92.00%) at epoch: 2                              
