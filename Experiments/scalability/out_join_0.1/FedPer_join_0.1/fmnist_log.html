==================== ALGORITHM: FedPer_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0005 -> 0.0007   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.7214 -> 0.4310   acc: 69.09% -> 82.73%             
client [21] (test)  loss: 23.9990 -> 0.3726   acc: 26.33% -> 86.47%            
client [68] (test)  loss: 0.2688 -> 0.1828   acc: 91.99% -> 94.77%             
client [93] (test)  loss: 0.5168 -> 0.1951   acc: 94.40% -> 96.80%             
client [31] (test)  loss: 0.6542 -> 0.2977   acc: 70.56% -> 92.78%             
client [20] (test)  loss: 0.1017 -> 0.0732   acc: 96.83% -> 96.83%             
client [59] (test)  loss: 16.8625 -> 0.4790   acc: 19.03% -> 84.19%            
client [48] (test)  loss: 0.0936 -> 0.1043   acc: 98.75% -> 98.75%             
client [34] (test)  loss: 0.8580 -> 0.3058   acc: 94.12% -> 92.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6191 -> 0.2160   acc: 32.27% -> 93.87%             
client [99] (test)  loss: 0.0922 -> 0.0942   acc: 98.01% -> 98.30%             
client [67] (test)  loss: 0.2211 -> 0.1666   acc: 93.15% -> 94.64%             
client [0] (test)  loss: 0.7444 -> 0.5847   acc: 75.70% -> 79.44%              
client [76] (test)  loss: 0.5450 -> 0.3542   acc: 92.11% -> 92.11%             
client [41] (test)  loss: 0.3154 -> 0.2904   acc: 89.12% -> 88.73%             
client [62] (test)  loss: 30.4247 -> 0.6231   acc: 33.33% -> 92.86%            
client [2] (test)  loss: 10.8168 -> 0.0009   acc: 46.95% -> 100.00%            
client [14] (test)  loss: 0.1316 -> 0.1027   acc: 96.38% -> 97.05%             
client [46] (test)  loss: 0.4511 -> 0.3148   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5066 -> 0.4534   acc: 79.53% -> 81.87%             
client [68] (test)  loss: 0.1276 -> 0.1166   acc: 95.47% -> 96.52%             
client [57] (test)  loss: 0.0308 -> 0.0272   acc: 99.06% -> 99.44%             
client [17] (test)  loss: 0.2125 -> 0.1545   acc: 91.99% -> 94.75%             
client [54] (test)  loss: 0.2160 -> 0.2150   acc: 91.71% -> 92.75%             
client [23] (test)  loss: 19.0847 -> 0.1378   acc: 21.80% -> 96.24%            
client [35] (test)  loss: 0.1609 -> 0.1713   acc: 95.15% -> 94.55%             
client [59] (test)  loss: 0.3924 -> 0.3404   acc: 85.81% -> 88.06%             
client [31] (test)  loss: 0.2537 -> 0.1810   acc: 91.67% -> 93.89%             
client [9] (test)  loss: 0.0374 -> 0.0358   acc: 98.34% -> 98.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2287 -> 0.1728   acc: 93.24% -> 95.00%             
client [33] (test)  loss: 0.1349 -> 0.0734   acc: 96.80% -> 97.03%             
client [16] (test)  loss: 0.0582 -> 0.0502   acc: 98.95% -> 98.95%             
client [44] (test)  loss: 0.2212 -> 0.1363   acc: 94.87% -> 95.97%             
client [8] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.2248 -> 0.1689   acc: 91.67% -> 93.33%             
client [47] (test)  loss: 0.0287 -> 0.0226   acc: 99.45% -> 99.45%             
client [36] (test)  loss: 0.0216 -> 0.0105   acc: 99.88% -> 99.63%             
client [20] (test)  loss: 0.0226 -> 0.0336   acc: 99.17% -> 99.00%             
client [56] (test)  loss: 0.3548 -> 0.3042   acc: 88.62% -> 89.43%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1381 -> 0.1072   acc: 96.89% -> 96.54%              
client [60] (test)  loss: 0.0963 -> 0.0981   acc: 97.29% -> 97.29%             
client [28] (test)  loss: 0.0763 -> 0.0512   acc: 97.32% -> 97.32%             
client [25] (test)  loss: 0.1577 -> 0.1218   acc: 96.52% -> 95.82%             
client [58] (test)  loss: 0.1576 -> 0.0873   acc: 94.53% -> 97.08%             
client [44] (test)  loss: 0.1738 -> 0.1293   acc: 96.70% -> 96.34%             
client [39] (test)  loss: 0.1452 -> 0.1523   acc: 94.44% -> 94.44%             
client [29] (test)  loss: 0.3426 -> 0.2750   acc: 87.21% -> 90.87%             
client [3] (test)  loss: 0.4959 -> 0.1483   acc: 81.88% -> 95.11%              
client [84] (test)  loss: 0.0433 -> 0.0407   acc: 99.08% -> 99.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4307 -> 0.2354   acc: 82.61% -> 91.06%             
client [84] (test)  loss: 0.0413 -> 0.0398   acc: 99.54% -> 99.54%             
client [10] (test)  loss: 0.0756 -> 0.0659   acc: 95.65% -> 96.38%             
client [36] (test)  loss: 0.0058 -> 0.0056   acc: 99.88% -> 99.88%             
client [65] (test)  loss: 0.2423 -> 0.2172   acc: 92.86% -> 95.24%             
client [81] (test)  loss: 0.0970 -> 0.1122   acc: 95.45% -> 96.36%             
client [79] (test)  loss: 0.3343 -> 0.3562   acc: 85.75% -> 86.49%             
client [42] (test)  loss: 0.0384 -> 0.0333   acc: 98.93% -> 98.99%             
client [11] (test)  loss: 0.3738 -> 0.3885   acc: 83.33% -> 85.33%             
client [96] (test)  loss: 0.2212 -> 0.2521   acc: 92.13% -> 91.85%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.0351 -> 0.0368   acc: 99.19% -> 99.19%             
client [52] (test)  loss: 0.2575 -> 0.2360   acc: 88.37% -> 89.15%             
client [42] (test)  loss: 0.0302 -> 0.0331   acc: 98.93% -> 98.99%             
client [69] (test)  loss: 0.5830 -> 0.1372   acc: 81.87% -> 95.73%             
client [59] (test)  loss: 0.3121 -> 0.2832   acc: 89.68% -> 90.65%             
client [7] (test)  loss: 0.0516 -> 0.0450   acc: 98.16% -> 98.34%              
client [26] (test)  loss: 0.0103 -> 0.0073   acc: 99.84% -> 99.84%             
client [49] (test)  loss: 0.0006 -> 0.0007   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.5026 -> 0.4105   acc: 77.00% -> 84.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4601 -> 0.3054   acc: 76.00% -> 90.00%             
client [47] (test)  loss: 0.0229 -> 0.0195   acc: 99.45% -> 99.63%             
client [21] (test)  loss: 0.2691 -> 0.1917   acc: 88.89% -> 92.03%             
client [77] (test)  loss: 0.0011 -> 0.0007   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.2106 -> 0.1531   acc: 92.48% -> 93.98%             
client [91] (test)  loss: 0.0272 -> 0.0164   acc: 100.00% -> 100.00%           
client [14] (test)  loss: 0.1114 -> 0.1046   acc: 97.45% -> 97.45%             
client [99] (test)  loss: 0.0937 -> 0.0813   acc: 98.01% -> 98.58%             
client [20] (test)  loss: 0.0115 -> 0.0233   acc: 99.50% -> 99.17%             
client [39] (test)  loss: 0.1470 -> 0.1447   acc: 91.67% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2308 -> 0.2255   acc: 89.15% -> 89.92%             
client [62] (test)  loss: 0.2079 -> 0.2081   acc: 92.86% -> 92.86%             
client [71] (test)  loss: 0.0452 -> 0.0393   acc: 98.55% -> 98.19%             
client [97] (test)  loss: 0.0633 -> 0.0586   acc: 98.69% -> 99.01%             
client [30] (test)  loss: 0.1083 -> 0.1123   acc: 97.00% -> 96.63%             
client [88] (test)  loss: 0.4748 -> 0.4969   acc: 81.77% -> 80.11%             
client [60] (test)  loss: 0.0923 -> 0.0876   acc: 97.10% -> 97.87%             
client [82] (test)  loss: 0.0268 -> 0.0261   acc: 99.68% -> 99.68%             
client [91] (test)  loss: 0.0057 -> 0.0054   acc: 100.00% -> 100.00%           
client [57] (test)  loss: 0.0228 -> 0.0247   acc: 99.62% -> 99.62%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2507 -> 0.1426   acc: 90.56% -> 92.22%             
client [15] (test)  loss: 0.1258 -> 0.1988   acc: 94.48% -> 92.36%             
client [71] (test)  loss: 0.0420 -> 0.0385   acc: 98.19% -> 98.37%             
client [97] (test)  loss: 0.0601 -> 0.0563   acc: 98.85% -> 99.01%             
client [53] (test)  loss: 0.0345 -> 0.0376   acc: 99.39% -> 99.29%             
client [77] (test)  loss: 0.0007 -> 0.0007   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.1475 -> 0.1300   acc: 94.74% -> 94.74%             
client [79] (test)  loss: 0.3172 -> 0.3356   acc: 85.75% -> 86.73%             
client [28] (test)  loss: 0.0464 -> 0.0325   acc: 98.21% -> 98.21%             
client [99] (test)  loss: 0.0784 -> 0.0773   acc: 98.58% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0630 -> 0.0573   acc: 98.69% -> 99.01%             
client [86] (test)  loss: 0.1097 -> 0.1237   acc: 100.00% -> 96.49%            
client [34] (test)  loss: 0.0786 -> 0.0680   acc: 97.06% -> 97.06%             
client [73] (test)  loss: 0.0274 -> 0.0257   acc: 99.64% -> 99.64%             
client [5] (test)  loss: 0.0374 -> 0.0366   acc: 98.91% -> 98.91%              
client [96] (test)  loss: 0.1931 -> 0.2158   acc: 94.38% -> 93.82%             
client [22] (test)  loss: 0.0700 -> 0.0671   acc: 98.58% -> 97.64%             
client [60] (test)  loss: 0.0857 -> 0.0835   acc: 97.49% -> 97.87%             
client [66] (test)  loss: 0.0010 -> 0.0006   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0347 -> 0.0383   acc: 98.73% -> 98.73%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1467 -> 0.1250   acc: 94.74% -> 94.74%             
client [65] (test)  loss: 0.3148 -> 0.2223   acc: 91.67% -> 95.24%             
client [95] (test)  loss: 0.1597 -> 0.1328   acc: 93.98% -> 95.49%             
client [17] (test)  loss: 0.1591 -> 0.1177   acc: 95.30% -> 95.86%             
client [8] (test)  loss: 0.0005 -> 0.0002   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.1204 -> 0.1694   acc: 95.15% -> 95.15%             
client [98] (test)  loss: 0.2457 -> 0.2456   acc: 88.00% -> 90.00%             
client [53] (test)  loss: 0.0329 -> 0.0375   acc: 99.39% -> 99.29%             
client [43] (test)  loss: 0.1443 -> 0.1291   acc: 94.81% -> 95.56%             
client [64] (test)  loss: 0.1716 -> 0.1235   acc: 94.71% -> 96.76%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3106 -> 0.1768   acc: 87.20% -> 92.27%             
client [88] (test)  loss: 0.4482 -> 0.3787   acc: 82.32% -> 82.87%             
client [38] (test)  loss: 0.3957 -> 0.3981   acc: 86.67% -> 87.27%             
client [3] (test)  loss: 0.2483 -> 0.1458   acc: 92.39% -> 95.29%              
client [5] (test)  loss: 0.0376 -> 0.0353   acc: 98.91% -> 98.91%              
client [41] (test)  loss: 0.2435 -> 0.1954   acc: 92.88% -> 93.78%             
client [7] (test)  loss: 0.0420 -> 0.0392   acc: 97.97% -> 98.53%              
client [37] (test)  loss: 0.0964 -> 0.0976   acc: 96.39% -> 95.88%             
client [45] (test)  loss: 0.2944 -> 0.3316   acc: 91.03% -> 89.74%             
client [47] (test)  loss: 0.0164 -> 0.0172   acc: 99.45% -> 99.45%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0288 -> 0.0270   acc: 99.30% -> 98.95%             
client [11] (test)  loss: 0.3386 -> 0.2969   acc: 86.44% -> 88.00%             
client [37] (test)  loss: 0.1097 -> 0.1085   acc: 97.42% -> 95.36%             
client [41] (test)  loss: 0.2585 -> 0.1905   acc: 92.36% -> 93.65%             
client [95] (test)  loss: 0.1678 -> 0.1239   acc: 94.74% -> 95.49%             
client [53] (test)  loss: 0.0372 -> 0.0383   acc: 99.29% -> 99.19%             
client [22] (test)  loss: 0.1097 -> 0.0619   acc: 98.11% -> 98.11%             
client [25] (test)  loss: 0.0951 -> 0.0824   acc: 97.21% -> 96.86%             
client [69] (test)  loss: 0.7229 -> 0.1233   acc: 80.80% -> 95.20%             
client [46] (test)  loss: 0.2733 -> 0.2578   acc: 91.19% -> 91.63%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0167 -> 0.0152   acc: 99.26% -> 99.26%             
client [69] (test)  loss: 0.4090 -> 0.1258   acc: 89.07% -> 96.27%             
client [82] (test)  loss: 0.0279 -> 0.0295   acc: 99.68% -> 99.68%             
client [45] (test)  loss: 0.2912 -> 0.3166   acc: 91.03% -> 91.03%             
client [7] (test)  loss: 0.0411 -> 0.0406   acc: 98.34% -> 98.53%              
client [50] (test)  loss: 0.0010 -> 0.0008   acc: 100.00% -> 100.00%           
client [35] (test)  loss: 0.1247 -> 0.1699   acc: 95.15% -> 95.15%             
client [24] (test)  loss: 0.5602 -> 0.5044   acc: 81.35% -> 83.16%             
client [15] (test)  loss: 0.1079 -> 0.2156   acc: 95.12% -> 91.30%             
client [58] (test)  loss: 0.0637 -> 0.0620   acc: 98.18% -> 97.81%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0566 -> 0.0714   acc: 98.75% -> 98.12%             
client [76] (test)  loss: 0.1632 -> 0.1310   acc: 94.74% -> 94.74%             
client [67] (test)  loss: 0.1688 -> 0.1450   acc: 94.94% -> 95.98%             
client [37] (test)  loss: 0.1205 -> 0.1104   acc: 95.36% -> 95.36%             
client [58] (test)  loss: 0.0649 -> 0.0611   acc: 97.99% -> 97.45%             
client [64] (test)  loss: 0.1872 -> 0.1371   acc: 94.71% -> 96.18%             
client [77] (test)  loss: 0.0007 -> 0.0010   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.0118 -> 0.0108   acc: 99.81% -> 99.81%             
client [12] (test)  loss: 0.3350 -> 0.3111   acc: 89.76% -> 90.61%             
client [89] (test)  loss: 0.6875 -> 0.6518   acc: 80.95% -> 80.95%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0355 -> 0.0377   acc: 99.54% -> 99.54%             
client [51] (test)  loss: 0.0339 -> 0.0215   acc: 99.23% -> 99.49%             
client [8] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.0128 -> 0.0123   acc: 99.76% -> 99.76%             
client [94] (test)  loss: 0.2573 -> 0.1487   acc: 91.84% -> 95.04%             
client [81] (test)  loss: 0.0319 -> 0.0727   acc: 100.00% -> 96.36%            
client [3] (test)  loss: 0.1565 -> 0.1454   acc: 94.57% -> 95.65%              
client [11] (test)  loss: 0.4270 -> 0.2678   acc: 83.78% -> 90.67%             
client [95] (test)  loss: 0.2035 -> 0.1346   acc: 94.74% -> 96.24%             
client [67] (test)  loss: 0.1414 -> 0.1420   acc: 95.68% -> 96.43%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2691 -> 0.1599   acc: 89.61% -> 92.75%             
client [79] (test)  loss: 0.2822 -> 0.3152   acc: 87.96% -> 87.71%             
client [58] (test)  loss: 0.0600 -> 0.0595   acc: 97.81% -> 97.63%             
client [88] (test)  loss: 0.5675 -> 0.3905   acc: 78.45% -> 83.43%             
client [46] (test)  loss: 0.2944 -> 0.2652   acc: 90.75% -> 91.19%             
client [11] (test)  loss: 0.4802 -> 0.2800   acc: 81.78% -> 88.22%             
client [55] (test)  loss: 0.0157 -> 0.0109   acc: 99.81% -> 99.81%             
client [13] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [31] (test)  loss: 0.3444 -> 0.1372   acc: 88.89% -> 94.44%             
client [75] (test)  loss: 0.2181 -> 0.2104   acc: 90.56% -> 91.28%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3275 -> 0.3238   acc: 86.61% -> 88.19%             
client [7] (test)  loss: 0.0366 -> 0.0372   acc: 98.53% -> 99.08%              
client [57] (test)  loss: 0.0252 -> 0.0256   acc: 99.62% -> 99.62%             
client [13] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [43] (test)  loss: 0.1140 -> 0.1117   acc: 95.56% -> 96.30%             
client [91] (test)  loss: 0.0036 -> 0.0038   acc: 100.00% -> 100.00%           
client [10] (test)  loss: 0.0343 -> 0.0256   acc: 98.55% -> 98.55%             
client [64] (test)  loss: 0.1739 -> 0.1486   acc: 94.41% -> 96.47%             
client [82] (test)  loss: 0.0294 -> 0.0300   acc: 99.68% -> 99.68%             
client [22] (test)  loss: 0.0637 -> 0.0729   acc: 98.11% -> 97.64%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0189 -> 0.0219   acc: 99.50% -> 99.50%             
client [23] (test)  loss: 0.0897 -> 0.0924   acc: 97.74% -> 96.99%             
client [88] (test)  loss: 0.4568 -> 0.4009   acc: 80.66% -> 84.53%             
client [98] (test)  loss: 0.2271 -> 0.2305   acc: 92.00% -> 91.00%             
client [79] (test)  loss: 0.3052 -> 0.3139   acc: 87.96% -> 87.96%             
client [21] (test)  loss: 0.3276 -> 0.1591   acc: 88.16% -> 92.51%             
client [92] (test)  loss: 0.1698 -> 0.1601   acc: 93.49% -> 94.52%             
client [56] (test)  loss: 0.3323 -> 0.3114   acc: 90.24% -> 90.65%             
client [5] (test)  loss: 0.0283 -> 0.0311   acc: 99.13% -> 99.13%              
client [52] (test)  loss: 0.2510 -> 0.1675   acc: 86.82% -> 93.80%             
==================== FedPer_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '0.1242 -> 0.0000', 'accuracy': '95.84% -> 0.00%'},          
    200: {'loss': '0.1233 -> 0.0000', 'accuracy': '96.00% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_join_0.1 achieved 10.0%(11.19%) at epoch: 0                             
FedPer_join_0.1 achieved 20.0%(22.79%) at epoch: 1                             
FedPer_join_0.1 achieved 60.0%(65.39%) at epoch: 4                             
FedPer_join_0.1 achieved 80.0%(82.59%) at epoch: 7                             
FedPer_join_0.1 achieved 90.0%(90.67%) at epoch: 16                            
Convergence (test_after):                                                      
FedPer_join_0.1 achieved 70.0%(79.84%) at epoch: 0                             
FedPer_join_0.1 achieved 90.0%(92.18%) at epoch: 2                             
