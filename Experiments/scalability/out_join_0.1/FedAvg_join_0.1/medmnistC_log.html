==================== ALGORITHM: FedAvg_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.9343 -> 0.6579   acc: 33.04% -> 75.65%             
client [81] (test)  loss: 2.3341 -> 1.7622   acc: 17.39% -> 43.48%             
client [21] (test)  loss: 2.5203 -> 2.1317   acc: 0.00% -> 41.38%              
client [68] (test)  loss: 1.8875 -> 0.2756   acc: 6.12% -> 89.80%              
client [93] (test)  loss: 2.5345 -> 0.7186   acc: 2.20% -> 81.32%              
client [31] (test)  loss: 2.5994 -> 0.5920   acc: 1.11% -> 86.67%              
client [20] (test)  loss: 1.8277 -> 0.5391   acc: 43.48% -> 84.35%             
client [59] (test)  loss: 2.2244 -> 0.2921   acc: 11.48% -> 96.72%             
client [48] (test)  loss: 1.5336 -> 0.4795   acc: 60.68% -> 86.32%             
client [34] (test)  loss: 2.1520 -> 0.9818   acc: 29.27% -> 73.98%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.5716 -> 0.1954   acc: 9.72% -> 93.35%              
client [99] (test)  loss: 2.8059 -> 0.2425   acc: 0.78% -> 95.31%              
client [67] (test)  loss: 1.4962 -> 0.1691   acc: 75.82% -> 97.80%             
client [0] (test)  loss: 2.0899 -> 0.9268   acc: 27.12% -> 79.66%              
client [76] (test)  loss: 2.1038 -> 0.7789   acc: 30.56% -> 69.44%             
client [41] (test)  loss: 2.5883 -> 0.4693   acc: 2.91% -> 85.44%              
client [62] (test)  loss: 2.4196 -> 0.0353   acc: 0.00% -> 100.00%             
client [2] (test)  loss: 2.3360 -> 0.5506   acc: 0.00% -> 86.99%               
client [14] (test)  loss: 1.7407 -> 0.9453   acc: 52.11% -> 66.20%             
client [46] (test)  loss: 3.0891 -> 0.6994   acc: 6.33% -> 79.75%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9819 -> 0.2120   acc: 74.19% -> 91.94%             
client [68] (test)  loss: 1.4195 -> 0.2088   acc: 46.94% -> 90.31%             
client [57] (test)  loss: 1.3821 -> 0.3831   acc: 50.00% -> 89.83%             
client [17] (test)  loss: 2.2844 -> 0.6016   acc: 1.06% -> 79.79%              
client [54] (test)  loss: 2.3776 -> 0.7963   acc: 36.52% -> 73.91%             
client [23] (test)  loss: 2.1726 -> 1.1894   acc: 35.19% -> 79.63%             
client [35] (test)  loss: 2.1813 -> 0.4969   acc: 0.00% -> 89.29%              
client [59] (test)  loss: 0.8303 -> 0.0627   acc: 82.79% -> 97.54%             
client [31] (test)  loss: 2.3191 -> 0.3548   acc: 7.78% -> 92.22%              
client [9] (test)  loss: 1.5916 -> 0.2596   acc: 57.14% -> 95.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1509 -> 0.2338   acc: 84.21% -> 96.49%             
client [33] (test)  loss: 1.8556 -> 0.3738   acc: 37.29% -> 89.83%             
client [16] (test)  loss: 2.0648 -> 0.8095   acc: 13.51% -> 75.68%             
client [44] (test)  loss: 1.4317 -> 0.1652   acc: 44.44% -> 94.20%             
client [8] (test)  loss: 1.8609 -> 0.7627   acc: 24.66% -> 56.16%              
client [31] (test)  loss: 2.0494 -> 0.3152   acc: 5.56% -> 93.33%              
client [47] (test)  loss: 2.6337 -> 0.1137   acc: 22.67% -> 97.33%             
client [36] (test)  loss: 1.6290 -> 0.2796   acc: 24.57% -> 91.43%             
client [20] (test)  loss: 3.4581 -> 0.3087   acc: 0.00% -> 87.83%              
client [56] (test)  loss: 1.8537 -> 0.2902   acc: 23.26% -> 97.67%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6731 -> 0.2080   acc: 73.08% -> 96.15%              
client [60] (test)  loss: 1.7142 -> 0.3082   acc: 13.33% -> 93.33%             
client [28] (test)  loss: 1.6635 -> 0.7765   acc: 48.00% -> 84.00%             
client [25] (test)  loss: 2.9198 -> 0.6148   acc: 10.34% -> 79.31%             
client [58] (test)  loss: 5.3597 -> 0.2343   acc: 0.00% -> 96.30%              
client [44] (test)  loss: 4.1577 -> 0.1299   acc: 2.90% -> 97.10%              
client [39] (test)  loss: 3.4236 -> 0.4935   acc: 3.20% -> 81.60%              
client [29] (test)  loss: 3.6753 -> 0.6006   acc: 3.57% -> 80.36%              
client [3] (test)  loss: 3.4285 -> 0.0632   acc: 2.44% -> 98.37%               
client [84] (test)  loss: 2.9928 -> 0.9378   acc: 9.76% -> 73.17%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.1149 -> 1.4310   acc: 6.90% -> 44.83%              
client [84] (test)  loss: 1.5183 -> 0.9151   acc: 60.98% -> 75.61%             
client [10] (test)  loss: 1.9706 -> 0.2485   acc: 18.95% -> 90.53%             
client [36] (test)  loss: 1.0523 -> 0.2074   acc: 52.00% -> 93.71%             
client [65] (test)  loss: 1.4374 -> 0.2234   acc: 50.83% -> 93.33%             
client [81] (test)  loss: 1.1366 -> 0.9903   acc: 65.22% -> 60.87%             
client [79] (test)  loss: 1.3924 -> 0.0869   acc: 44.30% -> 97.99%             
client [42] (test)  loss: 1.1549 -> 0.2493   acc: 62.64% -> 93.96%             
client [11] (test)  loss: 1.5051 -> 0.3222   acc: 42.55% -> 89.36%             
client [96] (test)  loss: 2.6225 -> 0.2032   acc: 8.82% -> 94.12%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.9782 -> 0.4161   acc: 13.70% -> 82.19%              
client [53] (test)  loss: 1.2155 -> 0.1451   acc: 62.32% -> 95.65%             
client [52] (test)  loss: 1.7139 -> 0.5492   acc: 41.03% -> 74.36%             
client [42] (test)  loss: 2.1902 -> 0.2312   acc: 23.02% -> 93.58%             
client [69] (test)  loss: 1.5794 -> 0.1272   acc: 40.41% -> 95.14%             
client [59] (test)  loss: 2.9137 -> 0.0527   acc: 1.64% -> 98.36%              
client [7] (test)  loss: 2.4968 -> 0.5226   acc: 27.59% -> 88.51%              
client [26] (test)  loss: 1.1478 -> 0.0872   acc: 53.10% -> 97.24%             
client [49] (test)  loss: 0.4734 -> 0.1165   acc: 86.96% -> 96.70%             
client [98] (test)  loss: 1.6744 -> 0.1446   acc: 36.49% -> 94.59%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.6025 -> 0.1346   acc: 35.14% -> 94.59%             
client [47] (test)  loss: 1.0219 -> 0.0903   acc: 57.33% -> 98.67%             
client [21] (test)  loss: 2.3511 -> 1.0275   acc: 6.90% -> 58.62%              
client [77] (test)  loss: 2.0887 -> 0.2436   acc: 30.43% -> 92.17%             
client [95] (test)  loss: 1.9314 -> 0.1325   acc: 32.14% -> 95.24%             
client [91] (test)  loss: 1.3166 -> 0.7235   acc: 56.25% -> 77.78%             
client [14] (test)  loss: 1.6628 -> 0.5425   acc: 36.62% -> 76.06%             
client [99] (test)  loss: 1.4750 -> 0.1352   acc: 49.22% -> 94.53%             
client [20] (test)  loss: 2.0068 -> 0.2166   acc: 28.70% -> 92.17%             
client [39] (test)  loss: 1.0085 -> 0.3527   acc: 62.40% -> 87.20%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.3630 -> 0.5521   acc: 17.95% -> 69.23%             
client [62] (test)  loss: 1.2692 -> 0.0037   acc: 64.43% -> 100.00%            
client [71] (test)  loss: 1.9335 -> 0.0572   acc: 39.84% -> 98.37%             
client [97] (test)  loss: 1.6520 -> 0.5137   acc: 47.17% -> 83.02%             
client [30] (test)  loss: 2.2031 -> 0.1321   acc: 24.60% -> 97.33%             
client [88] (test)  loss: 1.9478 -> 0.5424   acc: 43.75% -> 80.21%             
client [60] (test)  loss: 1.5889 -> 0.1536   acc: 42.22% -> 95.56%             
client [82] (test)  loss: 1.4527 -> 0.0666   acc: 43.68% -> 98.28%             
client [91] (test)  loss: 1.6116 -> 0.6735   acc: 46.53% -> 81.94%             
client [57] (test)  loss: 1.1953 -> 0.2224   acc: 54.24% -> 93.22%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.9396 -> 0.1934   acc: 33.33% -> 95.56%             
client [15] (test)  loss: 0.6904 -> 0.2124   acc: 81.40% -> 91.86%             
client [71] (test)  loss: 1.6787 -> 0.0405   acc: 52.03% -> 99.19%             
client [97] (test)  loss: 1.2584 -> 0.5111   acc: 51.57% -> 83.02%             
client [53] (test)  loss: 1.0227 -> 0.1527   acc: 50.72% -> 95.65%             
client [77] (test)  loss: 1.7971 -> 0.2287   acc: 46.96% -> 93.04%             
client [76] (test)  loss: 0.3658 -> 0.1905   acc: 91.67% -> 100.00%            
client [79] (test)  loss: 1.6047 -> 0.0708   acc: 46.98% -> 97.99%             
client [28] (test)  loss: 0.9276 -> 0.6692   acc: 64.00% -> 76.00%             
client [99] (test)  loss: 1.2003 -> 0.1114   acc: 63.28% -> 96.09%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.9971 -> 0.4802   acc: 69.81% -> 84.28%             
client [86] (test)  loss: 1.2059 -> 0.3649   acc: 68.39% -> 89.08%             
client [34] (test)  loss: 1.3501 -> 0.4003   acc: 55.28% -> 89.43%             
client [73] (test)  loss: 0.6277 -> 0.2660   acc: 79.37% -> 93.65%             
client [5] (test)  loss: 0.7308 -> 1.2619   acc: 68.57% -> 80.00%              
client [96] (test)  loss: 1.5628 -> 0.1698   acc: 47.06% -> 95.59%             
client [22] (test)  loss: 0.7183 -> 0.2977   acc: 76.27% -> 91.53%             
client [60] (test)  loss: 1.1399 -> 0.1517   acc: 57.78% -> 95.56%             
client [66] (test)  loss: 1.1599 -> 0.2865   acc: 65.71% -> 94.29%             
client [83] (test)  loss: 1.1727 -> 0.0118   acc: 53.85% -> 99.23%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4238 -> 0.1856   acc: 86.11% -> 97.22%             
client [65] (test)  loss: 1.6795 -> 0.1454   acc: 40.83% -> 95.00%             
client [95] (test)  loss: 2.0839 -> 0.1552   acc: 32.14% -> 95.24%             
client [17] (test)  loss: 1.6258 -> 0.2991   acc: 40.43% -> 91.49%             
client [8] (test)  loss: 0.9684 -> 0.1810   acc: 60.27% -> 94.52%              
client [35] (test)  loss: 1.1925 -> 0.1072   acc: 53.57% -> 96.43%             
client [98] (test)  loss: 1.7817 -> 0.1277   acc: 27.03% -> 95.95%             
client [53] (test)  loss: 0.8971 -> 0.1373   acc: 65.22% -> 95.65%             
client [43] (test)  loss: 0.1001 -> 0.0262   acc: 100.00% -> 100.00%           
client [64] (test)  loss: 0.5552 -> 0.1885   acc: 80.70% -> 96.49%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.9773 -> 0.6777   acc: 34.48% -> 75.86%             
client [88] (test)  loss: 1.5204 -> 0.5206   acc: 54.17% -> 80.21%             
client [38] (test)  loss: 0.1432 -> 0.0333   acc: 99.19% -> 99.19%             
client [3] (test)  loss: 2.2108 -> 0.0334   acc: 26.83% -> 99.19%              
client [5] (test)  loss: 0.6724 -> 0.8846   acc: 77.14% -> 77.14%              
client [41] (test)  loss: 0.7455 -> 0.0978   acc: 75.73% -> 99.03%             
client [7] (test)  loss: 1.7004 -> 0.4528   acc: 54.02% -> 90.80%              
client [37] (test)  loss: 0.9249 -> 0.0583   acc: 64.75% -> 98.03%             
client [45] (test)  loss: 0.7620 -> 0.1219   acc: 71.37% -> 96.92%             
client [47] (test)  loss: 0.2375 -> 0.0502   acc: 93.33% -> 97.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.1065 -> 0.2941   acc: 16.22% -> 91.89%             
client [11] (test)  loss: 1.2817 -> 0.2395   acc: 55.32% -> 91.49%             
client [37] (test)  loss: 0.9039 -> 0.0559   acc: 76.40% -> 98.46%             
client [41] (test)  loss: 0.9816 -> 0.1132   acc: 66.02% -> 98.06%             
client [95] (test)  loss: 2.4533 -> 0.1961   acc: 22.62% -> 95.24%             
client [53] (test)  loss: 0.8843 -> 0.1070   acc: 63.77% -> 98.55%             
client [22] (test)  loss: 1.2244 -> 0.3184   acc: 55.93% -> 88.14%             
client [25] (test)  loss: 2.3953 -> 0.3948   acc: 37.93% -> 86.21%             
client [69] (test)  loss: 3.7982 -> 0.0949   acc: 9.97% -> 96.68%              
client [46] (test)  loss: 0.5580 -> 0.1501   acc: 86.08% -> 94.94%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7264 -> 0.0510   acc: 74.67% -> 97.33%             
client [69] (test)  loss: 3.2097 -> 0.0961   acc: 23.53% -> 96.93%             
client [82] (test)  loss: 0.3338 -> 0.0635   acc: 90.80% -> 98.85%             
client [45] (test)  loss: 1.9221 -> 0.1180   acc: 27.75% -> 97.80%             
client [7] (test)  loss: 2.2333 -> 0.4517   acc: 33.33% -> 90.80%              
client [50] (test)  loss: 0.7540 -> 0.2140   acc: 80.00% -> 93.33%             
client [35] (test)  loss: 0.7710 -> 0.1398   acc: 75.00% -> 96.43%             
client [24] (test)  loss: 0.6437 -> 0.0653   acc: 80.65% -> 97.58%             
client [15] (test)  loss: 2.6711 -> 0.1724   acc: 10.47% -> 95.35%             
client [58] (test)  loss: 0.2949 -> 0.0387   acc: 88.89% -> 100.00%            
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8995 -> 0.2022   acc: 67.52% -> 93.16%             
client [76] (test)  loss: 0.1679 -> 0.1450   acc: 94.44% -> 94.44%             
client [67] (test)  loss: 3.9644 -> 0.0763   acc: 2.20% -> 98.90%              
client [37] (test)  loss: 0.5883 -> 0.0498   acc: 81.46% -> 98.46%             
client [58] (test)  loss: 1.2377 -> 0.0482   acc: 62.96% -> 100.00%            
client [64] (test)  loss: 0.4853 -> 0.1935   acc: 80.70% -> 96.49%             
client [77] (test)  loss: 0.9552 -> 0.1686   acc: 66.96% -> 93.04%             
client [55] (test)  loss: 1.2805 -> 0.3112   acc: 67.35% -> 91.84%             
client [12] (test)  loss: 0.3270 -> 0.0049   acc: 88.27% -> 100.00%            
client [89] (test)  loss: 0.5518 -> 0.2202   acc: 85.09% -> 92.98%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1262 -> 0.8766   acc: 65.85% -> 78.05%             
client [51] (test)  loss: 1.6456 -> 0.2367   acc: 61.90% -> 90.48%             
client [8] (test)  loss: 1.0120 -> 0.1623   acc: 75.34% -> 95.89%              
client [18] (test)  loss: 0.8429 -> 0.2001   acc: 73.02% -> 94.44%             
client [94] (test)  loss: 1.2934 -> 0.2214   acc: 60.98% -> 91.29%             
client [81] (test)  loss: 1.5756 -> 1.0136   acc: 65.22% -> 78.26%             
client [3] (test)  loss: 1.2142 -> 0.0389   acc: 60.16% -> 98.37%              
client [11] (test)  loss: 0.6011 -> 0.3073   acc: 80.85% -> 91.49%             
client [95] (test)  loss: 1.2198 -> 0.0804   acc: 53.57% -> 96.43%             
client [67] (test)  loss: 3.5468 -> 0.0628   acc: 8.79% -> 98.90%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.5766 -> 1.0759   acc: 44.83% -> 72.41%             
client [79] (test)  loss: 0.6099 -> 0.0581   acc: 78.52% -> 98.66%             
client [58] (test)  loss: 1.2177 -> 0.0828   acc: 70.37% -> 96.30%             
client [88] (test)  loss: 1.1621 -> 0.5233   acc: 65.62% -> 83.33%             
client [46] (test)  loss: 0.9643 -> 0.1563   acc: 62.03% -> 93.67%             
client [11] (test)  loss: 0.4435 -> 0.2925   acc: 87.23% -> 93.62%             
client [55] (test)  loss: 2.1381 -> 0.4081   acc: 30.61% -> 87.76%             
client [13] (test)  loss: 1.9881 -> 0.2409   acc: 36.17% -> 91.49%             
client [31] (test)  loss: 1.1692 -> 0.1851   acc: 53.33% -> 96.67%             
client [75] (test)  loss: 0.6929 -> 0.2824   acc: 82.47% -> 90.72%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7084 -> 0.3131   acc: 80.65% -> 89.52%             
client [7] (test)  loss: 1.9933 -> 0.4624   acc: 43.68% -> 86.21%              
client [57] (test)  loss: 0.4447 -> 0.1822   acc: 84.75% -> 94.07%             
client [13] (test)  loss: 1.6183 -> 0.2399   acc: 55.32% -> 93.62%             
client [43] (test)  loss: 0.7086 -> 0.1051   acc: 75.00% -> 95.00%             
client [91] (test)  loss: 0.8780 -> 0.5443   acc: 75.00% -> 84.03%             
client [10] (test)  loss: 0.4603 -> 0.1877   acc: 87.37% -> 93.68%             
client [64] (test)  loss: 0.2774 -> 0.1861   acc: 91.23% -> 96.49%             
client [82] (test)  loss: 0.1888 -> 0.0710   acc: 94.83% -> 98.85%             
client [22] (test)  loss: 0.5077 -> 0.2665   acc: 86.44% -> 89.83%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5958 -> 0.1187   acc: 80.00% -> 96.52%             
client [23] (test)  loss: 0.4681 -> 0.2370   acc: 85.19% -> 94.44%             
client [88] (test)  loss: 1.6881 -> 0.5567   acc: 59.38% -> 82.29%             
client [98] (test)  loss: 2.1258 -> 0.0583   acc: 39.19% -> 98.65%             
client [79] (test)  loss: 0.1422 -> 0.0552   acc: 97.99% -> 98.66%             
client [21] (test)  loss: 0.9800 -> 0.6695   acc: 65.52% -> 72.41%             
client [92] (test)  loss: 5.7589 -> 0.0014   acc: 6.00% -> 100.00%             
client [56] (test)  loss: 0.7147 -> 0.4815   acc: 76.74% -> 86.05%             
client [5] (test)  loss: 0.7177 -> 1.0247   acc: 74.29% -> 82.86%              
client [52] (test)  loss: 2.7041 -> 0.2991   acc: 38.46% -> 87.18%             
==================== FedAvg_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '1.3619 -> 0.0000', 'accuracy': '58.13% -> 0.00%'},          
    200: {'loss': '1.4434 -> 0.0000', 'accuracy': '57.91% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_join_0.1 achieved 10.0%(11.82%) at epoch: 0                             
FedAvg_join_0.1 achieved 20.0%(29.07%) at epoch: 2                             
FedAvg_join_0.1 achieved 30.0%(32.20%) at epoch: 12                            
FedAvg_join_0.1 achieved 50.0%(54.24%) at epoch: 16                            
FedAvg_join_0.1 achieved 60.0%(68.90%) at epoch: 62                            
FedAvg_join_0.1 achieved 70.0%(70.52%) at epoch: 100                           
FedAvg_join_0.1 achieved 80.0%(81.90%) at epoch: 175                           
Convergence (test_after):                                                      
FedAvg_join_0.1 achieved 60.0%(64.43%) at epoch: 0                             
FedAvg_join_0.1 achieved 70.0%(74.74%) at epoch: 1                             
FedAvg_join_0.1 achieved 80.0%(85.45%) at epoch: 5                             
FedAvg_join_0.1 achieved 90.0%(92.15%) at epoch: 16                            
