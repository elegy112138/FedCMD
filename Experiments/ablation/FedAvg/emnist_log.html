==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.7979 -> 0.1317   acc: 33.55% -> 95.81%             
client [81] (test)  loss: 1.5501 -> 0.1967   acc: 44.14% -> 92.55%             
client [21] (test)  loss: 157.6834 -> 0.0844   acc: 12.31% -> 97.60%           
client [68] (test)  loss: 2.6066 -> 0.3603   acc: 44.67% -> 89.25%             
client [93] (test)  loss: 0.6972 -> 0.0424   acc: 81.90% -> 98.68%             
client [31] (test)  loss: 3.7974 -> 0.1654   acc: 8.47% -> 94.05%              
client [20] (test)  loss: 2.1827 -> 0.1710   acc: 24.63% -> 95.17%             
client [59] (test)  loss: 147.3008 -> 0.3118   acc: 17.21% -> 88.51%           
client [48] (test)  loss: 4.0109 -> 0.6172   acc: 16.02% -> 80.83%             
client [34] (test)  loss: 2.1272 -> 0.1167   acc: 19.96% -> 96.81%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.3977 -> 0.2919   acc: 16.58% -> 91.11%             
client [99] (test)  loss: 0.5933 -> 0.0406   acc: 83.24% -> 99.01%             
client [67] (test)  loss: 0.9128 -> 0.3433   acc: 77.88% -> 87.51%             
client [0] (test)  loss: 0.9332 -> 0.1579   acc: 78.62% -> 95.14%              
client [76] (test)  loss: 1.7367 -> 0.2110   acc: 45.58% -> 93.45%             
client [41] (test)  loss: 1.6373 -> 0.3297   acc: 48.52% -> 88.01%             
client [62] (test)  loss: 60.4289 -> 0.1018   acc: 54.84% -> 97.28%            
client [2] (test)  loss: 145.0208 -> 0.1492   acc: 39.58% -> 95.85%            
client [14] (test)  loss: 1.3364 -> 0.1914   acc: 56.38% -> 94.62%             
client [46] (test)  loss: 1.5877 -> 0.0239   acc: 21.11% -> 99.33%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7783 -> 0.1981   acc: 73.61% -> 93.55%             
client [68] (test)  loss: 1.4755 -> 0.2687   acc: 52.36% -> 91.69%             
client [57] (test)  loss: 1.0442 -> 0.1274   acc: 68.28% -> 96.81%             
client [17] (test)  loss: 1.9184 -> 0.1549   acc: 46.73% -> 94.56%             
client [54] (test)  loss: 1.4640 -> 0.2395   acc: 55.90% -> 93.56%             
client [23] (test)  loss: 187.8188 -> 0.1001   acc: 44.56% -> 96.78%           
client [35] (test)  loss: 0.4495 -> 0.0129   acc: 87.96% -> 99.64%             
client [59] (test)  loss: 0.7099 -> 0.2480   acc: 78.90% -> 90.45%             
client [31] (test)  loss: 1.0530 -> 0.1253   acc: 71.84% -> 95.69%             
client [9] (test)  loss: 1.6372 -> 0.1702   acc: 54.35% -> 94.46%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8311 -> 0.2835   acc: 76.72% -> 91.20%             
client [33] (test)  loss: 0.9369 -> 0.0698   acc: 64.35% -> 98.06%             
client [16] (test)  loss: 1.1535 -> 0.2683   acc: 57.83% -> 91.63%             
client [44] (test)  loss: 4.1592 -> 0.3823   acc: 28.43% -> 87.65%             
client [8] (test)  loss: 1.7495 -> 0.3808   acc: 56.15% -> 85.75%              
client [31] (test)  loss: 0.7227 -> 0.1193   acc: 76.53% -> 95.86%             
client [47] (test)  loss: 1.3106 -> 0.2144   acc: 59.42% -> 93.44%             
client [36] (test)  loss: 2.0378 -> 0.1737   acc: 38.44% -> 95.67%             
client [20] (test)  loss: 1.7538 -> 0.0928   acc: 39.25% -> 97.48%             
client [56] (test)  loss: 1.0223 -> 0.0360   acc: 58.12% -> 98.91%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.2400 -> 0.3300   acc: 66.45% -> 86.34%              
client [60] (test)  loss: 0.9049 -> 0.1105   acc: 73.30% -> 96.95%             
client [28] (test)  loss: 0.3673 -> 0.0037   acc: 89.67% -> 99.92%             
client [25] (test)  loss: 1.6435 -> 0.1387   acc: 57.05% -> 95.58%             
client [58] (test)  loss: 0.2323 -> 0.0079   acc: 93.32% -> 99.66%             
client [44] (test)  loss: 1.4268 -> 0.3545   acc: 58.17% -> 87.83%             
client [39] (test)  loss: 1.1738 -> 0.1155   acc: 59.97% -> 97.03%             
client [29] (test)  loss: 1.0665 -> 0.1983   acc: 68.33% -> 93.37%             
client [3] (test)  loss: 0.1784 -> 0.0117   acc: 95.76% -> 99.63%              
client [84] (test)  loss: 1.0672 -> 0.1641   acc: 71.48% -> 94.77%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3858 -> 0.0438   acc: 89.12% -> 98.71%             
client [84] (test)  loss: 1.0442 -> 0.1644   acc: 69.18% -> 95.13%             
client [10] (test)  loss: 1.0149 -> 0.2953   acc: 70.07% -> 87.29%             
client [36] (test)  loss: 2.2354 -> 0.1682   acc: 36.59% -> 95.84%             
client [65] (test)  loss: 0.7275 -> 0.3054   acc: 71.47% -> 89.54%             
client [81] (test)  loss: 0.4698 -> 0.1522   acc: 80.39% -> 93.69%             
client [79] (test)  loss: 1.2213 -> 0.2528   acc: 63.14% -> 91.75%             
client [42] (test)  loss: 1.0426 -> 0.2364   acc: 67.61% -> 92.83%             
client [11] (test)  loss: 0.4418 -> 0.0755   acc: 88.95% -> 97.97%             
client [96] (test)  loss: 0.7986 -> 0.1197   acc: 78.44% -> 96.31%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.8761 -> 0.3402   acc: 57.66% -> 86.85%              
client [53] (test)  loss: 0.9296 -> 0.0486   acc: 68.05% -> 98.68%             
client [52] (test)  loss: 1.1090 -> 0.3055   acc: 61.68% -> 88.24%             
client [42] (test)  loss: 0.9404 -> 0.2364   acc: 74.73% -> 92.83%             
client [69] (test)  loss: 1.2916 -> 0.1967   acc: 66.81% -> 94.47%             
client [59] (test)  loss: 0.8144 -> 0.2189   acc: 72.73% -> 91.46%             
client [7] (test)  loss: 0.8642 -> 0.2437   acc: 78.44% -> 92.83%              
client [26] (test)  loss: 0.8000 -> 0.1666   acc: 65.65% -> 94.64%             
client [49] (test)  loss: 0.1166 -> 0.0004   acc: 96.74% -> 100.00%            
client [98] (test)  loss: 0.9905 -> 0.0472   acc: 63.81% -> 99.13%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9322 -> 0.0476   acc: 66.63% -> 99.13%             
client [47] (test)  loss: 1.1541 -> 0.2102   acc: 60.09% -> 93.83%             
client [21] (test)  loss: 0.5672 -> 0.0405   acc: 85.34% -> 98.76%             
client [77] (test)  loss: 0.9704 -> 0.0835   acc: 72.03% -> 97.67%             
client [95] (test)  loss: 1.3114 -> 0.0960   acc: 47.06% -> 97.40%             
client [91] (test)  loss: 1.0244 -> 0.0599   acc: 65.57% -> 98.25%             
client [14] (test)  loss: 0.7019 -> 0.1578   acc: 71.71% -> 95.43%             
client [99] (test)  loss: 0.1709 -> 0.0318   acc: 95.75% -> 99.08%             
client [20] (test)  loss: 1.1510 -> 0.0926   acc: 52.26% -> 97.57%             
client [39] (test)  loss: 1.1210 -> 0.1059   acc: 59.77% -> 97.25%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.3437 -> 0.3054   acc: 56.94% -> 88.11%             
client [62] (test)  loss: 0.2594 -> 0.0755   acc: 93.21% -> 98.17%             
client [71] (test)  loss: 0.4415 -> 0.0090   acc: 88.09% -> 99.78%             
client [97] (test)  loss: 0.3404 -> 0.0086   acc: 89.92% -> 99.66%             
client [30] (test)  loss: 1.6331 -> 0.1181   acc: 49.49% -> 96.80%             
client [88] (test)  loss: 0.9385 -> 0.2459   acc: 71.78% -> 90.88%             
client [60] (test)  loss: 0.8809 -> 0.1034   acc: 73.20% -> 97.58%             
client [82] (test)  loss: 1.5321 -> 0.5443   acc: 46.47% -> 72.00%             
client [91] (test)  loss: 0.9952 -> 0.0597   acc: 64.75% -> 98.39%             
client [57] (test)  loss: 0.7487 -> 0.1075   acc: 75.50% -> 97.62%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.3342 -> 0.1041   acc: 88.75% -> 96.25%             
client [15] (test)  loss: 0.8206 -> 0.0193   acc: 77.29% -> 99.52%             
client [71] (test)  loss: 0.5339 -> 0.0086   acc: 86.37% -> 99.82%             
client [97] (test)  loss: 1.2486 -> 0.0074   acc: 67.85% -> 99.70%             
client [53] (test)  loss: 0.4829 -> 0.0464   acc: 85.58% -> 98.78%             
client [77] (test)  loss: 1.1913 -> 0.0845   acc: 66.53% -> 97.70%             
client [76] (test)  loss: 1.0949 -> 0.1663   acc: 66.80% -> 94.96%             
client [79] (test)  loss: 1.4553 -> 0.2333   acc: 67.43% -> 92.96%             
client [28] (test)  loss: 0.3127 -> 0.0044   acc: 90.61% -> 99.90%             
client [99] (test)  loss: 0.3063 -> 0.0296   acc: 91.67% -> 99.25%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2002 -> 0.0062   acc: 93.26% -> 99.82%             
client [86] (test)  loss: 0.9182 -> 0.3048   acc: 71.67% -> 89.86%             
client [34] (test)  loss: 0.6956 -> 0.0771   acc: 77.14% -> 97.91%             
client [73] (test)  loss: 0.6060 -> 0.2229   acc: 82.57% -> 92.00%             
client [5] (test)  loss: 0.7668 -> 0.1097   acc: 77.73% -> 96.82%              
client [96] (test)  loss: 1.1952 -> 0.1242   acc: 70.32% -> 96.03%             
client [22] (test)  loss: 1.2315 -> 0.1424   acc: 67.88% -> 94.65%             
client [60] (test)  loss: 0.7086 -> 0.1008   acc: 74.87% -> 97.71%             
client [66] (test)  loss: 1.2022 -> 0.1723   acc: 52.59% -> 95.17%             
client [83] (test)  loss: 0.5128 -> 0.0985   acc: 86.73% -> 97.18%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7805 -> 0.1647   acc: 76.53% -> 95.05%             
client [65] (test)  loss: 1.0228 -> 0.3033   acc: 63.65% -> 90.23%             
client [95] (test)  loss: 1.7190 -> 0.0922   acc: 40.73% -> 97.72%             
client [17] (test)  loss: 0.6087 -> 0.1327   acc: 80.56% -> 95.74%             
client [8] (test)  loss: 1.4813 -> 0.3203   acc: 62.15% -> 87.95%              
client [35] (test)  loss: 0.3583 -> 0.0116   acc: 90.07% -> 99.62%             
client [98] (test)  loss: 0.3946 -> 0.0457   acc: 88.56% -> 99.17%             
client [53] (test)  loss: 0.3994 -> 0.0453   acc: 87.48% -> 98.86%             
client [43] (test)  loss: 1.5355 -> 0.2814   acc: 52.48% -> 90.33%             
client [64] (test)  loss: 1.3006 -> 0.2521   acc: 63.80% -> 92.12%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4980 -> 0.0422   acc: 84.87% -> 98.74%             
client [88] (test)  loss: 1.0492 -> 0.2403   acc: 59.18% -> 90.86%             
client [38] (test)  loss: 1.9610 -> 0.1949   acc: 58.71% -> 95.46%             
client [3] (test)  loss: 0.3386 -> 0.0119   acc: 87.32% -> 99.69%              
client [5] (test)  loss: 1.0190 -> 0.1075   acc: 68.93% -> 97.00%              
client [41] (test)  loss: 0.9719 -> 0.2900   acc: 69.08% -> 89.53%             
client [7] (test)  loss: 1.1789 -> 0.2345   acc: 63.27% -> 93.32%              
client [37] (test)  loss: 0.3130 -> 0.0239   acc: 88.97% -> 99.40%             
client [45] (test)  loss: 1.1578 -> 0.3357   acc: 68.19% -> 88.41%             
client [47] (test)  loss: 1.4396 -> 0.2048   acc: 51.41% -> 94.08%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.2289 -> 0.2574   acc: 63.65% -> 91.95%             
client [11] (test)  loss: 0.5768 -> 0.0718   acc: 84.49% -> 98.06%             
client [37] (test)  loss: 0.2142 -> 0.0248   acc: 93.43% -> 99.38%             
client [41] (test)  loss: 1.1369 -> 0.2751   acc: 67.73% -> 89.81%             
client [95] (test)  loss: 1.1326 -> 0.0910   acc: 54.10% -> 97.72%             
client [53] (test)  loss: 0.5087 -> 0.0441   acc: 85.45% -> 98.86%             
client [22] (test)  loss: 1.6109 -> 0.1389   acc: 62.47% -> 95.18%             
client [25] (test)  loss: 0.7538 -> 0.1160   acc: 79.62% -> 96.04%             
client [69] (test)  loss: 1.5617 -> 0.1819   acc: 61.21% -> 94.91%             
client [46] (test)  loss: 0.5138 -> 0.0156   acc: 80.31% -> 99.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9678 -> 0.2105   acc: 62.39% -> 93.87%             
client [69] (test)  loss: 1.1962 -> 0.1792   acc: 68.34% -> 95.22%             
client [82] (test)  loss: 1.6990 -> 0.5492   acc: 44.63% -> 71.62%             
client [45] (test)  loss: 0.9989 -> 0.3378   acc: 71.43% -> 88.34%             
client [7] (test)  loss: 1.1682 -> 0.2352   acc: 65.48% -> 93.38%              
client [50] (test)  loss: 1.5536 -> 0.0923   acc: 60.74% -> 97.69%             
client [35] (test)  loss: 0.3773 -> 0.0111   acc: 91.00% -> 99.58%             
client [24] (test)  loss: 0.7577 -> 0.1676   acc: 75.03% -> 94.60%             
client [15] (test)  loss: 0.1894 -> 0.0172   acc: 95.35% -> 99.59%             
client [58] (test)  loss: 0.4370 -> 0.0086   acc: 88.28% -> 99.70%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.5093 -> 0.4682   acc: 36.85% -> 84.04%             
client [76] (test)  loss: 0.7086 -> 0.1601   acc: 78.93% -> 95.32%             
client [67] (test)  loss: 0.5681 -> 0.2720   acc: 79.80% -> 89.56%             
client [37] (test)  loss: 0.4829 -> 0.0241   acc: 84.75% -> 99.40%             
client [58] (test)  loss: 0.3060 -> 0.0092   acc: 92.10% -> 99.72%             
client [64] (test)  loss: 1.0231 -> 0.2509   acc: 66.08% -> 92.62%             
client [77] (test)  loss: 0.3295 -> 0.0796   acc: 90.76% -> 97.78%             
client [55] (test)  loss: 0.5974 -> 0.0776   acc: 83.42% -> 97.70%             
client [12] (test)  loss: 0.9270 -> 0.2759   acc: 75.19% -> 91.93%             
client [89] (test)  loss: 0.9489 -> 0.2599   acc: 67.13% -> 89.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.0373 -> 0.1420   acc: 75.35% -> 95.45%             
client [51] (test)  loss: 0.7409 -> 0.2542   acc: 78.23% -> 92.47%             
client [8] (test)  loss: 1.3902 -> 0.3148   acc: 64.37% -> 88.46%              
client [18] (test)  loss: 0.2508 -> 0.0260   acc: 93.35% -> 99.34%             
client [94] (test)  loss: 0.4306 -> 0.0035   acc: 89.33% -> 99.96%             
client [81] (test)  loss: 1.2055 -> 0.1364   acc: 62.20% -> 94.26%             
client [3] (test)  loss: 0.1088 -> 0.0121   acc: 97.13% -> 99.72%              
client [11] (test)  loss: 0.5446 -> 0.0726   acc: 86.45% -> 98.13%             
client [95] (test)  loss: 2.2283 -> 0.0904   acc: 40.25% -> 97.90%             
client [67] (test)  loss: 0.9930 -> 0.2561   acc: 71.54% -> 90.38%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2343 -> 0.0413   acc: 93.47% -> 98.76%             
client [79] (test)  loss: 1.0263 -> 0.2317   acc: 67.62% -> 93.09%             
client [58] (test)  loss: 0.4729 -> 0.0090   acc: 87.55% -> 99.74%             
client [88] (test)  loss: 0.9492 -> 0.2353   acc: 67.56% -> 91.19%             
client [46] (test)  loss: 0.4794 -> 0.0149   acc: 84.87% -> 99.60%             
client [11] (test)  loss: 0.4932 -> 0.0719   acc: 86.67% -> 98.15%             
client [55] (test)  loss: 0.6398 -> 0.0785   acc: 75.52% -> 97.83%             
client [13] (test)  loss: 0.3811 -> 0.0604   acc: 88.87% -> 98.59%             
client [31] (test)  loss: 0.3517 -> 0.1031   acc: 89.35% -> 96.39%             
client [75] (test)  loss: 0.8469 -> 0.1823   acc: 75.88% -> 94.96%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2979 -> 0.0546   acc: 92.30% -> 98.55%             
client [7] (test)  loss: 0.8650 -> 0.2329   acc: 75.53% -> 93.92%              
client [57] (test)  loss: 0.6431 -> 0.0860   acc: 77.61% -> 97.81%             
client [13] (test)  loss: 0.4841 -> 0.0611   acc: 86.12% -> 98.49%             
client [43] (test)  loss: 1.0369 -> 0.2807   acc: 69.71% -> 90.02%             
client [91] (test)  loss: 0.7219 -> 0.0555   acc: 70.32% -> 98.42%             
client [10] (test)  loss: 0.9809 -> 0.2606   acc: 65.34% -> 88.68%             
client [64] (test)  loss: 0.9417 -> 0.2475   acc: 72.18% -> 92.26%             
client [82] (test)  loss: 1.9901 -> 0.5505   acc: 29.68% -> 72.23%             
client [22] (test)  loss: 1.0634 -> 0.1406   acc: 72.74% -> 95.23%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5928 -> 0.0927   acc: 84.45% -> 97.77%             
client [23] (test)  loss: 0.6073 -> 0.0881   acc: 75.76% -> 97.34%             
client [88] (test)  loss: 0.9052 -> 0.2302   acc: 58.91% -> 91.19%             
client [98] (test)  loss: 0.3732 -> 0.0500   acc: 91.11% -> 99.15%             
client [79] (test)  loss: 0.6515 -> 0.2308   acc: 75.44% -> 93.21%             
client [21] (test)  loss: 0.5919 -> 0.0426   acc: 81.77% -> 98.88%             
client [92] (test)  loss: 0.9234 -> 0.0575   acc: 60.04% -> 98.58%             
client [56] (test)  loss: 1.0952 -> 0.0272   acc: 67.68% -> 99.31%             
client [5] (test)  loss: 0.7635 -> 0.1042   acc: 76.94% -> 97.17%              
client [52] (test)  loss: 0.7269 -> 0.3006   acc: 71.24% -> 88.36%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.9108 -> 0.0000', 'accuracy': '74.14% -> 0.00%'},          
    200: {'loss': '0.7407 -> 0.0000', 'accuracy': '76.01% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 30.0%(30.91%) at epoch: 2                                      
FedAvg achieved 40.0%(47.10%) at epoch: 7                                      
FedAvg achieved 50.0%(54.98%) at epoch: 10                                     
FedAvg achieved 60.0%(63.17%) at epoch: 20                                     
FedAvg achieved 70.0%(70.39%) at epoch: 24                                     
FedAvg achieved 80.0%(80.46%) at epoch: 44                                     
Convergence (test_after):                                                      
FedAvg achieved 90.0%(91.30%) at epoch: 0                                      
