==================== ALGORITHM: FedPer_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3574 -> 4.0518   acc: 2.95% -> 5.25%               
client [81] (test)  loss: 4.1422 -> 3.9269   acc: 8.88% -> 10.86%              
client [21] (test)  loss: 37.4638 -> 4.0350   acc: 7.67% -> 9.76%              
client [68] (test)  loss: 4.0832 -> 3.8848   acc: 13.68% -> 13.68%             
client [93] (test)  loss: 4.2950 -> 3.9425   acc: 9.45% -> 11.07%              
client [31] (test)  loss: 4.5124 -> 4.0525   acc: 4.73% -> 12.36%              
client [20] (test)  loss: 4.2665 -> 4.2296   acc: 1.38% -> 3.10%               
client [59] (test)  loss: 36.6969 -> 4.1870   acc: 0.00% -> 4.53%              
client [48] (test)  loss: 4.2263 -> 4.0942   acc: 5.57% -> 5.90%               
client [34] (test)  loss: 4.3515 -> 4.0815   acc: 10.33% -> 14.02%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.2023 -> 3.6024   acc: 9.71% -> 14.03%              
client [99] (test)  loss: 4.0585 -> 3.9200   acc: 10.58% -> 13.14%             
client [67] (test)  loss: 3.9535 -> 3.8170   acc: 10.42% -> 11.73%             
client [0] (test)  loss: 3.3899 -> 3.2819   acc: 15.67% -> 17.00%              
client [76] (test)  loss: 4.5020 -> 4.2648   acc: 5.30% -> 5.30%               
client [41] (test)  loss: 3.9336 -> 3.9221   acc: 6.98% -> 2.66%               
client [62] (test)  loss: 130.9126 -> 3.7611   acc: 0.00% -> 15.84%            
client [2] (test)  loss: 134.9260 -> 3.5850   acc: 0.00% -> 16.56%             
client [14] (test)  loss: 3.9107 -> 3.8565   acc: 11.18% -> 12.78%             
client [46] (test)  loss: 4.0446 -> 3.8910   acc: 10.63% -> 13.95%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.8514 -> 4.1182   acc: 14.58% -> 13.89%             
client [68] (test)  loss: 3.7714 -> 3.5935   acc: 15.50% -> 17.63%             
client [57] (test)  loss: 3.8708 -> 3.5962   acc: 7.12% -> 16.50%              
client [17] (test)  loss: 4.0028 -> 3.5240   acc: 16.08% -> 17.54%             
client [54] (test)  loss: 3.5857 -> 3.4868   acc: 17.68% -> 18.65%             
client [23] (test)  loss: 189.3706 -> 3.9542   acc: 0.67% -> 8.00%             
client [35] (test)  loss: 3.7472 -> 3.7642   acc: 9.84% -> 10.82%              
client [59] (test)  loss: 3.6648 -> 3.7185   acc: 9.39% -> 11.00%              
client [31] (test)  loss: 4.0779 -> 3.8509   acc: 7.64% -> 15.64%              
client [9] (test)  loss: 3.9027 -> 3.8740   acc: 11.40% -> 9.12%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.4692 -> 3.3495   acc: 15.61% -> 18.60%             
client [33] (test)  loss: 3.7756 -> 3.6901   acc: 11.26% -> 13.31%             
client [16] (test)  loss: 3.1813 -> 3.1088   acc: 23.16% -> 26.05%             
client [44] (test)  loss: 5.1200 -> 3.7680   acc: 6.27% -> 13.20%              
client [8] (test)  loss: 3.5734 -> 3.6294   acc: 15.87% -> 14.92%              
client [31] (test)  loss: 4.3315 -> 3.9000   acc: 5.09% -> 16.73%              
client [47] (test)  loss: 4.0801 -> 3.8403   acc: 7.19% -> 12.19%              
client [36] (test)  loss: 3.7932 -> 3.7551   acc: 13.33% -> 14.58%             
client [20] (test)  loss: 3.8451 -> 3.7876   acc: 11.72% -> 11.72%             
client [56] (test)  loss: 4.0253 -> 4.1879   acc: 10.84% -> 11.54%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.5581 -> 3.6042   acc: 15.75% -> 19.05%              
client [60] (test)  loss: 4.2972 -> 3.8480   acc: 13.33% -> 17.41%             
client [28] (test)  loss: 4.5021 -> 3.8819   acc: 11.94% -> 16.13%             
client [25] (test)  loss: 4.2097 -> 3.2759   acc: 11.97% -> 23.62%             
client [58] (test)  loss: 4.0532 -> 3.5098   acc: 12.26% -> 20.13%             
client [44] (test)  loss: 3.6507 -> 3.7424   acc: 17.82% -> 13.53%             
client [39] (test)  loss: 3.9121 -> 3.7227   acc: 14.85% -> 18.48%             
client [29] (test)  loss: 4.7676 -> 3.5315   acc: 15.28% -> 15.95%             
client [3] (test)  loss: 3.3466 -> 3.1531   acc: 20.71% -> 25.24%              
client [84] (test)  loss: 3.9009 -> 3.7379   acc: 10.90% -> 14.02%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.2564 -> 3.4142   acc: 11.50% -> 18.82%             
client [84] (test)  loss: 3.9551 -> 3.7395   acc: 12.15% -> 17.13%             
client [10] (test)  loss: 4.3018 -> 3.4570   acc: 17.05% -> 17.38%             
client [36] (test)  loss: 3.9842 -> 3.9330   acc: 17.08% -> 17.08%             
client [65] (test)  loss: 3.9529 -> 3.3748   acc: 14.89% -> 25.89%             
client [81] (test)  loss: 3.7384 -> 3.6950   acc: 21.71% -> 18.42%             
client [79] (test)  loss: 3.9406 -> 3.7197   acc: 14.95% -> 15.95%             
client [42] (test)  loss: 4.1811 -> 3.6858   acc: 12.24% -> 18.37%             
client [11] (test)  loss: 3.9207 -> 3.4855   acc: 18.95% -> 21.05%             
client [96] (test)  loss: 4.3462 -> 3.6127   acc: 11.97% -> 15.53%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.1568 -> 3.6853   acc: 19.68% -> 22.22%              
client [53] (test)  loss: 4.1831 -> 3.9204   acc: 12.50% -> 15.13%             
client [52] (test)  loss: 3.9855 -> 3.4807   acc: 15.86% -> 20.06%             
client [42] (test)  loss: 5.0596 -> 3.6807   acc: 9.52% -> 19.05%              
client [69] (test)  loss: 3.5369 -> 3.7443   acc: 19.78% -> 20.86%             
client [59] (test)  loss: 3.6029 -> 4.7280   acc: 16.50% -> 5.18%              
client [7] (test)  loss: 5.4069 -> 3.6818   acc: 9.58% -> 20.77%               
client [26] (test)  loss: 3.6264 -> 3.7943   acc: 23.92% -> 21.26%             
client [49] (test)  loss: 4.3909 -> 4.0266   acc: 12.50% -> 18.15%             
client [98] (test)  loss: 3.8274 -> 3.8194   acc: 13.03% -> 11.40%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.8640 -> 3.7979   acc: 15.64% -> 13.68%             
client [47] (test)  loss: 4.5105 -> 3.9774   acc: 13.75% -> 14.69%             
client [21] (test)  loss: 3.8636 -> 3.3751   acc: 18.12% -> 24.74%             
client [77] (test)  loss: 4.3326 -> 3.8726   acc: 15.08% -> 13.44%             
client [95] (test)  loss: 4.3756 -> 3.9735   acc: 14.52% -> 16.83%             
client [91] (test)  loss: 3.6514 -> 3.6411   acc: 21.15% -> 22.76%             
client [14] (test)  loss: 4.1405 -> 4.0031   acc: 16.61% -> 17.57%             
client [99] (test)  loss: 3.7831 -> 3.8041   acc: 17.95% -> 19.23%             
client [20] (test)  loss: 4.2615 -> 3.9743   acc: 14.48% -> 16.90%             
client [39] (test)  loss: 4.2264 -> 3.7902   acc: 14.19% -> 17.16%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.1120 -> 3.4453   acc: 19.74% -> 22.01%             
client [62] (test)  loss: 3.6059 -> 3.9020   acc: 22.11% -> 19.80%             
client [71] (test)  loss: 4.5391 -> 4.9185   acc: 15.88% -> 14.86%             
client [97] (test)  loss: 3.5174 -> 3.3270   acc: 24.15% -> 26.63%             
client [30] (test)  loss: 3.5601 -> 3.7615   acc: 24.67% -> 17.00%             
client [88] (test)  loss: 3.9070 -> 3.8688   acc: 14.18% -> 15.60%             
client [60] (test)  loss: 4.6795 -> 4.1588   acc: 17.41% -> 19.63%             
client [82] (test)  loss: 3.8835 -> 3.8915   acc: 15.36% -> 15.02%             
client [91] (test)  loss: 4.0448 -> 3.7671   acc: 21.15% -> 23.72%             
client [57] (test)  loss: 3.6499 -> 3.5784   acc: 21.68% -> 22.98%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.7281 -> 4.6509   acc: 12.00% -> 16.73%             
client [15] (test)  loss: 3.6690 -> 3.5997   acc: 15.84% -> 21.12%             
client [71] (test)  loss: 4.9426 -> 5.1339   acc: 17.91% -> 15.88%             
client [97] (test)  loss: 3.5874 -> 3.5101   acc: 19.50% -> 24.15%             
client [53] (test)  loss: 4.3211 -> 4.1425   acc: 16.78% -> 17.76%             
client [77] (test)  loss: 6.3935 -> 3.7023   acc: 9.51% -> 17.38%              
client [76] (test)  loss: 5.7766 -> 4.5338   acc: 8.71% -> 13.26%              
client [79] (test)  loss: 4.4936 -> 3.9311   acc: 15.61% -> 16.94%             
client [28] (test)  loss: 4.3858 -> 3.9473   acc: 18.39% -> 14.84%             
client [99] (test)  loss: 4.2848 -> 3.9892   acc: 17.63% -> 20.83%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.7106 -> 3.6444   acc: 22.60% -> 26.32%             
client [86] (test)  loss: 4.0177 -> 4.9321   acc: 19.81% -> 17.53%             
client [34] (test)  loss: 4.9668 -> 4.1800   acc: 15.13% -> 18.82%             
client [73] (test)  loss: 5.0961 -> 4.6060   acc: 15.86% -> 19.74%             
client [5] (test)  loss: 4.9526 -> 4.3949   acc: 11.92% -> 17.88%              
client [96] (test)  loss: 4.1125 -> 4.7207   acc: 20.06% -> 19.42%             
client [22] (test)  loss: 4.3988 -> 4.1604   acc: 17.88% -> 16.23%             
client [60] (test)  loss: 5.0770 -> 4.5106   acc: 17.41% -> 20.00%             
client [66] (test)  loss: 5.2725 -> 4.0036   acc: 7.97% -> 15.95%              
client [83] (test)  loss: 4.9170 -> 4.1084   acc: 16.04% -> 21.16%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.4653 -> 4.8809   acc: 13.26% -> 13.64%             
client [65] (test)  loss: 4.6489 -> 3.7470   acc: 19.74% -> 28.16%             
client [95] (test)  loss: 5.1367 -> 4.2569   acc: 11.88% -> 19.47%             
client [17] (test)  loss: 5.1710 -> 3.5563   acc: 19.30% -> 25.73%             
client [8] (test)  loss: 4.7806 -> 4.5408   acc: 22.22% -> 19.68%              
client [35] (test)  loss: 4.7406 -> 4.4165   acc: 16.39% -> 16.07%             
client [98] (test)  loss: 4.4456 -> 4.2993   acc: 12.38% -> 16.61%             
client [53] (test)  loss: 4.5313 -> 4.2905   acc: 16.78% -> 19.41%             
client [43] (test)  loss: 4.6303 -> 4.3515   acc: 17.49% -> 14.52%             
client [64] (test)  loss: 4.0822 -> 3.3898   acc: 23.26% -> 31.89%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.8878 -> 3.6523   acc: 17.07% -> 23.34%             
client [88] (test)  loss: 4.9520 -> 4.2609   acc: 15.96% -> 17.02%             
client [38] (test)  loss: 4.5966 -> 3.3129   acc: 22.30% -> 34.10%             
client [3] (test)  loss: 3.9995 -> 4.0352   acc: 27.83% -> 30.10%              
client [5] (test)  loss: 6.3202 -> 4.9420   acc: 11.59% -> 13.91%              
client [41] (test)  loss: 5.0990 -> 4.3897   acc: 17.61% -> 20.93%             
client [7] (test)  loss: 4.8830 -> 4.0347   acc: 16.61% -> 22.36%              
client [37] (test)  loss: 4.4213 -> 4.0492   acc: 19.14% -> 20.46%             
client [45] (test)  loss: 3.8839 -> 3.6249   acc: 31.89% -> 25.91%             
client [47] (test)  loss: 5.7110 -> 4.3200   acc: 14.37% -> 19.38%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.0951 -> 3.5390   acc: 19.21% -> 27.11%             
client [11] (test)  loss: 4.9894 -> 4.5581   acc: 14.74% -> 22.11%             
client [37] (test)  loss: 4.5842 -> 4.4055   acc: 18.81% -> 19.47%             
client [41] (test)  loss: 5.3982 -> 4.5947   acc: 14.95% -> 19.27%             
client [95] (test)  loss: 5.6732 -> 4.6777   acc: 12.54% -> 19.14%             
client [53] (test)  loss: 4.4795 -> 4.9479   acc: 20.39% -> 18.42%             
client [22] (test)  loss: 4.9043 -> 4.6479   acc: 17.88% -> 17.55%             
client [25] (test)  loss: 4.8021 -> 3.7373   acc: 20.06% -> 28.16%             
client [69] (test)  loss: 4.8787 -> 5.1242   acc: 22.30% -> 23.02%             
client [46] (test)  loss: 4.6643 -> 4.5633   acc: 16.94% -> 21.93%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.1271 -> 5.0414   acc: 13.75% -> 17.50%             
client [69] (test)  loss: 5.4198 -> 5.4249   acc: 23.74% -> 24.10%             
client [82] (test)  loss: 4.7211 -> 4.9054   acc: 18.43% -> 17.41%             
client [45] (test)  loss: 3.6969 -> 3.7160   acc: 28.90% -> 28.90%             
client [7] (test)  loss: 5.0448 -> 4.2457   acc: 15.02% -> 23.96%              
client [50] (test)  loss: 5.0005 -> 4.4416   acc: 13.95% -> 18.60%             
client [35] (test)  loss: 5.2157 -> 5.2291   acc: 16.07% -> 15.41%             
client [24] (test)  loss: 8.3334 -> 5.0699   acc: 12.85% -> 24.31%             
client [15] (test)  loss: 6.0816 -> 4.5297   acc: 8.91% -> 20.79%              
client [58] (test)  loss: 4.9603 -> 5.0387   acc: 21.07% -> 25.79%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 6.3515 -> 6.1332   acc: 16.72% -> 12.79%             
client [76] (test)  loss: 6.6081 -> 5.9850   acc: 14.77% -> 15.53%             
client [67] (test)  loss: 4.6464 -> 4.6758   acc: 17.59% -> 19.22%             
client [37] (test)  loss: 5.7541 -> 4.8800   acc: 16.83% -> 21.12%             
client [58] (test)  loss: 5.2917 -> 5.2740   acc: 21.38% -> 26.42%             
client [64] (test)  loss: 4.3179 -> 4.1317   acc: 28.24% -> 25.91%             
client [77] (test)  loss: 5.5125 -> 4.3287   acc: 19.02% -> 21.64%             
client [55] (test)  loss: 6.3083 -> 6.1156   acc: 17.02% -> 12.06%             
client [12] (test)  loss: 5.0557 -> 5.1956   acc: 13.95% -> 16.28%             
client [89] (test)  loss: 7.3074 -> 5.3581   acc: 14.15% -> 18.65%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 6.9700 -> 6.2215   acc: 16.51% -> 19.31%             
client [51] (test)  loss: 5.3862 -> 5.1731   acc: 24.25% -> 25.91%             
client [8] (test)  loss: 5.9500 -> 5.8710   acc: 20.32% -> 25.71%              
client [18] (test)  loss: 4.6272 -> 3.9508   acc: 19.67% -> 32.79%             
client [94] (test)  loss: 5.7732 -> 5.0952   acc: 16.61% -> 18.73%             
client [81] (test)  loss: 5.1063 -> 5.0834   acc: 18.09% -> 25.33%             
client [3] (test)  loss: 5.6271 -> 4.9856   acc: 21.36% -> 30.42%              
client [11] (test)  loss: 5.5964 -> 5.5518   acc: 18.95% -> 20.00%             
client [95] (test)  loss: 6.9294 -> 5.7654   acc: 12.54% -> 14.85%             
client [67] (test)  loss: 5.5564 -> 4.8673   acc: 16.94% -> 18.57%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 7.4386 -> 4.6878   acc: 12.20% -> 26.83%             
client [79] (test)  loss: 5.9462 -> 5.6080   acc: 20.27% -> 20.93%             
client [58] (test)  loss: 6.3852 -> 5.9691   acc: 19.50% -> 26.42%             
client [88] (test)  loss: 6.9405 -> 5.3613   acc: 15.25% -> 17.02%             
client [46] (test)  loss: 6.2031 -> 5.6903   acc: 15.61% -> 18.94%             
client [11] (test)  loss: 6.8969 -> 6.0194   acc: 16.49% -> 17.89%             
client [55] (test)  loss: 6.9743 -> 6.5455   acc: 13.12% -> 12.41%             
client [13] (test)  loss: 7.5483 -> 6.0502   acc: 12.89% -> 18.12%             
client [31] (test)  loss: 7.0688 -> 6.4020   acc: 15.27% -> 16.00%             
client [75] (test)  loss: 6.1396 -> 5.8061   acc: 13.73% -> 16.42%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 6.8710 -> 6.4589   acc: 16.29% -> 17.92%             
client [7] (test)  loss: 6.5840 -> 5.5129   acc: 12.14% -> 21.41%              
client [57] (test)  loss: 6.1046 -> 5.1986   acc: 14.56% -> 21.68%             
client [13] (test)  loss: 6.5181 -> 6.4602   acc: 16.03% -> 16.03%             
client [43] (test)  loss: 9.0981 -> 5.7054   acc: 9.90% -> 13.53%              
client [91] (test)  loss: 6.3309 -> 5.2420   acc: 20.83% -> 23.40%             
client [10] (test)  loss: 6.1775 -> 5.7204   acc: 16.39% -> 19.67%             
client [64] (test)  loss: 5.4223 -> 5.1741   acc: 28.24% -> 27.91%             
client [82] (test)  loss: 7.3242 -> 6.1157   acc: 11.26% -> 19.45%             
client [22] (test)  loss: 6.9978 -> 6.1759   acc: 15.89% -> 15.56%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.0644 -> 5.7149   acc: 20.69% -> 20.69%             
client [23] (test)  loss: 5.3205 -> 5.8740   acc: 17.33% -> 17.33%             
client [88] (test)  loss: 8.1258 -> 5.7911   acc: 11.35% -> 19.50%             
client [98] (test)  loss: 6.8719 -> 6.1307   acc: 11.73% -> 17.59%             
client [79] (test)  loss: 6.2154 -> 6.2608   acc: 19.60% -> 19.93%             
client [21] (test)  loss: 6.9804 -> 5.1024   acc: 14.98% -> 25.44%             
client [92] (test)  loss: 7.1784 -> 6.1066   acc: 17.00% -> 21.33%             
client [56] (test)  loss: 9.0442 -> 7.5013   acc: 11.54% -> 13.29%             
client [5] (test)  loss: 7.7375 -> 7.3097   acc: 11.92% -> 16.89%              
client [52] (test)  loss: 6.9161 -> 5.9614   acc: 17.48% -> 20.06%             
==================== FedPer_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '4.4919 -> 0.0000', 'accuracy': '16.07% -> 0.00%'},          
    200: {'loss': '7.0170 -> 0.0000', 'accuracy': '17.57% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_0.5 achieved 10.0%(10.35%) at epoch: 24                                 
FedPer_0.5 achieved 20.0%(20.01%) at epoch: 153                                
Convergence (test_after):                                                      
FedPer_0.5 achieved 10.0%(11.00%) at epoch: 12                                 
FedPer_0.5 achieved 20.0%(21.07%) at epoch: 70                                 
