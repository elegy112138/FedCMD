==================== ALGORITHM: FedPer_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.5338 -> 1.0142   acc: 54.37% -> 47.57%             
client [81] (test)  loss: 1.9225 -> 1.7919   acc: 29.73% -> 30.63%             
client [21] (test)  loss: 2.3257 -> 1.1325   acc: 11.50% -> 68.14%             
client [68] (test)  loss: 2.1641 -> 1.8747   acc: 18.95% -> 36.84%             
client [93] (test)  loss: 1.7700 -> 1.3169   acc: 45.67% -> 61.42%             
client [31] (test)  loss: 1.7733 -> 1.0367   acc: 48.76% -> 69.42%             
client [20] (test)  loss: 0.4716 -> 0.3904   acc: 87.58% -> 87.58%             
client [59] (test)  loss: 2.1600 -> 1.2284   acc: 68.85% -> 65.57%             
client [48] (test)  loss: 0.8692 -> 0.8001   acc: 73.79% -> 72.82%             
client [34] (test)  loss: 2.0315 -> 1.7561   acc: 34.25% -> 27.40%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5877 -> 1.3956   acc: 37.36% -> 43.96%             
client [99] (test)  loss: 1.8904 -> 1.4872   acc: 47.14% -> 54.29%             
client [67] (test)  loss: 1.2809 -> 0.9137   acc: 61.04% -> 70.13%             
client [0] (test)  loss: 0.6856 -> 0.4682   acc: 78.03% -> 87.28%              
client [76] (test)  loss: 0.9307 -> 0.7862   acc: 75.00% -> 77.21%             
client [41] (test)  loss: 1.3569 -> 0.9380   acc: 60.54% -> 70.75%             
client [62] (test)  loss: 2.1807 -> 0.8238   acc: 14.71% -> 80.88%             
client [2] (test)  loss: 2.0658 -> 1.1576   acc: 54.17% -> 71.88%              
client [14] (test)  loss: 0.9265 -> 0.8142   acc: 73.02% -> 74.60%             
client [46] (test)  loss: 0.5907 -> 0.5235   acc: 80.95% -> 84.92%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0086 -> 0.9262   acc: 65.55% -> 69.75%             
client [68] (test)  loss: 1.2981 -> 1.1884   acc: 52.63% -> 54.74%             
client [57] (test)  loss: 1.1973 -> 0.9867   acc: 51.13% -> 60.90%             
client [17] (test)  loss: 0.6630 -> 0.5000   acc: 82.78% -> 85.43%             
client [54] (test)  loss: 0.9593 -> 0.8657   acc: 69.06% -> 71.94%             
client [23] (test)  loss: 2.2792 -> 1.5401   acc: 22.05% -> 55.12%             
client [35] (test)  loss: 1.3846 -> 1.3219   acc: 47.37% -> 44.21%             
client [59] (test)  loss: 0.6441 -> 0.5943   acc: 74.59% -> 75.41%             
client [31] (test)  loss: 0.6544 -> 0.6004   acc: 76.86% -> 77.69%             
client [9] (test)  loss: 1.4737 -> 1.4046   acc: 44.68% -> 53.19%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6746 -> 0.5922   acc: 81.76% -> 85.81%             
client [33] (test)  loss: 0.8782 -> 0.7692   acc: 70.21% -> 67.38%             
client [16] (test)  loss: 0.6509 -> 0.6205   acc: 77.48% -> 77.48%             
client [44] (test)  loss: 0.1347 -> 0.0090   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.4243 -> 0.3796   acc: 83.87% -> 89.52%              
client [31] (test)  loss: 0.5601 -> 0.5360   acc: 78.51% -> 78.51%             
client [47] (test)  loss: 1.0644 -> 0.9662   acc: 63.64% -> 69.70%             
client [36] (test)  loss: 1.1279 -> 0.8125   acc: 79.17% -> 75.00%             
client [20] (test)  loss: 0.2237 -> 0.1905   acc: 94.12% -> 94.12%             
client [56] (test)  loss: 0.8657 -> 0.7028   acc: 66.67% -> 74.81%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3606 -> 0.2877   acc: 89.36% -> 92.02%              
client [60] (test)  loss: 1.0158 -> 0.9518   acc: 70.59% -> 71.76%             
client [28] (test)  loss: 0.7410 -> 0.6954   acc: 77.36% -> 75.47%             
client [25] (test)  loss: 1.0723 -> 0.7384   acc: 60.50% -> 76.47%             
client [58] (test)  loss: 0.9665 -> 0.9479   acc: 61.65% -> 63.91%             
client [44] (test)  loss: 0.0299 -> 0.0057   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 0.5894 -> 0.5201   acc: 76.85% -> 77.83%             
client [29] (test)  loss: 0.5688 -> 0.4235   acc: 83.90% -> 89.83%             
client [3] (test)  loss: 0.4440 -> 0.3768   acc: 86.56% -> 88.54%              
client [84] (test)  loss: 0.7341 -> 0.7143   acc: 72.27% -> 75.63%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6324 -> 0.4837   acc: 80.97% -> 86.73%             
client [84] (test)  loss: 0.6760 -> 0.6874   acc: 73.95% -> 76.47%             
client [10] (test)  loss: 0.6067 -> 0.5220   acc: 78.95% -> 81.95%             
client [36] (test)  loss: 0.6491 -> 0.6123   acc: 77.78% -> 81.94%             
client [65] (test)  loss: 0.6444 -> 0.5965   acc: 72.95% -> 73.77%             
client [81] (test)  loss: 0.7235 -> 0.6775   acc: 78.38% -> 81.08%             
client [79] (test)  loss: 0.3508 -> 0.3408   acc: 87.32% -> 88.03%             
client [42] (test)  loss: 1.0371 -> 0.9309   acc: 69.05% -> 70.63%             
client [11] (test)  loss: 1.1375 -> 1.1571   acc: 58.57% -> 58.57%             
client [96] (test)  loss: 0.0883 -> 0.0653   acc: 96.95% -> 96.95%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2363 -> 0.2228   acc: 91.13% -> 92.74%              
client [53] (test)  loss: 0.4190 -> 0.4167   acc: 87.59% -> 84.67%             
client [52] (test)  loss: 0.5510 -> 0.4489   acc: 80.75% -> 83.85%             
client [42] (test)  loss: 0.9480 -> 0.8640   acc: 70.63% -> 69.84%             
client [69] (test)  loss: 0.7966 -> 0.8321   acc: 73.63% -> 69.23%             
client [59] (test)  loss: 0.3080 -> 0.2732   acc: 90.16% -> 91.80%             
client [7] (test)  loss: 0.6902 -> 0.6649   acc: 79.13% -> 79.13%              
client [26] (test)  loss: 0.5513 -> 0.4812   acc: 79.34% -> 84.30%             
client [49] (test)  loss: 0.2920 -> 0.2911   acc: 91.11% -> 90.37%             
client [98] (test)  loss: 0.6915 -> 0.6608   acc: 71.67% -> 70.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6746 -> 0.6354   acc: 71.67% -> 68.33%             
client [47] (test)  loss: 0.6587 -> 0.5828   acc: 81.82% -> 84.85%             
client [21] (test)  loss: 0.4211 -> 0.3874   acc: 88.05% -> 88.50%             
client [77] (test)  loss: 0.2846 -> 0.2890   acc: 90.29% -> 92.23%             
client [95] (test)  loss: 0.3097 -> 0.3560   acc: 91.84% -> 90.48%             
client [91] (test)  loss: 0.3696 -> 0.3709   acc: 89.15% -> 90.70%             
client [14] (test)  loss: 0.4422 -> 0.4426   acc: 84.13% -> 85.71%             
client [99] (test)  loss: 0.8508 -> 0.9450   acc: 77.14% -> 71.43%             
client [20] (test)  loss: 0.3202 -> 0.2067   acc: 91.50% -> 95.42%             
client [39] (test)  loss: 0.4540 -> 0.4280   acc: 82.27% -> 81.77%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5089 -> 0.4029   acc: 81.99% -> 84.47%             
client [62] (test)  loss: 0.3289 -> 0.3442   acc: 89.71% -> 88.24%             
client [71] (test)  loss: 0.5979 -> 0.5504   acc: 79.41% -> 83.33%             
client [97] (test)  loss: 0.5262 -> 0.4419   acc: 84.00% -> 86.00%             
client [30] (test)  loss: 0.4491 -> 0.3966   acc: 86.89% -> 90.16%             
client [88] (test)  loss: 0.6220 -> 0.7050   acc: 77.27% -> 76.52%             
client [60] (test)  loss: 0.7701 -> 0.7645   acc: 74.12% -> 75.29%             
client [82] (test)  loss: 0.6215 -> 0.5199   acc: 80.15% -> 83.21%             
client [91] (test)  loss: 0.3227 -> 0.3580   acc: 92.25% -> 90.70%             
client [57] (test)  loss: 0.8078 -> 0.5243   acc: 70.68% -> 79.70%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5038 -> 0.4208   acc: 86.78% -> 90.08%             
client [15] (test)  loss: 0.9198 -> 0.7775   acc: 75.76% -> 81.82%             
client [71] (test)  loss: 0.5666 -> 0.5360   acc: 83.33% -> 85.29%             
client [97] (test)  loss: 0.4857 -> 0.4198   acc: 84.00% -> 88.00%             
client [53] (test)  loss: 0.3064 -> 0.3994   acc: 89.05% -> 85.40%             
client [77] (test)  loss: 0.2527 -> 0.2704   acc: 92.23% -> 92.23%             
client [76] (test)  loss: 0.2899 -> 0.3423   acc: 88.97% -> 88.97%             
client [79] (test)  loss: 0.3493 -> 0.3348   acc: 87.32% -> 88.03%             
client [28] (test)  loss: 0.5576 -> 0.7197   acc: 84.91% -> 79.25%             
client [99] (test)  loss: 0.9737 -> 0.8717   acc: 70.00% -> 74.29%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4481 -> 0.3961   acc: 86.00% -> 88.00%             
client [86] (test)  loss: 0.2982 -> 0.2967   acc: 92.05% -> 92.05%             
client [34] (test)  loss: 0.5000 -> 0.5598   acc: 86.30% -> 82.19%             
client [73] (test)  loss: 0.7550 -> 0.8400   acc: 71.93% -> 72.81%             
client [5] (test)  loss: 0.5618 -> 0.5193   acc: 78.82% -> 80.00%              
client [96] (test)  loss: 0.0381 -> 0.0275   acc: 99.39% -> 99.39%             
client [22] (test)  loss: 0.5553 -> 0.6548   acc: 80.73% -> 77.98%             
client [60] (test)  loss: 0.7148 -> 0.7783   acc: 77.65% -> 74.12%             
client [66] (test)  loss: 0.2583 -> 0.2547   acc: 92.86% -> 92.86%             
client [83] (test)  loss: 0.3340 -> 0.2590   acc: 91.12% -> 93.46%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2900 -> 0.3208   acc: 91.18% -> 90.44%             
client [65] (test)  loss: 0.5477 -> 0.5283   acc: 77.87% -> 81.15%             
client [95] (test)  loss: 0.3628 -> 0.3585   acc: 91.16% -> 90.48%             
client [17] (test)  loss: 0.3166 -> 0.2988   acc: 89.40% -> 91.39%             
client [8] (test)  loss: 0.1796 -> 0.1633   acc: 93.55% -> 91.94%              
client [35] (test)  loss: 0.6160 -> 0.6552   acc: 77.89% -> 75.79%             
client [98] (test)  loss: 0.6638 -> 0.5790   acc: 73.33% -> 75.00%             
client [53] (test)  loss: 0.2380 -> 0.3819   acc: 92.70% -> 86.86%             
client [43] (test)  loss: 0.5097 -> 0.4085   acc: 83.61% -> 88.52%             
client [64] (test)  loss: 0.3806 -> 0.3556   acc: 88.51% -> 90.54%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3396 -> 0.2630   acc: 90.27% -> 91.15%             
client [88] (test)  loss: 0.6426 -> 0.6793   acc: 77.27% -> 78.79%             
client [38] (test)  loss: 0.5272 -> 0.3264   acc: 84.31% -> 88.24%             
client [3] (test)  loss: 0.3279 -> 0.2419   acc: 90.91% -> 93.28%              
client [5] (test)  loss: 0.5345 -> 0.5076   acc: 78.82% -> 81.18%              
client [41] (test)  loss: 0.3231 -> 0.2811   acc: 89.12% -> 91.16%             
client [7] (test)  loss: 0.5777 -> 0.5694   acc: 82.61% -> 81.74%              
client [37] (test)  loss: 0.4259 -> 0.4280   acc: 87.25% -> 86.58%             
client [45] (test)  loss: 0.2201 -> 0.1728   acc: 94.70% -> 93.18%             
client [47] (test)  loss: 0.4918 -> 0.5368   acc: 87.88% -> 84.85%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3687 -> 0.3836   acc: 88.08% -> 88.08%             
client [11] (test)  loss: 0.6245 -> 0.7098   acc: 80.00% -> 77.14%             
client [37] (test)  loss: 0.4017 -> 0.4295   acc: 87.92% -> 86.58%             
client [41] (test)  loss: 0.3370 -> 0.2777   acc: 87.76% -> 91.16%             
client [95] (test)  loss: 0.3699 -> 0.3733   acc: 91.16% -> 91.16%             
client [53] (test)  loss: 0.2191 -> 0.3761   acc: 93.43% -> 88.32%             
client [22] (test)  loss: 0.5236 -> 0.6100   acc: 78.90% -> 77.98%             
client [25] (test)  loss: 0.4786 -> 0.4444   acc: 85.71% -> 84.87%             
client [69] (test)  loss: 0.7559 -> 0.7855   acc: 72.53% -> 75.82%             
client [46] (test)  loss: 0.1589 -> 0.1498   acc: 93.65% -> 93.65%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4817 -> 0.5389   acc: 84.85% -> 86.36%             
client [69] (test)  loss: 0.8180 -> 0.7923   acc: 72.53% -> 75.82%             
client [82] (test)  loss: 0.5196 -> 0.3661   acc: 83.21% -> 89.31%             
client [45] (test)  loss: 0.2059 -> 0.1597   acc: 95.45% -> 94.70%             
client [7] (test)  loss: 0.5458 -> 0.5574   acc: 86.09% -> 83.48%              
client [50] (test)  loss: 0.2404 -> 0.2533   acc: 90.98% -> 90.23%             
client [35] (test)  loss: 0.6187 -> 0.6571   acc: 80.00% -> 75.79%             
client [24] (test)  loss: 0.5881 -> 0.5884   acc: 78.15% -> 78.15%             
client [15] (test)  loss: 0.9987 -> 0.8448   acc: 78.79% -> 81.82%             
client [58] (test)  loss: 0.6445 -> 0.6661   acc: 78.95% -> 79.70%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3076 -> 0.2942   acc: 94.17% -> 93.20%             
client [76] (test)  loss: 0.3127 -> 0.3155   acc: 91.18% -> 91.18%             
client [67] (test)  loss: 0.4496 -> 0.3445   acc: 83.77% -> 87.66%             
client [37] (test)  loss: 0.3798 -> 0.4232   acc: 87.25% -> 86.58%             
client [58] (test)  loss: 0.6283 -> 0.6652   acc: 78.95% -> 78.20%             
client [64] (test)  loss: 0.3230 -> 0.3352   acc: 92.57% -> 91.22%             
client [77] (test)  loss: 0.2153 -> 0.2322   acc: 94.17% -> 91.26%             
client [55] (test)  loss: 1.3270 -> 0.8906   acc: 57.69% -> 70.19%             
client [12] (test)  loss: 0.6331 -> 0.6494   acc: 79.49% -> 80.34%             
client [89] (test)  loss: 0.5172 -> 0.4832   acc: 80.00% -> 80.00%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4452 -> 0.6278   acc: 84.87% -> 79.83%             
client [51] (test)  loss: 0.3958 -> 0.4489   acc: 88.89% -> 87.96%             
client [8] (test)  loss: 0.1428 -> 0.1404   acc: 93.55% -> 93.55%              
client [18] (test)  loss: 0.5042 -> 0.5776   acc: 85.98% -> 80.37%             
client [94] (test)  loss: 0.0746 -> 0.0881   acc: 97.54% -> 96.72%             
client [81] (test)  loss: 0.4023 -> 0.3340   acc: 88.29% -> 88.29%             
client [3] (test)  loss: 0.3296 -> 0.2199   acc: 90.12% -> 94.47%              
client [11] (test)  loss: 0.5744 -> 0.6917   acc: 80.00% -> 80.00%             
client [95] (test)  loss: 0.3770 -> 0.3823   acc: 93.20% -> 92.52%             
client [67] (test)  loss: 0.3848 -> 0.3480   acc: 84.42% -> 87.66%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3500 -> 0.2190   acc: 89.38% -> 92.04%             
client [79] (test)  loss: 0.3566 -> 0.3230   acc: 89.44% -> 91.55%             
client [58] (test)  loss: 0.6325 -> 0.6806   acc: 80.45% -> 78.95%             
client [88] (test)  loss: 0.7059 -> 0.5874   acc: 73.48% -> 81.82%             
client [46] (test)  loss: 0.1857 -> 0.1395   acc: 93.65% -> 94.44%             
client [11] (test)  loss: 0.6289 -> 0.7073   acc: 82.86% -> 80.00%             
client [55] (test)  loss: 1.3316 -> 0.9607   acc: 58.65% -> 67.31%             
client [13] (test)  loss: 0.6658 -> 0.4936   acc: 80.28% -> 87.32%             
client [31] (test)  loss: 0.5826 -> 0.3739   acc: 90.08% -> 92.56%             
client [75] (test)  loss: 0.8264 -> 0.7534   acc: 79.25% -> 79.25%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4513 -> 0.5084   acc: 81.32% -> 82.42%             
client [7] (test)  loss: 0.5840 -> 0.5652   acc: 87.83% -> 85.22%              
client [57] (test)  loss: 0.4184 -> 0.3654   acc: 84.21% -> 86.47%             
client [13] (test)  loss: 0.6613 -> 0.5109   acc: 80.28% -> 84.51%             
client [43] (test)  loss: 0.4738 -> 0.3443   acc: 86.07% -> 89.34%             
client [91] (test)  loss: 0.3198 -> 0.3379   acc: 90.70% -> 90.70%             
client [10] (test)  loss: 0.4478 -> 0.3638   acc: 86.47% -> 89.47%             
client [64] (test)  loss: 0.3309 -> 0.3342   acc: 91.89% -> 90.54%             
client [82] (test)  loss: 0.4198 -> 0.3409   acc: 86.26% -> 89.31%             
client [22] (test)  loss: 0.5207 -> 0.5938   acc: 85.32% -> 79.82%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4188 -> 0.2727   acc: 91.50% -> 96.08%             
client [23] (test)  loss: 0.4481 -> 0.4752   acc: 81.89% -> 88.19%             
client [88] (test)  loss: 0.6423 -> 0.5799   acc: 75.76% -> 82.58%             
client [98] (test)  loss: 0.6645 -> 0.5706   acc: 71.67% -> 80.00%             
client [79] (test)  loss: 0.4157 -> 0.3365   acc: 88.73% -> 90.85%             
client [21] (test)  loss: 0.2332 -> 0.2134   acc: 93.81% -> 92.04%             
client [92] (test)  loss: 0.3812 -> 0.5146   acc: 86.73% -> 84.69%             
client [56] (test)  loss: 0.3017 -> 0.3100   acc: 90.37% -> 91.11%             
client [5] (test)  loss: 0.4775 -> 0.5065   acc: 80.00% -> 80.00%              
client [52] (test)  loss: 0.5066 -> 0.3497   acc: 83.23% -> 90.06%             
==================== FedPer_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.4812 -> 0.0000', 'accuracy': '84.21% -> 0.00%'},          
    200: {'loss': '0.4358 -> 0.0000', 'accuracy': '87.07% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_0.5 achieved 10.0%(13.52%) at epoch: 0                                  
FedPer_0.5 achieved 20.0%(26.39%) at epoch: 1                                  
FedPer_0.5 achieved 30.0%(30.17%) at epoch: 4                                  
FedPer_0.5 achieved 40.0%(48.66%) at epoch: 6                                  
FedPer_0.5 achieved 50.0%(53.93%) at epoch: 12                                 
FedPer_0.5 achieved 60.0%(63.84%) at epoch: 18                                 
FedPer_0.5 achieved 70.0%(74.33%) at epoch: 24                                 
FedPer_0.5 achieved 80.0%(80.53%) at epoch: 39                                 
FedPer_0.5 achieved 90.0%(90.35%) at epoch: 123                                
Convergence (test_after):                                                      
FedPer_0.5 achieved 40.0%(45.42%) at epoch: 0                                  
FedPer_0.5 achieved 50.0%(53.48%) at epoch: 3                                  
FedPer_0.5 achieved 60.0%(66.84%) at epoch: 6                                  
FedPer_0.5 achieved 70.0%(73.78%) at epoch: 19                                 
FedPer_0.5 achieved 80.0%(80.86%) at epoch: 24                                 
FedPer_0.5 achieved 90.0%(90.49%) at epoch: 123                                
