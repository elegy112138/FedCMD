==================== ALGORITHM: FedRep_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.0051 -> 4.8240   acc: 2.43% -> 2.61%               
client [81] (test)  loss: 5.0410 -> 4.9576   acc: 2.73% -> 2.91%               
client [21] (test)  loss: 5.2867 -> 4.7385   acc: 0.00% -> 3.43%               
client [68] (test)  loss: 5.0252 -> 4.8412   acc: 4.32% -> 5.58%               
client [93] (test)  loss: 4.9974 -> 4.7722   acc: 6.51% -> 6.51%               
client [31] (test)  loss: 5.4030 -> 4.7269   acc: 0.00% -> 7.21%               
client [20] (test)  loss: 4.7308 -> 4.6553   acc: 4.46% -> 4.46%               
client [59] (test)  loss: 5.3405 -> 4.8464   acc: 0.00% -> 2.52%               
client [48] (test)  loss: 4.7911 -> 4.7617   acc: 5.72% -> 5.72%               
client [34] (test)  loss: 4.9050 -> 4.8185   acc: 2.35% -> 3.07%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.3292 -> 4.8523   acc: 1.65% -> 1.83%               
client [99] (test)  loss: 5.0612 -> 4.9120   acc: 1.44% -> 2.52%               
client [67] (test)  loss: 4.6673 -> 4.5497   acc: 6.90% -> 6.90%               
client [0] (test)  loss: 4.7146 -> 4.6355   acc: 3.95% -> 4.31%                
client [76] (test)  loss: 4.8639 -> 4.8061   acc: 1.45% -> 3.08%               
client [41] (test)  loss: 4.7854 -> 4.5890   acc: 5.06% -> 4.70%               
client [62] (test)  loss: 5.3285 -> 4.8273   acc: 0.00% -> 3.09%               
client [2] (test)  loss: 5.3940 -> 4.7952   acc: 0.19% -> 4.45%                
client [14] (test)  loss: 4.9604 -> 4.8884   acc: 6.28% -> 5.91%               
client [46] (test)  loss: 4.8140 -> 4.7024   acc: 1.26% -> 2.89%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7592 -> 4.7243   acc: 5.99% -> 5.59%               
client [68] (test)  loss: 4.7889 -> 4.8142   acc: 3.60% -> 5.76%               
client [57] (test)  loss: 4.8820 -> 4.8228   acc: 4.90% -> 6.72%               
client [17] (test)  loss: 4.8725 -> 4.7652   acc: 6.24% -> 6.06%               
client [54] (test)  loss: 4.5838 -> 4.5229   acc: 1.09% -> 1.45%               
client [23] (test)  loss: 5.2981 -> 4.8039   acc: 1.98% -> 3.77%               
client [35] (test)  loss: 4.9119 -> 4.8222   acc: 2.89% -> 5.61%               
client [59] (test)  loss: 4.7362 -> 4.6967   acc: 2.52% -> 3.06%               
client [31] (test)  loss: 4.5479 -> 4.5540   acc: 7.03% -> 6.67%               
client [9] (test)  loss: 4.9785 -> 4.9793   acc: 3.07% -> 3.29%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.8665 -> 4.6919   acc: 3.63% -> 5.63%               
client [33] (test)  loss: 4.7435 -> 4.7010   acc: 3.07% -> 4.16%               
client [16] (test)  loss: 4.7513 -> 4.7249   acc: 5.74% -> 7.30%               
client [44] (test)  loss: 5.3757 -> 4.6707   acc: 2.89% -> 7.78%               
client [8] (test)  loss: 4.6055 -> 4.4729   acc: 6.53% -> 6.53%                
client [31] (test)  loss: 4.5641 -> 4.5469   acc: 5.95% -> 6.49%               
client [47] (test)  loss: 4.9414 -> 4.8107   acc: 4.24% -> 4.97%               
client [36] (test)  loss: 4.8400 -> 4.7364   acc: 4.32% -> 4.32%               
client [20] (test)  loss: 4.5738 -> 4.4915   acc: 6.06% -> 6.60%               
client [56] (test)  loss: 4.5650 -> 4.5210   acc: 6.69% -> 7.59%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.5065 -> 4.4137   acc: 8.00% -> 8.91%                
client [60] (test)  loss: 4.7908 -> 4.4947   acc: 4.50% -> 4.68%               
client [28] (test)  loss: 5.0197 -> 4.6128   acc: 6.53% -> 8.53%               
client [25] (test)  loss: 5.1288 -> 4.5803   acc: 0.91% -> 5.82%               
client [58] (test)  loss: 4.8676 -> 4.7974   acc: 5.06% -> 5.61%               
client [44] (test)  loss: 4.8326 -> 4.6200   acc: 7.41% -> 8.86%               
client [39] (test)  loss: 4.5799 -> 4.5396   acc: 10.12% -> 9.95%              
client [29] (test)  loss: 5.1121 -> 4.7761   acc: 5.72% -> 7.33%               
client [3] (test)  loss: 4.6393 -> 4.5544   acc: 6.51% -> 7.23%                
client [84] (test)  loss: 4.8602 -> 4.6946   acc: 5.23% -> 5.96%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.9728 -> 4.5671   acc: 6.32% -> 7.40%               
client [84] (test)  loss: 4.7210 -> 4.6500   acc: 6.50% -> 7.22%               
client [10] (test)  loss: 5.0529 -> 4.5978   acc: 3.62% -> 6.69%               
client [36] (test)  loss: 4.7098 -> 4.6996   acc: 5.05% -> 6.67%               
client [65] (test)  loss: 4.7338 -> 4.6985   acc: 9.11% -> 11.01%              
client [81] (test)  loss: 5.2236 -> 5.0019   acc: 2.00% -> 3.09%               
client [79] (test)  loss: 4.5816 -> 4.5389   acc: 10.78% -> 12.83%             
client [42] (test)  loss: 4.9253 -> 4.8526   acc: 6.33% -> 6.69%               
client [11] (test)  loss: 4.4661 -> 4.3853   acc: 13.66% -> 14.46%             
client [96] (test)  loss: 4.8339 -> 4.6120   acc: 5.06% -> 6.69%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.7797 -> 4.5353   acc: 7.08% -> 8.35%                
client [53] (test)  loss: 4.6039 -> 4.4171   acc: 7.57% -> 8.47%               
client [52] (test)  loss: 4.8225 -> 4.8248   acc: 9.87% -> 8.01%               
client [42] (test)  loss: 4.9267 -> 4.9410   acc: 6.15% -> 6.15%               
client [69] (test)  loss: 5.7439 -> 5.2035   acc: 3.66% -> 5.31%               
client [59] (test)  loss: 4.5239 -> 4.5639   acc: 6.29% -> 5.40%               
client [7] (test)  loss: 5.4694 -> 4.7830   acc: 5.00% -> 8.04%                
client [26] (test)  loss: 4.6121 -> 4.4636   acc: 7.45% -> 7.63%               
client [49] (test)  loss: 4.8165 -> 4.9048   acc: 4.35% -> 4.71%               
client [98] (test)  loss: 4.6276 -> 4.5648   acc: 6.87% -> 8.14%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.6980 -> 4.5907   acc: 8.14% -> 9.40%               
client [47] (test)  loss: 5.5559 -> 4.7717   acc: 4.97% -> 7.92%               
client [21] (test)  loss: 4.5972 -> 4.6326   acc: 8.48% -> 8.66%               
client [77] (test)  loss: 4.6618 -> 4.6290   acc: 8.17% -> 8.17%               
client [95] (test)  loss: 4.5937 -> 4.8015   acc: 7.96% -> 6.87%               
client [91] (test)  loss: 4.5835 -> 4.4444   acc: 10.81% -> 12.16%             
client [14] (test)  loss: 4.7854 -> 4.7970   acc: 8.32% -> 8.50%               
client [99] (test)  loss: 4.9878 -> 5.0482   acc: 6.12% -> 6.12%               
client [20] (test)  loss: 4.6583 -> 4.3938   acc: 9.27% -> 9.63%               
client [39] (test)  loss: 4.8549 -> 4.5498   acc: 11.32% -> 12.52%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.9267 -> 4.9478   acc: 8.94% -> 8.75%               
client [62] (test)  loss: 4.8078 -> 4.8281   acc: 6.72% -> 6.53%               
client [71] (test)  loss: 4.2877 -> 4.2689   acc: 11.53% -> 10.81%             
client [97] (test)  loss: 4.7076 -> 4.4907   acc: 8.64% -> 9.74%               
client [30] (test)  loss: 4.7866 -> 4.8003   acc: 8.35% -> 9.62%               
client [88] (test)  loss: 4.6533 -> 4.6434   acc: 7.10% -> 7.28%               
client [60] (test)  loss: 4.5402 -> 4.4153   acc: 6.29% -> 8.09%               
client [82] (test)  loss: 4.7282 -> 4.8516   acc: 6.78% -> 6.61%               
client [91] (test)  loss: 4.4939 -> 4.4789   acc: 12.33% -> 12.84%             
client [57] (test)  loss: 4.7511 -> 4.7358   acc: 8.17% -> 10.16%              
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.7128 -> 4.6640   acc: 8.83% -> 8.83%               
client [15] (test)  loss: 4.4085 -> 4.4398   acc: 7.64% -> 8.53%               
client [71] (test)  loss: 4.3819 -> 4.2918   acc: 10.63% -> 11.89%             
client [97] (test)  loss: 4.6251 -> 4.5950   acc: 8.27% -> 8.64%               
client [53] (test)  loss: 4.7332 -> 4.4194   acc: 8.83% -> 10.99%              
client [77] (test)  loss: 4.9874 -> 4.6348   acc: 8.52% -> 9.22%               
client [76] (test)  loss: 4.9737 -> 4.8258   acc: 4.53% -> 5.98%               
client [79] (test)  loss: 4.7600 -> 4.6433   acc: 13.57% -> 13.75%             
client [28] (test)  loss: 4.8049 -> 4.7749   acc: 9.26% -> 8.35%               
client [99] (test)  loss: 5.3116 -> 5.2469   acc: 4.68% -> 5.76%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.7672 -> 4.7305   acc: 9.19% -> 8.82%               
client [86] (test)  loss: 4.7672 -> 4.6533   acc: 6.17% -> 5.81%               
client [34] (test)  loss: 4.8341 -> 4.8671   acc: 8.48% -> 9.39%               
client [73] (test)  loss: 4.5920 -> 4.5161   acc: 6.73% -> 6.91%               
client [5] (test)  loss: 4.9375 -> 4.9286   acc: 8.65% -> 10.09%               
client [96] (test)  loss: 4.8884 -> 4.8290   acc: 9.04% -> 10.67%              
client [22] (test)  loss: 4.5451 -> 4.4814   acc: 12.30% -> 13.01%             
client [60] (test)  loss: 4.5657 -> 4.4814   acc: 8.45% -> 10.25%              
client [66] (test)  loss: 5.0247 -> 4.8647   acc: 5.09% -> 5.45%               
client [83] (test)  loss: 5.6536 -> 4.8674   acc: 4.55% -> 8.91%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.2660 -> 4.9856   acc: 5.80% -> 8.33%               
client [65] (test)  loss: 5.0958 -> 4.8794   acc: 10.44% -> 11.95%             
client [95] (test)  loss: 5.1185 -> 5.0891   acc: 6.51% -> 7.78%               
client [17] (test)  loss: 6.8019 -> 4.8242   acc: 6.06% -> 10.09%              
client [8] (test)  loss: 5.2264 -> 4.9221   acc: 9.80% -> 10.71%               
client [35] (test)  loss: 5.1785 -> 5.2005   acc: 6.15% -> 4.88%               
client [98] (test)  loss: 4.8385 -> 4.6781   acc: 8.32% -> 11.21%              
client [53] (test)  loss: 4.7035 -> 4.5185   acc: 9.73% -> 11.71%              
client [43] (test)  loss: 5.1529 -> 4.8219   acc: 9.26% -> 9.26%               
client [64] (test)  loss: 5.1736 -> 4.8293   acc: 8.53% -> 8.71%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.1872 -> 4.8124   acc: 11.01% -> 10.29%             
client [88] (test)  loss: 4.9321 -> 4.9645   acc: 7.99% -> 9.41%               
client [38] (test)  loss: 4.9027 -> 5.0332   acc: 9.42% -> 9.24%               
client [3] (test)  loss: 5.2196 -> 4.8706   acc: 6.15% -> 7.59%                
client [5] (test)  loss: 5.1680 -> 5.0849   acc: 7.39% -> 9.37%                
client [41] (test)  loss: 4.7575 -> 4.8059   acc: 9.95% -> 11.21%              
client [7] (test)  loss: 5.4172 -> 4.8609   acc: 8.04% -> 8.21%                
client [37] (test)  loss: 5.2671 -> 4.5023   acc: 10.11% -> 13.18%             
client [45] (test)  loss: 5.3903 -> 4.5966   acc: 8.45% -> 11.80%              
client [47] (test)  loss: 5.9401 -> 4.8944   acc: 7.92% -> 9.02%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.1355 -> 5.0167   acc: 12.00% -> 13.22%             
client [11] (test)  loss: 4.7990 -> 4.7566   acc: 14.85% -> 14.26%             
client [37] (test)  loss: 4.9786 -> 4.6743   acc: 10.83% -> 12.82%             
client [41] (test)  loss: 4.8393 -> 4.8724   acc: 10.67% -> 11.93%             
client [95] (test)  loss: 4.9683 -> 5.6852   acc: 8.68% -> 8.14%               
client [53] (test)  loss: 5.0994 -> 4.6290   acc: 11.89% -> 12.25%             
client [22] (test)  loss: 4.7748 -> 4.6803   acc: 12.12% -> 12.30%             
client [25] (test)  loss: 4.8019 -> 4.9124   acc: 8.18% -> 10.18%              
client [69] (test)  loss: 5.1816 -> 5.1234   acc: 11.36% -> 13.00%             
client [46] (test)  loss: 5.0137 -> 4.8419   acc: 7.58% -> 7.58%               
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.0422 -> 5.1820   acc: 9.94% -> 9.39%               
client [69] (test)  loss: 5.2978 -> 5.2395   acc: 13.55% -> 12.64%             
client [82] (test)  loss: 5.1394 -> 5.2108   acc: 7.13% -> 7.65%               
client [45] (test)  loss: 4.8923 -> 4.7847   acc: 10.74% -> 11.27%             
client [7] (test)  loss: 5.2928 -> 4.9809   acc: 9.29% -> 7.86%                
client [50] (test)  loss: 5.2961 -> 4.9121   acc: 9.04% -> 11.39%              
client [35] (test)  loss: 5.5786 -> 5.4570   acc: 6.33% -> 7.05%               
client [24] (test)  loss: 5.3035 -> 5.1328   acc: 8.38% -> 8.18%               
client [15] (test)  loss: 4.7785 -> 4.7685   acc: 9.77% -> 9.95%               
client [58] (test)  loss: 5.4128 -> 5.5615   acc: 6.69% -> 6.87%               
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 6.0008 -> 5.3410   acc: 13.77% -> 13.60%             
client [76] (test)  loss: 5.6690 -> 5.3171   acc: 6.88% -> 9.06%               
client [67] (test)  loss: 4.7554 -> 4.6028   acc: 11.33% -> 12.04%             
client [37] (test)  loss: 5.5473 -> 4.8770   acc: 11.01% -> 12.82%             
client [58] (test)  loss: 5.6191 -> 5.7214   acc: 6.69% -> 7.59%               
client [64] (test)  loss: 5.2344 -> 5.1150   acc: 10.16% -> 11.62%             
client [77] (test)  loss: 4.8857 -> 4.8727   acc: 9.22% -> 10.26%              
client [55] (test)  loss: 5.8409 -> 5.3715   acc: 9.63% -> 8.73%               
client [12] (test)  loss: 5.5455 -> 5.3501   acc: 9.20% -> 8.43%               
client [89] (test)  loss: 5.8865 -> 5.8497   acc: 7.44% -> 8.17%               
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.5365 -> 5.4801   acc: 9.57% -> 10.65%              
client [51] (test)  loss: 5.4339 -> 5.3777   acc: 6.16% -> 5.98%               
client [8] (test)  loss: 5.4841 -> 5.3376   acc: 10.34% -> 12.34%              
client [18] (test)  loss: 5.2228 -> 5.3606   acc: 11.07% -> 11.43%             
client [94] (test)  loss: 5.4490 -> 5.4922   acc: 9.79% -> 10.65%              
client [81] (test)  loss: 6.1513 -> 5.7439   acc: 6.73% -> 8.36%               
client [3] (test)  loss: 5.3335 -> 5.1899   acc: 8.32% -> 8.32%                
client [11] (test)  loss: 5.1212 -> 5.1409   acc: 13.27% -> 14.46%             
client [95] (test)  loss: 5.6003 -> 6.3746   acc: 7.41% -> 7.78%               
client [67] (test)  loss: 4.8510 -> 4.7152   acc: 12.04% -> 12.04%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.8855 -> 5.1480   acc: 11.55% -> 11.19%             
client [79] (test)  loss: 5.5791 -> 5.6473   acc: 11.90% -> 13.20%             
client [58] (test)  loss: 5.8680 -> 6.0838   acc: 8.32% -> 7.41%               
client [88] (test)  loss: 5.5766 -> 5.3951   acc: 8.88% -> 9.77%               
client [46] (test)  loss: 5.8243 -> 5.2184   acc: 9.21% -> 9.21%               
client [11] (test)  loss: 5.3744 -> 5.2678   acc: 13.27% -> 14.26%             
client [55] (test)  loss: 5.5449 -> 5.7297   acc: 9.09% -> 8.38%               
client [13] (test)  loss: 5.2997 -> 5.1689   acc: 14.79% -> 18.87%             
client [31] (test)  loss: 6.0376 -> 5.2037   acc: 7.39% -> 9.55%               
client [75] (test)  loss: 5.3308 -> 5.3266   acc: 9.57% -> 10.47%              
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.9371 -> 5.7683   acc: 9.19% -> 10.09%              
client [7] (test)  loss: 5.4718 -> 5.4581   acc: 8.75% -> 10.71%               
client [57] (test)  loss: 5.6219 -> 5.6855   acc: 10.89% -> 12.52%             
client [13] (test)  loss: 5.4471 -> 5.4189   acc: 15.95% -> 18.09%             
client [43] (test)  loss: 5.6989 -> 5.4831   acc: 9.62% -> 11.80%              
client [91] (test)  loss: 5.6446 -> 5.0988   acc: 13.18% -> 13.51%             
client [10] (test)  loss: 5.8300 -> 5.7668   acc: 8.50% -> 8.86%               
client [64] (test)  loss: 5.5875 -> 5.5956   acc: 11.98% -> 12.16%             
client [82] (test)  loss: 5.8015 -> 5.9475   acc: 8.17% -> 8.87%               
client [22] (test)  loss: 5.2788 -> 5.2112   acc: 11.76% -> 13.37%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.3665 -> 5.1567   acc: 13.90% -> 13.73%             
client [23] (test)  loss: 5.7173 -> 5.5890   acc: 7.54% -> 7.94%               
client [88] (test)  loss: 5.8443 -> 5.6022   acc: 8.35% -> 9.77%               
client [98] (test)  loss: 5.7329 -> 5.6750   acc: 9.58% -> 11.03%              
client [79] (test)  loss: 5.8774 -> 6.1453   acc: 10.97% -> 13.38%             
client [21] (test)  loss: 5.7366 -> 5.4538   acc: 10.11% -> 11.19%             
client [92] (test)  loss: 5.6537 -> 5.4007   acc: 12.09% -> 13.00%             
client [56] (test)  loss: 5.6489 -> 5.5893   acc: 15.01% -> 14.10%             
client [5] (test)  loss: 6.0939 -> 5.6854   acc: 8.29% -> 9.19%                
client [52] (test)  loss: 6.2362 -> 6.3602   acc: 11.17% -> 10.99%             
==================== FedRep_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '4.8694 -> 0.0000', 'accuracy': '8.60% -> 0.00%'},           
    200: {'loss': '5.9071 -> 0.0000', 'accuracy': '10.09% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_0.5 achieved 10.0%(11.20%) at epoch: 116                                
Convergence (test_after):                                                      
FedRep_0.5 achieved 10.0%(10.49%) at epoch: 100                                
