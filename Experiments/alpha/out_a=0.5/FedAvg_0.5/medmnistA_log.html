==================== ALGORITHM: FedAvg_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.2546 -> 0.6211   acc: 18.36% -> 81.64%             
client [81] (test)  loss: 1.4006 -> 0.3241   acc: 64.76% -> 89.43%             
client [21] (test)  loss: 2.4316 -> 1.2496   acc: 9.49% -> 53.56%              
client [68] (test)  loss: 1.8050 -> 0.6155   acc: 32.04% -> 80.26%             
client [93] (test)  loss: 2.9482 -> 0.5713   acc: 5.22% -> 82.46%              
client [31] (test)  loss: 2.3535 -> 0.6746   acc: 22.03% -> 79.32%             
client [20] (test)  loss: 2.1491 -> 0.8437   acc: 20.66% -> 73.55%             
client [59] (test)  loss: 2.6255 -> 0.4815   acc: 2.97% -> 83.17%              
client [48] (test)  loss: 2.1411 -> 0.7114   acc: 18.72% -> 79.95%             
client [34] (test)  loss: 1.4065 -> 0.6768   acc: 57.38% -> 83.61%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9128 -> 0.5770   acc: 32.48% -> 80.91%             
client [99] (test)  loss: 1.3692 -> 0.4720   acc: 60.48% -> 87.90%             
client [67] (test)  loss: 1.4545 -> 0.5536   acc: 49.37% -> 81.96%             
client [0] (test)  loss: 0.7683 -> 0.4122   acc: 76.56% -> 87.08%              
client [76] (test)  loss: 1.1058 -> 0.5899   acc: 50.00% -> 80.34%             
client [41] (test)  loss: 2.2701 -> 0.8510   acc: 18.16% -> 72.88%             
client [62] (test)  loss: 3.0213 -> 0.2181   acc: 10.16% -> 92.58%             
client [2] (test)  loss: 2.1762 -> 0.9485   acc: 13.27% -> 65.82%              
client [14] (test)  loss: 0.9113 -> 0.5321   acc: 74.42% -> 82.17%             
client [46] (test)  loss: 0.7877 -> 0.6290   acc: 74.85% -> 80.24%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8070 -> 0.4836   acc: 68.30% -> 82.14%             
client [68] (test)  loss: 0.5474 -> 0.2552   acc: 77.02% -> 91.26%             
client [57] (test)  loss: 0.3225 -> 0.2474   acc: 89.78% -> 91.13%             
client [17] (test)  loss: 1.1573 -> 0.3285   acc: 65.80% -> 89.59%             
client [54] (test)  loss: 0.3845 -> 0.2815   acc: 90.48% -> 91.11%             
client [23] (test)  loss: 2.9299 -> 0.4874   acc: 5.05% -> 82.32%              
client [35] (test)  loss: 1.1101 -> 0.5732   acc: 58.72% -> 78.90%             
client [59] (test)  loss: 1.2340 -> 0.3146   acc: 63.70% -> 88.12%             
client [31] (test)  loss: 0.7568 -> 0.3627   acc: 80.00% -> 86.78%             
client [9] (test)  loss: 1.2214 -> 0.5037   acc: 58.89% -> 83.33%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2110 -> 0.4262   acc: 63.18% -> 85.27%             
client [33] (test)  loss: 0.7142 -> 0.2948   acc: 75.13% -> 91.53%             
client [16] (test)  loss: 0.7340 -> 0.5534   acc: 74.61% -> 82.03%             
client [44] (test)  loss: 3.4508 -> 0.0597   acc: 18.52% -> 98.46%             
client [8] (test)  loss: 0.7115 -> 0.2902   acc: 82.29% -> 91.15%              
client [31] (test)  loss: 0.7530 -> 0.3035   acc: 77.63% -> 90.85%             
client [47] (test)  loss: 0.5718 -> 0.2645   acc: 81.13% -> 91.39%             
client [36] (test)  loss: 0.7329 -> 0.2516   acc: 79.75% -> 92.83%             
client [20] (test)  loss: 1.8933 -> 0.4846   acc: 48.76% -> 85.95%             
client [56] (test)  loss: 0.8354 -> 0.2865   acc: 67.64% -> 90.98%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7511 -> 0.3727   acc: 74.18% -> 88.52%              
client [60] (test)  loss: 0.9426 -> 0.1956   acc: 66.67% -> 94.17%             
client [28] (test)  loss: 0.4111 -> 0.2363   acc: 86.27% -> 92.16%             
client [25] (test)  loss: 3.0634 -> 0.3058   acc: 31.78% -> 91.12%             
client [58] (test)  loss: 0.5518 -> 0.2491   acc: 81.48% -> 95.06%             
client [44] (test)  loss: 0.5739 -> 0.0449   acc: 83.64% -> 99.07%             
client [39] (test)  loss: 0.7268 -> 0.3480   acc: 74.15% -> 86.44%             
client [29] (test)  loss: 1.6073 -> 0.3431   acc: 54.46% -> 87.46%             
client [3] (test)  loss: 0.6277 -> 0.3101   acc: 69.58% -> 90.61%              
client [84] (test)  loss: 0.7658 -> 0.6479   acc: 70.03% -> 75.57%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8210 -> 0.6738   acc: 73.22% -> 80.34%             
client [84] (test)  loss: 0.8843 -> 0.6103   acc: 68.73% -> 78.50%             
client [10] (test)  loss: 0.5424 -> 0.0723   acc: 82.34% -> 98.01%             
client [36] (test)  loss: 0.4120 -> 0.2000   acc: 87.54% -> 94.39%             
client [65] (test)  loss: 0.5127 -> 0.3574   acc: 83.33% -> 89.43%             
client [81] (test)  loss: 1.3706 -> 0.1138   acc: 52.42% -> 96.92%             
client [79] (test)  loss: 0.4413 -> 0.1761   acc: 85.38% -> 95.38%             
client [42] (test)  loss: 0.9345 -> 0.2470   acc: 69.95% -> 91.28%             
client [11] (test)  loss: 0.9612 -> 0.3711   acc: 68.61% -> 88.74%             
client [96] (test)  loss: 0.9617 -> 0.1860   acc: 58.13% -> 94.20%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5473 -> 0.2138   acc: 85.16% -> 93.23%              
client [53] (test)  loss: 1.6528 -> 0.4041   acc: 49.71% -> 85.76%             
client [52] (test)  loss: 0.6012 -> 0.3330   acc: 80.66% -> 87.21%             
client [42] (test)  loss: 0.8245 -> 0.2408   acc: 72.25% -> 91.51%             
client [69] (test)  loss: 0.9044 -> 0.3423   acc: 68.66% -> 87.75%             
client [59] (test)  loss: 0.9838 -> 0.2208   acc: 71.62% -> 91.09%             
client [7] (test)  loss: 0.9517 -> 0.1521   acc: 69.51% -> 95.41%              
client [26] (test)  loss: 0.5032 -> 0.0467   acc: 84.59% -> 98.49%             
client [49] (test)  loss: 0.5953 -> 0.4228   acc: 75.32% -> 83.83%             
client [98] (test)  loss: 0.7891 -> 0.4464   acc: 70.18% -> 85.09%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9638 -> 0.4406   acc: 65.50% -> 85.38%             
client [47] (test)  loss: 0.4526 -> 0.2252   acc: 87.42% -> 92.72%             
client [21] (test)  loss: 0.8962 -> 0.6414   acc: 73.22% -> 81.69%             
client [77] (test)  loss: 0.6846 -> 0.2274   acc: 77.29% -> 91.79%             
client [95] (test)  loss: 0.4977 -> 0.2522   acc: 84.19% -> 90.44%             
client [91] (test)  loss: 0.6251 -> 0.2855   acc: 77.09% -> 90.31%             
client [14] (test)  loss: 0.7896 -> 0.2367   acc: 81.40% -> 93.02%             
client [99] (test)  loss: 0.6593 -> 0.2773   acc: 80.65% -> 91.13%             
client [20] (test)  loss: 1.5694 -> 0.2893   acc: 53.72% -> 90.91%             
client [39] (test)  loss: 0.9342 -> 0.3161   acc: 69.92% -> 91.10%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8293 -> 0.3299   acc: 73.77% -> 87.54%             
client [62] (test)  loss: 0.5451 -> 0.0428   acc: 85.99% -> 98.08%             
client [71] (test)  loss: 0.4057 -> 0.1925   acc: 89.18% -> 94.85%             
client [97] (test)  loss: 0.7974 -> 0.2026   acc: 74.06% -> 94.58%             
client [30] (test)  loss: 0.3166 -> 0.1478   acc: 91.22% -> 94.26%             
client [88] (test)  loss: 0.4147 -> 0.2813   acc: 86.64% -> 92.17%             
client [60] (test)  loss: 0.3330 -> 0.1296   acc: 88.75% -> 95.83%             
client [82] (test)  loss: 0.9128 -> 0.5905   acc: 72.52% -> 82.45%             
client [91] (test)  loss: 1.0574 -> 0.2553   acc: 68.72% -> 91.63%             
client [57] (test)  loss: 0.1644 -> 0.1310   acc: 93.82% -> 96.24%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4389 -> 0.2460   acc: 87.80% -> 92.88%             
client [15] (test)  loss: 0.5181 -> 0.1216   acc: 83.63% -> 96.24%             
client [71] (test)  loss: 0.3080 -> 0.2071   acc: 93.81% -> 93.81%             
client [97] (test)  loss: 0.6084 -> 0.2002   acc: 81.60% -> 93.87%             
client [53] (test)  loss: 1.2773 -> 0.3664   acc: 63.37% -> 85.17%             
client [77] (test)  loss: 0.4768 -> 0.2117   acc: 85.51% -> 92.75%             
client [76] (test)  loss: 0.4515 -> 0.2705   acc: 84.14% -> 90.69%             
client [79] (test)  loss: 0.3135 -> 0.1383   acc: 92.31% -> 96.15%             
client [28] (test)  loss: 0.2608 -> 0.1830   acc: 92.81% -> 94.12%             
client [99] (test)  loss: 0.5965 -> 0.2860   acc: 83.06% -> 91.13%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5236 -> 0.1900   acc: 83.73% -> 94.58%             
client [86] (test)  loss: 0.7168 -> 0.2419   acc: 74.74% -> 93.30%             
client [34] (test)  loss: 0.5739 -> 0.2491   acc: 80.00% -> 93.11%             
client [73] (test)  loss: 0.2325 -> 0.0470   acc: 93.53% -> 98.80%             
client [5] (test)  loss: 0.3798 -> 0.2340   acc: 87.36% -> 93.31%              
client [96] (test)  loss: 0.9057 -> 0.1529   acc: 64.73% -> 95.33%             
client [22] (test)  loss: 0.7190 -> 0.2641   acc: 79.92% -> 89.96%             
client [60] (test)  loss: 0.2536 -> 0.1236   acc: 92.92% -> 95.83%             
client [66] (test)  loss: 0.5790 -> 0.1783   acc: 75.81% -> 94.09%             
client [83] (test)  loss: 0.3389 -> 0.0688   acc: 88.92% -> 98.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6988 -> 0.2544   acc: 78.28% -> 92.07%             
client [65] (test)  loss: 0.5521 -> 0.2721   acc: 83.33% -> 90.65%             
client [95] (test)  loss: 0.2591 -> 0.2439   acc: 91.54% -> 90.07%             
client [17] (test)  loss: 0.3852 -> 0.2211   acc: 88.48% -> 91.82%             
client [8] (test)  loss: 0.4255 -> 0.1826   acc: 88.02% -> 93.49%              
client [35] (test)  loss: 0.9558 -> 0.3463   acc: 70.64% -> 90.37%             
client [98] (test)  loss: 0.6178 -> 0.3760   acc: 80.12% -> 87.13%             
client [53] (test)  loss: 0.9394 -> 0.3306   acc: 72.09% -> 86.92%             
client [43] (test)  loss: 0.2782 -> 0.1075   acc: 92.17% -> 96.97%             
client [64] (test)  loss: 1.1108 -> 0.3311   acc: 70.16% -> 87.98%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8998 -> 0.6308   acc: 73.90% -> 83.73%             
client [88] (test)  loss: 0.3128 -> 0.2529   acc: 90.32% -> 93.09%             
client [38] (test)  loss: 0.4137 -> 0.1297   acc: 87.63% -> 95.70%             
client [3] (test)  loss: 0.3074 -> 0.1827   acc: 88.67% -> 93.20%              
client [5] (test)  loss: 0.5017 -> 0.2412   acc: 83.27% -> 93.31%              
client [41] (test)  loss: 1.1955 -> 0.3302   acc: 57.08% -> 88.21%             
client [7] (test)  loss: 0.4823 -> 0.1402   acc: 81.64% -> 95.74%              
client [37] (test)  loss: 0.9522 -> 0.1491   acc: 74.46% -> 96.04%             
client [45] (test)  loss: 0.5481 -> 0.2435   acc: 79.60% -> 91.64%             
client [47] (test)  loss: 1.5903 -> 0.2020   acc: 57.62% -> 93.05%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5019 -> 0.4630   acc: 81.25% -> 86.33%             
client [11] (test)  loss: 0.9184 -> 0.3075   acc: 72.29% -> 90.69%             
client [37] (test)  loss: 0.7154 -> 0.1523   acc: 78.78% -> 96.40%             
client [41] (test)  loss: 0.5902 -> 0.3222   acc: 77.36% -> 89.39%             
client [95] (test)  loss: 0.5810 -> 0.2416   acc: 83.09% -> 91.18%             
client [53] (test)  loss: 1.1056 -> 0.3268   acc: 67.73% -> 86.92%             
client [22] (test)  loss: 0.9503 -> 0.2541   acc: 74.48% -> 91.21%             
client [25] (test)  loss: 0.6892 -> 0.1320   acc: 77.10% -> 94.39%             
client [69] (test)  loss: 0.7571 -> 0.2600   acc: 75.50% -> 90.03%             
client [46] (test)  loss: 0.3951 -> 0.2502   acc: 86.83% -> 90.42%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3413 -> 0.2018   acc: 89.74% -> 93.71%             
client [69] (test)  loss: 0.5079 -> 0.2614   acc: 84.33% -> 90.60%             
client [82] (test)  loss: 1.6441 -> 0.4918   acc: 55.30% -> 85.76%             
client [45] (test)  loss: 0.5991 -> 0.2228   acc: 83.28% -> 91.97%             
client [7] (test)  loss: 0.2773 -> 0.1488   acc: 91.15% -> 96.07%              
client [50] (test)  loss: 0.5702 -> 0.2029   acc: 80.82% -> 93.40%             
client [35] (test)  loss: 0.5442 -> 0.3579   acc: 82.34% -> 89.91%             
client [24] (test)  loss: 0.4076 -> 0.2004   acc: 85.71% -> 93.30%             
client [15] (test)  loss: 0.2910 -> 0.0907   acc: 89.60% -> 97.79%             
client [58] (test)  loss: 0.2694 -> 0.1774   acc: 89.51% -> 95.68%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7744 -> 0.2279   acc: 77.27% -> 92.78%             
client [76] (test)  loss: 0.6811 -> 0.2582   acc: 77.93% -> 93.45%             
client [67] (test)  loss: 0.7449 -> 0.2383   acc: 77.22% -> 93.35%             
client [37] (test)  loss: 1.0955 -> 0.1551   acc: 72.66% -> 95.68%             
client [58] (test)  loss: 0.5494 -> 0.1731   acc: 81.79% -> 95.06%             
client [64] (test)  loss: 1.3123 -> 0.2487   acc: 64.34% -> 91.09%             
client [77] (test)  loss: 0.4877 -> 0.2140   acc: 84.54% -> 92.27%             
client [55] (test)  loss: 0.2789 -> 0.0584   acc: 90.60% -> 98.43%             
client [12] (test)  loss: 0.7228 -> 0.3622   acc: 75.85% -> 88.78%             
client [89] (test)  loss: 1.2937 -> 0.3425   acc: 64.42% -> 89.89%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7284 -> 0.3854   acc: 78.18% -> 85.67%             
client [51] (test)  loss: 0.6391 -> 0.3652   acc: 78.09% -> 87.04%             
client [8] (test)  loss: 0.2640 -> 0.1510   acc: 92.45% -> 94.53%              
client [18] (test)  loss: 0.3678 -> 0.2008   acc: 90.30% -> 93.64%             
client [94] (test)  loss: 0.4016 -> 0.0995   acc: 85.29% -> 97.06%             
client [81] (test)  loss: 0.6660 -> 0.0617   acc: 77.09% -> 97.58%             
client [3] (test)  loss: 0.3031 -> 0.1552   acc: 88.67% -> 93.85%              
client [11] (test)  loss: 0.8887 -> 0.2756   acc: 74.03% -> 91.34%             
client [95] (test)  loss: 0.2858 -> 0.2217   acc: 91.54% -> 92.28%             
client [67] (test)  loss: 0.8316 -> 0.2470   acc: 77.22% -> 92.41%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.8483 -> 0.6557   acc: 81.02% -> 84.75%             
client [79] (test)  loss: 0.3830 -> 0.1481   acc: 91.54% -> 95.38%             
client [58] (test)  loss: 0.2617 -> 0.1636   acc: 91.05% -> 95.68%             
client [88] (test)  loss: 0.2993 -> 0.2778   acc: 92.63% -> 92.63%             
client [46] (test)  loss: 0.4389 -> 0.2279   acc: 82.63% -> 90.42%             
client [11] (test)  loss: 0.8749 -> 0.2792   acc: 74.46% -> 91.13%             
client [55] (test)  loss: 0.1023 -> 0.0607   acc: 96.87% -> 98.17%             
client [13] (test)  loss: 0.5593 -> 0.1314   acc: 83.88% -> 95.47%             
client [31] (test)  loss: 0.4534 -> 0.2382   acc: 87.46% -> 93.90%             
client [75] (test)  loss: 0.3803 -> 0.0603   acc: 89.46% -> 98.13%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2307 -> 0.2175   acc: 89.52% -> 91.27%             
client [7] (test)  loss: 0.4279 -> 0.1668   acc: 86.56% -> 95.41%              
client [57] (test)  loss: 0.1074 -> 0.1035   acc: 97.58% -> 97.58%             
client [13] (test)  loss: 0.3213 -> 0.1386   acc: 89.92% -> 94.96%             
client [43] (test)  loss: 0.1303 -> 0.0944   acc: 96.46% -> 97.98%             
client [91] (test)  loss: 0.7549 -> 0.2010   acc: 78.85% -> 92.51%             
client [10] (test)  loss: 0.6450 -> 0.0893   acc: 80.79% -> 97.35%             
client [64] (test)  loss: 0.3177 -> 0.2176   acc: 87.60% -> 91.47%             
client [82] (test)  loss: 1.8131 -> 0.4522   acc: 55.96% -> 86.42%             
client [22] (test)  loss: 1.1271 -> 0.2336   acc: 73.22% -> 91.21%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1396 -> 0.2492   acc: 67.77% -> 90.08%             
client [23] (test)  loss: 2.6227 -> 0.2170   acc: 36.36% -> 93.94%             
client [88] (test)  loss: 0.3774 -> 0.3056   acc: 91.24% -> 93.09%             
client [98] (test)  loss: 0.4929 -> 0.3360   acc: 82.75% -> 87.72%             
client [79] (test)  loss: 0.6543 -> 0.1497   acc: 86.15% -> 96.92%             
client [21] (test)  loss: 0.9851 -> 0.6916   acc: 74.92% -> 84.07%             
client [92] (test)  loss: 1.4050 -> 0.4102   acc: 66.29% -> 86.29%             
client [56] (test)  loss: 0.7274 -> 0.1491   acc: 81.70% -> 95.76%             
client [5] (test)  loss: 0.2820 -> 0.2711   acc: 92.57% -> 94.05%              
client [52] (test)  loss: 0.6570 -> 0.2944   acc: 78.03% -> 90.16%             
==================== FedAvg_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.7014 -> 0.0000', 'accuracy': '77.93% -> 0.00%'},          
    200: {'loss': '0.5980 -> 0.0000', 'accuracy': '82.53% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_0.5 achieved 10.0%(13.73%) at epoch: 0                                  
FedAvg_0.5 achieved 30.0%(30.65%) at epoch: 1                                  
FedAvg_0.5 achieved 40.0%(45.47%) at epoch: 13                                 
FedAvg_0.5 achieved 50.0%(54.35%) at epoch: 18                                 
FedAvg_0.5 achieved 60.0%(61.96%) at epoch: 23                                 
FedAvg_0.5 achieved 70.0%(70.02%) at epoch: 33                                 
FedAvg_0.5 achieved 80.0%(80.57%) at epoch: 42                                 
Convergence (test_after):                                                      
FedAvg_0.5 achieved 50.0%(59.82%) at epoch: 0                                  
FedAvg_0.5 achieved 60.0%(61.41%) at epoch: 2                                  
FedAvg_0.5 achieved 70.0%(71.87%) at epoch: 3                                  
FedAvg_0.5 achieved 80.0%(80.80%) at epoch: 12                                 
FedAvg_0.5 achieved 90.0%(90.34%) at epoch: 23                                 
