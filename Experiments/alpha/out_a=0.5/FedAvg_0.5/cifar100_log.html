==================== ALGORITHM: FedAvg_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5138 -> 4.0536   acc: 1.97% -> 5.90%               
client [81] (test)  loss: 4.5125 -> 4.0045   acc: 2.30% -> 13.16%              
client [21] (test)  loss: 26.6897 -> 3.9966   acc: 0.70% -> 10.45%             
client [68] (test)  loss: 4.7760 -> 3.9807   acc: 0.30% -> 13.68%              
client [93] (test)  loss: 4.4708 -> 3.8983   acc: 4.23% -> 10.42%              
client [31] (test)  loss: 4.5854 -> 4.0581   acc: 0.00% -> 12.00%              
client [20] (test)  loss: 4.5706 -> 4.2553   acc: 3.45% -> 2.41%               
client [59] (test)  loss: 22.6278 -> 3.9857   acc: 0.00% -> 5.83%              
client [48] (test)  loss: 4.6318 -> 4.1253   acc: 0.66% -> 5.57%               
client [34] (test)  loss: 4.5482 -> 4.1060   acc: 1.11% -> 11.07%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.1236 -> 3.5171   acc: 0.36% -> 14.39%              
client [99] (test)  loss: 4.5091 -> 3.8326   acc: 1.92% -> 14.74%              
client [67] (test)  loss: 4.2709 -> 3.7524   acc: 4.56% -> 12.70%              
client [0] (test)  loss: 4.1563 -> 3.3332   acc: 4.67% -> 19.00%               
client [76] (test)  loss: 4.4989 -> 4.3880   acc: 3.79% -> 5.30%               
client [41] (test)  loss: 6.7091 -> 4.2152   acc: 1.66% -> 2.33%               
client [62] (test)  loss: 282.3582 -> 3.6860   acc: 0.00% -> 14.52%            
client [2] (test)  loss: 269.0051 -> 3.5819   acc: 0.33% -> 15.56%             
client [14] (test)  loss: 4.5461 -> 3.7586   acc: 1.60% -> 11.50%              
client [46] (test)  loss: 4.7053 -> 3.7906   acc: 0.66% -> 15.28%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.9906 -> 3.5814   acc: 10.76% -> 15.62%             
client [68] (test)  loss: 4.3499 -> 3.4348   acc: 5.78% -> 18.24%              
client [57] (test)  loss: 4.2083 -> 3.4426   acc: 8.41% -> 19.09%              
client [17] (test)  loss: 5.2939 -> 3.3715   acc: 0.29% -> 19.88%              
client [54] (test)  loss: 4.0581 -> 3.3934   acc: 5.14% -> 16.72%              
client [23] (test)  loss: 288.8879 -> 4.0818   acc: 0.67% -> 6.67%             
client [35] (test)  loss: 4.1336 -> 3.7139   acc: 7.54% -> 11.15%              
client [59] (test)  loss: 4.0684 -> 3.8275   acc: 9.06% -> 11.00%              
client [31] (test)  loss: 4.2302 -> 3.7117   acc: 5.45% -> 13.09%              
client [9] (test)  loss: 4.2134 -> 3.7724   acc: 1.95% -> 10.75%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.2187 -> 3.2255   acc: 1.99% -> 22.59%              
client [33] (test)  loss: 3.9609 -> 3.5695   acc: 10.92% -> 12.97%             
client [16] (test)  loss: 4.3720 -> 2.9209   acc: 4.21% -> 27.37%              
client [44] (test)  loss: 6.3474 -> 3.4239   acc: 2.64% -> 17.49%              
client [8] (test)  loss: 4.0457 -> 3.3660   acc: 10.79% -> 14.92%              
client [31] (test)  loss: 4.6518 -> 3.9067   acc: 1.82% -> 12.36%              
client [47] (test)  loss: 4.7160 -> 3.7692   acc: 3.44% -> 12.81%              
client [36] (test)  loss: 4.3429 -> 3.9066   acc: 6.25% -> 14.17%              
client [20] (test)  loss: 4.0813 -> 3.6519   acc: 8.97% -> 14.48%              
client [56] (test)  loss: 4.3007 -> 3.7368   acc: 5.94% -> 16.43%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0530 -> 3.3104   acc: 10.26% -> 23.44%              
client [60] (test)  loss: 4.5435 -> 3.7911   acc: 4.81% -> 17.41%              
client [28] (test)  loss: 4.5446 -> 3.4863   acc: 7.42% -> 18.39%              
client [25] (test)  loss: 4.3687 -> 3.0027   acc: 5.50% -> 25.57%              
client [58] (test)  loss: 3.9930 -> 3.4184   acc: 9.75% -> 15.72%              
client [44] (test)  loss: 4.2747 -> 3.2836   acc: 4.95% -> 21.12%              
client [39] (test)  loss: 3.8306 -> 3.6533   acc: 8.58% -> 17.16%              
client [29] (test)  loss: 6.4438 -> 3.4668   acc: 1.66% -> 21.26%              
client [3] (test)  loss: 3.9307 -> 3.0656   acc: 7.77% -> 28.48%               
client [84] (test)  loss: 4.4340 -> 3.4145   acc: 3.74% -> 19.00%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.0304 -> 3.1915   acc: 4.53% -> 23.34%              
client [84] (test)  loss: 4.2044 -> 3.3023   acc: 5.30% -> 21.50%              
client [10] (test)  loss: 5.1339 -> 3.0528   acc: 6.23% -> 19.34%              
client [36] (test)  loss: 4.5708 -> 3.7947   acc: 6.67% -> 20.00%              
client [65] (test)  loss: 4.4639 -> 3.3600   acc: 4.85% -> 25.89%              
client [81] (test)  loss: 3.8534 -> 3.7327   acc: 15.46% -> 18.09%             
client [79] (test)  loss: 3.8861 -> 3.3666   acc: 11.96% -> 23.26%             
client [42] (test)  loss: 4.8267 -> 3.5729   acc: 6.46% -> 17.35%              
client [11] (test)  loss: 4.1023 -> 3.4410   acc: 8.42% -> 17.89%              
client [96] (test)  loss: 4.6411 -> 3.5727   acc: 6.80% -> 13.59%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.9192 -> 3.3071   acc: 11.75% -> 20.63%              
client [53] (test)  loss: 4.2327 -> 3.2604   acc: 7.57% -> 19.41%              
client [52] (test)  loss: 5.1624 -> 3.2118   acc: 4.21% -> 21.68%              
client [42] (test)  loss: 4.8378 -> 3.1173   acc: 5.78% -> 25.17%              
client [69] (test)  loss: 3.5420 -> 3.3533   acc: 13.31% -> 21.58%             
client [59] (test)  loss: 3.8693 -> 3.5017   acc: 14.24% -> 12.94%             
client [7] (test)  loss: 4.7945 -> 3.6172   acc: 6.39% -> 15.65%               
client [26] (test)  loss: 3.9235 -> 4.3801   acc: 7.64% -> 18.60%              
client [49] (test)  loss: 4.1390 -> 3.4904   acc: 8.06% -> 18.95%              
client [98] (test)  loss: 3.7995 -> 3.4209   acc: 12.70% -> 15.31%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.6289 -> 3.5113   acc: 13.68% -> 16.29%             
client [47] (test)  loss: 4.6475 -> 3.2342   acc: 7.81% -> 22.81%              
client [21] (test)  loss: 4.1088 -> 3.0658   acc: 10.45% -> 26.83%             
client [77] (test)  loss: 3.9895 -> 3.2036   acc: 12.46% -> 21.97%             
client [95] (test)  loss: 3.8174 -> 3.3316   acc: 12.87% -> 18.15%             
client [91] (test)  loss: 3.7496 -> 3.5638   acc: 14.42% -> 20.51%             
client [14] (test)  loss: 4.1010 -> 3.1289   acc: 6.71% -> 26.20%              
client [99] (test)  loss: 3.9433 -> 3.2491   acc: 8.97% -> 24.04%              
client [20] (test)  loss: 3.9723 -> 3.0989   acc: 10.34% -> 24.83%             
client [39] (test)  loss: 4.2988 -> 3.7885   acc: 10.89% -> 19.14%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.4452 -> 3.1828   acc: 6.15% -> 23.95%              
client [62] (test)  loss: 3.7318 -> 3.3456   acc: 13.53% -> 21.78%             
client [71] (test)  loss: 4.0012 -> 3.8259   acc: 14.86% -> 16.55%             
client [97] (test)  loss: 3.8894 -> 2.9029   acc: 16.72% -> 31.27%             
client [30] (test)  loss: 3.3894 -> 4.9291   acc: 21.33% -> 8.67%              
client [88] (test)  loss: 3.4720 -> 3.0681   acc: 17.38% -> 23.76%             
client [60] (test)  loss: 3.9895 -> 4.0345   acc: 10.37% -> 20.37%             
client [82] (test)  loss: 3.8102 -> 3.7595   acc: 13.31% -> 13.99%             
client [91] (test)  loss: 4.0191 -> 3.4328   acc: 10.90% -> 24.68%             
client [57] (test)  loss: 4.4377 -> 3.3304   acc: 6.80% -> 22.98%              
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.3021 -> 3.2452   acc: 11.27% -> 23.64%             
client [15] (test)  loss: 3.9986 -> 3.5296   acc: 9.24% -> 20.46%              
client [71] (test)  loss: 4.2773 -> 3.8416   acc: 10.81% -> 15.88%             
client [97] (test)  loss: 3.7706 -> 2.9154   acc: 15.17% -> 32.82%             
client [53] (test)  loss: 4.4751 -> 3.1766   acc: 8.22% -> 23.36%              
client [77] (test)  loss: 3.9028 -> 3.0118   acc: 15.08% -> 25.57%             
client [76] (test)  loss: 4.3075 -> 3.5308   acc: 11.74% -> 18.18%             
client [79] (test)  loss: 3.9008 -> 3.1770   acc: 16.28% -> 29.24%             
client [28] (test)  loss: 3.8369 -> 3.6004   acc: 13.87% -> 19.35%             
client [99] (test)  loss: 3.9587 -> 3.2221   acc: 10.58% -> 23.40%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.5969 -> 2.8247   acc: 18.89% -> 31.89%             
client [86] (test)  loss: 3.4769 -> 3.1976   acc: 18.18% -> 27.60%             
client [34] (test)  loss: 4.5967 -> 3.3572   acc: 10.70% -> 22.51%             
client [73] (test)  loss: 3.3518 -> 3.2380   acc: 21.36% -> 26.86%             
client [5] (test)  loss: 4.1389 -> 3.5203   acc: 12.91% -> 21.85%              
client [96] (test)  loss: 3.4901 -> 3.1016   acc: 20.06% -> 22.01%             
client [22] (test)  loss: 4.2110 -> 3.2661   acc: 12.91% -> 22.19%             
client [60] (test)  loss: 3.7911 -> 3.9127   acc: 12.96% -> 17.41%             
client [66] (test)  loss: 4.8524 -> 3.4436   acc: 5.32% -> 17.94%              
client [83] (test)  loss: 4.2822 -> 3.0613   acc: 6.14% -> 26.28%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.8865 -> 3.4125   acc: 17.42% -> 21.59%             
client [65] (test)  loss: 4.8787 -> 3.1223   acc: 7.12% -> 32.36%              
client [95] (test)  loss: 4.0592 -> 3.1551   acc: 12.21% -> 25.74%             
client [17] (test)  loss: 4.9882 -> 3.0004   acc: 11.11% -> 31.58%             
client [8] (test)  loss: 3.6124 -> 3.0597   acc: 16.19% -> 28.89%              
client [35] (test)  loss: 3.5265 -> 3.3272   acc: 16.72% -> 22.30%             
client [98] (test)  loss: 3.5563 -> 3.0800   acc: 19.22% -> 25.08%             
client [53] (test)  loss: 4.0300 -> 3.1600   acc: 9.21% -> 22.04%              
client [43] (test)  loss: 4.3165 -> 3.4035   acc: 7.92% -> 16.17%              
client [64] (test)  loss: 3.1648 -> 2.7058   acc: 22.59% -> 33.55%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.9236 -> 3.2724   acc: 16.72% -> 27.18%             
client [88] (test)  loss: 4.1612 -> 2.8540   acc: 13.83% -> 28.72%             
client [38] (test)  loss: 3.6907 -> 2.4721   acc: 11.15% -> 39.67%             
client [3] (test)  loss: 3.7005 -> 3.2317   acc: 18.45% -> 29.45%              
client [5] (test)  loss: 4.0015 -> 3.6554   acc: 15.23% -> 19.87%              
client [41] (test)  loss: 4.7177 -> 2.9881   acc: 9.63% -> 27.57%              
client [7] (test)  loss: 3.9936 -> 3.4873   acc: 9.90% -> 20.77%               
client [37] (test)  loss: 3.8405 -> 3.2080   acc: 13.20% -> 29.04%             
client [45] (test)  loss: 4.0173 -> 3.2104   acc: 13.29% -> 29.90%             
client [47] (test)  loss: 5.1202 -> 3.0598   acc: 8.75% -> 27.19%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.1495 -> 2.5857   acc: 11.58% -> 35.53%             
client [11] (test)  loss: 4.3551 -> 3.0201   acc: 11.58% -> 28.07%             
client [37] (test)  loss: 3.6534 -> 3.1139   acc: 16.17% -> 31.35%             
client [41] (test)  loss: 4.7232 -> 3.0852   acc: 10.63% -> 26.58%             
client [95] (test)  loss: 4.9147 -> 3.1496   acc: 6.93% -> 27.72%              
client [53] (test)  loss: 3.8967 -> 3.3135   acc: 12.17% -> 21.71%             
client [22] (test)  loss: 4.1716 -> 3.3333   acc: 13.91% -> 26.49%             
client [25] (test)  loss: 3.6355 -> 2.8497   acc: 21.36% -> 30.42%             
client [69] (test)  loss: 3.7312 -> 3.0349   acc: 13.31% -> 32.37%             
client [46] (test)  loss: 3.5064 -> 3.4300   acc: 17.61% -> 24.25%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.9316 -> 3.0920   acc: 12.50% -> 26.56%             
client [69] (test)  loss: 3.6314 -> 3.0148   acc: 15.83% -> 30.22%             
client [82] (test)  loss: 4.1810 -> 3.6257   acc: 15.36% -> 18.09%             
client [45] (test)  loss: 4.0702 -> 2.9983   acc: 12.29% -> 31.89%             
client [7] (test)  loss: 3.8332 -> 3.2386   acc: 12.46% -> 23.32%              
client [50] (test)  loss: 3.7356 -> 3.1670   acc: 20.93% -> 25.91%             
client [35] (test)  loss: 3.5039 -> 3.2291   acc: 20.98% -> 25.57%             
client [24] (test)  loss: 3.9055 -> 3.1094   acc: 11.81% -> 27.43%             
client [15] (test)  loss: 4.2846 -> 3.3595   acc: 8.58% -> 25.41%              
client [58] (test)  loss: 3.3441 -> 3.0359   acc: 22.64% -> 30.19%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.2332 -> 3.2972   acc: 8.52% -> 25.90%              
client [76] (test)  loss: 4.6323 -> 3.4518   acc: 12.12% -> 21.97%             
client [67] (test)  loss: 3.5286 -> 3.6507   acc: 22.80% -> 21.82%             
client [37] (test)  loss: 3.8700 -> 3.2667   acc: 16.83% -> 28.05%             
client [58] (test)  loss: 3.7896 -> 2.9752   acc: 21.38% -> 31.13%             
client [64] (test)  loss: 3.0697 -> 2.7041   acc: 22.26% -> 33.89%             
client [77] (test)  loss: 3.5938 -> 3.1625   acc: 17.70% -> 26.56%             
client [55] (test)  loss: 4.5354 -> 3.6136   acc: 13.12% -> 19.86%             
client [12] (test)  loss: 3.8780 -> 3.2884   acc: 16.94% -> 22.92%             
client [89] (test)  loss: 3.6013 -> 3.0234   acc: 16.72% -> 31.19%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.7806 -> 3.0816   acc: 14.95% -> 28.04%             
client [51] (test)  loss: 3.5596 -> 3.0357   acc: 14.62% -> 30.56%             
client [8] (test)  loss: 3.9761 -> 3.0629   acc: 11.11% -> 33.97%              
client [18] (test)  loss: 3.2586 -> 2.6890   acc: 21.97% -> 33.77%             
client [94] (test)  loss: 4.0443 -> 3.3110   acc: 12.01% -> 29.33%             
client [81] (test)  loss: 3.3883 -> 3.0750   acc: 20.39% -> 31.58%             
client [3] (test)  loss: 3.7388 -> 3.6619   acc: 17.80% -> 28.48%              
client [11] (test)  loss: 3.6639 -> 3.5684   acc: 22.81% -> 26.67%             
client [95] (test)  loss: 4.8359 -> 3.2403   acc: 7.92% -> 27.06%              
client [67] (test)  loss: 3.4573 -> 3.1894   acc: 20.20% -> 27.04%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.7854 -> 3.1427   acc: 12.54% -> 27.53%             
client [79] (test)  loss: 4.2297 -> 3.6724   acc: 18.60% -> 27.91%             
client [58] (test)  loss: 3.7278 -> 2.9310   acc: 22.01% -> 34.28%             
client [88] (test)  loss: 4.1064 -> 2.7405   acc: 14.54% -> 32.98%             
client [46] (test)  loss: 3.8252 -> 3.2928   acc: 17.94% -> 28.24%             
client [11] (test)  loss: 4.7658 -> 3.3051   acc: 11.93% -> 30.18%             
client [55] (test)  loss: 3.9143 -> 3.5285   acc: 18.79% -> 21.99%             
client [13] (test)  loss: 4.1241 -> 3.3015   acc: 13.24% -> 25.44%             
client [31] (test)  loss: 4.4398 -> 3.4870   acc: 15.64% -> 26.55%             
client [75] (test)  loss: 4.1408 -> 3.0473   acc: 15.52% -> 28.66%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.6403 -> 3.1697   acc: 18.89% -> 27.69%             
client [7] (test)  loss: 3.8628 -> 3.0786   acc: 12.14% -> 25.24%              
client [57] (test)  loss: 3.8560 -> 3.5262   acc: 20.06% -> 27.51%             
client [13] (test)  loss: 4.2394 -> 3.2330   acc: 12.89% -> 26.13%             
client [43] (test)  loss: 4.1080 -> 3.1466   acc: 14.85% -> 26.40%             
client [91] (test)  loss: 3.7702 -> 3.0827   acc: 16.03% -> 30.45%             
client [10] (test)  loss: 4.0258 -> 2.7808   acc: 17.70% -> 32.46%             
client [64] (test)  loss: 3.0244 -> 2.7841   acc: 25.58% -> 32.56%             
client [82] (test)  loss: 4.1749 -> 3.5081   acc: 15.70% -> 20.48%             
client [22] (test)  loss: 3.9262 -> 3.3007   acc: 20.53% -> 26.49%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.2688 -> 2.9249   acc: 21.72% -> 28.97%             
client [23] (test)  loss: 4.5046 -> 3.3120   acc: 16.00% -> 28.00%             
client [88] (test)  loss: 4.1293 -> 2.7835   acc: 15.25% -> 29.79%             
client [98] (test)  loss: 3.5446 -> 2.8837   acc: 22.15% -> 31.92%             
client [79] (test)  loss: 4.1108 -> 3.8091   acc: 21.59% -> 28.24%             
client [21] (test)  loss: 3.8754 -> 3.0757   acc: 18.82% -> 32.75%             
client [92] (test)  loss: 4.0285 -> 3.2773   acc: 14.67% -> 28.00%             
client [56] (test)  loss: 3.8371 -> 3.6548   acc: 18.18% -> 26.57%             
client [5] (test)  loss: 3.4750 -> 5.1782   acc: 20.86% -> 13.25%              
client [52] (test)  loss: 3.4041 -> 3.0914   acc: 22.98% -> 33.01%             
==================== FedAvg_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '4.1509 -> 0.0000', 'accuracy': '12.07% -> 0.00%'},          
    200: {'loss': '4.0262 -> 0.0000', 'accuracy': '16.71% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_0.5 achieved 10.0%(10.82%) at epoch: 66                                 
Convergence (test_after):                                                      
FedAvg_0.5 achieved 10.0%(10.83%) at epoch: 12                                 
FedAvg_0.5 achieved 20.0%(20.75%) at epoch: 49                                 
FedAvg_0.5 achieved 30.0%(30.88%) at epoch: 151                                
