==================== ALGORITHM: FedAvg_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.0776 -> 0.4337   acc: 71.03% -> 87.66%             
client [81] (test)  loss: 0.5918 -> 0.2955   acc: 82.84% -> 92.54%             
client [21] (test)  loss: 8.0443 -> 0.4946   acc: 73.03% -> 84.24%             
client [68] (test)  loss: 1.4083 -> 0.6906   acc: 35.83% -> 73.86%             
client [93] (test)  loss: 0.7567 -> 0.5939   acc: 79.07% -> 73.39%             
client [31] (test)  loss: 1.0510 -> 0.6042   acc: 66.20% -> 81.28%             
client [20] (test)  loss: 0.4705 -> 0.2458   acc: 90.50% -> 90.24%             
client [59] (test)  loss: 12.2285 -> 0.3615   acc: 59.39% -> 90.83%            
client [48] (test)  loss: 1.1173 -> 0.6599   acc: 58.93% -> 71.79%             
client [34] (test)  loss: 0.6875 -> 0.4391   acc: 80.41% -> 85.75%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.0644 -> 0.4103   acc: 58.04% -> 86.90%             
client [99] (test)  loss: 1.1821 -> 0.2910   acc: 58.15% -> 90.74%             
client [67] (test)  loss: 0.5134 -> 0.3029   acc: 80.08% -> 89.13%             
client [0] (test)  loss: 0.7271 -> 0.5814   acc: 68.41% -> 78.65%              
client [76] (test)  loss: 1.1716 -> 0.3880   acc: 53.38% -> 84.64%             
client [41] (test)  loss: 0.7970 -> 0.1469   acc: 62.78% -> 94.72%             
client [62] (test)  loss: 38.4659 -> 0.2577   acc: 39.72% -> 91.99%            
client [2] (test)  loss: 51.0897 -> 0.4808   acc: 13.56% -> 85.80%             
client [14] (test)  loss: 0.6050 -> 0.3940   acc: 76.84% -> 86.65%             
client [46] (test)  loss: 1.0868 -> 0.4473   acc: 54.93% -> 81.87%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1159 -> 0.6095   acc: 50.27% -> 73.40%             
client [68] (test)  loss: 1.3375 -> 0.4868   acc: 40.82% -> 81.64%             
client [57] (test)  loss: 0.1778 -> 0.0614   acc: 95.56% -> 97.78%             
client [17] (test)  loss: 0.5612 -> 0.2771   acc: 78.42% -> 91.49%             
client [54] (test)  loss: 0.7664 -> 0.4581   acc: 73.19% -> 82.31%             
client [23] (test)  loss: 68.9282 -> 0.3228   acc: 8.75% -> 91.25%             
client [35] (test)  loss: 0.4055 -> 0.2134   acc: 86.30% -> 93.02%             
client [59] (test)  loss: 0.3898 -> 0.1920   acc: 89.96% -> 94.76%             
client [31] (test)  loss: 0.5935 -> 0.4206   acc: 78.21% -> 85.20%             
client [9] (test)  loss: 0.5666 -> 0.1253   acc: 80.32% -> 94.73%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6051 -> 0.1683   acc: 82.00% -> 93.14%             
client [33] (test)  loss: 0.4636 -> 0.1264   acc: 83.33% -> 95.71%             
client [16] (test)  loss: 0.7473 -> 0.2132   acc: 73.57% -> 93.39%             
client [44] (test)  loss: 1.6083 -> 0.1834   acc: 43.56% -> 93.56%             
client [8] (test)  loss: 0.3508 -> 0.2732   acc: 88.65% -> 92.14%              
client [31] (test)  loss: 0.5056 -> 0.3946   acc: 80.73% -> 85.20%             
client [47] (test)  loss: 0.6610 -> 0.2947   acc: 77.14% -> 91.21%             
client [36] (test)  loss: 0.4531 -> 0.1452   acc: 85.00% -> 94.62%             
client [20] (test)  loss: 0.4567 -> 0.1665   acc: 85.22% -> 94.46%             
client [56] (test)  loss: 0.5402 -> 0.4555   acc: 78.82% -> 82.51%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8496 -> 0.5700   acc: 74.61% -> 77.34%              
client [60] (test)  loss: 0.5288 -> 0.2690   acc: 80.00% -> 92.73%             
client [28] (test)  loss: 0.4276 -> 0.1292   acc: 87.04% -> 95.77%             
client [25] (test)  loss: 0.4712 -> 0.2501   acc: 83.06% -> 91.53%             
client [58] (test)  loss: 1.0395 -> 0.6195   acc: 63.46% -> 74.73%             
client [44] (test)  loss: 0.3720 -> 0.1816   acc: 89.43% -> 93.30%             
client [39] (test)  loss: 0.3298 -> 0.2834   acc: 89.06% -> 89.97%             
client [29] (test)  loss: 0.4739 -> 0.4606   acc: 82.94% -> 80.58%             
client [3] (test)  loss: 0.2615 -> 0.2108   acc: 91.12% -> 92.89%              
client [84] (test)  loss: 0.7880 -> 0.2939   acc: 71.29% -> 90.68%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8734 -> 0.3420   acc: 66.67% -> 90.61%             
client [84] (test)  loss: 0.6962 -> 0.2904   acc: 76.05% -> 90.87%             
client [10] (test)  loss: 0.3209 -> 0.2804   acc: 89.87% -> 90.82%             
client [36] (test)  loss: 0.6825 -> 0.1592   acc: 76.92% -> 93.46%             
client [65] (test)  loss: 0.4260 -> 0.3659   acc: 84.09% -> 87.34%             
client [81] (test)  loss: 0.3315 -> 0.1549   acc: 89.55% -> 94.78%             
client [79] (test)  loss: 0.9964 -> 0.4906   acc: 64.55% -> 81.27%             
client [42] (test)  loss: 0.6512 -> 0.3315   acc: 77.05% -> 88.89%             
client [11] (test)  loss: 0.1792 -> 0.0954   acc: 93.91% -> 96.61%             
client [96] (test)  loss: 0.7264 -> 0.4583   acc: 73.81% -> 83.07%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5147 -> 0.2596   acc: 81.22% -> 92.58%              
client [53] (test)  loss: 0.5961 -> 0.4039   acc: 78.07% -> 84.05%             
client [52] (test)  loss: 0.3147 -> 0.3070   acc: 88.60% -> 91.52%             
client [42] (test)  loss: 0.4830 -> 0.3398   acc: 80.92% -> 86.96%             
client [69] (test)  loss: 0.3463 -> 0.3400   acc: 89.88% -> 88.69%             
client [59] (test)  loss: 0.3941 -> 0.1817   acc: 88.21% -> 94.76%             
client [7] (test)  loss: 0.8174 -> 0.3239   acc: 71.30% -> 90.87%              
client [26] (test)  loss: 0.3375 -> 0.0972   acc: 87.43% -> 95.63%             
client [49] (test)  loss: 0.4723 -> 0.4304   acc: 81.35% -> 83.79%             
client [98] (test)  loss: 0.4443 -> 0.1000   acc: 83.42% -> 97.37%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3507 -> 0.1009   acc: 87.37% -> 96.84%             
client [47] (test)  loss: 0.7976 -> 0.2924   acc: 68.13% -> 90.11%             
client [21] (test)  loss: 0.5074 -> 0.3538   acc: 83.33% -> 89.70%             
client [77] (test)  loss: 0.4976 -> 0.2664   acc: 84.63% -> 91.94%             
client [95] (test)  loss: 0.7426 -> 0.3104   acc: 74.81% -> 90.70%             
client [91] (test)  loss: 0.2725 -> 0.1877   acc: 92.11% -> 94.40%             
client [14] (test)  loss: 0.7609 -> 0.3281   acc: 74.39% -> 88.56%             
client [99] (test)  loss: 0.4792 -> 0.2233   acc: 84.81% -> 94.44%             
client [20] (test)  loss: 0.3728 -> 0.1563   acc: 87.60% -> 93.93%             
client [39] (test)  loss: 0.3095 -> 0.2823   acc: 89.06% -> 90.27%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3217 -> 0.2857   acc: 89.47% -> 91.23%             
client [62] (test)  loss: 0.2466 -> 0.1890   acc: 91.29% -> 93.03%             
client [71] (test)  loss: 0.5406 -> 0.3262   acc: 81.48% -> 87.65%             
client [97] (test)  loss: 0.4915 -> 0.3743   acc: 81.32% -> 87.55%             
client [30] (test)  loss: 0.7047 -> 0.4437   acc: 77.10% -> 86.92%             
client [88] (test)  loss: 0.4250 -> 0.3542   acc: 87.30% -> 89.84%             
client [60] (test)  loss: 0.5443 -> 0.2814   acc: 84.24% -> 91.82%             
client [82] (test)  loss: 0.7231 -> 1.1333   acc: 73.48% -> 67.40%             
client [91] (test)  loss: 0.3347 -> 0.1881   acc: 90.84% -> 94.40%             
client [57] (test)  loss: 0.2826 -> 0.0565   acc: 88.89% -> 97.78%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5611 -> 0.3739   acc: 81.84% -> 86.87%             
client [15] (test)  loss: 0.3970 -> 0.3788   acc: 84.56% -> 87.02%             
client [71] (test)  loss: 0.6532 -> 0.3061   acc: 77.78% -> 87.65%             
client [97] (test)  loss: 0.5061 -> 0.3759   acc: 83.27% -> 88.72%             
client [53] (test)  loss: 0.7207 -> 0.3937   acc: 73.09% -> 86.05%             
client [77] (test)  loss: 0.6804 -> 0.3010   acc: 77.33% -> 91.44%             
client [76] (test)  loss: 1.3524 -> 0.3883   acc: 61.79% -> 87.02%             
client [79] (test)  loss: 1.0112 -> 0.5109   acc: 67.15% -> 82.13%             
client [28] (test)  loss: 0.4068 -> 0.1433   acc: 89.58% -> 95.21%             
client [99] (test)  loss: 0.3779 -> 0.2411   acc: 89.63% -> 93.70%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5987 -> 0.3790   acc: 79.77% -> 86.77%             
client [86] (test)  loss: 0.3368 -> 0.2859   acc: 90.86% -> 92.29%             
client [34] (test)  loss: 0.3846 -> 0.2489   acc: 88.55% -> 91.35%             
client [73] (test)  loss: 0.4266 -> 0.3260   acc: 85.35% -> 90.48%             
client [5] (test)  loss: 0.2272 -> 0.1690   acc: 92.17% -> 95.85%              
client [96] (test)  loss: 0.6228 -> 0.4342   acc: 78.84% -> 84.13%             
client [22] (test)  loss: 0.8406 -> 0.3518   acc: 71.48% -> 89.60%             
client [60] (test)  loss: 0.5781 -> 0.3038   acc: 81.82% -> 91.52%             
client [66] (test)  loss: 0.5064 -> 0.2512   acc: 82.07% -> 93.23%             
client [83] (test)  loss: 0.5344 -> 0.2731   acc: 83.80% -> 92.13%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.9803 -> 0.3906   acc: 70.38% -> 87.57%             
client [65] (test)  loss: 0.4614 -> 0.3782   acc: 81.82% -> 87.66%             
client [95] (test)  loss: 0.6032 -> 0.3470   acc: 80.62% -> 88.76%             
client [17] (test)  loss: 0.4726 -> 0.2882   acc: 83.28% -> 91.79%             
client [8] (test)  loss: 0.4951 -> 0.2909   acc: 81.22% -> 92.58%              
client [35] (test)  loss: 0.4037 -> 0.1704   acc: 86.82% -> 93.54%             
client [98] (test)  loss: 0.3245 -> 0.0924   acc: 87.89% -> 96.84%             
client [53] (test)  loss: 0.5783 -> 0.4067   acc: 81.06% -> 85.71%             
client [43] (test)  loss: 0.4117 -> 0.2650   acc: 85.93% -> 90.20%             
client [64] (test)  loss: 0.6521 -> 0.1466   acc: 78.86% -> 94.86%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5899 -> 0.3398   acc: 80.61% -> 91.21%             
client [88] (test)  loss: 0.4332 -> 0.3610   acc: 87.94% -> 92.06%             
client [38] (test)  loss: 1.0631 -> 0.4476   acc: 65.47% -> 88.67%             
client [3] (test)  loss: 0.3529 -> 0.1926   acc: 88.32% -> 92.89%              
client [5] (test)  loss: 0.3025 -> 0.1782   acc: 91.24% -> 96.08%              
client [41] (test)  loss: 0.3858 -> 0.1432   acc: 88.06% -> 95.83%             
client [7] (test)  loss: 0.9115 -> 0.3357   acc: 74.35% -> 91.30%              
client [37] (test)  loss: 0.5574 -> 0.2349   acc: 81.25% -> 92.71%             
client [45] (test)  loss: 0.3951 -> 0.2260   acc: 87.50% -> 94.15%             
client [47] (test)  loss: 0.6387 -> 0.3262   acc: 76.48% -> 89.23%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6530 -> 0.1955   acc: 82.58% -> 94.89%             
client [11] (test)  loss: 0.2192 -> 0.0905   acc: 90.74% -> 95.49%             
client [37] (test)  loss: 0.5174 -> 0.2366   acc: 84.38% -> 92.71%             
client [41] (test)  loss: 0.3050 -> 0.1460   acc: 89.44% -> 96.11%             
client [95] (test)  loss: 0.9151 -> 0.3580   acc: 70.93% -> 90.70%             
client [53] (test)  loss: 0.6602 -> 0.4051   acc: 79.07% -> 85.38%             
client [22] (test)  loss: 0.7636 -> 0.3545   acc: 75.50% -> 89.93%             
client [25] (test)  loss: 0.4889 -> 0.2761   acc: 85.18% -> 91.86%             
client [69] (test)  loss: 0.3185 -> 0.2902   acc: 92.26% -> 91.67%             
client [46] (test)  loss: 0.6231 -> 0.2281   acc: 78.67% -> 92.27%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7742 -> 0.3344   acc: 71.87% -> 89.45%             
client [69] (test)  loss: 0.2788 -> 0.2781   acc: 91.67% -> 91.07%             
client [82] (test)  loss: 0.8453 -> 0.7179   acc: 73.20% -> 76.52%             
client [45] (test)  loss: 0.4146 -> 0.2285   acc: 88.30% -> 93.88%             
client [7] (test)  loss: 0.6396 -> 0.3247   acc: 82.61% -> 92.39%              
client [50] (test)  loss: 0.5609 -> 0.2935   acc: 84.03% -> 92.72%             
client [35] (test)  loss: 0.3825 -> 0.1902   acc: 87.86% -> 93.54%             
client [24] (test)  loss: 0.7941 -> 0.4872   acc: 69.95% -> 83.24%             
client [15] (test)  loss: 0.3949 -> 0.4243   acc: 87.37% -> 86.32%             
client [58] (test)  loss: 0.8964 -> 0.6022   acc: 73.35% -> 78.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8525 -> 0.4633   acc: 76.79% -> 83.57%             
client [76] (test)  loss: 1.0351 -> 0.4220   acc: 70.93% -> 87.39%             
client [67] (test)  loss: 0.4197 -> 0.2672   acc: 86.12% -> 91.15%             
client [37] (test)  loss: 0.6145 -> 0.2396   acc: 82.29% -> 92.97%             
client [58] (test)  loss: 0.8742 -> 0.6242   acc: 74.73% -> 78.02%             
client [64] (test)  loss: 0.3787 -> 0.1479   acc: 88.86% -> 94.00%             
client [77] (test)  loss: 0.6875 -> 0.3158   acc: 80.60% -> 90.43%             
client [55] (test)  loss: 0.5350 -> 0.1465   acc: 83.88% -> 94.86%             
client [12] (test)  loss: 0.3541 -> 0.2685   acc: 88.35% -> 94.04%             
client [89] (test)  loss: 0.3712 -> 0.2477   acc: 88.71% -> 93.42%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6125 -> 0.2481   acc: 82.13% -> 92.59%             
client [51] (test)  loss: 0.6271 -> 0.0931   acc: 81.40% -> 97.84%             
client [8] (test)  loss: 0.2749 -> 0.3104   acc: 89.96% -> 91.70%              
client [18] (test)  loss: 0.3392 -> 0.2071   acc: 87.33% -> 92.47%             
client [94] (test)  loss: 0.4406 -> 0.2673   acc: 87.59% -> 91.90%             
client [81] (test)  loss: 0.3277 -> 0.1273   acc: 88.06% -> 95.52%             
client [3] (test)  loss: 0.2694 -> 0.2076   acc: 90.10% -> 92.39%              
client [11] (test)  loss: 0.2523 -> 0.0979   acc: 92.55% -> 96.16%             
client [95] (test)  loss: 0.7449 -> 0.3670   acc: 79.84% -> 89.53%             
client [67] (test)  loss: 0.6019 -> 0.2748   acc: 80.28% -> 90.95%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4000 -> 0.3467   acc: 87.58% -> 90.30%             
client [79] (test)  loss: 1.2359 -> 0.5191   acc: 62.82% -> 83.29%             
client [58] (test)  loss: 0.9489 -> 0.6429   acc: 73.35% -> 77.75%             
client [88] (test)  loss: 0.4145 -> 0.4152   acc: 88.25% -> 89.84%             
client [46] (test)  loss: 0.5599 -> 0.2338   acc: 83.47% -> 90.40%             
client [11] (test)  loss: 0.2243 -> 0.0994   acc: 90.52% -> 96.39%             
client [55] (test)  loss: 0.6073 -> 0.1505   acc: 82.48% -> 93.93%             
client [13] (test)  loss: 0.4488 -> 0.2963   acc: 83.76% -> 89.69%             
client [31] (test)  loss: 0.9254 -> 0.3985   acc: 73.18% -> 86.31%             
client [75] (test)  loss: 0.3460 -> 0.0847   acc: 89.95% -> 97.28%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4242 -> 0.1732   acc: 85.45% -> 95.31%             
client [7] (test)  loss: 0.4764 -> 0.3530   acc: 84.78% -> 91.52%              
client [57] (test)  loss: 0.3090 -> 0.0555   acc: 89.72% -> 98.33%             
client [13] (test)  loss: 0.4593 -> 0.2875   acc: 85.82% -> 90.46%             
client [43] (test)  loss: 0.4934 -> 0.2762   acc: 86.18% -> 90.45%             
client [91] (test)  loss: 0.2126 -> 0.1492   acc: 93.89% -> 95.17%             
client [10] (test)  loss: 0.3520 -> 0.3017   acc: 89.56% -> 90.51%             
client [64] (test)  loss: 0.2650 -> 0.1390   acc: 90.86% -> 95.14%             
client [82] (test)  loss: 1.2189 -> 0.6960   acc: 65.47% -> 78.45%             
client [22] (test)  loss: 0.9761 -> 0.3606   acc: 70.81% -> 88.93%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2506 -> 0.1698   acc: 91.03% -> 93.67%             
client [23] (test)  loss: 0.7464 -> 0.3728   acc: 75.00% -> 86.88%             
client [88] (test)  loss: 0.5254 -> 0.4148   acc: 85.08% -> 89.52%             
client [98] (test)  loss: 0.1651 -> 0.0952   acc: 95.53% -> 97.11%             
client [79] (test)  loss: 1.1044 -> 0.5502   acc: 65.71% -> 82.13%             
client [21] (test)  loss: 0.4608 -> 0.3431   acc: 84.55% -> 90.61%             
client [92] (test)  loss: 0.1128 -> 0.0560   acc: 96.96% -> 97.47%             
client [56] (test)  loss: 0.4786 -> 0.5518   acc: 84.48% -> 85.22%             
client [5] (test)  loss: 0.3361 -> 0.1872   acc: 90.09% -> 95.85%              
client [52] (test)  loss: 0.2826 -> 0.2592   acc: 90.06% -> 93.57%             
==================== FedAvg_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.5637 -> 0.0000', 'accuracy': '81.29% -> 0.00%'},          
    200: {'loss': '0.5306 -> 0.0000', 'accuracy': '83.58% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_0.5 achieved 10.0%(13.21%) at epoch: 1                                  
FedAvg_0.5 achieved 30.0%(32.50%) at epoch: 2                                  
FedAvg_0.5 achieved 40.0%(46.01%) at epoch: 6                                  
FedAvg_0.5 achieved 60.0%(61.13%) at epoch: 7                                  
FedAvg_0.5 achieved 70.0%(76.33%) at epoch: 22                                 
FedAvg_0.5 achieved 80.0%(80.76%) at epoch: 30                                 
Convergence (test_after):                                                      
FedAvg_0.5 achieved 50.0%(51.52%) at epoch: 0                                  
FedAvg_0.5 achieved 60.0%(67.56%) at epoch: 1                                  
FedAvg_0.5 achieved 70.0%(74.40%) at epoch: 2                                  
FedAvg_0.5 achieved 80.0%(82.21%) at epoch: 4                                  
FedAvg_0.5 achieved 90.0%(90.59%) at epoch: 34                                 
