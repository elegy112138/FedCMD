==================== ALGORITHM: FedProx_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9412 -> 0.6509   acc: 68.57% -> 77.14%             
client [81] (test)  loss: 1.0846 -> 0.7674   acc: 59.10% -> 67.23%             
client [21] (test)  loss: 10.9962 -> 0.6260   acc: 57.50% -> 84.17%            
client [68] (test)  loss: 0.9946 -> 0.7565   acc: 67.72% -> 75.32%             
client [93] (test)  loss: 1.1662 -> 0.6204   acc: 54.60% -> 79.37%             
client [31] (test)  loss: 1.1847 -> 0.6961   acc: 49.90% -> 74.16%             
client [20] (test)  loss: 0.9243 -> 0.7327   acc: 68.47% -> 74.84%             
client [59] (test)  loss: 11.3571 -> 0.4219   acc: 55.71% -> 87.43%            
client [48] (test)  loss: 0.6479 -> 0.3257   acc: 83.20% -> 87.66%             
client [34] (test)  loss: 0.6957 -> 0.4618   acc: 77.45% -> 84.24%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6811 -> 0.3115   acc: 76.36% -> 89.35%             
client [99] (test)  loss: 0.5696 -> 0.3458   acc: 81.07% -> 88.98%             
client [67] (test)  loss: 0.6109 -> 0.3580   acc: 82.12% -> 89.67%             
client [0] (test)  loss: 0.5871 -> 0.5015   acc: 80.85% -> 81.65%              
client [76] (test)  loss: 0.6208 -> 0.2850   acc: 79.44% -> 89.94%             
client [41] (test)  loss: 0.8046 -> 0.6021   acc: 67.90% -> 78.23%             
client [62] (test)  loss: 22.0119 -> 0.5372   acc: 44.34% -> 83.49%            
client [2] (test)  loss: 27.5388 -> 0.5204   acc: 33.33% -> 80.65%             
client [14] (test)  loss: 0.7018 -> 0.4111   acc: 73.05% -> 85.64%             
client [46] (test)  loss: 0.6660 -> 0.3478   acc: 76.09% -> 85.42%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5041 -> 0.4141   acc: 80.60% -> 86.15%             
client [68] (test)  loss: 0.5178 -> 0.4704   acc: 81.65% -> 80.38%             
client [57] (test)  loss: 0.5161 -> 0.3357   acc: 84.12% -> 89.17%             
client [17] (test)  loss: 0.5717 -> 0.2400   acc: 80.63% -> 92.41%             
client [54] (test)  loss: 0.4051 -> 0.2636   acc: 87.59% -> 91.41%             
client [23] (test)  loss: 43.4384 -> 0.2548   acc: 13.16% -> 92.78%            
client [35] (test)  loss: 0.4722 -> 0.3384   acc: 81.90% -> 86.94%             
client [59] (test)  loss: 0.4487 -> 0.2527   acc: 84.57% -> 92.00%             
client [31] (test)  loss: 0.6630 -> 0.5362   acc: 71.97% -> 78.53%             
client [9] (test)  loss: 0.5487 -> 0.4080   acc: 80.10% -> 83.12%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7832 -> 0.4389   acc: 73.09% -> 83.57%             
client [33] (test)  loss: 0.4779 -> 0.3749   acc: 83.24% -> 85.95%             
client [16] (test)  loss: 0.3244 -> 0.1762   acc: 90.58% -> 93.98%             
client [44] (test)  loss: 0.8539 -> 0.3219   acc: 73.35% -> 88.99%             
client [8] (test)  loss: 0.4128 -> 0.3784   acc: 85.16% -> 84.84%              
client [31] (test)  loss: 0.6970 -> 0.5100   acc: 72.76% -> 79.72%             
client [47] (test)  loss: 0.6528 -> 0.4991   acc: 76.40% -> 81.27%             
client [36] (test)  loss: 0.4698 -> 0.4011   acc: 82.52% -> 83.74%             
client [20] (test)  loss: 0.5673 -> 0.5340   acc: 80.89% -> 81.21%             
client [56] (test)  loss: 0.4661 -> 0.4710   acc: 83.44% -> 83.44%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7225 -> 0.5335   acc: 72.68% -> 76.03%              
client [60] (test)  loss: 0.4309 -> 0.2053   acc: 85.64% -> 94.06%             
client [28] (test)  loss: 0.6840 -> 0.6136   acc: 78.80% -> 82.95%             
client [25] (test)  loss: 0.6163 -> 0.4217   acc: 77.04% -> 86.02%             
client [58] (test)  loss: 0.3929 -> 0.2155   acc: 87.17% -> 92.67%             
client [44] (test)  loss: 0.4460 -> 0.2911   acc: 82.38% -> 89.65%             
client [39] (test)  loss: 0.6137 -> 0.3766   acc: 75.75% -> 85.01%             
client [29] (test)  loss: 0.8444 -> 0.4849   acc: 68.56% -> 84.43%             
client [3] (test)  loss: 0.5215 -> 0.3330   acc: 79.61% -> 89.26%              
client [84] (test)  loss: 0.6049 -> 0.3531   acc: 77.68% -> 86.96%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4508 -> 0.3304   acc: 85.83% -> 89.72%             
client [84] (test)  loss: 0.5549 -> 0.3475   acc: 80.58% -> 87.25%             
client [10] (test)  loss: 0.5085 -> 0.2959   acc: 83.33% -> 89.44%             
client [36] (test)  loss: 0.5326 -> 0.3725   acc: 80.67% -> 86.50%             
client [65] (test)  loss: 0.3026 -> 0.2909   acc: 89.06% -> 90.18%             
client [81] (test)  loss: 0.5169 -> 0.4831   acc: 78.15% -> 80.39%             
client [79] (test)  loss: 0.6894 -> 0.4552   acc: 76.24% -> 80.39%             
client [42] (test)  loss: 0.9098 -> 0.3573   acc: 62.33% -> 88.84%             
client [11] (test)  loss: 0.4600 -> 0.4054   acc: 83.33% -> 87.68%             
client [96] (test)  loss: 0.3511 -> 0.2655   acc: 87.26% -> 90.86%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3625 -> 0.3506   acc: 86.13% -> 86.77%              
client [53] (test)  loss: 0.4002 -> 0.1741   acc: 86.40% -> 94.74%             
client [52] (test)  loss: 0.5842 -> 0.4304   acc: 78.67% -> 85.60%             
client [42] (test)  loss: 0.5964 -> 0.3556   acc: 76.28% -> 89.77%             
client [69] (test)  loss: 0.3508 -> 0.2560   acc: 86.49% -> 90.91%             
client [59] (test)  loss: 0.4013 -> 0.2290   acc: 87.71% -> 93.14%             
client [7] (test)  loss: 0.4602 -> 0.4280   acc: 83.89% -> 84.72%              
client [26] (test)  loss: 0.2521 -> 0.2560   acc: 92.28% -> 91.23%             
client [49] (test)  loss: 0.4925 -> 0.4226   acc: 81.62% -> 84.73%             
client [98] (test)  loss: 0.4737 -> 0.4998   acc: 80.83% -> 78.89%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5499 -> 0.4563   acc: 78.61% -> 81.94%             
client [47] (test)  loss: 0.7188 -> 0.4155   acc: 72.66% -> 86.52%             
client [21] (test)  loss: 0.4014 -> 0.3263   acc: 85.83% -> 89.17%             
client [77] (test)  loss: 0.4392 -> 0.3027   acc: 82.86% -> 87.14%             
client [95] (test)  loss: 0.4329 -> 0.2818   acc: 85.35% -> 89.58%             
client [91] (test)  loss: 0.6100 -> 0.4149   acc: 76.84% -> 84.47%             
client [14] (test)  loss: 0.4042 -> 0.2913   acc: 86.40% -> 88.41%             
client [99] (test)  loss: 0.3082 -> 0.2453   acc: 90.11% -> 91.24%             
client [20] (test)  loss: 0.5297 -> 0.4717   acc: 82.80% -> 82.80%             
client [39] (test)  loss: 0.7578 -> 0.3311   acc: 68.39% -> 87.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5818 -> 0.4323   acc: 78.39% -> 84.49%             
client [62] (test)  loss: 0.4581 -> 0.4393   acc: 87.77% -> 86.85%             
client [71] (test)  loss: 0.3232 -> 0.2511   acc: 88.14% -> 91.81%             
client [97] (test)  loss: 0.5601 -> 0.3807   acc: 80.97% -> 86.19%             
client [30] (test)  loss: 0.3796 -> 0.2705   acc: 83.11% -> 92.91%             
client [88] (test)  loss: 0.5617 -> 0.4444   acc: 79.61% -> 81.82%             
client [60] (test)  loss: 0.3464 -> 0.2263   acc: 91.34% -> 94.80%             
client [82] (test)  loss: 0.3899 -> 0.2982   acc: 87.31% -> 89.80%             
client [91] (test)  loss: 0.5215 -> 0.3935   acc: 79.21% -> 86.05%             
client [57] (test)  loss: 0.3718 -> 0.3120   acc: 89.89% -> 90.61%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6669 -> 0.5195   acc: 77.34% -> 80.91%             
client [15] (test)  loss: 0.3476 -> 0.3393   acc: 88.09% -> 88.92%             
client [71] (test)  loss: 0.3100 -> 0.2487   acc: 90.11% -> 92.94%             
client [97] (test)  loss: 0.5464 -> 0.3945   acc: 81.34% -> 85.82%             
client [53] (test)  loss: 0.4058 -> 0.1835   acc: 83.77% -> 94.74%             
client [77] (test)  loss: 0.3615 -> 0.3019   acc: 86.79% -> 87.50%             
client [76] (test)  loss: 0.4142 -> 0.2877   acc: 85.01% -> 91.22%             
client [79] (test)  loss: 0.7273 -> 0.4797   acc: 77.07% -> 80.39%             
client [28] (test)  loss: 0.5836 -> 0.6106   acc: 82.49% -> 80.65%             
client [99] (test)  loss: 0.2894 -> 0.2386   acc: 90.68% -> 91.53%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4890 -> 0.3920   acc: 82.09% -> 85.82%             
client [86] (test)  loss: 0.2024 -> 0.1541   acc: 93.49% -> 94.42%             
client [34] (test)  loss: 0.3998 -> 0.3701   acc: 86.14% -> 87.77%             
client [73] (test)  loss: 0.3765 -> 0.2857   acc: 86.57% -> 90.15%             
client [5] (test)  loss: 0.5355 -> 0.4148   acc: 81.23% -> 85.44%              
client [96] (test)  loss: 0.2387 -> 0.2452   acc: 91.69% -> 91.14%             
client [22] (test)  loss: 0.4847 -> 0.4248   acc: 83.55% -> 87.74%             
client [60] (test)  loss: 0.3599 -> 0.2389   acc: 88.37% -> 94.06%             
client [66] (test)  loss: 0.4836 -> 0.4330   acc: 84.07% -> 87.41%             
client [83] (test)  loss: 0.3688 -> 0.2154   acc: 89.95% -> 93.81%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4521 -> 0.2674   acc: 85.01% -> 91.65%             
client [65] (test)  loss: 0.2556 -> 0.2959   acc: 91.07% -> 90.40%             
client [95] (test)  loss: 0.4628 -> 0.2755   acc: 84.23% -> 90.42%             
client [17] (test)  loss: 0.4078 -> 0.2664   acc: 87.96% -> 93.19%             
client [8] (test)  loss: 0.2902 -> 0.4094   acc: 89.35% -> 84.19%              
client [35] (test)  loss: 0.5061 -> 0.3344   acc: 80.41% -> 89.55%             
client [98] (test)  loss: 0.5448 -> 0.4328   acc: 81.39% -> 85.00%             
client [53] (test)  loss: 0.3211 -> 0.1929   acc: 89.47% -> 94.96%             
client [43] (test)  loss: 0.2702 -> 0.1610   acc: 92.47% -> 95.70%             
client [64] (test)  loss: 0.5891 -> 0.4344   acc: 83.00% -> 86.97%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3819 -> 0.3303   acc: 88.06% -> 89.17%             
client [88] (test)  loss: 0.6687 -> 0.4738   acc: 76.31% -> 83.20%             
client [38] (test)  loss: 0.3509 -> 0.3203   acc: 88.36% -> 90.88%             
client [3] (test)  loss: 0.5187 -> 0.3259   acc: 83.47% -> 90.36%              
client [5] (test)  loss: 0.4988 -> 0.4063   acc: 82.38% -> 85.44%              
client [41] (test)  loss: 0.5749 -> 0.4627   acc: 80.07% -> 83.03%             
client [7] (test)  loss: 0.4456 -> 0.4608   acc: 85.83% -> 85.83%              
client [37] (test)  loss: 0.4110 -> 0.2638   acc: 86.87% -> 91.62%             
client [45] (test)  loss: 0.5495 -> 0.2573   acc: 80.89% -> 89.79%             
client [47] (test)  loss: 0.4942 -> 0.4188   acc: 82.02% -> 86.52%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4257 -> 0.1800   acc: 85.08% -> 94.76%             
client [11] (test)  loss: 0.4699 -> 0.3642   acc: 84.42% -> 88.04%             
client [37] (test)  loss: 0.4102 -> 0.2550   acc: 86.31% -> 92.46%             
client [41] (test)  loss: 0.6742 -> 0.4808   acc: 74.17% -> 82.29%             
client [95] (test)  loss: 0.5330 -> 0.2874   acc: 81.41% -> 89.86%             
client [53] (test)  loss: 0.4203 -> 0.1995   acc: 86.62% -> 94.74%             
client [22] (test)  loss: 0.5111 -> 0.4295   acc: 82.26% -> 87.42%             
client [25] (test)  loss: 0.7710 -> 0.4910   acc: 76.25% -> 85.22%             
client [69] (test)  loss: 0.4060 -> 0.2823   acc: 85.97% -> 91.43%             
client [46] (test)  loss: 0.4747 -> 0.3289   acc: 85.71% -> 89.80%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4420 -> 0.4440   acc: 83.52% -> 86.52%             
client [69] (test)  loss: 0.3987 -> 0.2779   acc: 86.75% -> 91.43%             
client [82] (test)  loss: 0.3496 -> 0.2922   acc: 88.31% -> 91.29%             
client [45] (test)  loss: 0.5957 -> 0.2553   acc: 79.84% -> 91.36%             
client [7] (test)  loss: 0.4093 -> 0.4742   acc: 86.67% -> 86.11%              
client [50] (test)  loss: 0.5326 -> 0.5292   acc: 82.35% -> 81.79%             
client [35] (test)  loss: 0.3784 -> 0.3505   acc: 86.38% -> 87.87%             
client [24] (test)  loss: 0.3927 -> 0.2749   acc: 86.15% -> 91.69%             
client [15] (test)  loss: 0.4371 -> 0.3109   acc: 86.43% -> 90.58%             
client [58] (test)  loss: 0.2371 -> 0.2264   acc: 91.36% -> 92.93%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3180 -> 0.2060   acc: 90.55% -> 93.18%             
client [76] (test)  loss: 0.6139 -> 0.2510   acc: 83.94% -> 92.51%             
client [67] (test)  loss: 0.3628 -> 0.2882   acc: 89.42% -> 92.19%             
client [37] (test)  loss: 0.4586 -> 0.2443   acc: 87.15% -> 91.62%             
client [58] (test)  loss: 0.2685 -> 0.2180   acc: 91.36% -> 92.15%             
client [64] (test)  loss: 0.5811 -> 0.4638   acc: 82.44% -> 85.55%             
client [77] (test)  loss: 0.4184 -> 0.3377   acc: 85.71% -> 86.79%             
client [55] (test)  loss: 0.5108 -> 0.4610   acc: 84.34% -> 88.06%             
client [12] (test)  loss: 0.5409 -> 0.4568   acc: 80.00% -> 81.36%             
client [89] (test)  loss: 0.6765 -> 0.3620   acc: 81.67% -> 89.39%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4811 -> 0.3053   acc: 84.06% -> 88.70%             
client [51] (test)  loss: 0.3683 -> 0.2954   acc: 86.49% -> 88.29%             
client [8] (test)  loss: 0.3711 -> 0.3755   acc: 88.06% -> 87.74%              
client [18] (test)  loss: 0.3056 -> 0.2815   acc: 91.49% -> 93.01%             
client [94] (test)  loss: 0.5199 -> 0.5141   acc: 82.02% -> 84.71%             
client [81] (test)  loss: 0.5698 -> 0.5537   acc: 79.83% -> 79.83%             
client [3] (test)  loss: 0.6029 -> 0.3198   acc: 78.51% -> 90.08%              
client [11] (test)  loss: 0.4612 -> 0.3823   acc: 86.59% -> 87.68%             
client [95] (test)  loss: 0.4859 -> 0.2988   acc: 81.69% -> 91.55%             
client [67] (test)  loss: 0.3364 -> 0.2847   acc: 90.68% -> 93.20%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4111 -> 0.3414   acc: 87.50% -> 90.28%             
client [79] (test)  loss: 0.8577 -> 0.4608   acc: 76.80% -> 83.15%             
client [58] (test)  loss: 0.2341 -> 0.2129   acc: 92.67% -> 91.88%             
client [88] (test)  loss: 0.7988 -> 0.5200   acc: 76.03% -> 83.20%             
client [46] (test)  loss: 0.5339 -> 0.3445   acc: 85.71% -> 89.50%             
client [11] (test)  loss: 0.4713 -> 0.3878   acc: 87.32% -> 87.68%             
client [55] (test)  loss: 0.6676 -> 0.4549   acc: 81.60% -> 88.06%             
client [13] (test)  loss: 0.2988 -> 0.2692   acc: 90.29% -> 91.60%             
client [31] (test)  loss: 0.9616 -> 0.5580   acc: 71.97% -> 79.32%             
client [75] (test)  loss: 0.4695 -> 0.2649   acc: 83.44% -> 92.02%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2593 -> 0.1422   acc: 91.38% -> 94.83%             
client [7] (test)  loss: 0.4559 -> 0.4608   acc: 83.61% -> 85.83%              
client [57] (test)  loss: 0.3385 -> 0.3059   acc: 91.70% -> 92.78%             
client [13] (test)  loss: 0.3828 -> 0.2547   acc: 87.93% -> 91.60%             
client [43] (test)  loss: 0.4196 -> 0.2136   acc: 87.10% -> 95.16%             
client [91] (test)  loss: 0.5615 -> 0.3976   acc: 80.53% -> 87.63%             
client [10] (test)  loss: 0.3281 -> 0.2800   acc: 90.56% -> 92.50%             
client [64] (test)  loss: 0.6194 -> 0.4964   acc: 82.72% -> 86.12%             
client [82] (test)  loss: 0.4491 -> 0.2755   acc: 86.07% -> 91.54%             
client [22] (test)  loss: 0.4804 -> 0.4213   acc: 83.87% -> 88.71%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5783 -> 0.4766   acc: 82.17% -> 85.35%             
client [23] (test)  loss: 0.6820 -> 0.2768   acc: 78.34% -> 94.06%             
client [88] (test)  loss: 0.6528 -> 0.5043   acc: 80.17% -> 84.02%             
client [98] (test)  loss: 0.4038 -> 0.4540   acc: 85.56% -> 85.00%             
client [79] (test)  loss: 0.7679 -> 0.4573   acc: 78.73% -> 85.36%             
client [21] (test)  loss: 0.3906 -> 0.3278   acc: 87.78% -> 92.22%             
client [92] (test)  loss: 0.5261 -> 0.5177   acc: 82.75% -> 81.94%             
client [56] (test)  loss: 0.3605 -> 0.4195   acc: 88.12% -> 88.12%             
client [5] (test)  loss: 0.5850 -> 0.3606   acc: 79.69% -> 88.12%              
client [52] (test)  loss: 0.5877 -> 0.4299   acc: 78.67% -> 86.15%             
==================== FedProx_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.4641 -> 0.0000', 'accuracy': '84.21% -> 0.00%'},          
    200: {'loss': '0.4792 -> 0.0000', 'accuracy': '84.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx_1 achieved 10.0%(13.79%) at epoch: 1                                   
FedProx_1 achieved 30.0%(30.10%) at epoch: 3                                   
FedProx_1 achieved 40.0%(41.92%) at epoch: 4                                   
FedProx_1 achieved 60.0%(68.85%) at epoch: 7                                   
FedProx_1 achieved 70.0%(70.10%) at epoch: 13                                  
FedProx_1 achieved 80.0%(80.27%) at epoch: 37                                  
Convergence (test_after):                                                      
FedProx_1 achieved 40.0%(49.38%) at epoch: 0                                   
FedProx_1 achieved 50.0%(55.65%) at epoch: 1                                   
FedProx_1 achieved 60.0%(66.13%) at epoch: 2                                   
FedProx_1 achieved 70.0%(70.10%) at epoch: 3                                   
FedProx_1 achieved 80.0%(80.30%) at epoch: 8                                   
FedProx_1 achieved 90.0%(91.03%) at epoch: 56                                  
