==================== ALGORITHM: FedProx_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2446 -> 5.0158   acc: 1.62% -> 3.78%               
client [81] (test)  loss: 5.2596 -> 5.0652   acc: 1.11% -> 3.69%               
client [21] (test)  loss: 5.2661 -> 5.0079   acc: 1.09% -> 4.36%               
client [68] (test)  loss: 5.2129 -> 4.8931   acc: 1.45% -> 5.79%               
client [93] (test)  loss: 5.2037 -> 5.0834   acc: 1.63% -> 2.54%               
client [31] (test)  loss: 5.2408 -> 5.0410   acc: 0.54% -> 4.68%               
client [20] (test)  loss: 5.2965 -> 4.9197   acc: 0.38% -> 7.94%               
client [59] (test)  loss: 5.2750 -> 5.0061   acc: 2.00% -> 2.18%               
client [48] (test)  loss: 5.2193 -> 4.9911   acc: 1.61% -> 3.58%               
client [34] (test)  loss: 5.1966 -> 5.1310   acc: 0.91% -> 1.82%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.1327 -> 4.7129   acc: 2.41% -> 6.48%               
client [99] (test)  loss: 5.0367 -> 4.9357   acc: 3.07% -> 3.43%               
client [67] (test)  loss: 5.0041 -> 4.7252   acc: 3.73% -> 6.34%               
client [0] (test)  loss: 4.8868 -> 4.8066   acc: 4.89% -> 5.80%                
client [76] (test)  loss: 4.9732 -> 4.7642   acc: 2.54% -> 5.63%               
client [41] (test)  loss: 5.1691 -> 4.8137   acc: 1.99% -> 2.54%               
client [62] (test)  loss: 5.2151 -> 4.9006   acc: 0.90% -> 4.13%               
client [2] (test)  loss: 5.2346 -> 5.0512   acc: 2.30% -> 1.92%                
client [14] (test)  loss: 4.8899 -> 4.9457   acc: 4.69% -> 5.23%               
client [46] (test)  loss: 5.0592 -> 4.7794   acc: 2.90% -> 4.36%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.8798 -> 4.2661   acc: 5.70% -> 12.48%              
client [68] (test)  loss: 4.6854 -> 4.7093   acc: 4.34% -> 6.15%               
client [57] (test)  loss: 4.7944 -> 4.6942   acc: 4.72% -> 6.35%               
client [17] (test)  loss: 5.6240 -> 4.7594   acc: 3.78% -> 5.77%               
client [54] (test)  loss: 4.6848 -> 4.6062   acc: 5.63% -> 5.26%               
client [23] (test)  loss: 5.1855 -> 4.7541   acc: 1.45% -> 4.88%               
client [35] (test)  loss: 4.7326 -> 4.8118   acc: 6.35% -> 3.99%               
client [59] (test)  loss: 4.6598 -> 4.6218   acc: 4.18% -> 6.36%               
client [31] (test)  loss: 4.7130 -> 4.7298   acc: 5.05% -> 5.95%               
client [9] (test)  loss: 4.9243 -> 4.7874   acc: 4.34% -> 4.52%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6747 -> 4.4953   acc: 8.36% -> 9.11%               
client [33] (test)  loss: 4.5883 -> 4.5511   acc: 6.34% -> 4.17%               
client [16] (test)  loss: 4.4992 -> 4.3882   acc: 7.00% -> 11.85%              
client [44] (test)  loss: 7.9516 -> 4.4570   acc: 3.02% -> 9.06%               
client [8] (test)  loss: 4.6998 -> 4.6611   acc: 4.87% -> 6.68%                
client [31] (test)  loss: 4.6964 -> 4.6883   acc: 5.77% -> 6.49%               
client [47] (test)  loss: 5.2006 -> 4.5690   acc: 4.15% -> 6.32%               
client [36] (test)  loss: 4.6473 -> 4.7200   acc: 5.45% -> 6.18%               
client [20] (test)  loss: 4.8060 -> 4.3857   acc: 6.43% -> 10.02%              
client [56] (test)  loss: 4.6601 -> 4.4834   acc: 8.66% -> 8.30%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4986 -> 4.5231   acc: 9.44% -> 7.26%                
client [60] (test)  loss: 5.2499 -> 4.4636   acc: 7.01% -> 7.37%               
client [28] (test)  loss: 5.4292 -> 4.6748   acc: 5.26% -> 8.17%               
client [25] (test)  loss: 6.1443 -> 4.4377   acc: 3.42% -> 8.29%               
client [58] (test)  loss: 4.6583 -> 4.5632   acc: 8.29% -> 6.67%               
client [44] (test)  loss: 4.4596 -> 4.4233   acc: 10.48% -> 9.59%              
client [39] (test)  loss: 4.3923 -> 4.7393   acc: 9.64% -> 7.82%               
client [29] (test)  loss: 4.9220 -> 4.2832   acc: 7.53% -> 10.51%              
client [3] (test)  loss: 4.7060 -> 4.3139   acc: 7.33% -> 11.99%               
client [84] (test)  loss: 4.5248 -> 4.4244   acc: 11.05% -> 8.15%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.7400 -> 4.5504   acc: 8.17% -> 8.53%               
client [84] (test)  loss: 4.3078 -> 4.2948   acc: 11.96% -> 11.59%             
client [10] (test)  loss: 4.8878 -> 4.2208   acc: 8.99% -> 12.77%              
client [36] (test)  loss: 4.4903 -> 4.3461   acc: 7.64% -> 9.82%               
client [65] (test)  loss: 4.3326 -> 4.5070   acc: 10.34% -> 9.80%              
client [81] (test)  loss: 4.6954 -> 4.2511   acc: 7.75% -> 9.96%               
client [79] (test)  loss: 4.4720 -> 4.3722   acc: 8.88% -> 7.64%               
client [42] (test)  loss: 4.5560 -> 4.4891   acc: 10.00% -> 10.00%             
client [11] (test)  loss: 4.7133 -> 4.4292   acc: 5.40% -> 8.99%               
client [96] (test)  loss: 4.3717 -> 4.0877   acc: 10.09% -> 12.61%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.5010 -> 4.4620   acc: 8.30% -> 9.93%                
client [53] (test)  loss: 4.5720 -> 4.2990   acc: 7.05% -> 11.64%              
client [52] (test)  loss: 4.4821 -> 4.4406   acc: 9.06% -> 11.96%              
client [42] (test)  loss: 4.4583 -> 4.5807   acc: 12.45% -> 11.51%             
client [69] (test)  loss: 4.4505 -> 4.2641   acc: 9.44% -> 12.22%              
client [59] (test)  loss: 4.4270 -> 4.1495   acc: 7.82% -> 14.00%              
client [7] (test)  loss: 4.6720 -> 4.3002   acc: 8.51% -> 11.96%               
client [26] (test)  loss: 4.4270 -> 4.5380   acc: 12.41% -> 8.81%              
client [49] (test)  loss: 4.3310 -> 4.4653   acc: 10.47% -> 11.37%             
client [98] (test)  loss: 4.3400 -> 4.2882   acc: 10.55% -> 11.09%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.3761 -> 4.3200   acc: 10.36% -> 11.45%             
client [47] (test)  loss: 4.8456 -> 4.4484   acc: 9.21% -> 10.65%              
client [21] (test)  loss: 4.3398 -> 4.3876   acc: 10.16% -> 10.89%             
client [77] (test)  loss: 4.2986 -> 4.3826   acc: 9.89% -> 11.69%              
client [95] (test)  loss: 4.3989 -> 4.3982   acc: 9.76% -> 11.07%              
client [91] (test)  loss: 4.5723 -> 4.8374   acc: 12.00% -> 10.73%             
client [14] (test)  loss: 4.2207 -> 4.4244   acc: 10.47% -> 9.75%              
client [99] (test)  loss: 4.2341 -> 4.7269   acc: 13.00% -> 7.76%              
client [20] (test)  loss: 4.4802 -> 4.0176   acc: 9.83% -> 17.96%              
client [39] (test)  loss: 4.3467 -> 4.2030   acc: 11.09% -> 12.73%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.6486 -> 4.4039   acc: 10.51% -> 13.77%             
client [62] (test)  loss: 4.3695 -> 4.8287   acc: 10.41% -> 10.23%             
client [71] (test)  loss: 4.2866 -> 4.3616   acc: 13.08% -> 12.01%             
client [97] (test)  loss: 4.6198 -> 4.5369   acc: 10.55% -> 9.82%              
client [30] (test)  loss: 4.2090 -> 4.4551   acc: 13.04% -> 9.42%              
client [88] (test)  loss: 4.4995 -> 4.2090   acc: 10.67% -> 17.36%             
client [60] (test)  loss: 4.5654 -> 4.2470   acc: 10.25% -> 14.21%             
client [82] (test)  loss: 4.3219 -> 4.2513   acc: 14.29% -> 16.25%             
client [91] (test)  loss: 4.4994 -> 4.6331   acc: 11.09% -> 12.36%             
client [57] (test)  loss: 4.2070 -> 4.2471   acc: 11.62% -> 13.79%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.7109 -> 4.7889   acc: 7.75% -> 10.27%              
client [15] (test)  loss: 4.6993 -> 4.5380   acc: 9.69% -> 10.23%              
client [71] (test)  loss: 4.3766 -> 4.3919   acc: 10.57% -> 11.11%             
client [97] (test)  loss: 4.5467 -> 4.5964   acc: 10.73% -> 10.73%             
client [53] (test)  loss: 4.8457 -> 4.5922   acc: 8.82% -> 9.70%               
client [77] (test)  loss: 4.4300 -> 4.3901   acc: 10.43% -> 11.33%             
client [76] (test)  loss: 4.2688 -> 4.2371   acc: 13.61% -> 17.60%             
client [79] (test)  loss: 4.4963 -> 4.4952   acc: 10.83% -> 8.17%              
client [28] (test)  loss: 4.3518 -> 4.7213   acc: 11.80% -> 11.07%             
client [99] (test)  loss: 4.3928 -> 4.6141   acc: 11.55% -> 10.29%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.4865 -> 4.7093   acc: 13.27% -> 10.18%             
client [86] (test)  loss: 4.3186 -> 4.5948   acc: 10.89% -> 10.89%             
client [34] (test)  loss: 4.4675 -> 4.5088   acc: 10.55% -> 11.45%             
client [73] (test)  loss: 4.3285 -> 4.5933   acc: 12.80% -> 12.20%             
client [5] (test)  loss: 4.4476 -> 4.4673   acc: 9.79% -> 10.68%               
client [96] (test)  loss: 4.1623 -> 4.2472   acc: 13.87% -> 15.86%             
client [22] (test)  loss: 4.3072 -> 4.3263   acc: 11.93% -> 13.38%             
client [60] (test)  loss: 4.6451 -> 4.4079   acc: 10.07% -> 14.39%             
client [66] (test)  loss: 4.6050 -> 4.6569   acc: 11.55% -> 13.18%             
client [83] (test)  loss: 4.8474 -> 4.5695   acc: 10.67% -> 14.47%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.3613 -> 4.4975   acc: 13.79% -> 16.52%             
client [65] (test)  loss: 4.5898 -> 4.6482   acc: 10.16% -> 11.25%             
client [95] (test)  loss: 4.7113 -> 4.7126   acc: 10.88% -> 12.38%             
client [17] (test)  loss: 5.2516 -> 4.5606   acc: 10.81% -> 13.51%             
client [8] (test)  loss: 4.7142 -> 4.9165   acc: 12.27% -> 10.65%              
client [35] (test)  loss: 4.6459 -> 4.5895   acc: 13.97% -> 14.70%             
client [98] (test)  loss: 4.4828 -> 4.6704   acc: 10.36% -> 11.64%             
client [53] (test)  loss: 4.6802 -> 4.8333   acc: 8.99% -> 10.23%              
client [43] (test)  loss: 4.4713 -> 4.7116   acc: 12.32% -> 8.70%              
client [64] (test)  loss: 4.6340 -> 4.5834   acc: 9.85% -> 12.45%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.7908 -> 4.7028   acc: 9.80% -> 11.62%              
client [88] (test)  loss: 4.6923 -> 4.6695   acc: 10.49% -> 15.55%             
client [38] (test)  loss: 4.7614 -> 4.8285   acc: 11.30% -> 10.56%             
client [3] (test)  loss: 4.9297 -> 4.7410   acc: 9.66% -> 15.56%               
client [5] (test)  loss: 4.6469 -> 4.7709   acc: 11.57% -> 9.43%               
client [41] (test)  loss: 4.6415 -> 4.7301   acc: 9.42% -> 10.87%              
client [7] (test)  loss: 4.7427 -> 4.6586   acc: 11.05% -> 13.22%              
client [37] (test)  loss: 4.5102 -> 4.6001   acc: 13.87% -> 13.15%             
client [45] (test)  loss: 5.0020 -> 4.3852   acc: 10.55% -> 13.64%             
client [47] (test)  loss: 5.1032 -> 4.6337   acc: 10.29% -> 13.54%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.7443 -> 4.8737   acc: 11.67% -> 14.18%             
client [11] (test)  loss: 4.6892 -> 4.6396   acc: 10.07% -> 13.49%             
client [37] (test)  loss: 4.5915 -> 4.7063   acc: 12.25% -> 14.77%             
client [41] (test)  loss: 4.7074 -> 4.8704   acc: 9.06% -> 9.78%               
client [95] (test)  loss: 4.8375 -> 4.9827   acc: 10.88% -> 12.57%             
client [53] (test)  loss: 5.2594 -> 5.0323   acc: 9.17% -> 9.52%               
client [22] (test)  loss: 4.6135 -> 4.5992   acc: 11.93% -> 12.84%             
client [25] (test)  loss: 4.6537 -> 4.9303   acc: 11.17% -> 12.07%             
client [69] (test)  loss: 4.9196 -> 4.8872   acc: 8.33% -> 13.89%              
client [46] (test)  loss: 4.8170 -> 4.8729   acc: 11.80% -> 11.43%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.8475 -> 4.8790   acc: 9.21% -> 13.72%              
client [69] (test)  loss: 5.1592 -> 5.0510   acc: 7.78% -> 12.04%              
client [82] (test)  loss: 4.5573 -> 4.6513   acc: 13.75% -> 16.25%             
client [45] (test)  loss: 4.6912 -> 4.7539   acc: 12.18% -> 14.18%             
client [7] (test)  loss: 4.8327 -> 4.9723   acc: 10.69% -> 13.22%              
client [50] (test)  loss: 4.8532 -> 5.0497   acc: 11.78% -> 13.95%             
client [35] (test)  loss: 4.7052 -> 4.9228   acc: 12.52% -> 15.79%             
client [24] (test)  loss: 5.1767 -> 4.6152   acc: 10.52% -> 16.76%             
client [15] (test)  loss: 5.2671 -> 5.0130   acc: 9.87% -> 9.87%               
client [58] (test)  loss: 4.8324 -> 5.2168   acc: 11.71% -> 13.69%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.6697 -> 4.9702   acc: 12.19% -> 11.83%             
client [76] (test)  loss: 4.8689 -> 5.0726   acc: 13.25% -> 14.88%             
client [67] (test)  loss: 4.9463 -> 4.8698   acc: 10.82% -> 15.67%             
client [37] (test)  loss: 5.0294 -> 5.0203   acc: 9.91% -> 12.97%              
client [58] (test)  loss: 5.0085 -> 5.3669   acc: 10.27% -> 13.69%             
client [64] (test)  loss: 5.1305 -> 5.1416   acc: 10.78% -> 12.08%             
client [77] (test)  loss: 4.8615 -> 4.9047   acc: 10.97% -> 13.31%             
client [55] (test)  loss: 5.1720 -> 5.1273   acc: 10.55% -> 13.77%             
client [12] (test)  loss: 5.1713 -> 5.3002   acc: 8.42% -> 10.57%              
client [89] (test)  loss: 4.8174 -> 4.8835   acc: 13.26% -> 15.41%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.0157 -> 5.0504   acc: 13.04% -> 16.85%             
client [51] (test)  loss: 5.1706 -> 5.0569   acc: 12.25% -> 14.77%             
client [8] (test)  loss: 5.1949 -> 5.4078   acc: 11.91% -> 12.45%              
client [18] (test)  loss: 4.7522 -> 5.0622   acc: 12.52% -> 14.13%             
client [94] (test)  loss: 5.2361 -> 5.3499   acc: 7.96% -> 10.49%              
client [81] (test)  loss: 5.3047 -> 5.3779   acc: 8.67% -> 7.93%               
client [3] (test)  loss: 5.4159 -> 5.1408   acc: 8.77% -> 15.03%               
client [11] (test)  loss: 5.1245 -> 5.0169   acc: 9.53% -> 13.49%              
client [95] (test)  loss: 5.3162 -> 5.3927   acc: 10.88% -> 13.88%             
client [67] (test)  loss: 5.1443 -> 4.9952   acc: 11.75% -> 14.93%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.5270 -> 5.1886   acc: 9.98% -> 13.07%              
client [79] (test)  loss: 5.2352 -> 5.3296   acc: 11.01% -> 10.83%             
client [58] (test)  loss: 5.2905 -> 5.5706   acc: 11.17% -> 13.51%             
client [88] (test)  loss: 5.6306 -> 5.2557   acc: 9.40% -> 13.92%              
client [46] (test)  loss: 5.5846 -> 5.2639   acc: 11.62% -> 11.62%             
client [11] (test)  loss: 5.2899 -> 5.1031   acc: 8.99% -> 14.39%              
client [55] (test)  loss: 5.2677 -> 5.3547   acc: 12.16% -> 13.95%             
client [13] (test)  loss: 5.5234 -> 5.2411   acc: 10.69% -> 13.59%             
client [31] (test)  loss: 5.8280 -> 5.6225   acc: 8.11% -> 11.71%              
client [75] (test)  loss: 5.1610 -> 5.1859   acc: 11.55% -> 16.97%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.2984 -> 5.3769   acc: 9.84% -> 11.68%              
client [7] (test)  loss: 5.0856 -> 5.2723   acc: 12.14% -> 14.49%              
client [57] (test)  loss: 5.1113 -> 5.2412   acc: 11.62% -> 13.79%             
client [13] (test)  loss: 5.4337 -> 5.3312   acc: 10.51% -> 13.59%             
client [43] (test)  loss: 5.1785 -> 5.2759   acc: 10.14% -> 10.69%             
client [91] (test)  loss: 5.9687 -> 5.5871   acc: 6.73% -> 13.09%              
client [10] (test)  loss: 5.4101 -> 5.4042   acc: 11.15% -> 14.93%             
client [64] (test)  loss: 5.2372 -> 5.5123   acc: 11.34% -> 12.45%             
client [82] (test)  loss: 5.2370 -> 5.1514   acc: 11.61% -> 15.36%             
client [22] (test)  loss: 5.1232 -> 5.0282   acc: 11.75% -> 13.92%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.5132 -> 5.1533   acc: 10.78% -> 17.96%             
client [23] (test)  loss: 5.8554 -> 5.9922   acc: 9.04% -> 7.05%               
client [88] (test)  loss: 5.8345 -> 5.4511   acc: 8.68% -> 13.20%              
client [98] (test)  loss: 5.4194 -> 5.7384   acc: 10.18% -> 11.27%             
client [79] (test)  loss: 5.3886 -> 5.5759   acc: 11.90% -> 9.77%              
client [21] (test)  loss: 5.5703 -> 5.3248   acc: 10.53% -> 13.79%             
client [92] (test)  loss: 5.6969 -> 5.3215   acc: 10.00% -> 15.89%             
client [56] (test)  loss: 5.4679 -> 5.2025   acc: 13.36% -> 16.25%             
client [5] (test)  loss: 5.6463 -> 5.4639   acc: 10.14% -> 10.85%              
client [52] (test)  loss: 5.6407 -> 5.8855   acc: 11.59% -> 12.50%             
==================== FedProx_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '4.4563 -> 0.0000', 'accuracy': '11.32% -> 0.00%'},          
    200: {'loss': '5.6062 -> 0.0000', 'accuracy': '10.31% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx_1 achieved 10.0%(10.23%) at epoch: 63                                  
Convergence (test_after):                                                      
FedProx_1 achieved 10.0%(10.33%) at epoch: 50                                  
