==================== ALGORITHM: FedProx_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.9797 -> 1.5394   acc: 35.48% -> 41.13%             
client [81] (test)  loss: 2.3423 -> 1.6479   acc: 8.20% -> 48.36%              
client [21] (test)  loss: 2.1427 -> 1.4835   acc: 48.74% -> 51.26%             
client [68] (test)  loss: 1.7726 -> 1.3126   acc: 49.49% -> 51.52%             
client [93] (test)  loss: 1.7391 -> 0.8832   acc: 67.50% -> 74.17%             
client [31] (test)  loss: 2.4524 -> 2.0185   acc: 14.10% -> 44.87%             
client [20] (test)  loss: 1.8324 -> 1.5063   acc: 25.90% -> 46.04%             
client [59] (test)  loss: 2.2829 -> 1.7307   acc: 31.50% -> 37.80%             
client [48] (test)  loss: 1.9995 -> 1.7910   acc: 29.09% -> 40.00%             
client [34] (test)  loss: 1.8447 -> 1.5587   acc: 45.07% -> 45.07%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5023 -> 1.1303   acc: 55.36% -> 61.61%             
client [99] (test)  loss: 1.8679 -> 1.2953   acc: 56.82% -> 60.23%             
client [67] (test)  loss: 1.7584 -> 1.2284   acc: 42.06% -> 61.90%             
client [0] (test)  loss: 1.4828 -> 0.8739   acc: 53.18% -> 77.46%              
client [76] (test)  loss: 1.3494 -> 0.8827   acc: 72.15% -> 74.68%             
client [41] (test)  loss: 1.6865 -> 1.0062   acc: 49.18% -> 68.03%             
client [62] (test)  loss: 2.0683 -> 1.3320   acc: 22.54% -> 57.75%             
client [2] (test)  loss: 2.2899 -> 0.7698   acc: 13.79% -> 84.83%              
client [14] (test)  loss: 1.2562 -> 0.9200   acc: 70.08% -> 73.23%             
client [46] (test)  loss: 1.8425 -> 1.1289   acc: 36.75% -> 63.25%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.2966 -> 0.9362   acc: 62.50% -> 67.86%             
client [68] (test)  loss: 1.1256 -> 0.5898   acc: 62.63% -> 80.81%             
client [57] (test)  loss: 1.4377 -> 0.7428   acc: 42.11% -> 83.04%             
client [17] (test)  loss: 1.3011 -> 1.3914   acc: 58.65% -> 58.65%             
client [54] (test)  loss: 1.5865 -> 1.3746   acc: 43.24% -> 44.59%             
client [23] (test)  loss: 2.2850 -> 1.1450   acc: 18.92% -> 63.51%             
client [35] (test)  loss: 1.3576 -> 0.7559   acc: 57.14% -> 80.95%             
client [59] (test)  loss: 1.1548 -> 0.9167   acc: 64.57% -> 63.78%             
client [31] (test)  loss: 1.6121 -> 1.2183   acc: 35.90% -> 64.10%             
client [9] (test)  loss: 1.4083 -> 0.8269   acc: 59.79% -> 77.32%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9979 -> 0.6673   acc: 62.40% -> 76.80%             
client [33] (test)  loss: 1.1053 -> 0.7175   acc: 65.42% -> 74.77%             
client [16] (test)  loss: 1.0305 -> 0.7456   acc: 66.67% -> 75.00%             
client [44] (test)  loss: 1.4402 -> 0.5988   acc: 48.15% -> 82.22%             
client [8] (test)  loss: 1.0455 -> 0.4749   acc: 70.83% -> 82.64%              
client [31] (test)  loss: 1.6487 -> 1.0877   acc: 46.15% -> 70.51%             
client [47] (test)  loss: 0.7975 -> 0.5253   acc: 73.95% -> 83.19%             
client [36] (test)  loss: 1.5261 -> 0.8957   acc: 45.30% -> 67.52%             
client [20] (test)  loss: 1.2145 -> 0.7944   acc: 56.12% -> 71.22%             
client [56] (test)  loss: 1.0242 -> 0.6645   acc: 66.67% -> 74.36%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6178 -> 0.5736   acc: 77.59% -> 81.03%              
client [60] (test)  loss: 1.4178 -> 0.8749   acc: 51.32% -> 73.68%             
client [28] (test)  loss: 0.8511 -> 0.4481   acc: 71.77% -> 83.06%             
client [25] (test)  loss: 1.2472 -> 0.6986   acc: 57.85% -> 76.03%             
client [58] (test)  loss: 0.5392 -> 0.4459   acc: 80.00% -> 87.50%             
client [44] (test)  loss: 0.6580 -> 0.5162   acc: 80.00% -> 82.96%             
client [39] (test)  loss: 0.7267 -> 0.2644   acc: 76.43% -> 90.00%             
client [29] (test)  loss: 0.9812 -> 0.5539   acc: 64.71% -> 83.19%             
client [3] (test)  loss: 1.0601 -> 0.7899   acc: 58.47% -> 72.88%              
client [84] (test)  loss: 0.9674 -> 0.2738   acc: 68.10% -> 93.87%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9303 -> 0.4622   acc: 71.43% -> 88.24%             
client [84] (test)  loss: 0.6640 -> 0.2300   acc: 82.21% -> 95.09%             
client [10] (test)  loss: 0.9269 -> 0.5858   acc: 74.36% -> 74.36%             
client [36] (test)  loss: 1.3414 -> 0.6032   acc: 57.26% -> 78.63%             
client [65] (test)  loss: 1.0596 -> 0.8813   acc: 62.71% -> 66.10%             
client [81] (test)  loss: 1.1550 -> 0.5604   acc: 62.30% -> 77.05%             
client [79] (test)  loss: 0.7561 -> 0.5538   acc: 75.21% -> 77.78%             
client [42] (test)  loss: 0.6750 -> 0.4509   acc: 81.25% -> 85.94%             
client [11] (test)  loss: 0.9206 -> 0.5430   acc: 66.67% -> 82.58%             
client [96] (test)  loss: 0.6270 -> 0.5826   acc: 78.15% -> 77.31%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8126 -> 0.3873   acc: 78.47% -> 84.72%              
client [53] (test)  loss: 0.4690 -> 0.3332   acc: 85.71% -> 86.55%             
client [52] (test)  loss: 0.9003 -> 0.4032   acc: 70.54% -> 87.60%             
client [42] (test)  loss: 0.5859 -> 0.3860   acc: 80.47% -> 86.72%             
client [69] (test)  loss: 0.8487 -> 0.6342   acc: 74.11% -> 77.68%             
client [59] (test)  loss: 0.8358 -> 0.6451   acc: 73.23% -> 76.38%             
client [7] (test)  loss: 0.9104 -> 0.5381   acc: 66.67% -> 82.22%              
client [26] (test)  loss: 0.5820 -> 0.4946   acc: 83.85% -> 85.38%             
client [49] (test)  loss: 0.4042 -> 0.3241   acc: 85.29% -> 89.71%             
client [98] (test)  loss: 0.6741 -> 0.6434   acc: 81.58% -> 81.58%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6826 -> 0.6273   acc: 77.19% -> 80.70%             
client [47] (test)  loss: 0.6226 -> 0.4051   acc: 84.03% -> 83.19%             
client [21] (test)  loss: 0.6758 -> 0.4307   acc: 83.19% -> 91.60%             
client [77] (test)  loss: 0.6786 -> 0.5493   acc: 74.19% -> 79.03%             
client [95] (test)  loss: 1.0508 -> 0.3511   acc: 63.69% -> 87.15%             
client [91] (test)  loss: 0.7279 -> 0.5203   acc: 69.84% -> 82.54%             
client [14] (test)  loss: 0.4771 -> 0.3174   acc: 81.89% -> 90.55%             
client [99] (test)  loss: 0.7907 -> 0.5374   acc: 72.73% -> 85.23%             
client [20] (test)  loss: 1.3063 -> 0.5593   acc: 59.71% -> 82.73%             
client [39] (test)  loss: 0.3072 -> 0.1958   acc: 93.57% -> 94.29%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.0893 -> 0.3698   acc: 65.89% -> 90.70%             
client [62] (test)  loss: 0.6302 -> 0.3355   acc: 81.69% -> 88.73%             
client [71] (test)  loss: 0.7454 -> 0.6342   acc: 71.76% -> 74.05%             
client [97] (test)  loss: 0.5087 -> 0.2963   acc: 82.55% -> 90.60%             
client [30] (test)  loss: 0.6211 -> 0.4847   acc: 82.68% -> 85.83%             
client [88] (test)  loss: 0.7309 -> 0.4528   acc: 73.53% -> 83.82%             
client [60] (test)  loss: 0.5642 -> 0.5907   acc: 78.95% -> 76.32%             
client [82] (test)  loss: 0.3936 -> 0.2827   acc: 88.52% -> 90.98%             
client [91] (test)  loss: 0.6809 -> 0.4826   acc: 69.84% -> 82.54%             
client [57] (test)  loss: 0.4136 -> 0.3694   acc: 85.38% -> 91.81%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.3919 -> 0.7361   acc: 60.26% -> 76.92%             
client [15] (test)  loss: 1.0926 -> 0.3991   acc: 68.70% -> 86.26%             
client [71] (test)  loss: 0.8267 -> 0.6540   acc: 72.52% -> 74.81%             
client [97] (test)  loss: 0.3639 -> 0.3053   acc: 89.93% -> 90.60%             
client [53] (test)  loss: 0.4070 -> 0.2739   acc: 87.39% -> 88.24%             
client [77] (test)  loss: 0.6165 -> 0.5200   acc: 76.61% -> 81.45%             
client [76] (test)  loss: 0.4937 -> 0.4108   acc: 88.61% -> 89.87%             
client [79] (test)  loss: 0.7491 -> 0.4717   acc: 79.49% -> 82.91%             
client [28] (test)  loss: 0.5255 -> 0.3244   acc: 81.45% -> 85.48%             
client [99] (test)  loss: 0.5575 -> 0.5141   acc: 85.23% -> 86.36%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4520 -> 0.2906   acc: 85.91% -> 90.60%             
client [86] (test)  loss: 0.4703 -> 0.2829   acc: 88.62% -> 92.68%             
client [34] (test)  loss: 0.5328 -> 0.4947   acc: 78.87% -> 82.39%             
client [73] (test)  loss: 0.6347 -> 0.5700   acc: 78.40% -> 77.60%             
client [5] (test)  loss: 0.9556 -> 0.6315   acc: 65.71% -> 76.19%              
client [96] (test)  loss: 0.4818 -> 0.4911   acc: 83.19% -> 84.03%             
client [22] (test)  loss: 0.5129 -> 0.4827   acc: 81.31% -> 80.37%             
client [60] (test)  loss: 0.5551 -> 0.5099   acc: 76.32% -> 82.89%             
client [66] (test)  loss: 0.8001 -> 0.5212   acc: 73.39% -> 83.06%             
client [83] (test)  loss: 0.5165 -> 0.3081   acc: 86.73% -> 88.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4860 -> 0.4104   acc: 89.87% -> 88.61%             
client [65] (test)  loss: 1.1733 -> 0.6927   acc: 68.64% -> 72.88%             
client [95] (test)  loss: 0.9254 -> 0.3521   acc: 70.39% -> 88.27%             
client [17] (test)  loss: 1.8568 -> 0.4667   acc: 51.92% -> 83.65%             
client [8] (test)  loss: 0.6025 -> 0.3571   acc: 84.03% -> 86.81%              
client [35] (test)  loss: 0.3753 -> 0.1805   acc: 86.90% -> 94.05%             
client [98] (test)  loss: 0.5126 -> 0.5098   acc: 81.58% -> 81.58%             
client [53] (test)  loss: 0.3667 -> 0.2552   acc: 87.39% -> 89.08%             
client [43] (test)  loss: 0.6110 -> 0.2784   acc: 78.95% -> 93.30%             
client [64] (test)  loss: 0.4630 -> 0.2924   acc: 80.80% -> 92.80%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7298 -> 0.4842   acc: 84.03% -> 91.60%             
client [88] (test)  loss: 0.7119 -> 0.4040   acc: 74.26% -> 85.29%             
client [38] (test)  loss: 0.4771 -> 0.4968   acc: 85.71% -> 84.52%             
client [3] (test)  loss: 0.6334 -> 0.5486   acc: 77.97% -> 76.27%              
client [5] (test)  loss: 0.7095 -> 0.6159   acc: 77.14% -> 77.14%              
client [41] (test)  loss: 0.4274 -> 0.3659   acc: 82.79% -> 84.43%             
client [7] (test)  loss: 0.6624 -> 0.3902   acc: 80.00% -> 82.96%              
client [37] (test)  loss: 0.5361 -> 0.4035   acc: 82.08% -> 88.68%             
client [45] (test)  loss: 0.6538 -> 0.2423   acc: 78.79% -> 92.93%             
client [47] (test)  loss: 0.6914 -> 0.3670   acc: 84.87% -> 87.39%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5981 -> 0.4227   acc: 80.56% -> 86.11%             
client [11] (test)  loss: 0.5014 -> 0.4740   acc: 84.09% -> 86.36%             
client [37] (test)  loss: 0.5203 -> 0.3914   acc: 83.49% -> 88.68%             
client [41] (test)  loss: 0.3812 -> 0.3694   acc: 86.89% -> 85.25%             
client [95] (test)  loss: 0.7039 -> 0.3271   acc: 77.09% -> 88.83%             
client [53] (test)  loss: 0.4690 -> 0.2410   acc: 86.55% -> 88.24%             
client [22] (test)  loss: 0.4848 -> 0.4218   acc: 84.11% -> 83.18%             
client [25] (test)  loss: 0.5665 -> 0.3706   acc: 83.47% -> 85.95%             
client [69] (test)  loss: 0.9113 -> 0.4816   acc: 73.21% -> 83.04%             
client [46] (test)  loss: 0.6170 -> 0.3750   acc: 79.49% -> 86.32%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5362 -> 0.3495   acc: 86.55% -> 88.24%             
client [69] (test)  loss: 0.8406 -> 0.4601   acc: 75.00% -> 82.14%             
client [82] (test)  loss: 0.5116 -> 0.2100   acc: 80.33% -> 95.90%             
client [45] (test)  loss: 0.5560 -> 0.2330   acc: 81.82% -> 92.93%             
client [7] (test)  loss: 0.4910 -> 0.3812   acc: 82.96% -> 85.19%              
client [50] (test)  loss: 0.3856 -> 0.1613   acc: 84.44% -> 91.85%             
client [35] (test)  loss: 0.1979 -> 0.1663   acc: 94.05% -> 94.05%             
client [24] (test)  loss: 0.4803 -> 0.3305   acc: 80.36% -> 85.71%             
client [15] (test)  loss: 0.6071 -> 0.3713   acc: 81.68% -> 88.55%             
client [58] (test)  loss: 0.3437 -> 0.2347   acc: 90.62% -> 91.88%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6421 -> 0.4529   acc: 76.36% -> 85.45%             
client [76] (test)  loss: 0.4402 -> 0.4204   acc: 87.34% -> 87.34%             
client [67] (test)  loss: 0.4691 -> 0.4893   acc: 85.71% -> 84.92%             
client [37] (test)  loss: 0.5566 -> 0.3855   acc: 84.91% -> 89.15%             
client [58] (test)  loss: 0.2367 -> 0.2236   acc: 90.62% -> 91.88%             
client [64] (test)  loss: 0.3987 -> 0.2601   acc: 88.00% -> 92.00%             
client [77] (test)  loss: 0.5486 -> 0.4539   acc: 78.23% -> 84.68%             
client [55] (test)  loss: 0.4230 -> 0.3834   acc: 84.13% -> 87.30%             
client [12] (test)  loss: 0.9173 -> 0.7186   acc: 67.86% -> 85.00%             
client [89] (test)  loss: 0.6013 -> 0.5463   acc: 86.96% -> 86.23%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4424 -> 0.1468   acc: 85.89% -> 96.93%             
client [51] (test)  loss: 0.3133 -> 0.3504   acc: 90.97% -> 88.39%             
client [8] (test)  loss: 0.3969 -> 0.3093   acc: 85.42% -> 89.58%              
client [18] (test)  loss: 0.7149 -> 0.6125   acc: 79.38% -> 83.51%             
client [94] (test)  loss: 0.4582 -> 0.2872   acc: 89.17% -> 90.83%             
client [81] (test)  loss: 1.1528 -> 0.4406   acc: 66.39% -> 82.79%             
client [3] (test)  loss: 0.5687 -> 0.5205   acc: 81.36% -> 79.66%              
client [11] (test)  loss: 0.4484 -> 0.4569   acc: 86.36% -> 84.85%             
client [95] (test)  loss: 0.6783 -> 0.2796   acc: 77.09% -> 89.39%             
client [67] (test)  loss: 0.4781 -> 0.4366   acc: 83.33% -> 84.13%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6595 -> 0.4398   acc: 83.19% -> 92.44%             
client [79] (test)  loss: 0.9628 -> 0.4015   acc: 76.92% -> 88.89%             
client [58] (test)  loss: 0.2856 -> 0.2416   acc: 92.50% -> 91.88%             
client [88] (test)  loss: 0.6477 -> 0.3886   acc: 77.94% -> 86.03%             
client [46] (test)  loss: 0.7960 -> 0.3661   acc: 74.36% -> 86.32%             
client [11] (test)  loss: 0.5184 -> 0.4444   acc: 83.33% -> 87.12%             
client [55] (test)  loss: 0.4041 -> 0.3647   acc: 87.30% -> 90.48%             
client [13] (test)  loss: 0.5663 -> 0.2761   acc: 79.27% -> 87.80%             
client [31] (test)  loss: 0.8864 -> 0.6009   acc: 66.67% -> 80.77%             
client [75] (test)  loss: 0.8114 -> 0.4125   acc: 73.11% -> 88.24%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4657 -> 0.2912   acc: 81.51% -> 90.76%             
client [7] (test)  loss: 0.5373 -> 0.3561   acc: 82.22% -> 88.89%              
client [57] (test)  loss: 0.3348 -> 0.3056   acc: 91.23% -> 91.81%             
client [13] (test)  loss: 0.6385 -> 0.2710   acc: 80.49% -> 89.02%             
client [43] (test)  loss: 0.5839 -> 0.2863   acc: 83.25% -> 93.30%             
client [91] (test)  loss: 0.8072 -> 0.5388   acc: 71.43% -> 79.37%             
client [10] (test)  loss: 0.5972 -> 0.2999   acc: 87.18% -> 87.18%             
client [64] (test)  loss: 0.3400 -> 0.2266   acc: 88.80% -> 91.20%             
client [82] (test)  loss: 0.3540 -> 0.2117   acc: 87.70% -> 94.26%             
client [22] (test)  loss: 0.4716 -> 0.3881   acc: 81.31% -> 85.05%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9800 -> 0.4853   acc: 71.22% -> 84.17%             
client [23] (test)  loss: 0.7027 -> 0.3228   acc: 71.62% -> 86.49%             
client [88] (test)  loss: 0.5667 -> 0.3921   acc: 81.62% -> 86.76%             
client [98] (test)  loss: 0.4191 -> 0.4300   acc: 85.96% -> 84.21%             
client [79] (test)  loss: 0.6859 -> 0.4270   acc: 84.62% -> 90.60%             
client [21] (test)  loss: 0.5452 -> 0.4385   acc: 88.24% -> 93.28%             
client [92] (test)  loss: 0.4088 -> 0.3453   acc: 83.08% -> 84.62%             
client [56] (test)  loss: 0.3581 -> 0.2934   acc: 88.03% -> 89.74%             
client [5] (test)  loss: 0.8487 -> 0.6720   acc: 75.24% -> 75.24%              
client [52] (test)  loss: 0.9679 -> 0.3837   acc: 72.09% -> 91.47%             
==================== FedProx_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.6373 -> 0.0000', 'accuracy': '79.88% -> 0.00%'},          
    200: {'loss': '0.5375 -> 0.0000', 'accuracy': '83.56% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx_1 achieved 10.0%(12.38%) at epoch: 0                                   
FedProx_1 achieved 20.0%(23.39%) at epoch: 2                                   
FedProx_1 achieved 30.0%(39.84%) at epoch: 8                                   
FedProx_1 achieved 40.0%(40.81%) at epoch: 11                                  
FedProx_1 achieved 50.0%(53.86%) at epoch: 20                                  
FedProx_1 achieved 60.0%(65.07%) at epoch: 34                                  
FedProx_1 achieved 70.0%(72.33%) at epoch: 48                                  
FedProx_1 achieved 80.0%(80.88%) at epoch: 75                                  
Convergence (test_after):                                                      
FedProx_1 achieved 30.0%(34.29%) at epoch: 0                                   
FedProx_1 achieved 40.0%(41.63%) at epoch: 4                                   
FedProx_1 achieved 50.0%(57.36%) at epoch: 11                                  
FedProx_1 achieved 60.0%(60.16%) at epoch: 13                                  
FedProx_1 achieved 70.0%(72.54%) at epoch: 20                                  
FedProx_1 achieved 80.0%(83.41%) at epoch: 49                                  
FedProx_1 achieved 90.0%(90.52%) at epoch: 150                                 
