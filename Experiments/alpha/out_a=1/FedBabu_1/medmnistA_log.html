==================== ALGORITHM: FedBabu_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0602 -> 1.2770   acc: 17.49% -> 55.09%             
client [81] (test)  loss: 2.0653 -> 1.5666   acc: 14.16% -> 53.10%             
client [21] (test)  loss: 2.2257 -> 1.0821   acc: 22.43% -> 69.16%             
client [68] (test)  loss: 1.5492 -> 1.0640   acc: 46.40% -> 70.86%             
client [93] (test)  loss: 0.8793 -> 0.5457   acc: 78.49% -> 80.23%             
client [31] (test)  loss: 2.0719 -> 1.5793   acc: 17.62% -> 43.61%             
client [20] (test)  loss: 1.2834 -> 0.7602   acc: 63.40% -> 76.80%             
client [59] (test)  loss: 2.1825 -> 1.1735   acc: 22.19% -> 69.21%             
client [48] (test)  loss: 1.5262 -> 1.1764   acc: 36.15% -> 63.18%             
client [34] (test)  loss: 1.5368 -> 0.8750   acc: 51.88% -> 65.32%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4171 -> 0.6874   acc: 52.17% -> 79.26%             
client [99] (test)  loss: 1.2678 -> 0.8468   acc: 53.79% -> 76.55%             
client [67] (test)  loss: 1.3674 -> 0.8282   acc: 47.88% -> 74.13%             
client [0] (test)  loss: 0.9852 -> 0.6157   acc: 70.82% -> 80.98%              
client [76] (test)  loss: 1.1677 -> 0.8558   acc: 55.86% -> 72.75%             
client [41] (test)  loss: 1.7577 -> 0.9785   acc: 38.00% -> 70.00%             
client [62] (test)  loss: 2.5495 -> 0.6486   acc: 5.14% -> 81.43%              
client [2] (test)  loss: 2.1398 -> 0.6681   acc: 12.28% -> 79.64%              
client [14] (test)  loss: 0.9224 -> 0.4726   acc: 65.76% -> 85.76%             
client [46] (test)  loss: 0.8489 -> 0.6810   acc: 71.37% -> 78.21%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0111 -> 0.6862   acc: 62.69% -> 71.57%             
client [68] (test)  loss: 0.7923 -> 0.6784   acc: 77.70% -> 78.42%             
client [57] (test)  loss: 1.2000 -> 0.8434   acc: 47.96% -> 73.47%             
client [17] (test)  loss: 1.2376 -> 0.8247   acc: 51.37% -> 70.55%             
client [54] (test)  loss: 0.7409 -> 0.5345   acc: 77.57% -> 84.03%             
client [23] (test)  loss: 2.0610 -> 0.5154   acc: 23.06% -> 83.06%             
client [35] (test)  loss: 1.0644 -> 0.6456   acc: 52.31% -> 81.71%             
client [59] (test)  loss: 0.7999 -> 0.5115   acc: 76.49% -> 85.43%             
client [31] (test)  loss: 0.9344 -> 0.8318   acc: 68.72% -> 72.25%             
client [9] (test)  loss: 0.9640 -> 0.7031   acc: 67.26% -> 73.75%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8028 -> 0.5502   acc: 74.68% -> 83.54%             
client [33] (test)  loss: 0.5795 -> 0.4488   acc: 83.44% -> 87.01%             
client [16] (test)  loss: 0.7551 -> 0.3901   acc: 78.44% -> 86.25%             
client [44] (test)  loss: 1.4389 -> 0.5049   acc: 52.69% -> 84.70%             
client [8] (test)  loss: 0.6049 -> 0.3355   acc: 82.62% -> 89.18%              
client [31] (test)  loss: 0.8051 -> 0.7130   acc: 76.21% -> 76.21%             
client [47] (test)  loss: 0.8766 -> 0.4335   acc: 68.67% -> 82.83%             
client [36] (test)  loss: 0.9229 -> 0.5302   acc: 67.76% -> 82.57%             
client [20] (test)  loss: 0.4908 -> 0.3378   acc: 83.66% -> 88.89%             
client [56] (test)  loss: 0.6381 -> 0.2996   acc: 82.21% -> 90.18%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4116 -> 0.2915   acc: 86.64% -> 90.23%              
client [60] (test)  loss: 0.5119 -> 0.2419   acc: 85.80% -> 92.28%             
client [28] (test)  loss: 1.2982 -> 0.7760   acc: 61.11% -> 76.59%             
client [25] (test)  loss: 1.0755 -> 0.3871   acc: 68.37% -> 87.86%             
client [58] (test)  loss: 0.7542 -> 0.3440   acc: 71.28% -> 89.42%             
client [44] (test)  loss: 0.8179 -> 0.4460   acc: 71.95% -> 86.40%             
client [39] (test)  loss: 0.9951 -> 0.5066   acc: 63.95% -> 83.72%             
client [29] (test)  loss: 0.8791 -> 0.4981   acc: 72.53% -> 86.27%             
client [3] (test)  loss: 0.5865 -> 0.3209   acc: 80.07% -> 91.50%              
client [84] (test)  loss: 1.4206 -> 0.5825   acc: 51.25% -> 79.00%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6306 -> 0.3634   acc: 81.00% -> 87.54%             
client [84] (test)  loss: 0.8096 -> 0.4920   acc: 72.24% -> 83.27%             
client [10] (test)  loss: 0.4279 -> 0.4129   acc: 85.16% -> 89.84%             
client [36] (test)  loss: 0.8443 -> 0.4418   acc: 69.41% -> 83.22%             
client [65] (test)  loss: 0.4381 -> 0.3759   acc: 87.18% -> 89.42%             
client [81] (test)  loss: 0.7173 -> 0.6213   acc: 76.55% -> 77.88%             
client [79] (test)  loss: 0.6620 -> 0.5766   acc: 76.82% -> 81.82%             
client [42] (test)  loss: 0.8621 -> 0.6318   acc: 71.47% -> 78.08%             
client [11] (test)  loss: 0.9531 -> 0.6613   acc: 69.33% -> 79.41%             
client [96] (test)  loss: 0.6812 -> 0.5438   acc: 80.50% -> 81.21%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8111 -> 0.2326   acc: 75.08% -> 93.11%              
client [53] (test)  loss: 0.6036 -> 0.4895   acc: 75.69% -> 83.14%             
client [52] (test)  loss: 0.5820 -> 0.2796   acc: 79.55% -> 91.69%             
client [42] (test)  loss: 0.7818 -> 0.5978   acc: 74.47% -> 79.88%             
client [69] (test)  loss: 0.3768 -> 0.3238   acc: 88.29% -> 89.63%             
client [59] (test)  loss: 0.3814 -> 0.2542   acc: 87.75% -> 91.39%             
client [7] (test)  loss: 0.3833 -> 0.2819   acc: 88.47% -> 90.20%              
client [26] (test)  loss: 0.6401 -> 0.2117   acc: 79.85% -> 93.37%             
client [49] (test)  loss: 0.3278 -> 0.1572   acc: 89.61% -> 96.10%             
client [98] (test)  loss: 0.6236 -> 0.4157   acc: 80.63% -> 86.39%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6388 -> 0.4017   acc: 79.06% -> 88.48%             
client [47] (test)  loss: 0.6259 -> 0.2775   acc: 79.82% -> 90.06%             
client [21] (test)  loss: 0.3773 -> 0.3082   acc: 88.47% -> 90.65%             
client [77] (test)  loss: 0.6004 -> 0.4883   acc: 80.68% -> 82.77%             
client [95] (test)  loss: 0.5546 -> 0.4573   acc: 81.53% -> 82.73%             
client [91] (test)  loss: 0.6321 -> 0.4358   acc: 79.14% -> 84.49%             
client [14] (test)  loss: 0.2904 -> 0.1873   acc: 90.30% -> 93.94%             
client [99] (test)  loss: 0.7145 -> 0.4699   acc: 71.72% -> 85.52%             
client [20] (test)  loss: 0.3795 -> 0.2186   acc: 86.27% -> 92.81%             
client [39] (test)  loss: 0.5405 -> 0.3079   acc: 80.52% -> 92.15%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4505 -> 0.2643   acc: 85.94% -> 92.01%             
client [62] (test)  loss: 0.5699 -> 0.2758   acc: 81.71% -> 91.71%             
client [71] (test)  loss: 0.5575 -> 0.3066   acc: 81.60% -> 92.00%             
client [97] (test)  loss: 0.3423 -> 0.2003   acc: 88.14% -> 93.53%             
client [30] (test)  loss: 0.2415 -> 0.1253   acc: 92.72% -> 95.57%             
client [88] (test)  loss: 0.3949 -> 0.1509   acc: 85.90% -> 95.19%             
client [60] (test)  loss: 0.3256 -> 0.1914   acc: 88.58% -> 93.83%             
client [82] (test)  loss: 0.6681 -> 0.3596   acc: 73.14% -> 87.06%             
client [91] (test)  loss: 0.5715 -> 0.4157   acc: 80.21% -> 84.49%             
client [57] (test)  loss: 0.5443 -> 0.4621   acc: 82.65% -> 84.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5257 -> 0.4513   acc: 81.94% -> 85.46%             
client [15] (test)  loss: 0.2825 -> 0.1215   acc: 92.19% -> 96.25%             
client [71] (test)  loss: 0.5318 -> 0.2997   acc: 77.60% -> 91.20%             
client [97] (test)  loss: 0.3473 -> 0.1923   acc: 87.60% -> 94.88%             
client [53] (test)  loss: 0.5534 -> 0.4206   acc: 79.61% -> 83.92%             
client [77] (test)  loss: 0.6501 -> 0.4322   acc: 78.85% -> 84.07%             
client [76] (test)  loss: 0.5362 -> 0.3665   acc: 80.38% -> 87.19%             
client [79] (test)  loss: 0.7254 -> 0.4639   acc: 75.00% -> 85.91%             
client [28] (test)  loss: 0.8377 -> 0.5787   acc: 72.22% -> 82.54%             
client [99] (test)  loss: 0.8915 -> 0.4354   acc: 69.31% -> 87.59%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2655 -> 0.1847   acc: 90.84% -> 94.61%             
client [86] (test)  loss: 0.6861 -> 0.4236   acc: 75.90% -> 88.72%             
client [34] (test)  loss: 0.6563 -> 0.2502   acc: 80.11% -> 92.74%             
client [73] (test)  loss: 0.2651 -> 0.1753   acc: 91.09% -> 96.36%             
client [5] (test)  loss: 0.7863 -> 0.2556   acc: 77.75% -> 90.38%              
client [96] (test)  loss: 0.6120 -> 0.4565   acc: 81.56% -> 85.11%             
client [22] (test)  loss: 0.4732 -> 0.2465   acc: 85.00% -> 92.22%             
client [60] (test)  loss: 0.4317 -> 0.1762   acc: 85.80% -> 95.37%             
client [66] (test)  loss: 0.4867 -> 0.3967   acc: 83.70% -> 85.51%             
client [83] (test)  loss: 0.8022 -> 0.3692   acc: 71.18% -> 87.68%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5027 -> 0.3420   acc: 82.83% -> 87.19%             
client [65] (test)  loss: 0.3815 -> 0.2830   acc: 89.42% -> 91.35%             
client [95] (test)  loss: 0.4728 -> 0.3317   acc: 84.34% -> 89.96%             
client [17] (test)  loss: 0.8681 -> 0.5495   acc: 72.60% -> 77.40%             
client [8] (test)  loss: 0.5926 -> 0.1903   acc: 80.98% -> 95.08%              
client [35] (test)  loss: 0.3089 -> 0.2423   acc: 91.44% -> 92.82%             
client [98] (test)  loss: 0.6211 -> 0.3809   acc: 81.15% -> 89.53%             
client [53] (test)  loss: 0.4378 -> 0.3877   acc: 83.14% -> 83.92%             
client [43] (test)  loss: 0.5890 -> 0.3122   acc: 79.12% -> 88.21%             
client [64] (test)  loss: 0.6093 -> 0.2634   acc: 82.28% -> 89.87%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3418 -> 0.2778   acc: 88.16% -> 92.83%             
client [88] (test)  loss: 0.2647 -> 0.1440   acc: 90.38% -> 94.55%             
client [38] (test)  loss: 0.5496 -> 0.3457   acc: 83.98% -> 89.32%             
client [3] (test)  loss: 0.2617 -> 0.2224   acc: 90.52% -> 92.81%              
client [5] (test)  loss: 0.8363 -> 0.2386   acc: 75.82% -> 92.03%              
client [41] (test)  loss: 0.6887 -> 0.3210   acc: 82.00% -> 90.80%             
client [7] (test)  loss: 0.6664 -> 0.2131   acc: 75.79% -> 91.64%              
client [37] (test)  loss: 0.3203 -> 0.2925   acc: 89.33% -> 88.67%             
client [45] (test)  loss: 1.2101 -> 0.4210   acc: 67.19% -> 84.54%             
client [47] (test)  loss: 0.3880 -> 0.2250   acc: 86.45% -> 93.07%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4158 -> 0.2727   acc: 86.99% -> 89.96%             
client [11] (test)  loss: 0.6748 -> 0.4534   acc: 76.89% -> 87.39%             
client [37] (test)  loss: 0.2306 -> 0.2765   acc: 92.67% -> 89.00%             
client [41] (test)  loss: 0.8817 -> 0.3059   acc: 74.40% -> 90.80%             
client [95] (test)  loss: 0.4011 -> 0.3085   acc: 85.54% -> 91.57%             
client [53] (test)  loss: 0.4229 -> 0.3623   acc: 83.53% -> 86.27%             
client [22] (test)  loss: 0.3555 -> 0.2242   acc: 89.44% -> 93.33%             
client [25] (test)  loss: 0.6879 -> 0.2283   acc: 75.08% -> 92.01%             
client [69] (test)  loss: 0.3537 -> 0.2519   acc: 87.63% -> 90.30%             
client [46] (test)  loss: 0.2630 -> 0.2231   acc: 92.74% -> 94.44%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2714 -> 0.2234   acc: 91.27% -> 91.87%             
client [69] (test)  loss: 0.3008 -> 0.2527   acc: 89.63% -> 89.97%             
client [82] (test)  loss: 0.6546 -> 0.2855   acc: 78.32% -> 89.32%             
client [45] (test)  loss: 0.6402 -> 0.4198   acc: 75.39% -> 86.75%             
client [7] (test)  loss: 0.3490 -> 0.2024   acc: 90.20% -> 92.22%              
client [50] (test)  loss: 0.3743 -> 0.2291   acc: 85.04% -> 91.97%             
client [35] (test)  loss: 0.1928 -> 0.2207   acc: 93.98% -> 94.21%             
client [24] (test)  loss: 0.5806 -> 0.3247   acc: 78.43% -> 89.09%             
client [15] (test)  loss: 0.1823 -> 0.0935   acc: 94.38% -> 95.94%             
client [58] (test)  loss: 0.5279 -> 0.2254   acc: 80.60% -> 91.18%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5139 -> 0.3892   acc: 83.78% -> 87.16%             
client [76] (test)  loss: 0.4720 -> 0.3226   acc: 83.65% -> 89.37%             
client [67] (test)  loss: 0.3592 -> 0.3780   acc: 89.19% -> 89.19%             
client [37] (test)  loss: 0.2973 -> 0.2627   acc: 87.00% -> 90.00%             
client [58] (test)  loss: 0.3762 -> 0.2091   acc: 86.65% -> 91.18%             
client [64] (test)  loss: 0.4675 -> 0.2236   acc: 86.08% -> 91.77%             
client [77] (test)  loss: 0.5220 -> 0.3865   acc: 84.07% -> 86.42%             
client [55] (test)  loss: 0.4284 -> 0.1703   acc: 87.95% -> 93.98%             
client [12] (test)  loss: 0.2798 -> 0.3702   acc: 91.73% -> 87.80%             
client [89] (test)  loss: 0.2243 -> 0.2221   acc: 93.08% -> 91.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5099 -> 0.2992   acc: 83.99% -> 91.10%             
client [51] (test)  loss: 0.5442 -> 0.4151   acc: 82.05% -> 88.03%             
client [8] (test)  loss: 0.4510 -> 0.1841   acc: 85.90% -> 93.44%              
client [18] (test)  loss: 0.1652 -> 0.0972   acc: 95.38% -> 97.36%             
client [94] (test)  loss: 0.3406 -> 0.1776   acc: 85.94% -> 94.14%             
client [81] (test)  loss: 0.4275 -> 0.4296   acc: 84.07% -> 86.73%             
client [3] (test)  loss: 0.3195 -> 0.1915   acc: 89.54% -> 93.14%              
client [11] (test)  loss: 0.7245 -> 0.4435   acc: 74.37% -> 86.97%             
client [95] (test)  loss: 0.3996 -> 0.2708   acc: 88.76% -> 92.77%             
client [67] (test)  loss: 0.3814 -> 0.3891   acc: 89.58% -> 89.96%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2807 -> 0.2566   acc: 90.65% -> 93.15%             
client [79] (test)  loss: 0.6513 -> 0.4055   acc: 80.45% -> 89.55%             
client [58] (test)  loss: 0.3477 -> 0.2046   acc: 87.91% -> 91.94%             
client [88] (test)  loss: 0.2697 -> 0.1368   acc: 90.71% -> 95.51%             
client [46] (test)  loss: 0.2282 -> 0.2080   acc: 92.31% -> 93.59%             
client [11] (test)  loss: 0.6963 -> 0.4492   acc: 77.73% -> 87.82%             
client [55] (test)  loss: 0.4048 -> 0.1697   acc: 89.16% -> 93.98%             
client [13] (test)  loss: 0.2744 -> 0.2625   acc: 90.73% -> 91.85%             
client [31] (test)  loss: 0.5144 -> 0.4165   acc: 83.26% -> 88.11%             
client [75] (test)  loss: 0.2825 -> 0.2402   acc: 88.89% -> 91.53%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2671 -> 0.1760   acc: 92.02% -> 95.71%             
client [7] (test)  loss: 0.4655 -> 0.1784   acc: 84.15% -> 93.66%              
client [57] (test)  loss: 0.3088 -> 0.3072   acc: 90.82% -> 90.82%             
client [13] (test)  loss: 0.2286 -> 0.2637   acc: 92.42% -> 92.42%             
client [43] (test)  loss: 0.4247 -> 0.3039   acc: 84.77% -> 88.70%             
client [91] (test)  loss: 0.5400 -> 0.2327   acc: 81.82% -> 92.51%             
client [10] (test)  loss: 0.2728 -> 0.2708   acc: 92.19% -> 91.41%             
client [64] (test)  loss: 0.3524 -> 0.2037   acc: 87.97% -> 93.04%             
client [82] (test)  loss: 0.5568 -> 0.2717   acc: 81.23% -> 89.64%             
client [22] (test)  loss: 0.2730 -> 0.2240   acc: 92.78% -> 91.11%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3340 -> 0.1883   acc: 89.54% -> 93.14%             
client [23] (test)  loss: 0.3924 -> 0.2369   acc: 85.56% -> 91.39%             
client [88] (test)  loss: 0.1699 -> 0.1365   acc: 94.55% -> 95.51%             
client [98] (test)  loss: 0.6611 -> 0.3694   acc: 80.10% -> 90.05%             
client [79] (test)  loss: 0.5931 -> 0.4021   acc: 82.73% -> 88.64%             
client [21] (test)  loss: 0.2771 -> 0.2737   acc: 93.15% -> 92.52%             
client [92] (test)  loss: 0.5669 -> 0.4588   acc: 80.30% -> 82.95%             
client [56] (test)  loss: 0.2431 -> 0.1660   acc: 91.72% -> 95.71%             
client [5] (test)  loss: 0.5033 -> 0.2409   acc: 85.16% -> 92.86%              
client [52] (test)  loss: 0.3930 -> 0.2477   acc: 86.90% -> 92.97%             
==================== FedBabu_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.5125 -> 1.7921', 'accuracy': '82.71% -> 71.79%'},         
    200: {'loss': '0.4093 -> 3.5138', 'accuracy': '86.60% -> 67.44%'}          
}                                                                              
Convergence (test_before):                                                     
FedBabu_1 achieved 10.0%(15.55%) at epoch: 0                                   
FedBabu_1 achieved 20.0%(24.95%) at epoch: 1                                   
FedBabu_1 achieved 30.0%(36.93%) at epoch: 7                                   
FedBabu_1 achieved 40.0%(44.73%) at epoch: 13                                  
FedBabu_1 achieved 50.0%(56.32%) at epoch: 18                                  
FedBabu_1 achieved 60.0%(60.10%) at epoch: 20                                  
FedBabu_1 achieved 70.0%(71.31%) at epoch: 27                                  
FedBabu_1 achieved 80.0%(80.40%) at epoch: 51                                  
Convergence (test_after):                                                      
FedBabu_1 achieved 30.0%(37.20%) at epoch: 0                                   
FedBabu_1 achieved 40.0%(41.00%) at epoch: 1                                   
FedBabu_1 achieved 50.0%(51.02%) at epoch: 3                                   
FedBabu_1 achieved 60.0%(62.04%) at epoch: 5                                   
FedBabu_1 achieved 70.0%(70.99%) at epoch: 12                                  
FedBabu_1 achieved 80.0%(82.11%) at epoch: 20                                  
FedBabu_1 achieved 90.0%(90.88%) at epoch: 78                                  
