==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4188 -> 1.1405   acc: 51.17% -> 62.14%             
client [81] (test)  loss: 1.6206 -> 1.4818   acc: 54.42% -> 57.08%             
client [21] (test)  loss: 2.2435 -> 0.9273   acc: 22.74% -> 70.72%             
client [68] (test)  loss: 1.2629 -> 0.9607   acc: 58.27% -> 73.38%             
client [93] (test)  loss: 0.5713 -> 0.4782   acc: 78.78% -> 83.72%             
client [31] (test)  loss: 2.1334 -> 1.5408   acc: 18.50% -> 42.73%             
client [20] (test)  loss: 0.8341 -> 0.6477   acc: 72.55% -> 80.07%             
client [59] (test)  loss: 2.2065 -> 1.0295   acc: 16.56% -> 70.86%             
client [48] (test)  loss: 1.1130 -> 0.9617   acc: 59.12% -> 66.55%             
client [34] (test)  loss: 0.9980 -> 0.7508   acc: 59.14% -> 72.58%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.3279 -> 0.6568   acc: 57.53% -> 79.26%             
client [99] (test)  loss: 0.9424 -> 0.8242   acc: 71.03% -> 75.17%             
client [67] (test)  loss: 0.9214 -> 0.8226   acc: 71.43% -> 73.36%             
client [0] (test)  loss: 0.6316 -> 0.5574   acc: 80.00% -> 81.64%              
client [76] (test)  loss: 0.8801 -> 0.8135   acc: 71.12% -> 72.75%             
client [41] (test)  loss: 1.0869 -> 0.8892   acc: 64.80% -> 73.60%             
client [62] (test)  loss: 2.3383 -> 0.6396   acc: 24.29% -> 79.14%             
client [2] (test)  loss: 2.1527 -> 0.6734   acc: 11.98% -> 77.84%              
client [14] (test)  loss: 0.4931 -> 0.4270   acc: 83.94% -> 85.76%             
client [46] (test)  loss: 0.7091 -> 0.6852   acc: 74.36% -> 77.78%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8244 -> 0.6869   acc: 64.72% -> 72.84%             
client [68] (test)  loss: 0.6891 -> 0.6827   acc: 77.34% -> 77.34%             
client [57] (test)  loss: 0.8760 -> 0.8786   acc: 76.02% -> 71.94%             
client [17] (test)  loss: 1.0046 -> 0.8029   acc: 65.07% -> 73.97%             
client [54] (test)  loss: 0.4912 -> 0.4798   acc: 84.03% -> 82.51%             
client [23] (test)  loss: 1.9761 -> 0.5234   acc: 23.89% -> 83.06%             
client [35] (test)  loss: 0.6588 -> 0.6590   acc: 79.63% -> 81.94%             
client [59] (test)  loss: 0.4812 -> 0.4328   acc: 83.77% -> 85.43%             
client [31] (test)  loss: 0.8832 -> 0.8256   acc: 68.28% -> 70.93%             
client [9] (test)  loss: 0.7324 -> 0.6957   acc: 72.86% -> 73.75%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7085 -> 0.5585   acc: 79.75% -> 82.91%             
client [33] (test)  loss: 0.5167 -> 0.3847   acc: 82.14% -> 87.66%             
client [16] (test)  loss: 0.4344 -> 0.4196   acc: 85.13% -> 85.87%             
client [44] (test)  loss: 1.2748 -> 0.5289   acc: 58.64% -> 81.59%             
client [8] (test)  loss: 0.3238 -> 0.3019   acc: 90.16% -> 91.15%              
client [31] (test)  loss: 0.7966 -> 0.7269   acc: 69.60% -> 74.45%             
client [47] (test)  loss: 0.5567 -> 0.4111   acc: 81.33% -> 85.54%             
client [36] (test)  loss: 0.6985 -> 0.5652   acc: 75.00% -> 81.25%             
client [20] (test)  loss: 0.4293 -> 0.3664   acc: 84.64% -> 88.24%             
client [56] (test)  loss: 0.4097 -> 0.2896   acc: 87.42% -> 90.18%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3015 -> 0.2885   acc: 88.60% -> 90.55%              
client [60] (test)  loss: 0.3068 -> 0.2180   acc: 90.12% -> 93.21%             
client [28] (test)  loss: 0.8143 -> 0.8409   acc: 68.25% -> 69.05%             
client [25] (test)  loss: 0.4626 -> 0.4072   acc: 86.26% -> 87.54%             
client [58] (test)  loss: 0.3718 -> 0.3401   acc: 88.66% -> 89.42%             
client [44] (test)  loss: 0.5181 -> 0.4669   acc: 81.59% -> 84.42%             
client [39] (test)  loss: 0.4063 -> 0.4012   acc: 87.21% -> 87.21%             
client [29] (test)  loss: 0.6611 -> 0.4934   acc: 78.97% -> 87.12%             
client [3] (test)  loss: 0.3789 -> 0.3140   acc: 89.22% -> 90.52%              
client [84] (test)  loss: 0.6713 -> 0.6144   acc: 75.44% -> 77.22%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4641 -> 0.3920   acc: 83.18% -> 86.92%             
client [84] (test)  loss: 0.5972 -> 0.5401   acc: 77.22% -> 79.00%             
client [10] (test)  loss: 0.4189 -> 0.3858   acc: 87.11% -> 89.06%             
client [36] (test)  loss: 0.5463 -> 0.5067   acc: 80.92% -> 81.58%             
client [65] (test)  loss: 0.3505 -> 0.3527   acc: 88.78% -> 88.46%             
client [81] (test)  loss: 0.8014 -> 0.6913   acc: 75.66% -> 75.66%             
client [79] (test)  loss: 0.5205 -> 0.5675   acc: 82.73% -> 81.82%             
client [42] (test)  loss: 0.7674 -> 0.6740   acc: 73.87% -> 77.78%             
client [11] (test)  loss: 0.6627 -> 0.6562   acc: 76.89% -> 79.83%             
client [96] (test)  loss: 0.7964 -> 0.5785   acc: 72.70% -> 80.50%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3632 -> 0.2432   acc: 88.20% -> 92.46%              
client [53] (test)  loss: 0.6413 -> 0.5357   acc: 74.51% -> 80.00%             
client [52] (test)  loss: 0.9390 -> 0.3185   acc: 72.20% -> 91.05%             
client [42] (test)  loss: 0.6325 -> 0.6360   acc: 78.68% -> 80.18%             
client [69] (test)  loss: 0.3281 -> 0.3116   acc: 87.96% -> 88.96%             
client [59] (test)  loss: 0.4321 -> 0.2824   acc: 86.42% -> 90.40%             
client [7] (test)  loss: 0.4806 -> 0.2943   acc: 87.90% -> 91.93%              
client [26] (test)  loss: 0.2257 -> 0.2108   acc: 93.11% -> 93.62%             
client [49] (test)  loss: 0.1814 -> 0.1475   acc: 93.83% -> 95.45%             
client [98] (test)  loss: 0.4785 -> 0.4004   acc: 82.72% -> 86.39%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5423 -> 0.3848   acc: 81.15% -> 89.01%             
client [47] (test)  loss: 0.3859 -> 0.2629   acc: 85.24% -> 90.36%             
client [21] (test)  loss: 0.3787 -> 0.3639   acc: 87.23% -> 88.16%             
client [77] (test)  loss: 0.5094 -> 0.5117   acc: 83.55% -> 82.25%             
client [95] (test)  loss: 0.5796 -> 0.5108   acc: 80.72% -> 79.92%             
client [91] (test)  loss: 0.5092 -> 0.5245   acc: 81.28% -> 81.82%             
client [14] (test)  loss: 0.2446 -> 0.1896   acc: 90.61% -> 94.24%             
client [99] (test)  loss: 0.5383 -> 0.4751   acc: 84.48% -> 85.86%             
client [20] (test)  loss: 0.4104 -> 0.3053   acc: 87.58% -> 90.52%             
client [39] (test)  loss: 0.2859 -> 0.2965   acc: 91.28% -> 90.99%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8484 -> 0.3061   acc: 77.64% -> 92.65%             
client [62] (test)  loss: 0.4490 -> 0.2961   acc: 83.43% -> 88.86%             
client [71] (test)  loss: 0.3529 -> 0.3630   acc: 90.40% -> 89.60%             
client [97] (test)  loss: 0.4018 -> 0.1879   acc: 85.98% -> 93.53%             
client [30] (test)  loss: 0.1641 -> 0.1270   acc: 93.99% -> 95.25%             
client [88] (test)  loss: 0.2246 -> 0.1406   acc: 91.35% -> 95.51%             
client [60] (test)  loss: 0.2622 -> 0.1918   acc: 91.36% -> 94.75%             
client [82] (test)  loss: 0.4132 -> 0.3900   acc: 85.76% -> 87.06%             
client [91] (test)  loss: 0.5076 -> 0.4978   acc: 82.35% -> 83.42%             
client [57] (test)  loss: 0.4798 -> 0.4344   acc: 83.16% -> 86.73%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7580 -> 0.5799   acc: 77.09% -> 83.70%             
client [15] (test)  loss: 0.1438 -> 0.1253   acc: 95.62% -> 96.25%             
client [71] (test)  loss: 0.3728 -> 0.3471   acc: 89.60% -> 89.60%             
client [97] (test)  loss: 0.2687 -> 0.1769   acc: 90.84% -> 93.80%             
client [53] (test)  loss: 0.5615 -> 0.4884   acc: 80.39% -> 81.96%             
client [77] (test)  loss: 0.5315 -> 0.4866   acc: 84.86% -> 82.51%             
client [76] (test)  loss: 0.3862 -> 0.3833   acc: 86.65% -> 85.56%             
client [79] (test)  loss: 0.5010 -> 0.4962   acc: 84.55% -> 85.45%             
client [28] (test)  loss: 0.7299 -> 0.6611   acc: 77.78% -> 80.16%             
client [99] (test)  loss: 0.5311 -> 0.4474   acc: 82.76% -> 86.55%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2944 -> 0.1767   acc: 90.57% -> 94.88%             
client [86] (test)  loss: 0.3474 -> 0.3612   acc: 86.15% -> 86.15%             
client [34] (test)  loss: 0.3438 -> 0.2710   acc: 91.13% -> 92.47%             
client [73] (test)  loss: 0.2179 -> 0.1908   acc: 91.50% -> 93.93%             
client [5] (test)  loss: 0.4098 -> 0.2431   acc: 87.91% -> 91.48%              
client [96] (test)  loss: 0.8509 -> 0.5512   acc: 75.18% -> 85.82%             
client [22] (test)  loss: 0.2957 -> 0.2712   acc: 87.22% -> 88.89%             
client [60] (test)  loss: 0.2349 -> 0.1879   acc: 93.83% -> 94.75%             
client [66] (test)  loss: 0.5180 -> 0.4044   acc: 83.70% -> 86.96%             
client [83] (test)  loss: 0.4538 -> 0.3868   acc: 87.44% -> 88.42%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4736 -> 0.3804   acc: 84.74% -> 85.56%             
client [65] (test)  loss: 0.3266 -> 0.2773   acc: 91.03% -> 91.35%             
client [95] (test)  loss: 0.5354 -> 0.4310   acc: 82.73% -> 84.74%             
client [17] (test)  loss: 0.8586 -> 0.5614   acc: 71.92% -> 80.14%             
client [8] (test)  loss: 0.2575 -> 0.2116   acc: 92.79% -> 94.75%              
client [35] (test)  loss: 0.3466 -> 0.2801   acc: 91.20% -> 92.13%             
client [98] (test)  loss: 0.4908 -> 0.3755   acc: 83.77% -> 90.58%             
client [53] (test)  loss: 0.4984 -> 0.4791   acc: 81.96% -> 83.14%             
client [43] (test)  loss: 0.5209 -> 0.3406   acc: 83.05% -> 87.22%             
client [64] (test)  loss: 0.6997 -> 0.2722   acc: 79.75% -> 90.51%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4062 -> 0.3570   acc: 88.47% -> 91.59%             
client [88] (test)  loss: 0.2157 -> 0.1263   acc: 92.31% -> 95.83%             
client [38] (test)  loss: 0.6535 -> 0.3119   acc: 81.60% -> 91.39%             
client [3] (test)  loss: 0.2918 -> 0.2309   acc: 90.20% -> 93.46%              
client [5] (test)  loss: 0.3386 -> 0.2397   acc: 90.66% -> 91.48%              
client [41] (test)  loss: 0.5848 -> 0.3447   acc: 81.60% -> 89.60%             
client [7] (test)  loss: 0.3961 -> 0.2537   acc: 89.05% -> 92.80%              
client [37] (test)  loss: 0.4001 -> 0.3299   acc: 86.00% -> 88.67%             
client [45] (test)  loss: 0.5372 -> 0.4577   acc: 82.97% -> 85.17%             
client [47] (test)  loss: 0.2926 -> 0.2145   acc: 90.06% -> 93.67%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2753 -> 0.2274   acc: 91.45% -> 91.45%             
client [11] (test)  loss: 0.6503 -> 0.5301   acc: 80.67% -> 84.87%             
client [37] (test)  loss: 0.3586 -> 0.3240   acc: 88.33% -> 89.67%             
client [41] (test)  loss: 0.5774 -> 0.3403   acc: 81.60% -> 90.00%             
client [95] (test)  loss: 0.4682 -> 0.3820   acc: 86.75% -> 86.75%             
client [53] (test)  loss: 0.5258 -> 0.4660   acc: 82.35% -> 84.31%             
client [22] (test)  loss: 0.3062 -> 0.2281   acc: 88.89% -> 88.89%             
client [25] (test)  loss: 0.6323 -> 0.2945   acc: 79.55% -> 91.37%             
client [69] (test)  loss: 0.3439 -> 0.2702   acc: 86.96% -> 90.30%             
client [46] (test)  loss: 0.2807 -> 0.2720   acc: 90.17% -> 89.32%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2403 -> 0.2197   acc: 92.47% -> 93.67%             
client [69] (test)  loss: 0.3137 -> 0.2856   acc: 89.30% -> 89.63%             
client [82] (test)  loss: 0.4347 -> 0.3687   acc: 86.73% -> 88.03%             
client [45] (test)  loss: 0.5679 -> 0.4778   acc: 80.44% -> 84.54%             
client [7] (test)  loss: 0.5114 -> 0.2705   acc: 86.17% -> 93.37%              
client [50] (test)  loss: 0.2493 -> 0.2181   acc: 91.97% -> 93.07%             
client [35] (test)  loss: 0.2692 -> 0.2492   acc: 93.06% -> 93.52%             
client [24] (test)  loss: 0.5175 -> 0.4176   acc: 81.73% -> 87.06%             
client [15] (test)  loss: 0.1180 -> 0.0988   acc: 95.62% -> 95.62%             
client [58] (test)  loss: 0.2920 -> 0.2744   acc: 90.93% -> 91.44%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4300 -> 0.4559   acc: 86.15% -> 87.84%             
client [76] (test)  loss: 0.3973 -> 0.3723   acc: 87.47% -> 87.74%             
client [67] (test)  loss: 0.6110 -> 0.5343   acc: 85.33% -> 85.71%             
client [37] (test)  loss: 0.3523 -> 0.3331   acc: 87.33% -> 89.33%             
client [58] (test)  loss: 0.2926 -> 0.2667   acc: 91.69% -> 92.19%             
client [64] (test)  loss: 0.5603 -> 0.2340   acc: 82.91% -> 92.41%             
client [77] (test)  loss: 0.5186 -> 0.4554   acc: 84.60% -> 85.38%             
client [55] (test)  loss: 0.6237 -> 0.4469   acc: 86.14% -> 91.57%             
client [12] (test)  loss: 0.4568 -> 0.4178   acc: 83.46% -> 86.22%             
client [89] (test)  loss: 0.2919 -> 0.2833   acc: 92.51% -> 92.22%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5185 -> 0.4163   acc: 83.63% -> 86.12%             
client [51] (test)  loss: 0.5288 -> 0.5178   acc: 87.61% -> 87.18%             
client [8] (test)  loss: 0.2509 -> 0.2111   acc: 93.11% -> 94.43%              
client [18] (test)  loss: 0.1094 -> 0.0892   acc: 96.37% -> 97.36%             
client [94] (test)  loss: 0.3059 -> 0.2267   acc: 91.02% -> 93.36%             
client [81] (test)  loss: 0.6244 -> 0.5302   acc: 82.74% -> 85.40%             
client [3] (test)  loss: 0.2484 -> 0.2110   acc: 90.52% -> 93.14%              
client [11] (test)  loss: 0.7075 -> 0.5293   acc: 79.41% -> 86.97%             
client [95] (test)  loss: 0.4207 -> 0.3744   acc: 87.95% -> 87.95%             
client [67] (test)  loss: 0.6766 -> 0.5232   acc: 85.71% -> 88.03%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4297 -> 0.3602   acc: 89.41% -> 90.03%             
client [79] (test)  loss: 0.4362 -> 0.5088   acc: 88.64% -> 87.27%             
client [58] (test)  loss: 0.2862 -> 0.2679   acc: 91.44% -> 92.19%             
client [88] (test)  loss: 0.1718 -> 0.1154   acc: 94.23% -> 96.47%             
client [46] (test)  loss: 0.3495 -> 0.2654   acc: 89.74% -> 88.46%             
client [11] (test)  loss: 0.6704 -> 0.5282   acc: 78.15% -> 85.29%             
client [55] (test)  loss: 0.5437 -> 0.4482   acc: 89.16% -> 91.57%             
client [13] (test)  loss: 0.2485 -> 0.2999   acc: 91.85% -> 90.45%             
client [31] (test)  loss: 0.7853 -> 0.5784   acc: 76.65% -> 84.14%             
client [75] (test)  loss: 0.3460 -> 0.3887   acc: 89.42% -> 89.95%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2533 -> 0.2229   acc: 92.64% -> 94.17%             
client [7] (test)  loss: 0.4154 -> 0.2718   acc: 89.34% -> 93.66%              
client [57] (test)  loss: 0.3831 -> 0.3553   acc: 89.29% -> 88.78%             
client [13] (test)  loss: 0.2857 -> 0.2994   acc: 91.29% -> 90.73%             
client [43] (test)  loss: 0.4523 -> 0.3739   acc: 85.75% -> 86.24%             
client [91] (test)  loss: 0.4519 -> 0.3893   acc: 84.49% -> 86.63%             
client [10] (test)  loss: 0.2743 -> 0.2194   acc: 91.80% -> 91.41%             
client [64] (test)  loss: 0.3346 -> 0.2282   acc: 88.61% -> 93.04%             
client [82] (test)  loss: 0.3884 -> 0.3703   acc: 85.76% -> 89.00%             
client [22] (test)  loss: 0.2784 -> 0.2174   acc: 90.56% -> 91.11%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4071 -> 0.2631   acc: 88.56% -> 94.12%             
client [23] (test)  loss: 0.3128 -> 0.2324   acc: 89.72% -> 91.94%             
client [88] (test)  loss: 0.1247 -> 0.1119   acc: 95.51% -> 96.47%             
client [98] (test)  loss: 0.4008 -> 0.3940   acc: 89.01% -> 90.58%             
client [79] (test)  loss: 0.4604 -> 0.5199   acc: 85.45% -> 85.00%             
client [21] (test)  loss: 0.4123 -> 0.3557   acc: 88.47% -> 90.97%             
client [92] (test)  loss: 0.6590 -> 0.5468   acc: 80.68% -> 84.47%             
client [56] (test)  loss: 0.1579 -> 0.1437   acc: 95.09% -> 95.09%             
client [5] (test)  loss: 0.3403 -> 0.2284   acc: 92.03% -> 93.13%              
client [52] (test)  loss: 0.5666 -> 0.3146   acc: 88.18% -> 94.25%             
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.4076 -> 0.0000', 'accuracy': '86.91% -> 0.00%'},          
    200: {'loss': '0.4002 -> 0.0000', 'accuracy': '88.46% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_1 achieved 10.0%(15.55%) at epoch: 0                                    
FedPer_1 achieved 20.0%(27.58%) at epoch: 1                                    
FedPer_1 achieved 30.0%(31.08%) at epoch: 2                                    
FedPer_1 achieved 50.0%(52.61%) at epoch: 7                                    
FedPer_1 achieved 60.0%(63.61%) at epoch: 16                                   
FedPer_1 achieved 70.0%(70.15%) at epoch: 20                                   
FedPer_1 achieved 80.0%(82.67%) at epoch: 34                                   
FedPer_1 achieved 90.0%(90.42%) at epoch: 148                                  
Convergence (test_after):                                                      
FedPer_1 achieved 30.0%(38.48%) at epoch: 0                                    
FedPer_1 achieved 40.0%(43.66%) at epoch: 1                                    
FedPer_1 achieved 50.0%(57.22%) at epoch: 3                                    
FedPer_1 achieved 60.0%(64.49%) at epoch: 5                                    
FedPer_1 achieved 70.0%(71.52%) at epoch: 12                                   
FedPer_1 achieved 80.0%(82.23%) at epoch: 20                                   
FedPer_1 achieved 90.0%(90.85%) at epoch: 78                                   
