==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6896 -> 1.4151   acc: 46.98% -> 48.05%             
client [81] (test)  loss: 1.6769 -> 2.3830   acc: 42.11% -> 28.47%             
client [21] (test)  loss: 73.6251 -> 2.3729   acc: 12.98% -> 26.57%            
client [68] (test)  loss: 1.3135 -> 1.4928   acc: 56.83% -> 49.89%             
client [93] (test)  loss: 1.3527 -> 1.2941   acc: 52.22% -> 55.35%             
client [31] (test)  loss: 4.2553 -> 1.3947   acc: 30.19% -> 43.93%             
client [20] (test)  loss: 1.6763 -> 1.4716   acc: 43.44% -> 48.06%             
client [59] (test)  loss: 69.0673 -> 1.3259   acc: 10.40% -> 56.18%            
client [48] (test)  loss: 2.2404 -> 1.4782   acc: 34.45% -> 45.09%             
client [34] (test)  loss: 1.6162 -> 1.2479   acc: 41.13% -> 57.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9061 -> 1.4651   acc: 51.64% -> 51.35%             
client [99] (test)  loss: 1.1139 -> 1.1375   acc: 63.23% -> 62.41%             
client [67] (test)  loss: 1.6165 -> 3.2689   acc: 44.74% -> 17.79%             
client [0] (test)  loss: 1.2867 -> 3.3048   acc: 59.74% -> 31.77%              
client [76] (test)  loss: 1.0072 -> 1.5354   acc: 65.14% -> 50.97%             
client [41] (test)  loss: 1.4203 -> 1.8777   acc: 51.41% -> 43.66%             
client [62] (test)  loss: 69.3081 -> 2.1911   acc: 28.86% -> 24.15%            
client [2] (test)  loss: 49.6263 -> 1.3381   acc: 24.09% -> 50.07%             
client [14] (test)  loss: 0.8076 -> 0.7429   acc: 67.88% -> 71.18%             
client [46] (test)  loss: 1.5720 -> 1.2748   acc: 44.01% -> 53.28%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1317 -> 1.2769   acc: 60.40% -> 60.69%             
client [68] (test)  loss: 1.4781 -> 1.3382   acc: 57.99% -> 57.41%             
client [57] (test)  loss: 1.0462 -> 1.0162   acc: 58.55% -> 60.45%             
client [17] (test)  loss: 1.5358 -> 1.0462   acc: 51.10% -> 60.40%             
client [54] (test)  loss: 1.1225 -> 0.9328   acc: 59.38% -> 65.31%             
client [23] (test)  loss: 103.9591 -> 1.2364   acc: 19.54% -> 55.32%           
client [35] (test)  loss: 1.2026 -> 1.6326   acc: 58.66% -> 47.42%             
client [59] (test)  loss: 1.1176 -> 1.1807   acc: 63.85% -> 60.34%             
client [31] (test)  loss: 1.1766 -> 1.2012   acc: 55.45% -> 56.63%             
client [9] (test)  loss: 1.3268 -> 1.5029   acc: 49.43% -> 40.66%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.3780 -> 1.3461   acc: 50.99% -> 54.97%             
client [33] (test)  loss: 1.3361 -> 1.4943   acc: 53.85% -> 53.22%             
client [16] (test)  loss: 1.1101 -> 1.1419   acc: 61.31% -> 59.11%             
client [44] (test)  loss: 2.3681 -> 1.1116   acc: 39.27% -> 56.31%             
client [8] (test)  loss: 1.2017 -> 0.9840   acc: 66.32% -> 70.38%              
client [31] (test)  loss: 1.5565 -> 1.1191   acc: 49.48% -> 61.28%             
client [47] (test)  loss: 1.0639 -> 1.0996   acc: 63.24% -> 61.83%             
client [36] (test)  loss: 1.3071 -> 1.1607   acc: 51.34% -> 56.36%             
client [20] (test)  loss: 1.3182 -> 1.4281   acc: 54.20% -> 50.80%             
client [56] (test)  loss: 1.4108 -> 2.1631   acc: 46.97% -> 29.36%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1949 -> 1.1191   acc: 59.14% -> 63.05%              
client [60] (test)  loss: 2.0210 -> 1.6557   acc: 34.42% -> 48.21%             
client [28] (test)  loss: 1.2802 -> 1.7040   acc: 58.16% -> 49.18%             
client [25] (test)  loss: 1.8058 -> 1.4063   acc: 44.76% -> 48.62%             
client [58] (test)  loss: 1.4408 -> 1.8938   acc: 51.68% -> 41.42%             
client [44] (test)  loss: 1.1157 -> 1.0784   acc: 56.31% -> 57.92%             
client [39] (test)  loss: 1.1442 -> 1.1302   acc: 58.01% -> 59.14%             
client [29] (test)  loss: 1.8408 -> 1.5863   acc: 45.44% -> 46.86%             
client [3] (test)  loss: 1.4641 -> 1.4028   acc: 46.99% -> 52.64%              
client [84] (test)  loss: 1.0805 -> 1.2398   acc: 64.13% -> 63.13%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2583 -> 1.0710   acc: 59.90% -> 60.87%             
client [84] (test)  loss: 1.0628 -> 1.1765   acc: 63.31% -> 64.08%             
client [10] (test)  loss: 1.1822 -> 1.0523   acc: 61.03% -> 65.86%             
client [36] (test)  loss: 1.1305 -> 1.2219   acc: 58.70% -> 57.78%             
client [65] (test)  loss: 1.3906 -> 1.5824   acc: 55.07% -> 48.76%             
client [81] (test)  loss: 1.5084 -> 1.3937   acc: 50.74% -> 53.98%             
client [79] (test)  loss: 1.3736 -> 1.3258   acc: 46.55% -> 51.98%             
client [42] (test)  loss: 1.3058 -> 1.3488   acc: 54.29% -> 54.74%             
client [11] (test)  loss: 2.5078 -> 1.6293   acc: 35.39% -> 50.26%             
client [96] (test)  loss: 1.6420 -> 1.6801   acc: 46.29% -> 42.93%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.1389 -> 1.0810   acc: 69.67% -> 69.11%              
client [53] (test)  loss: 1.2840 -> 1.4558   acc: 51.00% -> 46.77%             
client [52] (test)  loss: 1.2440 -> 1.2313   acc: 61.76% -> 60.29%             
client [42] (test)  loss: 1.4254 -> 1.3671   acc: 51.31% -> 53.47%             
client [69] (test)  loss: 1.4700 -> 1.3644   acc: 52.42% -> 58.76%             
client [59] (test)  loss: 1.1192 -> 1.1615   acc: 63.20% -> 60.99%             
client [7] (test)  loss: 1.0392 -> 0.9890   acc: 65.13% -> 66.35%              
client [26] (test)  loss: 1.0654 -> 1.3474   acc: 64.26% -> 62.50%             
client [49] (test)  loss: 1.5551 -> 1.6212   acc: 44.45% -> 44.17%             
client [98] (test)  loss: 1.4065 -> 1.6562   acc: 46.90% -> 39.32%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4091 -> 1.6013   acc: 47.55% -> 41.74%             
client [47] (test)  loss: 1.1454 -> 1.0616   acc: 62.05% -> 65.92%             
client [21] (test)  loss: 1.0570 -> 1.0753   acc: 62.98% -> 61.17%             
client [77] (test)  loss: 1.3750 -> 1.1594   acc: 55.25% -> 63.52%             
client [95] (test)  loss: 1.4584 -> 1.4484   acc: 50.44% -> 51.39%             
client [91] (test)  loss: 1.2859 -> 1.2021   acc: 51.34% -> 52.97%             
client [14] (test)  loss: 0.8483 -> 0.8076   acc: 67.35% -> 71.84%             
client [99] (test)  loss: 1.0023 -> 1.0728   acc: 66.74% -> 65.98%             
client [20] (test)  loss: 1.3342 -> 1.4126   acc: 53.35% -> 53.54%             
client [39] (test)  loss: 1.2645 -> 1.1177   acc: 58.54% -> 60.80%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1305 -> 1.1386   acc: 62.42% -> 61.98%             
client [62] (test)  loss: 1.4337 -> 1.2746   acc: 56.23% -> 58.26%             
client [71] (test)  loss: 1.2756 -> 1.6888   acc: 56.50% -> 44.73%             
client [97] (test)  loss: 1.4690 -> 1.4145   acc: 50.46% -> 54.49%             
client [30] (test)  loss: 1.0095 -> 1.2155   acc: 65.70% -> 65.05%             
client [88] (test)  loss: 1.4840 -> 1.1186   acc: 50.44% -> 61.56%             
client [60] (test)  loss: 2.1874 -> 1.4340   acc: 34.72% -> 54.66%             
client [82] (test)  loss: 1.7975 -> 1.6494   acc: 41.64% -> 48.27%             
client [91] (test)  loss: 1.3455 -> 1.2211   acc: 50.00% -> 54.59%             
client [57] (test)  loss: 1.1111 -> 1.0320   acc: 60.59% -> 61.93%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.4551 -> 1.2089   acc: 56.97% -> 59.61%             
client [15] (test)  loss: 1.1355 -> 0.9995   acc: 62.90% -> 68.35%             
client [71] (test)  loss: 1.3531 -> 1.7688   acc: 54.78% -> 44.73%             
client [97] (test)  loss: 1.4821 -> 1.4898   acc: 54.26% -> 53.46%             
client [53] (test)  loss: 1.1966 -> 1.3428   acc: 58.54% -> 52.62%             
client [77] (test)  loss: 1.2471 -> 1.2437   acc: 58.07% -> 61.58%             
client [76] (test)  loss: 0.9398 -> 0.9754   acc: 69.83% -> 68.93%             
client [79] (test)  loss: 1.3073 -> 1.3795   acc: 54.63% -> 51.32%             
client [28] (test)  loss: 1.2511 -> 1.5418   acc: 59.02% -> 57.53%             
client [99] (test)  loss: 1.0475 -> 1.0421   acc: 66.12% -> 68.25%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.6199 -> 1.6514   acc: 51.50% -> 52.76%             
client [86] (test)  loss: 1.5297 -> 1.8797   acc: 50.97% -> 39.52%             
client [34] (test)  loss: 1.4808 -> 1.4017   acc: 58.87% -> 59.96%             
client [73] (test)  loss: 1.2997 -> 1.4032   acc: 56.32% -> 54.26%             
client [5] (test)  loss: 1.2323 -> 1.2069   acc: 60.43% -> 62.28%              
client [96] (test)  loss: 2.4380 -> 1.5156   acc: 29.22% -> 51.65%             
client [22] (test)  loss: 1.2342 -> 1.4160   acc: 60.23% -> 61.60%             
client [60] (test)  loss: 1.9320 -> 1.4625   acc: 41.96% -> 54.86%             
client [66] (test)  loss: 1.0233 -> 1.0483   acc: 65.21% -> 65.72%             
client [83] (test)  loss: 3.0307 -> 1.1424   acc: 40.15% -> 65.59%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.9932 -> 1.0285   acc: 69.13% -> 67.88%             
client [65] (test)  loss: 1.2986 -> 1.5296   acc: 56.88% -> 54.97%             
client [95] (test)  loss: 1.3291 -> 1.3611   acc: 55.82% -> 53.80%             
client [17] (test)  loss: 1.1553 -> 1.0458   acc: 60.98% -> 65.08%             
client [8] (test)  loss: 0.9565 -> 1.1147   acc: 73.65% -> 69.67%              
client [35] (test)  loss: 1.4658 -> 1.4964   acc: 54.89% -> 55.50%             
client [98] (test)  loss: 1.4411 -> 1.4278   acc: 49.05% -> 48.14%             
client [53] (test)  loss: 1.1785 -> 1.3288   acc: 60.54% -> 55.31%             
client [43] (test)  loss: 0.8445 -> 0.6442   acc: 71.82% -> 81.34%             
client [64] (test)  loss: 1.3469 -> 1.4105   acc: 57.43% -> 56.04%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.1512 -> 1.1381   acc: 60.63% -> 59.72%             
client [88] (test)  loss: 1.3083 -> 1.1937   acc: 55.33% -> 61.56%             
client [38] (test)  loss: 1.2154 -> 1.2776   acc: 62.86% -> 63.06%             
client [3] (test)  loss: 1.4544 -> 1.5514   acc: 50.56% -> 53.58%              
client [5] (test)  loss: 1.2256 -> 1.2905   acc: 61.20% -> 60.61%              
client [41] (test)  loss: 1.4194 -> 1.5629   acc: 52.28% -> 54.16%             
client [7] (test)  loss: 0.9182 -> 1.0501   acc: 70.01% -> 68.11%              
client [37] (test)  loss: 1.4176 -> 1.1865   acc: 54.45% -> 62.53%             
client [45] (test)  loss: 1.3940 -> 1.3129   acc: 54.89% -> 55.21%             
client [47] (test)  loss: 1.1961 -> 1.1292   acc: 62.95% -> 64.29%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.1121 -> 1.3161   acc: 62.78% -> 59.37%             
client [11] (test)  loss: 3.5333 -> 1.3572   acc: 30.17% -> 58.52%             
client [37] (test)  loss: 1.3818 -> 1.2925   acc: 57.02% -> 60.76%             
client [41] (test)  loss: 1.3388 -> 1.5897   acc: 53.01% -> 54.89%             
client [95] (test)  loss: 1.4879 -> 1.5999   acc: 53.61% -> 49.75%             
client [53] (test)  loss: 1.2850 -> 1.3482   acc: 58.69% -> 54.38%             
client [22] (test)  loss: 1.1620 -> 1.2840   acc: 62.90% -> 63.18%             
client [25] (test)  loss: 1.4376 -> 1.5090   acc: 49.66% -> 48.34%             
client [69] (test)  loss: 2.1224 -> 1.5155   acc: 44.16% -> 58.76%             
client [46] (test)  loss: 1.3378 -> 1.6124   acc: 52.12% -> 53.43%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.0613 -> 1.2451   acc: 66.29% -> 63.69%             
client [69] (test)  loss: 2.0624 -> 1.6094   acc: 45.58% -> 58.55%             
client [82] (test)  loss: 2.2078 -> 1.9771   acc: 41.18% -> 45.75%             
client [45] (test)  loss: 1.3299 -> 1.3927   acc: 55.61% -> 53.38%             
client [7] (test)  loss: 1.0352 -> 1.0577   acc: 64.86% -> 67.71%              
client [50] (test)  loss: 1.3624 -> 1.4045   acc: 53.69% -> 55.67%             
client [35] (test)  loss: 1.5009 -> 1.4715   acc: 58.51% -> 59.05%             
client [24] (test)  loss: 1.3345 -> 1.2789   acc: 60.47% -> 61.12%             
client [15] (test)  loss: 0.8945 -> 0.9944   acc: 69.58% -> 68.76%             
client [58] (test)  loss: 1.5184 -> 1.7708   acc: 54.44% -> 51.58%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.1784 -> 1.3160   acc: 59.28% -> 58.73%             
client [76] (test)  loss: 1.2371 -> 1.0617   acc: 65.74% -> 68.53%             
client [67] (test)  loss: 1.4575 -> 2.1489   acc: 53.00% -> 40.92%             
client [37] (test)  loss: 1.7630 -> 1.3584   acc: 52.90% -> 60.62%             
client [58] (test)  loss: 1.4715 -> 1.6104   acc: 56.21% -> 54.83%             
client [64] (test)  loss: 1.4493 -> 1.4970   acc: 56.36% -> 58.24%             
client [77] (test)  loss: 1.4602 -> 1.2971   acc: 55.16% -> 63.04%             
client [55] (test)  loss: 1.5484 -> 2.0573   acc: 52.12% -> 44.19%             
client [12] (test)  loss: 1.2592 -> 1.2286   acc: 61.67% -> 63.17%             
client [89] (test)  loss: 1.4128 -> 1.4776   acc: 60.47% -> 60.74%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.8157 -> 1.5403   acc: 50.12% -> 65.55%             
client [51] (test)  loss: 1.7023 -> 1.2954   acc: 50.62% -> 59.66%             
client [8] (test)  loss: 1.0041 -> 1.0565   acc: 74.28% -> 73.81%              
client [18] (test)  loss: 1.0629 -> 1.1713   acc: 64.82% -> 63.55%             
client [94] (test)  loss: 1.1780 -> 1.2868   acc: 63.77% -> 63.90%             
client [81] (test)  loss: 1.7126 -> 1.5378   acc: 53.24% -> 55.24%             
client [3] (test)  loss: 1.4526 -> 1.6746   acc: 53.86% -> 51.60%              
client [11] (test)  loss: 2.9714 -> 1.4749   acc: 37.91% -> 59.65%             
client [95] (test)  loss: 1.6913 -> 1.8188   acc: 54.56% -> 49.11%             
client [67] (test)  loss: 1.4737 -> 2.0364   acc: 53.15% -> 43.62%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.3074 -> 1.2283   acc: 61.59% -> 59.78%             
client [79] (test)  loss: 1.5849 -> 1.5283   acc: 52.42% -> 53.52%             
client [58] (test)  loss: 1.4379 -> 1.6921   acc: 57.50% -> 56.41%             
client [88] (test)  loss: 1.4553 -> 1.2917   acc: 59.33% -> 61.56%             
client [46] (test)  loss: 1.5250 -> 1.6638   acc: 52.04% -> 54.09%             
client [11] (test)  loss: 2.7295 -> 1.5192   acc: 40.26% -> 58.61%             
client [55] (test)  loss: 1.6537 -> 2.0628   acc: 51.24% -> 48.56%             
client [13] (test)  loss: 1.4802 -> 1.6244   acc: 56.53% -> 55.67%             
client [31] (test)  loss: 1.6837 -> 1.4115   acc: 54.96% -> 58.99%             
client [75] (test)  loss: 0.9714 -> 0.6940   acc: 72.62% -> 83.17%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.7740 -> 1.6751   acc: 51.52% -> 54.14%             
client [7] (test)  loss: 1.1941 -> 1.1665   acc: 60.52% -> 66.35%              
client [57] (test)  loss: 1.2331 -> 1.1821   acc: 61.37% -> 64.11%             
client [13] (test)  loss: 1.6132 -> 1.7117   acc: 54.96% -> 55.20%             
client [43] (test)  loss: 0.9553 -> 0.7387   acc: 70.15% -> 80.32%             
client [91] (test)  loss: 1.6785 -> 1.6054   acc: 46.47% -> 43.79%             
client [10] (test)  loss: 1.7038 -> 1.2741   acc: 50.69% -> 64.83%             
client [64] (test)  loss: 1.6214 -> 1.7899   acc: 57.97% -> 56.68%             
client [82] (test)  loss: 1.9252 -> 1.9192   acc: 50.23% -> 48.83%             
client [22] (test)  loss: 1.1516 -> 1.3077   acc: 64.12% -> 65.06%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.7045 -> 1.5110   acc: 50.61% -> 54.30%             
client [23] (test)  loss: 1.5412 -> 1.5770   acc: 53.52% -> 55.38%             
client [88] (test)  loss: 1.4159 -> 1.3580   acc: 60.67% -> 58.67%             
client [98] (test)  loss: 1.7552 -> 1.8245   acc: 44.55% -> 47.94%             
client [79] (test)  loss: 1.7934 -> 1.6476   acc: 52.94% -> 54.92%             
client [21] (test)  loss: 1.3317 -> 1.2472   acc: 60.51% -> 60.45%             
client [92] (test)  loss: 1.9708 -> 1.9385   acc: 39.07% -> 42.82%             
client [56] (test)  loss: 2.0521 -> 1.9603   acc: 44.17% -> 47.88%             
client [5] (test)  loss: 1.3342 -> 1.4967   acc: 61.26% -> 60.67%              
client [52] (test)  loss: 1.3786 -> 1.3542   acc: 62.20% -> 63.08%             
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '1.3101 -> 0.0000', 'accuracy': '57.08% -> 0.00%'},          
    200: {'loss': '1.6507 -> 0.0000', 'accuracy': '55.59% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_1 achieved 10.0%(10.65%) at epoch: 0                                    
FedPer_1 achieved 20.0%(25.16%) at epoch: 3                                    
FedPer_1 achieved 30.0%(33.79%) at epoch: 4                                    
FedPer_1 achieved 40.0%(48.59%) at epoch: 16                                   
FedPer_1 achieved 50.0%(50.86%) at epoch: 19                                   
FedPer_1 achieved 60.0%(61.05%) at epoch: 78                                   
Convergence (test_after):                                                      
FedPer_1 achieved 40.0%(40.18%) at epoch: 0                                    
FedPer_1 achieved 50.0%(50.21%) at epoch: 16                                   
FedPer_1 achieved 60.0%(60.64%) at epoch: 78                                   
