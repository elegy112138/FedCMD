==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7149 -> 1.7013   acc: 39.38% -> 35.23%             
client [81] (test)  loss: 1.7706 -> 2.5160   acc: 33.54% -> 24.00%             
client [21] (test)  loss: 36.6511 -> 1.6609   acc: 9.42% -> 36.47%             
client [68] (test)  loss: 1.6899 -> 1.8016   acc: 36.22% -> 25.32%             
client [93] (test)  loss: 1.8721 -> 1.5790   acc: 30.36% -> 45.83%             
client [31] (test)  loss: 2.0045 -> 1.6878   acc: 22.97% -> 39.22%             
client [20] (test)  loss: 1.5993 -> 1.4576   acc: 49.26% -> 52.21%             
client [59] (test)  loss: 39.8099 -> 2.1695   acc: 4.37% -> 26.82%             
client [48] (test)  loss: 2.4302 -> 2.0850   acc: 42.98% -> 29.75%             
client [34] (test)  loss: 1.7424 -> 2.0515   acc: 37.33% -> 32.43%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.3631 -> 1.7259   acc: 19.82% -> 37.39%             
client [99] (test)  loss: 1.6422 -> 1.4766   acc: 41.98% -> 47.17%             
client [67] (test)  loss: 1.4441 -> 1.3250   acc: 48.52% -> 50.59%             
client [0] (test)  loss: 1.4612 -> 1.4798   acc: 47.74% -> 50.21%              
client [76] (test)  loss: 1.5574 -> 1.7387   acc: 41.83% -> 43.46%             
client [41] (test)  loss: 1.9288 -> 1.7529   acc: 26.02% -> 39.78%             
client [62] (test)  loss: 98.3438 -> 1.4548   acc: 19.73% -> 48.64%            
client [2] (test)  loss: 147.6864 -> 1.4129   acc: 1.73% -> 53.98%             
client [14] (test)  loss: 1.3307 -> 1.7372   acc: 54.77% -> 42.74%             
client [46] (test)  loss: 1.4166 -> 1.7974   acc: 55.37% -> 43.80%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.2067 -> 1.9309   acc: 54.14% -> 36.98%             
client [68] (test)  loss: 1.7350 -> 1.5654   acc: 34.62% -> 32.37%             
client [57] (test)  loss: 1.7619 -> 1.4611   acc: 41.07% -> 50.00%             
client [17] (test)  loss: 1.9862 -> 1.2172   acc: 38.63% -> 56.87%             
client [54] (test)  loss: 1.2872 -> 1.3820   acc: 51.12% -> 50.00%             
client [23] (test)  loss: 134.7565 -> 1.3875   acc: 12.30% -> 49.21%           
client [35] (test)  loss: 1.4398 -> 1.3090   acc: 48.36% -> 52.36%             
client [59] (test)  loss: 1.9703 -> 2.1899   acc: 32.36% -> 33.24%             
client [31] (test)  loss: 1.4389 -> 1.4102   acc: 52.30% -> 48.41%             
client [9] (test)  loss: 1.4442 -> 1.8445   acc: 50.78% -> 43.57%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2658 -> 1.2055   acc: 51.37% -> 59.27%             
client [33] (test)  loss: 1.7311 -> 1.5437   acc: 40.92% -> 45.87%             
client [16] (test)  loss: 1.4129 -> 1.2711   acc: 50.15% -> 51.99%             
client [44] (test)  loss: 3.1783 -> 1.4752   acc: 35.12% -> 46.49%             
client [8] (test)  loss: 1.4989 -> 1.3582   acc: 50.38% -> 53.65%              
client [31] (test)  loss: 1.5325 -> 1.4310   acc: 49.12% -> 46.64%             
client [47] (test)  loss: 1.5292 -> 1.2471   acc: 43.73% -> 52.41%             
client [36] (test)  loss: 1.3528 -> 1.5006   acc: 55.08% -> 49.54%             
client [20] (test)  loss: 1.1751 -> 1.0529   acc: 62.13% -> 66.18%             
client [56] (test)  loss: 1.8720 -> 1.8949   acc: 38.17% -> 41.60%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.2002 -> 1.2885   acc: 61.54% -> 61.26%              
client [60] (test)  loss: 1.1407 -> 1.0937   acc: 59.75% -> 64.41%             
client [28] (test)  loss: 1.8295 -> 1.2679   acc: 45.65% -> 60.56%             
client [25] (test)  loss: 1.7698 -> 1.3247   acc: 34.42% -> 48.66%             
client [58] (test)  loss: 1.4167 -> 1.3762   acc: 48.62% -> 48.92%             
client [44] (test)  loss: 1.2833 -> 1.4609   acc: 54.85% -> 48.16%             
client [39] (test)  loss: 1.3435 -> 1.4872   acc: 53.33% -> 48.44%             
client [29] (test)  loss: 1.7774 -> 1.5014   acc: 41.96% -> 52.51%             
client [3] (test)  loss: 1.2374 -> 1.1922   acc: 54.44% -> 59.27%              
client [84] (test)  loss: 1.3229 -> 2.0418   acc: 51.95% -> 48.38%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.3659 -> 1.6864   acc: 53.19% -> 50.15%             
client [84] (test)  loss: 1.1151 -> 1.8891   acc: 64.61% -> 51.62%             
client [10] (test)  loss: 1.3816 -> 1.3287   acc: 52.65% -> 53.03%             
client [36] (test)  loss: 1.2459 -> 1.2904   acc: 56.00% -> 57.54%             
client [65] (test)  loss: 1.5730 -> 1.5076   acc: 43.25% -> 58.73%             
client [81] (test)  loss: 1.7242 -> 1.5665   acc: 43.69% -> 46.77%             
client [79] (test)  loss: 1.5304 -> 1.3235   acc: 48.07% -> 54.14%             
client [42] (test)  loss: 2.4283 -> 1.4402   acc: 45.94% -> 54.06%             
client [11] (test)  loss: 1.2245 -> 1.3025   acc: 57.72% -> 57.32%             
client [96] (test)  loss: 1.7724 -> 1.3952   acc: 43.09% -> 50.00%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.3351 -> 1.5759   acc: 55.67% -> 52.90%              
client [53] (test)  loss: 1.4495 -> 1.2920   acc: 50.00% -> 54.84%             
client [52] (test)  loss: 2.0114 -> 1.1008   acc: 31.75% -> 63.17%             
client [42] (test)  loss: 1.8593 -> 1.2876   acc: 47.62% -> 55.74%             
client [69] (test)  loss: 1.5083 -> 1.5964   acc: 48.20% -> 48.65%             
client [59] (test)  loss: 1.6742 -> 1.6248   acc: 45.77% -> 49.56%             
client [7] (test)  loss: 0.7965 -> 0.6897   acc: 75.38% -> 76.40%              
client [26] (test)  loss: 1.0057 -> 1.3225   acc: 68.70% -> 57.00%             
client [49] (test)  loss: 0.9111 -> 0.8598   acc: 66.56% -> 70.03%             
client [98] (test)  loss: 1.4565 -> 1.3426   acc: 50.00% -> 57.14%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.3438 -> 1.2899   acc: 50.42% -> 55.04%             
client [47] (test)  loss: 1.2569 -> 1.2432   acc: 58.52% -> 57.56%             
client [21] (test)  loss: 1.6353 -> 1.7060   acc: 48.63% -> 51.06%             
client [77] (test)  loss: 1.4961 -> 1.4177   acc: 49.22% -> 51.30%             
client [95] (test)  loss: 2.1802 -> 1.4727   acc: 41.95% -> 51.37%             
client [91] (test)  loss: 1.0780 -> 1.0650   acc: 61.84% -> 65.74%             
client [14] (test)  loss: 1.8030 -> 1.3706   acc: 41.08% -> 56.85%             
client [99] (test)  loss: 1.4553 -> 1.2635   acc: 49.06% -> 56.60%             
client [20] (test)  loss: 1.4363 -> 0.9761   acc: 53.68% -> 70.59%             
client [39] (test)  loss: 1.4291 -> 1.3916   acc: 58.67% -> 56.89%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.4099 -> 1.0940   acc: 58.10% -> 65.08%             
client [62] (test)  loss: 1.1760 -> 1.0943   acc: 63.61% -> 63.61%             
client [71] (test)  loss: 1.3102 -> 1.3458   acc: 57.21% -> 58.56%             
client [97] (test)  loss: 1.4354 -> 1.0915   acc: 46.82% -> 60.67%             
client [30] (test)  loss: 1.3401 -> 1.4569   acc: 53.41% -> 51.63%             
client [88] (test)  loss: 2.8662 -> 1.6501   acc: 26.25% -> 51.83%             
client [60] (test)  loss: 1.2999 -> 1.1274   acc: 55.51% -> 64.83%             
client [82] (test)  loss: 1.8797 -> 1.3038   acc: 40.21% -> 61.19%             
client [91] (test)  loss: 1.3917 -> 1.1125   acc: 60.45% -> 65.74%             
client [57] (test)  loss: 1.4577 -> 1.3191   acc: 55.06% -> 54.76%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5490 -> 1.4304   acc: 53.36% -> 56.89%             
client [15] (test)  loss: 1.2648 -> 1.1052   acc: 54.81% -> 59.62%             
client [71] (test)  loss: 1.6716 -> 1.3501   acc: 42.79% -> 59.91%             
client [97] (test)  loss: 1.3287 -> 1.1456   acc: 55.81% -> 61.80%             
client [53] (test)  loss: 1.6049 -> 1.2751   acc: 52.58% -> 57.74%             
client [77] (test)  loss: 1.5290 -> 1.4954   acc: 48.70% -> 49.74%             
client [76] (test)  loss: 1.1965 -> 1.4433   acc: 62.42% -> 47.39%             
client [79] (test)  loss: 1.5623 -> 1.5772   acc: 51.93% -> 45.30%             
client [28] (test)  loss: 1.7437 -> 1.0830   acc: 49.07% -> 67.70%             
client [99] (test)  loss: 1.9682 -> 1.3099   acc: 40.57% -> 55.66%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.2857 -> 1.0950   acc: 57.68% -> 62.92%             
client [86] (test)  loss: 0.9347 -> 0.9406   acc: 71.13% -> 70.24%             
client [34] (test)  loss: 1.6142 -> 1.7437   acc: 50.41% -> 49.32%             
client [73] (test)  loss: 1.1707 -> 1.2154   acc: 59.26% -> 64.81%             
client [5] (test)  loss: 1.3412 -> 1.3330   acc: 57.22% -> 54.01%              
client [96] (test)  loss: 1.5294 -> 1.3984   acc: 54.88% -> 57.32%             
client [22] (test)  loss: 1.4658 -> 1.4571   acc: 60.93% -> 58.60%             
client [60] (test)  loss: 1.2275 -> 1.0570   acc: 59.75% -> 65.25%             
client [66] (test)  loss: 1.2359 -> 1.4768   acc: 63.16% -> 57.89%             
client [83] (test)  loss: 1.5702 -> 1.6289   acc: 52.61% -> 50.37%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.2952 -> 1.5161   acc: 59.80% -> 48.04%             
client [65] (test)  loss: 1.4814 -> 1.2576   acc: 53.57% -> 61.11%             
client [95] (test)  loss: 1.9262 -> 1.4298   acc: 48.63% -> 52.89%             
client [17] (test)  loss: 1.5686 -> 1.2996   acc: 54.27% -> 59.72%             
client [8] (test)  loss: 1.2586 -> 1.3501   acc: 58.19% -> 59.95%              
client [35] (test)  loss: 2.7459 -> 1.6731   acc: 37.82% -> 52.73%             
client [98] (test)  loss: 1.5519 -> 1.4366   acc: 51.68% -> 58.82%             
client [53] (test)  loss: 1.7158 -> 1.4419   acc: 54.19% -> 55.81%             
client [43] (test)  loss: 1.1400 -> 0.8880   acc: 59.26% -> 70.99%             
client [64] (test)  loss: 1.1018 -> 1.1612   acc: 58.97% -> 59.88%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.5710 -> 1.3715   acc: 51.06% -> 57.45%             
client [88] (test)  loss: 1.8622 -> 1.7258   acc: 47.18% -> 52.49%             
client [38] (test)  loss: 2.6690 -> 1.8147   acc: 29.60% -> 48.80%             
client [3] (test)  loss: 1.5100 -> 1.3052   acc: 53.23% -> 59.27%              
client [5] (test)  loss: 1.2494 -> 1.2883   acc: 58.82% -> 53.48%              
client [41] (test)  loss: 2.1641 -> 1.2162   acc: 46.47% -> 62.45%             
client [7] (test)  loss: 0.6850 -> 0.6567   acc: 78.17% -> 80.20%              
client [37] (test)  loss: 2.3508 -> 0.7669   acc: 42.35% -> 78.24%             
client [45] (test)  loss: 1.3574 -> 1.4899   acc: 58.55% -> 55.59%             
client [47] (test)  loss: 1.4867 -> 1.3578   acc: 57.56% -> 58.52%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.3443 -> 1.3115   acc: 59.94% -> 58.72%             
client [11] (test)  loss: 1.5262 -> 1.3492   acc: 55.69% -> 61.79%             
client [37] (test)  loss: 2.0455 -> 0.7923   acc: 45.29% -> 77.06%             
client [41] (test)  loss: 1.9920 -> 1.2294   acc: 47.21% -> 62.08%             
client [95] (test)  loss: 1.7595 -> 1.6194   acc: 50.15% -> 54.10%             
client [53] (test)  loss: 2.5130 -> 1.3883   acc: 47.10% -> 57.10%             
client [22] (test)  loss: 1.3229 -> 1.4387   acc: 64.43% -> 61.22%             
client [25] (test)  loss: 1.8207 -> 1.3349   acc: 45.99% -> 54.60%             
client [69] (test)  loss: 2.1341 -> 1.3859   acc: 45.95% -> 59.46%             
client [46] (test)  loss: 1.5655 -> 1.3557   acc: 58.95% -> 61.98%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.5776 -> 1.4362   acc: 54.98% -> 59.81%             
client [69] (test)  loss: 1.8986 -> 1.4041   acc: 49.55% -> 59.46%             
client [82] (test)  loss: 1.5840 -> 1.4640   acc: 51.40% -> 58.39%             
client [45] (test)  loss: 1.3181 -> 1.5883   acc: 59.21% -> 54.28%             
client [7] (test)  loss: 0.6894 -> 0.6508   acc: 78.68% -> 81.22%              
client [50] (test)  loss: 1.6304 -> 2.0517   acc: 52.80% -> 46.40%             
client [35] (test)  loss: 2.7924 -> 1.5284   acc: 41.45% -> 56.73%             
client [24] (test)  loss: 1.1921 -> 1.1616   acc: 65.38% -> 65.38%             
client [15] (test)  loss: 1.2580 -> 1.1226   acc: 55.77% -> 62.50%             
client [58] (test)  loss: 1.5538 -> 1.5693   acc: 52.31% -> 52.92%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.2274 -> 1.4303   acc: 66.39% -> 58.95%             
client [76] (test)  loss: 1.2325 -> 1.4848   acc: 59.80% -> 51.96%             
client [67] (test)  loss: 1.6143 -> 1.1184   acc: 54.14% -> 64.79%             
client [37] (test)  loss: 0.9763 -> 0.8220   acc: 66.47% -> 77.65%             
client [58] (test)  loss: 2.0224 -> 1.6644   acc: 46.15% -> 52.31%             
client [64] (test)  loss: 1.3326 -> 1.0899   acc: 55.32% -> 66.26%             
client [77] (test)  loss: 1.4740 -> 1.7755   acc: 50.26% -> 48.70%             
client [55] (test)  loss: 1.3610 -> 1.3563   acc: 61.63% -> 56.73%             
client [12] (test)  loss: 1.0285 -> 1.1489   acc: 66.04% -> 71.93%             
client [89] (test)  loss: 1.8999 -> 1.6574   acc: 50.62% -> 51.85%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.3681 -> 1.5660   acc: 54.22% -> 59.09%             
client [51] (test)  loss: 2.5465 -> 1.3884   acc: 43.71% -> 61.26%             
client [8] (test)  loss: 1.6624 -> 1.5031   acc: 49.62% -> 60.45%              
client [18] (test)  loss: 1.0160 -> 1.1080   acc: 71.66% -> 73.29%             
client [94] (test)  loss: 1.8509 -> 1.4067   acc: 46.48% -> 57.75%             
client [81] (test)  loss: 1.7377 -> 1.5225   acc: 51.38% -> 57.54%             
client [3] (test)  loss: 1.2931 -> 1.4464   acc: 59.27% -> 57.66%              
client [11] (test)  loss: 1.6904 -> 1.3597   acc: 54.47% -> 62.60%             
client [95] (test)  loss: 2.0658 -> 1.6771   acc: 50.76% -> 55.93%             
client [67] (test)  loss: 1.7989 -> 1.1590   acc: 52.66% -> 63.91%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.2187 -> 1.3320   acc: 60.79% -> 58.36%             
client [79] (test)  loss: 1.5259 -> 1.4073   acc: 53.04% -> 55.25%             
client [58] (test)  loss: 1.8381 -> 1.7407   acc: 50.77% -> 54.46%             
client [88] (test)  loss: 2.1010 -> 1.6712   acc: 46.84% -> 53.82%             
client [46] (test)  loss: 1.9030 -> 1.3878   acc: 57.02% -> 64.19%             
client [11] (test)  loss: 1.4670 -> 1.3823   acc: 59.35% -> 62.20%             
client [55] (test)  loss: 1.6340 -> 1.5035   acc: 61.22% -> 53.47%             
client [13] (test)  loss: 1.3982 -> 1.2257   acc: 62.10% -> 66.53%             
client [31] (test)  loss: 1.7629 -> 1.4778   acc: 56.89% -> 59.36%             
client [75] (test)  loss: 1.1993 -> 1.0784   acc: 65.43% -> 68.05%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.6884 -> 1.4659   acc: 51.02% -> 59.59%             
client [7] (test)  loss: 0.7397 -> 0.7350   acc: 76.14% -> 79.95%              
client [57] (test)  loss: 1.5539 -> 1.5256   acc: 56.85% -> 59.52%             
client [13] (test)  loss: 1.5423 -> 1.1711   acc: 58.87% -> 67.34%             
client [43] (test)  loss: 1.2266 -> 0.9457   acc: 60.49% -> 71.91%             
client [91] (test)  loss: 0.9889 -> 1.0233   acc: 69.64% -> 68.25%             
client [10] (test)  loss: 2.4226 -> 1.7495   acc: 44.70% -> 49.24%             
client [64] (test)  loss: 1.0792 -> 1.1083   acc: 62.31% -> 67.17%             
client [82] (test)  loss: 1.7640 -> 1.6152   acc: 50.70% -> 56.99%             
client [22] (test)  loss: 1.3973 -> 1.4951   acc: 65.60% -> 61.81%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.0609 -> 1.1012   acc: 44.12% -> 70.22%             
client [23] (test)  loss: 2.6605 -> 1.5018   acc: 36.28% -> 60.57%             
client [88] (test)  loss: 2.5667 -> 1.7500   acc: 43.52% -> 52.16%             
client [98] (test)  loss: 1.6078 -> 1.5071   acc: 53.36% -> 59.66%             
client [79] (test)  loss: 1.5385 -> 1.4926   acc: 54.14% -> 51.38%             
client [21] (test)  loss: 1.6069 -> 1.3725   acc: 53.19% -> 59.57%             
client [92] (test)  loss: 2.9933 -> 2.1785   acc: 34.10% -> 44.92%             
client [56] (test)  loss: 1.6900 -> 2.0625   acc: 59.54% -> 53.05%             
client [5] (test)  loss: 1.2792 -> 1.3965   acc: 57.75% -> 56.15%              
client [52] (test)  loss: 2.2009 -> 1.3704   acc: 42.86% -> 63.17%             
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '1.4358 -> 0.0000', 'accuracy': '55.44% -> 0.00%'},          
    200: {'loss': '1.7273 -> 0.0000', 'accuracy': '55.52% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_1 achieved 10.0%(12.49%) at epoch: 1                                    
FedPer_1 achieved 20.0%(22.58%) at epoch: 3                                    
FedPer_1 achieved 30.0%(33.25%) at epoch: 7                                    
FedPer_1 achieved 40.0%(40.61%) at epoch: 20                                   
FedPer_1 achieved 50.0%(54.40%) at epoch: 34                                   
FedPer_1 achieved 60.0%(60.87%) at epoch: 80                                   
Convergence (test_after):                                                      
FedPer_1 achieved 30.0%(32.75%) at epoch: 0                                    
FedPer_1 achieved 40.0%(46.79%) at epoch: 12                                   
FedPer_1 achieved 50.0%(50.11%) at epoch: 28                                   
FedPer_1 achieved 60.0%(62.14%) at epoch: 94                                   
