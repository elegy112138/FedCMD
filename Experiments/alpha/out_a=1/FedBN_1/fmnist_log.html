==================== ALGORITHM: FedBN_1 ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8798 -> 0.5939   acc: 67.86% -> 78.21%             
client [81] (test)  loss: 1.0459 -> 0.7167   acc: 56.58% -> 70.59%             
client [21] (test)  loss: 17.4147 -> 0.5654   acc: 40.56% -> 85.00%            
client [68] (test)  loss: 0.9305 -> 0.7058   acc: 68.99% -> 75.95%             
client [93] (test)  loss: 1.1030 -> 0.5739   acc: 55.56% -> 81.59%             
client [31] (test)  loss: 1.1607 -> 0.6548   acc: 50.10% -> 75.35%             
client [20] (test)  loss: 0.8615 -> 0.6909   acc: 68.79% -> 75.80%             
client [59] (test)  loss: 20.3205 -> 0.3726   acc: 33.14% -> 89.43%            
client [48] (test)  loss: 0.5674 -> 0.3012   acc: 85.30% -> 87.66%             
client [34] (test)  loss: 0.6495 -> 0.4290   acc: 76.90% -> 85.60%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6706 -> 0.3003   acc: 77.14% -> 89.35%             
client [99] (test)  loss: 0.5185 -> 0.3284   acc: 82.20% -> 88.42%             
client [67] (test)  loss: 0.5864 -> 0.3432   acc: 82.87% -> 90.18%             
client [0] (test)  loss: 0.5496 -> 0.4804   acc: 82.45% -> 82.45%              
client [76] (test)  loss: 0.5792 -> 0.2734   acc: 80.51% -> 91.22%             
client [41] (test)  loss: 0.7745 -> 0.5796   acc: 69.00% -> 78.97%             
client [62] (test)  loss: 23.7376 -> 0.5096   acc: 44.34% -> 83.18%            
client [2] (test)  loss: 31.9447 -> 0.4924   acc: 30.77% -> 81.35%             
client [14] (test)  loss: 0.6675 -> 0.3752   acc: 75.57% -> 87.41%             
client [46] (test)  loss: 0.5935 -> 0.3335   acc: 78.13% -> 86.01%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4735 -> 0.3817   acc: 81.86% -> 86.40%             
client [68] (test)  loss: 0.5102 -> 0.4565   acc: 79.11% -> 81.65%             
client [57] (test)  loss: 0.4891 -> 0.3163   acc: 85.20% -> 90.61%             
client [17] (test)  loss: 0.4961 -> 0.2415   acc: 83.77% -> 92.41%             
client [54] (test)  loss: 0.3530 -> 0.2414   acc: 89.74% -> 91.89%             
client [23] (test)  loss: 40.2695 -> 0.2525   acc: 20.81% -> 91.93%            
client [35] (test)  loss: 0.5219 -> 0.3299   acc: 79.48% -> 88.81%             
client [59] (test)  loss: 0.4120 -> 0.2303   acc: 86.57% -> 91.71%             
client [31] (test)  loss: 0.5980 -> 0.5179   acc: 74.75% -> 78.93%             
client [9] (test)  loss: 0.5279 -> 0.3862   acc: 81.36% -> 84.89%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7113 -> 0.4122   acc: 74.79% -> 85.55%             
client [33] (test)  loss: 0.4275 -> 0.3535   acc: 83.51% -> 86.76%             
client [16] (test)  loss: 0.3316 -> 0.1671   acc: 89.79% -> 94.50%             
client [44] (test)  loss: 0.9410 -> 0.2881   acc: 70.04% -> 90.75%             
client [8] (test)  loss: 0.3815 -> 0.3603   acc: 88.39% -> 86.45%              
client [31] (test)  loss: 0.6690 -> 0.5039   acc: 74.55% -> 79.92%             
client [47] (test)  loss: 0.6471 -> 0.4385   acc: 74.91% -> 83.52%             
client [36] (test)  loss: 0.4776 -> 0.3869   acc: 81.60% -> 84.97%             
client [20] (test)  loss: 0.5411 -> 0.5221   acc: 81.85% -> 80.89%             
client [56] (test)  loss: 0.4677 -> 0.4563   acc: 84.06% -> 85.00%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7223 -> 0.5446   acc: 75.00% -> 76.80%              
client [60] (test)  loss: 0.3942 -> 0.2001   acc: 85.89% -> 95.54%             
client [28] (test)  loss: 0.6411 -> 0.6043   acc: 79.26% -> 82.95%             
client [25] (test)  loss: 0.6422 -> 0.4065   acc: 78.10% -> 86.02%             
client [58] (test)  loss: 0.3435 -> 0.2098   acc: 89.53% -> 92.67%             
client [44] (test)  loss: 0.3945 -> 0.2655   acc: 83.92% -> 90.75%             
client [39] (test)  loss: 0.6336 -> 0.3590   acc: 75.48% -> 85.83%             
client [29] (test)  loss: 0.7921 -> 0.4792   acc: 70.36% -> 85.33%             
client [3] (test)  loss: 0.4897 -> 0.3636   acc: 81.27% -> 87.33%              
client [84] (test)  loss: 0.5913 -> 0.3428   acc: 78.26% -> 86.09%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4511 -> 0.3174   acc: 86.11% -> 88.89%             
client [84] (test)  loss: 0.5446 -> 0.3378   acc: 80.58% -> 88.12%             
client [10] (test)  loss: 0.4715 -> 0.2947   acc: 85.00% -> 90.56%             
client [36] (test)  loss: 0.5117 -> 0.3677   acc: 79.14% -> 86.50%             
client [65] (test)  loss: 0.2979 -> 0.2859   acc: 89.29% -> 89.96%             
client [81] (test)  loss: 0.4914 -> 0.4852   acc: 77.87% -> 81.51%             
client [79] (test)  loss: 0.6967 -> 0.5161   acc: 75.69% -> 76.80%             
client [42] (test)  loss: 0.8132 -> 0.3411   acc: 67.91% -> 89.77%             
client [11] (test)  loss: 0.4590 -> 0.4113   acc: 84.78% -> 87.32%             
client [96] (test)  loss: 0.3631 -> 0.2661   acc: 86.15% -> 90.58%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3852 -> 0.3599   acc: 85.81% -> 86.45%              
client [53] (test)  loss: 0.3917 -> 0.1737   acc: 85.09% -> 94.96%             
client [52] (test)  loss: 0.5890 -> 0.4270   acc: 78.95% -> 86.15%             
client [42] (test)  loss: 0.5603 -> 0.3375   acc: 79.07% -> 89.77%             
client [69] (test)  loss: 0.3744 -> 0.2693   acc: 86.23% -> 90.91%             
client [59] (test)  loss: 0.4242 -> 0.2034   acc: 86.00% -> 93.71%             
client [7] (test)  loss: 0.4664 -> 0.4122   acc: 84.72% -> 86.39%              
client [26] (test)  loss: 0.2460 -> 0.2513   acc: 90.53% -> 91.23%             
client [49] (test)  loss: 0.4997 -> 0.4381   acc: 84.49% -> 84.25%             
client [98] (test)  loss: 0.4728 -> 0.4269   acc: 81.11% -> 83.61%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5286 -> 0.4336   acc: 79.72% -> 84.17%             
client [47] (test)  loss: 0.6579 -> 0.4191   acc: 74.53% -> 86.52%             
client [21] (test)  loss: 0.4019 -> 0.3314   acc: 86.67% -> 90.00%             
client [77] (test)  loss: 0.3597 -> 0.3190   acc: 85.71% -> 85.36%             
client [95] (test)  loss: 0.4316 -> 0.2908   acc: 87.04% -> 89.01%             
client [91] (test)  loss: 0.6219 -> 0.3808   acc: 78.42% -> 86.58%             
client [14] (test)  loss: 0.3987 -> 0.2824   acc: 85.89% -> 89.17%             
client [99] (test)  loss: 0.3030 -> 0.2435   acc: 89.27% -> 92.09%             
client [20] (test)  loss: 0.5493 -> 0.4608   acc: 82.80% -> 83.44%             
client [39] (test)  loss: 0.7012 -> 0.3616   acc: 71.39% -> 86.92%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5781 -> 0.4409   acc: 79.50% -> 85.60%             
client [62] (test)  loss: 0.4648 -> 0.4276   acc: 85.93% -> 87.16%             
client [71] (test)  loss: 0.3831 -> 0.2359   acc: 87.29% -> 93.22%             
client [97] (test)  loss: 0.6285 -> 0.3708   acc: 77.24% -> 88.81%             
client [30] (test)  loss: 0.3690 -> 0.3026   acc: 85.47% -> 90.88%             
client [88] (test)  loss: 0.5560 -> 0.4376   acc: 80.17% -> 83.47%             
client [60] (test)  loss: 0.3378 -> 0.2234   acc: 91.58% -> 95.05%             
client [82] (test)  loss: 0.3930 -> 0.3091   acc: 86.32% -> 90.05%             
client [91] (test)  loss: 0.5328 -> 0.3848   acc: 81.32% -> 86.32%             
client [57] (test)  loss: 0.3484 -> 0.3008   acc: 90.61% -> 91.34%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6864 -> 0.5527   acc: 77.73% -> 79.52%             
client [15] (test)  loss: 0.3350 -> 0.3119   acc: 88.92% -> 90.03%             
client [71] (test)  loss: 0.3932 -> 0.2379   acc: 87.57% -> 91.81%             
client [97] (test)  loss: 0.5637 -> 0.3781   acc: 80.60% -> 88.43%             
client [53] (test)  loss: 0.4279 -> 0.1806   acc: 83.77% -> 94.08%             
client [77] (test)  loss: 0.3633 -> 0.3230   acc: 87.50% -> 86.07%             
client [76] (test)  loss: 0.3939 -> 0.2629   acc: 87.37% -> 92.08%             
client [79] (test)  loss: 0.8098 -> 0.4910   acc: 73.20% -> 80.94%             
client [28] (test)  loss: 0.5987 -> 0.6037   acc: 82.95% -> 81.57%             
client [99] (test)  loss: 0.3248 -> 0.2328   acc: 88.70% -> 93.22%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4514 -> 0.3872   acc: 83.58% -> 88.43%             
client [86] (test)  loss: 0.1847 -> 0.1501   acc: 93.49% -> 94.88%             
client [34] (test)  loss: 0.5794 -> 0.4182   acc: 80.98% -> 88.04%             
client [73] (test)  loss: 0.4293 -> 0.2860   acc: 82.99% -> 89.55%             
client [5] (test)  loss: 0.5170 -> 0.4031   acc: 82.38% -> 88.12%              
client [96] (test)  loss: 0.2554 -> 0.2449   acc: 91.69% -> 90.86%             
client [22] (test)  loss: 0.4907 -> 0.4079   acc: 82.58% -> 86.77%             
client [60] (test)  loss: 0.3760 -> 0.2397   acc: 86.39% -> 94.06%             
client [66] (test)  loss: 0.4797 -> 0.4448   acc: 84.81% -> 87.04%             
client [83] (test)  loss: 0.3146 -> 0.2182   acc: 90.98% -> 94.33%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3608 -> 0.2483   acc: 87.37% -> 92.29%             
client [65] (test)  loss: 0.2555 -> 0.2802   acc: 91.07% -> 90.62%             
client [95] (test)  loss: 0.3781 -> 0.2806   acc: 87.32% -> 89.30%             
client [17] (test)  loss: 0.3918 -> 0.2863   acc: 87.43% -> 92.15%             
client [8] (test)  loss: 0.2996 -> 0.3655   acc: 90.32% -> 86.45%              
client [35] (test)  loss: 0.4446 -> 0.3522   acc: 84.70% -> 89.55%             
client [98] (test)  loss: 0.5238 -> 0.4468   acc: 81.39% -> 84.44%             
client [53] (test)  loss: 0.3389 -> 0.1903   acc: 87.06% -> 94.52%             
client [43] (test)  loss: 0.3033 -> 0.1698   acc: 93.01% -> 96.24%             
client [64] (test)  loss: 0.6535 -> 0.4587   acc: 81.30% -> 86.12%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3581 -> 0.3298   acc: 91.11% -> 90.28%             
client [88] (test)  loss: 0.7638 -> 0.4431   acc: 74.93% -> 85.12%             
client [38] (test)  loss: 0.3305 -> 0.3285   acc: 89.31% -> 91.19%             
client [3] (test)  loss: 0.4856 -> 0.3163   acc: 83.20% -> 89.53%              
client [5] (test)  loss: 0.5752 -> 0.4024   acc: 82.38% -> 88.12%              
client [41] (test)  loss: 0.5338 -> 0.5168   acc: 81.92% -> 80.81%             
client [7] (test)  loss: 0.5047 -> 0.4050   acc: 84.72% -> 86.11%              
client [37] (test)  loss: 0.4212 -> 0.2648   acc: 85.75% -> 91.34%             
client [45] (test)  loss: 0.6173 -> 0.2669   acc: 78.01% -> 90.05%             
client [47] (test)  loss: 0.6027 -> 0.4337   acc: 80.15% -> 86.52%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3287 -> 0.1690   acc: 88.48% -> 94.76%             
client [11] (test)  loss: 0.4771 -> 0.3644   acc: 85.14% -> 85.87%             
client [37] (test)  loss: 0.4096 -> 0.2446   acc: 85.75% -> 91.06%             
client [41] (test)  loss: 0.7471 -> 0.5337   acc: 70.85% -> 80.44%             
client [95] (test)  loss: 0.5031 -> 0.3030   acc: 82.54% -> 88.45%             
client [53] (test)  loss: 0.4522 -> 0.2008   acc: 83.99% -> 94.08%             
client [22] (test)  loss: 0.4901 -> 0.3981   acc: 85.48% -> 89.03%             
client [25] (test)  loss: 0.9139 -> 0.5677   acc: 72.56% -> 83.38%             
client [69] (test)  loss: 0.4123 -> 0.2943   acc: 87.01% -> 91.95%             
client [46] (test)  loss: 0.4051 -> 0.3428   acc: 86.88% -> 90.09%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4678 -> 0.4689   acc: 83.15% -> 85.77%             
client [69] (test)  loss: 0.3948 -> 0.2891   acc: 87.53% -> 91.43%             
client [82] (test)  loss: 0.3398 -> 0.2918   acc: 89.55% -> 90.80%             
client [45] (test)  loss: 0.4280 -> 0.2720   acc: 84.55% -> 90.58%             
client [7] (test)  loss: 0.3991 -> 0.4475   acc: 85.83% -> 85.56%              
client [50] (test)  loss: 0.4671 -> 0.4853   acc: 84.87% -> 83.75%             
client [35] (test)  loss: 0.3656 -> 0.3851   acc: 86.94% -> 88.99%             
client [24] (test)  loss: 0.4426 -> 0.2909   acc: 85.89% -> 90.68%             
client [15] (test)  loss: 0.3944 -> 0.3087   acc: 89.20% -> 89.47%             
client [58] (test)  loss: 0.2634 -> 0.2383   acc: 90.84% -> 93.19%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2984 -> 0.2227   acc: 90.81% -> 92.13%             
client [76] (test)  loss: 0.4528 -> 0.2554   acc: 87.15% -> 91.43%             
client [67] (test)  loss: 0.4093 -> 0.3078   acc: 88.66% -> 92.19%             
client [37] (test)  loss: 0.3703 -> 0.2570   acc: 87.99% -> 90.50%             
client [58] (test)  loss: 0.2746 -> 0.2494   acc: 91.36% -> 91.88%             
client [64] (test)  loss: 0.6660 -> 0.4903   acc: 80.45% -> 85.55%             
client [77] (test)  loss: 0.3796 -> 0.3370   acc: 87.50% -> 87.14%             
client [55] (test)  loss: 0.5443 -> 0.4736   acc: 83.37% -> 87.87%             
client [12] (test)  loss: 0.6639 -> 0.4711   acc: 80.91% -> 81.82%             
client [89] (test)  loss: 0.7549 -> 0.3721   acc: 79.74% -> 88.75%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4702 -> 0.3265   acc: 84.35% -> 91.01%             
client [51] (test)  loss: 0.3375 -> 0.2949   acc: 88.29% -> 87.69%             
client [8] (test)  loss: 0.4994 -> 0.3600   acc: 85.16% -> 88.06%              
client [18] (test)  loss: 0.3155 -> 0.2965   acc: 89.36% -> 93.31%             
client [94] (test)  loss: 0.5541 -> 0.5560   acc: 81.61% -> 84.09%             
client [81] (test)  loss: 0.4929 -> 0.5413   acc: 80.95% -> 80.95%             
client [3] (test)  loss: 0.5296 -> 0.3545   acc: 80.99% -> 89.53%              
client [11] (test)  loss: 0.4373 -> 0.3925   acc: 85.51% -> 88.77%             
client [95] (test)  loss: 0.4923 -> 0.3130   acc: 85.07% -> 89.58%             
client [67] (test)  loss: 0.4157 -> 0.2999   acc: 87.91% -> 92.44%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3905 -> 0.3536   acc: 90.00% -> 90.83%             
client [79] (test)  loss: 0.8091 -> 0.4457   acc: 78.45% -> 85.08%             
client [58] (test)  loss: 0.2411 -> 0.2522   acc: 91.10% -> 91.88%             
client [88] (test)  loss: 0.9226 -> 0.4823   acc: 74.93% -> 85.12%             
client [46] (test)  loss: 0.4569 -> 0.3847   acc: 88.92% -> 89.50%             
client [11] (test)  loss: 0.4224 -> 0.3918   acc: 88.77% -> 88.04%             
client [55] (test)  loss: 0.6517 -> 0.4880   acc: 82.58% -> 87.08%             
client [13] (test)  loss: 0.2619 -> 0.2535   acc: 92.13% -> 91.86%             
client [31] (test)  loss: 1.1076 -> 0.5858   acc: 69.58% -> 78.53%             
client [75] (test)  loss: 0.3601 -> 0.2630   acc: 85.28% -> 87.73%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2726 -> 0.1847   acc: 92.07% -> 94.14%             
client [7] (test)  loss: 0.4046 -> 0.3924   acc: 85.56% -> 88.06%              
client [57] (test)  loss: 0.3020 -> 0.2845   acc: 91.70% -> 92.78%             
client [13] (test)  loss: 0.3256 -> 0.2585   acc: 88.71% -> 91.86%             
client [43] (test)  loss: 0.4429 -> 0.2334   acc: 89.25% -> 95.16%             
client [91] (test)  loss: 0.5765 -> 0.3759   acc: 81.84% -> 87.63%             
client [10] (test)  loss: 0.3555 -> 0.2970   acc: 90.56% -> 91.11%             
client [64] (test)  loss: 0.6795 -> 0.5145   acc: 82.72% -> 86.69%             
client [82] (test)  loss: 0.3899 -> 0.2846   acc: 86.57% -> 91.04%             
client [22] (test)  loss: 0.4649 -> 0.4166   acc: 86.13% -> 89.03%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5472 -> 0.4979   acc: 83.76% -> 85.67%             
client [23] (test)  loss: 0.7582 -> 0.2963   acc: 77.07% -> 94.48%             
client [88] (test)  loss: 0.7237 -> 0.4785   acc: 78.51% -> 84.02%             
client [98] (test)  loss: 0.4482 -> 0.5192   acc: 84.44% -> 84.44%             
client [79] (test)  loss: 0.6985 -> 0.4571   acc: 80.11% -> 85.91%             
client [21] (test)  loss: 0.4015 -> 0.3424   acc: 88.33% -> 90.00%             
client [92] (test)  loss: 0.5804 -> 0.5395   acc: 81.94% -> 82.21%             
client [56] (test)  loss: 0.4062 -> 0.3800   acc: 88.44% -> 89.06%             
client [5] (test)  loss: 0.6239 -> 0.3919   acc: 80.84% -> 88.51%              
client [52] (test)  loss: 0.5915 -> 0.5027   acc: 81.99% -> 85.32%             
==================== FedBN_1 TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.4680 -> 0.0000', 'accuracy': '84.28% -> 0.00%'},          
    200: {'loss': '0.4919 -> 0.0000', 'accuracy': '84.70% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_1 achieved 10.0%(16.06%) at epoch: 1                                     
FedBN_1 achieved 20.0%(21.98%) at epoch: 2                                     
FedBN_1 achieved 30.0%(32.87%) at epoch: 3                                     
FedBN_1 achieved 40.0%(48.54%) at epoch: 4                                     
FedBN_1 achieved 70.0%(70.75%) at epoch: 7                                     
FedBN_1 achieved 80.0%(82.02%) at epoch: 37                                    
Convergence (test_after):                                                      
FedBN_1 achieved 50.0%(53.09%) at epoch: 0                                     
FedBN_1 achieved 70.0%(71.19%) at epoch: 2                                     
FedBN_1 achieved 80.0%(81.38%) at epoch: 8                                     
FedBN_1 achieved 90.0%(91.13%) at epoch: 56                                    
