==================== ALGORITHM: FedBN_1 ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5426 -> 4.3821   acc: 0.33% -> 6.25%               
client [81] (test)  loss: 4.5279 -> 4.3712   acc: 3.99% -> 6.98%               
client [21] (test)  loss: 51.9724 -> 4.4824   acc: 1.00% -> 1.66%              
client [68] (test)  loss: 4.5610 -> 4.3903   acc: 1.32% -> 4.97%               
client [93] (test)  loss: 4.5496 -> 4.4101   acc: 1.62% -> 6.82%               
client [31] (test)  loss: 4.6529 -> 4.4704   acc: 1.05% -> 4.88%               
client [20] (test)  loss: 4.6503 -> 4.4796   acc: 0.35% -> 3.12%               
client [59] (test)  loss: 48.1659 -> 4.3102   acc: 0.91% -> 7.29%              
client [48] (test)  loss: 4.5112 -> 4.4294   acc: 3.96% -> 3.30%               
client [34] (test)  loss: 4.5548 -> 4.3565   acc: 0.90% -> 10.51%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.5312 -> 3.9271   acc: 1.32% -> 11.22%              
client [99] (test)  loss: 4.4311 -> 4.4902   acc: 5.68% -> 4.73%               
client [67] (test)  loss: 4.4030 -> 4.0655   acc: 2.99% -> 7.31%               
client [0] (test)  loss: 4.4489 -> 4.1218   acc: 2.99% -> 8.31%                
client [76] (test)  loss: 4.4554 -> 4.1447   acc: 2.51% -> 7.17%               
client [41] (test)  loss: 4.4999 -> 3.9898   acc: 0.98% -> 7.82%               
client [62] (test)  loss: 123.2828 -> 4.0736   acc: 1.09% -> 11.59%            
client [2] (test)  loss: 119.7219 -> 3.9784   acc: 0.97% -> 7.12%              
client [14] (test)  loss: 4.4112 -> 4.1800   acc: 3.53% -> 8.48%               
client [46] (test)  loss: 4.4727 -> 4.4185   acc: 2.27% -> 6.49%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1452 -> 4.2138   acc: 9.80% -> 4.73%               
client [68] (test)  loss: 4.3719 -> 3.8959   acc: 4.30% -> 14.57%              
client [57] (test)  loss: 4.2030 -> 4.1707   acc: 4.90% -> 6.21%               
client [17] (test)  loss: 4.3315 -> 3.9894   acc: 4.19% -> 6.77%               
client [54] (test)  loss: 4.3217 -> 3.8572   acc: 6.07% -> 15.00%              
client [23] (test)  loss: 328.1899 -> 3.8804   acc: 0.33% -> 6.33%             
client [35] (test)  loss: 4.1562 -> 4.0645   acc: 4.59% -> 8.85%               
client [59] (test)  loss: 4.2215 -> 3.8818   acc: 5.17% -> 9.12%               
client [31] (test)  loss: 4.1093 -> 3.8567   acc: 6.62% -> 9.76%               
client [9] (test)  loss: 4.2268 -> 3.9660   acc: 6.62% -> 6.95%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6426 -> 4.3136   acc: 1.98% -> 8.91%               
client [33] (test)  loss: 4.0676 -> 3.7882   acc: 7.17% -> 14.01%              
client [16] (test)  loss: 4.1767 -> 3.9721   acc: 6.62% -> 9.06%               
client [44] (test)  loss: 4.7955 -> 3.8745   acc: 0.98% -> 14.43%              
client [8] (test)  loss: 4.3685 -> 4.1579   acc: 2.70% -> 6.08%                
client [31] (test)  loss: 4.1733 -> 3.8630   acc: 5.57% -> 9.41%               
client [47] (test)  loss: 4.3831 -> 5.0351   acc: 3.28% -> 6.56%               
client [36] (test)  loss: 4.1943 -> 3.8265   acc: 7.64% -> 12.96%              
client [20] (test)  loss: 4.0564 -> 3.6724   acc: 7.64% -> 14.58%              
client [56] (test)  loss: 4.1058 -> 4.4057   acc: 7.56% -> 3.09%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.1788 -> 5.4315   acc: 7.89% -> 6.25%                
client [60] (test)  loss: 5.6364 -> 3.8152   acc: 2.60% -> 11.36%              
client [28] (test)  loss: 4.8276 -> 3.6689   acc: 5.63% -> 15.23%              
client [25] (test)  loss: 5.2228 -> 3.9821   acc: 5.52% -> 11.03%              
client [58] (test)  loss: 4.3791 -> 3.7071   acc: 4.69% -> 15.62%              
client [44] (test)  loss: 4.3153 -> 3.8147   acc: 7.87% -> 14.43%              
client [39] (test)  loss: 3.7750 -> 3.6325   acc: 14.00% -> 14.33%             
client [29] (test)  loss: 4.5472 -> 3.7742   acc: 11.26% -> 14.24%             
client [3] (test)  loss: 4.1538 -> 4.0458   acc: 8.50% -> 10.46%               
client [84] (test)  loss: 4.2685 -> 4.0463   acc: 8.17% -> 8.50%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.6463 -> 3.7942   acc: 5.98% -> 10.30%              
client [84] (test)  loss: 3.9269 -> 4.0841   acc: 12.75% -> 7.84%              
client [10] (test)  loss: 4.9917 -> 4.2725   acc: 3.96% -> 7.26%               
client [36] (test)  loss: 3.7592 -> 3.8643   acc: 11.63% -> 15.28%             
client [65] (test)  loss: 4.3044 -> 4.0011   acc: 7.59% -> 8.25%               
client [81] (test)  loss: 3.9040 -> 3.7125   acc: 9.63% -> 11.30%              
client [79] (test)  loss: 4.3095 -> 3.9345   acc: 6.56% -> 10.82%              
client [42] (test)  loss: 4.2341 -> 3.6613   acc: 4.30% -> 16.56%              
client [11] (test)  loss: 4.6402 -> 3.7006   acc: 1.68% -> 11.07%              
client [96] (test)  loss: 5.3906 -> 3.6773   acc: 2.55% -> 9.09%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.1823 -> 4.2916   acc: 8.78% -> 9.80%                
client [53] (test)  loss: 3.9604 -> 3.6830   acc: 9.12% -> 14.01%              
client [52] (test)  loss: 4.2984 -> 3.6517   acc: 9.42% -> 19.16%              
client [42] (test)  loss: 4.1153 -> 3.7868   acc: 5.96% -> 14.24%              
client [69] (test)  loss: 4.0988 -> 3.5939   acc: 9.90% -> 15.18%              
client [59] (test)  loss: 4.1125 -> 3.8063   acc: 8.51% -> 11.25%              
client [7] (test)  loss: 5.6278 -> 3.6678   acc: 5.23% -> 12.09%               
client [26] (test)  loss: 3.9281 -> 3.5390   acc: 11.92% -> 16.23%             
client [49] (test)  loss: 3.7344 -> 3.6622   acc: 11.48% -> 15.08%             
client [98] (test)  loss: 3.8493 -> 3.8604   acc: 11.65% -> 13.27%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.9839 -> 3.7915   acc: 11.97% -> 14.24%             
client [47] (test)  loss: 4.5900 -> 4.4646   acc: 7.87% -> 7.87%               
client [21] (test)  loss: 3.9777 -> 3.5559   acc: 12.29% -> 16.28%             
client [77] (test)  loss: 3.9844 -> 3.9984   acc: 8.55% -> 10.86%              
client [95] (test)  loss: 3.7717 -> 3.6758   acc: 12.50% -> 15.20%             
client [91] (test)  loss: 3.7269 -> 3.3133   acc: 16.78% -> 24.34%             
client [14] (test)  loss: 3.7667 -> 4.2201   acc: 18.02% -> 11.31%             
client [99] (test)  loss: 3.8217 -> 3.4723   acc: 11.99% -> 16.72%             
client [20] (test)  loss: 3.7512 -> 3.4046   acc: 14.24% -> 19.79%             
client [39] (test)  loss: 3.9129 -> 3.6540   acc: 13.00% -> 17.33%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.6213 -> 3.4989   acc: 8.44% -> 22.73%              
client [62] (test)  loss: 4.0564 -> 3.7104   acc: 9.42% -> 15.22%              
client [71] (test)  loss: 3.5054 -> 3.3856   acc: 14.52% -> 18.81%             
client [97] (test)  loss: 3.9230 -> 4.1859   acc: 12.58% -> 5.63%              
client [30] (test)  loss: 3.6587 -> 3.4786   acc: 15.84% -> 19.80%             
client [88] (test)  loss: 4.0533 -> 4.3304   acc: 9.30% -> 8.64%               
client [60] (test)  loss: 4.0414 -> 3.6079   acc: 11.69% -> 13.96%             
client [82] (test)  loss: 3.4512 -> 3.4301   acc: 17.88% -> 18.87%             
client [91] (test)  loss: 3.5722 -> 3.4093   acc: 15.13% -> 22.37%             
client [57] (test)  loss: 3.5287 -> 3.6999   acc: 15.36% -> 16.01%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.9614 -> 3.2376   acc: 13.59% -> 23.00%             
client [15] (test)  loss: 3.7086 -> 3.8045   acc: 13.49% -> 13.49%             
client [71] (test)  loss: 3.5446 -> 3.3856   acc: 15.51% -> 20.46%             
client [97] (test)  loss: 3.9317 -> 4.3213   acc: 10.93% -> 6.62%              
client [53] (test)  loss: 3.9238 -> 3.7104   acc: 11.40% -> 17.26%             
client [77] (test)  loss: 4.1153 -> 3.8369   acc: 9.87% -> 14.47%              
client [76] (test)  loss: 4.3005 -> 3.5782   acc: 8.24% -> 16.49%              
client [79] (test)  loss: 3.9327 -> 3.4228   acc: 9.84% -> 19.34%              
client [28] (test)  loss: 4.0216 -> 3.3976   acc: 12.91% -> 17.55%             
client [99] (test)  loss: 3.5664 -> 3.3400   acc: 16.72% -> 19.87%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.8057 -> 4.1461   acc: 10.93% -> 8.61%              
client [86] (test)  loss: 4.5497 -> 4.5001   acc: 9.03% -> 12.71%              
client [34] (test)  loss: 3.6454 -> 3.8917   acc: 10.51% -> 14.41%             
client [73] (test)  loss: 3.5284 -> 3.6302   acc: 16.39% -> 18.03%             
client [5] (test)  loss: 3.6941 -> 3.4556   acc: 16.45% -> 18.09%              
client [96] (test)  loss: 3.9750 -> 3.8243   acc: 18.91% -> 12.73%             
client [22] (test)  loss: 3.9891 -> 4.9917   acc: 9.77% -> 7.49%               
client [60] (test)  loss: 4.0797 -> 3.6087   acc: 11.04% -> 18.18%             
client [66] (test)  loss: 4.2041 -> 3.7217   acc: 10.97% -> 15.81%             
client [83] (test)  loss: 4.0770 -> 3.3674   acc: 10.23% -> 22.11%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.0574 -> 3.5547   acc: 10.75% -> 14.70%             
client [65] (test)  loss: 3.6504 -> 3.7795   acc: 15.84% -> 12.21%             
client [95] (test)  loss: 3.5526 -> 3.6172   acc: 17.23% -> 16.22%             
client [17] (test)  loss: 4.4246 -> 3.6044   acc: 11.61% -> 17.10%             
client [8] (test)  loss: 4.4810 -> 3.7011   acc: 8.11% -> 13.85%               
client [35] (test)  loss: 3.7163 -> 3.6222   acc: 15.41% -> 17.05%             
client [98] (test)  loss: 3.5141 -> 3.3706   acc: 16.83% -> 23.95%             
client [53] (test)  loss: 3.6016 -> 3.7813   acc: 14.98% -> 17.59%             
client [43] (test)  loss: 3.3302 -> 3.2578   acc: 21.45% -> 23.10%             
client [64] (test)  loss: 3.3949 -> 3.2485   acc: 18.48% -> 20.79%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.4059 -> 3.3823   acc: 21.59% -> 20.93%             
client [88] (test)  loss: 4.1790 -> 3.7157   acc: 9.63% -> 19.60%              
client [38] (test)  loss: 4.5358 -> 3.5535   acc: 7.89% -> 17.76%              
client [3] (test)  loss: 3.6571 -> 3.0705   acc: 17.97% -> 22.55%              
client [5] (test)  loss: 4.0365 -> 3.4063   acc: 12.50% -> 22.37%              
client [41] (test)  loss: 3.9891 -> 3.3708   acc: 11.07% -> 20.85%             
client [7] (test)  loss: 3.6321 -> 3.3950   acc: 16.01% -> 20.26%              
client [37] (test)  loss: 4.0516 -> 3.5406   acc: 15.56% -> 21.52%             
client [45] (test)  loss: 4.5852 -> 3.4649   acc: 11.26% -> 17.55%             
client [47] (test)  loss: 3.9600 -> 4.4349   acc: 16.72% -> 12.46%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.8163 -> 4.0189   acc: 13.59% -> 13.94%             
client [11] (test)  loss: 3.9002 -> 3.6590   acc: 13.76% -> 15.10%             
client [37] (test)  loss: 4.1660 -> 3.5035   acc: 10.93% -> 23.84%             
client [41] (test)  loss: 3.8788 -> 3.3768   acc: 13.68% -> 22.15%             
client [95] (test)  loss: 3.7086 -> 3.6984   acc: 14.53% -> 15.20%             
client [53] (test)  loss: 4.2080 -> 3.9022   acc: 10.42% -> 19.87%             
client [22] (test)  loss: 3.6289 -> 4.5438   acc: 14.66% -> 10.75%             
client [25] (test)  loss: 4.0930 -> 3.3967   acc: 13.10% -> 18.97%             
client [69] (test)  loss: 4.1920 -> 3.1396   acc: 11.55% -> 26.07%             
client [46] (test)  loss: 3.6172 -> 3.2980   acc: 18.83% -> 26.62%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.6178 -> 3.7285   acc: 17.38% -> 19.67%             
client [69] (test)  loss: 4.0296 -> 3.1612   acc: 13.20% -> 26.40%             
client [82] (test)  loss: 3.4363 -> 3.3744   acc: 16.56% -> 19.87%             
client [45] (test)  loss: 3.7425 -> 3.5674   acc: 15.89% -> 18.87%             
client [7] (test)  loss: 3.8778 -> 3.3253   acc: 12.75% -> 20.26%              
client [50] (test)  loss: 3.2118 -> 3.3419   acc: 21.35% -> 21.35%             
client [35] (test)  loss: 3.5018 -> 3.6563   acc: 19.67% -> 18.69%             
client [24] (test)  loss: 3.9759 -> 3.3921   acc: 16.22% -> 22.97%             
client [15] (test)  loss: 3.8326 -> 3.4574   acc: 13.82% -> 19.08%             
client [58] (test)  loss: 3.9479 -> 3.3418   acc: 13.28% -> 23.44%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.9297 -> 3.8096   acc: 16.17% -> 16.17%             
client [76] (test)  loss: 3.8674 -> 3.5130   acc: 13.98% -> 18.64%             
client [67] (test)  loss: 4.2552 -> 3.7812   acc: 10.30% -> 13.29%             
client [37] (test)  loss: 4.2282 -> 3.5123   acc: 15.56% -> 24.17%             
client [58] (test)  loss: 4.1701 -> 3.4232   acc: 16.02% -> 24.61%             
client [64] (test)  loss: 3.3900 -> 3.2350   acc: 19.47% -> 19.14%             
client [77] (test)  loss: 3.5228 -> 3.2719   acc: 17.11% -> 25.99%             
client [55] (test)  loss: 3.6622 -> 3.4084   acc: 19.02% -> 21.64%             
client [12] (test)  loss: 3.5597 -> 3.2536   acc: 18.81% -> 20.13%             
client [89] (test)  loss: 3.9074 -> 3.5066   acc: 17.10% -> 20.00%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.6518 -> 3.4578   acc: 15.69% -> 19.28%             
client [51] (test)  loss: 3.5156 -> 3.3666   acc: 18.54% -> 26.49%             
client [8] (test)  loss: 4.7414 -> 3.5946   acc: 7.43% -> 17.23%               
client [18] (test)  loss: 3.2299 -> 2.9370   acc: 20.92% -> 27.78%             
client [94] (test)  loss: 3.8313 -> 3.4749   acc: 19.39% -> 24.49%             
client [81] (test)  loss: 3.6131 -> 3.1307   acc: 17.61% -> 25.25%             
client [3] (test)  loss: 4.1090 -> 3.0750   acc: 13.40% -> 24.84%              
client [11] (test)  loss: 3.6500 -> 3.1300   acc: 15.44% -> 25.84%             
client [95] (test)  loss: 3.8728 -> 3.7730   acc: 13.51% -> 18.92%             
client [67] (test)  loss: 4.1540 -> 3.6066   acc: 13.29% -> 16.94%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.6827 -> 3.3107   acc: 19.93% -> 23.59%             
client [79] (test)  loss: 3.5771 -> 3.3922   acc: 17.38% -> 20.98%             
client [58] (test)  loss: 3.7419 -> 3.2901   acc: 16.02% -> 24.22%             
client [88] (test)  loss: 4.1649 -> 3.7931   acc: 12.96% -> 19.27%             
client [46] (test)  loss: 3.2677 -> 3.3447   acc: 25.00% -> 26.62%             
client [11] (test)  loss: 3.6504 -> 3.2147   acc: 15.10% -> 21.81%             
client [55] (test)  loss: 3.7521 -> 3.5042   acc: 18.69% -> 21.64%             
client [13] (test)  loss: 3.6239 -> 3.3331   acc: 12.99% -> 22.73%             
client [31] (test)  loss: 3.4187 -> 3.3392   acc: 19.86% -> 20.21%             
client [75] (test)  loss: 3.6297 -> 3.1933   acc: 18.75% -> 28.29%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.7368 -> 3.3735   acc: 17.67% -> 23.67%             
client [7] (test)  loss: 3.8093 -> 3.2131   acc: 16.99% -> 25.49%              
client [57] (test)  loss: 3.2306 -> 3.6310   acc: 26.14% -> 21.24%             
client [13] (test)  loss: 3.9178 -> 3.2818   acc: 13.64% -> 23.70%             
client [43] (test)  loss: 3.6507 -> 3.4274   acc: 21.45% -> 27.39%             
client [91] (test)  loss: 3.6054 -> 2.8212   acc: 19.08% -> 31.58%             
client [10] (test)  loss: 4.3108 -> 3.6026   acc: 8.91% -> 17.82%              
client [64] (test)  loss: 3.3389 -> 3.2954   acc: 20.46% -> 17.82%             
client [82] (test)  loss: 3.5558 -> 3.4259   acc: 15.89% -> 20.20%             
client [22] (test)  loss: 3.6908 -> 4.1495   acc: 16.94% -> 17.26%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.9391 -> 3.0687   acc: 13.89% -> 26.39%             
client [23] (test)  loss: 3.3869 -> 3.3757   acc: 19.00% -> 20.67%             
client [88] (test)  loss: 4.0485 -> 3.6810   acc: 15.61% -> 20.60%             
client [98] (test)  loss: 4.0685 -> 3.3049   acc: 14.89% -> 27.83%             
client [79] (test)  loss: 3.2403 -> 3.2739   acc: 21.64% -> 23.61%             
client [21] (test)  loss: 3.8151 -> 3.1934   acc: 15.95% -> 23.92%             
client [92] (test)  loss: 3.3897 -> 3.2544   acc: 23.75% -> 27.19%             
client [56] (test)  loss: 4.1134 -> 3.3851   acc: 14.09% -> 21.65%             
client [5] (test)  loss: 3.7155 -> 3.6054   acc: 18.75% -> 22.70%              
client [52] (test)  loss: 5.2514 -> 3.2688   acc: 8.44% -> 26.62%              
==================== FedBN_1 TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '3.8656 -> 0.0000', 'accuracy': '13.01% -> 0.00%'},          
    200: {'loss': '3.7766 -> 0.0000', 'accuracy': '17.53% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_1 achieved 10.0%(10.51%) at epoch: 74                                    
Convergence (test_after):                                                      
FedBN_1 achieved 10.0%(10.16%) at epoch: 31                                    
FedBN_1 achieved 20.0%(20.98%) at epoch: 118                                   
