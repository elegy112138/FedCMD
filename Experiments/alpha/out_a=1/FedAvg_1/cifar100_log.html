==================== ALGORITHM: FedAvg_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5416 -> 4.3766   acc: 0.33% -> 6.25%               
client [81] (test)  loss: 4.5264 -> 4.3674   acc: 3.99% -> 7.31%               
client [21] (test)  loss: 53.3324 -> 4.4790   acc: 1.33% -> 2.33%              
client [68] (test)  loss: 4.5627 -> 4.3855   acc: 1.32% -> 5.96%               
client [93] (test)  loss: 4.5501 -> 4.4047   acc: 1.62% -> 6.82%               
client [31] (test)  loss: 4.6566 -> 4.4645   acc: 1.05% -> 5.23%               
client [20] (test)  loss: 4.6500 -> 4.4732   acc: 0.35% -> 3.82%               
client [59] (test)  loss: 49.4456 -> 4.3024   acc: 0.91% -> 6.99%              
client [48] (test)  loss: 4.5102 -> 4.4264   acc: 3.96% -> 3.30%               
client [34] (test)  loss: 4.5550 -> 4.3549   acc: 0.90% -> 10.51%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.5216 -> 3.9119   acc: 1.65% -> 10.89%              
client [99] (test)  loss: 4.4195 -> 4.6416   acc: 5.36% -> 3.79%               
client [67] (test)  loss: 4.3724 -> 3.9692   acc: 3.99% -> 10.30%              
client [0] (test)  loss: 4.4542 -> 4.1154   acc: 2.99% -> 8.31%                
client [76] (test)  loss: 4.4596 -> 4.1248   acc: 2.87% -> 7.53%               
client [41] (test)  loss: 4.5126 -> 3.9804   acc: 1.63% -> 7.82%               
client [62] (test)  loss: 138.5057 -> 4.0585   acc: 1.45% -> 10.51%            
client [2] (test)  loss: 133.9180 -> 3.9389   acc: 0.97% -> 6.47%              
client [14] (test)  loss: 4.3964 -> 4.1664   acc: 3.53% -> 7.42%               
client [46] (test)  loss: 4.4784 -> 4.4516   acc: 2.60% -> 6.49%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1136 -> 4.2523   acc: 11.15% -> 4.73%              
client [68] (test)  loss: 4.3734 -> 3.8776   acc: 4.97% -> 12.91%              
client [57] (test)  loss: 4.1895 -> 4.1302   acc: 5.88% -> 6.21%               
client [17] (test)  loss: 4.3267 -> 3.9695   acc: 5.16% -> 8.39%               
client [54] (test)  loss: 4.3580 -> 3.8713   acc: 7.14% -> 15.36%              
client [23] (test)  loss: 365.4154 -> 3.8705   acc: 0.33% -> 6.67%             
client [35] (test)  loss: 4.1290 -> 4.0478   acc: 5.25% -> 7.87%               
client [59] (test)  loss: 4.2103 -> 3.8751   acc: 5.17% -> 9.42%               
client [31] (test)  loss: 4.0877 -> 3.8365   acc: 8.36% -> 9.76%               
client [9] (test)  loss: 4.2320 -> 4.0573   acc: 7.62% -> 7.28%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.4627 -> 4.1783   acc: 3.63% -> 9.57%               
client [33] (test)  loss: 4.0488 -> 3.8425   acc: 8.14% -> 13.68%              
client [16] (test)  loss: 4.1410 -> 3.9651   acc: 7.32% -> 9.06%               
client [44] (test)  loss: 4.8840 -> 3.8856   acc: 1.64% -> 14.43%              
client [8] (test)  loss: 4.4594 -> 4.1528   acc: 3.04% -> 6.08%                
client [31] (test)  loss: 4.2344 -> 3.7733   acc: 5.92% -> 10.80%              
client [47] (test)  loss: 4.4815 -> 5.1826   acc: 3.61% -> 6.56%               
client [36] (test)  loss: 4.1654 -> 3.9556   acc: 8.97% -> 14.29%              
client [20] (test)  loss: 4.0451 -> 3.6413   acc: 7.64% -> 15.28%              
client [56] (test)  loss: 4.1220 -> 4.4732   acc: 7.56% -> 2.41%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0938 -> 5.4489   acc: 7.89% -> 5.92%                
client [60] (test)  loss: 5.7580 -> 3.7547   acc: 2.27% -> 12.66%              
client [28] (test)  loss: 5.0554 -> 3.6381   acc: 5.30% -> 15.23%              
client [25] (test)  loss: 5.3913 -> 4.0653   acc: 5.17% -> 12.07%              
client [58] (test)  loss: 4.2398 -> 3.5786   acc: 5.47% -> 17.19%              
client [44] (test)  loss: 4.3820 -> 3.8071   acc: 7.54% -> 14.75%              
client [39] (test)  loss: 3.6883 -> 3.6268   acc: 15.00% -> 15.33%             
client [29] (test)  loss: 4.6184 -> 3.7206   acc: 10.93% -> 15.23%             
client [3] (test)  loss: 4.1175 -> 4.0328   acc: 7.84% -> 11.76%               
client [84] (test)  loss: 4.0982 -> 3.6698   acc: 8.82% -> 11.76%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.7781 -> 3.7543   acc: 5.98% -> 11.63%              
client [84] (test)  loss: 3.9791 -> 4.2026   acc: 12.09% -> 9.48%              
client [10] (test)  loss: 4.8796 -> 4.2813   acc: 5.61% -> 8.58%               
client [36] (test)  loss: 3.7486 -> 3.9972   acc: 12.62% -> 15.28%             
client [65] (test)  loss: 4.3380 -> 3.9054   acc: 7.26% -> 8.91%               
client [81] (test)  loss: 3.9168 -> 3.6255   acc: 10.30% -> 13.95%             
client [79] (test)  loss: 4.3796 -> 3.9937   acc: 5.57% -> 10.16%              
client [42] (test)  loss: 4.2532 -> 3.6152   acc: 4.97% -> 18.21%              
client [11] (test)  loss: 4.4901 -> 3.7106   acc: 3.36% -> 11.74%              
client [96] (test)  loss: 5.3562 -> 3.6797   acc: 4.00% -> 10.55%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.4492 -> 4.0345   acc: 8.11% -> 10.14%               
client [53] (test)  loss: 3.8864 -> 3.7273   acc: 11.40% -> 13.36%             
client [52] (test)  loss: 4.3964 -> 3.6560   acc: 7.79% -> 20.78%              
client [42] (test)  loss: 4.0485 -> 3.6022   acc: 8.28% -> 17.88%              
client [69] (test)  loss: 3.9846 -> 3.4445   acc: 11.22% -> 18.15%             
client [59] (test)  loss: 4.1476 -> 3.9418   acc: 10.94% -> 10.94%             
client [7] (test)  loss: 5.2149 -> 3.5276   acc: 6.54% -> 16.34%               
client [26] (test)  loss: 3.8626 -> 3.5606   acc: 10.60% -> 19.54%             
client [49] (test)  loss: 3.6738 -> 3.7226   acc: 13.77% -> 14.75%             
client [98] (test)  loss: 3.7882 -> 3.6193   acc: 12.62% -> 15.86%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.2401 -> 3.5569   acc: 10.68% -> 16.83%             
client [47] (test)  loss: 4.4521 -> 4.8398   acc: 9.51% -> 7.87%               
client [21] (test)  loss: 4.1083 -> 3.5058   acc: 11.96% -> 19.27%             
client [77] (test)  loss: 3.8476 -> 4.0079   acc: 11.84% -> 9.87%              
client [95] (test)  loss: 3.7936 -> 3.7872   acc: 11.82% -> 14.53%             
client [91] (test)  loss: 3.7511 -> 3.5237   acc: 16.78% -> 19.74%             
client [14] (test)  loss: 3.7514 -> 3.9862   acc: 19.79% -> 12.72%             
client [99] (test)  loss: 4.0029 -> 3.4070   acc: 9.78% -> 18.61%              
client [20] (test)  loss: 3.8962 -> 3.3904   acc: 13.19% -> 19.79%             
client [39] (test)  loss: 3.7844 -> 4.1314   acc: 14.67% -> 9.67%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.3674 -> 3.5086   acc: 11.04% -> 20.45%             
client [62] (test)  loss: 4.1370 -> 4.4721   acc: 9.42% -> 10.51%              
client [71] (test)  loss: 3.3291 -> 3.1915   acc: 18.15% -> 19.80%             
client [97] (test)  loss: 3.9154 -> 4.1415   acc: 16.56% -> 9.27%              
client [30] (test)  loss: 3.4425 -> 3.3711   acc: 19.47% -> 20.46%             
client [88] (test)  loss: 4.6201 -> 3.9045   acc: 4.32% -> 17.28%              
client [60] (test)  loss: 3.8331 -> 3.4353   acc: 15.58% -> 18.83%             
client [82] (test)  loss: 3.3565 -> 3.4656   acc: 19.87% -> 17.88%             
client [91] (test)  loss: 3.6962 -> 3.4370   acc: 15.13% -> 20.39%             
client [57] (test)  loss: 3.4095 -> 3.8809   acc: 19.28% -> 16.34%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.7121 -> 3.2865   acc: 14.98% -> 21.95%             
client [15] (test)  loss: 3.8292 -> 3.4506   acc: 17.11% -> 18.09%             
client [71] (test)  loss: 3.3748 -> 3.2486   acc: 19.47% -> 24.09%             
client [97] (test)  loss: 3.9583 -> 4.2018   acc: 10.60% -> 10.60%             
client [53] (test)  loss: 3.9139 -> 3.5994   acc: 12.38% -> 17.92%             
client [77] (test)  loss: 3.7058 -> 3.7417   acc: 16.12% -> 12.83%             
client [76] (test)  loss: 4.4396 -> 3.5178   acc: 6.45% -> 15.77%              
client [79] (test)  loss: 3.8633 -> 3.3953   acc: 12.13% -> 17.70%             
client [28] (test)  loss: 3.9435 -> 3.2463   acc: 11.92% -> 20.53%             
client [99] (test)  loss: 3.5559 -> 3.3280   acc: 17.98% -> 20.50%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.7235 -> 4.1015   acc: 12.91% -> 12.25%             
client [86] (test)  loss: 4.1574 -> 3.8356   acc: 12.37% -> 17.06%             
client [34] (test)  loss: 3.5292 -> 3.2877   acc: 15.92% -> 23.12%             
client [73] (test)  loss: 3.4791 -> 3.6356   acc: 19.02% -> 17.38%             
client [5] (test)  loss: 3.5692 -> 3.3293   acc: 18.42% -> 21.38%              
client [96] (test)  loss: 3.6252 -> 3.4398   acc: 20.73% -> 19.27%             
client [22] (test)  loss: 4.0270 -> 5.0798   acc: 11.40% -> 8.14%              
client [60] (test)  loss: 3.9298 -> 3.4420   acc: 12.01% -> 18.18%             
client [66] (test)  loss: 4.5029 -> 3.6503   acc: 11.29% -> 18.06%             
client [83] (test)  loss: 4.2244 -> 3.4423   acc: 12.21% -> 22.77%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.2624 -> 3.5306   acc: 10.04% -> 17.92%             
client [65] (test)  loss: 3.7335 -> 3.7442   acc: 14.85% -> 14.19%             
client [95] (test)  loss: 3.7307 -> 3.7589   acc: 16.89% -> 16.55%             
client [17] (test)  loss: 4.5209 -> 3.7732   acc: 14.52% -> 18.39%             
client [8] (test)  loss: 5.0855 -> 3.7333   acc: 8.45% -> 12.50%               
client [35] (test)  loss: 3.7842 -> 3.5134   acc: 18.69% -> 19.02%             
client [98] (test)  loss: 3.3604 -> 3.2963   acc: 21.36% -> 25.89%             
client [53] (test)  loss: 3.5623 -> 3.5628   acc: 18.89% -> 20.52%             
client [43] (test)  loss: 3.4774 -> 3.4083   acc: 21.78% -> 22.77%             
client [64] (test)  loss: 3.4496 -> 3.4019   acc: 17.82% -> 17.16%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.6495 -> 3.4040   acc: 19.60% -> 20.93%             
client [88] (test)  loss: 4.3556 -> 3.6885   acc: 9.63% -> 21.59%              
client [38] (test)  loss: 4.5880 -> 3.5267   acc: 8.88% -> 18.42%              
client [3] (test)  loss: 3.6008 -> 3.1357   acc: 18.95% -> 23.20%              
client [5] (test)  loss: 3.8828 -> 3.4412   acc: 16.45% -> 20.72%              
client [41] (test)  loss: 4.0122 -> 3.3371   acc: 12.38% -> 22.48%             
client [7] (test)  loss: 3.8356 -> 3.3780   acc: 17.32% -> 21.57%              
client [37] (test)  loss: 4.0673 -> 3.5081   acc: 16.23% -> 22.52%             
client [45] (test)  loss: 4.5616 -> 3.7135   acc: 12.91% -> 16.56%             
client [47] (test)  loss: 3.9050 -> 3.8377   acc: 19.02% -> 17.05%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.8599 -> 4.0598   acc: 15.33% -> 13.94%             
client [11] (test)  loss: 3.9418 -> 3.4090   acc: 13.76% -> 19.13%             
client [37] (test)  loss: 4.0332 -> 3.5247   acc: 11.59% -> 25.50%             
client [41] (test)  loss: 3.9638 -> 3.3885   acc: 12.38% -> 22.15%             
client [95] (test)  loss: 3.6029 -> 3.7541   acc: 17.57% -> 16.89%             
client [53] (test)  loss: 3.9524 -> 3.4748   acc: 12.38% -> 24.43%             
client [22] (test)  loss: 3.7767 -> 4.6782   acc: 14.66% -> 11.73%             
client [25] (test)  loss: 3.7307 -> 3.3838   acc: 17.93% -> 22.41%             
client [69] (test)  loss: 3.8611 -> 3.2173   acc: 15.51% -> 26.73%             
client [46] (test)  loss: 3.6367 -> 3.7178   acc: 19.81% -> 21.75%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.4836 -> 4.0651   acc: 19.67% -> 18.69%             
client [69] (test)  loss: 3.8211 -> 3.3733   acc: 16.50% -> 23.10%             
client [82] (test)  loss: 3.4721 -> 3.3634   acc: 19.21% -> 21.19%             
client [45] (test)  loss: 3.7626 -> 3.5893   acc: 15.89% -> 18.87%             
client [7] (test)  loss: 4.1035 -> 3.3244   acc: 13.73% -> 21.90%              
client [50] (test)  loss: 3.3239 -> 3.4683   acc: 23.22% -> 23.22%             
client [35] (test)  loss: 3.4878 -> 3.8733   acc: 19.34% -> 17.38%             
client [24] (test)  loss: 4.6608 -> 3.5050   acc: 10.81% -> 24.32%             
client [15] (test)  loss: 4.0232 -> 3.4491   acc: 16.78% -> 20.72%             
client [58] (test)  loss: 3.7026 -> 3.3033   acc: 19.14% -> 22.27%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.4264 -> 4.3117   acc: 14.85% -> 16.17%             
client [76] (test)  loss: 3.9665 -> 3.5357   acc: 13.62% -> 19.71%             
client [67] (test)  loss: 4.3229 -> 3.9232   acc: 13.29% -> 16.94%             
client [37] (test)  loss: 4.2491 -> 3.5126   acc: 14.90% -> 25.50%             
client [58] (test)  loss: 3.4633 -> 3.3185   acc: 23.05% -> 21.88%             
client [64] (test)  loss: 3.4891 -> 3.2249   acc: 17.16% -> 20.79%             
client [77] (test)  loss: 3.7650 -> 3.3444   acc: 17.11% -> 24.01%             
client [55] (test)  loss: 3.6162 -> 3.8553   acc: 18.69% -> 18.03%             
client [12] (test)  loss: 3.4724 -> 3.4390   acc: 20.13% -> 21.12%             
client [89] (test)  loss: 3.6200 -> 3.5496   acc: 15.16% -> 19.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.8430 -> 3.9735   acc: 17.65% -> 16.34%             
client [51] (test)  loss: 3.5202 -> 3.4703   acc: 20.20% -> 24.17%             
client [8] (test)  loss: 4.7485 -> 3.8579   acc: 10.14% -> 14.53%              
client [18] (test)  loss: 3.4527 -> 3.2838   acc: 19.93% -> 23.53%             
client [94] (test)  loss: 4.5440 -> 3.4353   acc: 14.97% -> 25.51%             
client [81] (test)  loss: 3.7486 -> 3.1842   acc: 14.95% -> 23.92%             
client [3] (test)  loss: 4.0843 -> 3.3678   acc: 14.38% -> 21.57%              
client [11] (test)  loss: 3.5024 -> 3.2596   acc: 17.79% -> 26.51%             
client [95] (test)  loss: 3.5817 -> 3.7577   acc: 15.20% -> 18.24%             
client [67] (test)  loss: 4.0198 -> 4.1180   acc: 19.27% -> 15.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.0380 -> 3.5107   acc: 19.60% -> 22.59%             
client [79] (test)  loss: 3.7372 -> 3.3591   acc: 17.38% -> 21.31%             
client [58] (test)  loss: 3.5566 -> 3.3255   acc: 20.70% -> 25.78%             
client [88] (test)  loss: 4.5189 -> 3.5731   acc: 12.62% -> 24.25%             
client [46] (test)  loss: 4.0827 -> 3.9505   acc: 17.86% -> 20.13%             
client [11] (test)  loss: 3.6549 -> 3.4104   acc: 15.44% -> 24.16%             
client [55] (test)  loss: 3.2947 -> 3.5574   acc: 23.61% -> 24.59%             
client [13] (test)  loss: 3.5787 -> 3.4272   acc: 19.48% -> 24.03%             
client [31] (test)  loss: 3.6436 -> 3.3550   acc: 18.47% -> 20.56%             
client [75] (test)  loss: 3.5979 -> 3.3147   acc: 18.42% -> 26.64%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.5645 -> 3.4356   acc: 15.00% -> 24.67%             
client [7] (test)  loss: 3.8664 -> 3.5121   acc: 19.93% -> 19.28%              
client [57] (test)  loss: 3.2261 -> 3.8728   acc: 29.74% -> 23.20%             
client [13] (test)  loss: 3.7278 -> 3.5728   acc: 18.18% -> 23.05%             
client [43] (test)  loss: 3.9525 -> 3.4644   acc: 18.81% -> 25.74%             
client [91] (test)  loss: 3.9993 -> 2.9241   acc: 18.09% -> 30.26%             
client [10] (test)  loss: 4.4241 -> 3.6389   acc: 12.87% -> 18.81%             
client [64] (test)  loss: 3.7535 -> 3.3131   acc: 16.83% -> 20.79%             
client [82] (test)  loss: 3.3953 -> 3.2471   acc: 21.52% -> 23.84%             
client [22] (test)  loss: 3.8904 -> 4.7842   acc: 15.64% -> 14.33%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.9912 -> 3.3851   acc: 15.28% -> 24.65%             
client [23] (test)  loss: 3.9053 -> 3.9624   acc: 13.67% -> 20.67%             
client [88] (test)  loss: 5.0346 -> 3.5840   acc: 10.30% -> 26.58%             
client [98] (test)  loss: 3.3645 -> 3.9555   acc: 23.62% -> 22.01%             
client [79] (test)  loss: 3.3363 -> 3.2588   acc: 20.00% -> 24.59%             
client [21] (test)  loss: 4.1276 -> 3.3589   acc: 17.94% -> 26.25%             
client [92] (test)  loss: 3.5213 -> 3.4103   acc: 22.19% -> 25.62%             
client [56] (test)  loss: 4.1967 -> 3.6693   acc: 14.43% -> 22.34%             
client [5] (test)  loss: 3.8349 -> 3.7525   acc: 16.45% -> 22.37%              
client [52] (test)  loss: 4.6449 -> 3.3662   acc: 13.64% -> 25.00%             
==================== FedAvg_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '3.8881 -> 0.0000', 'accuracy': '14.05% -> 0.00%'},          
    200: {'loss': '3.9599 -> 0.0000', 'accuracy': '17.66% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_1 achieved 10.0%(10.14%) at epoch: 69                                   
FedAvg_1 achieved 20.0%(21.19%) at epoch: 186                                  
Convergence (test_after):                                                      
FedAvg_1 achieved 10.0%(10.02%) at epoch: 27                                   
FedAvg_1 achieved 20.0%(20.29%) at epoch: 105                                  
