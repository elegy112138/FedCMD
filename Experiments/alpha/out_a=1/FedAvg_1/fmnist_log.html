==================== ALGORITHM: FedAvg_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8582 -> 0.5774   acc: 68.93% -> 79.29%             
client [81] (test)  loss: 1.0280 -> 0.7011   acc: 57.42% -> 71.15%             
client [21] (test)  loss: 19.3982 -> 0.5490   acc: 38.33% -> 85.28%            
client [68] (test)  loss: 0.8880 -> 0.6810   acc: 70.25% -> 77.22%             
client [93] (test)  loss: 1.0785 -> 0.5596   acc: 56.19% -> 81.59%             
client [31] (test)  loss: 1.1548 -> 0.6426   acc: 50.10% -> 75.94%             
client [20] (test)  loss: 0.8363 -> 0.6819   acc: 69.11% -> 75.80%             
client [59] (test)  loss: 20.8691 -> 0.3561   acc: 35.14% -> 89.14%            
client [48] (test)  loss: 0.5567 -> 0.2938   acc: 84.78% -> 87.93%             
client [34] (test)  loss: 0.6249 -> 0.4206   acc: 76.90% -> 85.60%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6892 -> 0.2955   acc: 75.58% -> 89.09%             
client [99] (test)  loss: 0.5149 -> 0.3218   acc: 81.64% -> 88.98%             
client [67] (test)  loss: 0.5832 -> 0.3351   acc: 83.38% -> 90.18%             
client [0] (test)  loss: 0.5515 -> 0.4789   acc: 81.91% -> 82.71%              
client [76] (test)  loss: 0.5733 -> 0.2684   acc: 80.51% -> 91.01%             
client [41] (test)  loss: 0.7498 -> 0.5749   acc: 69.74% -> 79.70%             
client [62] (test)  loss: 20.3003 -> 0.5012   acc: 50.15% -> 83.79%            
client [2] (test)  loss: 26.1106 -> 0.4886   acc: 40.79% -> 81.59%             
client [14] (test)  loss: 0.6858 -> 0.3728   acc: 73.55% -> 87.66%             
client [46] (test)  loss: 0.6024 -> 0.3304   acc: 77.84% -> 86.59%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4675 -> 0.3821   acc: 82.62% -> 86.40%             
client [68] (test)  loss: 0.4970 -> 0.4451   acc: 81.65% -> 82.91%             
client [57] (test)  loss: 0.5186 -> 0.3152   acc: 83.03% -> 90.25%             
client [17] (test)  loss: 0.4905 -> 0.2461   acc: 83.51% -> 92.15%             
client [54] (test)  loss: 0.3834 -> 0.2379   acc: 88.07% -> 92.12%             
client [23] (test)  loss: 25.6630 -> 0.2597   acc: 42.68% -> 92.14%            
client [35] (test)  loss: 0.5273 -> 0.3275   acc: 78.92% -> 89.18%             
client [59] (test)  loss: 0.3894 -> 0.2322   acc: 87.71% -> 91.43%             
client [31] (test)  loss: 0.5893 -> 0.5119   acc: 75.94% -> 79.52%             
client [9] (test)  loss: 0.5099 -> 0.3781   acc: 81.11% -> 85.64%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7132 -> 0.4113   acc: 73.65% -> 86.12%             
client [33] (test)  loss: 0.4339 -> 0.3350   acc: 83.24% -> 86.76%             
client [16] (test)  loss: 0.3099 -> 0.1611   acc: 90.31% -> 93.98%             
client [44] (test)  loss: 1.0162 -> 0.2877   acc: 66.96% -> 90.75%             
client [8] (test)  loss: 0.3843 -> 0.3679   acc: 88.39% -> 84.84%              
client [31] (test)  loss: 0.6758 -> 0.4958   acc: 73.56% -> 80.72%             
client [47] (test)  loss: 0.6373 -> 0.4223   acc: 73.41% -> 85.39%             
client [36] (test)  loss: 0.4820 -> 0.3900   acc: 80.98% -> 86.20%             
client [20] (test)  loss: 0.5430 -> 0.5183   acc: 81.53% -> 81.85%             
client [56] (test)  loss: 0.4671 -> 0.4806   acc: 83.75% -> 84.06%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7859 -> 0.5487   acc: 73.71% -> 76.55%              
client [60] (test)  loss: 0.4074 -> 0.2029   acc: 86.63% -> 94.80%             
client [28] (test)  loss: 0.6647 -> 0.5898   acc: 80.18% -> 81.11%             
client [25] (test)  loss: 0.6449 -> 0.4151   acc: 77.31% -> 86.28%             
client [58] (test)  loss: 0.3368 -> 0.2061   acc: 89.27% -> 92.93%             
client [44] (test)  loss: 0.4112 -> 0.2573   acc: 83.48% -> 91.63%             
client [39] (test)  loss: 0.6402 -> 0.3628   acc: 76.84% -> 86.10%             
client [29] (test)  loss: 0.8175 -> 0.4898   acc: 69.76% -> 83.83%             
client [3] (test)  loss: 0.5377 -> 0.3551   acc: 80.44% -> 88.15%              
client [84] (test)  loss: 0.6348 -> 0.3308   acc: 77.39% -> 87.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4565 -> 0.3204   acc: 85.56% -> 88.61%             
client [84] (test)  loss: 0.5691 -> 0.3330   acc: 81.16% -> 88.99%             
client [10] (test)  loss: 0.5244 -> 0.3032   acc: 83.61% -> 91.11%             
client [36] (test)  loss: 0.4967 -> 0.3600   acc: 80.98% -> 85.89%             
client [65] (test)  loss: 0.2960 -> 0.2913   acc: 89.51% -> 89.73%             
client [81] (test)  loss: 0.4869 -> 0.5009   acc: 79.55% -> 80.67%             
client [79] (test)  loss: 0.7242 -> 0.5115   acc: 75.97% -> 79.56%             
client [42] (test)  loss: 0.8563 -> 0.3715   acc: 65.58% -> 88.37%             
client [11] (test)  loss: 0.4500 -> 0.4105   acc: 84.06% -> 86.96%             
client [96] (test)  loss: 0.4008 -> 0.2734   acc: 84.76% -> 90.30%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3809 -> 0.3598   acc: 87.10% -> 87.10%              
client [53] (test)  loss: 0.3976 -> 0.1712   acc: 85.75% -> 95.18%             
client [52] (test)  loss: 0.6396 -> 0.4239   acc: 77.01% -> 85.87%             
client [42] (test)  loss: 0.5712 -> 0.3638   acc: 79.07% -> 88.84%             
client [69] (test)  loss: 0.3642 -> 0.2632   acc: 85.97% -> 90.65%             
client [59] (test)  loss: 0.4170 -> 0.1995   acc: 86.00% -> 94.57%             
client [7] (test)  loss: 0.4218 -> 0.4209   acc: 86.67% -> 86.11%              
client [26] (test)  loss: 0.2396 -> 0.2517   acc: 91.58% -> 91.23%             
client [49] (test)  loss: 0.4520 -> 0.4667   acc: 82.82% -> 83.53%             
client [98] (test)  loss: 0.4765 -> 0.4264   acc: 83.61% -> 84.44%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5206 -> 0.4144   acc: 81.39% -> 85.83%             
client [47] (test)  loss: 0.6895 -> 0.4302   acc: 75.28% -> 86.89%             
client [21] (test)  loss: 0.3976 -> 0.3331   acc: 86.39% -> 89.44%             
client [77] (test)  loss: 0.4004 -> 0.3092   acc: 84.64% -> 87.50%             
client [95] (test)  loss: 0.4927 -> 0.2916   acc: 84.23% -> 89.01%             
client [91] (test)  loss: 0.5505 -> 0.3905   acc: 80.00% -> 85.79%             
client [14] (test)  loss: 0.4020 -> 0.2917   acc: 86.65% -> 89.17%             
client [99] (test)  loss: 0.3479 -> 0.2381   acc: 87.85% -> 92.94%             
client [20] (test)  loss: 0.5344 -> 0.4761   acc: 81.85% -> 83.44%             
client [39] (test)  loss: 0.7527 -> 0.3546   acc: 71.39% -> 87.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6578 -> 0.4580   acc: 77.29% -> 83.66%             
client [62] (test)  loss: 0.4260 -> 0.4058   acc: 88.69% -> 87.16%             
client [71] (test)  loss: 0.3426 -> 0.2373   acc: 89.55% -> 92.09%             
client [97] (test)  loss: 0.5450 -> 0.3702   acc: 79.85% -> 86.57%             
client [30] (test)  loss: 0.3810 -> 0.2698   acc: 84.12% -> 91.89%             
client [88] (test)  loss: 0.6264 -> 0.4512   acc: 78.24% -> 82.09%             
client [60] (test)  loss: 0.3219 -> 0.2291   acc: 92.08% -> 94.55%             
client [82] (test)  loss: 0.3758 -> 0.2858   acc: 88.06% -> 90.55%             
client [91] (test)  loss: 0.5502 -> 0.3919   acc: 80.00% -> 86.58%             
client [57] (test)  loss: 0.3664 -> 0.3366   acc: 89.53% -> 91.70%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7180 -> 0.5305   acc: 76.94% -> 80.32%             
client [15] (test)  loss: 0.3619 -> 0.3265   acc: 88.64% -> 88.92%             
client [71] (test)  loss: 0.4146 -> 0.2511   acc: 87.57% -> 92.09%             
client [97] (test)  loss: 0.5552 -> 0.3710   acc: 82.46% -> 86.57%             
client [53] (test)  loss: 0.4468 -> 0.1788   acc: 83.33% -> 95.39%             
client [77] (test)  loss: 0.3613 -> 0.3106   acc: 87.14% -> 86.79%             
client [76] (test)  loss: 0.4511 -> 0.2748   acc: 84.15% -> 91.43%             
client [79] (test)  loss: 0.7846 -> 0.4559   acc: 76.24% -> 83.15%             
client [28] (test)  loss: 0.6566 -> 0.6272   acc: 83.41% -> 81.11%             
client [99] (test)  loss: 0.3272 -> 0.2428   acc: 88.70% -> 92.66%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4578 -> 0.3835   acc: 82.84% -> 86.94%             
client [86] (test)  loss: 0.2057 -> 0.1462   acc: 92.56% -> 95.12%             
client [34] (test)  loss: 0.5281 -> 0.3983   acc: 82.07% -> 87.50%             
client [73] (test)  loss: 0.3845 -> 0.2794   acc: 86.57% -> 90.15%             
client [5] (test)  loss: 0.5677 -> 0.4057   acc: 80.84% -> 87.74%              
client [96] (test)  loss: 0.2808 -> 0.2458   acc: 89.20% -> 92.24%             
client [22] (test)  loss: 0.4475 -> 0.4275   acc: 84.52% -> 86.45%             
client [60] (test)  loss: 0.3434 -> 0.2441   acc: 87.13% -> 94.31%             
client [66] (test)  loss: 0.5004 -> 0.4792   acc: 84.07% -> 87.04%             
client [83] (test)  loss: 0.4773 -> 0.2119   acc: 85.82% -> 93.81%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3935 -> 0.2500   acc: 86.94% -> 92.51%             
client [65] (test)  loss: 0.2919 -> 0.3063   acc: 89.96% -> 89.73%             
client [95] (test)  loss: 0.4882 -> 0.2797   acc: 84.23% -> 90.70%             
client [17] (test)  loss: 0.4464 -> 0.2958   acc: 85.34% -> 92.41%             
client [8] (test)  loss: 0.2836 -> 0.3627   acc: 91.29% -> 87.42%              
client [35] (test)  loss: 0.6158 -> 0.3612   acc: 79.66% -> 89.18%             
client [98] (test)  loss: 0.5503 -> 0.4413   acc: 82.22% -> 85.00%             
client [53] (test)  loss: 0.3488 -> 0.1852   acc: 86.62% -> 94.52%             
client [43] (test)  loss: 0.3105 -> 0.1888   acc: 92.47% -> 96.77%             
client [64] (test)  loss: 0.7036 -> 0.4615   acc: 81.02% -> 85.55%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4165 -> 0.3524   acc: 88.61% -> 90.28%             
client [88] (test)  loss: 0.8377 -> 0.4688   acc: 74.38% -> 84.57%             
client [38] (test)  loss: 0.3651 -> 0.3224   acc: 89.62% -> 91.82%             
client [3] (test)  loss: 0.5875 -> 0.3158   acc: 81.82% -> 91.18%              
client [5] (test)  loss: 0.5522 -> 0.3721   acc: 82.76% -> 86.97%              
client [41] (test)  loss: 0.5512 -> 0.5006   acc: 77.86% -> 80.81%             
client [7] (test)  loss: 0.4689 -> 0.4377   acc: 84.44% -> 86.39%              
client [37] (test)  loss: 0.4299 -> 0.2292   acc: 86.59% -> 91.62%             
client [45] (test)  loss: 0.6365 -> 0.2715   acc: 78.53% -> 90.31%             
client [47] (test)  loss: 0.5562 -> 0.4357   acc: 81.27% -> 86.14%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4224 -> 0.1973   acc: 86.13% -> 94.24%             
client [11] (test)  loss: 0.4704 -> 0.3888   acc: 86.96% -> 86.96%             
client [37] (test)  loss: 0.3924 -> 0.2266   acc: 87.43% -> 92.74%             
client [41] (test)  loss: 0.7647 -> 0.4897   acc: 70.48% -> 81.55%             
client [95] (test)  loss: 0.5298 -> 0.2891   acc: 82.54% -> 90.42%             
client [53] (test)  loss: 0.4372 -> 0.1977   acc: 85.31% -> 94.30%             
client [22] (test)  loss: 0.4960 -> 0.4419   acc: 83.55% -> 87.74%             
client [25] (test)  loss: 1.1015 -> 0.5137   acc: 69.66% -> 84.70%             
client [69] (test)  loss: 0.3847 -> 0.2757   acc: 87.53% -> 91.43%             
client [46] (test)  loss: 0.4439 -> 0.3606   acc: 86.01% -> 90.09%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4346 -> 0.4349   acc: 85.02% -> 86.52%             
client [69] (test)  loss: 0.3663 -> 0.2691   acc: 88.31% -> 91.17%             
client [82] (test)  loss: 0.3488 -> 0.2684   acc: 89.55% -> 91.79%             
client [45] (test)  loss: 0.5882 -> 0.2797   acc: 79.06% -> 90.84%             
client [7] (test)  loss: 0.3945 -> 0.4662   acc: 86.11% -> 86.67%              
client [50] (test)  loss: 0.5318 -> 0.4936   acc: 83.19% -> 83.47%             
client [35] (test)  loss: 0.4061 -> 0.3583   acc: 86.19% -> 88.43%             
client [24] (test)  loss: 0.5509 -> 0.2778   acc: 79.60% -> 91.44%             
client [15] (test)  loss: 0.5371 -> 0.3083   acc: 83.93% -> 89.20%             
client [58] (test)  loss: 0.2584 -> 0.2382   acc: 92.15% -> 91.62%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3408 -> 0.2068   acc: 89.24% -> 92.39%             
client [76] (test)  loss: 0.5806 -> 0.2486   acc: 83.94% -> 92.29%             
client [67] (test)  loss: 0.3880 -> 0.2975   acc: 90.18% -> 92.19%             
client [37] (test)  loss: 0.3967 -> 0.2220   acc: 87.71% -> 92.46%             
client [58] (test)  loss: 0.2983 -> 0.2383   acc: 90.84% -> 91.62%             
client [64] (test)  loss: 0.6190 -> 0.5011   acc: 84.70% -> 86.12%             
client [77] (test)  loss: 0.4481 -> 0.3465   acc: 86.43% -> 88.21%             
client [55] (test)  loss: 0.5635 -> 0.4583   acc: 82.00% -> 87.28%             
client [12] (test)  loss: 0.6368 -> 0.4625   acc: 80.91% -> 80.91%             
client [89] (test)  loss: 0.6597 -> 0.3631   acc: 83.28% -> 89.71%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4931 -> 0.3097   acc: 84.64% -> 89.86%             
client [51] (test)  loss: 0.3927 -> 0.3072   acc: 86.19% -> 89.19%             
client [8] (test)  loss: 0.3762 -> 0.3490   acc: 87.10% -> 88.71%              
client [18] (test)  loss: 0.3285 -> 0.3104   acc: 90.88% -> 93.31%             
client [94] (test)  loss: 0.5207 -> 0.5483   acc: 82.64% -> 84.50%             
client [81] (test)  loss: 0.5532 -> 0.5100   acc: 79.83% -> 81.23%             
client [3] (test)  loss: 0.6168 -> 0.3088   acc: 78.51% -> 90.08%              
client [11] (test)  loss: 0.4477 -> 0.3937   acc: 86.23% -> 86.96%             
client [95] (test)  loss: 0.4939 -> 0.3157   acc: 83.38% -> 90.70%             
client [67] (test)  loss: 0.4379 -> 0.3064   acc: 86.40% -> 91.69%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4239 -> 0.3480   acc: 88.61% -> 91.39%             
client [79] (test)  loss: 0.7168 -> 0.5221   acc: 78.73% -> 83.43%             
client [58] (test)  loss: 0.2886 -> 0.2215   acc: 90.31% -> 91.88%             
client [88] (test)  loss: 0.9730 -> 0.5009   acc: 75.48% -> 85.95%             
client [46] (test)  loss: 0.5065 -> 0.3752   acc: 88.05% -> 89.50%             
client [11] (test)  loss: 0.4794 -> 0.3981   acc: 86.96% -> 86.96%             
client [55] (test)  loss: 0.6836 -> 0.4591   acc: 81.60% -> 87.28%             
client [13] (test)  loss: 0.3201 -> 0.2617   acc: 89.50% -> 92.91%             
client [31] (test)  loss: 1.2069 -> 0.5913   acc: 67.40% -> 79.13%             
client [75] (test)  loss: 0.4196 -> 0.2830   acc: 83.44% -> 88.96%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2664 -> 0.1494   acc: 92.07% -> 95.17%             
client [7] (test)  loss: 0.5263 -> 0.4559   acc: 83.33% -> 86.11%              
client [57] (test)  loss: 0.3457 -> 0.2964   acc: 91.34% -> 92.42%             
client [13] (test)  loss: 0.3917 -> 0.2464   acc: 87.66% -> 92.91%             
client [43] (test)  loss: 0.5431 -> 0.2387   acc: 84.41% -> 95.16%             
client [91] (test)  loss: 0.5697 -> 0.3933   acc: 80.79% -> 87.89%             
client [10] (test)  loss: 0.3218 -> 0.2734   acc: 90.28% -> 92.50%             
client [64] (test)  loss: 0.7062 -> 0.5300   acc: 82.72% -> 85.55%             
client [82] (test)  loss: 0.4468 -> 0.2456   acc: 86.57% -> 92.04%             
client [22] (test)  loss: 0.5246 -> 0.4320   acc: 84.52% -> 89.03%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5290 -> 0.4822   acc: 84.08% -> 85.67%             
client [23] (test)  loss: 0.5804 -> 0.3021   acc: 83.65% -> 94.69%             
client [88] (test)  loss: 0.7211 -> 0.4939   acc: 79.34% -> 84.85%             
client [98] (test)  loss: 0.4288 -> 0.4724   acc: 86.39% -> 85.83%             
client [79] (test)  loss: 0.6600 -> 0.5026   acc: 78.45% -> 84.25%             
client [21] (test)  loss: 0.3961 -> 0.3485   acc: 88.06% -> 90.56%             
client [92] (test)  loss: 0.5723 -> 0.5186   acc: 82.75% -> 84.64%             
client [56] (test)  loss: 0.4034 -> 0.3937   acc: 87.81% -> 88.12%             
client [5] (test)  loss: 0.5378 -> 0.3714   acc: 80.46% -> 86.21%              
client [52] (test)  loss: 0.6032 -> 0.4416   acc: 80.06% -> 85.60%             
==================== FedAvg_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.4822 -> 0.0000', 'accuracy': '84.16% -> 0.00%'},          
    200: {'loss': '0.5030 -> 0.0000', 'accuracy': '84.47% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_1 achieved 10.0%(16.06%) at epoch: 1                                    
FedAvg_1 achieved 20.0%(22.12%) at epoch: 2                                    
FedAvg_1 achieved 30.0%(33.22%) at epoch: 3                                    
FedAvg_1 achieved 50.0%(50.39%) at epoch: 4                                    
FedAvg_1 achieved 70.0%(71.14%) at epoch: 7                                    
FedAvg_1 achieved 80.0%(80.49%) at epoch: 28                                   
Convergence (test_after):                                                      
FedAvg_1 achieved 50.0%(53.09%) at epoch: 0                                    
FedAvg_1 achieved 70.0%(71.93%) at epoch: 2                                    
FedAvg_1 achieved 80.0%(81.50%) at epoch: 8                                    
FedAvg_1 achieved 90.0%(91.29%) at epoch: 56                                   
