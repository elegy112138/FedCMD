==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6180 -> 1.5010   acc: 47.26% -> 47.78%             
client [81] (test)  loss: 2.0910 -> 1.9594   acc: 34.51% -> 33.19%             
client [21] (test)  loss: 2.3810 -> 1.9680   acc: 11.53% -> 27.73%             
client [68] (test)  loss: 1.9058 -> 1.6460   acc: 30.94% -> 39.21%             
client [93] (test)  loss: 0.7397 -> 0.6398   acc: 78.78% -> 78.78%             
client [31] (test)  loss: 2.1714 -> 2.0598   acc: 22.91% -> 26.87%             
client [20] (test)  loss: 1.1847 -> 1.0062   acc: 63.73% -> 67.97%             
client [59] (test)  loss: 2.3626 -> 2.0020   acc: 24.17% -> 45.36%             
client [48] (test)  loss: 1.4403 -> 1.2984   acc: 52.70% -> 56.42%             
client [34] (test)  loss: 1.2167 -> 1.0567   acc: 52.96% -> 54.30%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4205 -> 1.2458   acc: 55.18% -> 66.22%             
client [99] (test)  loss: 1.9452 -> 1.7089   acc: 32.07% -> 36.90%             
client [67] (test)  loss: 1.9717 -> 1.7169   acc: 35.52% -> 40.54%             
client [0] (test)  loss: 1.3105 -> 1.1069   acc: 53.11% -> 69.51%              
client [76] (test)  loss: 1.7388 -> 1.6085   acc: 43.87% -> 46.87%             
client [41] (test)  loss: 2.1102 -> 1.7761   acc: 39.60% -> 39.60%             
client [62] (test)  loss: 2.3763 -> 1.3014   acc: 15.14% -> 54.86%             
client [2] (test)  loss: 2.3944 -> 1.7450   acc: 17.07% -> 50.30%              
client [14] (test)  loss: 1.1916 -> 1.0615   acc: 46.97% -> 56.36%             
client [46] (test)  loss: 1.3529 -> 1.2653   acc: 56.41% -> 64.53%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.4449 -> 1.3135   acc: 44.16% -> 55.84%             
client [68] (test)  loss: 1.2028 -> 1.1239   acc: 66.19% -> 67.27%             
client [57] (test)  loss: 1.9963 -> 1.8475   acc: 43.37% -> 45.92%             
client [17] (test)  loss: 1.8503 -> 1.7536   acc: 34.93% -> 38.36%             
client [54] (test)  loss: 1.2874 -> 1.1811   acc: 52.85% -> 59.32%             
client [23] (test)  loss: 2.3588 -> 1.5783   acc: 23.61% -> 44.17%             
client [35] (test)  loss: 1.1281 -> 1.0116   acc: 71.76% -> 73.84%             
client [59] (test)  loss: 1.4297 -> 1.2562   acc: 58.94% -> 61.26%             
client [31] (test)  loss: 1.8394 -> 1.7672   acc: 37.00% -> 39.21%             
client [9] (test)  loss: 1.5199 -> 1.4160   acc: 46.02% -> 53.69%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.7563 -> 1.6519   acc: 32.91% -> 42.41%             
client [33] (test)  loss: 0.9506 -> 0.9122   acc: 66.88% -> 68.51%             
client [16] (test)  loss: 1.1034 -> 1.0361   acc: 59.48% -> 63.94%             
client [44] (test)  loss: 1.9278 -> 1.5885   acc: 40.79% -> 44.48%             
client [8] (test)  loss: 0.9047 -> 0.8457   acc: 69.18% -> 76.39%              
client [31] (test)  loss: 1.6941 -> 1.6226   acc: 42.73% -> 44.05%             
client [47] (test)  loss: 1.0403 -> 0.9616   acc: 58.73% -> 61.75%             
client [36] (test)  loss: 1.8403 -> 1.5418   acc: 43.09% -> 49.67%             
client [20] (test)  loss: 0.7327 -> 0.6932   acc: 74.18% -> 74.51%             
client [56] (test)  loss: 1.2803 -> 1.0879   acc: 54.29% -> 59.82%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1251 -> 1.0467   acc: 62.21% -> 63.84%              
client [60] (test)  loss: 0.9101 -> 0.7856   acc: 71.60% -> 76.23%             
client [28] (test)  loss: 1.6247 -> 1.5406   acc: 39.68% -> 43.65%             
client [25] (test)  loss: 1.2606 -> 1.1493   acc: 53.99% -> 61.34%             
client [58] (test)  loss: 0.7247 -> 0.7113   acc: 77.33% -> 77.08%             
client [44] (test)  loss: 1.5885 -> 1.3994   acc: 44.48% -> 55.24%             
client [39] (test)  loss: 1.1609 -> 1.0391   acc: 59.01% -> 62.79%             
client [29] (test)  loss: 1.6289 -> 1.5859   acc: 45.92% -> 46.78%             
client [3] (test)  loss: 0.8799 -> 0.8304   acc: 72.55% -> 73.53%              
client [84] (test)  loss: 1.6387 -> 1.5496   acc: 42.35% -> 47.33%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.3741 -> 1.1524   acc: 58.26% -> 67.29%             
client [84] (test)  loss: 1.4673 -> 1.3931   acc: 50.18% -> 51.96%             
client [10] (test)  loss: 1.2188 -> 1.1722   acc: 57.03% -> 58.98%             
client [36] (test)  loss: 1.3221 -> 1.2510   acc: 60.86% -> 61.18%             
client [65] (test)  loss: 0.8576 -> 0.8253   acc: 72.76% -> 74.04%             
client [81] (test)  loss: 1.6153 -> 1.5483   acc: 47.79% -> 49.12%             
client [79] (test)  loss: 1.7574 -> 1.6725   acc: 41.36% -> 43.18%             
client [42] (test)  loss: 1.4012 -> 1.3376   acc: 50.75% -> 54.65%             
client [11] (test)  loss: 1.6576 -> 1.5838   acc: 51.68% -> 53.36%             
client [96] (test)  loss: 1.3535 -> 1.2654   acc: 56.74% -> 58.51%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7385 -> 0.6940   acc: 81.31% -> 81.64%              
client [53] (test)  loss: 1.4789 -> 1.4323   acc: 43.53% -> 45.49%             
client [52] (test)  loss: 0.6623 -> 0.6235   acc: 81.15% -> 81.15%             
client [42] (test)  loss: 1.2864 -> 1.2385   acc: 56.16% -> 57.96%             
client [69] (test)  loss: 0.7566 -> 0.7315   acc: 76.92% -> 76.59%             
client [59] (test)  loss: 0.9567 -> 0.9006   acc: 68.54% -> 68.21%             
client [7] (test)  loss: 0.6621 -> 0.6365   acc: 79.54% -> 80.12%              
client [26] (test)  loss: 0.5149 -> 0.4743   acc: 80.36% -> 82.14%             
client [49] (test)  loss: 0.6453 -> 0.5820   acc: 75.97% -> 78.25%             
client [98] (test)  loss: 1.3591 -> 1.3141   acc: 53.93% -> 54.97%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.3141 -> 1.2709   acc: 54.97% -> 56.02%             
client [47] (test)  loss: 0.9143 -> 0.8758   acc: 64.76% -> 66.87%             
client [21] (test)  loss: 1.0116 -> 0.9205   acc: 71.96% -> 72.27%             
client [77] (test)  loss: 1.0558 -> 1.0242   acc: 67.62% -> 67.89%             
client [95] (test)  loss: 1.4685 -> 1.4269   acc: 42.17% -> 44.98%             
client [91] (test)  loss: 1.5813 -> 1.5352   acc: 39.57% -> 40.11%             
client [14] (test)  loss: 0.5925 -> 0.5537   acc: 80.61% -> 81.82%             
client [99] (test)  loss: 1.2740 -> 1.1995   acc: 55.17% -> 57.93%             
client [20] (test)  loss: 0.5720 -> 0.5548   acc: 83.01% -> 83.66%             
client [39] (test)  loss: 0.8959 -> 0.8752   acc: 67.44% -> 68.90%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6235 -> 0.5967   acc: 81.15% -> 81.15%             
client [62] (test)  loss: 0.6791 -> 0.6746   acc: 77.14% -> 79.14%             
client [71] (test)  loss: 1.3064 -> 1.2658   acc: 56.80% -> 58.40%             
client [97] (test)  loss: 0.6629 -> 0.6332   acc: 80.86% -> 81.67%             
client [30] (test)  loss: 0.5295 -> 0.5113   acc: 82.59% -> 82.59%             
client [88] (test)  loss: 0.6521 -> 0.6120   acc: 79.17% -> 83.01%             
client [60] (test)  loss: 0.6031 -> 0.5822   acc: 78.70% -> 79.63%             
client [82] (test)  loss: 1.0935 -> 1.0663   acc: 66.34% -> 67.31%             
client [91] (test)  loss: 1.4937 -> 1.4538   acc: 42.25% -> 44.92%             
client [57] (test)  loss: 1.5834 -> 1.5138   acc: 52.55% -> 54.59%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2405 -> 1.2450   acc: 60.35% -> 60.79%             
client [15] (test)  loss: 0.6983 -> 0.6491   acc: 74.38% -> 76.25%             
client [71] (test)  loss: 1.2658 -> 1.2265   acc: 58.40% -> 66.40%             
client [97] (test)  loss: 0.5998 -> 0.5908   acc: 81.94% -> 81.40%             
client [53] (test)  loss: 1.3011 -> 1.2606   acc: 54.90% -> 55.69%             
client [77] (test)  loss: 1.0242 -> 0.9987   acc: 67.89% -> 69.71%             
client [76] (test)  loss: 1.0715 -> 1.0479   acc: 65.12% -> 65.94%             
client [79] (test)  loss: 1.4974 -> 1.4063   acc: 49.09% -> 50.45%             
client [28] (test)  loss: 1.1704 -> 1.1373   acc: 61.11% -> 64.29%             
client [99] (test)  loss: 1.1367 -> 1.0836   acc: 64.14% -> 68.97%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5852 -> 0.5826   acc: 82.48% -> 82.21%             
client [86] (test)  loss: 1.2528 -> 1.2065   acc: 62.56% -> 62.56%             
client [34] (test)  loss: 0.5130 -> 0.5006   acc: 81.45% -> 81.72%             
client [73] (test)  loss: 0.9469 -> 0.9087   acc: 68.42% -> 69.23%             
client [5] (test)  loss: 0.5111 -> 0.5062   acc: 80.49% -> 80.77%              
client [96] (test)  loss: 1.0315 -> 1.0330   acc: 63.12% -> 63.48%             
client [22] (test)  loss: 1.3976 -> 1.3340   acc: 53.89% -> 55.00%             
client [60] (test)  loss: 0.5317 -> 0.5164   acc: 82.41% -> 83.33%             
client [66] (test)  loss: 1.1435 -> 1.0837   acc: 64.49% -> 64.49%             
client [83] (test)  loss: 0.9257 -> 0.9331   acc: 70.94% -> 71.67%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0256 -> 1.0282   acc: 66.21% -> 67.30%             
client [65] (test)  loss: 0.7738 -> 0.7526   acc: 75.96% -> 76.92%             
client [95] (test)  loss: 1.3125 -> 1.2899   acc: 53.41% -> 54.22%             
client [17] (test)  loss: 1.4893 -> 1.4479   acc: 47.26% -> 48.63%             
client [8] (test)  loss: 0.5802 -> 0.5503   acc: 83.61% -> 84.26%              
client [35] (test)  loss: 0.7648 -> 0.7766   acc: 75.93% -> 76.16%             
client [98] (test)  loss: 1.1895 -> 1.1514   acc: 61.26% -> 62.30%             
client [53] (test)  loss: 1.2279 -> 1.2014   acc: 56.08% -> 58.43%             
client [43] (test)  loss: 0.7270 -> 0.6966   acc: 74.69% -> 75.92%             
client [64] (test)  loss: 1.3719 -> 1.3245   acc: 56.33% -> 61.39%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8593 -> 0.8211   acc: 73.21% -> 73.83%             
client [88] (test)  loss: 0.5044 -> 0.4953   acc: 84.29% -> 84.62%             
client [38] (test)  loss: 0.8018 -> 0.7939   acc: 74.48% -> 74.18%             
client [3] (test)  loss: 0.6229 -> 0.6285   acc: 83.33% -> 83.33%              
client [5] (test)  loss: 0.5050 -> 0.5042   acc: 80.49% -> 79.95%              
client [41] (test)  loss: 1.0771 -> 1.0100   acc: 69.20% -> 68.80%             
client [7] (test)  loss: 0.6106 -> 0.6055   acc: 79.83% -> 80.69%              
client [37] (test)  loss: 1.2038 -> 1.1422   acc: 58.33% -> 61.00%             
client [45] (test)  loss: 1.0897 -> 1.0424   acc: 64.67% -> 66.88%             
client [47] (test)  loss: 0.8157 -> 0.7927   acc: 70.18% -> 71.69%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8121 -> 0.8047   acc: 78.44% -> 78.44%             
client [11] (test)  loss: 1.2973 -> 1.2729   acc: 59.66% -> 65.97%             
client [37] (test)  loss: 1.0502 -> 1.0266   acc: 67.00% -> 66.67%             
client [41] (test)  loss: 1.0100 -> 0.9956   acc: 68.80% -> 70.40%             
client [95] (test)  loss: 1.2821 -> 1.2924   acc: 58.23% -> 58.63%             
client [53] (test)  loss: 1.2014 -> 1.1777   acc: 58.43% -> 58.82%             
client [22] (test)  loss: 1.2722 -> 1.2140   acc: 56.11% -> 60.56%             
client [25] (test)  loss: 0.7709 -> 0.7453   acc: 78.27% -> 79.23%             
client [69] (test)  loss: 0.7093 -> 0.7089   acc: 77.59% -> 78.60%             
client [46] (test)  loss: 0.9507 -> 0.9248   acc: 67.95% -> 70.51%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7412 -> 0.7393   acc: 73.80% -> 75.00%             
client [69] (test)  loss: 0.7086 -> 0.7135   acc: 78.60% -> 78.60%             
client [82] (test)  loss: 0.9962 -> 0.9908   acc: 68.93% -> 70.23%             
client [45] (test)  loss: 0.9703 -> 0.9409   acc: 68.77% -> 70.66%             
client [7] (test)  loss: 0.6055 -> 0.5946   acc: 80.69% -> 81.27%              
client [50] (test)  loss: 0.8344 -> 0.7663   acc: 78.47% -> 79.93%             
client [35] (test)  loss: 0.8034 -> 0.8147   acc: 75.46% -> 75.23%             
client [24] (test)  loss: 1.0049 -> 1.0230   acc: 69.29% -> 69.29%             
client [15] (test)  loss: 0.5118 -> 0.4917   acc: 83.75% -> 83.44%             
client [58] (test)  loss: 0.8566 -> 0.8682   acc: 79.35% -> 79.35%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8742 -> 0.8836   acc: 71.96% -> 72.64%             
client [76] (test)  loss: 1.0716 -> 1.0798   acc: 65.12% -> 65.67%             
client [67] (test)  loss: 1.0174 -> 1.0259   acc: 70.66% -> 70.27%             
client [37] (test)  loss: 1.0117 -> 1.0067   acc: 67.33% -> 67.00%             
client [58] (test)  loss: 0.8789 -> 0.8899   acc: 79.85% -> 79.60%             
client [64] (test)  loss: 1.1835 -> 1.1465   acc: 63.92% -> 63.92%             
client [77] (test)  loss: 0.9577 -> 0.9595   acc: 70.76% -> 70.76%             
client [55] (test)  loss: 1.0335 -> 1.0262   acc: 72.29% -> 72.29%             
client [12] (test)  loss: 0.9490 -> 0.9504   acc: 71.26% -> 71.65%             
client [89] (test)  loss: 0.6691 -> 0.6740   acc: 80.69% -> 80.40%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.5378 -> 1.5362   acc: 60.14% -> 59.79%             
client [51] (test)  loss: 0.9707 -> 0.9681   acc: 67.95% -> 68.38%             
client [8] (test)  loss: 0.4489 -> 0.4407   acc: 86.89% -> 86.89%              
client [18] (test)  loss: 0.3176 -> 0.3086   acc: 90.43% -> 90.43%             
client [94] (test)  loss: 0.7917 -> 0.7773   acc: 75.39% -> 75.78%             
client [81] (test)  loss: 1.3348 -> 1.3445   acc: 61.06% -> 61.95%             
client [3] (test)  loss: 0.6635 -> 0.6745   acc: 82.68% -> 82.68%              
client [11] (test)  loss: 1.2610 -> 1.3036   acc: 63.87% -> 63.03%             
client [95] (test)  loss: 1.3556 -> 1.3688   acc: 60.24% -> 59.84%             
client [67] (test)  loss: 1.0259 -> 1.0407   acc: 70.27% -> 69.88%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7728 -> 0.7645   acc: 74.77% -> 75.08%             
client [79] (test)  loss: 1.0510 -> 1.0652   acc: 63.18% -> 63.18%             
client [58] (test)  loss: 0.9167 -> 0.9244   acc: 79.60% -> 79.60%             
client [88] (test)  loss: 0.4831 -> 0.4812   acc: 84.94% -> 84.94%             
client [46] (test)  loss: 0.8731 -> 0.8625   acc: 71.79% -> 71.79%             
client [11] (test)  loss: 1.3036 -> 1.3133   acc: 63.03% -> 62.18%             
client [55] (test)  loss: 1.0045 -> 1.0002   acc: 73.49% -> 73.49%             
client [13] (test)  loss: 0.7124 -> 0.7194   acc: 79.21% -> 79.78%             
client [31] (test)  loss: 1.2661 -> 1.2738   acc: 60.79% -> 60.79%             
client [75] (test)  loss: 0.9575 -> 0.9536   acc: 65.08% -> 66.14%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5506 -> 0.5534   acc: 83.13% -> 83.13%             
client [7] (test)  loss: 0.5586 -> 0.5575   acc: 83.29% -> 83.86%              
client [57] (test)  loss: 1.1342 -> 1.1109   acc: 65.31% -> 64.29%             
client [13] (test)  loss: 0.7237 -> 0.7248   acc: 79.49% -> 80.34%             
client [43] (test)  loss: 0.6705 -> 0.6775   acc: 77.40% -> 77.15%             
client [91] (test)  loss: 1.2845 -> 1.2477   acc: 58.82% -> 60.96%             
client [10] (test)  loss: 0.8808 -> 0.8550   acc: 71.88% -> 73.05%             
client [64] (test)  loss: 1.0579 -> 1.0554   acc: 66.46% -> 65.19%             
client [82] (test)  loss: 1.0196 -> 1.0324   acc: 71.84% -> 71.84%             
client [22] (test)  loss: 0.9993 -> 0.9796   acc: 68.33% -> 69.44%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5439 -> 0.5484   acc: 84.31% -> 84.97%             
client [23] (test)  loss: 0.6620 -> 0.6469   acc: 80.83% -> 81.67%             
client [88] (test)  loss: 0.4812 -> 0.4781   acc: 84.94% -> 84.94%             
client [98] (test)  loss: 0.9722 -> 0.9650   acc: 70.16% -> 69.63%             
client [79] (test)  loss: 1.1043 -> 1.1254   acc: 63.64% -> 64.09%             
client [21] (test)  loss: 0.7624 -> 0.7649   acc: 75.08% -> 75.39%             
client [92] (test)  loss: 1.0995 -> 1.1050   acc: 64.77% -> 64.39%             
client [56] (test)  loss: 0.4670 -> 0.4644   acc: 84.97% -> 84.66%             
client [5] (test)  loss: 0.5184 -> 0.5232   acc: 82.69% -> 82.69%              
client [52] (test)  loss: 0.5464 -> 0.5513   acc: 84.35% -> 84.66%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.9278 -> 0.0000', 'accuracy': '70.49% -> 0.00%'},          
    200: {'loss': '0.8365 -> 0.0000', 'accuracy': '75.41% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(15.55%) at epoch: 0                                
Local-only-1 achieved 20.0%(24.32%) at epoch: 3                                
Local-only-1 achieved 30.0%(31.51%) at epoch: 4                                
Local-only-1 achieved 40.0%(43.40%) at epoch: 9                                
Local-only-1 achieved 50.0%(50.66%) at epoch: 17                               
Local-only-1 achieved 60.0%(62.22%) at epoch: 44                               
Local-only-1 achieved 70.0%(71.10%) at epoch: 69                               
Local-only-1 achieved 80.0%(80.05%) at epoch: 168                              
Convergence (test_after):                                                      
Local-only-1 achieved 30.0%(38.48%) at epoch: 0                                
Local-only-1 achieved 40.0%(43.04%) at epoch: 1                                
Local-only-1 achieved 50.0%(50.76%) at epoch: 5                                
Local-only-1 achieved 60.0%(60.98%) at epoch: 28                               
Local-only-1 achieved 70.0%(70.02%) at epoch: 45                               
Local-only-1 achieved 80.0%(80.59%) at epoch: 168                              
