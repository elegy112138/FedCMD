==================== ALGORITHM: FedFomo_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1984 -> 5.1752   acc: 2.52% -> 3.24%               
client [81] (test)  loss: 5.2151 -> 5.1998   acc: 2.58% -> 2.21%               
client [21] (test)  loss: 5.2928 -> 5.2209   acc: 0.18% -> 2.00%               
client [68] (test)  loss: 5.1575 -> 5.0302   acc: 4.88% -> 4.88%               
client [93] (test)  loss: 5.2225 -> 5.1376   acc: 2.00% -> 2.36%               
client [31] (test)  loss: 5.2439 -> 5.1927   acc: 4.50% -> 4.86%               
client [20] (test)  loss: 5.0828 -> 5.0729   acc: 7.94% -> 8.13%               
client [59] (test)  loss: 5.2922 -> 5.2299   acc: 1.09% -> 1.27%               
client [48] (test)  loss: 5.1026 -> 5.0979   acc: 4.84% -> 5.56%               
client [34] (test)  loss: 5.1913 -> 5.1263   acc: 1.64% -> 1.82%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.2262 -> 5.1691   acc: 1.30% -> 1.67%               
client [99] (test)  loss: 5.1910 -> 5.1397   acc: 1.26% -> 1.62%               
client [67] (test)  loss: 5.2650 -> 5.1667   acc: 1.12% -> 2.61%               
client [0] (test)  loss: 5.1443 -> 5.0787   acc: 2.36% -> 3.08%                
client [76] (test)  loss: 4.8642 -> 4.8557   acc: 5.08% -> 7.62%               
client [41] (test)  loss: 5.2604 -> 5.1988   acc: 0.91% -> 2.36%               
client [62] (test)  loss: 5.2900 -> 5.1995   acc: 0.36% -> 2.15%               
client [2] (test)  loss: 5.2965 -> 5.2284   acc: 0.00% -> 4.99%                
client [14] (test)  loss: 5.1277 -> 5.1382   acc: 3.43% -> 4.15%               
client [46] (test)  loss: 5.0727 -> 5.0835   acc: 2.18% -> 3.09%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7935 -> 4.7913   acc: 11.23% -> 12.83%             
client [68] (test)  loss: 4.9048 -> 4.8851   acc: 6.69% -> 6.69%               
client [57] (test)  loss: 5.1634 -> 5.1096   acc: 3.81% -> 3.81%               
client [17] (test)  loss: 5.1123 -> 5.0971   acc: 4.32% -> 4.32%               
client [54] (test)  loss: 5.0430 -> 5.0659   acc: 2.90% -> 5.26%               
client [23] (test)  loss: 5.3046 -> 5.2631   acc: 0.36% -> 1.08%               
client [35] (test)  loss: 4.9734 -> 4.9641   acc: 3.45% -> 3.63%               
client [59] (test)  loss: 5.0675 -> 5.0408   acc: 1.27% -> 1.27%               
client [31] (test)  loss: 5.2613 -> 5.3105   acc: 3.24% -> 3.06%               
client [9] (test)  loss: 5.2038 -> 5.2363   acc: 1.99% -> 2.71%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.1770 -> 5.2113   acc: 3.35% -> 3.90%               
client [33] (test)  loss: 5.2880 -> 5.4265   acc: 3.62% -> 3.99%               
client [16] (test)  loss: 5.1644 -> 5.1285   acc: 3.77% -> 3.59%               
client [44] (test)  loss: 5.2893 -> 5.3157   acc: 1.42% -> 0.36%               
client [8] (test)  loss: 5.1466 -> 5.2286   acc: 5.42% -> 4.87%                
client [31] (test)  loss: 5.3884 -> 5.5151   acc: 3.24% -> 2.88%               
client [47] (test)  loss: 5.0549 -> 5.0356   acc: 4.15% -> 4.33%               
client [36] (test)  loss: 5.2587 -> 5.1751   acc: 2.00% -> 2.73%               
client [20] (test)  loss: 5.1666 -> 5.2589   acc: 7.75% -> 8.13%               
client [56] (test)  loss: 5.1222 -> 5.0573   acc: 5.96% -> 5.23%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.1119 -> 5.1266   acc: 2.72% -> 3.09%                
client [60] (test)  loss: 4.9494 -> 4.9100   acc: 5.22% -> 5.22%               
client [28] (test)  loss: 5.0275 -> 5.0594   acc: 4.36% -> 5.08%               
client [25] (test)  loss: 5.1406 -> 5.1010   acc: 1.80% -> 2.16%               
client [58] (test)  loss: 5.0959 -> 5.1945   acc: 4.32% -> 3.78%               
client [44] (test)  loss: 5.3157 -> 5.2924   acc: 0.36% -> 1.42%               
client [39] (test)  loss: 5.0574 -> 5.0535   acc: 4.91% -> 4.73%               
client [29] (test)  loss: 5.2504 -> 5.2961   acc: 2.98% -> 3.68%               
client [3] (test)  loss: 5.0299 -> 5.0226   acc: 5.01% -> 5.01%                
client [84] (test)  loss: 5.0306 -> 5.0896   acc: 5.07% -> 5.80%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.0895 -> 5.0724   acc: 2.72% -> 3.27%               
client [84] (test)  loss: 5.1753 -> 5.2743   acc: 5.80% -> 5.43%               
client [10] (test)  loss: 5.0881 -> 5.0952   acc: 4.68% -> 5.40%               
client [36] (test)  loss: 5.0348 -> 5.0185   acc: 4.18% -> 5.09%               
client [65] (test)  loss: 5.3537 -> 5.4213   acc: 2.90% -> 2.72%               
client [81] (test)  loss: 5.2945 -> 5.3163   acc: 3.14% -> 2.95%               
client [79] (test)  loss: 5.1992 -> 5.2253   acc: 4.44% -> 4.26%               
client [42] (test)  loss: 5.2142 -> 5.2524   acc: 6.42% -> 5.85%               
client [11] (test)  loss: 4.8760 -> 4.8819   acc: 10.07% -> 10.07%             
client [96] (test)  loss: 4.9839 -> 4.9797   acc: 3.06% -> 3.24%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.1580 -> 5.0813   acc: 3.25% -> 3.25%                
client [53] (test)  loss: 5.1717 -> 5.1790   acc: 3.88% -> 5.11%               
client [52] (test)  loss: 5.1489 -> 5.1812   acc: 3.62% -> 5.25%               
client [42] (test)  loss: 5.3312 -> 5.4659   acc: 6.60% -> 5.85%               
client [69] (test)  loss: 5.6706 -> 5.9196   acc: 5.00% -> 4.07%               
client [59] (test)  loss: 5.0572 -> 5.1210   acc: 2.36% -> 2.00%               
client [7] (test)  loss: 5.1402 -> 5.2421   acc: 5.62% -> 5.62%                
client [26] (test)  loss: 5.0908 -> 5.1254   acc: 5.04% -> 5.58%               
client [49] (test)  loss: 5.1407 -> 5.1776   acc: 3.25% -> 3.43%               
client [98] (test)  loss: 5.2397 -> 5.3989   acc: 4.00% -> 2.55%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 5.3989 -> 5.6285   acc: 2.55% -> 2.73%               
client [47] (test)  loss: 5.0360 -> 5.0425   acc: 3.61% -> 3.61%               
client [21] (test)  loss: 5.0674 -> 5.0751   acc: 3.27% -> 3.27%               
client [77] (test)  loss: 5.4231 -> 5.6547   acc: 5.04% -> 4.68%               
client [95] (test)  loss: 5.5388 -> 5.7489   acc: 4.69% -> 4.50%               
client [91] (test)  loss: 5.4341 -> 5.5343   acc: 4.36% -> 4.55%               
client [14] (test)  loss: 5.4569 -> 5.6615   acc: 3.97% -> 3.61%               
client [99] (test)  loss: 5.2827 -> 5.3937   acc: 4.15% -> 4.33%               
client [20] (test)  loss: 6.0312 -> 6.3562   acc: 6.99% -> 7.56%               
client [39] (test)  loss: 5.0787 -> 5.1179   acc: 4.73% -> 3.82%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.1812 -> 5.2490   acc: 5.25% -> 5.25%               
client [62] (test)  loss: 5.9211 -> 6.2102   acc: 3.23% -> 3.05%               
client [71] (test)  loss: 5.3449 -> 5.4851   acc: 3.41% -> 3.76%               
client [97] (test)  loss: 5.3663 -> 5.4708   acc: 2.73% -> 3.27%               
client [30] (test)  loss: 5.1290 -> 5.0982   acc: 3.99% -> 4.53%               
client [88] (test)  loss: 4.9479 -> 4.9938   acc: 6.87% -> 7.05%               
client [60] (test)  loss: 5.1224 -> 5.2757   acc: 5.94% -> 5.94%               
client [82] (test)  loss: 5.3394 -> 5.5527   acc: 7.32% -> 6.07%               
client [91] (test)  loss: 5.7343 -> 5.9835   acc: 4.91% -> 4.18%               
client [57] (test)  loss: 5.1768 -> 5.2433   acc: 5.08% -> 6.17%               
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.6166 -> 5.8742   acc: 2.16% -> 2.34%               
client [15] (test)  loss: 5.2157 -> 5.3055   acc: 3.59% -> 3.41%               
client [71] (test)  loss: 5.4851 -> 5.6719   acc: 3.76% -> 3.23%               
client [97] (test)  loss: 5.8244 -> 6.0967   acc: 4.36% -> 4.73%               
client [53] (test)  loss: 5.4147 -> 5.5957   acc: 5.64% -> 4.94%               
client [77] (test)  loss: 5.6547 -> 6.0155   acc: 4.68% -> 4.32%               
client [76] (test)  loss: 5.5622 -> 5.8675   acc: 4.90% -> 4.17%               
client [79] (test)  loss: 5.3443 -> 5.4669   acc: 4.97% -> 4.97%               
client [28] (test)  loss: 5.0969 -> 5.1921   acc: 3.27% -> 3.99%               
client [99] (test)  loss: 5.5599 -> 5.7618   acc: 4.33% -> 5.05%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 5.5931 -> 5.0769   acc: 1.45% -> 2.73%               
client [86] (test)  loss: 5.3288 -> 5.5181   acc: 5.81% -> 6.72%               
client [34] (test)  loss: 6.5744 -> 6.8327   acc: 1.82% -> 1.64%               
client [73] (test)  loss: 5.4970 -> 5.6616   acc: 3.86% -> 3.25%               
client [5] (test)  loss: 5.8516 -> 6.0122   acc: 5.34% -> 5.52%                
client [96] (test)  loss: 4.9205 -> 4.9058   acc: 5.05% -> 4.14%               
client [22] (test)  loss: 5.5726 -> 5.8483   acc: 5.06% -> 5.24%               
client [60] (test)  loss: 6.1257 -> 6.4875   acc: 5.04% -> 4.86%               
client [66] (test)  loss: 5.1787 -> 5.3594   acc: 6.14% -> 5.42%               
client [83] (test)  loss: 5.6336 -> 4.9441   acc: 1.63% -> 5.42%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.7767 -> 4.8340   acc: 9.44% -> 9.62%               
client [65] (test)  loss: 5.6642 -> 5.8733   acc: 2.90% -> 3.09%               
client [95] (test)  loss: 6.6110 -> 6.8576   acc: 3.94% -> 3.38%               
client [17] (test)  loss: 5.1792 -> 5.2701   acc: 4.86% -> 4.32%               
client [8] (test)  loss: 5.0942 -> 5.1434   acc: 5.60% -> 6.14%                
client [35] (test)  loss: 4.9829 -> 5.1450   acc: 5.99% -> 5.26%               
client [98] (test)  loss: 5.2633 -> 4.8271   acc: 1.45% -> 4.36%               
client [53] (test)  loss: 5.2334 -> 5.0376   acc: 0.88% -> 2.82%               
client [43] (test)  loss: 5.2288 -> 5.0442   acc: 1.45% -> 3.08%               
client [64] (test)  loss: 5.3834 -> 5.0502   acc: 1.86% -> 3.90%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.1144 -> 5.1902   acc: 3.81% -> 3.45%               
client [88] (test)  loss: 4.8041 -> 4.8406   acc: 6.51% -> 6.69%               
client [38] (test)  loss: 6.2468 -> 6.5523   acc: 4.26% -> 3.33%               
client [3] (test)  loss: 4.9350 -> 4.9946   acc: 5.72% -> 6.44%                
client [5] (test)  loss: 5.3409 -> 4.9681   acc: 0.71% -> 4.45%                
client [41] (test)  loss: 5.2330 -> 4.9395   acc: 1.63% -> 3.44%               
client [7] (test)  loss: 5.5954 -> 5.8331   acc: 4.53% -> 5.62%                
client [37] (test)  loss: 4.9335 -> 4.9079   acc: 3.06% -> 3.42%               
client [45] (test)  loss: 5.1022 -> 5.1310   acc: 4.91% -> 5.09%               
client [47] (test)  loss: 5.1647 -> 5.3182   acc: 3.61% -> 3.97%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.8775 -> 4.8809   acc: 5.03% -> 6.46%               
client [11] (test)  loss: 5.9314 -> 6.2359   acc: 7.01% -> 6.47%               
client [37] (test)  loss: 5.1228 -> 5.3499   acc: 3.06% -> 2.88%               
client [41] (test)  loss: 4.9395 -> 4.9369   acc: 3.44% -> 4.71%               
client [95] (test)  loss: 5.1511 -> 5.2630   acc: 6.38% -> 6.75%               
client [53] (test)  loss: 5.0376 -> 5.0168   acc: 2.82% -> 4.06%               
client [22] (test)  loss: 5.2323 -> 4.8279   acc: 1.45% -> 6.33%               
client [25] (test)  loss: 5.4114 -> 4.8818   acc: 1.98% -> 4.50%               
client [69] (test)  loss: 4.9785 -> 5.0403   acc: 4.81% -> 5.74%               
client [46] (test)  loss: 5.5633 -> 6.0140   acc: 4.72% -> 2.90%               
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.9745 -> 5.1563   acc: 4.87% -> 5.05%               
client [69] (test)  loss: 5.1525 -> 5.3037   acc: 5.00% -> 5.00%               
client [82] (test)  loss: 4.9964 -> 5.0637   acc: 8.75% -> 8.57%               
client [45] (test)  loss: 5.2941 -> 5.4678   acc: 5.27% -> 4.18%               
client [7] (test)  loss: 5.8331 -> 6.0916   acc: 5.62% -> 3.80%                
client [50] (test)  loss: 5.4376 -> 5.5547   acc: 3.80% -> 3.99%               
client [35] (test)  loss: 5.5852 -> 5.7954   acc: 3.81% -> 3.27%               
client [24] (test)  loss: 4.9144 -> 5.3513   acc: 8.73% -> 6.60%               
client [15] (test)  loss: 5.0197 -> 5.0662   acc: 5.57% -> 6.10%               
client [58] (test)  loss: 4.9599 -> 5.0755   acc: 5.41% -> 5.77%               
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.6435 -> 5.9103   acc: 4.12% -> 4.12%               
client [76] (test)  loss: 5.0079 -> 5.2273   acc: 8.53% -> 7.80%               
client [67] (test)  loss: 5.4085 -> 5.6412   acc: 5.22% -> 5.04%               
client [37] (test)  loss: 5.6665 -> 6.0300   acc: 2.70% -> 3.06%               
client [58] (test)  loss: 5.1901 -> 5.5312   acc: 4.68% -> 4.68%               
client [64] (test)  loss: 5.2180 -> 5.3730   acc: 6.51% -> 5.76%               
client [77] (test)  loss: 5.1144 -> 5.2456   acc: 4.68% -> 5.22%               
client [55] (test)  loss: 4.8720 -> 4.9034   acc: 6.08% -> 6.80%               
client [12] (test)  loss: 5.5555 -> 5.8529   acc: 5.56% -> 5.56%               
client [89] (test)  loss: 5.3364 -> 5.5445   acc: 5.20% -> 5.02%               
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.8445 -> 5.0521   acc: 7.79% -> 7.61%               
client [51] (test)  loss: 5.6507 -> 5.7965   acc: 5.77% -> 6.13%               
client [8] (test)  loss: 4.9130 -> 5.0377   acc: 8.12% -> 7.58%                
client [18] (test)  loss: 6.2644 -> 6.5446   acc: 5.01% -> 5.01%               
client [94] (test)  loss: 5.1543 -> 5.2761   acc: 3.98% -> 3.80%               
client [81] (test)  loss: 6.0606 -> 6.3187   acc: 4.24% -> 3.69%               
client [3] (test)  loss: 5.5235 -> 5.7502   acc: 6.44% -> 6.44%                
client [11] (test)  loss: 4.7891 -> 4.9018   acc: 6.65% -> 7.01%               
client [95] (test)  loss: 5.1395 -> 5.1838   acc: 5.07% -> 5.82%               
client [67] (test)  loss: 5.6412 -> 5.8668   acc: 5.04% -> 4.48%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.5426 -> 5.7720   acc: 3.63% -> 3.63%               
client [79] (test)  loss: 5.4927 -> 5.7649   acc: 4.09% -> 4.44%               
client [58] (test)  loss: 5.0539 -> 5.3415   acc: 6.13% -> 5.41%               
client [88] (test)  loss: 5.1263 -> 5.2224   acc: 7.41% -> 6.69%               
client [46] (test)  loss: 5.1345 -> 5.2605   acc: 5.81% -> 5.81%               
client [11] (test)  loss: 4.9018 -> 4.9856   acc: 7.01% -> 7.01%               
client [55] (test)  loss: 5.7981 -> 6.0961   acc: 5.37% -> 5.37%               
client [13] (test)  loss: 5.5997 -> 5.9265   acc: 6.52% -> 6.34%               
client [31] (test)  loss: 5.0988 -> 4.9316   acc: 1.62% -> 4.50%               
client [75] (test)  loss: 5.2178 -> 5.4400   acc: 8.30% -> 7.76%               
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.6558 -> 5.1572   acc: 2.05% -> 2.87%               
client [7] (test)  loss: 5.2594 -> 5.4520   acc: 7.07% -> 6.52%                
client [57] (test)  loss: 7.0740 -> 7.3200   acc: 5.08% -> 4.90%               
client [13] (test)  loss: 4.6212 -> 4.6791   acc: 6.70% -> 5.80%               
client [43] (test)  loss: 4.8845 -> 4.9457   acc: 5.07% -> 5.62%               
client [91] (test)  loss: 5.3477 -> 5.8865   acc: 5.09% -> 4.18%               
client [10] (test)  loss: 5.2529 -> 4.8450   acc: 2.52% -> 7.19%               
client [64] (test)  loss: 5.1204 -> 5.1177   acc: 4.46% -> 5.58%               
client [82] (test)  loss: 6.3667 -> 6.5870   acc: 6.79% -> 6.43%               
client [22] (test)  loss: 5.4708 -> 5.7174   acc: 4.88% -> 5.42%               
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.2118 -> 5.4516   acc: 7.18% -> 6.62%               
client [23] (test)  loss: 5.9154 -> 6.2141   acc: 3.44% -> 3.25%               
client [88] (test)  loss: 5.2224 -> 5.4245   acc: 6.69% -> 6.69%               
client [98] (test)  loss: 4.8579 -> 5.0564   acc: 6.55% -> 6.36%               
client [79] (test)  loss: 6.2930 -> 6.5390   acc: 4.80% -> 4.97%               
client [21] (test)  loss: 5.1171 -> 4.6282   acc: 4.72% -> 5.99%               
client [92] (test)  loss: 5.6741 -> 5.9905   acc: 9.46% -> 9.46%               
client [56] (test)  loss: 5.4042 -> 4.6840   acc: 3.25% -> 8.12%               
client [5] (test)  loss: 6.1931 -> 6.4249   acc: 5.16% -> 4.98%                
client [52] (test)  loss: 6.3699 -> 6.6489   acc: 5.43% -> 4.89%               
==================== FedFomo_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '5.4183 -> 0.0000', 'accuracy': '4.52% -> 0.00%'},           
    200: {'loss': '5.5763 -> 0.0000', 'accuracy': '5.65% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
Convergence (test_after):                                                      
