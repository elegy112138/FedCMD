==================== ALGORITHM: FedFomo_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6069 -> 1.5118   acc: 47.52% -> 48.30%             
client [81] (test)  loss: 2.1287 -> 2.0075   acc: 30.97% -> 30.97%             
client [21] (test)  loss: 2.2362 -> 1.6402   acc: 27.73% -> 37.38%             
client [68] (test)  loss: 1.4761 -> 1.1782   acc: 38.13% -> 63.31%             
client [93] (test)  loss: 0.8635 -> 0.6432   acc: 78.78% -> 78.78%             
client [31] (test)  loss: 2.2554 -> 2.0911   acc: 25.99% -> 27.31%             
client [20] (test)  loss: 1.2542 -> 1.0831   acc: 58.17% -> 66.99%             
client [59] (test)  loss: 2.3123 -> 1.5823   acc: 6.95% -> 60.26%              
client [48] (test)  loss: 1.4271 -> 1.3223   acc: 52.36% -> 55.74%             
client [34] (test)  loss: 1.2856 -> 1.1147   acc: 52.96% -> 52.96%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5113 -> 1.3344   acc: 60.54% -> 66.89%             
client [99] (test)  loss: 1.4437 -> 1.3098   acc: 47.93% -> 55.17%             
client [67] (test)  loss: 1.7034 -> 1.4513   acc: 40.15% -> 44.40%             
client [0] (test)  loss: 1.4369 -> 1.2108   acc: 52.13% -> 68.20%              
client [76] (test)  loss: 1.6553 -> 1.5574   acc: 44.96% -> 51.50%             
client [41] (test)  loss: 2.2044 -> 1.8776   acc: 39.60% -> 39.60%             
client [62] (test)  loss: 2.3763 -> 1.3750   acc: 15.14% -> 54.86%             
client [2] (test)  loss: 2.3943 -> 1.8689   acc: 17.07% -> 48.20%              
client [14] (test)  loss: 1.3152 -> 0.9571   acc: 66.36% -> 70.61%             
client [46] (test)  loss: 1.1049 -> 1.0480   acc: 59.83% -> 65.38%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.5293 -> 1.4200   acc: 38.83% -> 46.45%             
client [68] (test)  loss: 0.9650 -> 0.9270   acc: 70.86% -> 72.30%             
client [57] (test)  loss: 1.7905 -> 1.7243   acc: 42.86% -> 43.88%             
client [17] (test)  loss: 1.6392 -> 1.5631   acc: 49.32% -> 43.15%             
client [54] (test)  loss: 1.3679 -> 1.2805   acc: 51.33% -> 55.13%             
client [23] (test)  loss: 2.0690 -> 1.1011   acc: 36.94% -> 57.78%             
client [35] (test)  loss: 1.2139 -> 1.1000   acc: 68.29% -> 71.76%             
client [59] (test)  loss: 1.1718 -> 1.0478   acc: 63.91% -> 66.23%             
client [31] (test)  loss: 1.9025 -> 1.8616   acc: 29.96% -> 32.16%             
client [9] (test)  loss: 1.4121 -> 1.3263   acc: 54.28% -> 57.52%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2000 -> 1.0808   acc: 63.92% -> 68.99%             
client [33] (test)  loss: 0.8738 -> 0.8433   acc: 69.81% -> 72.08%             
client [16] (test)  loss: 0.9430 -> 0.8997   acc: 71.00% -> 72.49%             
client [44] (test)  loss: 2.0248 -> 1.6954   acc: 42.49% -> 46.74%             
client [8] (test)  loss: 0.9591 -> 0.9138   acc: 66.56% -> 66.23%              
client [31] (test)  loss: 1.8189 -> 1.7714   acc: 34.80% -> 36.12%             
client [47] (test)  loss: 1.1146 -> 1.0128   acc: 57.23% -> 58.73%             
client [36] (test)  loss: 1.4565 -> 1.2815   acc: 59.87% -> 63.49%             
client [20] (test)  loss: 0.7791 -> 0.7444   acc: 74.51% -> 75.16%             
client [56] (test)  loss: 0.9100 -> 0.8045   acc: 69.02% -> 71.78%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1610 -> 1.0955   acc: 59.61% -> 62.54%              
client [60] (test)  loss: 0.7342 -> 0.6773   acc: 77.16% -> 77.47%             
client [28] (test)  loss: 1.6886 -> 1.5983   acc: 38.89% -> 41.67%             
client [25] (test)  loss: 1.2264 -> 1.1448   acc: 55.27% -> 61.98%             
client [58] (test)  loss: 0.7540 -> 0.7283   acc: 76.07% -> 77.33%             
client [44] (test)  loss: 1.6954 -> 1.4894   acc: 46.74% -> 53.26%             
client [39] (test)  loss: 1.2581 -> 1.1279   acc: 56.40% -> 58.72%             
client [29] (test)  loss: 1.6786 -> 1.6507   acc: 43.78% -> 44.21%             
client [3] (test)  loss: 0.9362 -> 0.8935   acc: 72.55% -> 72.22%              
client [84] (test)  loss: 1.4479 -> 1.3916   acc: 52.31% -> 53.74%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.1105 -> 0.9788   acc: 69.16% -> 70.72%             
client [84] (test)  loss: 1.3445 -> 1.3049   acc: 55.52% -> 56.94%             
client [10] (test)  loss: 1.2620 -> 1.2168   acc: 57.03% -> 57.81%             
client [36] (test)  loss: 1.1297 -> 1.0838   acc: 63.16% -> 66.45%             
client [65] (test)  loss: 0.8097 -> 0.7887   acc: 74.68% -> 75.96%             
client [81] (test)  loss: 1.6890 -> 1.6203   acc: 48.23% -> 49.12%             
client [79] (test)  loss: 1.4046 -> 1.3316   acc: 50.45% -> 50.45%             
client [42] (test)  loss: 1.4899 -> 1.4192   acc: 50.45% -> 50.15%             
client [11] (test)  loss: 1.6643 -> 1.6011   acc: 50.42% -> 50.42%             
client [96] (test)  loss: 1.4002 -> 1.3028   acc: 50.35% -> 55.32%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8323 -> 0.7925   acc: 74.43% -> 76.72%              
client [53] (test)  loss: 1.4565 -> 1.4183   acc: 47.45% -> 52.55%             
client [52] (test)  loss: 0.7077 -> 0.6702   acc: 78.91% -> 79.55%             
client [42] (test)  loss: 1.3714 -> 1.3356   acc: 51.95% -> 53.45%             
client [69] (test)  loss: 0.8249 -> 0.7985   acc: 71.91% -> 73.91%             
client [59] (test)  loss: 0.8196 -> 0.7706   acc: 72.19% -> 75.50%             
client [7] (test)  loss: 0.6194 -> 0.6078   acc: 82.71% -> 81.84%              
client [26] (test)  loss: 0.5117 -> 0.4783   acc: 83.16% -> 85.20%             
client [49] (test)  loss: 0.6869 -> 0.6269   acc: 74.35% -> 78.90%             
client [98] (test)  loss: 1.0031 -> 0.9729   acc: 69.63% -> 69.11%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9729 -> 0.9460   acc: 69.11% -> 69.11%             
client [47] (test)  loss: 0.9580 -> 0.9220   acc: 60.24% -> 61.45%             
client [21] (test)  loss: 0.9029 -> 0.8483   acc: 72.59% -> 72.90%             
client [77] (test)  loss: 1.0864 -> 1.0622   acc: 63.71% -> 65.80%             
client [95] (test)  loss: 1.5745 -> 1.5443   acc: 39.36% -> 40.96%             
client [91] (test)  loss: 1.4835 -> 1.4380   acc: 42.78% -> 44.39%             
client [14] (test)  loss: 0.5795 -> 0.5490   acc: 81.52% -> 81.52%             
client [99] (test)  loss: 1.0286 -> 1.0026   acc: 70.00% -> 71.03%             
client [20] (test)  loss: 0.6387 -> 0.6212   acc: 80.39% -> 81.37%             
client [39] (test)  loss: 0.9749 -> 0.9339   acc: 65.41% -> 66.28%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6702 -> 0.6404   acc: 79.55% -> 79.55%             
client [62] (test)  loss: 0.7294 -> 0.7256   acc: 74.86% -> 75.43%             
client [71] (test)  loss: 1.2477 -> 1.2211   acc: 63.20% -> 64.00%             
client [97] (test)  loss: 0.6533 -> 0.6370   acc: 81.13% -> 80.86%             
client [30] (test)  loss: 0.4866 -> 0.4722   acc: 82.59% -> 82.91%             
client [88] (test)  loss: 0.6018 -> 0.5807   acc: 79.81% -> 81.09%             
client [60] (test)  loss: 0.5321 -> 0.5192   acc: 83.02% -> 84.26%             
client [82] (test)  loss: 1.0872 -> 1.0652   acc: 67.96% -> 68.61%             
client [91] (test)  loss: 1.3948 -> 1.3564   acc: 45.99% -> 48.13%             
client [57] (test)  loss: 1.2702 -> 1.2295   acc: 62.76% -> 62.76%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.4321 -> 1.4361   acc: 58.15% -> 59.47%             
client [15] (test)  loss: 0.5502 -> 0.5235   acc: 81.88% -> 82.19%             
client [71] (test)  loss: 1.2211 -> 1.1998   acc: 64.00% -> 66.40%             
client [97] (test)  loss: 0.6272 -> 0.6258   acc: 80.05% -> 80.05%             
client [53] (test)  loss: 1.2853 -> 1.2469   acc: 61.18% -> 61.57%             
client [77] (test)  loss: 1.0622 -> 1.0471   acc: 65.80% -> 67.10%             
client [76] (test)  loss: 1.0925 -> 1.0644   acc: 66.21% -> 66.21%             
client [79] (test)  loss: 1.2027 -> 1.1524   acc: 59.09% -> 60.45%             
client [28] (test)  loss: 1.1310 -> 1.1304   acc: 60.71% -> 62.30%             
client [99] (test)  loss: 0.9880 -> 0.9801   acc: 72.07% -> 72.07%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6250 -> 0.6305   acc: 79.78% -> 79.51%             
client [86] (test)  loss: 0.9344 -> 0.9040   acc: 73.85% -> 74.87%             
client [34] (test)  loss: 0.5716 -> 0.5609   acc: 78.76% -> 79.30%             
client [73] (test)  loss: 0.9991 -> 0.9584   acc: 69.64% -> 70.85%             
client [5] (test)  loss: 0.5597 -> 0.5595   acc: 78.57% -> 79.12%              
client [96] (test)  loss: 1.1104 -> 1.1131   acc: 63.83% -> 63.83%             
client [22] (test)  loss: 0.9642 -> 0.9189   acc: 67.22% -> 68.33%             
client [60] (test)  loss: 0.4945 -> 0.4883   acc: 85.80% -> 85.80%             
client [66] (test)  loss: 1.0081 -> 0.9777   acc: 66.67% -> 67.39%             
client [83] (test)  loss: 1.0074 -> 1.0093   acc: 66.26% -> 66.26%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0202 -> 1.0187   acc: 66.49% -> 66.49%             
client [65] (test)  loss: 0.7572 -> 0.7456   acc: 76.92% -> 77.88%             
client [95] (test)  loss: 1.4623 -> 1.4371   acc: 43.37% -> 46.18%             
client [17] (test)  loss: 1.1724 -> 1.2003   acc: 58.90% -> 59.59%             
client [8] (test)  loss: 0.6923 -> 0.6649   acc: 78.69% -> 79.67%              
client [35] (test)  loss: 0.7997 -> 0.8073   acc: 77.08% -> 76.85%             
client [98] (test)  loss: 0.9006 -> 0.8814   acc: 70.16% -> 71.73%             
client [53] (test)  loss: 1.2200 -> 1.1968   acc: 60.78% -> 60.78%             
client [43] (test)  loss: 0.7436 -> 0.7201   acc: 72.48% -> 74.20%             
client [64] (test)  loss: 0.9951 -> 0.9310   acc: 69.62% -> 72.15%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8095 -> 0.7790   acc: 72.59% -> 74.14%             
client [88] (test)  loss: 0.5541 -> 0.5552   acc: 81.41% -> 81.41%             
client [38] (test)  loss: 0.7515 -> 0.7591   acc: 74.48% -> 75.07%             
client [3] (test)  loss: 0.6700 -> 0.6745   acc: 81.05% -> 82.03%              
client [5] (test)  loss: 0.5572 -> 0.5579   acc: 79.40% -> 79.12%              
client [41] (test)  loss: 1.0704 -> 1.0279   acc: 70.80% -> 72.00%             
client [7] (test)  loss: 0.5950 -> 0.5883   acc: 82.13% -> 82.42%              
client [37] (test)  loss: 1.1222 -> 1.0892   acc: 60.67% -> 61.67%             
client [45] (test)  loss: 0.9845 -> 0.9511   acc: 68.14% -> 69.72%             
client [47] (test)  loss: 0.8698 -> 0.8491   acc: 67.17% -> 69.58%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7937 -> 0.7934   acc: 76.58% -> 76.95%             
client [11] (test)  loss: 1.2853 -> 1.2597   acc: 60.92% -> 58.40%             
client [37] (test)  loss: 1.0419 -> 1.0269   acc: 67.00% -> 67.33%             
client [41] (test)  loss: 1.0279 -> 0.9980   acc: 72.00% -> 72.80%             
client [95] (test)  loss: 1.4024 -> 1.4030   acc: 48.19% -> 49.40%             
client [53] (test)  loss: 1.1968 -> 1.1820   acc: 60.78% -> 60.39%             
client [22] (test)  loss: 0.8888 -> 0.8711   acc: 68.89% -> 69.44%             
client [25] (test)  loss: 0.6641 -> 0.6559   acc: 80.51% -> 80.19%             
client [69] (test)  loss: 0.7379 -> 0.7389   acc: 75.59% -> 75.92%             
client [46] (test)  loss: 0.8399 -> 0.8270   acc: 71.37% -> 70.94%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.8010 -> 0.7951   acc: 72.89% -> 73.19%             
client [69] (test)  loss: 0.7422 -> 0.7432   acc: 75.92% -> 75.92%             
client [82] (test)  loss: 0.9984 -> 0.9916   acc: 69.26% -> 69.58%             
client [45] (test)  loss: 0.9029 -> 0.8860   acc: 69.40% -> 68.77%             
client [7] (test)  loss: 0.5883 -> 0.5881   acc: 82.42% -> 82.42%              
client [50] (test)  loss: 0.6581 -> 0.6405   acc: 82.12% -> 82.48%             
client [35] (test)  loss: 0.8342 -> 0.8521   acc: 75.46% -> 74.77%             
client [24] (test)  loss: 1.0933 -> 1.1133   acc: 67.26% -> 67.01%             
client [15] (test)  loss: 0.4786 -> 0.4687   acc: 83.75% -> 84.69%             
client [58] (test)  loss: 0.7570 -> 0.7658   acc: 80.35% -> 80.10%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.9050 -> 0.9093   acc: 70.95% -> 70.95%             
client [76] (test)  loss: 1.0253 -> 1.0365   acc: 66.76% -> 67.30%             
client [67] (test)  loss: 0.9593 -> 0.9637   acc: 69.88% -> 69.50%             
client [37] (test)  loss: 1.0200 -> 1.0138   acc: 67.33% -> 67.00%             
client [58] (test)  loss: 0.7742 -> 0.7822   acc: 79.60% -> 79.85%             
client [64] (test)  loss: 0.9079 -> 0.9027   acc: 69.62% -> 70.89%             
client [77] (test)  loss: 1.0475 -> 1.0585   acc: 68.67% -> 68.93%             
client [55] (test)  loss: 0.8616 -> 0.8564   acc: 75.30% -> 74.70%             
client [12] (test)  loss: 0.9677 -> 0.9563   acc: 68.90% -> 69.69%             
client [89] (test)  loss: 0.7852 -> 0.7917   acc: 78.39% -> 78.10%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.3833 -> 1.3932   acc: 56.23% -> 55.87%             
client [51] (test)  loss: 1.0751 -> 1.0678   acc: 64.10% -> 63.68%             
client [8] (test)  loss: 0.5514 -> 0.5395   acc: 83.28% -> 83.28%              
client [18] (test)  loss: 0.3574 -> 0.3494   acc: 89.11% -> 89.11%             
client [94] (test)  loss: 0.8069 -> 0.7917   acc: 75.78% -> 76.56%             
client [81] (test)  loss: 1.4009 -> 1.4082   acc: 58.85% -> 59.73%             
client [3] (test)  loss: 0.7094 -> 0.7214   acc: 81.05% -> 81.05%              
client [11] (test)  loss: 1.2278 -> 1.2273   acc: 62.61% -> 60.08%             
client [95] (test)  loss: 1.4153 -> 1.4210   acc: 57.03% -> 57.43%             
client [67] (test)  loss: 0.9637 -> 0.9705   acc: 69.50% -> 69.88%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7523 -> 0.7481   acc: 74.45% -> 75.39%             
client [79] (test)  loss: 1.0274 -> 1.0392   acc: 68.64% -> 68.18%             
client [58] (test)  loss: 0.8032 -> 0.8091   acc: 79.35% -> 79.35%             
client [88] (test)  loss: 0.5610 -> 0.5602   acc: 81.09% -> 81.09%             
client [46] (test)  loss: 0.8083 -> 0.8098   acc: 71.37% -> 72.65%             
client [11] (test)  loss: 1.2273 -> 1.2247   acc: 60.08% -> 61.34%             
client [55] (test)  loss: 0.8797 -> 0.8824   acc: 75.90% -> 75.90%             
client [13] (test)  loss: 0.7136 -> 0.7153   acc: 76.69% -> 76.97%             
client [31] (test)  loss: 1.4653 -> 1.4799   acc: 59.47% -> 59.47%             
client [75] (test)  loss: 1.0989 -> 1.0133   acc: 67.20% -> 66.14%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5871 -> 0.5896   acc: 82.82% -> 81.90%             
client [7] (test)  loss: 0.5610 -> 0.5593   acc: 82.71% -> 83.57%              
client [57] (test)  loss: 1.0156 -> 1.0096   acc: 65.82% -> 66.33%             
client [13] (test)  loss: 0.7192 -> 0.7233   acc: 76.97% -> 78.09%             
client [43] (test)  loss: 0.6894 -> 0.6968   acc: 75.92% -> 76.17%             
client [91] (test)  loss: 1.2197 -> 1.1931   acc: 63.10% -> 63.10%             
client [10] (test)  loss: 0.9202 -> 0.9046   acc: 70.70% -> 71.09%             
client [64] (test)  loss: 0.9116 -> 0.9176   acc: 70.25% -> 70.25%             
client [82] (test)  loss: 0.9858 -> 0.9909   acc: 68.28% -> 68.61%             
client [22] (test)  loss: 0.8604 -> 0.8637   acc: 71.67% -> 71.67%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5688 -> 0.5689   acc: 82.68% -> 83.66%             
client [23] (test)  loss: 0.6713 -> 0.6703   acc: 78.89% -> 79.44%             
client [88] (test)  loss: 0.5602 -> 0.5613   acc: 81.09% -> 81.41%             
client [98] (test)  loss: 0.7870 -> 0.7822   acc: 73.82% -> 74.35%             
client [79] (test)  loss: 1.0562 -> 1.0694   acc: 68.18% -> 68.18%             
client [21] (test)  loss: 0.7486 -> 0.7540   acc: 75.08% -> 74.14%             
client [92] (test)  loss: 1.1652 -> 1.1644   acc: 60.61% -> 60.98%             
client [56] (test)  loss: 0.4486 -> 0.4498   acc: 84.97% -> 85.28%             
client [5] (test)  loss: 0.5755 -> 0.5785   acc: 80.22% -> 80.49%              
client [52] (test)  loss: 0.5558 -> 0.5595   acc: 83.07% -> 83.07%             
==================== FedFomo_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.9061 -> 0.0000', 'accuracy': '70.85% -> 0.00%'},          
    200: {'loss': '0.8432 -> 0.0000', 'accuracy': '74.55% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_1 achieved 10.0%(15.55%) at epoch: 0                                   
FedFomo_1 achieved 20.0%(26.13%) at epoch: 1                                   
FedFomo_1 achieved 30.0%(33.44%) at epoch: 4                                   
FedFomo_1 achieved 40.0%(42.50%) at epoch: 7                                   
FedFomo_1 achieved 50.0%(51.05%) at epoch: 17                                  
FedFomo_1 achieved 60.0%(62.28%) at epoch: 34                                  
FedFomo_1 achieved 70.0%(71.46%) at epoch: 69                                  
Convergence (test_after):                                                      
FedFomo_1 achieved 30.0%(38.81%) at epoch: 0                                   
FedFomo_1 achieved 40.0%(40.68%) at epoch: 1                                   
FedFomo_1 achieved 50.0%(54.86%) at epoch: 5                                   
FedFomo_1 achieved 60.0%(63.43%) at epoch: 20                                  
FedFomo_1 achieved 70.0%(71.84%) at epoch: 60                                  
