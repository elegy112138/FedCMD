==================== ALGORITHM: FedDyn_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8556 -> 0.5872   acc: 69.64% -> 78.21%             
client [81] (test)  loss: 1.0412 -> 0.7097   acc: 57.14% -> 70.31%             
client [21] (test)  loss: 17.9725 -> 0.5592   acc: 39.72% -> 84.72%            
client [68] (test)  loss: 0.8918 -> 0.6904   acc: 70.25% -> 76.58%             
client [93] (test)  loss: 1.0694 -> 0.5653   acc: 56.19% -> 81.90%             
client [31] (test)  loss: 1.1413 -> 0.6487   acc: 49.30% -> 75.15%             
client [20] (test)  loss: 0.8419 -> 0.6875   acc: 69.75% -> 75.80%             
client [59] (test)  loss: 19.5181 -> 0.3620   acc: 36.86% -> 89.14%            
client [48] (test)  loss: 0.5817 -> 0.2977   acc: 84.51% -> 87.93%             
client [34] (test)  loss: 0.6420 -> 0.4253   acc: 77.17% -> 85.87%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6553 -> 0.2958   acc: 77.40% -> 89.35%             
client [99] (test)  loss: 0.5315 -> 0.3231   acc: 80.79% -> 88.98%             
client [67] (test)  loss: 0.5647 -> 0.3361   acc: 83.88% -> 90.18%             
client [0] (test)  loss: 0.5607 -> 0.4811   acc: 80.85% -> 82.45%              
client [76] (test)  loss: 0.5480 -> 0.2695   acc: 81.58% -> 90.79%             
client [41] (test)  loss: 0.7558 -> 0.5805   acc: 70.85% -> 78.97%             
client [62] (test)  loss: 18.9916 -> 0.5051   acc: 51.07% -> 83.49%            
client [2] (test)  loss: 25.8626 -> 0.4927   acc: 39.86% -> 81.82%             
client [14] (test)  loss: 0.6836 -> 0.3747   acc: 74.31% -> 87.41%             
client [46] (test)  loss: 0.5784 -> 0.3344   acc: 79.30% -> 86.30%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4891 -> 0.3967   acc: 81.11% -> 86.15%             
client [68] (test)  loss: 0.4714 -> 0.4449   acc: 82.91% -> 82.91%             
client [57] (test)  loss: 0.5042 -> 0.3162   acc: 82.67% -> 90.97%             
client [17] (test)  loss: 0.5243 -> 0.2460   acc: 82.20% -> 92.15%             
client [54] (test)  loss: 0.3728 -> 0.2420   acc: 88.31% -> 91.65%             
client [23] (test)  loss: 24.7009 -> 0.2575   acc: 42.25% -> 92.14%            
client [35] (test)  loss: 0.4877 -> 0.3292   acc: 80.41% -> 88.81%             
client [59] (test)  loss: 0.4349 -> 0.2339   acc: 84.86% -> 91.43%             
client [31] (test)  loss: 0.6170 -> 0.5164   acc: 74.16% -> 78.73%             
client [9] (test)  loss: 0.5306 -> 0.3865   acc: 79.85% -> 84.38%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7760 -> 0.4148   acc: 72.52% -> 84.99%             
client [33] (test)  loss: 0.4322 -> 0.3430   acc: 85.41% -> 86.76%             
client [16] (test)  loss: 0.3058 -> 0.1659   acc: 90.58% -> 93.98%             
client [44] (test)  loss: 1.0713 -> 0.2893   acc: 67.18% -> 90.53%             
client [8] (test)  loss: 0.3775 -> 0.3690   acc: 88.06% -> 85.16%              
client [31] (test)  loss: 0.6374 -> 0.5011   acc: 75.55% -> 80.52%             
client [47] (test)  loss: 0.6259 -> 0.4294   acc: 75.66% -> 83.90%             
client [36] (test)  loss: 0.4654 -> 0.3892   acc: 83.74% -> 86.20%             
client [20] (test)  loss: 0.5375 -> 0.5214   acc: 82.80% -> 81.85%             
client [56] (test)  loss: 0.4402 -> 0.4870   acc: 84.38% -> 84.69%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6936 -> 0.5416   acc: 76.03% -> 77.58%              
client [60] (test)  loss: 0.4111 -> 0.2056   acc: 86.39% -> 95.05%             
client [28] (test)  loss: 0.6773 -> 0.5891   acc: 79.26% -> 81.11%             
client [25] (test)  loss: 0.6873 -> 0.4119   acc: 75.73% -> 86.54%             
client [58] (test)  loss: 0.3372 -> 0.2104   acc: 89.53% -> 92.41%             
client [44] (test)  loss: 0.3900 -> 0.2633   acc: 85.24% -> 90.97%             
client [39] (test)  loss: 0.6829 -> 0.3480   acc: 75.75% -> 86.92%             
client [29] (test)  loss: 0.8164 -> 0.4795   acc: 70.36% -> 84.43%             
client [3] (test)  loss: 0.5262 -> 0.3518   acc: 81.27% -> 87.88%              
client [84] (test)  loss: 0.6387 -> 0.3293   acc: 77.10% -> 87.83%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4883 -> 0.3291   acc: 85.00% -> 88.33%             
client [84] (test)  loss: 0.6026 -> 0.3244   acc: 79.42% -> 88.41%             
client [10] (test)  loss: 0.5475 -> 0.2937   acc: 82.50% -> 90.28%             
client [36] (test)  loss: 0.5209 -> 0.3668   acc: 80.06% -> 85.89%             
client [65] (test)  loss: 0.2873 -> 0.2921   acc: 90.85% -> 90.18%             
client [81] (test)  loss: 0.5440 -> 0.4740   acc: 77.87% -> 81.79%             
client [79] (test)  loss: 0.7627 -> 0.5553   acc: 75.41% -> 76.24%             
client [42] (test)  loss: 0.8766 -> 0.3615   acc: 64.65% -> 88.37%             
client [11] (test)  loss: 0.4674 -> 0.4235   acc: 83.33% -> 86.96%             
client [96] (test)  loss: 0.4490 -> 0.2795   acc: 84.21% -> 89.47%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3730 -> 0.3773   acc: 88.06% -> 87.10%              
client [53] (test)  loss: 0.3978 -> 0.1745   acc: 84.87% -> 95.18%             
client [52] (test)  loss: 0.6174 -> 0.4270   acc: 77.84% -> 85.04%             
client [42] (test)  loss: 0.5586 -> 0.3471   acc: 79.07% -> 89.77%             
client [69] (test)  loss: 0.3474 -> 0.2607   acc: 87.27% -> 91.43%             
client [59] (test)  loss: 0.4399 -> 0.2004   acc: 85.71% -> 93.14%             
client [7] (test)  loss: 0.4161 -> 0.4373   acc: 85.28% -> 86.67%              
client [26] (test)  loss: 0.2585 -> 0.2499   acc: 90.53% -> 91.23%             
client [49] (test)  loss: 0.4367 -> 0.4478   acc: 84.96% -> 84.01%             
client [98] (test)  loss: 0.4848 -> 0.4488   acc: 83.61% -> 83.06%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6040 -> 0.4371   acc: 78.33% -> 83.89%             
client [47] (test)  loss: 0.6081 -> 0.4108   acc: 77.53% -> 86.14%             
client [21] (test)  loss: 0.3710 -> 0.3319   acc: 87.50% -> 90.28%             
client [77] (test)  loss: 0.3796 -> 0.3113   acc: 86.07% -> 86.07%             
client [95] (test)  loss: 0.5183 -> 0.2889   acc: 84.51% -> 89.58%             
client [91] (test)  loss: 0.5795 -> 0.3852   acc: 79.74% -> 86.58%             
client [14] (test)  loss: 0.4064 -> 0.2932   acc: 86.40% -> 88.16%             
client [99] (test)  loss: 0.3312 -> 0.2425   acc: 88.14% -> 93.22%             
client [20] (test)  loss: 0.5026 -> 0.4656   acc: 83.12% -> 84.39%             
client [39] (test)  loss: 0.7407 -> 0.3964   acc: 71.66% -> 85.29%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6474 -> 0.4324   acc: 77.29% -> 85.04%             
client [62] (test)  loss: 0.4669 -> 0.4209   acc: 85.32% -> 86.85%             
client [71] (test)  loss: 0.3722 -> 0.2483   acc: 87.29% -> 92.09%             
client [97] (test)  loss: 0.5530 -> 0.3608   acc: 80.22% -> 87.31%             
client [30] (test)  loss: 0.3651 -> 0.2761   acc: 84.80% -> 90.88%             
client [88] (test)  loss: 0.6154 -> 0.4533   acc: 78.51% -> 82.64%             
client [60] (test)  loss: 0.3373 -> 0.2280   acc: 91.34% -> 95.05%             
client [82] (test)  loss: 0.3941 -> 0.2910   acc: 87.81% -> 90.55%             
client [91] (test)  loss: 0.5303 -> 0.4005   acc: 79.21% -> 86.05%             
client [57] (test)  loss: 0.3732 -> 0.3240   acc: 88.45% -> 90.97%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7158 -> 0.5386   acc: 76.34% -> 80.32%             
client [15] (test)  loss: 0.3772 -> 0.3234   acc: 89.75% -> 88.64%             
client [71] (test)  loss: 0.3877 -> 0.2534   acc: 87.01% -> 91.53%             
client [97] (test)  loss: 0.5839 -> 0.3748   acc: 80.97% -> 87.31%             
client [53] (test)  loss: 0.4534 -> 0.1816   acc: 83.99% -> 95.18%             
client [77] (test)  loss: 0.3371 -> 0.3086   acc: 88.21% -> 87.50%             
client [76] (test)  loss: 0.4665 -> 0.2702   acc: 85.01% -> 91.86%             
client [79] (test)  loss: 0.8502 -> 0.5314   acc: 72.65% -> 79.56%             
client [28] (test)  loss: 0.6736 -> 0.6583   acc: 83.87% -> 81.57%             
client [99] (test)  loss: 0.3243 -> 0.2502   acc: 88.70% -> 92.66%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5169 -> 0.3588   acc: 82.84% -> 88.81%             
client [86] (test)  loss: 0.2199 -> 0.1485   acc: 91.40% -> 95.12%             
client [34] (test)  loss: 0.4391 -> 0.4063   acc: 83.97% -> 86.14%             
client [73] (test)  loss: 0.4127 -> 0.2917   acc: 85.37% -> 89.85%             
client [5] (test)  loss: 0.5271 -> 0.3812   acc: 81.99% -> 88.89%              
client [96] (test)  loss: 0.2791 -> 0.2594   acc: 90.30% -> 91.69%             
client [22] (test)  loss: 0.4669 -> 0.4296   acc: 85.48% -> 87.42%             
client [60] (test)  loss: 0.3522 -> 0.2503   acc: 88.37% -> 94.31%             
client [66] (test)  loss: 0.5835 -> 0.4754   acc: 81.85% -> 86.67%             
client [83] (test)  loss: 0.2973 -> 0.2098   acc: 94.07% -> 95.10%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4660 -> 0.2678   acc: 86.08% -> 92.51%             
client [65] (test)  loss: 0.2851 -> 0.2878   acc: 90.40% -> 90.85%             
client [95] (test)  loss: 0.5069 -> 0.2851   acc: 82.82% -> 90.99%             
client [17] (test)  loss: 0.3610 -> 0.2836   acc: 90.05% -> 93.19%             
client [8] (test)  loss: 0.3225 -> 0.4244   acc: 90.65% -> 84.52%              
client [35] (test)  loss: 0.5131 -> 0.3680   acc: 80.60% -> 89.18%             
client [98] (test)  loss: 0.4977 -> 0.4722   acc: 83.06% -> 85.00%             
client [53] (test)  loss: 0.3594 -> 0.1918   acc: 86.62% -> 94.30%             
client [43] (test)  loss: 0.3135 -> 0.1891   acc: 91.94% -> 97.31%             
client [64] (test)  loss: 0.7433 -> 0.4822   acc: 78.75% -> 86.40%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4158 -> 0.3627   acc: 87.78% -> 91.11%             
client [88] (test)  loss: 0.7504 -> 0.4866   acc: 76.03% -> 83.75%             
client [38] (test)  loss: 0.3917 -> 0.3418   acc: 88.05% -> 90.88%             
client [3] (test)  loss: 0.6716 -> 0.3210   acc: 78.79% -> 90.36%              
client [5] (test)  loss: 0.4884 -> 0.3409   acc: 82.76% -> 88.51%              
client [41] (test)  loss: 0.5571 -> 0.5371   acc: 78.60% -> 79.70%             
client [7] (test)  loss: 0.4766 -> 0.4703   acc: 85.28% -> 85.56%              
client [37] (test)  loss: 0.4375 -> 0.2322   acc: 84.92% -> 92.18%             
client [45] (test)  loss: 0.7810 -> 0.2820   acc: 75.92% -> 90.05%             
client [47] (test)  loss: 0.5182 -> 0.4436   acc: 82.40% -> 85.77%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4872 -> 0.2004   acc: 85.34% -> 94.24%             
client [11] (test)  loss: 0.5389 -> 0.4065   acc: 84.42% -> 86.59%             
client [37] (test)  loss: 0.4178 -> 0.2368   acc: 85.75% -> 91.06%             
client [41] (test)  loss: 0.7427 -> 0.5161   acc: 72.69% -> 80.44%             
client [95] (test)  loss: 0.4776 -> 0.3018   acc: 84.79% -> 89.58%             
client [53] (test)  loss: 0.4689 -> 0.2017   acc: 85.09% -> 94.30%             
client [22] (test)  loss: 0.4834 -> 0.4394   acc: 84.52% -> 87.74%             
client [25] (test)  loss: 0.9730 -> 0.4530   acc: 73.35% -> 85.49%             
client [69] (test)  loss: 0.3902 -> 0.2747   acc: 88.05% -> 91.95%             
client [46] (test)  loss: 0.4427 -> 0.3710   acc: 86.30% -> 89.50%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3593 -> 0.4543   acc: 86.89% -> 86.52%             
client [69] (test)  loss: 0.3428 -> 0.2817   acc: 89.35% -> 91.69%             
client [82] (test)  loss: 0.3315 -> 0.2794   acc: 89.30% -> 91.29%             
client [45] (test)  loss: 0.5734 -> 0.2873   acc: 81.94% -> 90.05%             
client [7] (test)  loss: 0.4057 -> 0.5077   acc: 86.67% -> 83.89%              
client [50] (test)  loss: 0.6148 -> 0.5540   acc: 81.51% -> 80.11%             
client [35] (test)  loss: 0.3850 -> 0.3702   acc: 86.75% -> 89.18%             
client [24] (test)  loss: 0.5574 -> 0.2813   acc: 80.10% -> 91.18%             
client [15] (test)  loss: 0.5067 -> 0.3082   acc: 86.70% -> 89.75%             
client [58] (test)  loss: 0.2228 -> 0.2214   acc: 93.46% -> 92.93%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3731 -> 0.2129   acc: 87.93% -> 92.91%             
client [76] (test)  loss: 0.5587 -> 0.2571   acc: 85.01% -> 92.08%             
client [67] (test)  loss: 0.3809 -> 0.3086   acc: 89.42% -> 92.44%             
client [37] (test)  loss: 0.3952 -> 0.2397   acc: 87.71% -> 91.62%             
client [58] (test)  loss: 0.2917 -> 0.2201   acc: 91.10% -> 92.93%             
client [64] (test)  loss: 0.6806 -> 0.5102   acc: 81.59% -> 87.82%             
client [77] (test)  loss: 0.4569 -> 0.3365   acc: 86.07% -> 87.50%             
client [55] (test)  loss: 0.6033 -> 0.4678   acc: 82.58% -> 87.28%             
client [12] (test)  loss: 0.6200 -> 0.4666   acc: 79.09% -> 82.27%             
client [89] (test)  loss: 0.7290 -> 0.3719   acc: 81.35% -> 89.39%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4609 -> 0.3253   acc: 85.51% -> 91.01%             
client [51] (test)  loss: 0.3363 -> 0.3030   acc: 87.69% -> 88.89%             
client [8] (test)  loss: 0.3809 -> 0.3596   acc: 88.06% -> 88.39%              
client [18] (test)  loss: 0.2936 -> 0.3125   acc: 92.10% -> 93.01%             
client [94] (test)  loss: 0.5074 -> 0.5442   acc: 83.88% -> 85.74%             
client [81] (test)  loss: 0.4872 -> 0.5490   acc: 82.63% -> 79.83%             
client [3] (test)  loss: 0.6479 -> 0.3372   acc: 79.61% -> 88.98%              
client [11] (test)  loss: 0.4678 -> 0.4119   acc: 85.87% -> 89.13%             
client [95] (test)  loss: 0.4919 -> 0.3225   acc: 84.51% -> 89.86%             
client [67] (test)  loss: 0.4227 -> 0.3252   acc: 87.66% -> 91.69%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4126 -> 0.3506   acc: 88.89% -> 90.28%             
client [79] (test)  loss: 0.7304 -> 0.5230   acc: 78.73% -> 84.53%             
client [58] (test)  loss: 0.2645 -> 0.2114   acc: 91.88% -> 92.67%             
client [88] (test)  loss: 0.9363 -> 0.5257   acc: 76.03% -> 83.47%             
client [46] (test)  loss: 0.4607 -> 0.3842   acc: 88.92% -> 88.92%             
client [11] (test)  loss: 0.4702 -> 0.4109   acc: 87.32% -> 89.86%             
client [55] (test)  loss: 0.7427 -> 0.5122   acc: 81.02% -> 87.48%             
client [13] (test)  loss: 0.3010 -> 0.2529   acc: 91.34% -> 91.60%             
client [31] (test)  loss: 1.0385 -> 0.5485   acc: 71.37% -> 80.72%             
client [75] (test)  loss: 0.4112 -> 0.2539   acc: 84.66% -> 89.57%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2934 -> 0.1472   acc: 91.72% -> 95.52%             
client [7] (test)  loss: 0.6260 -> 0.4946   acc: 79.72% -> 85.56%              
client [57] (test)  loss: 0.3996 -> 0.3212   acc: 89.89% -> 93.14%             
client [13] (test)  loss: 0.3241 -> 0.2525   acc: 89.76% -> 90.81%             
client [43] (test)  loss: 0.4054 -> 0.2164   acc: 90.32% -> 95.70%             
client [91] (test)  loss: 0.5538 -> 0.4079   acc: 81.32% -> 87.89%             
client [10] (test)  loss: 0.3321 -> 0.3157   acc: 91.11% -> 91.67%             
client [64] (test)  loss: 0.6169 -> 0.5355   acc: 84.14% -> 84.42%             
client [82] (test)  loss: 0.4346 -> 0.2744   acc: 88.06% -> 91.79%             
client [22] (test)  loss: 0.5432 -> 0.4665   acc: 84.84% -> 88.06%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6867 -> 0.4807   acc: 79.62% -> 84.71%             
client [23] (test)  loss: 0.6938 -> 0.3244   acc: 81.95% -> 94.06%             
client [88] (test)  loss: 0.7355 -> 0.5009   acc: 79.61% -> 83.47%             
client [98] (test)  loss: 0.4591 -> 0.4817   acc: 85.56% -> 86.94%             
client [79] (test)  loss: 0.7197 -> 0.5418   acc: 79.01% -> 84.81%             
client [21] (test)  loss: 0.3766 -> 0.3692   acc: 88.33% -> 90.56%             
client [92] (test)  loss: 0.5945 -> 0.5073   acc: 80.86% -> 83.56%             
client [56] (test)  loss: 0.4286 -> 0.4227   acc: 86.25% -> 87.50%             
client [5] (test)  loss: 0.5117 -> 0.3448   acc: 81.23% -> 88.12%              
client [52] (test)  loss: 0.6588 -> 0.5018   acc: 78.67% -> 84.21%             
==================== FedDyn_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.4817 -> 0.0000', 'accuracy': '84.08% -> 0.00%'},          
    200: {'loss': '0.5213 -> 0.0000', 'accuracy': '84.13% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn_1 achieved 10.0%(16.40%) at epoch: 1                                    
FedDyn_1 achieved 20.0%(20.04%) at epoch: 2                                    
FedDyn_1 achieved 30.0%(32.80%) at epoch: 3                                    
FedDyn_1 achieved 40.0%(45.47%) at epoch: 4                                    
FedDyn_1 achieved 70.0%(70.23%) at epoch: 7                                    
FedDyn_1 achieved 80.0%(80.32%) at epoch: 28                                   
Convergence (test_after):                                                      
FedDyn_1 achieved 50.0%(53.09%) at epoch: 0                                    
FedDyn_1 achieved 70.0%(71.16%) at epoch: 2                                    
FedDyn_1 achieved 80.0%(81.17%) at epoch: 8                                    
FedDyn_1 achieved 90.0%(91.26%) at epoch: 56                                   
