==================== ALGORITHM: FedDyn_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1702 -> 4.9620   acc: 2.52% -> 4.86%               
client [81] (test)  loss: 5.1874 -> 4.9457   acc: 2.58% -> 4.43%               
client [21] (test)  loss: 5.2408 -> 4.8899   acc: 1.45% -> 4.54%               
client [68] (test)  loss: 5.1019 -> 4.7668   acc: 1.99% -> 7.05%               
client [93] (test)  loss: 5.0941 -> 4.9166   acc: 2.36% -> 3.81%               
client [31] (test)  loss: 5.1500 -> 5.0006   acc: 2.70% -> 5.05%               
client [20] (test)  loss: 5.2296 -> 4.8376   acc: 2.08% -> 8.70%               
client [59] (test)  loss: 5.2571 -> 4.8318   acc: 2.73% -> 2.91%               
client [48] (test)  loss: 5.1509 -> 4.8820   acc: 2.15% -> 3.76%               
client [34] (test)  loss: 5.1179 -> 4.9660   acc: 1.64% -> 3.09%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.1747 -> 4.5721   acc: 2.41% -> 8.52%               
client [99] (test)  loss: 5.6793 -> 4.7214   acc: 2.71% -> 5.05%               
client [67] (test)  loss: 4.8918 -> 4.5828   acc: 5.22% -> 10.07%              
client [0] (test)  loss: 4.7033 -> 4.6146   acc: 6.16% -> 9.78%                
client [76] (test)  loss: 4.7827 -> 4.3529   acc: 5.63% -> 9.44%               
client [41] (test)  loss: 5.3530 -> 4.6238   acc: 1.63% -> 5.80%               
client [62] (test)  loss: 5.1531 -> 4.7310   acc: 1.26% -> 5.75%               
client [2] (test)  loss: 5.1848 -> 4.7943   acc: 2.50% -> 6.91%                
client [14] (test)  loss: 4.6893 -> 4.7802   acc: 7.58% -> 7.40%               
client [46] (test)  loss: 5.0942 -> 4.5819   acc: 3.63% -> 6.17%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7273 -> 4.2727   acc: 8.73% -> 13.90%              
client [68] (test)  loss: 4.5617 -> 4.3548   acc: 6.87% -> 12.30%              
client [57] (test)  loss: 4.5461 -> 4.5057   acc: 7.44% -> 12.52%              
client [17] (test)  loss: 6.4503 -> 4.4740   acc: 3.96% -> 8.47%               
client [54] (test)  loss: 4.5871 -> 4.4030   acc: 6.90% -> 10.53%              
client [23] (test)  loss: 5.1126 -> 4.6772   acc: 1.63% -> 5.79%               
client [35] (test)  loss: 4.6748 -> 4.3000   acc: 7.26% -> 13.25%              
client [59] (test)  loss: 4.5164 -> 4.3628   acc: 6.55% -> 9.45%               
client [31] (test)  loss: 4.5388 -> 4.7134   acc: 7.57% -> 8.11%               
client [9] (test)  loss: 4.6809 -> 4.6325   acc: 6.87% -> 7.23%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6169 -> 4.4745   acc: 8.18% -> 11.34%              
client [33] (test)  loss: 4.4335 -> 4.5275   acc: 8.88% -> 8.51%               
client [16] (test)  loss: 4.3822 -> 4.2922   acc: 9.16% -> 11.49%              
client [44] (test)  loss: 10.7364 -> 4.4102   acc: 2.84% -> 11.90%             
client [8] (test)  loss: 4.6568 -> 4.5364   acc: 6.68% -> 9.39%                
client [31] (test)  loss: 4.5813 -> 4.7094   acc: 5.95% -> 8.47%               
client [47] (test)  loss: 4.7470 -> 4.3668   acc: 7.22% -> 11.19%              
client [36] (test)  loss: 4.5762 -> 4.3384   acc: 7.45% -> 10.00%              
client [20] (test)  loss: 4.6915 -> 4.1728   acc: 7.75% -> 13.61%              
client [56] (test)  loss: 4.6033 -> 4.3612   acc: 10.83% -> 10.47%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4509 -> 4.3998   acc: 9.62% -> 9.62%                
client [60] (test)  loss: 5.1366 -> 4.2558   acc: 9.89% -> 13.85%              
client [28] (test)  loss: 5.1232 -> 4.6245   acc: 9.98% -> 8.17%               
client [25] (test)  loss: 5.5662 -> 4.2641   acc: 7.75% -> 12.43%              
client [58] (test)  loss: 4.4954 -> 4.4252   acc: 10.81% -> 11.71%             
client [44] (test)  loss: 4.3206 -> 4.3900   acc: 11.37% -> 12.26%             
client [39] (test)  loss: 4.2913 -> 4.2546   acc: 13.45% -> 12.91%             
client [29] (test)  loss: 5.1065 -> 4.2242   acc: 6.65% -> 12.78%              
client [3] (test)  loss: 4.7976 -> 4.2675   acc: 6.98% -> 15.56%               
client [84] (test)  loss: 4.4279 -> 4.2709   acc: 13.41% -> 13.59%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.9201 -> 4.4275   acc: 10.16% -> 12.89%             
client [84] (test)  loss: 4.3041 -> 4.3215   acc: 12.68% -> 15.04%             
client [10] (test)  loss: 4.9740 -> 4.3460   acc: 9.89% -> 13.85%              
client [36] (test)  loss: 4.4718 -> 4.2765   acc: 7.82% -> 14.36%              
client [65] (test)  loss: 4.3277 -> 4.5272   acc: 12.16% -> 10.16%             
client [81] (test)  loss: 4.7238 -> 4.2589   acc: 9.23% -> 12.92%              
client [79] (test)  loss: 4.4715 -> 4.4409   acc: 10.30% -> 8.17%              
client [42] (test)  loss: 4.5889 -> 4.5019   acc: 10.75% -> 14.15%             
client [11] (test)  loss: 4.6465 -> 4.2861   acc: 7.73% -> 13.13%              
client [96] (test)  loss: 4.4639 -> 4.1094   acc: 10.81% -> 15.50%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.5155 -> 4.6358   acc: 11.01% -> 10.83%              
client [53] (test)  loss: 4.6108 -> 4.5867   acc: 8.11% -> 10.05%              
client [52] (test)  loss: 4.4928 -> 4.5926   acc: 11.59% -> 12.32%             
client [42] (test)  loss: 4.4776 -> 4.6147   acc: 12.08% -> 14.15%             
client [69] (test)  loss: 4.4160 -> 4.3855   acc: 12.04% -> 14.81%             
client [59] (test)  loss: 4.3773 -> 4.2844   acc: 10.55% -> 13.09%             
client [7] (test)  loss: 5.0429 -> 4.4534   acc: 7.97% -> 12.32%               
client [26] (test)  loss: 4.5082 -> 4.3478   acc: 9.89% -> 11.69%              
client [49] (test)  loss: 4.4082 -> 4.5944   acc: 10.29% -> 11.01%             
client [98] (test)  loss: 4.3124 -> 4.4567   acc: 10.91% -> 12.18%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.4270 -> 4.5619   acc: 11.27% -> 11.27%             
client [47] (test)  loss: 4.9571 -> 4.5809   acc: 10.65% -> 12.64%             
client [21] (test)  loss: 4.3790 -> 4.6400   acc: 9.80% -> 11.80%              
client [77] (test)  loss: 4.3285 -> 4.5391   acc: 11.15% -> 10.43%             
client [95] (test)  loss: 4.4902 -> 4.6122   acc: 10.13% -> 12.01%             
client [91] (test)  loss: 4.6957 -> 4.8651   acc: 11.82% -> 11.09%             
client [14] (test)  loss: 4.3475 -> 4.6223   acc: 9.75% -> 11.55%              
client [99] (test)  loss: 4.4141 -> 4.7888   acc: 12.64% -> 10.11%             
client [20] (test)  loss: 4.6012 -> 4.2048   acc: 10.21% -> 19.09%             
client [39] (test)  loss: 4.4852 -> 4.2916   acc: 12.55% -> 14.18%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.7072 -> 4.6916   acc: 10.69% -> 12.14%             
client [62] (test)  loss: 4.5408 -> 4.7965   acc: 10.77% -> 11.49%             
client [71] (test)  loss: 4.5033 -> 4.6516   acc: 11.65% -> 11.11%             
client [97] (test)  loss: 4.6434 -> 4.7593   acc: 12.00% -> 11.09%             
client [30] (test)  loss: 4.3307 -> 4.7767   acc: 13.59% -> 9.24%              
client [88] (test)  loss: 4.6068 -> 4.4780   acc: 11.57% -> 16.82%             
client [60] (test)  loss: 4.7782 -> 4.5448   acc: 9.53% -> 14.39%              
client [82] (test)  loss: 4.4983 -> 4.4967   acc: 13.39% -> 16.61%             
client [91] (test)  loss: 4.7159 -> 4.9832   acc: 9.64% -> 11.82%              
client [57] (test)  loss: 4.3614 -> 4.5863   acc: 12.16% -> 14.34%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.0057 -> 5.1580   acc: 8.65% -> 12.25%              
client [15] (test)  loss: 4.8992 -> 4.9238   acc: 9.69% -> 9.69%               
client [71] (test)  loss: 4.6078 -> 4.7192   acc: 10.04% -> 11.29%             
client [97] (test)  loss: 4.6040 -> 4.9081   acc: 13.45% -> 11.45%             
client [53] (test)  loss: 4.9483 -> 5.0285   acc: 7.41% -> 10.05%              
client [77] (test)  loss: 4.5751 -> 4.7891   acc: 11.33% -> 10.43%             
client [76] (test)  loss: 4.5188 -> 4.5849   acc: 12.89% -> 15.43%             
client [79] (test)  loss: 4.6027 -> 4.7985   acc: 12.43% -> 10.12%             
client [28] (test)  loss: 4.5231 -> 5.2224   acc: 11.25% -> 9.44%              
client [99] (test)  loss: 4.6358 -> 5.1411   acc: 11.55% -> 10.65%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.6120 -> 5.0288   acc: 13.45% -> 11.27%             
client [86] (test)  loss: 4.6014 -> 5.0321   acc: 10.53% -> 11.43%             
client [34] (test)  loss: 4.8499 -> 4.8673   acc: 9.64% -> 13.82%              
client [73] (test)  loss: 4.6145 -> 4.9399   acc: 11.99% -> 11.59%             
client [5] (test)  loss: 4.8485 -> 4.9795   acc: 9.61% -> 9.43%                
client [96] (test)  loss: 4.3565 -> 4.4555   acc: 13.15% -> 16.76%             
client [22] (test)  loss: 4.5895 -> 4.5628   acc: 10.49% -> 13.38%             
client [60] (test)  loss: 4.9560 -> 4.8363   acc: 9.89% -> 14.93%              
client [66] (test)  loss: 4.9350 -> 4.8964   acc: 11.01% -> 13.90%             
client [83] (test)  loss: 5.0265 -> 5.0995   acc: 11.57% -> 11.75%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.6760 -> 5.0240   acc: 13.97% -> 14.34%             
client [65] (test)  loss: 4.7940 -> 5.1408   acc: 11.43% -> 10.16%             
client [95] (test)  loss: 4.9911 -> 5.0831   acc: 10.32% -> 12.57%             
client [17] (test)  loss: 5.1577 -> 5.0319   acc: 9.91% -> 10.99%              
client [8] (test)  loss: 5.0770 -> 5.3506   acc: 11.37% -> 10.29%              
client [35] (test)  loss: 4.9309 -> 4.9235   acc: 11.25% -> 13.97%             
client [98] (test)  loss: 4.7569 -> 4.8865   acc: 10.91% -> 12.36%             
client [53] (test)  loss: 4.9484 -> 5.3221   acc: 8.29% -> 9.88%               
client [43] (test)  loss: 4.8114 -> 4.8859   acc: 11.05% -> 10.51%             
client [64] (test)  loss: 5.0186 -> 5.1442   acc: 9.29% -> 11.90%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.1168 -> 5.2043   acc: 10.53% -> 12.16%             
client [88] (test)  loss: 5.0104 -> 5.1531   acc: 7.78% -> 13.74%              
client [38] (test)  loss: 5.1449 -> 5.2540   acc: 9.07% -> 10.00%              
client [3] (test)  loss: 5.5332 -> 5.2809   acc: 8.23% -> 14.31%               
client [5] (test)  loss: 5.0271 -> 5.2983   acc: 10.68% -> 9.61%               
client [41] (test)  loss: 4.8513 -> 5.1369   acc: 9.42% -> 9.06%               
client [7] (test)  loss: 4.9965 -> 5.1486   acc: 10.69% -> 11.96%              
client [37] (test)  loss: 4.7692 -> 5.1011   acc: 12.07% -> 11.35%             
client [45] (test)  loss: 5.0097 -> 4.8181   acc: 10.55% -> 12.18%             
client [47] (test)  loss: 5.3465 -> 5.1360   acc: 10.65% -> 14.44%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.2424 -> 5.3588   acc: 11.85% -> 13.82%             
client [11] (test)  loss: 5.0054 -> 5.2396   acc: 10.43% -> 12.05%             
client [37] (test)  loss: 4.8792 -> 5.2367   acc: 12.97% -> 10.81%             
client [41] (test)  loss: 4.9928 -> 5.3127   acc: 9.06% -> 9.78%               
client [95] (test)  loss: 5.1923 -> 5.4332   acc: 9.38% -> 11.82%              
client [53] (test)  loss: 5.6061 -> 5.4953   acc: 7.76% -> 10.58%              
client [22] (test)  loss: 4.9325 -> 5.0053   acc: 11.39% -> 14.65%             
client [25] (test)  loss: 5.1717 -> 5.1791   acc: 9.91% -> 11.35%              
client [69] (test)  loss: 5.3044 -> 5.2769   acc: 8.15% -> 11.48%              
client [46] (test)  loss: 5.2038 -> 5.2773   acc: 11.07% -> 11.62%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.1177 -> 5.3551   acc: 10.11% -> 14.08%             
client [69] (test)  loss: 5.5758 -> 5.5390   acc: 8.33% -> 10.93%              
client [82] (test)  loss: 5.0280 -> 5.2389   acc: 12.14% -> 16.07%             
client [45] (test)  loss: 4.8669 -> 5.1569   acc: 14.00% -> 15.27%             
client [7] (test)  loss: 5.2092 -> 5.4004   acc: 10.51% -> 13.04%              
client [50] (test)  loss: 5.3034 -> 5.5816   acc: 9.78% -> 12.14%              
client [35] (test)  loss: 5.0032 -> 5.2885   acc: 13.79% -> 13.61%             
client [24] (test)  loss: 5.5544 -> 5.7696   acc: 8.91% -> 17.65%              
client [15] (test)  loss: 5.4745 -> 5.3832   acc: 9.87% -> 10.05%              
client [58] (test)  loss: 5.1198 -> 5.6019   acc: 11.53% -> 12.43%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.0440 -> 5.3492   acc: 13.62% -> 13.62%             
client [76] (test)  loss: 5.2064 -> 5.5475   acc: 14.16% -> 15.79%             
client [67] (test)  loss: 5.2737 -> 5.5164   acc: 10.26% -> 14.74%             
client [37] (test)  loss: 5.2637 -> 5.5626   acc: 10.81% -> 10.99%             
client [58] (test)  loss: 5.4303 -> 5.6821   acc: 11.35% -> 11.17%             
client [64] (test)  loss: 5.5767 -> 5.6942   acc: 9.85% -> 10.41%              
client [77] (test)  loss: 5.0767 -> 5.6458   acc: 9.35% -> 10.61%              
client [55] (test)  loss: 5.3685 -> 5.6607   acc: 11.09% -> 13.06%             
client [12] (test)  loss: 5.6344 -> 5.6871   acc: 6.09% -> 10.39%              
client [89] (test)  loss: 5.1128 -> 5.0273   acc: 12.01% -> 16.13%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.4104 -> 5.6220   acc: 13.22% -> 14.67%             
client [51] (test)  loss: 5.3357 -> 5.9087   acc: 11.89% -> 13.69%             
client [8] (test)  loss: 5.5762 -> 5.9900   acc: 11.55% -> 12.09%              
client [18] (test)  loss: 5.1258 -> 6.1420   acc: 13.42% -> 12.52%             
client [94] (test)  loss: 5.5743 -> 5.9008   acc: 8.68% -> 10.67%              
client [81] (test)  loss: 5.6167 -> 5.9176   acc: 8.86% -> 7.38%               
client [3] (test)  loss: 5.9178 -> 5.7862   acc: 7.87% -> 13.42%               
client [11] (test)  loss: 5.3541 -> 5.6435   acc: 10.07% -> 14.03%             
client [95] (test)  loss: 5.5872 -> 5.7389   acc: 9.76% -> 12.95%              
client [67] (test)  loss: 5.4747 -> 5.7058   acc: 11.38% -> 13.62%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.8847 -> 6.0617   acc: 9.62% -> 10.34%              
client [79] (test)  loss: 5.5213 -> 5.8468   acc: 10.30% -> 10.66%             
client [58] (test)  loss: 5.6845 -> 6.0309   acc: 11.53% -> 11.89%             
client [88] (test)  loss: 5.8272 -> 5.7285   acc: 7.41% -> 11.03%              
client [46] (test)  loss: 5.7087 -> 5.7902   acc: 11.98% -> 12.52%             
client [11] (test)  loss: 5.5020 -> 5.7435   acc: 10.07% -> 14.21%             
client [55] (test)  loss: 5.6246 -> 5.8547   acc: 11.09% -> 11.45%             
client [13] (test)  loss: 5.8116 -> 5.8638   acc: 10.33% -> 11.59%             
client [31] (test)  loss: 6.0057 -> 6.1888   acc: 9.01% -> 12.07%              
client [75] (test)  loss: 5.4280 -> 5.7824   acc: 10.47% -> 14.80%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.7845 -> 6.0186   acc: 11.48% -> 10.45%             
client [7] (test)  loss: 5.4209 -> 6.1750   acc: 10.87% -> 11.96%              
client [57] (test)  loss: 5.6293 -> 5.8231   acc: 10.71% -> 12.70%             
client [13] (test)  loss: 5.7569 -> 5.8997   acc: 9.60% -> 12.14%              
client [43] (test)  loss: 5.7571 -> 5.8573   acc: 10.14% -> 9.60%              
client [91] (test)  loss: 6.2791 -> 6.9463   acc: 7.82% -> 10.91%              
client [10] (test)  loss: 5.7810 -> 5.9555   acc: 10.61% -> 13.13%             
client [64] (test)  loss: 5.7589 -> 6.1459   acc: 12.08% -> 10.41%             
client [82] (test)  loss: 5.5856 -> 5.6431   acc: 11.79% -> 15.36%             
client [22] (test)  loss: 5.5883 -> 5.6208   acc: 8.68% -> 13.74%              
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.8203 -> 5.6524   acc: 10.96% -> 15.69%             
client [23] (test)  loss: 6.2282 -> 6.7369   acc: 7.78% -> 7.59%               
client [88] (test)  loss: 6.0325 -> 6.2110   acc: 8.32% -> 11.03%              
client [98] (test)  loss: 5.6325 -> 6.2274   acc: 12.91% -> 12.00%             
client [79] (test)  loss: 5.6586 -> 6.0402   acc: 10.66% -> 10.66%             
client [21] (test)  loss: 5.8872 -> 6.2680   acc: 10.89% -> 12.89%             
client [92] (test)  loss: 5.9520 -> 5.8061   acc: 10.36% -> 13.57%             
client [56] (test)  loss: 5.9470 -> 5.9434   acc: 11.55% -> 15.16%             
client [5] (test)  loss: 6.1170 -> 6.3135   acc: 9.79% -> 9.61%                
client [52] (test)  loss: 5.8655 -> 6.8464   acc: 10.14% -> 11.05%             
==================== FedDyn_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '4.6490 -> 0.0000', 'accuracy': '11.19% -> 0.00%'},          
    200: {'loss': '5.9474 -> 0.0000', 'accuracy': '10.17% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn_1 achieved 10.0%(10.32%) at epoch: 54                                   
Convergence (test_after):                                                      
FedDyn_1 achieved 10.0%(10.16%) at epoch: 29                                   
