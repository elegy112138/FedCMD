==================== ALGORITHM: FedDyn_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5422 -> 4.3776   acc: 0.33% -> 6.25%               
client [81] (test)  loss: 4.5270 -> 4.3682   acc: 4.32% -> 7.31%               
client [21] (test)  loss: 52.5407 -> 4.4794   acc: 1.33% -> 1.99%              
client [68] (test)  loss: 4.5609 -> 4.3854   acc: 1.32% -> 5.96%               
client [93] (test)  loss: 4.5493 -> 4.4051   acc: 1.62% -> 6.82%               
client [31] (test)  loss: 4.6522 -> 4.4634   acc: 1.05% -> 5.57%               
client [20] (test)  loss: 4.6480 -> 4.4729   acc: 0.35% -> 4.17%               
client [59] (test)  loss: 48.6475 -> 4.3030   acc: 1.52% -> 7.29%              
client [48] (test)  loss: 4.5111 -> 4.4268   acc: 3.96% -> 3.63%               
client [34] (test)  loss: 4.5564 -> 4.3562   acc: 0.90% -> 10.51%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.5087 -> 3.8979   acc: 1.65% -> 12.54%              
client [99] (test)  loss: 4.4180 -> 4.6137   acc: 5.36% -> 4.73%               
client [67] (test)  loss: 4.3650 -> 3.9800   acc: 4.32% -> 9.30%               
client [0] (test)  loss: 4.4476 -> 4.1180   acc: 3.65% -> 8.31%                
client [76] (test)  loss: 4.4558 -> 4.1308   acc: 2.51% -> 6.45%               
client [41] (test)  loss: 4.5070 -> 3.9701   acc: 1.30% -> 7.82%               
client [62] (test)  loss: 136.1872 -> 4.0636   acc: 1.45% -> 11.59%            
client [2] (test)  loss: 131.6772 -> 3.9415   acc: 0.97% -> 7.44%              
client [14] (test)  loss: 4.4026 -> 4.1643   acc: 3.89% -> 8.48%               
client [46] (test)  loss: 4.4736 -> 4.5376   acc: 2.27% -> 6.17%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1172 -> 4.2635   acc: 11.15% -> 4.05%              
client [68] (test)  loss: 4.3602 -> 3.8822   acc: 5.30% -> 13.91%              
client [57] (test)  loss: 4.1807 -> 4.1303   acc: 5.88% -> 5.88%               
client [17] (test)  loss: 4.3296 -> 3.9657   acc: 5.16% -> 8.71%               
client [54] (test)  loss: 4.3214 -> 3.8581   acc: 6.79% -> 15.71%              
client [23] (test)  loss: 360.1825 -> 3.8854   acc: 0.33% -> 6.00%             
client [35] (test)  loss: 4.1280 -> 4.0611   acc: 4.92% -> 7.87%               
client [59] (test)  loss: 4.2244 -> 3.8585   acc: 5.47% -> 9.42%               
client [31] (test)  loss: 4.0934 -> 3.8404   acc: 7.32% -> 10.10%              
client [9] (test)  loss: 4.2332 -> 4.1046   acc: 6.62% -> 7.28%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.4451 -> 4.1465   acc: 3.63% -> 8.91%               
client [33] (test)  loss: 4.0132 -> 3.9086   acc: 8.79% -> 11.07%              
client [16] (test)  loss: 4.1342 -> 3.9695   acc: 7.67% -> 9.76%               
client [44] (test)  loss: 4.8534 -> 3.8635   acc: 1.97% -> 13.77%              
client [8] (test)  loss: 4.4288 -> 4.1145   acc: 3.38% -> 5.74%                
client [31] (test)  loss: 4.2481 -> 3.7818   acc: 5.23% -> 11.85%              
client [47] (test)  loss: 4.4826 -> 5.2099   acc: 3.93% -> 6.56%               
client [36] (test)  loss: 4.2096 -> 3.9264   acc: 8.31% -> 14.95%              
client [20] (test)  loss: 4.0366 -> 3.6266   acc: 7.29% -> 15.28%              
client [56] (test)  loss: 4.2937 -> 4.1837   acc: 4.47% -> 4.81%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0854 -> 5.4767   acc: 7.89% -> 6.25%                
client [60] (test)  loss: 5.6081 -> 3.7682   acc: 2.27% -> 12.01%              
client [28] (test)  loss: 5.0550 -> 3.6509   acc: 4.64% -> 14.57%              
client [25] (test)  loss: 5.3749 -> 4.1102   acc: 5.17% -> 12.41%              
client [58] (test)  loss: 4.2849 -> 3.5983   acc: 5.47% -> 17.19%              
client [44] (test)  loss: 4.4001 -> 3.8162   acc: 6.89% -> 14.10%              
client [39] (test)  loss: 3.6714 -> 3.6334   acc: 15.00% -> 14.67%             
client [29] (test)  loss: 4.5674 -> 3.7067   acc: 10.93% -> 15.56%             
client [3] (test)  loss: 4.0801 -> 4.0373   acc: 8.50% -> 10.78%               
client [84] (test)  loss: 4.1553 -> 3.9104   acc: 9.15% -> 9.15%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.8155 -> 3.7696   acc: 5.98% -> 11.63%              
client [84] (test)  loss: 3.9419 -> 4.3210   acc: 12.09% -> 8.50%              
client [10] (test)  loss: 4.9023 -> 4.1733   acc: 4.62% -> 9.57%               
client [36] (test)  loss: 3.7967 -> 4.0035   acc: 12.62% -> 15.61%             
client [65] (test)  loss: 4.3807 -> 3.8829   acc: 7.26% -> 8.91%               
client [81] (test)  loss: 3.9933 -> 3.5634   acc: 10.63% -> 14.95%             
client [79] (test)  loss: 4.3331 -> 4.0077   acc: 5.57% -> 9.84%               
client [42] (test)  loss: 4.2834 -> 3.6340   acc: 4.30% -> 18.21%              
client [11] (test)  loss: 4.5524 -> 3.6013   acc: 3.36% -> 12.75%              
client [96] (test)  loss: 5.3637 -> 3.6621   acc: 3.64% -> 10.18%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.3662 -> 3.9603   acc: 9.12% -> 11.15%               
client [53] (test)  loss: 3.8999 -> 3.6270   acc: 12.05% -> 15.96%             
client [52] (test)  loss: 4.3675 -> 3.6257   acc: 8.12% -> 20.78%              
client [42] (test)  loss: 4.0902 -> 3.5744   acc: 7.62% -> 17.55%              
client [69] (test)  loss: 3.9804 -> 3.5253   acc: 11.88% -> 17.16%             
client [59] (test)  loss: 4.2154 -> 3.7463   acc: 9.42% -> 11.25%              
client [7] (test)  loss: 5.3882 -> 3.4937   acc: 6.21% -> 16.01%               
client [26] (test)  loss: 3.8378 -> 3.5958   acc: 12.25% -> 18.21%             
client [49] (test)  loss: 3.6673 -> 3.7016   acc: 12.46% -> 15.08%             
client [98] (test)  loss: 3.7808 -> 3.8294   acc: 11.97% -> 12.94%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.2339 -> 3.4802   acc: 10.68% -> 20.71%             
client [47] (test)  loss: 4.5438 -> 3.8691   acc: 9.18% -> 13.44%              
client [21] (test)  loss: 3.8991 -> 3.5038   acc: 14.95% -> 18.94%             
client [77] (test)  loss: 3.8425 -> 3.9069   acc: 10.86% -> 10.53%             
client [95] (test)  loss: 3.8379 -> 3.7943   acc: 10.81% -> 14.19%             
client [91] (test)  loss: 3.5852 -> 3.5931   acc: 18.42% -> 19.74%             
client [14] (test)  loss: 3.7815 -> 4.0014   acc: 20.85% -> 14.49%             
client [99] (test)  loss: 4.0341 -> 3.4180   acc: 9.78% -> 17.98%              
client [20] (test)  loss: 3.9114 -> 3.3741   acc: 13.54% -> 21.18%             
client [39] (test)  loss: 4.0872 -> 3.7072   acc: 12.67% -> 16.67%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.4556 -> 3.6497   acc: 10.39% -> 20.78%             
client [62] (test)  loss: 4.2059 -> 4.0154   acc: 9.06% -> 11.23%              
client [71] (test)  loss: 3.3317 -> 3.2401   acc: 18.48% -> 21.45%             
client [97] (test)  loss: 4.0134 -> 4.0360   acc: 14.57% -> 10.26%             
client [30] (test)  loss: 3.3959 -> 3.2878   acc: 20.13% -> 21.45%             
client [88] (test)  loss: 4.5751 -> 3.8017   acc: 4.32% -> 15.61%              
client [60] (test)  loss: 3.8914 -> 3.4469   acc: 15.26% -> 17.53%             
client [82] (test)  loss: 3.3891 -> 3.4046   acc: 19.87% -> 19.54%             
client [91] (test)  loss: 3.7557 -> 3.6746   acc: 16.12% -> 18.42%             
client [57] (test)  loss: 3.4269 -> 4.0601   acc: 16.99% -> 14.05%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.7242 -> 3.3013   acc: 16.38% -> 20.91%             
client [15] (test)  loss: 3.7714 -> 3.7215   acc: 16.78% -> 15.79%             
client [71] (test)  loss: 3.3805 -> 3.1656   acc: 19.47% -> 24.09%             
client [97] (test)  loss: 3.9899 -> 4.1465   acc: 10.93% -> 10.60%             
client [53] (test)  loss: 4.0471 -> 3.6749   acc: 10.75% -> 17.59%             
client [77] (test)  loss: 3.6972 -> 3.7515   acc: 14.80% -> 14.14%             
client [76] (test)  loss: 4.4592 -> 3.6081   acc: 7.17% -> 17.56%              
client [79] (test)  loss: 3.9236 -> 3.5874   acc: 11.80% -> 15.41%             
client [28] (test)  loss: 4.0754 -> 3.2678   acc: 10.60% -> 21.19%             
client [99] (test)  loss: 3.5278 -> 3.3273   acc: 19.24% -> 19.87%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.7988 -> 3.9973   acc: 11.26% -> 12.91%             
client [86] (test)  loss: 3.8237 -> 4.0091   acc: 14.05% -> 15.72%             
client [34] (test)  loss: 3.6037 -> 3.3165   acc: 14.41% -> 19.82%             
client [73] (test)  loss: 3.3861 -> 3.4558   acc: 19.67% -> 19.34%             
client [5] (test)  loss: 3.5309 -> 3.6271   acc: 19.08% -> 21.38%              
client [96] (test)  loss: 3.6677 -> 3.5670   acc: 20.00% -> 16.36%             
client [22] (test)  loss: 3.8893 -> 5.2246   acc: 12.05% -> 7.82%              
client [60] (test)  loss: 3.7425 -> 3.3768   acc: 13.96% -> 18.83%             
client [66] (test)  loss: 4.2116 -> 3.7821   acc: 12.90% -> 17.42%             
client [83] (test)  loss: 4.0717 -> 3.3772   acc: 12.21% -> 23.10%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.2408 -> 3.5746   acc: 10.75% -> 17.20%             
client [65] (test)  loss: 3.7152 -> 3.7774   acc: 15.51% -> 13.20%             
client [95] (test)  loss: 3.7874 -> 3.8209   acc: 16.55% -> 17.23%             
client [17] (test)  loss: 4.3043 -> 4.0135   acc: 14.19% -> 17.42%             
client [8] (test)  loss: 4.9664 -> 3.6278   acc: 8.45% -> 15.54%               
client [35] (test)  loss: 3.7147 -> 3.5324   acc: 18.69% -> 19.02%             
client [98] (test)  loss: 3.3505 -> 3.3196   acc: 20.06% -> 24.60%             
client [53] (test)  loss: 3.5604 -> 3.6646   acc: 16.94% -> 20.52%             
client [43] (test)  loss: 3.3490 -> 3.3966   acc: 21.78% -> 21.78%             
client [64] (test)  loss: 3.4530 -> 3.2544   acc: 18.48% -> 20.46%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.7022 -> 3.4696   acc: 20.27% -> 19.60%             
client [88] (test)  loss: 4.4494 -> 3.8082   acc: 9.30% -> 20.27%              
client [38] (test)  loss: 4.7072 -> 3.5737   acc: 7.57% -> 18.42%              
client [3] (test)  loss: 3.5829 -> 3.1030   acc: 20.26% -> 25.82%              
client [5] (test)  loss: 4.0727 -> 4.0547   acc: 15.13% -> 17.43%              
client [41] (test)  loss: 4.1671 -> 3.3600   acc: 11.07% -> 21.17%             
client [7] (test)  loss: 3.7428 -> 3.3502   acc: 16.01% -> 21.90%              
client [37] (test)  loss: 4.0894 -> 3.4421   acc: 16.23% -> 24.83%             
client [45] (test)  loss: 4.5399 -> 3.5993   acc: 13.58% -> 18.87%             
client [47] (test)  loss: 3.7541 -> 4.8815   acc: 19.34% -> 11.48%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.6093 -> 4.1336   acc: 16.38% -> 13.94%             
client [11] (test)  loss: 3.7873 -> 3.3810   acc: 15.44% -> 20.13%             
client [37] (test)  loss: 4.1889 -> 3.4570   acc: 11.59% -> 24.83%             
client [41] (test)  loss: 4.0213 -> 3.3552   acc: 12.38% -> 22.48%             
client [95] (test)  loss: 3.5776 -> 3.7893   acc: 15.54% -> 17.57%             
client [53] (test)  loss: 3.9434 -> 3.6664   acc: 15.31% -> 23.13%             
client [22] (test)  loss: 3.8554 -> 4.9123   acc: 14.01% -> 9.77%              
client [25] (test)  loss: 3.7836 -> 3.3756   acc: 19.31% -> 19.66%             
client [69] (test)  loss: 3.8712 -> 3.1977   acc: 14.52% -> 26.07%             
client [46] (test)  loss: 3.6479 -> 3.4078   acc: 18.83% -> 25.00%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.3991 -> 3.8320   acc: 20.33% -> 20.00%             
client [69] (test)  loss: 3.9787 -> 3.2298   acc: 13.53% -> 26.73%             
client [82] (test)  loss: 3.4639 -> 3.4543   acc: 19.21% -> 19.87%             
client [45] (test)  loss: 3.8403 -> 3.7594   acc: 15.56% -> 18.87%             
client [7] (test)  loss: 3.9652 -> 3.3059   acc: 14.38% -> 20.59%              
client [50] (test)  loss: 3.4786 -> 3.6652   acc: 19.85% -> 19.48%             
client [35] (test)  loss: 3.3811 -> 3.9340   acc: 22.62% -> 18.36%             
client [24] (test)  loss: 4.5219 -> 3.5503   acc: 11.82% -> 28.04%             
client [15] (test)  loss: 3.8420 -> 3.4282   acc: 17.11% -> 20.72%             
client [58] (test)  loss: 3.6664 -> 3.3976   acc: 19.14% -> 22.66%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.2100 -> 4.5521   acc: 16.17% -> 15.51%             
client [76] (test)  loss: 3.9510 -> 3.6050   acc: 12.90% -> 20.43%             
client [67] (test)  loss: 4.2928 -> 3.7086   acc: 13.95% -> 15.95%             
client [37] (test)  loss: 4.1910 -> 3.4673   acc: 16.23% -> 25.83%             
client [58] (test)  loss: 3.6663 -> 3.4574   acc: 20.70% -> 22.66%             
client [64] (test)  loss: 3.4506 -> 3.2195   acc: 18.15% -> 21.12%             
client [77] (test)  loss: 3.6477 -> 3.4509   acc: 20.07% -> 23.03%             
client [55] (test)  loss: 3.4784 -> 3.5333   acc: 21.64% -> 23.93%             
client [12] (test)  loss: 3.5714 -> 3.4495   acc: 18.81% -> 21.45%             
client [89] (test)  loss: 3.4745 -> 3.4667   acc: 16.77% -> 19.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.9302 -> 3.9227   acc: 16.34% -> 15.36%             
client [51] (test)  loss: 3.6665 -> 3.5425   acc: 18.87% -> 23.51%             
client [8] (test)  loss: 4.6828 -> 3.6361   acc: 10.14% -> 17.23%              
client [18] (test)  loss: 3.3968 -> 3.2401   acc: 22.22% -> 25.49%             
client [94] (test)  loss: 4.4274 -> 3.3582   acc: 16.67% -> 26.19%             
client [81] (test)  loss: 3.7787 -> 3.1201   acc: 14.62% -> 26.58%             
client [3] (test)  loss: 4.0190 -> 3.3509   acc: 14.05% -> 22.88%              
client [11] (test)  loss: 3.5948 -> 3.9095   acc: 16.44% -> 18.46%             
client [95] (test)  loss: 3.5997 -> 3.7655   acc: 17.23% -> 18.24%             
client [67] (test)  loss: 4.1536 -> 3.5610   acc: 16.61% -> 21.26%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.1654 -> 3.3488   acc: 19.60% -> 24.92%             
client [79] (test)  loss: 3.6840 -> 3.7371   acc: 17.05% -> 17.05%             
client [58] (test)  loss: 3.6548 -> 3.4639   acc: 18.75% -> 25.00%             
client [88] (test)  loss: 4.3523 -> 3.7897   acc: 12.62% -> 21.93%             
client [46] (test)  loss: 4.3786 -> 3.3030   acc: 15.26% -> 28.57%             
client [11] (test)  loss: 3.9086 -> 3.6294   acc: 14.09% -> 18.79%             
client [55] (test)  loss: 3.2530 -> 3.9189   acc: 23.61% -> 19.02%             
client [13] (test)  loss: 3.5755 -> 3.4354   acc: 20.78% -> 22.40%             
client [31] (test)  loss: 3.6724 -> 3.3140   acc: 18.12% -> 23.00%             
client [75] (test)  loss: 3.5707 -> 3.2839   acc: 18.75% -> 26.32%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.3744 -> 3.4530   acc: 16.00% -> 23.67%             
client [7] (test)  loss: 3.9076 -> 3.3660   acc: 18.63% -> 21.24%              
client [57] (test)  loss: 3.1978 -> 4.1626   acc: 28.10% -> 20.92%             
client [13] (test)  loss: 3.7534 -> 3.4109   acc: 18.51% -> 22.73%             
client [43] (test)  loss: 3.5624 -> 3.5527   acc: 22.77% -> 23.76%             
client [91] (test)  loss: 3.9751 -> 2.9394   acc: 17.11% -> 30.59%             
client [10] (test)  loss: 4.6163 -> 3.9518   acc: 10.89% -> 16.83%             
client [64] (test)  loss: 3.6533 -> 3.3510   acc: 18.81% -> 20.79%             
client [82] (test)  loss: 3.4263 -> 3.4192   acc: 22.19% -> 21.52%             
client [22] (test)  loss: 3.9934 -> 5.3201   acc: 13.03% -> 9.77%              
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.9357 -> 3.2624   acc: 15.62% -> 26.74%             
client [23] (test)  loss: 3.9504 -> 4.0537   acc: 12.67% -> 20.00%             
client [88] (test)  loss: 4.5738 -> 3.7409   acc: 12.29% -> 23.26%             
client [98] (test)  loss: 3.3706 -> 4.4333   acc: 22.33% -> 19.09%             
client [79] (test)  loss: 3.4272 -> 3.5279   acc: 18.36% -> 20.33%             
client [21] (test)  loss: 4.3862 -> 3.2880   acc: 16.94% -> 25.91%             
client [92] (test)  loss: 3.5174 -> 3.5537   acc: 21.25% -> 25.00%             
client [56] (test)  loss: 4.2384 -> 3.6238   acc: 13.40% -> 21.99%             
client [5] (test)  loss: 4.1261 -> 3.8413   acc: 14.47% -> 22.37%              
client [52] (test)  loss: 4.5074 -> 3.6327   acc: 12.99% -> 21.43%             
==================== FedDyn_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '3.8795 -> 0.0000', 'accuracy': '14.08% -> 0.00%'},          
    200: {'loss': '3.9219 -> 0.0000', 'accuracy': '17.45% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn_1 achieved 10.0%(10.02%) at epoch: 64                                   
FedDyn_1 achieved 20.0%(20.60%) at epoch: 186                                  
Convergence (test_after):                                                      
FedDyn_1 achieved 10.0%(10.02%) at epoch: 27                                   
FedDyn_1 achieved 20.0%(20.54%) at epoch: 107                                  
