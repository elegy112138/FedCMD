==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.5188 -> 1.4522   acc: 50.89% -> 50.89%             
client [81] (test)  loss: 2.0913 -> 2.0668   acc: 24.95% -> 25.14%             
client [21] (test)  loss: 24.5319 -> 1.5381   acc: 47.31% -> 47.31%            
client [68] (test)  loss: 2.0246 -> 1.9957   acc: 25.35% -> 25.54%             
client [93] (test)  loss: 1.3510 -> 1.1839   acc: 53.14% -> 53.14%             
client [31] (test)  loss: 1.8591 -> 1.4949   acc: 52.37% -> 52.37%             
client [20] (test)  loss: 2.1585 -> 2.1390   acc: 18.47% -> 15.32%             
client [59] (test)  loss: 74.8209 -> 1.9277   acc: 1.29% -> 31.70%             
client [48] (test)  loss: 1.6666 -> 1.6421   acc: 38.04% -> 38.04%             
client [34] (test)  loss: 2.1439 -> 2.1599   acc: 24.18% -> 19.92%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.8281 -> 1.7010   acc: 33.89% -> 33.89%             
client [99] (test)  loss: 1.3695 -> 1.3392   acc: 51.06% -> 51.06%             
client [67] (test)  loss: 1.7934 -> 1.8048   acc: 40.62% -> 40.62%             
client [0] (test)  loss: 1.7726 -> 1.8228   acc: 40.19% -> 32.43%              
client [76] (test)  loss: 1.8338 -> 1.8804   acc: 27.39% -> 29.04%             
client [41] (test)  loss: 1.8260 -> 1.7179   acc: 45.88% -> 37.25%             
client [62] (test)  loss: 70.9062 -> 1.8390   acc: 9.40% -> 33.08%             
client [2] (test)  loss: 45.3575 -> 1.6275   acc: 32.22% -> 31.83%             
client [14] (test)  loss: 2.1304 -> 2.1165   acc: 22.56% -> 22.56%             
client [46] (test)  loss: 1.4195 -> 1.3993   acc: 40.89% -> 36.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.8196 -> 1.7908   acc: 33.57% -> 37.76%             
client [68] (test)  loss: 1.8293 -> 1.7216   acc: 30.69% -> 30.89%             
client [57] (test)  loss: 2.0362 -> 2.0215   acc: 26.73% -> 24.32%             
client [17] (test)  loss: 2.0087 -> 1.8738   acc: 32.67% -> 35.92%             
client [54] (test)  loss: 1.5597 -> 1.9052   acc: 40.34% -> 25.24%             
client [23] (test)  loss: 97.3981 -> 1.5822   acc: 0.98% -> 35.07%             
client [35] (test)  loss: 1.2547 -> 3.6691   acc: 51.20% -> 16.14%             
client [59] (test)  loss: 1.8213 -> 1.9220   acc: 35.05% -> 23.97%             
client [31] (test)  loss: 1.2734 -> 1.2736   acc: 65.17% -> 62.09%             
client [9] (test)  loss: 1.1685 -> 1.3254   acc: 54.33% -> 51.97%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.6250 -> 1.6003   acc: 35.77% -> 41.06%             
client [33] (test)  loss: 0.5327 -> 0.5906   acc: 82.80% -> 79.44%             
client [16] (test)  loss: 0.7314 -> 1.6030   acc: 78.29% -> 41.74%             
client [44] (test)  loss: 1.5577 -> 1.3930   acc: 56.67% -> 42.33%             
client [8] (test)  loss: 1.5218 -> 1.5225   acc: 41.23% -> 42.42%              
client [31] (test)  loss: 1.1740 -> 1.1340   acc: 64.93% -> 64.93%             
client [47] (test)  loss: 1.2610 -> 1.6327   acc: 60.27% -> 44.72%             
client [36] (test)  loss: 1.0771 -> 1.0488   acc: 64.36% -> 63.16%             
client [20] (test)  loss: 1.8525 -> 1.8413   acc: 35.59% -> 34.23%             
client [56] (test)  loss: 0.7537 -> 0.7972   acc: 74.04% -> 72.69%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.4268 -> 1.4385   acc: 54.30% -> 55.79%              
client [60] (test)  loss: 1.4533 -> 1.2546   acc: 52.91% -> 57.52%             
client [28] (test)  loss: 1.5520 -> 1.2987   acc: 53.05% -> 56.91%             
client [25] (test)  loss: 2.5281 -> 1.6611   acc: 27.82% -> 39.09%             
client [58] (test)  loss: 1.5254 -> 1.5108   acc: 45.41% -> 48.65%             
client [44] (test)  loss: 0.8001 -> 1.1205   acc: 71.83% -> 56.67%             
client [39] (test)  loss: 1.2900 -> 1.2599   acc: 62.77% -> 62.96%             
client [29] (test)  loss: 1.3075 -> 1.4156   acc: 52.94% -> 52.94%             
client [3] (test)  loss: 1.2242 -> 1.1260   acc: 59.81% -> 63.37%              
client [84] (test)  loss: 1.2956 -> 2.1788   acc: 55.88% -> 32.81%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8268 -> 0.8269   acc: 73.30% -> 69.89%             
client [84] (test)  loss: 1.1658 -> 2.1490   acc: 60.63% -> 31.00%             
client [10] (test)  loss: 1.4012 -> 1.2679   acc: 56.14% -> 60.45%             
client [36] (test)  loss: 0.8997 -> 0.9557   acc: 70.23% -> 64.06%             
client [65] (test)  loss: 0.6020 -> 0.5637   acc: 78.66% -> 81.37%             
client [81] (test)  loss: 1.3604 -> 1.3110   acc: 47.84% -> 53.10%             
client [79] (test)  loss: 0.3410 -> 0.3659   acc: 90.62% -> 86.95%             
client [42] (test)  loss: 0.7215 -> 0.6904   acc: 77.29% -> 77.89%             
client [11] (test)  loss: 0.3393 -> 0.2634   acc: 88.54% -> 91.65%             
client [96] (test)  loss: 1.0852 -> 1.0356   acc: 65.65% -> 67.04%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9670 -> 0.9680   acc: 70.14% -> 69.19%              
client [53] (test)  loss: 0.9806 -> 1.4487   acc: 69.88% -> 50.00%             
client [52] (test)  loss: 0.8638 -> 1.5155   acc: 70.79% -> 53.93%             
client [42] (test)  loss: 0.6255 -> 0.6469   acc: 80.00% -> 79.55%             
client [69] (test)  loss: 1.0191 -> 1.2067   acc: 63.89% -> 57.59%             
client [59] (test)  loss: 1.2068 -> 1.1426   acc: 54.90% -> 61.08%             
client [7] (test)  loss: 1.4958 -> 1.4609   acc: 46.62% -> 46.26%              
client [26] (test)  loss: 0.5548 -> 0.6841   acc: 82.52% -> 78.01%             
client [49] (test)  loss: 1.1737 -> 1.3109   acc: 59.65% -> 51.49%             
client [98] (test)  loss: 0.9654 -> 1.1476   acc: 71.23% -> 62.58%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9247 -> 1.2118   acc: 71.83% -> 60.56%             
client [47] (test)  loss: 0.7222 -> 0.7352   acc: 77.16% -> 73.51%             
client [21] (test)  loss: 0.7180 -> 0.7471   acc: 76.52% -> 71.68%             
client [77] (test)  loss: 0.5513 -> 0.6995   acc: 80.52% -> 72.96%             
client [95] (test)  loss: 0.6186 -> 0.5389   acc: 79.96% -> 82.91%             
client [91] (test)  loss: 1.0659 -> 1.0577   acc: 66.84% -> 68.15%             
client [14] (test)  loss: 1.1682 -> 1.1559   acc: 64.16% -> 64.41%             
client [99] (test)  loss: 0.4719 -> 0.8033   acc: 85.88% -> 73.31%             
client [20] (test)  loss: 1.3146 -> 1.2967   acc: 62.16% -> 62.61%             
client [39] (test)  loss: 0.8895 -> 0.8794   acc: 73.88% -> 75.05%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7514 -> 1.2554   acc: 75.09% -> 61.24%             
client [62] (test)  loss: 0.7545 -> 0.8832   acc: 75.56% -> 72.18%             
client [71] (test)  loss: 0.9730 -> 1.0390   acc: 66.04% -> 62.29%             
client [97] (test)  loss: 1.1319 -> 1.0857   acc: 62.30% -> 62.98%             
client [30] (test)  loss: 0.6868 -> 0.8268   acc: 76.19% -> 73.90%             
client [88] (test)  loss: 0.8161 -> 0.8573   acc: 73.89% -> 74.53%             
client [60] (test)  loss: 0.9439 -> 0.9143   acc: 68.34% -> 71.14%             
client [82] (test)  loss: 0.9590 -> 0.9585   acc: 69.79% -> 68.23%             
client [91] (test)  loss: 0.9863 -> 0.9959   acc: 68.93% -> 68.93%             
client [57] (test)  loss: 1.1207 -> 1.1037   acc: 63.66% -> 65.17%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7603 -> 0.6169   acc: 78.91% -> 81.52%             
client [15] (test)  loss: 0.9118 -> 1.0894   acc: 73.33% -> 62.58%             
client [71] (test)  loss: 0.9643 -> 0.9267   acc: 65.36% -> 69.11%             
client [97] (test)  loss: 1.0405 -> 0.9473   acc: 62.75% -> 69.53%             
client [53] (test)  loss: 0.8348 -> 1.3325   acc: 71.35% -> 56.73%             
client [77] (test)  loss: 0.4664 -> 0.5602   acc: 84.69% -> 80.52%             
client [76] (test)  loss: 0.9121 -> 0.8616   acc: 72.61% -> 72.28%             
client [79] (test)  loss: 0.1722 -> 0.4389   acc: 94.49% -> 87.32%             
client [28] (test)  loss: 0.8852 -> 0.9121   acc: 69.61% -> 68.33%             
client [99] (test)  loss: 0.4395 -> 0.5745   acc: 87.43% -> 83.37%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.8950 -> 0.8969   acc: 71.78% -> 70.20%             
client [86] (test)  loss: 0.8882 -> 0.8532   acc: 71.51% -> 73.64%             
client [34] (test)  loss: 0.8965 -> 1.6439   acc: 72.92% -> 47.58%             
client [73] (test)  loss: 0.4776 -> 0.5651   acc: 84.95% -> 81.35%             
client [5] (test)  loss: 0.7714 -> 1.0261   acc: 73.20% -> 67.38%              
client [96] (test)  loss: 0.6813 -> 1.0287   acc: 78.95% -> 67.31%             
client [22] (test)  loss: 0.6484 -> 0.6677   acc: 79.10% -> 78.20%             
client [60] (test)  loss: 0.8198 -> 0.8697   acc: 74.35% -> 74.55%             
client [66] (test)  loss: 0.0407 -> 0.0372   acc: 98.84% -> 99.23%             
client [83] (test)  loss: 0.7828 -> 1.0126   acc: 78.48% -> 67.39%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7565 -> 0.7720   acc: 78.22% -> 76.57%             
client [65] (test)  loss: 0.3603 -> 0.3716   acc: 89.33% -> 88.06%             
client [95] (test)  loss: 0.5014 -> 0.4889   acc: 85.07% -> 84.28%             
client [17] (test)  loss: 0.8189 -> 0.8015   acc: 74.19% -> 74.37%             
client [8] (test)  loss: 0.8001 -> 0.7915   acc: 73.93% -> 74.41%              
client [35] (test)  loss: 0.5093 -> 0.5219   acc: 83.47% -> 80.88%             
client [98] (test)  loss: 0.7270 -> 1.0943   acc: 81.49% -> 63.38%             
client [53] (test)  loss: 0.7573 -> 1.2131   acc: 76.02% -> 61.70%             
client [43] (test)  loss: 0.7686 -> 0.9251   acc: 71.43% -> 70.41%             
client [64] (test)  loss: 0.9379 -> 1.0122   acc: 72.29% -> 67.51%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5010 -> 0.6087   acc: 84.05% -> 78.14%             
client [88] (test)  loss: 0.6474 -> 0.6463   acc: 81.47% -> 81.26%             
client [38] (test)  loss: 0.6309 -> 0.7151   acc: 81.16% -> 79.33%             
client [3] (test)  loss: 0.6366 -> 0.6503   acc: 82.66% -> 81.20%              
client [5] (test)  loss: 0.6822 -> 0.9199   acc: 76.89% -> 69.90%              
client [41] (test)  loss: 0.8265 -> 0.9699   acc: 71.57% -> 69.22%             
client [7] (test)  loss: 0.7910 -> 0.9197   acc: 75.27% -> 69.40%              
client [37] (test)  loss: 0.7713 -> 1.1025   acc: 80.79% -> 69.90%             
client [45] (test)  loss: 0.6919 -> 0.8307   acc: 76.54% -> 72.09%             
client [47] (test)  loss: 0.5499 -> 0.6759   acc: 82.92% -> 76.39%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3218 -> 0.3626   acc: 88.87% -> 88.31%             
client [11] (test)  loss: 0.1945 -> 0.1833   acc: 92.23% -> 92.62%             
client [37] (test)  loss: 0.7479 -> 1.2461   acc: 81.98% -> 67.92%             
client [41] (test)  loss: 0.7700 -> 0.9121   acc: 75.10% -> 69.80%             
client [95] (test)  loss: 0.4467 -> 0.4664   acc: 88.21% -> 87.03%             
client [53] (test)  loss: 0.6741 -> 1.1637   acc: 78.65% -> 61.40%             
client [22] (test)  loss: 0.5776 -> 0.5609   acc: 81.62% -> 83.24%             
client [25] (test)  loss: 0.8457 -> 0.7527   acc: 73.64% -> 76.91%             
client [69] (test)  loss: 0.7128 -> 0.8185   acc: 77.04% -> 73.52%             
client [46] (test)  loss: 0.5345 -> 0.5708   acc: 81.60% -> 80.48%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4940 -> 0.6625   acc: 83.49% -> 77.35%             
client [69] (test)  loss: 0.7427 -> 0.8200   acc: 75.93% -> 74.07%             
client [82] (test)  loss: 0.7275 -> 0.6327   acc: 79.69% -> 82.03%             
client [45] (test)  loss: 0.6308 -> 0.7622   acc: 82.53% -> 75.68%             
client [7] (test)  loss: 0.7968 -> 0.8757   acc: 75.62% -> 71.89%              
client [50] (test)  loss: 0.7013 -> 0.6678   acc: 78.09% -> 80.28%             
client [35] (test)  loss: 0.4610 -> 0.5435   acc: 85.46% -> 82.67%             
client [24] (test)  loss: 0.7390 -> 0.6506   acc: 81.82% -> 83.22%             
client [15] (test)  loss: 0.6934 -> 0.7258   acc: 81.08% -> 77.85%             
client [58] (test)  loss: 0.8361 -> 0.9651   acc: 74.05% -> 69.01%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5221 -> 0.5975   acc: 80.78% -> 76.86%             
client [76] (test)  loss: 0.6500 -> 0.7109   acc: 77.56% -> 75.91%             
client [67] (test)  loss: 0.6780 -> 0.7045   acc: 78.12% -> 79.38%             
client [37] (test)  loss: 0.7421 -> 1.2374   acc: 79.80% -> 68.51%             
client [58] (test)  loss: 0.7872 -> 0.9431   acc: 75.14% -> 68.11%             
client [64] (test)  loss: 0.8070 -> 0.8625   acc: 76.83% -> 75.06%             
client [77] (test)  loss: 0.3524 -> 0.3855   acc: 87.67% -> 87.28%             
client [55] (test)  loss: 0.5331 -> 0.9127   acc: 84.64% -> 73.12%             
client [12] (test)  loss: 0.5721 -> 0.6544   acc: 83.71% -> 80.34%             
client [89] (test)  loss: 0.6285 -> 0.7311   acc: 83.20% -> 79.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5857 -> 1.0698   acc: 78.73% -> 66.29%             
client [51] (test)  loss: 0.7153 -> 0.8885   acc: 79.18% -> 69.80%             
client [8] (test)  loss: 0.6411 -> 0.7183   acc: 79.62% -> 76.07%              
client [18] (test)  loss: 0.7009 -> 0.7946   acc: 80.11% -> 75.97%             
client [94] (test)  loss: 0.5663 -> 0.5691   acc: 82.94% -> 82.54%             
client [81] (test)  loss: 0.6829 -> 0.8436   acc: 78.80% -> 71.86%             
client [3] (test)  loss: 0.5847 -> 0.6154   acc: 84.60% -> 83.79%              
client [11] (test)  loss: 0.1610 -> 0.1599   acc: 94.76% -> 93.98%             
client [95] (test)  loss: 0.4218 -> 0.4456   acc: 89.00% -> 88.21%             
client [67] (test)  loss: 0.6345 -> 0.6749   acc: 79.06% -> 79.38%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4441 -> 0.6331   acc: 85.30% -> 78.14%             
client [79] (test)  loss: 0.1565 -> 0.1837   acc: 95.22% -> 94.49%             
client [58] (test)  loss: 0.7508 -> 0.9296   acc: 76.22% -> 69.01%             
client [88] (test)  loss: 0.5855 -> 0.6257   acc: 84.42% -> 81.68%             
client [46] (test)  loss: 0.5092 -> 0.5868   acc: 82.71% -> 81.41%             
client [11] (test)  loss: 0.1619 -> 0.1513   acc: 94.56% -> 94.76%             
client [55] (test)  loss: 0.4875 -> 0.9052   acc: 85.92% -> 73.76%             
client [13] (test)  loss: 0.1051 -> 0.1596   acc: 96.38% -> 94.33%             
client [31] (test)  loss: 0.5044 -> 0.4983   acc: 85.07% -> 84.83%             
client [75] (test)  loss: 0.4906 -> 0.6110   acc: 83.58% -> 78.11%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4267 -> 0.3632   acc: 84.19% -> 87.24%             
client [7] (test)  loss: 0.7286 -> 0.7702   acc: 77.76% -> 75.98%              
client [57] (test)  loss: 0.7231 -> 0.7209   acc: 77.18% -> 77.78%             
client [13] (test)  loss: 0.1013 -> 0.1513   acc: 96.69% -> 94.96%             
client [43] (test)  loss: 0.6959 -> 0.8339   acc: 77.21% -> 73.81%             
client [91] (test)  loss: 0.7467 -> 0.7171   acc: 77.28% -> 79.90%             
client [10] (test)  loss: 0.7012 -> 0.7278   acc: 77.95% -> 77.27%             
client [64] (test)  loss: 0.7059 -> 0.8499   acc: 80.60% -> 75.57%             
client [82] (test)  loss: 0.6939 -> 0.5931   acc: 80.21% -> 84.11%             
client [22] (test)  loss: 0.5446 -> 0.5254   acc: 82.70% -> 83.60%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8514 -> 0.9058   acc: 74.77% -> 72.52%             
client [23] (test)  loss: 0.5896 -> 0.6848   acc: 81.24% -> 79.12%             
client [88] (test)  loss: 0.5393 -> 0.6069   acc: 85.05% -> 82.53%             
client [98] (test)  loss: 0.5848 -> 0.8813   acc: 83.30% -> 73.04%             
client [79] (test)  loss: 0.1389 -> 0.1748   acc: 95.77% -> 94.49%             
client [21] (test)  loss: 0.4610 -> 0.5721   acc: 84.95% -> 80.47%             
client [92] (test)  loss: 0.6312 -> 0.7550   acc: 79.30% -> 76.25%             
client [56] (test)  loss: 0.3256 -> 0.3421   acc: 88.85% -> 90.58%             
client [5] (test)  loss: 0.5854 -> 0.8387   acc: 79.81% -> 72.62%              
client [52] (test)  loss: 0.5916 -> 0.6600   acc: 80.90% -> 78.46%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.7377 -> 0.0000', 'accuracy': '76.26% -> 0.00%'},          
    200: {'loss': '0.5306 -> 0.0000', 'accuracy': '83.82% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(11.52%) at epoch: 0                                    
FedRep_1 achieved 20.0%(21.31%) at epoch: 2                                    
FedRep_1 achieved 30.0%(37.90%) at epoch: 4                                    
FedRep_1 achieved 40.0%(42.82%) at epoch: 23                                   
FedRep_1 achieved 50.0%(53.97%) at epoch: 30                                   
FedRep_1 achieved 60.0%(61.97%) at epoch: 39                                   
FedRep_1 achieved 70.0%(71.76%) at epoch: 59                                   
FedRep_1 achieved 80.0%(81.10%) at epoch: 100                                  
Convergence (test_after):                                                      
FedRep_1 achieved 30.0%(35.33%) at epoch: 0                                    
FedRep_1 achieved 40.0%(42.98%) at epoch: 4                                    
FedRep_1 achieved 50.0%(50.22%) at epoch: 32                                   
FedRep_1 achieved 60.0%(61.54%) at epoch: 41                                   
FedRep_1 achieved 70.0%(70.73%) at epoch: 73                                   
FedRep_1 achieved 80.0%(83.80%) at epoch: 114                                  
