==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.1405 -> 2.0274   acc: 25.81% -> 36.29%             
client [81] (test)  loss: 2.1769 -> 2.0083   acc: 36.89% -> 38.52%             
client [21] (test)  loss: 2.3264 -> 2.1039   acc: 16.81% -> 48.74%             
client [68] (test)  loss: 2.0706 -> 1.8701   acc: 39.39% -> 30.30%             
client [93] (test)  loss: 1.7729 -> 1.1656   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.4227 -> 2.3427   acc: 10.26% -> 10.26%             
client [20] (test)  loss: 2.1627 -> 2.0508   acc: 37.41% -> 39.57%             
client [59] (test)  loss: 2.3549 -> 2.1257   acc: 38.58% -> 36.22%             
client [48] (test)  loss: 2.2567 -> 2.2142   acc: 16.36% -> 20.00%             
client [34] (test)  loss: 2.1234 -> 1.9434   acc: 38.03% -> 34.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.0908 -> 1.9288   acc: 29.46% -> 23.21%             
client [99] (test)  loss: 2.1482 -> 2.0042   acc: 31.82% -> 31.82%             
client [67] (test)  loss: 2.1492 -> 1.9696   acc: 21.43% -> 25.40%             
client [0] (test)  loss: 1.7403 -> 1.6379   acc: 37.57% -> 42.77%              
client [76] (test)  loss: 1.8083 -> 1.7007   acc: 51.90% -> 49.37%             
client [41] (test)  loss: 2.0117 -> 1.8277   acc: 36.89% -> 38.52%             
client [62] (test)  loss: 2.2849 -> 2.0396   acc: 5.63% -> 46.48%              
client [2] (test)  loss: 2.2313 -> 1.3691   acc: 63.45% -> 63.45%              
client [14] (test)  loss: 1.8435 -> 1.7738   acc: 39.37% -> 42.52%             
client [46] (test)  loss: 1.7595 -> 1.7329   acc: 52.99% -> 52.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.8287 -> 1.7144   acc: 35.71% -> 37.50%             
client [68] (test)  loss: 1.7027 -> 1.5243   acc: 30.30% -> 32.32%             
client [57] (test)  loss: 1.8037 -> 1.7219   acc: 39.18% -> 39.18%             
client [17] (test)  loss: 1.9028 -> 1.8157   acc: 37.50% -> 52.88%             
client [54] (test)  loss: 1.8530 -> 1.8422   acc: 35.14% -> 36.49%             
client [23] (test)  loss: 2.2568 -> 2.0574   acc: 35.14% -> 36.49%             
client [35] (test)  loss: 1.8098 -> 1.7648   acc: 39.29% -> 40.48%             
client [59] (test)  loss: 1.6729 -> 1.6035   acc: 36.22% -> 36.22%             
client [31] (test)  loss: 2.0143 -> 1.9825   acc: 42.31% -> 44.87%             
client [9] (test)  loss: 1.8533 -> 1.7702   acc: 27.84% -> 41.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.6993 -> 1.6385   acc: 44.00% -> 47.20%             
client [33] (test)  loss: 1.3351 -> 1.3030   acc: 57.94% -> 57.94%             
client [16] (test)  loss: 1.6404 -> 1.5668   acc: 45.83% -> 51.39%             
client [44] (test)  loss: 1.9383 -> 1.5789   acc: 32.59% -> 45.19%             
client [8] (test)  loss: 0.9661 -> 0.9409   acc: 65.28% -> 65.28%              
client [31] (test)  loss: 1.9485 -> 1.9033   acc: 51.28% -> 51.28%             
client [47] (test)  loss: 1.4107 -> 1.3522   acc: 72.27% -> 68.91%             
client [36] (test)  loss: 1.9772 -> 1.7431   acc: 47.01% -> 45.30%             
client [20] (test)  loss: 1.6093 -> 1.5620   acc: 46.04% -> 47.48%             
client [56] (test)  loss: 1.6144 -> 1.5025   acc: 48.72% -> 47.86%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.7441 -> 1.7108   acc: 35.34% -> 36.21%              
client [60] (test)  loss: 1.8914 -> 1.7996   acc: 22.37% -> 30.26%             
client [28] (test)  loss: 1.4682 -> 1.3217   acc: 52.42% -> 54.03%             
client [25] (test)  loss: 1.7678 -> 1.6489   acc: 47.11% -> 47.93%             
client [58] (test)  loss: 1.2112 -> 1.1729   acc: 49.38% -> 50.62%             
client [44] (test)  loss: 1.5454 -> 1.4574   acc: 46.67% -> 51.11%             
client [39] (test)  loss: 0.7972 -> 0.7801   acc: 76.43% -> 76.43%             
client [29] (test)  loss: 1.3467 -> 1.2659   acc: 48.74% -> 52.94%             
client [3] (test)  loss: 1.8880 -> 1.8277   acc: 30.51% -> 35.59%              
client [84] (test)  loss: 0.7221 -> 0.6834   acc: 76.07% -> 79.14%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.4081 -> 1.2337   acc: 49.58% -> 52.10%             
client [84] (test)  loss: 0.6590 -> 0.6257   acc: 79.14% -> 81.60%             
client [10] (test)  loss: 1.9561 -> 1.9236   acc: 30.77% -> 30.77%             
client [36] (test)  loss: 1.5589 -> 1.5438   acc: 47.01% -> 47.01%             
client [65] (test)  loss: 1.5857 -> 1.5478   acc: 40.68% -> 40.68%             
client [81] (test)  loss: 1.5906 -> 1.5307   acc: 40.98% -> 45.08%             
client [79] (test)  loss: 1.5194 -> 1.4853   acc: 47.86% -> 53.85%             
client [42] (test)  loss: 1.5587 -> 1.5456   acc: 48.44% -> 51.56%             
client [11] (test)  loss: 1.4716 -> 1.4205   acc: 46.21% -> 46.21%             
client [96] (test)  loss: 1.5064 -> 1.4506   acc: 40.34% -> 44.54%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8120 -> 0.7765   acc: 68.06% -> 75.69%              
client [53] (test)  loss: 1.2640 -> 1.2180   acc: 47.06% -> 48.74%             
client [52] (test)  loss: 1.2198 -> 1.1745   acc: 63.57% -> 65.89%             
client [42] (test)  loss: 1.4636 -> 1.4512   acc: 54.69% -> 52.34%             
client [69] (test)  loss: 1.3917 -> 1.3607   acc: 50.89% -> 52.68%             
client [59] (test)  loss: 1.3442 -> 1.3170   acc: 45.67% -> 45.67%             
client [7] (test)  loss: 1.6421 -> 1.5429   acc: 32.59% -> 38.52%              
client [26] (test)  loss: 1.6759 -> 1.6188   acc: 28.46% -> 34.62%             
client [49] (test)  loss: 1.4137 -> 1.3653   acc: 47.06% -> 47.06%             
client [98] (test)  loss: 1.4330 -> 1.4136   acc: 44.74% -> 45.61%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.3640 -> 1.3445   acc: 50.88% -> 56.14%             
client [47] (test)  loss: 1.0259 -> 0.9891   acc: 72.27% -> 71.43%             
client [21] (test)  loss: 1.1114 -> 1.0589   acc: 67.23% -> 70.59%             
client [77] (test)  loss: 1.2854 -> 1.2705   acc: 60.48% -> 58.06%             
client [95] (test)  loss: 1.1255 -> 1.1090   acc: 64.25% -> 67.04%             
client [91] (test)  loss: 1.5517 -> 1.5176   acc: 38.10% -> 39.68%             
client [14] (test)  loss: 1.1282 -> 1.0935   acc: 61.42% -> 62.99%             
client [99] (test)  loss: 1.4759 -> 1.4611   acc: 51.14% -> 54.55%             
client [20] (test)  loss: 1.2740 -> 1.2529   acc: 52.52% -> 54.68%             
client [39] (test)  loss: 0.6730 -> 0.6452   acc: 76.43% -> 77.14%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1188 -> 1.0550   acc: 62.79% -> 66.67%             
client [62] (test)  loss: 1.2123 -> 1.1911   acc: 61.97% -> 63.38%             
client [71] (test)  loss: 1.3493 -> 1.3092   acc: 49.62% -> 50.38%             
client [97] (test)  loss: 0.8958 -> 0.8465   acc: 63.09% -> 70.47%             
client [30] (test)  loss: 1.1806 -> 1.1569   acc: 67.72% -> 67.72%             
client [88] (test)  loss: 1.3730 -> 1.3440   acc: 57.35% -> 60.29%             
client [60] (test)  loss: 1.5304 -> 1.5196   acc: 39.47% -> 44.74%             
client [82] (test)  loss: 1.0265 -> 0.9961   acc: 62.30% -> 65.57%             
client [91] (test)  loss: 1.4609 -> 1.4428   acc: 39.68% -> 39.68%             
client [57] (test)  loss: 1.2136 -> 1.1820   acc: 57.31% -> 59.06%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5172 -> 1.5205   acc: 58.97% -> 57.69%             
client [15] (test)  loss: 0.6426 -> 0.6233   acc: 80.92% -> 80.92%             
client [71] (test)  loss: 1.2786 -> 1.2384   acc: 50.38% -> 53.44%             
client [97] (test)  loss: 0.7645 -> 0.7424   acc: 73.15% -> 76.51%             
client [53] (test)  loss: 1.0558 -> 1.0191   acc: 61.34% -> 61.34%             
client [77] (test)  loss: 1.2151 -> 1.2018   acc: 58.87% -> 62.10%             
client [76] (test)  loss: 0.9771 -> 0.9668   acc: 69.62% -> 69.62%             
client [79] (test)  loss: 1.1805 -> 1.1480   acc: 67.52% -> 69.23%             
client [28] (test)  loss: 0.9728 -> 0.9542   acc: 66.13% -> 65.32%             
client [99] (test)  loss: 1.3682 -> 1.3538   acc: 55.68% -> 55.68%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6960 -> 0.6828   acc: 77.85% -> 79.87%             
client [86] (test)  loss: 0.5885 -> 0.5765   acc: 80.49% -> 81.30%             
client [34] (test)  loss: 1.1675 -> 1.1434   acc: 61.27% -> 63.38%             
client [73] (test)  loss: 1.3291 -> 1.3147   acc: 55.20% -> 53.60%             
client [5] (test)  loss: 1.5077 -> 1.5069   acc: 53.33% -> 53.33%              
client [96] (test)  loss: 1.1253 -> 1.1173   acc: 62.18% -> 65.55%             
client [22] (test)  loss: 1.6183 -> 1.6089   acc: 37.38% -> 37.38%             
client [60] (test)  loss: 1.4368 -> 1.4246   acc: 47.37% -> 52.63%             
client [66] (test)  loss: 1.0430 -> 1.0247   acc: 58.06% -> 59.68%             
client [83] (test)  loss: 1.3077 -> 1.2502   acc: 55.75% -> 63.72%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8665 -> 0.8745   acc: 77.22% -> 78.48%             
client [65] (test)  loss: 1.3621 -> 1.3193   acc: 44.92% -> 45.76%             
client [95] (test)  loss: 0.9358 -> 0.9347   acc: 77.09% -> 76.54%             
client [17] (test)  loss: 1.3880 -> 1.2239   acc: 56.73% -> 61.54%             
client [8] (test)  loss: 0.6318 -> 0.6179   acc: 77.78% -> 77.78%              
client [35] (test)  loss: 1.1443 -> 1.1395   acc: 65.48% -> 65.48%             
client [98] (test)  loss: 1.1449 -> 1.1370   acc: 67.54% -> 66.67%             
client [53] (test)  loss: 0.9402 -> 0.9162   acc: 64.71% -> 65.55%             
client [43] (test)  loss: 0.6574 -> 0.6175   acc: 78.95% -> 80.86%             
client [64] (test)  loss: 1.0253 -> 0.9983   acc: 68.00% -> 69.60%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8517 -> 0.8089   acc: 75.63% -> 78.99%             
client [88] (test)  loss: 1.1375 -> 1.1123   acc: 61.03% -> 61.76%             
client [38] (test)  loss: 1.1435 -> 1.1227   acc: 64.29% -> 63.10%             
client [3] (test)  loss: 1.3089 -> 1.2870   acc: 57.63% -> 61.86%              
client [5] (test)  loss: 1.4328 -> 1.4517   acc: 56.19% -> 55.24%              
client [41] (test)  loss: 0.9228 -> 0.9175   acc: 70.49% -> 70.49%             
client [7] (test)  loss: 1.2718 -> 1.2336   acc: 54.81% -> 61.48%              
client [37] (test)  loss: 0.9384 -> 0.9207   acc: 71.70% -> 72.64%             
client [45] (test)  loss: 1.1947 -> 1.1296   acc: 57.58% -> 60.61%             
client [47] (test)  loss: 0.7529 -> 0.7598   acc: 72.27% -> 73.11%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0516 -> 1.0456   acc: 69.44% -> 66.67%             
client [11] (test)  loss: 1.0587 -> 1.0453   acc: 65.15% -> 66.67%             
client [37] (test)  loss: 0.8815 -> 0.8718   acc: 74.53% -> 74.06%             
client [41] (test)  loss: 0.8897 -> 0.8903   acc: 70.49% -> 70.49%             
client [95] (test)  loss: 0.8617 -> 0.8818   acc: 78.77% -> 78.21%             
client [53] (test)  loss: 0.8741 -> 0.8385   acc: 65.55% -> 69.75%             
client [22] (test)  loss: 1.5397 -> 1.5200   acc: 41.12% -> 41.12%             
client [25] (test)  loss: 1.1842 -> 1.1797   acc: 66.12% -> 66.94%             
client [69] (test)  loss: 1.0055 -> 0.9979   acc: 65.18% -> 66.96%             
client [46] (test)  loss: 1.0926 -> 1.0680   acc: 63.25% -> 64.96%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6904 -> 0.6955   acc: 77.31% -> 78.99%             
client [69] (test)  loss: 0.9853 -> 0.9686   acc: 67.86% -> 70.54%             
client [82] (test)  loss: 0.7501 -> 0.7304   acc: 77.05% -> 77.05%             
client [45] (test)  loss: 1.0388 -> 1.0098   acc: 62.63% -> 64.65%             
client [7] (test)  loss: 1.1830 -> 1.1520   acc: 60.00% -> 62.96%              
client [50] (test)  loss: 0.5113 -> 0.4877   acc: 82.96% -> 84.44%             
client [35] (test)  loss: 1.0101 -> 1.0059   acc: 70.24% -> 70.24%             
client [24] (test)  loss: 1.0011 -> 0.9831   acc: 67.86% -> 69.64%             
client [15] (test)  loss: 0.5281 -> 0.5158   acc: 82.44% -> 82.44%             
client [58] (test)  loss: 0.6714 -> 0.6781   acc: 74.38% -> 73.75%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.2226 -> 1.2039   acc: 70.91% -> 69.09%             
client [76] (test)  loss: 0.7635 -> 0.7698   acc: 81.01% -> 81.01%             
client [67] (test)  loss: 0.9747 -> 0.9763   acc: 62.70% -> 62.70%             
client [37] (test)  loss: 0.8295 -> 0.8201   acc: 75.47% -> 76.42%             
client [58] (test)  loss: 0.6476 -> 0.6504   acc: 75.00% -> 74.38%             
client [64] (test)  loss: 0.8607 -> 0.8458   acc: 72.80% -> 72.80%             
client [77] (test)  loss: 1.0126 -> 1.0082   acc: 66.94% -> 68.55%             
client [55] (test)  loss: 0.9345 -> 0.9093   acc: 65.87% -> 68.25%             
client [12] (test)  loss: 1.5934 -> 1.6163   acc: 49.29% -> 50.00%             
client [89] (test)  loss: 0.9344 -> 0.9000   acc: 68.84% -> 70.29%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3998 -> 0.3921   acc: 90.18% -> 90.18%             
client [51] (test)  loss: 0.5299 -> 0.5332   acc: 82.58% -> 81.94%             
client [8] (test)  loss: 0.5491 -> 0.5492   acc: 77.08% -> 77.78%              
client [18] (test)  loss: 1.3424 -> 1.3180   acc: 49.48% -> 48.45%             
client [94] (test)  loss: 0.5500 -> 0.5291   acc: 80.83% -> 80.83%             
client [81] (test)  loss: 0.9581 -> 0.9424   acc: 61.48% -> 62.30%             
client [3] (test)  loss: 1.1560 -> 1.1668   acc: 64.41% -> 61.86%              
client [11] (test)  loss: 0.9636 -> 0.9554   acc: 70.45% -> 71.97%             
client [95] (test)  loss: 0.8139 -> 0.8447   acc: 79.89% -> 79.33%             
client [67] (test)  loss: 0.9339 -> 0.9409   acc: 62.70% -> 63.49%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6801 -> 0.6512   acc: 82.35% -> 84.87%             
client [79] (test)  loss: 0.8401 -> 0.8269   acc: 75.21% -> 76.07%             
client [58] (test)  loss: 0.5993 -> 0.6025   acc: 76.88% -> 76.88%             
client [88] (test)  loss: 0.9817 -> 0.9560   acc: 63.24% -> 66.91%             
client [46] (test)  loss: 0.9606 -> 0.9468   acc: 72.65% -> 75.21%             
client [11] (test)  loss: 0.9452 -> 0.9387   acc: 71.97% -> 72.73%             
client [55] (test)  loss: 0.8206 -> 0.8141   acc: 69.84% -> 71.43%             
client [13] (test)  loss: 1.1608 -> 1.1562   acc: 64.63% -> 67.07%             
client [31] (test)  loss: 1.4499 -> 1.4008   acc: 61.54% -> 66.67%             
client [75] (test)  loss: 1.0916 -> 1.0858   acc: 63.87% -> 64.71%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7918 -> 0.7678   acc: 76.47% -> 77.31%             
client [7] (test)  loss: 1.0213 -> 0.9975   acc: 65.19% -> 65.19%              
client [57] (test)  loss: 0.6982 -> 0.6982   acc: 81.87% -> 83.04%             
client [13] (test)  loss: 1.1065 -> 1.1067   acc: 65.85% -> 65.85%             
client [43] (test)  loss: 0.4965 -> 0.4579   acc: 83.73% -> 86.60%             
client [91] (test)  loss: 1.0233 -> 1.0192   acc: 61.90% -> 61.90%             
client [10] (test)  loss: 1.3484 -> 1.3113   acc: 61.54% -> 61.54%             
client [64] (test)  loss: 0.7666 -> 0.7531   acc: 74.40% -> 74.40%             
client [82] (test)  loss: 0.5993 -> 0.5933   acc: 81.97% -> 81.15%             
client [22] (test)  loss: 1.3888 -> 1.3715   acc: 48.60% -> 49.53%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8864 -> 0.8872   acc: 73.38% -> 72.66%             
client [23] (test)  loss: 0.8877 -> 0.8866   acc: 68.92% -> 68.92%             
client [88] (test)  loss: 0.9259 -> 0.9103   acc: 66.91% -> 68.38%             
client [98] (test)  loss: 0.8554 -> 0.8491   acc: 76.32% -> 75.44%             
client [79] (test)  loss: 0.7852 -> 0.7910   acc: 75.21% -> 76.92%             
client [21] (test)  loss: 0.6299 -> 0.6010   acc: 84.03% -> 85.71%             
client [92] (test)  loss: 0.7838 -> 0.7653   acc: 67.69% -> 68.46%             
client [56] (test)  loss: 0.6942 -> 0.7004   acc: 76.07% -> 74.36%             
client [5] (test)  loss: 1.2665 -> 1.2995   acc: 54.29% -> 54.29%              
client [52] (test)  loss: 0.6573 -> 0.6387   acc: 82.17% -> 82.95%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '1.1230 -> 0.0000', 'accuracy': '62.50% -> 0.00%'},          
    200: {'loss': '0.7970 -> 0.0000', 'accuracy': '73.75% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(12.38%) at epoch: 0                                    
FedRep_1 achieved 20.0%(29.03%) at epoch: 4                                    
FedRep_1 achieved 30.0%(35.29%) at epoch: 9                                    
FedRep_1 achieved 40.0%(46.93%) at epoch: 20                                   
FedRep_1 achieved 50.0%(53.02%) at epoch: 35                                   
FedRep_1 achieved 60.0%(60.25%) at epoch: 76                                   
FedRep_1 achieved 70.0%(71.28%) at epoch: 123                                  
Convergence (test_after):                                                      
FedRep_1 achieved 20.0%(28.00%) at epoch: 0                                    
FedRep_1 achieved 30.0%(31.65%) at epoch: 1                                    
FedRep_1 achieved 40.0%(41.11%) at epoch: 5                                    
FedRep_1 achieved 50.0%(51.84%) at epoch: 20                                   
FedRep_1 achieved 60.0%(61.13%) at epoch: 75                                   
FedRep_1 achieved 70.0%(70.12%) at epoch: 119                                  
