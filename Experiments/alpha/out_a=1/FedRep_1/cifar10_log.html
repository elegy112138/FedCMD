==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.1260 -> 1.9716   acc: 22.80% -> 23.83%             
client [81] (test)  loss: 2.0896 -> 2.0904   acc: 18.77% -> 23.69%             
client [21] (test)  loss: 22.8652 -> 1.9267   acc: 2.74% -> 34.65%             
client [68] (test)  loss: 2.0936 -> 1.9993   acc: 26.28% -> 26.28%             
client [93] (test)  loss: 2.0970 -> 2.0062   acc: 27.38% -> 28.27%             
client [31] (test)  loss: 2.1408 -> 2.0291   acc: 25.80% -> 30.39%             
client [20] (test)  loss: 1.6623 -> 1.6040   acc: 44.49% -> 44.49%             
client [59] (test)  loss: 22.7560 -> 2.1010   acc: 12.24% -> 19.24%            
client [48] (test)  loss: 1.6434 -> 1.7040   acc: 43.25% -> 44.63%             
client [34] (test)  loss: 1.9791 -> 1.9356   acc: 27.79% -> 30.79%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.0669 -> 1.9564   acc: 22.52% -> 25.68%             
client [99] (test)  loss: 1.9473 -> 1.8729   acc: 33.02% -> 32.08%             
client [67] (test)  loss: 1.7736 -> 1.6540   acc: 32.84% -> 37.28%             
client [0] (test)  loss: 1.8060 -> 1.7906   acc: 34.16% -> 40.74%              
client [76] (test)  loss: 1.6466 -> 1.6865   acc: 37.58% -> 42.48%             
client [41] (test)  loss: 1.8313 -> 1.7689   acc: 36.06% -> 39.41%             
client [62] (test)  loss: 6.9975 -> 1.5414   acc: 47.96% -> 45.24%             
client [2] (test)  loss: 24.8419 -> 1.8302   acc: 3.81% -> 40.83%              
client [14] (test)  loss: 1.8636 -> 1.7718   acc: 31.54% -> 38.59%             
client [46] (test)  loss: 1.8471 -> 1.9643   acc: 30.30% -> 23.42%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.4034 -> 2.4392   acc: 51.48% -> 14.79%             
client [68] (test)  loss: 1.7768 -> 2.0765   acc: 32.37% -> 16.67%             
client [57] (test)  loss: 2.2112 -> 1.7576   acc: 27.68% -> 41.37%             
client [17] (test)  loss: 1.8196 -> 1.4280   acc: 36.97% -> 47.87%             
client [54] (test)  loss: 1.6731 -> 1.5625   acc: 34.98% -> 38.34%             
client [23] (test)  loss: 23.2013 -> 1.6006   acc: 5.36% -> 34.70%             
client [35] (test)  loss: 1.7219 -> 2.1065   acc: 40.73% -> 30.18%             
client [59] (test)  loss: 2.0236 -> 2.0827   acc: 27.11% -> 24.78%             
client [31] (test)  loss: 1.9000 -> 1.7832   acc: 30.74% -> 34.98%             
client [9] (test)  loss: 1.4758 -> 1.6894   acc: 36.68% -> 28.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.5647 -> 1.9573   acc: 43.16% -> 36.47%             
client [33] (test)  loss: 1.6808 -> 1.7719   acc: 37.95% -> 36.30%             
client [16] (test)  loss: 1.7117 -> 1.3867   acc: 42.81% -> 48.32%             
client [44] (test)  loss: 2.5837 -> 1.6660   acc: 25.75% -> 43.48%             
client [8] (test)  loss: 1.5651 -> 1.7993   acc: 43.32% -> 33.25%              
client [31] (test)  loss: 1.8962 -> 1.7262   acc: 34.98% -> 39.93%             
client [47] (test)  loss: 3.5230 -> 1.6129   acc: 18.97% -> 37.30%             
client [36] (test)  loss: 1.5565 -> 1.7114   acc: 46.46% -> 38.15%             
client [20] (test)  loss: 1.7634 -> 1.4020   acc: 34.56% -> 54.78%             
client [56] (test)  loss: 1.9062 -> 2.0531   acc: 36.64% -> 25.57%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.4637 -> 1.9952   acc: 47.80% -> 32.14%              
client [60] (test)  loss: 2.6927 -> 1.3941   acc: 47.46% -> 52.54%             
client [28] (test)  loss: 2.8067 -> 1.9247   acc: 41.93% -> 29.19%             
client [25] (test)  loss: 2.2130 -> 1.9855   acc: 11.87% -> 14.84%             
client [58] (test)  loss: 1.6826 -> 4.5563   acc: 40.00% -> 11.08%             
client [44] (test)  loss: 1.6000 -> 1.6104   acc: 47.16% -> 45.15%             
client [39] (test)  loss: 1.4962 -> 1.8806   acc: 41.33% -> 32.44%             
client [29] (test)  loss: 3.2718 -> 1.7021   acc: 25.13% -> 36.43%             
client [3] (test)  loss: 1.5754 -> 1.6645   acc: 42.34% -> 41.94%              
client [84] (test)  loss: 1.4952 -> 2.8061   acc: 47.73% -> 25.00%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.9904 -> 2.0047   acc: 24.92% -> 38.30%             
client [84] (test)  loss: 1.5062 -> 2.8417   acc: 46.75% -> 25.00%             
client [10] (test)  loss: 1.8093 -> 6.9809   acc: 39.77% -> 8.71%              
client [36] (test)  loss: 1.4293 -> 1.4123   acc: 44.62% -> 50.46%             
client [65] (test)  loss: 1.4826 -> 1.5114   acc: 48.81% -> 49.60%             
client [81] (test)  loss: 1.6938 -> 2.7585   acc: 36.62% -> 23.08%             
client [79] (test)  loss: 1.5937 -> 1.7843   acc: 51.93% -> 35.91%             
client [42] (test)  loss: 1.5086 -> 2.6689   acc: 49.86% -> 26.61%             
client [11] (test)  loss: 1.6306 -> 2.0780   acc: 48.37% -> 35.37%             
client [96] (test)  loss: 1.6620 -> 1.5426   acc: 43.90% -> 42.28%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.1401 -> 1.4721   acc: 34.26% -> 43.83%              
client [53] (test)  loss: 1.5886 -> 1.4817   acc: 37.42% -> 44.19%             
client [52] (test)  loss: 1.5797 -> 1.5000   acc: 47.30% -> 53.65%             
client [42] (test)  loss: 2.2702 -> 1.7678   acc: 31.37% -> 31.93%             
client [69] (test)  loss: 1.6794 -> 2.3465   acc: 44.59% -> 20.72%             
client [59] (test)  loss: 2.0061 -> 2.4515   acc: 34.40% -> 23.91%             
client [7] (test)  loss: 5.7812 -> 1.7267   acc: 20.05% -> 41.37%              
client [26] (test)  loss: 1.9649 -> 1.5512   acc: 40.97% -> 52.16%             
client [49] (test)  loss: 1.1069 -> 1.1853   acc: 59.94% -> 53.31%             
client [98] (test)  loss: 1.4821 -> 1.4671   acc: 43.70% -> 43.70%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4120 -> 1.4758   acc: 43.28% -> 42.86%             
client [47] (test)  loss: 2.0780 -> 1.4528   acc: 26.05% -> 45.34%             
client [21] (test)  loss: 1.4963 -> 2.3629   acc: 43.16% -> 38.60%             
client [77] (test)  loss: 1.5273 -> 1.4664   acc: 41.45% -> 44.04%             
client [95] (test)  loss: 1.3957 -> 1.6155   acc: 51.67% -> 40.43%             
client [91] (test)  loss: 0.9963 -> 1.1990   acc: 64.62% -> 55.15%             
client [14] (test)  loss: 1.3414 -> 1.7924   acc: 53.53% -> 40.25%             
client [99] (test)  loss: 1.5778 -> 1.5274   acc: 43.87% -> 41.51%             
client [20] (test)  loss: 1.2787 -> 1.1424   acc: 57.35% -> 64.34%             
client [39] (test)  loss: 1.4527 -> 1.8452   acc: 40.89% -> 35.56%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.3691 -> 1.4097   acc: 57.14% -> 56.51%             
client [62] (test)  loss: 1.1538 -> 2.2474   acc: 59.52% -> 20.07%             
client [71] (test)  loss: 1.5090 -> 1.4587   acc: 46.85% -> 46.40%             
client [97] (test)  loss: 1.3144 -> 1.2590   acc: 40.82% -> 49.06%             
client [30] (test)  loss: 1.2851 -> 2.8155   acc: 54.30% -> 24.93%             
client [88] (test)  loss: 1.6368 -> 1.7554   acc: 38.87% -> 34.22%             
client [60] (test)  loss: 1.3054 -> 1.3738   acc: 53.81% -> 51.27%             
client [82] (test)  loss: 1.3706 -> 1.4533   acc: 52.10% -> 56.29%             
client [91] (test)  loss: 1.0308 -> 1.1449   acc: 64.35% -> 61.84%             
client [57] (test)  loss: 1.5490 -> 1.6590   acc: 44.05% -> 43.15%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5381 -> 1.5531   acc: 40.28% -> 48.76%             
client [15] (test)  loss: 1.5981 -> 2.2421   acc: 36.54% -> 34.62%             
client [71] (test)  loss: 1.6920 -> 1.5546   acc: 36.94% -> 45.95%             
client [97] (test)  loss: 1.3963 -> 1.2585   acc: 46.44% -> 49.81%             
client [53] (test)  loss: 1.3382 -> 1.3924   acc: 49.68% -> 47.74%             
client [77] (test)  loss: 1.4305 -> 1.4449   acc: 43.52% -> 48.19%             
client [76] (test)  loss: 1.4286 -> 1.4326   acc: 49.67% -> 51.31%             
client [79] (test)  loss: 1.4277 -> 2.1664   acc: 51.93% -> 24.31%             
client [28] (test)  loss: 1.1562 -> 2.2614   acc: 58.07% -> 30.43%             
client [99] (test)  loss: 1.5131 -> 1.5270   acc: 47.17% -> 43.87%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.0958 -> 1.1989   acc: 54.31% -> 53.18%             
client [86] (test)  loss: 1.1389 -> 1.5238   acc: 61.31% -> 49.11%             
client [34] (test)  loss: 1.5120 -> 1.9162   acc: 41.69% -> 37.33%             
client [73] (test)  loss: 1.4253 -> 2.3025   acc: 50.37% -> 28.52%             
client [5] (test)  loss: 1.5265 -> 1.5415   acc: 41.71% -> 39.57%              
client [96] (test)  loss: 1.5311 -> 1.5370   acc: 43.50% -> 43.50%             
client [22] (test)  loss: 1.2698 -> 1.3800   acc: 58.60% -> 54.23%             
client [60] (test)  loss: 1.3916 -> 1.3846   acc: 51.69% -> 51.27%             
client [66] (test)  loss: 1.3425 -> 1.8711   acc: 51.52% -> 38.78%             
client [83] (test)  loss: 1.7060 -> 1.5292   acc: 43.28% -> 44.40%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.3367 -> 1.3706   acc: 51.63% -> 53.27%             
client [65] (test)  loss: 1.2966 -> 1.7035   acc: 54.76% -> 46.43%             
client [95] (test)  loss: 1.4427 -> 1.5220   acc: 50.15% -> 44.07%             
client [17] (test)  loss: 1.3055 -> 1.2806   acc: 55.45% -> 57.82%             
client [8] (test)  loss: 1.5517 -> 1.3731   acc: 44.84% -> 50.88%              
client [35] (test)  loss: 1.4465 -> 1.4844   acc: 50.18% -> 46.55%             
client [98] (test)  loss: 1.2796 -> 1.6241   acc: 51.26% -> 37.82%             
client [53] (test)  loss: 1.3135 -> 1.3585   acc: 50.65% -> 49.03%             
client [43] (test)  loss: 0.9701 -> 1.2699   acc: 58.64% -> 50.00%             
client [64] (test)  loss: 1.2566 -> 1.2378   acc: 53.19% -> 54.71%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.4476 -> 1.9816   acc: 45.59% -> 44.68%             
client [88] (test)  loss: 1.5077 -> 3.8215   acc: 43.85% -> 16.94%             
client [38] (test)  loss: 1.3636 -> 1.3380   acc: 48.80% -> 49.60%             
client [3] (test)  loss: 1.3153 -> 1.3471   acc: 52.82% -> 47.18%              
client [5] (test)  loss: 1.4844 -> 1.5540   acc: 42.78% -> 37.97%              
client [41] (test)  loss: 1.2974 -> 2.0205   acc: 48.33% -> 35.69%             
client [7] (test)  loss: 0.9322 -> 1.7349   acc: 65.74% -> 46.70%              
client [37] (test)  loss: 0.9554 -> 1.6080   acc: 70.59% -> 48.24%             
client [45] (test)  loss: 1.3202 -> 1.5126   acc: 49.34% -> 43.75%             
client [47] (test)  loss: 1.3707 -> 1.3955   acc: 48.23% -> 43.73%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.2755 -> 1.2226   acc: 52.91% -> 51.07%             
client [11] (test)  loss: 1.4027 -> 1.4172   acc: 55.69% -> 53.66%             
client [37] (test)  loss: 0.9450 -> 1.5993   acc: 72.35% -> 48.82%             
client [41] (test)  loss: 1.2545 -> 2.0158   acc: 53.90% -> 36.06%             
client [95] (test)  loss: 1.6788 -> 1.5793   acc: 46.50% -> 37.99%             
client [53] (test)  loss: 1.2880 -> 1.3214   acc: 51.61% -> 50.32%             
client [22] (test)  loss: 1.5357 -> 1.3679   acc: 49.56% -> 55.39%             
client [25] (test)  loss: 1.3993 -> 1.6365   acc: 42.43% -> 40.06%             
client [69] (test)  loss: 1.4925 -> 2.4741   acc: 46.40% -> 23.42%             
client [46] (test)  loss: 1.2659 -> 1.4473   acc: 60.06% -> 55.10%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.3425 -> 1.3363   acc: 49.84% -> 48.87%             
client [69] (test)  loss: 1.4444 -> 2.3388   acc: 46.40% -> 22.97%             
client [82] (test)  loss: 1.2579 -> 1.3384   acc: 56.64% -> 56.99%             
client [45] (test)  loss: 1.3109 -> 1.4577   acc: 48.36% -> 49.34%             
client [7] (test)  loss: 0.8753 -> 1.6702   acc: 65.23% -> 47.21%              
client [50] (test)  loss: 1.2425 -> 1.2191   acc: 59.60% -> 61.20%             
client [35] (test)  loss: 1.4622 -> 1.3478   acc: 48.36% -> 51.27%             
client [24] (test)  loss: 1.0911 -> 1.9622   acc: 58.88% -> 37.28%             
client [15] (test)  loss: 1.3426 -> 2.0475   acc: 50.00% -> 39.42%             
client [58] (test)  loss: 1.4142 -> 2.4374   acc: 47.08% -> 30.46%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.2701 -> 1.8739   acc: 53.17% -> 36.64%             
client [76] (test)  loss: 1.2843 -> 1.2770   acc: 56.54% -> 56.86%             
client [67] (test)  loss: 1.2567 -> 1.3127   acc: 53.85% -> 52.07%             
client [37] (test)  loss: 1.0488 -> 1.8557   acc: 64.71% -> 48.24%             
client [58] (test)  loss: 1.4209 -> 2.4985   acc: 48.92% -> 31.08%             
client [64] (test)  loss: 1.2029 -> 1.2145   acc: 53.80% -> 54.10%             
client [77] (test)  loss: 1.3350 -> 1.5653   acc: 45.08% -> 43.52%             
client [55] (test)  loss: 1.2548 -> 1.1907   acc: 61.22% -> 63.67%             
client [12] (test)  loss: 0.9680 -> 0.9965   acc: 68.72% -> 68.18%             
client [89] (test)  loss: 1.5111 -> 2.7562   acc: 47.22% -> 21.30%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.2313 -> 1.9505   acc: 55.84% -> 46.75%             
client [51] (test)  loss: 1.3586 -> 1.9359   acc: 49.01% -> 29.80%             
client [8] (test)  loss: 1.3946 -> 1.3507   acc: 50.88% -> 51.64%              
client [18] (test)  loss: 0.9193 -> 1.1742   acc: 72.31% -> 67.75%             
client [94] (test)  loss: 1.4524 -> 1.6899   acc: 50.70% -> 46.48%             
client [81] (test)  loss: 1.5655 -> 2.1392   acc: 45.85% -> 33.23%             
client [3] (test)  loss: 1.2528 -> 1.3711   acc: 54.44% -> 48.39%              
client [11] (test)  loss: 1.3154 -> 1.5306   acc: 56.50% -> 49.19%             
client [95] (test)  loss: 1.2995 -> 1.3244   acc: 50.15% -> 51.98%             
client [67] (test)  loss: 1.1490 -> 1.2681   acc: 59.76% -> 52.66%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.2805 -> 1.7002   acc: 55.02% -> 45.90%             
client [79] (test)  loss: 1.3498 -> 1.9914   acc: 54.70% -> 39.78%             
client [58] (test)  loss: 1.4261 -> 2.5370   acc: 48.62% -> 31.69%             
client [88] (test)  loss: 1.5566 -> 4.8571   acc: 44.85% -> 16.94%             
client [46] (test)  loss: 1.2996 -> 1.4553   acc: 60.61% -> 55.10%             
client [11] (test)  loss: 1.2937 -> 1.5800   acc: 57.32% -> 47.15%             
client [55] (test)  loss: 1.2267 -> 1.2083   acc: 60.41% -> 64.08%             
client [13] (test)  loss: 1.2820 -> 1.6810   acc: 57.26% -> 51.21%             
client [31] (test)  loss: 1.3838 -> 1.3901   acc: 46.64% -> 50.88%             
client [75] (test)  loss: 0.9950 -> 1.6477   acc: 64.33% -> 52.30%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.3820 -> 1.4280   acc: 49.80% -> 51.84%             
client [7] (test)  loss: 0.8052 -> 1.3503   acc: 69.04% -> 56.09%              
client [57] (test)  loss: 1.4659 -> 1.5198   acc: 47.02% -> 44.94%             
client [13] (test)  loss: 1.2908 -> 1.7547   acc: 56.85% -> 49.60%             
client [43] (test)  loss: 0.8814 -> 1.1399   acc: 63.58% -> 51.23%             
client [91] (test)  loss: 1.0148 -> 1.0466   acc: 64.07% -> 66.85%             
client [10] (test)  loss: 1.2619 -> 4.7148   acc: 53.03% -> 9.85%              
client [64] (test)  loss: 1.2207 -> 1.2273   acc: 55.93% -> 56.23%             
client [82] (test)  loss: 1.2277 -> 1.4341   acc: 59.44% -> 55.24%             
client [22] (test)  loss: 1.2791 -> 1.2579   acc: 58.60% -> 57.43%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0631 -> 1.0142   acc: 66.54% -> 66.54%             
client [23] (test)  loss: 1.3677 -> 1.4836   acc: 47.32% -> 42.59%             
client [88] (test)  loss: 1.4309 -> 5.1988   acc: 51.16% -> 16.94%             
client [98] (test)  loss: 1.1930 -> 1.4351   acc: 55.04% -> 44.12%             
client [79] (test)  loss: 1.4397 -> 1.8661   acc: 51.93% -> 41.44%             
client [21] (test)  loss: 1.3992 -> 1.6946   acc: 51.67% -> 47.11%             
client [92] (test)  loss: 1.5809 -> 1.3442   acc: 42.62% -> 51.80%             
client [56] (test)  loss: 1.4629 -> 2.3440   acc: 51.53% -> 39.31%             
client [5] (test)  loss: 1.3469 -> 1.6941   acc: 50.80% -> 40.11%              
client [52] (test)  loss: 1.1310 -> 1.3519   acc: 64.76% -> 57.78%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '1.4251 -> 0.0000', 'accuracy': '49.59% -> 0.00%'},          
    200: {'loss': '1.2922 -> 0.0000', 'accuracy': '55.25% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(14.67%) at epoch: 1                                    
FedRep_1 achieved 20.0%(21.20%) at epoch: 3                                    
FedRep_1 achieved 30.0%(33.09%) at epoch: 7                                    
FedRep_1 achieved 40.0%(41.13%) at epoch: 24                                   
FedRep_1 achieved 50.0%(50.89%) at epoch: 57                                   
Convergence (test_after):                                                      
FedRep_1 achieved 20.0%(26.81%) at epoch: 0                                    
FedRep_1 achieved 30.0%(31.73%) at epoch: 3                                    
FedRep_1 achieved 40.0%(42.07%) at epoch: 27                                   
FedRep_1 achieved 50.0%(50.02%) at epoch: 117                                  
