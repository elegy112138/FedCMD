==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.8241 -> 1.6979   acc: 43.86% -> 46.74%             
client [81] (test)  loss: 2.1165 -> 2.0292   acc: 19.91% -> 30.09%             
client [21] (test)  loss: 2.3211 -> 1.8336   acc: 22.43% -> 28.04%             
client [68] (test)  loss: 1.8386 -> 1.6604   acc: 32.73% -> 39.57%             
client [93] (test)  loss: 0.8815 -> 0.7636   acc: 78.78% -> 78.78%             
client [31] (test)  loss: 2.3202 -> 2.0647   acc: 18.06% -> 25.55%             
client [20] (test)  loss: 1.4469 -> 1.2593   acc: 46.41% -> 53.92%             
client [59] (test)  loss: 2.3080 -> 1.7905   acc: 17.88% -> 37.42%             
client [48] (test)  loss: 1.7203 -> 1.6496   acc: 38.85% -> 42.23%             
client [34] (test)  loss: 1.3821 -> 1.2230   acc: 52.96% -> 52.96%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6441 -> 1.3183   acc: 38.80% -> 61.54%             
client [99] (test)  loss: 1.7158 -> 1.5510   acc: 41.38% -> 41.38%             
client [67] (test)  loss: 1.6810 -> 1.5379   acc: 37.07% -> 39.38%             
client [0] (test)  loss: 1.2580 -> 1.1426   acc: 56.72% -> 61.64%              
client [76] (test)  loss: 1.6690 -> 1.5764   acc: 43.60% -> 45.23%             
client [41] (test)  loss: 2.0449 -> 1.6964   acc: 38.00% -> 43.60%             
client [62] (test)  loss: 2.2958 -> 1.2099   acc: 21.43% -> 54.86%             
client [2] (test)  loss: 2.1971 -> 1.3637   acc: 25.15% -> 52.99%              
client [14] (test)  loss: 1.2629 -> 1.1629   acc: 48.18% -> 49.09%             
client [46] (test)  loss: 1.3709 -> 1.2903   acc: 43.16% -> 59.40%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.4361 -> 1.3642   acc: 45.94% -> 51.78%             
client [68] (test)  loss: 1.2306 -> 1.1825   acc: 54.32% -> 66.19%             
client [57] (test)  loss: 1.6655 -> 1.5996   acc: 41.33% -> 53.57%             
client [17] (test)  loss: 1.5736 -> 1.4747   acc: 44.52% -> 47.95%             
client [54] (test)  loss: 1.3874 -> 1.3429   acc: 47.53% -> 47.53%             
client [23] (test)  loss: 2.1209 -> 1.1571   acc: 24.72% -> 50.56%             
client [35] (test)  loss: 1.3150 -> 1.2427   acc: 69.91% -> 69.68%             
client [59] (test)  loss: 1.3834 -> 1.2982   acc: 55.63% -> 59.60%             
client [31] (test)  loss: 1.7358 -> 1.7242   acc: 39.21% -> 39.65%             
client [9] (test)  loss: 1.4280 -> 1.3690   acc: 47.79% -> 51.92%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.3170 -> 1.2897   acc: 56.96% -> 56.33%             
client [33] (test)  loss: 0.9497 -> 0.9281   acc: 65.91% -> 67.21%             
client [16] (test)  loss: 0.9395 -> 0.9022   acc: 67.66% -> 69.89%             
client [44] (test)  loss: 1.5923 -> 1.1497   acc: 47.88% -> 66.01%             
client [8] (test)  loss: 0.8565 -> 0.8247   acc: 72.13% -> 74.43%              
client [31] (test)  loss: 1.5999 -> 1.5974   acc: 41.41% -> 42.73%             
client [47] (test)  loss: 1.0294 -> 0.9152   acc: 57.83% -> 64.46%             
client [36] (test)  loss: 1.2876 -> 1.2200   acc: 62.83% -> 61.84%             
client [20] (test)  loss: 0.7727 -> 0.7310   acc: 72.88% -> 76.47%             
client [56] (test)  loss: 0.9155 -> 0.8212   acc: 69.33% -> 74.54%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8379 -> 0.7714   acc: 71.99% -> 74.27%              
client [60] (test)  loss: 0.8362 -> 0.6751   acc: 72.22% -> 79.01%             
client [28] (test)  loss: 1.5584 -> 1.4277   acc: 38.10% -> 55.95%             
client [25] (test)  loss: 1.3212 -> 0.9088   acc: 56.23% -> 72.52%             
client [58] (test)  loss: 0.7902 -> 0.7490   acc: 74.81% -> 76.07%             
client [44] (test)  loss: 1.0686 -> 1.0111   acc: 66.57% -> 68.27%             
client [39] (test)  loss: 0.8882 -> 0.8491   acc: 72.97% -> 72.67%             
client [29] (test)  loss: 1.3986 -> 1.2897   acc: 51.50% -> 59.66%             
client [3] (test)  loss: 0.6964 -> 0.6615   acc: 78.76% -> 80.39%              
client [84] (test)  loss: 1.3719 -> 1.3599   acc: 52.67% -> 53.74%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9566 -> 0.8421   acc: 64.80% -> 72.90%             
client [84] (test)  loss: 1.2405 -> 1.2319   acc: 58.01% -> 59.79%             
client [10] (test)  loss: 0.9723 -> 0.9279   acc: 67.97% -> 71.48%             
client [36] (test)  loss: 1.0108 -> 0.9701   acc: 67.76% -> 68.42%             
client [65] (test)  loss: 0.7565 -> 0.7405   acc: 74.04% -> 77.24%             
client [81] (test)  loss: 1.5240 -> 1.4373   acc: 50.00% -> 57.08%             
client [79] (test)  loss: 1.2031 -> 1.1668   acc: 56.36% -> 60.45%             
client [42] (test)  loss: 1.2451 -> 1.2344   acc: 57.06% -> 56.76%             
client [11] (test)  loss: 1.3159 -> 1.2838   acc: 61.34% -> 61.34%             
client [96] (test)  loss: 1.1765 -> 1.1166   acc: 59.57% -> 62.06%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6282 -> 0.6034   acc: 84.26% -> 83.93%              
client [53] (test)  loss: 0.9575 -> 0.9507   acc: 67.06% -> 64.31%             
client [52] (test)  loss: 0.6157 -> 0.5643   acc: 82.43% -> 83.39%             
client [42] (test)  loss: 1.1704 -> 1.1588   acc: 59.46% -> 59.46%             
client [69] (test)  loss: 0.6898 -> 0.6965   acc: 77.93% -> 75.92%             
client [59] (test)  loss: 0.7719 -> 0.7382   acc: 75.17% -> 78.15%             
client [7] (test)  loss: 0.6858 -> 0.5968   acc: 79.83% -> 79.83%              
client [26] (test)  loss: 0.4230 -> 0.5518   acc: 86.99% -> 80.87%             
client [49] (test)  loss: 0.4526 -> 0.4337   acc: 86.04% -> 87.99%             
client [98] (test)  loss: 0.9216 -> 0.8983   acc: 75.39% -> 76.44%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8422 -> 0.8217   acc: 78.53% -> 79.58%             
client [47] (test)  loss: 0.7915 -> 0.7056   acc: 66.27% -> 71.39%             
client [21] (test)  loss: 0.7376 -> 0.7102   acc: 75.08% -> 75.08%             
client [77] (test)  loss: 0.9542 -> 0.9585   acc: 70.76% -> 70.50%             
client [95] (test)  loss: 1.1329 -> 1.1355   acc: 59.44% -> 59.84%             
client [91] (test)  loss: 1.1615 -> 1.1300   acc: 61.50% -> 62.03%             
client [14] (test)  loss: 0.5023 -> 0.4867   acc: 83.64% -> 84.55%             
client [99] (test)  loss: 0.9364 -> 0.9137   acc: 72.41% -> 74.14%             
client [20] (test)  loss: 0.5303 -> 0.5042   acc: 83.99% -> 85.62%             
client [39] (test)  loss: 0.6813 -> 0.6552   acc: 77.62% -> 77.62%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5356 -> 0.5042   acc: 82.11% -> 84.35%             
client [62] (test)  loss: 0.6057 -> 0.5761   acc: 77.71% -> 80.29%             
client [71] (test)  loss: 0.7821 -> 0.7528   acc: 79.20% -> 79.20%             
client [97] (test)  loss: 0.5417 -> 0.4938   acc: 80.59% -> 81.94%             
client [30] (test)  loss: 0.4919 -> 0.4621   acc: 82.28% -> 82.28%             
client [88] (test)  loss: 0.4588 -> 0.4117   acc: 87.50% -> 87.82%             
client [60] (test)  loss: 0.4155 -> 0.3870   acc: 87.96% -> 90.12%             
client [82] (test)  loss: 0.8240 -> 0.8076   acc: 72.82% -> 73.14%             
client [91] (test)  loss: 1.0766 -> 1.0593   acc: 63.64% -> 64.17%             
client [57] (test)  loss: 1.0616 -> 1.1172   acc: 67.35% -> 61.73%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9648 -> 1.3923   acc: 66.96% -> 51.98%             
client [15] (test)  loss: 0.3979 -> 0.3891   acc: 89.38% -> 88.44%             
client [71] (test)  loss: 0.7105 -> 0.6973   acc: 79.20% -> 80.80%             
client [97] (test)  loss: 0.4531 -> 0.4435   acc: 82.75% -> 83.29%             
client [53] (test)  loss: 0.7928 -> 0.8278   acc: 69.80% -> 69.02%             
client [77] (test)  loss: 0.8906 -> 0.9033   acc: 72.06% -> 71.02%             
client [76] (test)  loss: 0.7892 -> 0.7739   acc: 73.57% -> 75.20%             
client [79] (test)  loss: 0.9031 -> 0.8793   acc: 66.36% -> 73.18%             
client [28] (test)  loss: 1.0593 -> 1.0316   acc: 60.32% -> 61.51%             
client [99] (test)  loss: 0.8446 -> 0.8331   acc: 75.17% -> 77.24%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4205 -> 0.4130   acc: 85.18% -> 85.44%             
client [86] (test)  loss: 0.7958 -> 1.0192   acc: 70.77% -> 62.56%             
client [34] (test)  loss: 0.5653 -> 0.5035   acc: 76.34% -> 77.96%             
client [73] (test)  loss: 0.5403 -> 0.5319   acc: 84.21% -> 83.81%             
client [5] (test)  loss: 0.4490 -> 0.4099   acc: 83.24% -> 84.34%              
client [96] (test)  loss: 0.8860 -> 0.8895   acc: 68.79% -> 68.79%             
client [22] (test)  loss: 0.7588 -> 0.7469   acc: 75.56% -> 75.56%             
client [60] (test)  loss: 0.3391 -> 0.3373   acc: 90.74% -> 91.67%             
client [66] (test)  loss: 0.8219 -> 0.7932   acc: 73.55% -> 73.91%             
client [83] (test)  loss: 0.7496 -> 0.7324   acc: 74.38% -> 75.86%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6935 -> 0.6859   acc: 75.75% -> 77.11%             
client [65] (test)  loss: 0.5399 -> 0.5432   acc: 82.37% -> 84.62%             
client [95] (test)  loss: 0.9523 -> 0.9517   acc: 66.27% -> 64.26%             
client [17] (test)  loss: 0.8490 -> 0.8352   acc: 67.81% -> 65.75%             
client [8] (test)  loss: 0.4426 -> 0.4285   acc: 85.90% -> 86.23%              
client [35] (test)  loss: 0.6692 -> 0.6811   acc: 81.25% -> 80.79%             
client [98] (test)  loss: 0.6510 -> 0.6367   acc: 81.68% -> 83.25%             
client [53] (test)  loss: 0.7514 -> 0.7851   acc: 70.20% -> 70.98%             
client [43] (test)  loss: 0.5978 -> 0.5707   acc: 79.12% -> 81.57%             
client [64] (test)  loss: 0.7401 -> 0.7405   acc: 78.48% -> 80.38%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5938 -> 0.5894   acc: 79.13% -> 80.06%             
client [88] (test)  loss: 0.3150 -> 0.3058   acc: 88.78% -> 89.10%             
client [38] (test)  loss: 0.5677 -> 0.5525   acc: 80.71% -> 82.20%             
client [3] (test)  loss: 0.3955 -> 0.3880   acc: 89.54% -> 88.24%              
client [5] (test)  loss: 0.4147 -> 0.3703   acc: 84.62% -> 85.71%              
client [41] (test)  loss: 0.7488 -> 0.7518   acc: 76.40% -> 75.60%             
client [7] (test)  loss: 0.4242 -> 0.4313   acc: 86.17% -> 87.61%              
client [37] (test)  loss: 0.6733 -> 0.6686   acc: 76.00% -> 76.33%             
client [45] (test)  loss: 0.7031 -> 0.6661   acc: 73.50% -> 78.55%             
client [47] (test)  loss: 0.6034 -> 0.5505   acc: 78.01% -> 79.22%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4901 -> 0.4886   acc: 80.30% -> 81.41%             
client [11] (test)  loss: 0.8933 -> 0.8510   acc: 68.49% -> 74.79%             
client [37] (test)  loss: 0.6457 -> 0.6370   acc: 77.67% -> 78.33%             
client [41] (test)  loss: 0.7277 -> 0.7414   acc: 77.20% -> 74.80%             
client [95] (test)  loss: 0.8832 -> 0.8754   acc: 67.07% -> 66.67%             
client [53] (test)  loss: 0.7033 -> 0.7540   acc: 72.16% -> 72.16%             
client [22] (test)  loss: 0.6501 -> 0.6361   acc: 79.44% -> 78.89%             
client [25] (test)  loss: 0.5175 -> 0.5076   acc: 85.62% -> 85.30%             
client [69] (test)  loss: 0.5215 -> 0.5239   acc: 82.61% -> 82.61%             
client [46] (test)  loss: 0.5509 -> 0.6264   acc: 80.77% -> 80.77%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4803 -> 0.4851   acc: 81.33% -> 81.33%             
client [69] (test)  loss: 0.4969 -> 0.5098   acc: 82.94% -> 82.94%             
client [82] (test)  loss: 0.6492 -> 0.6345   acc: 80.26% -> 82.20%             
client [45] (test)  loss: 0.6198 -> 0.6202   acc: 79.50% -> 79.81%             
client [7] (test)  loss: 0.3862 -> 0.4036   acc: 88.76% -> 88.47%              
client [50] (test)  loss: 0.4560 -> 0.4643   acc: 83.94% -> 84.31%             
client [35] (test)  loss: 0.5956 -> 0.5941   acc: 83.80% -> 82.87%             
client [24] (test)  loss: 0.6916 -> 0.7559   acc: 72.34% -> 71.57%             
client [15] (test)  loss: 0.2763 -> 0.2692   acc: 92.19% -> 91.56%             
client [58] (test)  loss: 0.4083 -> 0.4337   acc: 86.90% -> 86.15%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5583 -> 0.6179   acc: 80.07% -> 78.72%             
client [76] (test)  loss: 0.5761 -> 0.5769   acc: 80.38% -> 79.29%             
client [67] (test)  loss: 0.7244 -> 0.7207   acc: 81.85% -> 78.76%             
client [37] (test)  loss: 0.5805 -> 0.6044   acc: 81.00% -> 78.67%             
client [58] (test)  loss: 0.4017 -> 0.4193   acc: 86.90% -> 86.15%             
client [64] (test)  loss: 0.6163 -> 0.6230   acc: 81.01% -> 81.65%             
client [77] (test)  loss: 0.7158 -> 0.7654   acc: 76.50% -> 73.63%             
client [55] (test)  loss: 0.7496 -> 0.7153   acc: 82.53% -> 84.94%             
client [12] (test)  loss: 0.6383 -> 0.6039   acc: 77.56% -> 79.53%             
client [89] (test)  loss: 0.4239 -> 0.4140   acc: 88.18% -> 88.18%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6743 -> 0.6860   acc: 73.67% -> 72.95%             
client [51] (test)  loss: 0.6064 -> 0.7591   acc: 79.49% -> 72.22%             
client [8] (test)  loss: 0.3432 -> 0.3319   acc: 89.51% -> 89.18%              
client [18] (test)  loss: 0.1580 -> 0.1547   acc: 95.05% -> 94.39%             
client [94] (test)  loss: 0.3932 -> 0.3847   acc: 86.33% -> 87.11%             
client [81] (test)  loss: 0.8582 -> 0.8568   acc: 72.57% -> 72.12%             
client [3] (test)  loss: 0.3253 -> 0.3295   acc: 91.50% -> 91.18%              
client [11] (test)  loss: 0.7771 -> 0.7948   acc: 74.37% -> 76.47%             
client [95] (test)  loss: 0.7738 -> 0.7870   acc: 71.89% -> 72.29%             
client [67] (test)  loss: 0.7136 -> 0.7070   acc: 81.85% -> 79.92%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5308 -> 0.5265   acc: 84.74% -> 84.74%             
client [79] (test)  loss: 0.6219 -> 0.6203   acc: 80.00% -> 79.55%             
client [58] (test)  loss: 0.3708 -> 0.3838   acc: 88.16% -> 87.41%             
client [88] (test)  loss: 0.2485 -> 0.2469   acc: 91.67% -> 91.99%             
client [46] (test)  loss: 0.4647 -> 0.5036   acc: 84.62% -> 85.04%             
client [11] (test)  loss: 0.7573 -> 0.7745   acc: 75.63% -> 78.15%             
client [55] (test)  loss: 0.6753 -> 0.6658   acc: 87.35% -> 86.75%             
client [13] (test)  loss: 0.4291 -> 0.4178   acc: 88.20% -> 88.76%             
client [31] (test)  loss: 0.7903 -> 0.9981   acc: 73.13% -> 67.40%             
client [75] (test)  loss: 0.5493 -> 0.5621   acc: 82.01% -> 83.07%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4010 -> 0.3977   acc: 89.26% -> 90.18%             
client [7] (test)  loss: 0.3539 -> 0.3664   acc: 90.78% -> 89.63%              
client [57] (test)  loss: 0.6986 -> 0.7088   acc: 77.04% -> 76.53%             
client [13] (test)  loss: 0.4161 -> 0.4030   acc: 87.92% -> 88.48%             
client [43] (test)  loss: 0.4276 -> 0.4475   acc: 85.50% -> 83.78%             
client [91] (test)  loss: 0.7175 -> 0.7100   acc: 80.21% -> 79.14%             
client [10] (test)  loss: 0.4613 -> 0.4582   acc: 84.77% -> 85.94%             
client [64] (test)  loss: 0.5409 -> 0.5413   acc: 84.18% -> 83.54%             
client [82] (test)  loss: 0.5587 -> 0.5702   acc: 83.17% -> 83.82%             
client [22] (test)  loss: 0.4964 -> 0.5040   acc: 82.22% -> 83.33%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3859 -> 0.3759   acc: 87.25% -> 88.56%             
client [23] (test)  loss: 0.4067 -> 0.3900   acc: 85.83% -> 87.22%             
client [88] (test)  loss: 0.2277 -> 0.2301   acc: 91.03% -> 91.99%             
client [98] (test)  loss: 0.4827 -> 0.4763   acc: 86.39% -> 86.39%             
client [79] (test)  loss: 0.5831 -> 0.5939   acc: 81.36% -> 80.91%             
client [21] (test)  loss: 0.5052 -> 0.5080   acc: 85.67% -> 85.36%             
client [92] (test)  loss: 0.6992 -> 0.6946   acc: 75.38% -> 75.00%             
client [56] (test)  loss: 0.2392 -> 0.3157   acc: 92.94% -> 88.65%             
client [5] (test)  loss: 0.3177 -> 0.2962   acc: 89.29% -> 89.29%              
client [52] (test)  loss: 0.3743 -> 0.3611   acc: 89.14% -> 88.82%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.6764 -> 0.0000', 'accuracy': '77.97% -> 0.00%'},          
    200: {'loss': '0.4688 -> 0.0000', 'accuracy': '84.93% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(15.55%) at epoch: 0                                    
FedRep_1 achieved 20.0%(21.11%) at epoch: 1                                    
FedRep_1 achieved 30.0%(37.21%) at epoch: 3                                    
FedRep_1 achieved 40.0%(44.95%) at epoch: 18                                   
FedRep_1 achieved 50.0%(50.11%) at epoch: 20                                   
FedRep_1 achieved 60.0%(62.42%) at epoch: 34                                   
FedRep_1 achieved 70.0%(72.01%) at epoch: 45                                   
FedRep_1 achieved 80.0%(81.63%) at epoch: 97                                   
Convergence (test_after):                                                      
FedRep_1 achieved 30.0%(33.09%) at epoch: 0                                    
FedRep_1 achieved 40.0%(48.25%) at epoch: 5                                    
FedRep_1 achieved 50.0%(50.38%) at epoch: 12                                   
FedRep_1 achieved 60.0%(60.01%) at epoch: 28                                   
FedRep_1 achieved 70.0%(73.89%) at epoch: 45                                   
FedRep_1 achieved 80.0%(80.37%) at epoch: 78                                   
