==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2405 -> 5.1720   acc: 2.52% -> 2.52%               
client [81] (test)  loss: 5.2720 -> 5.2099   acc: 1.85% -> 2.58%               
client [21] (test)  loss: 5.2902 -> 5.1862   acc: 0.18% -> 2.00%               
client [68] (test)  loss: 5.2478 -> 5.0713   acc: 1.27% -> 4.88%               
client [93] (test)  loss: 5.2850 -> 5.1688   acc: 0.54% -> 1.45%               
client [31] (test)  loss: 5.3662 -> 5.2226   acc: 0.18% -> 1.26%               
client [20] (test)  loss: 5.1575 -> 5.0784   acc: 7.94% -> 7.94%               
client [59] (test)  loss: 5.2908 -> 5.2061   acc: 0.55% -> 1.27%               
client [48] (test)  loss: 5.1720 -> 5.1233   acc: 2.15% -> 2.15%               
client [34] (test)  loss: 5.2136 -> 5.1383   acc: 1.82% -> 1.64%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.3791 -> 5.1080   acc: 0.19% -> 2.22%               
client [99] (test)  loss: 5.1687 -> 5.0778   acc: 1.99% -> 1.62%               
client [67] (test)  loss: 5.0644 -> 5.0259   acc: 3.17% -> 3.54%               
client [0] (test)  loss: 5.0552 -> 5.0084   acc: 3.26% -> 3.26%                
client [76] (test)  loss: 4.9601 -> 4.9008   acc: 3.27% -> 4.36%               
client [41] (test)  loss: 5.2155 -> 5.1008   acc: 1.99% -> 1.63%               
client [62] (test)  loss: 5.2916 -> 5.1342   acc: 0.90% -> 3.41%               
client [2] (test)  loss: 5.3258 -> 5.0630   acc: 0.77% -> 5.37%                
client [14] (test)  loss: 5.1213 -> 5.1400   acc: 1.81% -> 3.79%               
client [46] (test)  loss: 5.0684 -> 5.0024   acc: 3.27% -> 3.27%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7251 -> 4.7485   acc: 11.76% -> 12.12%             
client [68] (test)  loss: 4.9288 -> 4.9257   acc: 4.88% -> 5.97%               
client [57] (test)  loss: 5.1309 -> 5.1072   acc: 1.27% -> 2.36%               
client [17] (test)  loss: 5.1066 -> 5.0834   acc: 3.60% -> 4.14%               
client [54] (test)  loss: 5.0067 -> 4.9921   acc: 2.00% -> 1.81%               
client [23] (test)  loss: 5.3136 -> 5.0876   acc: 1.08% -> 1.81%               
client [35] (test)  loss: 5.0075 -> 4.9924   acc: 1.27% -> 1.63%               
client [59] (test)  loss: 5.0016 -> 4.9789   acc: 1.27% -> 1.82%               
client [31] (test)  loss: 5.1236 -> 5.1452   acc: 4.68% -> 4.50%               
client [9] (test)  loss: 5.1669 -> 5.1791   acc: 2.17% -> 2.71%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.0860 -> 5.0958   acc: 4.46% -> 4.28%               
client [33] (test)  loss: 5.1092 -> 5.1995   acc: 2.54% -> 2.54%               
client [16] (test)  loss: 4.9960 -> 4.9906   acc: 3.05% -> 4.67%               
client [44] (test)  loss: 5.6175 -> 5.0613   acc: 0.00% -> 2.66%               
client [8] (test)  loss: 5.0569 -> 5.0439   acc: 3.25% -> 3.97%                
client [31] (test)  loss: 5.1818 -> 5.1791   acc: 5.05% -> 4.50%               
client [47] (test)  loss: 5.0381 -> 4.9182   acc: 3.25% -> 2.89%               
client [36] (test)  loss: 5.0315 -> 4.9734   acc: 2.73% -> 2.55%               
client [20] (test)  loss: 5.0818 -> 5.0221   acc: 7.75% -> 8.13%               
client [56] (test)  loss: 4.9721 -> 4.9153   acc: 5.60% -> 5.78%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.1052 -> 5.0854   acc: 2.18% -> 1.63%                
client [60] (test)  loss: 5.0919 -> 4.8938   acc: 4.50% -> 4.32%               
client [28] (test)  loss: 5.1973 -> 4.9674   acc: 2.54% -> 3.63%               
client [25] (test)  loss: 5.2785 -> 4.9913   acc: 2.34% -> 2.52%               
client [58] (test)  loss: 5.0060 -> 4.9437   acc: 1.98% -> 2.34%               
client [44] (test)  loss: 5.1389 -> 5.0199   acc: 2.84% -> 3.37%               
client [39] (test)  loss: 5.0719 -> 5.0534   acc: 4.00% -> 4.00%               
client [29] (test)  loss: 5.3426 -> 5.0779   acc: 2.28% -> 4.73%               
client [3] (test)  loss: 4.9556 -> 4.9332   acc: 6.08% -> 6.62%                
client [84] (test)  loss: 5.0402 -> 4.9847   acc: 4.17% -> 3.62%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.3011 -> 4.9662   acc: 4.36% -> 4.54%               
client [84] (test)  loss: 5.0459 -> 4.9891   acc: 2.90% -> 4.17%               
client [10] (test)  loss: 5.2771 -> 4.9990   acc: 5.04% -> 4.86%               
client [36] (test)  loss: 5.0818 -> 5.0039   acc: 2.73% -> 3.45%               
client [65] (test)  loss: 5.2394 -> 5.2828   acc: 3.09% -> 3.27%               
client [81] (test)  loss: 5.2607 -> 5.0662   acc: 2.77% -> 4.61%               
client [79] (test)  loss: 5.1002 -> 5.0889   acc: 5.86% -> 6.22%               
client [42] (test)  loss: 5.0771 -> 5.0516   acc: 6.60% -> 6.79%               
client [11] (test)  loss: 4.9415 -> 4.7605   acc: 6.83% -> 10.61%              
client [96] (test)  loss: 5.0576 -> 4.8573   acc: 5.41% -> 5.59%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.2642 -> 5.1031   acc: 3.25% -> 5.23%                
client [53] (test)  loss: 4.8554 -> 4.8210   acc: 6.00% -> 7.23%               
client [52] (test)  loss: 5.2859 -> 5.3468   acc: 3.62% -> 4.35%               
client [42] (test)  loss: 5.1106 -> 5.0866   acc: 7.36% -> 7.55%               
client [69] (test)  loss: 5.0012 -> 5.0301   acc: 5.74% -> 5.93%               
client [59] (test)  loss: 4.9628 -> 4.9583   acc: 4.18% -> 4.18%               
client [7] (test)  loss: 6.0340 -> 5.1975   acc: 5.98% -> 5.80%                
client [26] (test)  loss: 4.9614 -> 4.9107   acc: 5.94% -> 5.40%               
client [49] (test)  loss: 5.0980 -> 5.1410   acc: 7.22% -> 7.22%               
client [98] (test)  loss: 4.9903 -> 4.9357   acc: 2.36% -> 2.55%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 5.1574 -> 5.0028   acc: 3.09% -> 2.91%               
client [47] (test)  loss: 5.5595 -> 4.8936   acc: 3.25% -> 4.33%               
client [21] (test)  loss: 5.0669 -> 5.1573   acc: 3.63% -> 3.99%               
client [77] (test)  loss: 5.1490 -> 5.1255   acc: 5.22% -> 5.04%               
client [95] (test)  loss: 5.1709 -> 5.1613   acc: 5.07% -> 6.57%               
client [91] (test)  loss: 5.8005 -> 5.3413   acc: 2.55% -> 3.27%               
client [14] (test)  loss: 5.1615 -> 5.2353   acc: 4.87% -> 6.14%               
client [99] (test)  loss: 5.2630 -> 5.1942   acc: 4.87% -> 5.42%               
client [20] (test)  loss: 5.3009 -> 5.0604   acc: 7.75% -> 8.51%               
client [39] (test)  loss: 5.7604 -> 5.2108   acc: 4.55% -> 4.00%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.7290 -> 5.7003   acc: 3.80% -> 4.17%               
client [62] (test)  loss: 5.2731 -> 5.2844   acc: 5.92% -> 6.64%               
client [71] (test)  loss: 5.2024 -> 5.1607   acc: 4.66% -> 4.66%               
client [97] (test)  loss: 5.4427 -> 5.2134   acc: 1.64% -> 1.82%               
client [30] (test)  loss: 5.2628 -> 5.4772   acc: 2.54% -> 2.17%               
client [88] (test)  loss: 4.9195 -> 5.0036   acc: 6.15% -> 5.97%               
client [60] (test)  loss: 5.2744 -> 5.1158   acc: 5.76% -> 6.47%               
client [82] (test)  loss: 4.8895 -> 4.8654   acc: 8.93% -> 10.71%              
client [91] (test)  loss: 5.7977 -> 5.5210   acc: 3.09% -> 3.27%               
client [57] (test)  loss: 5.2322 -> 5.1043   acc: 4.90% -> 7.44%               
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.6837 -> 5.5113   acc: 4.86% -> 4.86%               
client [15] (test)  loss: 5.2051 -> 5.2110   acc: 4.31% -> 5.39%               
client [71] (test)  loss: 5.4093 -> 5.2415   acc: 4.12% -> 4.12%               
client [97] (test)  loss: 5.4344 -> 5.3926   acc: 2.00% -> 2.73%               
client [53] (test)  loss: 5.1713 -> 4.9587   acc: 5.64% -> 6.88%               
client [77] (test)  loss: 5.4618 -> 5.2332   acc: 5.58% -> 6.29%               
client [76] (test)  loss: 5.0780 -> 4.8593   acc: 7.08% -> 8.89%               
client [79] (test)  loss: 5.5157 -> 5.2173   acc: 6.39% -> 5.86%               
client [28] (test)  loss: 5.0746 -> 5.1408   acc: 6.53% -> 5.63%               
client [99] (test)  loss: 5.6955 -> 5.4881   acc: 5.60% -> 5.05%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 5.6254 -> 5.5643   acc: 2.36% -> 2.91%               
client [86] (test)  loss: 5.3360 -> 5.2437   acc: 5.63% -> 5.99%               
client [34] (test)  loss: 5.4419 -> 6.0101   acc: 3.64% -> 3.09%               
client [73] (test)  loss: 5.2475 -> 5.3302   acc: 5.28% -> 6.50%               
client [5] (test)  loss: 5.0154 -> 5.0493   acc: 6.76% -> 6.58%                
client [96] (test)  loss: 5.1192 -> 5.1124   acc: 8.11% -> 7.75%               
client [22] (test)  loss: 5.2113 -> 5.5074   acc: 4.52% -> 2.71%               
client [60] (test)  loss: 5.3793 -> 5.3283   acc: 5.40% -> 5.76%               
client [66] (test)  loss: 5.3540 -> 5.3327   acc: 8.30% -> 8.84%               
client [83] (test)  loss: 5.6978 -> 5.2269   acc: 8.14% -> 8.86%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.3901 -> 5.0672   acc: 8.35% -> 10.71%              
client [65] (test)  loss: 5.5874 -> 5.4770   acc: 4.17% -> 5.81%               
client [95] (test)  loss: 5.6192 -> 5.4986   acc: 6.00% -> 7.50%               
client [17] (test)  loss: 7.1784 -> 5.0147   acc: 5.77% -> 6.49%               
client [8] (test)  loss: 5.8876 -> 5.3915   acc: 5.60% -> 5.60%                
client [35] (test)  loss: 5.5183 -> 5.3675   acc: 4.90% -> 5.99%               
client [98] (test)  loss: 5.5453 -> 5.2329   acc: 3.45% -> 4.91%               
client [53] (test)  loss: 5.0834 -> 5.0884   acc: 7.23% -> 6.88%               
client [43] (test)  loss: 5.7261 -> 5.4502   acc: 3.08% -> 3.62%               
client [64] (test)  loss: 5.5893 -> 5.3602   acc: 7.81% -> 7.25%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.5376 -> 5.1741   acc: 4.72% -> 4.72%               
client [88] (test)  loss: 5.1251 -> 5.5665   acc: 7.41% -> 5.97%               
client [38] (test)  loss: 5.5331 -> 5.5940   acc: 6.30% -> 5.56%               
client [3] (test)  loss: 5.5250 -> 5.3842   acc: 10.02% -> 10.02%              
client [5] (test)  loss: 5.3072 -> 5.2416   acc: 6.41% -> 6.94%                
client [41] (test)  loss: 5.4389 -> 5.3783   acc: 4.35% -> 3.08%               
client [7] (test)  loss: 5.8315 -> 5.5234   acc: 5.98% -> 5.62%                
client [37] (test)  loss: 5.3035 -> 5.2352   acc: 5.95% -> 5.95%               
client [45] (test)  loss: 6.2070 -> 5.2724   acc: 4.00% -> 5.64%               
client [47] (test)  loss: 6.1701 -> 5.1801   acc: 4.87% -> 4.69%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.7921 -> 5.6196   acc: 7.54% -> 8.08%               
client [11] (test)  loss: 5.3236 -> 5.1700   acc: 7.37% -> 7.91%               
client [37] (test)  loss: 5.3985 -> 5.4248   acc: 5.59% -> 6.67%               
client [41] (test)  loss: 5.5932 -> 5.4666   acc: 4.53% -> 3.44%               
client [95] (test)  loss: 5.9758 -> 5.9139   acc: 5.82% -> 6.94%               
client [53] (test)  loss: 5.5853 -> 5.2664   acc: 6.00% -> 6.70%               
client [22] (test)  loss: 5.5859 -> 5.6793   acc: 4.34% -> 4.34%               
client [25] (test)  loss: 5.4088 -> 5.3524   acc: 4.50% -> 5.59%               
client [69] (test)  loss: 5.5861 -> 5.5665   acc: 7.04% -> 6.11%               
client [46] (test)  loss: 5.3410 -> 5.3107   acc: 5.26% -> 6.72%               
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.5996 -> 5.5330   acc: 5.05% -> 5.78%               
client [69] (test)  loss: 5.6705 -> 5.7570   acc: 6.67% -> 6.67%               
client [82] (test)  loss: 5.3593 -> 5.6464   acc: 11.25% -> 8.93%              
client [45] (test)  loss: 5.7625 -> 5.4419   acc: 5.64% -> 6.36%               
client [7] (test)  loss: 6.1374 -> 5.6747   acc: 7.43% -> 6.34%                
client [50] (test)  loss: 6.1026 -> 5.6358   acc: 3.99% -> 4.35%               
client [35] (test)  loss: 5.7978 -> 5.7830   acc: 5.63% -> 6.72%               
client [24] (test)  loss: 5.7096 -> 5.6204   acc: 9.63% -> 9.45%               
client [15] (test)  loss: 5.7990 -> 5.7623   acc: 4.67% -> 6.46%               
client [58] (test)  loss: 5.9508 -> 5.9815   acc: 5.59% -> 5.95%               
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.9387 -> 5.7204   acc: 6.27% -> 6.63%               
client [76] (test)  loss: 5.6460 -> 5.4929   acc: 9.44% -> 10.71%              
client [67] (test)  loss: 5.5889 -> 5.6029   acc: 7.65% -> 8.21%               
client [37] (test)  loss: 5.9552 -> 5.7564   acc: 6.49% -> 5.77%               
client [58] (test)  loss: 6.1517 -> 6.1915   acc: 5.95% -> 5.05%               
client [64] (test)  loss: 5.8839 -> 5.7762   acc: 6.88% -> 6.69%               
client [77] (test)  loss: 5.7116 -> 5.6677   acc: 7.01% -> 7.55%               
client [55] (test)  loss: 6.5797 -> 5.6866   acc: 6.98% -> 6.44%               
client [12] (test)  loss: 5.8775 -> 6.0055   acc: 7.89% -> 8.06%               
client [89] (test)  loss: 6.0055 -> 5.7695   acc: 9.86% -> 10.57%              
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 6.5129 -> 6.4474   acc: 7.43% -> 8.15%               
client [51] (test)  loss: 5.9106 -> 5.6903   acc: 7.93% -> 8.29%               
client [8] (test)  loss: 6.4410 -> 6.2080   acc: 7.76% -> 7.76%                
client [18] (test)  loss: 6.0192 -> 5.9865   acc: 5.90% -> 7.51%               
client [94] (test)  loss: 5.8902 -> 5.8034   acc: 6.69% -> 6.51%               
client [81] (test)  loss: 6.4055 -> 6.3715   acc: 6.09% -> 6.83%               
client [3] (test)  loss: 6.0597 -> 6.0475   acc: 8.59% -> 8.94%                
client [11] (test)  loss: 5.8012 -> 5.6798   acc: 6.83% -> 7.19%               
client [95] (test)  loss: 6.8840 -> 6.7482   acc: 7.13% -> 6.57%               
client [67] (test)  loss: 5.9877 -> 5.7785   acc: 7.28% -> 7.65%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 6.5574 -> 5.7183   acc: 4.36% -> 4.36%               
client [79] (test)  loss: 6.5081 -> 6.4334   acc: 5.68% -> 5.86%               
client [58] (test)  loss: 6.6874 -> 6.6881   acc: 5.41% -> 5.05%               
client [88] (test)  loss: 6.0702 -> 5.9712   acc: 6.87% -> 7.78%               
client [46] (test)  loss: 6.4791 -> 6.1544   acc: 5.99% -> 5.63%               
client [11] (test)  loss: 5.9864 -> 5.8809   acc: 5.04% -> 6.65%               
client [55] (test)  loss: 6.4263 -> 6.2102   acc: 8.94% -> 7.51%               
client [13] (test)  loss: 6.4717 -> 6.2187   acc: 7.25% -> 7.43%               
client [31] (test)  loss: 7.2202 -> 6.5385   acc: 6.67% -> 4.68%               
client [75] (test)  loss: 6.6323 -> 6.3166   acc: 7.40% -> 7.40%               
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 6.8727 -> 6.9552   acc: 5.12% -> 5.33%               
client [7] (test)  loss: 6.4097 -> 6.4596   acc: 7.97% -> 8.51%                
client [57] (test)  loss: 6.3548 -> 6.4162   acc: 9.07% -> 9.07%               
client [13] (test)  loss: 6.4790 -> 6.4709   acc: 6.88% -> 7.79%               
client [43] (test)  loss: 6.3302 -> 6.6582   acc: 6.16% -> 5.43%               
client [91] (test)  loss: 8.1913 -> 6.5869   acc: 4.91% -> 6.00%               
client [10] (test)  loss: 6.6326 -> 6.6248   acc: 7.19% -> 7.73%               
client [64] (test)  loss: 6.5506 -> 6.5525   acc: 7.06% -> 7.06%               
client [82] (test)  loss: 6.2294 -> 6.6577   acc: 10.54% -> 10.36%             
client [22] (test)  loss: 6.3832 -> 6.4775   acc: 4.52% -> 4.52%               
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.3584 -> 6.3206   acc: 8.32% -> 8.88%               
client [23] (test)  loss: 6.5822 -> 6.7713   acc: 4.16% -> 5.06%               
client [88] (test)  loss: 6.5960 -> 6.2923   acc: 8.14% -> 9.04%               
client [98] (test)  loss: 6.6013 -> 6.4747   acc: 6.18% -> 6.91%               
client [79] (test)  loss: 6.9259 -> 6.9826   acc: 5.33% -> 6.22%               
client [21] (test)  loss: 6.4984 -> 6.1816   acc: 5.08% -> 6.17%               
client [92] (test)  loss: 6.4936 -> 6.5282   acc: 8.93% -> 9.82%               
client [56] (test)  loss: 7.1940 -> 6.7869   acc: 5.78% -> 6.68%               
client [5] (test)  loss: 6.6864 -> 6.3635   acc: 7.12% -> 6.41%                
client [52] (test)  loss: 7.2559 -> 7.1058   acc: 7.07% -> 7.25%               
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '5.3713 -> 0.0000', 'accuracy': '5.41% -> 0.00%'},           
    200: {'loss': '6.9345 -> 0.0000', 'accuracy': '6.62% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
Convergence (test_after):                                                      
