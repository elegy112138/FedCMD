==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7766 -> 0.0030   acc: 92.66% -> 100.00%            
client [81] (test)  loss: 1.9963 -> 0.1946   acc: 26.47% -> 94.12%             
client [21] (test)  loss: 4.0310 -> 0.0138   acc: 77.33% -> 99.48%             
client [68] (test)  loss: 1.8926 -> 0.6029   acc: 23.53% -> 82.35%             
client [93] (test)  loss: 0.5058 -> 0.1725   acc: 96.39% -> 95.74%             
client [31] (test)  loss: 1.3328 -> 0.3340   acc: 71.56% -> 88.53%             
client [20] (test)  loss: 1.6194 -> 0.1939   acc: 29.17% -> 97.22%             
client [59] (test)  loss: 18.7539 -> 0.1201   acc: 57.56% -> 97.80%            
client [48] (test)  loss: 1.3750 -> 0.4797   acc: 51.55% -> 87.21%             
client [34] (test)  loss: 1.5190 -> 0.0846   acc: 57.35% -> 99.02%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4223 -> 0.0807   acc: 86.39% -> 98.61%             
client [99] (test)  loss: 0.2616 -> 0.0353   acc: 94.73% -> 99.08%             
client [67] (test)  loss: 0.8688 -> 0.2704   acc: 67.26% -> 90.27%             
client [0] (test)  loss: 2.3723 -> 0.0244   acc: 0.58% -> 99.13%               
client [76] (test)  loss: 0.7295 -> 0.2247   acc: 86.11% -> 94.44%             
client [41] (test)  loss: 1.0857 -> 0.0410   acc: 57.88% -> 99.06%             
client [62] (test)  loss: 51.4859 -> 0.1535   acc: 43.14% -> 96.64%            
client [2] (test)  loss: 10.8654 -> 0.0715   acc: 81.01% -> 99.61%             
client [14] (test)  loss: 1.2658 -> 0.1513   acc: 48.36% -> 94.26%             
client [46] (test)  loss: 0.8223 -> 0.1296   acc: 71.39% -> 95.95%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5398 -> 0.1894   acc: 82.00% -> 98.00%             
client [68] (test)  loss: 1.2048 -> 0.1389   acc: 51.63% -> 96.73%             
client [57] (test)  loss: 0.5194 -> 0.0333   acc: 87.35% -> 98.92%             
client [17] (test)  loss: 0.1145 -> 0.1127   acc: 95.56% -> 95.56%             
client [54] (test)  loss: 0.9372 -> 0.1050   acc: 71.74% -> 96.38%             
client [23] (test)  loss: 42.3118 -> 0.3029   acc: 58.46% -> 92.31%            
client [35] (test)  loss: 0.3966 -> 0.1310   acc: 87.45% -> 95.67%             
client [59] (test)  loss: 0.2409 -> 0.0192   acc: 95.85% -> 99.27%             
client [31] (test)  loss: 0.3280 -> 0.0977   acc: 93.12% -> 98.62%             
client [9] (test)  loss: 1.4585 -> 0.0852   acc: 30.77% -> 98.13%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1401 -> 0.0005   acc: 95.84% -> 100.00%            
client [33] (test)  loss: 0.4783 -> 0.0425   acc: 83.85% -> 98.97%             
client [16] (test)  loss: 0.8632 -> 0.0168   acc: 71.04% -> 99.73%             
client [44] (test)  loss: 0.4162 -> 0.0013   acc: 87.10% -> 100.00%            
client [8] (test)  loss: 0.6815 -> 0.1318   acc: 76.97% -> 95.79%              
client [31] (test)  loss: 0.3910 -> 0.0714   acc: 88.07% -> 99.08%             
client [47] (test)  loss: 0.1705 -> 0.0022   acc: 96.64% -> 100.00%            
client [36] (test)  loss: 1.0615 -> 0.0114   acc: 70.83% -> 100.00%            
client [20] (test)  loss: 0.1514 -> 0.0782   acc: 97.22% -> 97.22%             
client [56] (test)  loss: 0.4146 -> 0.0669   acc: 89.06% -> 95.31%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6369 -> 0.0020   acc: 79.19% -> 100.00%             
client [60] (test)  loss: 0.2166 -> 0.0010   acc: 95.25% -> 100.00%            
client [28] (test)  loss: 0.1492 -> 0.0763   acc: 97.62% -> 98.81%             
client [25] (test)  loss: 0.5040 -> 0.0665   acc: 83.55% -> 97.97%             
client [58] (test)  loss: 0.2317 -> 0.0721   acc: 94.12% -> 97.76%             
client [44] (test)  loss: 0.1931 -> 0.0012   acc: 96.31% -> 100.00%            
client [39] (test)  loss: 0.6527 -> 0.0884   acc: 78.76% -> 97.35%             
client [29] (test)  loss: 0.1562 -> 0.0078   acc: 96.61% -> 100.00%            
client [3] (test)  loss: 0.1692 -> 0.0007   acc: 96.68% -> 100.00%             
client [84] (test)  loss: 0.1508 -> 0.0030   acc: 96.79% -> 100.00%            
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5669 -> 0.0029   acc: 81.35% -> 99.87%             
client [84] (test)  loss: 0.1021 -> 0.0020   acc: 98.29% -> 100.00%            
client [10] (test)  loss: 0.8223 -> 0.0732   acc: 70.67% -> 97.33%             
client [36] (test)  loss: 0.1345 -> 0.0011   acc: 100.00% -> 100.00%           
client [65] (test)  loss: 0.4171 -> 0.0365   acc: 87.57% -> 98.87%             
client [81] (test)  loss: 2.3889 -> 0.0110   acc: 32.35% -> 100.00%            
client [79] (test)  loss: 0.7896 -> 0.0808   acc: 70.57% -> 97.01%             
client [42] (test)  loss: 0.2311 -> 0.0455   acc: 91.86% -> 98.84%             
client [11] (test)  loss: 0.6590 -> 0.0753   acc: 78.61% -> 98.40%             
client [96] (test)  loss: 0.5566 -> 0.0612   acc: 77.94% -> 97.71%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5459 -> 0.0947   acc: 82.87% -> 97.19%              
client [53] (test)  loss: 0.2297 -> 0.0739   acc: 90.43% -> 97.13%             
client [52] (test)  loss: 0.1750 -> 0.1301   acc: 97.40% -> 97.40%             
client [42] (test)  loss: 0.1502 -> 0.0442   acc: 95.35% -> 97.67%             
client [69] (test)  loss: 0.1796 -> 0.0222   acc: 94.44% -> 99.44%             
client [59] (test)  loss: 0.3574 -> 0.0048   acc: 86.10% -> 100.00%            
client [7] (test)  loss: 0.7989 -> 0.0065   acc: 73.19% -> 99.86%              
client [26] (test)  loss: 0.0724 -> 0.0229   acc: 98.09% -> 99.05%             
client [49] (test)  loss: 0.4718 -> 0.0731   acc: 85.20% -> 96.93%             
client [98] (test)  loss: 0.2465 -> 0.0968   acc: 88.24% -> 100.00%            
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2600 -> 0.0702   acc: 91.18% -> 100.00%            
client [47] (test)  loss: 0.1049 -> 0.0017   acc: 96.64% -> 100.00%            
client [21] (test)  loss: 0.5537 -> 0.0029   acc: 80.57% -> 99.87%             
client [77] (test)  loss: 0.1385 -> 0.0010   acc: 96.20% -> 100.00%            
client [95] (test)  loss: 0.2024 -> 0.0063   acc: 93.14% -> 99.83%             
client [91] (test)  loss: 0.2629 -> 0.0856   acc: 92.44% -> 96.64%             
client [14] (test)  loss: 0.1616 -> 0.0516   acc: 95.90% -> 98.36%             
client [99] (test)  loss: 0.1368 -> 0.0062   acc: 95.26% -> 99.74%             
client [20] (test)  loss: 0.4463 -> 0.0433   acc: 81.94% -> 98.61%             
client [39] (test)  loss: 1.1291 -> 0.0690   acc: 64.60% -> 98.23%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2485 -> 0.1580   acc: 93.51% -> 97.40%             
client [62] (test)  loss: 0.1916 -> 0.0732   acc: 94.96% -> 98.04%             
client [71] (test)  loss: 0.1528 -> 0.0425   acc: 95.59% -> 98.61%             
client [97] (test)  loss: 0.1179 -> 0.0049   acc: 97.59% -> 99.73%             
client [30] (test)  loss: 0.1806 -> 0.0519   acc: 93.75% -> 98.44%             
client [88] (test)  loss: 0.1269 -> 0.0246   acc: 96.44% -> 98.90%             
client [60] (test)  loss: 1.3596 -> 0.0009   acc: 61.58% -> 100.00%            
client [82] (test)  loss: 0.1048 -> 0.0197   acc: 98.04% -> 99.02%             
client [91] (test)  loss: 0.2440 -> 0.0905   acc: 93.28% -> 97.48%             
client [57] (test)  loss: 0.7775 -> 0.0046   acc: 75.15% -> 100.00%            
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1336 -> 0.0358   acc: 96.79% -> 99.08%             
client [15] (test)  loss: 0.0884 -> 0.0074   acc: 100.00% -> 100.00%           
client [71] (test)  loss: 0.2045 -> 0.0419   acc: 94.21% -> 98.49%             
client [97] (test)  loss: 0.1101 -> 0.0043   acc: 97.05% -> 99.73%             
client [53] (test)  loss: 0.1323 -> 0.0536   acc: 96.17% -> 97.61%             
client [77] (test)  loss: 0.0520 -> 0.0008   acc: 99.18% -> 100.00%            
client [76] (test)  loss: 0.1039 -> 0.0880   acc: 94.44% -> 97.22%             
client [79] (test)  loss: 0.3477 -> 0.0649   acc: 90.02% -> 97.26%             
client [28] (test)  loss: 0.2664 -> 0.0850   acc: 91.67% -> 97.62%             
client [99] (test)  loss: 0.1493 -> 0.0061   acc: 95.52% -> 99.87%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1396 -> 0.0043   acc: 96.51% -> 99.73%             
client [86] (test)  loss: 0.0489 -> 0.0018   acc: 100.00% -> 100.00%           
client [34] (test)  loss: 0.1087 -> 0.0091   acc: 97.55% -> 99.51%             
client [73] (test)  loss: 0.1369 -> 0.0190   acc: 97.18% -> 99.44%             
client [5] (test)  loss: 0.1852 -> 0.0985   acc: 95.35% -> 97.21%              
client [96] (test)  loss: 0.2213 -> 0.0447   acc: 91.40% -> 98.28%             
client [22] (test)  loss: 0.2847 -> 0.0074   acc: 91.91% -> 99.71%             
client [60] (test)  loss: 0.5015 -> 0.0011   acc: 88.12% -> 100.00%            
client [66] (test)  loss: 0.1690 -> 0.0927   acc: 92.71% -> 97.92%             
client [83] (test)  loss: 0.0979 -> 0.0440   acc: 97.46% -> 98.48%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1278 -> 0.0957   acc: 94.44% -> 94.44%             
client [65] (test)  loss: 0.0924 -> 0.0281   acc: 98.31% -> 98.87%             
client [95] (test)  loss: 0.0885 -> 0.0042   acc: 97.16% -> 100.00%            
client [17] (test)  loss: 0.0337 -> 0.0040   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.3755 -> 0.0768   acc: 89.04% -> 97.75%              
client [35] (test)  loss: 0.1088 -> 0.0354   acc: 97.40% -> 98.70%             
client [98] (test)  loss: 0.1500 -> 0.0629   acc: 94.12% -> 100.00%            
client [53] (test)  loss: 0.1034 -> 0.0486   acc: 96.17% -> 98.09%             
client [43] (test)  loss: 0.6978 -> 0.0262   acc: 78.34% -> 98.62%             
client [64] (test)  loss: 0.0831 -> 0.0010   acc: 97.44% -> 99.89%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3508 -> 0.0014   acc: 89.77% -> 99.87%             
client [88] (test)  loss: 0.0869 -> 0.0219   acc: 96.99% -> 99.18%             
client [38] (test)  loss: 0.2463 -> 0.0047   acc: 91.79% -> 99.75%             
client [3] (test)  loss: 0.1794 -> 0.0003   acc: 93.91% -> 100.00%             
client [5] (test)  loss: 0.3221 -> 0.0989   acc: 89.77% -> 97.21%              
client [41] (test)  loss: 0.2987 -> 0.0138   acc: 91.06% -> 99.53%             
client [7] (test)  loss: 0.6446 -> 0.0057   acc: 77.78% -> 99.86%              
client [37] (test)  loss: 0.3834 -> 0.0880   acc: 88.16% -> 96.05%             
client [45] (test)  loss: 0.1054 -> 0.0046   acc: 96.70% -> 99.73%             
client [47] (test)  loss: 0.1208 -> 0.0014   acc: 97.48% -> 100.00%            
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5181 -> 0.0055   acc: 83.33% -> 100.00%            
client [11] (test)  loss: 0.1857 -> 0.0532   acc: 95.99% -> 98.66%             
client [37] (test)  loss: 0.2864 -> 0.0978   acc: 93.42% -> 96.05%             
client [41] (test)  loss: 0.1042 -> 0.0142   acc: 96.24% -> 99.53%             
client [95] (test)  loss: 0.1199 -> 0.0041   acc: 96.32% -> 100.00%            
client [53] (test)  loss: 0.1109 -> 0.0443   acc: 96.17% -> 98.09%             
client [22] (test)  loss: 0.2959 -> 0.0071   acc: 91.47% -> 99.71%             
client [25] (test)  loss: 0.1480 -> 0.0495   acc: 96.12% -> 98.15%             
client [69] (test)  loss: 0.1094 -> 0.0117   acc: 97.22% -> 99.72%             
client [46] (test)  loss: 0.0998 -> 0.0319   acc: 97.69% -> 99.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2809 -> 0.0028   acc: 92.72% -> 100.00%            
client [69] (test)  loss: 0.1810 -> 0.0119   acc: 94.72% -> 99.72%             
client [82] (test)  loss: 0.0649 -> 0.0136   acc: 98.04% -> 100.00%            
client [45] (test)  loss: 0.0734 -> 0.0033   acc: 98.08% -> 100.00%            
client [7] (test)  loss: 0.3565 -> 0.0053   acc: 88.47% -> 99.72%              
client [50] (test)  loss: 0.1113 -> 0.0168   acc: 96.24% -> 99.62%             
client [35] (test)  loss: 0.1070 -> 0.0310   acc: 96.97% -> 99.13%             
client [24] (test)  loss: 0.2325 -> 0.1139   acc: 90.00% -> 96.00%             
client [15] (test)  loss: 0.0262 -> 0.0037   acc: 100.00% -> 100.00%           
client [58] (test)  loss: 0.0647 -> 0.0409   acc: 97.76% -> 98.88%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1218 -> 0.0351   acc: 96.12% -> 98.84%             
client [76] (test)  loss: 0.1430 -> 0.0994   acc: 94.44% -> 97.22%             
client [67] (test)  loss: 0.1977 -> 0.0457   acc: 93.36% -> 98.67%             
client [37] (test)  loss: 0.1995 -> 0.0871   acc: 94.74% -> 96.05%             
client [58] (test)  loss: 0.1031 -> 0.0396   acc: 96.64% -> 99.16%             
client [64] (test)  loss: 0.1519 -> 0.0013   acc: 95.10% -> 99.89%             
client [77] (test)  loss: 0.0773 -> 0.0005   acc: 98.37% -> 100.00%            
client [55] (test)  loss: 0.1813 -> 0.0151   acc: 95.23% -> 99.75%             
client [12] (test)  loss: 0.0263 -> 0.0090   acc: 100.00% -> 100.00%           
client [89] (test)  loss: 0.2948 -> 0.0215   acc: 90.34% -> 99.14%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1105 -> 0.0014   acc: 97.22% -> 100.00%            
client [51] (test)  loss: 0.2156 -> 0.0379   acc: 92.81% -> 98.84%             
client [8] (test)  loss: 0.1876 -> 0.0651   acc: 94.10% -> 98.31%              
client [18] (test)  loss: 0.2052 -> 0.0365   acc: 94.70% -> 99.24%             
client [94] (test)  loss: 0.2033 -> 0.0985   acc: 94.29% -> 97.96%             
client [81] (test)  loss: 0.3889 -> 0.0059   acc: 85.29% -> 100.00%            
client [3] (test)  loss: 0.0271 -> 0.0005   acc: 98.89% -> 100.00%             
client [11] (test)  loss: 0.1523 -> 0.0516   acc: 97.06% -> 99.20%             
client [95] (test)  loss: 0.1021 -> 0.0048   acc: 96.66% -> 99.83%             
client [67] (test)  loss: 0.1903 -> 0.0474   acc: 95.58% -> 98.23%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2901 -> 0.0012   acc: 90.93% -> 100.00%            
client [79] (test)  loss: 0.4763 -> 0.0601   acc: 84.79% -> 97.76%             
client [58] (test)  loss: 0.0547 -> 0.0396   acc: 98.60% -> 99.16%             
client [88] (test)  loss: 0.0360 -> 0.0197   acc: 99.18% -> 99.45%             
client [46] (test)  loss: 0.1170 -> 0.0344   acc: 97.40% -> 98.84%             
client [11] (test)  loss: 0.2722 -> 0.0481   acc: 92.51% -> 98.93%             
client [55] (test)  loss: 0.3810 -> 0.0150   acc: 87.69% -> 99.75%             
client [13] (test)  loss: 1.1153 -> 0.0205   acc: 69.80% -> 99.39%             
client [31] (test)  loss: 0.1736 -> 0.0335   acc: 92.66% -> 99.08%             
client [75] (test)  loss: 0.0524 -> 0.0293   acc: 98.50% -> 99.25%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1667 -> 0.0224   acc: 95.47% -> 99.41%             
client [7] (test)  loss: 0.1138 -> 0.0067   acc: 96.81% -> 99.86%              
client [57] (test)  loss: 0.1423 -> 0.0022   acc: 95.83% -> 100.00%            
client [13] (test)  loss: 1.6922 -> 0.0179   acc: 55.10% -> 99.39%             
client [43] (test)  loss: 0.8907 -> 0.0241   acc: 71.89% -> 99.08%             
client [91] (test)  loss: 0.2807 -> 0.1041   acc: 92.44% -> 97.48%             
client [10] (test)  loss: 0.2778 -> 0.0593   acc: 90.67% -> 96.00%             
client [64] (test)  loss: 0.0220 -> 0.0015   acc: 99.36% -> 99.89%             
client [82] (test)  loss: 0.0751 -> 0.0092   acc: 98.04% -> 100.00%            
client [22] (test)  loss: 0.4973 -> 0.0053   acc: 85.59% -> 99.85%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1154 -> 0.0508   acc: 91.67% -> 98.61%             
client [23] (test)  loss: 0.1816 -> 0.0722   acc: 93.85% -> 96.92%             
client [88] (test)  loss: 0.1097 -> 0.0219   acc: 96.99% -> 99.18%             
client [98] (test)  loss: 0.0983 -> 0.0465   acc: 94.12% -> 97.06%             
client [79] (test)  loss: 0.1688 -> 0.0567   acc: 93.52% -> 98.00%             
client [21] (test)  loss: 0.3282 -> 0.0010   acc: 89.77% -> 100.00%            
client [92] (test)  loss: 0.1016 -> 0.0294   acc: 96.45% -> 99.02%             
client [56] (test)  loss: 0.2597 -> 0.0199   acc: 90.62% -> 98.44%             
client [5] (test)  loss: 0.1810 -> 0.0913   acc: 94.88% -> 98.14%              
client [52] (test)  loss: 0.1081 -> 0.1038   acc: 97.40% -> 97.40%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3280 -> 0.0000', 'accuracy': '90.20% -> 0.00%'},          
    200: {'loss': '0.2047 -> 0.0000', 'accuracy': '93.56% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(19.66%) at epoch: 1                                      
FedDyn achieved 30.0%(36.69%) at epoch: 2                                      
FedDyn achieved 50.0%(55.87%) at epoch: 7                                      
FedDyn achieved 60.0%(69.43%) at epoch: 9                                      
FedDyn achieved 70.0%(71.04%) at epoch: 12                                     
FedDyn achieved 80.0%(89.28%) at epoch: 18                                     
FedDyn achieved 90.0%(91.47%) at epoch: 40                                     
Convergence (test_after):                                                      
FedDyn achieved 70.0%(75.91%) at epoch: 0                                      
FedDyn achieved 80.0%(86.65%) at epoch: 1                                      
FedDyn achieved 90.0%(90.52%) at epoch: 2                                      
