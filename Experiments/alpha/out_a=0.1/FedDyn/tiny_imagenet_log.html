==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.3617 -> 3.2366   acc: 1.37% -> 10.82%              
client [81] (test)  loss: 5.1797 -> 3.3637   acc: 2.85% -> 13.88%              
client [21] (test)  loss: 5.3462 -> 3.3073   acc: 2.00% -> 24.80%              
client [68] (test)  loss: 5.6513 -> 3.3807   acc: 0.33% -> 17.72%              
client [93] (test)  loss: 5.3495 -> 3.3144   acc: 0.37% -> 20.96%              
client [31] (test)  loss: 5.9418 -> 2.8976   acc: 1.05% -> 30.66%              
client [20] (test)  loss: 4.9145 -> 3.4749   acc: 6.40% -> 13.49%              
client [59] (test)  loss: 5.2572 -> 3.3666   acc: 0.70% -> 15.49%              
client [48] (test)  loss: 5.0751 -> 3.2866   acc: 2.41% -> 30.63%              
client [34] (test)  loss: 4.9461 -> 3.4415   acc: 3.94% -> 18.56%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.6293 -> 3.5953   acc: 0.27% -> 13.30%              
client [99] (test)  loss: 5.2575 -> 3.9077   acc: 2.25% -> 15.13%              
client [67] (test)  loss: 5.0758 -> 3.0758   acc: 1.41% -> 21.16%              
client [0] (test)  loss: 4.9462 -> 3.3442   acc: 6.45% -> 19.35%               
client [76] (test)  loss: 5.0999 -> 3.1977   acc: 2.18% -> 20.55%              
client [41] (test)  loss: 4.9255 -> 2.9635   acc: 1.78% -> 27.05%              
client [62] (test)  loss: 5.2902 -> 3.5739   acc: 1.20% -> 10.94%              
client [2] (test)  loss: 5.2225 -> 2.9599   acc: 0.22% -> 22.83%               
client [14] (test)  loss: 4.9876 -> 2.8607   acc: 1.25% -> 28.65%              
client [46] (test)  loss: 4.8383 -> 3.4774   acc: 3.60% -> 14.59%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.4486 -> 2.9597   acc: 5.75% -> 24.38%              
client [68] (test)  loss: 5.1875 -> 3.0335   acc: 2.93% -> 26.18%              
client [57] (test)  loss: 4.9222 -> 3.2152   acc: 5.27% -> 23.27%              
client [17] (test)  loss: 6.2414 -> 2.7315   acc: 0.95% -> 27.17%              
client [54] (test)  loss: 5.0982 -> 3.1671   acc: 2.47% -> 24.07%              
client [23] (test)  loss: 5.1222 -> 2.5791   acc: 2.12% -> 33.63%              
client [35] (test)  loss: 5.2448 -> 3.0403   acc: 3.82% -> 18.67%              
client [59] (test)  loss: 4.9414 -> 3.1441   acc: 2.11% -> 21.83%              
client [31] (test)  loss: 4.4405 -> 2.5594   acc: 6.10% -> 38.85%              
client [9] (test)  loss: 4.5494 -> 3.7737   acc: 8.73% -> 16.55%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.9990 -> 2.9127   acc: 3.30% -> 29.54%              
client [33] (test)  loss: 4.5732 -> 2.9881   acc: 7.05% -> 29.09%              
client [16] (test)  loss: 4.7002 -> 3.2188   acc: 5.28% -> 23.50%              
client [44] (test)  loss: 8.4968 -> 2.8381   acc: 3.54% -> 28.66%              
client [8] (test)  loss: 4.9509 -> 2.7937   acc: 3.34% -> 31.80%               
client [31] (test)  loss: 4.8976 -> 2.5628   acc: 5.75% -> 40.94%              
client [47] (test)  loss: 5.4156 -> 2.1761   acc: 2.71% -> 46.65%              
client [36] (test)  loss: 4.3218 -> 2.3339   acc: 13.95% -> 38.95%             
client [20] (test)  loss: 4.8094 -> 2.9963   acc: 7.27% -> 24.05%              
client [56] (test)  loss: 5.0912 -> 3.2510   acc: 3.20% -> 19.04%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.3629 -> 3.1465   acc: 1.63% -> 25.50%               
client [60] (test)  loss: 5.4572 -> 2.8509   acc: 4.18% -> 33.45%              
client [28] (test)  loss: 5.0066 -> 2.8068   acc: 7.05% -> 30.74%              
client [25] (test)  loss: 5.8879 -> 3.0981   acc: 4.70% -> 26.61%              
client [58] (test)  loss: 4.8457 -> 2.9073   acc: 3.89% -> 28.09%              
client [44] (test)  loss: 4.8162 -> 2.8192   acc: 6.60% -> 29.63%              
client [39] (test)  loss: 5.0731 -> 3.1742   acc: 4.95% -> 25.74%              
client [29] (test)  loss: 5.0212 -> 2.8805   acc: 12.24% -> 27.38%             
client [3] (test)  loss: 4.6138 -> 2.8795   acc: 8.17% -> 26.31%               
client [84] (test)  loss: 4.7889 -> 2.9411   acc: 6.21% -> 29.08%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 6.0125 -> 3.1434   acc: 2.20% -> 28.00%              
client [84] (test)  loss: 4.4090 -> 2.8790   acc: 12.59% -> 32.45%             
client [10] (test)  loss: 5.2739 -> 2.7905   acc: 6.53% -> 28.54%              
client [36] (test)  loss: 4.4010 -> 2.3546   acc: 7.79% -> 38.59%              
client [65] (test)  loss: 4.3975 -> 3.4000   acc: 9.32% -> 20.25%              
client [81] (test)  loss: 5.3911 -> 2.7831   acc: 7.12% -> 27.40%              
client [79] (test)  loss: 5.0270 -> 3.3781   acc: 2.99% -> 17.74%              
client [42] (test)  loss: 4.7546 -> 2.9225   acc: 5.72% -> 28.26%              
client [11] (test)  loss: 4.6659 -> 3.4411   acc: 7.44% -> 20.42%              
client [96] (test)  loss: 4.9909 -> 2.2989   acc: 4.68% -> 35.79%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.1908 -> 2.7396   acc: 5.56% -> 34.98%               
client [53] (test)  loss: 4.8494 -> 2.8463   acc: 6.59% -> 35.85%              
client [52] (test)  loss: 4.5439 -> 3.1388   acc: 13.30% -> 30.14%             
client [42] (test)  loss: 4.2963 -> 2.9602   acc: 11.63% -> 28.80%             
client [69] (test)  loss: 4.7263 -> 3.5473   acc: 6.91% -> 20.74%              
client [59] (test)  loss: 4.4495 -> 3.0896   acc: 7.75% -> 26.94%              
client [7] (test)  loss: 5.9316 -> 3.2134   acc: 6.28% -> 26.39%               
client [26] (test)  loss: 4.4889 -> 2.7642   acc: 13.32% -> 35.75%             
client [49] (test)  loss: 4.2135 -> 3.0924   acc: 10.49% -> 28.50%             
client [98] (test)  loss: 4.9447 -> 2.7560   acc: 5.67% -> 34.22%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.6181 -> 2.7646   acc: 11.34% -> 36.11%             
client [47] (test)  loss: 5.6885 -> 2.1104   acc: 2.35% -> 45.93%              
client [21] (test)  loss: 5.1635 -> 3.0470   acc: 4.60% -> 31.40%              
client [77] (test)  loss: 4.6026 -> 2.7545   acc: 5.15% -> 30.58%              
client [95] (test)  loss: 4.7162 -> 2.6838   acc: 15.37% -> 43.37%             
client [91] (test)  loss: 4.6634 -> 2.6366   acc: 11.34% -> 34.18%             
client [14] (test)  loss: 4.0225 -> 2.6991   acc: 13.52% -> 34.52%             
client [99] (test)  loss: 4.7598 -> 3.7570   acc: 5.93% -> 22.70%              
client [20] (test)  loss: 4.6388 -> 3.1506   acc: 8.13% -> 25.78%              
client [39] (test)  loss: 5.2941 -> 3.1808   acc: 5.94% -> 25.41%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.6704 -> 3.2499   acc: 12.59% -> 30.85%             
client [62] (test)  loss: 4.7323 -> 3.4351   acc: 8.38% -> 21.20%              
client [71] (test)  loss: 4.1304 -> 3.2532   acc: 16.18% -> 26.09%             
client [97] (test)  loss: 4.7685 -> 3.0588   acc: 8.59% -> 28.05%              
client [30] (test)  loss: 3.9582 -> 3.1492   acc: 17.40% -> 31.09%             
client [88] (test)  loss: 4.9216 -> 3.3748   acc: 10.75% -> 28.33%             
client [60] (test)  loss: 5.1868 -> 2.6823   acc: 4.00% -> 40.55%              
client [82] (test)  loss: 4.6602 -> 2.9733   acc: 8.44% -> 34.09%              
client [91] (test)  loss: 4.5633 -> 2.6599   acc: 13.71% -> 36.38%             
client [57] (test)  loss: 4.3139 -> 3.3919   acc: 14.73% -> 26.18%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.4860 -> 2.4152   acc: 9.41% -> 48.08%              
client [15] (test)  loss: 4.3582 -> 3.0724   acc: 12.59% -> 29.72%             
client [71] (test)  loss: 4.5378 -> 3.3657   acc: 9.42% -> 25.60%              
client [97] (test)  loss: 4.6891 -> 3.0183   acc: 8.59% -> 29.77%              
client [53] (test)  loss: 5.1094 -> 2.9921   acc: 6.20% -> 34.69%              
client [77] (test)  loss: 4.6374 -> 2.8322   acc: 10.31% -> 30.41%             
client [76] (test)  loss: 4.5720 -> 2.8939   acc: 9.82% -> 33.64%              
client [79] (test)  loss: 5.3104 -> 3.9857   acc: 5.13% -> 16.67%              
client [28] (test)  loss: 4.8161 -> 2.9067   acc: 8.68% -> 31.46%              
client [99] (test)  loss: 5.0232 -> 3.7845   acc: 5.73% -> 23.72%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.7045 -> 3.0944   acc: 9.54% -> 29.01%              
client [86] (test)  loss: 4.6513 -> 3.0239   acc: 10.34% -> 35.22%             
client [34] (test)  loss: 4.9490 -> 3.4749   acc: 8.58% -> 27.61%              
client [73] (test)  loss: 4.6067 -> 2.8539   acc: 11.13% -> 36.88%             
client [5] (test)  loss: 4.9699 -> 2.9522   acc: 6.85% -> 30.27%               
client [96] (test)  loss: 4.3875 -> 2.8146   acc: 13.13% -> 33.99%             
client [22] (test)  loss: 4.8701 -> 3.1374   acc: 11.24% -> 32.74%             
client [60] (test)  loss: 5.0253 -> 2.7489   acc: 6.00% -> 39.45%              
client [66] (test)  loss: 4.9244 -> 3.4225   acc: 6.60% -> 22.82%              
client [83] (test)  loss: 4.8919 -> 3.5710   acc: 9.49% -> 22.96%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.8973 -> 3.1430   acc: 9.64% -> 33.27%              
client [65] (test)  loss: 4.6812 -> 3.5744   acc: 11.11% -> 23.48%             
client [95] (test)  loss: 5.8002 -> 2.9718   acc: 7.16% -> 39.58%              
client [17] (test)  loss: 5.2360 -> 2.9196   acc: 12.01% -> 34.44%             
client [8] (test)  loss: 5.2416 -> 2.8410   acc: 5.41% -> 37.04%               
client [35] (test)  loss: 5.1676 -> 2.9573   acc: 7.63% -> 32.53%              
client [98] (test)  loss: 5.1409 -> 2.9481   acc: 6.99% -> 35.92%              
client [53] (test)  loss: 4.5843 -> 3.1364   acc: 12.02% -> 34.88%             
client [43] (test)  loss: 5.0044 -> 3.2290   acc: 8.15% -> 27.80%              
client [64] (test)  loss: 5.1948 -> 2.9101   acc: 4.79% -> 38.12%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.2958 -> 3.4193   acc: 5.80% -> 29.60%              
client [88] (test)  loss: 5.2047 -> 3.6212   acc: 11.09% -> 27.47%             
client [38] (test)  loss: 4.9232 -> 3.6204   acc: 8.71% -> 25.61%              
client [3] (test)  loss: 4.9193 -> 3.3088   acc: 6.86% -> 28.27%               
client [5] (test)  loss: 5.5273 -> 3.0721   acc: 5.59% -> 30.09%               
client [41] (test)  loss: 5.0315 -> 3.2061   acc: 4.80% -> 29.72%              
client [7] (test)  loss: 5.7477 -> 3.8505   acc: 7.00% -> 27.83%               
client [37] (test)  loss: 5.4093 -> 3.1181   acc: 5.03% -> 29.87%              
client [45] (test)  loss: 5.4290 -> 3.3305   acc: 8.52% -> 26.57%              
client [47] (test)  loss: 6.3593 -> 2.3347   acc: 2.89% -> 45.03%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.4903 -> 3.5023   acc: 8.56% -> 26.59%              
client [11] (test)  loss: 5.1553 -> 3.5731   acc: 8.65% -> 26.64%              
client [37] (test)  loss: 5.3805 -> 3.4399   acc: 7.14% -> 29.71%              
client [41] (test)  loss: 5.5677 -> 3.1829   acc: 3.56% -> 30.25%              
client [95] (test)  loss: 6.0340 -> 3.1528   acc: 7.16% -> 38.74%              
client [53] (test)  loss: 5.3928 -> 3.2246   acc: 7.95% -> 36.43%              
client [22] (test)  loss: 4.7362 -> 3.3690   acc: 14.00% -> 33.33%             
client [25] (test)  loss: 5.3422 -> 3.9626   acc: 9.22% -> 23.65%              
client [69] (test)  loss: 5.4106 -> 4.0224   acc: 6.65% -> 22.87%              
client [46] (test)  loss: 4.4308 -> 3.4314   acc: 13.87% -> 30.45%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.7998 -> 2.6219   acc: 9.58% -> 43.40%              
client [69] (test)  loss: 5.6117 -> 4.1198   acc: 6.12% -> 22.87%              
client [82] (test)  loss: 5.0089 -> 3.4911   acc: 7.47% -> 33.77%              
client [45] (test)  loss: 5.1040 -> 3.5868   acc: 10.55% -> 25.96%             
client [7] (test)  loss: 6.0766 -> 3.9175   acc: 5.39% -> 27.65%               
client [50] (test)  loss: 5.2844 -> 3.2738   acc: 9.67% -> 32.12%              
client [35] (test)  loss: 5.0074 -> 3.3632   acc: 11.24% -> 27.91%             
client [24] (test)  loss: 5.1166 -> 3.2474   acc: 10.14% -> 34.25%             
client [15] (test)  loss: 4.7222 -> 3.3670   acc: 12.41% -> 31.47%             
client [58] (test)  loss: 5.5345 -> 3.6744   acc: 7.60% -> 29.15%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.0274 -> 2.6647   acc: 10.94% -> 42.89%             
client [76] (test)  loss: 5.2684 -> 3.4185   acc: 10.18% -> 33.27%             
client [67] (test)  loss: 5.3534 -> 3.5013   acc: 9.17% -> 31.04%              
client [37] (test)  loss: 5.8619 -> 3.4608   acc: 5.36% -> 30.19%              
client [58] (test)  loss: 5.3334 -> 4.0799   acc: 9.19% -> 25.62%              
client [64] (test)  loss: 5.2835 -> 3.8498   acc: 5.61% -> 34.16%              
client [77] (test)  loss: 5.1156 -> 3.4823   acc: 9.45% -> 29.04%              
client [55] (test)  loss: 5.5942 -> 3.4802   acc: 8.94% -> 29.56%              
client [12] (test)  loss: 5.9463 -> 3.3412   acc: 5.05% -> 37.46%              
client [89] (test)  loss: 4.9881 -> 3.2600   acc: 10.67% -> 31.28%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.1746 -> 3.6302   acc: 10.28% -> 30.85%             
client [51] (test)  loss: 6.1748 -> 2.8011   acc: 11.09% -> 37.27%             
client [8] (test)  loss: 5.8374 -> 3.4421   acc: 4.13% -> 37.36%               
client [18] (test)  loss: 5.0755 -> 3.9516   acc: 9.12% -> 27.55%              
client [94] (test)  loss: 5.3636 -> 3.6087   acc: 11.48% -> 37.34%             
client [81] (test)  loss: 5.5164 -> 3.5914   acc: 10.14% -> 30.07%             
client [3] (test)  loss: 5.0213 -> 3.5561   acc: 10.62% -> 31.37%              
client [11] (test)  loss: 5.1913 -> 4.0392   acc: 9.34% -> 26.12%              
client [95] (test)  loss: 5.7058 -> 3.3636   acc: 9.89% -> 37.68%              
client [67] (test)  loss: 5.5507 -> 3.5286   acc: 6.88% -> 31.92%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.6858 -> 3.8500   acc: 8.60% -> 26.60%              
client [79] (test)  loss: 6.0873 -> 4.4974   acc: 5.56% -> 19.23%              
client [58] (test)  loss: 5.7936 -> 3.9257   acc: 7.07% -> 29.86%              
client [88] (test)  loss: 5.3962 -> 4.0418   acc: 12.29% -> 28.84%             
client [46] (test)  loss: 4.9764 -> 3.6319   acc: 12.61% -> 29.73%             
client [11] (test)  loss: 5.1944 -> 4.2307   acc: 8.48% -> 23.36%              
client [55] (test)  loss: 5.1646 -> 3.8019   acc: 12.59% -> 25.18%             
client [13] (test)  loss: 5.3621 -> 3.8916   acc: 12.29% -> 33.62%             
client [31] (test)  loss: 5.5651 -> 3.2909   acc: 8.89% -> 41.81%              
client [75] (test)  loss: 5.7982 -> 3.5827   acc: 8.35% -> 31.65%              
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.3170 -> 3.7920   acc: 10.61% -> 32.73%             
client [7] (test)  loss: 6.2674 -> 4.0518   acc: 5.03% -> 28.90%               
client [57] (test)  loss: 5.0447 -> 3.7087   acc: 11.45% -> 28.18%             
client [13] (test)  loss: 5.7646 -> 4.1702   acc: 12.12% -> 32.08%             
client [43] (test)  loss: 5.3576 -> 3.9010   acc: 8.15% -> 28.12%              
client [91] (test)  loss: 5.3010 -> 3.1500   acc: 13.20% -> 37.06%             
client [10] (test)  loss: 5.4064 -> 3.4975   acc: 14.18% -> 32.65%             
client [64] (test)  loss: 5.0004 -> 3.5354   acc: 8.42% -> 36.96%              
client [82] (test)  loss: 5.1306 -> 3.7109   acc: 12.99% -> 32.95%             
client [22] (test)  loss: 5.4694 -> 3.6719   acc: 12.62% -> 31.56%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.5677 -> 4.1608   acc: 10.38% -> 25.26%             
client [23] (test)  loss: 5.0961 -> 3.2428   acc: 12.39% -> 35.75%             
client [88] (test)  loss: 6.1978 -> 4.4766   acc: 9.04% -> 26.11%              
client [98] (test)  loss: 5.2964 -> 3.5332   acc: 10.59% -> 38.94%             
client [79] (test)  loss: 5.9749 -> 4.4851   acc: 7.48% -> 20.73%              
client [21] (test)  loss: 5.7636 -> 3.8440   acc: 6.40% -> 29.20%              
client [92] (test)  loss: 5.8193 -> 3.7282   acc: 7.61% -> 31.49%              
client [56] (test)  loss: 5.9530 -> 4.2085   acc: 8.54% -> 24.91%              
client [5] (test)  loss: 5.6967 -> 3.6482   acc: 9.55% -> 30.45%               
client [52] (test)  loss: 5.5442 -> 4.1428   acc: 9.22% -> 31.38%              
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '4.7881 -> 0.0000', 'accuracy': '8.93% -> 0.00%'},           
    200: {'loss': '5.8316 -> 0.0000', 'accuracy': '8.58% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(10.32%) at epoch: 64                                     
Convergence (test_after):                                                      
FedDyn achieved 10.0%(15.54%) at epoch: 0                                      
FedDyn achieved 20.0%(22.29%) at epoch: 11                                     
FedDyn achieved 30.0%(31.21%) at epoch: 39                                     
