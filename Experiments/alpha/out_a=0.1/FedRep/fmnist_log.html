==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0077 -> 0.0031   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 1.2153 -> 1.0272   acc: 54.55% -> 54.55%             
client [21] (test)  loss: 24.9794 -> 0.8962   acc: 12.32% -> 78.99%            
client [68] (test)  loss: 0.4705 -> 0.3935   acc: 89.20% -> 89.20%             
client [93] (test)  loss: 0.7570 -> 0.4443   acc: 85.60% -> 85.60%             
client [31] (test)  loss: 1.4980 -> 0.7851   acc: 60.56% -> 60.56%             
client [20] (test)  loss: 0.2026 -> 0.1708   acc: 96.83% -> 96.83%             
client [59] (test)  loss: 45.2411 -> 1.0496   acc: 11.94% -> 70.97%            
client [48] (test)  loss: 0.1207 -> 0.1145   acc: 98.75% -> 98.75%             
client [34] (test)  loss: 1.3047 -> 0.8341   acc: 73.53% -> 73.53%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2109 -> 0.5544   acc: 57.33% -> 84.53%             
client [99] (test)  loss: 0.2540 -> 0.1959   acc: 88.64% -> 97.16%             
client [67] (test)  loss: 0.4062 -> 0.3362   acc: 86.16% -> 90.62%             
client [0] (test)  loss: 1.2184 -> 1.0857   acc: 62.62% -> 68.22%              
client [76] (test)  loss: 1.1531 -> 0.9333   acc: 84.21% -> 84.21%             
client [41] (test)  loss: 0.5943 -> 0.4581   acc: 82.64% -> 83.81%             
client [62] (test)  loss: 57.5915 -> 1.3149   acc: 0.00% -> 85.71%             
client [2] (test)  loss: 24.5421 -> 0.0067   acc: 0.00% -> 100.00%             
client [14] (test)  loss: 0.1930 -> 0.1495   acc: 91.68% -> 94.36%             
client [46] (test)  loss: 0.4435 -> 0.3799   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7295 -> 0.6596   acc: 77.72% -> 80.05%             
client [68] (test)  loss: 0.3008 -> 0.2514   acc: 91.29% -> 91.99%             
client [57] (test)  loss: 0.1222 -> 0.0566   acc: 97.18% -> 97.93%             
client [17] (test)  loss: 0.5284 -> 0.4330   acc: 85.08% -> 85.36%             
client [54] (test)  loss: 0.4033 -> 0.3629   acc: 80.83% -> 82.38%             
client [23] (test)  loss: 34.8748 -> 0.2540   acc: 4.89% -> 95.49%             
client [35] (test)  loss: 0.4008 -> 0.3428   acc: 89.70% -> 90.91%             
client [59] (test)  loss: 0.6520 -> 0.5654   acc: 80.97% -> 87.74%             
client [31] (test)  loss: 0.4722 -> 0.4025   acc: 85.00% -> 88.89%             
client [9] (test)  loss: 0.1716 -> 0.1264   acc: 92.95% -> 93.15%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4608 -> 0.3742   acc: 87.06% -> 89.71%             
client [33] (test)  loss: 0.1864 -> 0.1695   acc: 92.92% -> 94.98%             
client [16] (test)  loss: 0.2518 -> 0.1888   acc: 96.85% -> 98.25%             
client [44] (test)  loss: 0.9955 -> 0.5024   acc: 72.89% -> 87.91%             
client [8] (test)  loss: 0.0002 -> 0.0003   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.3931 -> 0.3516   acc: 88.33% -> 90.00%             
client [47] (test)  loss: 0.1041 -> 0.0627   acc: 96.88% -> 98.53%             
client [36] (test)  loss: 0.1201 -> 0.0880   acc: 97.79% -> 97.79%             
client [20] (test)  loss: 0.1009 -> 0.0941   acc: 96.83% -> 96.83%             
client [56] (test)  loss: 0.5658 -> 0.5345   acc: 80.08% -> 80.49%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2654 -> 0.2379   acc: 93.08% -> 93.08%              
client [60] (test)  loss: 0.1725 -> 0.1402   acc: 95.16% -> 96.13%             
client [28] (test)  loss: 0.2316 -> 0.1878   acc: 94.64% -> 95.54%             
client [25] (test)  loss: 0.4669 -> 0.3209   acc: 90.59% -> 93.73%             
client [58] (test)  loss: 0.2574 -> 0.2267   acc: 90.88% -> 92.15%             
client [44] (test)  loss: 0.5056 -> 0.3856   acc: 90.11% -> 91.58%             
client [39] (test)  loss: 0.2716 -> 0.2571   acc: 94.44% -> 94.44%             
client [29] (test)  loss: 0.4881 -> 0.4274   acc: 80.37% -> 81.74%             
client [3] (test)  loss: 0.4978 -> 0.3227   acc: 80.80% -> 90.40%              
client [84] (test)  loss: 0.0993 -> 0.0809   acc: 98.62% -> 99.08%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4727 -> 0.3973   acc: 87.44% -> 84.54%             
client [84] (test)  loss: 0.0783 -> 0.0683   acc: 98.62% -> 99.08%             
client [10] (test)  loss: 0.1230 -> 0.1147   acc: 97.83% -> 96.38%             
client [36] (test)  loss: 0.0569 -> 0.0486   acc: 97.79% -> 97.79%             
client [65] (test)  loss: 0.3600 -> 0.3432   acc: 91.67% -> 92.86%             
client [81] (test)  loss: 0.4916 -> 0.4114   acc: 80.00% -> 82.73%             
client [79] (test)  loss: 0.4865 -> 0.4844   acc: 77.89% -> 78.38%             
client [42] (test)  loss: 0.0442 -> 0.0398   acc: 98.75% -> 99.05%             
client [11] (test)  loss: 0.5976 -> 0.5481   acc: 68.67% -> 72.89%             
client [96] (test)  loss: 0.3994 -> 0.3518   acc: 87.08% -> 86.24%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.0977 -> 0.0737   acc: 98.38% -> 98.48%             
client [52] (test)  loss: 0.3713 -> 0.3611   acc: 85.27% -> 86.05%             
client [42] (test)  loss: 0.0376 -> 0.0372   acc: 98.93% -> 99.11%             
client [69] (test)  loss: 0.2317 -> 0.2284   acc: 91.20% -> 90.93%             
client [59] (test)  loss: 0.4346 -> 0.4129   acc: 88.39% -> 88.39%             
client [7] (test)  loss: 0.0968 -> 0.0733   acc: 96.13% -> 97.61%              
client [26] (test)  loss: 0.0356 -> 0.0226   acc: 99.52% -> 99.60%             
client [49] (test)  loss: 0.0005 -> 0.0005   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.5860 -> 0.5690   acc: 70.00% -> 72.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5855 -> 0.5744   acc: 70.00% -> 70.00%             
client [47] (test)  loss: 0.0465 -> 0.0394   acc: 98.90% -> 99.08%             
client [21] (test)  loss: 0.3315 -> 0.3433   acc: 86.23% -> 87.44%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.3301 -> 0.3178   acc: 92.48% -> 91.73%             
client [91] (test)  loss: 0.3524 -> 0.2517   acc: 78.12% -> 87.50%             
client [14] (test)  loss: 0.1241 -> 0.1085   acc: 96.38% -> 97.18%             
client [99] (test)  loss: 0.1019 -> 0.1133   acc: 98.58% -> 98.30%             
client [20] (test)  loss: 0.0651 -> 0.0653   acc: 97.33% -> 97.67%             
client [39] (test)  loss: 0.2240 -> 0.2249   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3408 -> 0.3386   acc: 86.05% -> 86.82%             
client [62] (test)  loss: 0.2615 -> 0.2588   acc: 92.86% -> 92.86%             
client [71] (test)  loss: 0.0609 -> 0.0568   acc: 97.47% -> 97.47%             
client [97] (test)  loss: 0.0852 -> 0.0807   acc: 98.03% -> 98.03%             
client [30] (test)  loss: 0.1763 -> 0.1738   acc: 94.76% -> 95.13%             
client [88] (test)  loss: 0.6356 -> 0.6150   acc: 71.82% -> 70.17%             
client [60] (test)  loss: 0.1492 -> 0.1365   acc: 96.71% -> 96.71%             
client [82] (test)  loss: 0.0488 -> 0.0452   acc: 98.56% -> 98.56%             
client [91] (test)  loss: 0.1704 -> 0.1264   acc: 93.75% -> 100.00%            
client [57] (test)  loss: 0.0343 -> 0.0342   acc: 99.44% -> 99.44%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2797 -> 0.2544   acc: 91.67% -> 92.22%             
client [15] (test)  loss: 0.2174 -> 0.2258   acc: 94.06% -> 93.21%             
client [71] (test)  loss: 0.0595 -> 0.0550   acc: 97.47% -> 97.47%             
client [97] (test)  loss: 0.0792 -> 0.0753   acc: 98.03% -> 98.19%             
client [53] (test)  loss: 0.0700 -> 0.0607   acc: 98.58% -> 98.79%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.3719 -> 0.3558   acc: 92.11% -> 92.11%             
client [79] (test)  loss: 0.4400 -> 0.4472   acc: 81.82% -> 82.31%             
client [28] (test)  loss: 0.1091 -> 0.1044   acc: 96.43% -> 96.43%             
client [99] (test)  loss: 0.0946 -> 0.1106   acc: 98.58% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0758 -> 0.0727   acc: 98.03% -> 98.19%             
client [86] (test)  loss: 0.3432 -> 0.3414   acc: 91.23% -> 91.23%             
client [34] (test)  loss: 0.1162 -> 0.1218   acc: 95.59% -> 95.59%             
client [73] (test)  loss: 0.0458 -> 0.0473   acc: 98.93% -> 98.93%             
client [5] (test)  loss: 0.0401 -> 0.0406   acc: 99.13% -> 99.13%              
client [96] (test)  loss: 0.2662 -> 0.2647   acc: 90.45% -> 91.01%             
client [22] (test)  loss: 0.1682 -> 0.1595   acc: 93.40% -> 95.28%             
client [60] (test)  loss: 0.1441 -> 0.1356   acc: 96.52% -> 96.71%             
client [66] (test)  loss: 0.0002 -> 0.0003   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0606 -> 0.0593   acc: 98.31% -> 98.31%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3228 -> 0.3109   acc: 92.11% -> 92.11%             
client [65] (test)  loss: 0.2980 -> 0.2883   acc: 92.86% -> 95.24%             
client [95] (test)  loss: 0.2452 -> 0.2425   acc: 93.23% -> 93.98%             
client [17] (test)  loss: 0.2297 -> 0.2215   acc: 92.27% -> 92.27%             
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.1420 -> 0.1446   acc: 94.55% -> 93.94%             
client [98] (test)  loss: 0.5711 -> 0.6031   acc: 72.00% -> 66.00%             
client [53] (test)  loss: 0.0635 -> 0.0576   acc: 98.79% -> 98.99%             
client [43] (test)  loss: 0.2978 -> 0.2789   acc: 88.89% -> 88.15%             
client [64] (test)  loss: 0.1979 -> 0.1956   acc: 95.59% -> 95.59%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2851 -> 0.3177   acc: 88.89% -> 88.41%             
client [88] (test)  loss: 0.5559 -> 0.5463   acc: 74.59% -> 72.93%             
client [38] (test)  loss: 0.4766 -> 0.4649   acc: 83.03% -> 84.24%             
client [3] (test)  loss: 0.2395 -> 0.1752   acc: 91.67% -> 93.84%              
client [5] (test)  loss: 0.0392 -> 0.0396   acc: 99.13% -> 99.13%              
client [41] (test)  loss: 0.2908 -> 0.3165   acc: 89.90% -> 88.99%             
client [7] (test)  loss: 0.0645 -> 0.0575   acc: 97.24% -> 97.61%              
client [37] (test)  loss: 0.2378 -> 0.2200   acc: 91.75% -> 92.27%             
client [45] (test)  loss: 0.4921 -> 0.4745   acc: 76.92% -> 75.64%             
client [47] (test)  loss: 0.0325 -> 0.0299   acc: 99.26% -> 99.26%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0570 -> 0.0568   acc: 98.60% -> 98.60%             
client [11] (test)  loss: 0.4153 -> 0.4237   acc: 82.22% -> 82.00%             
client [37] (test)  loss: 0.2152 -> 0.2046   acc: 92.27% -> 92.27%             
client [41] (test)  loss: 0.2695 -> 0.3224   acc: 90.80% -> 89.12%             
client [95] (test)  loss: 0.2221 -> 0.2141   acc: 92.48% -> 93.23%             
client [53] (test)  loss: 0.0605 -> 0.0544   acc: 98.89% -> 98.99%             
client [22] (test)  loss: 0.1453 -> 0.1333   acc: 95.75% -> 95.75%             
client [25] (test)  loss: 0.1834 -> 0.1696   acc: 94.77% -> 94.77%             
client [69] (test)  loss: 0.1819 -> 0.1892   acc: 94.13% -> 94.13%             
client [46] (test)  loss: 0.3011 -> 0.3012   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0240 -> 0.0232   acc: 99.26% -> 99.26%             
client [69] (test)  loss: 0.1608 -> 0.1923   acc: 94.93% -> 94.13%             
client [82] (test)  loss: 0.0353 -> 0.0354   acc: 99.52% -> 99.52%             
client [45] (test)  loss: 0.4599 -> 0.4498   acc: 78.21% -> 75.64%             
client [7] (test)  loss: 0.0624 -> 0.0573   acc: 97.24% -> 97.61%              
client [50] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [35] (test)  loss: 0.1380 -> 0.1394   acc: 94.55% -> 94.55%             
client [24] (test)  loss: 0.5033 -> 0.4522   acc: 83.16% -> 83.94%             
client [15] (test)  loss: 0.1945 -> 0.2152   acc: 92.36% -> 90.45%             
client [58] (test)  loss: 0.1186 -> 0.1076   acc: 97.08% -> 97.26%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1045 -> 0.0971   acc: 98.75% -> 98.75%             
client [76] (test)  loss: 0.2931 -> 0.2748   acc: 94.74% -> 94.74%             
client [67] (test)  loss: 0.1644 -> 0.1536   acc: 94.49% -> 95.09%             
client [37] (test)  loss: 0.2233 -> 0.1962   acc: 91.75% -> 91.75%             
client [58] (test)  loss: 0.1257 -> 0.1025   acc: 96.35% -> 97.45%             
client [64] (test)  loss: 0.1799 -> 0.1805   acc: 96.18% -> 95.59%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.0133 -> 0.0135   acc: 99.81% -> 99.71%             
client [12] (test)  loss: 0.3573 -> 0.3569   acc: 88.91% -> 88.57%             
client [89] (test)  loss: 0.7013 -> 0.6967   acc: 76.19% -> 78.57%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0600 -> 0.0629   acc: 99.08% -> 99.08%             
client [51] (test)  loss: 0.0282 -> 0.0283   acc: 99.49% -> 99.49%             
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.0149 -> 0.0149   acc: 99.76% -> 99.76%             
client [94] (test)  loss: 0.2431 -> 0.2410   acc: 92.91% -> 93.26%             
client [81] (test)  loss: 0.1543 -> 0.1544   acc: 95.45% -> 94.55%             
client [3] (test)  loss: 0.2006 -> 0.1614   acc: 92.75% -> 94.75%              
client [11] (test)  loss: 0.3903 -> 0.4096   acc: 84.00% -> 82.89%             
client [95] (test)  loss: 0.1922 -> 0.1890   acc: 92.48% -> 91.73%             
client [67] (test)  loss: 0.1556 -> 0.1494   acc: 94.79% -> 95.54%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2570 -> 0.3163   acc: 90.10% -> 88.65%             
client [79] (test)  loss: 0.3800 -> 0.3825   acc: 85.01% -> 84.77%             
client [58] (test)  loss: 0.1119 -> 0.0958   acc: 96.53% -> 97.99%             
client [88] (test)  loss: 0.5171 -> 0.5105   acc: 75.14% -> 76.24%             
client [46] (test)  loss: 0.2977 -> 0.2894   acc: 91.19% -> 91.19%             
client [11] (test)  loss: 0.3839 -> 0.4025   acc: 84.00% -> 83.56%             
client [55] (test)  loss: 0.0136 -> 0.0134   acc: 99.81% -> 99.81%             
client [13] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [31] (test)  loss: 0.2382 -> 0.1990   acc: 92.78% -> 93.89%             
client [75] (test)  loss: 0.3214 -> 0.3160   acc: 87.41% -> 87.65%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3578 -> 0.3496   acc: 88.19% -> 88.98%             
client [7] (test)  loss: 0.0523 -> 0.0535   acc: 97.97% -> 97.97%              
client [57] (test)  loss: 0.0306 -> 0.0310   acc: 99.62% -> 99.62%             
client [13] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [43] (test)  loss: 0.2554 -> 0.2514   acc: 88.89% -> 88.89%             
client [91] (test)  loss: 0.0213 -> 0.0205   acc: 100.00% -> 100.00%           
client [10] (test)  loss: 0.0782 -> 0.0782   acc: 95.65% -> 95.65%             
client [64] (test)  loss: 0.1769 -> 0.1757   acc: 96.18% -> 95.88%             
client [82] (test)  loss: 0.0327 -> 0.0328   acc: 99.52% -> 99.52%             
client [22] (test)  loss: 0.1032 -> 0.1048   acc: 97.17% -> 97.17%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0381 -> 0.0414   acc: 99.00% -> 99.00%             
client [23] (test)  loss: 0.1321 -> 0.1325   acc: 96.99% -> 96.99%             
client [88] (test)  loss: 0.5173 -> 0.5016   acc: 75.14% -> 77.35%             
client [98] (test)  loss: 0.4871 -> 0.6497   acc: 80.00% -> 65.00%             
client [79] (test)  loss: 0.3685 -> 0.3756   acc: 85.75% -> 85.50%             
client [21] (test)  loss: 0.2647 -> 0.3103   acc: 89.37% -> 88.89%             
client [92] (test)  loss: 0.2435 -> 0.2352   acc: 94.18% -> 94.86%             
client [56] (test)  loss: 0.3537 -> 0.3492   acc: 86.99% -> 86.99%             
client [5] (test)  loss: 0.0401 -> 0.0389   acc: 99.13% -> 99.13%              
client [52] (test)  loss: 0.2725 -> 0.2692   acc: 89.15% -> 89.15%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1650 -> 0.0000', 'accuracy': '94.31% -> 0.00%'},          
    200: {'loss': '0.1282 -> 0.0000', 'accuracy': '95.67% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(11.19%) at epoch: 0                                      
FedRep achieved 50.0%(53.39%) at epoch: 4                                      
FedRep achieved 70.0%(70.21%) at epoch: 7                                      
FedRep achieved 80.0%(81.08%) at epoch: 18                                     
FedRep achieved 90.0%(90.85%) at epoch: 24                                     
Convergence (test_after):                                                      
FedRep achieved 70.0%(72.98%) at epoch: 0                                      
FedRep achieved 80.0%(82.00%) at epoch: 3                                      
FedRep achieved 90.0%(93.38%) at epoch: 8                                      
