==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.9274 -> 0.6772   acc: 40.00% -> 75.65%             
client [81] (test)  loss: 2.3449 -> 1.7732   acc: 17.39% -> 43.48%             
client [21] (test)  loss: 2.5261 -> 2.1351   acc: 0.00% -> 41.38%              
client [68] (test)  loss: 1.8007 -> 0.2981   acc: 24.49% -> 89.80%             
client [93] (test)  loss: 2.5322 -> 0.7512   acc: 1.10% -> 81.32%              
client [31] (test)  loss: 2.5549 -> 0.6155   acc: 1.11% -> 86.67%              
client [20] (test)  loss: 1.9132 -> 0.5781   acc: 38.26% -> 84.35%             
client [59] (test)  loss: 2.2621 -> 0.3421   acc: 8.20% -> 95.90%              
client [48] (test)  loss: 1.6434 -> 0.5278   acc: 50.43% -> 83.76%             
client [34] (test)  loss: 2.1672 -> 1.0241   acc: 30.89% -> 74.80%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.4534 -> 0.2172   acc: 9.21% -> 93.35%              
client [99] (test)  loss: 2.8647 -> 0.2505   acc: 0.78% -> 95.31%              
client [67] (test)  loss: 1.5919 -> 0.1873   acc: 72.53% -> 97.80%             
client [0] (test)  loss: 2.1390 -> 0.9932   acc: 27.12% -> 74.58%              
client [76] (test)  loss: 2.0685 -> 0.8234   acc: 30.56% -> 69.44%             
client [41] (test)  loss: 2.5886 -> 0.4988   acc: 2.91% -> 85.44%              
client [62] (test)  loss: 2.3759 -> 0.0586   acc: 0.00% -> 100.00%             
client [2] (test)  loss: 2.3349 -> 0.6126   acc: 0.00% -> 86.30%               
client [14] (test)  loss: 1.8037 -> 0.9993   acc: 53.52% -> 64.79%             
client [46] (test)  loss: 3.1098 -> 0.7305   acc: 5.06% -> 77.22%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1822 -> 0.2398   acc: 58.06% -> 91.94%             
client [68] (test)  loss: 1.6046 -> 0.2438   acc: 38.27% -> 89.80%             
client [57] (test)  loss: 1.5192 -> 0.4123   acc: 38.98% -> 89.83%             
client [17] (test)  loss: 2.2577 -> 0.6619   acc: 1.06% -> 78.72%              
client [54] (test)  loss: 2.3343 -> 0.8061   acc: 37.39% -> 74.78%             
client [23] (test)  loss: 2.1880 -> 1.2602   acc: 35.19% -> 79.63%             
client [35] (test)  loss: 2.1534 -> 0.5468   acc: 0.00% -> 92.86%              
client [59] (test)  loss: 0.9043 -> 0.0662   acc: 81.15% -> 97.54%             
client [31] (test)  loss: 2.3294 -> 0.3615   acc: 7.78% -> 92.22%              
client [9] (test)  loss: 1.7026 -> 0.2903   acc: 52.38% -> 95.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2729 -> 0.2433   acc: 80.70% -> 94.74%             
client [33] (test)  loss: 1.9556 -> 0.3934   acc: 30.51% -> 89.83%             
client [16] (test)  loss: 1.9644 -> 0.8920   acc: 16.22% -> 75.68%             
client [44] (test)  loss: 1.4787 -> 0.2128   acc: 49.76% -> 92.75%             
client [8] (test)  loss: 1.7981 -> 0.9399   acc: 23.29% -> 47.95%              
client [31] (test)  loss: 1.9414 -> 0.3189   acc: 10.00% -> 93.33%             
client [47] (test)  loss: 2.7739 -> 0.1259   acc: 21.33% -> 96.00%             
client [36] (test)  loss: 1.5457 -> 0.3250   acc: 25.71% -> 89.71%             
client [20] (test)  loss: 3.5398 -> 0.3171   acc: 0.00% -> 86.09%              
client [56] (test)  loss: 1.9259 -> 0.3205   acc: 6.98% -> 97.67%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7296 -> 0.2183   acc: 69.23% -> 92.31%              
client [60] (test)  loss: 1.6284 -> 0.3517   acc: 13.33% -> 91.11%             
client [28] (test)  loss: 1.5990 -> 0.6897   acc: 48.00% -> 84.00%             
client [25] (test)  loss: 2.4490 -> 0.6311   acc: 11.49% -> 79.31%             
client [58] (test)  loss: 4.8351 -> 0.2445   acc: 0.00% -> 96.30%              
client [44] (test)  loss: 3.7802 -> 0.1633   acc: 2.90% -> 96.14%              
client [39] (test)  loss: 3.0999 -> 0.5279   acc: 6.40% -> 80.80%              
client [29] (test)  loss: 3.5280 -> 0.6203   acc: 3.57% -> 80.36%              
client [3] (test)  loss: 3.0542 -> 0.0699   acc: 2.44% -> 98.37%               
client [84] (test)  loss: 2.4741 -> 0.9417   acc: 9.76% -> 73.17%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.2214 -> 1.3769   acc: 6.90% -> 44.83%              
client [84] (test)  loss: 1.5680 -> 0.9090   acc: 58.54% -> 75.61%             
client [10] (test)  loss: 1.9355 -> 0.2625   acc: 17.89% -> 92.63%             
client [36] (test)  loss: 1.0703 -> 0.2267   acc: 49.71% -> 92.57%             
client [65] (test)  loss: 1.4702 -> 0.2326   acc: 48.33% -> 93.33%             
client [81] (test)  loss: 1.1949 -> 0.9669   acc: 65.22% -> 65.22%             
client [79] (test)  loss: 1.5447 -> 0.0994   acc: 36.24% -> 97.99%             
client [42] (test)  loss: 1.2724 -> 0.2682   acc: 56.98% -> 92.83%             
client [11] (test)  loss: 1.5047 -> 0.3452   acc: 48.94% -> 89.36%             
client [96] (test)  loss: 2.6284 -> 0.2219   acc: 7.35% -> 94.12%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.8480 -> 0.4296   acc: 21.92% -> 86.30%              
client [53] (test)  loss: 1.0827 -> 0.1554   acc: 65.22% -> 95.65%             
client [52] (test)  loss: 1.4000 -> 0.5793   acc: 51.28% -> 69.23%             
client [42] (test)  loss: 1.9845 -> 0.2426   acc: 26.04% -> 92.83%             
client [69] (test)  loss: 1.6357 -> 0.1521   acc: 36.57% -> 94.12%             
client [59] (test)  loss: 2.8600 -> 0.0562   acc: 3.28% -> 98.36%              
client [7] (test)  loss: 2.3967 -> 0.5153   acc: 27.59% -> 87.36%              
client [26] (test)  loss: 1.1721 -> 0.1012   acc: 52.41% -> 97.24%             
client [49] (test)  loss: 0.5029 -> 0.1283   acc: 86.81% -> 96.40%             
client [98] (test)  loss: 1.4763 -> 0.1490   acc: 39.19% -> 94.59%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4335 -> 0.1403   acc: 39.19% -> 94.59%             
client [47] (test)  loss: 1.0175 -> 0.0849   acc: 61.33% -> 98.67%             
client [21] (test)  loss: 2.4294 -> 1.3613   acc: 10.34% -> 44.83%             
client [77] (test)  loss: 2.0454 -> 0.2610   acc: 31.30% -> 91.30%             
client [95] (test)  loss: 2.0554 -> 0.1261   acc: 32.14% -> 95.24%             
client [91] (test)  loss: 1.2752 -> 0.7352   acc: 56.94% -> 76.39%             
client [14] (test)  loss: 1.7649 -> 0.5855   acc: 30.99% -> 74.65%             
client [99] (test)  loss: 1.5882 -> 0.1489   acc: 42.97% -> 94.53%             
client [20] (test)  loss: 2.1133 -> 0.2532   acc: 31.30% -> 88.70%             
client [39] (test)  loss: 0.9162 -> 0.3812   acc: 66.40% -> 86.40%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.8320 -> 0.5801   acc: 25.64% -> 69.23%             
client [62] (test)  loss: 1.6305 -> 0.0083   acc: 53.69% -> 100.00%            
client [71] (test)  loss: 1.6149 -> 0.0635   acc: 47.97% -> 98.37%             
client [97] (test)  loss: 1.4390 -> 0.5099   acc: 54.09% -> 82.39%             
client [30] (test)  loss: 1.9224 -> 0.1385   acc: 36.90% -> 96.79%             
client [88] (test)  loss: 1.6596 -> 0.5619   acc: 47.92% -> 78.12%             
client [60] (test)  loss: 1.2013 -> 0.1578   acc: 53.33% -> 95.56%             
client [82] (test)  loss: 1.2359 -> 0.0845   acc: 48.85% -> 98.28%             
client [91] (test)  loss: 1.4506 -> 0.6815   acc: 54.86% -> 78.47%             
client [57] (test)  loss: 1.0106 -> 0.2326   acc: 66.10% -> 92.37%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.7729 -> 0.1846   acc: 35.56% -> 96.67%             
client [15] (test)  loss: 0.7673 -> 0.2478   acc: 81.40% -> 88.37%             
client [71] (test)  loss: 1.7251 -> 0.0452   acc: 52.03% -> 99.19%             
client [97] (test)  loss: 1.2595 -> 0.5003   acc: 50.31% -> 83.02%             
client [53] (test)  loss: 1.0348 -> 0.1611   acc: 46.38% -> 94.20%             
client [77] (test)  loss: 1.7698 -> 0.2367   acc: 46.09% -> 93.04%             
client [76] (test)  loss: 0.3786 -> 0.1868   acc: 91.67% -> 100.00%            
client [79] (test)  loss: 1.7275 -> 0.0789   acc: 41.95% -> 98.32%             
client [28] (test)  loss: 1.0692 -> 0.7113   acc: 56.00% -> 84.00%             
client [99] (test)  loss: 1.3503 -> 0.1242   acc: 57.03% -> 95.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.0234 -> 0.4907   acc: 67.92% -> 84.28%             
client [86] (test)  loss: 1.1298 -> 0.3887   acc: 72.41% -> 88.51%             
client [34] (test)  loss: 1.5280 -> 0.4362   acc: 49.59% -> 88.62%             
client [73] (test)  loss: 0.6700 -> 0.2735   acc: 80.95% -> 92.06%             
client [5] (test)  loss: 0.9278 -> 1.2042   acc: 68.57% -> 77.14%              
client [96] (test)  loss: 1.9896 -> 0.1695   acc: 25.00% -> 95.59%             
client [22] (test)  loss: 0.8586 -> 0.3099   acc: 69.49% -> 89.83%             
client [60] (test)  loss: 1.0621 -> 0.1688   acc: 57.78% -> 95.56%             
client [66] (test)  loss: 1.2483 -> 0.3502   acc: 62.86% -> 91.43%             
client [83] (test)  loss: 1.2764 -> 0.0134   acc: 50.00% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4674 -> 0.1885   acc: 80.56% -> 100.00%            
client [65] (test)  loss: 1.5695 -> 0.1464   acc: 50.00% -> 94.17%             
client [95] (test)  loss: 2.0463 -> 0.1192   acc: 30.95% -> 96.43%             
client [17] (test)  loss: 1.4854 -> 0.3328   acc: 50.00% -> 90.43%             
client [8] (test)  loss: 0.9931 -> 0.1801   acc: 58.90% -> 91.78%              
client [35] (test)  loss: 1.2997 -> 0.1254   acc: 42.86% -> 100.00%            
client [98] (test)  loss: 1.6770 -> 0.1303   acc: 29.73% -> 95.95%             
client [53] (test)  loss: 0.9387 -> 0.1546   acc: 63.77% -> 95.65%             
client [43] (test)  loss: 0.1654 -> 0.0356   acc: 100.00% -> 100.00%           
client [64] (test)  loss: 0.7407 -> 0.1932   acc: 78.95% -> 96.49%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.8437 -> 0.7688   acc: 34.48% -> 75.86%             
client [88] (test)  loss: 1.5081 -> 0.4962   acc: 56.25% -> 81.25%             
client [38] (test)  loss: 0.1870 -> 0.0389   acc: 98.39% -> 99.19%             
client [3] (test)  loss: 2.3379 -> 0.0362   acc: 34.15% -> 99.19%              
client [5] (test)  loss: 0.7623 -> 1.0403   acc: 80.00% -> 82.86%              
client [41] (test)  loss: 0.7893 -> 0.1069   acc: 72.82% -> 99.03%             
client [7] (test)  loss: 1.9649 -> 0.4719   acc: 47.13% -> 88.51%              
client [37] (test)  loss: 0.9275 -> 0.0653   acc: 64.33% -> 98.17%             
client [45] (test)  loss: 0.8480 -> 0.1597   acc: 68.28% -> 95.59%             
client [47] (test)  loss: 0.3334 -> 0.0487   acc: 93.33% -> 97.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.0061 -> 0.3254   acc: 13.51% -> 91.89%             
client [11] (test)  loss: 1.3141 -> 0.2241   acc: 46.81% -> 93.62%             
client [37] (test)  loss: 0.8717 -> 0.0626   acc: 75.70% -> 98.31%             
client [41] (test)  loss: 1.0296 -> 0.1183   acc: 63.11% -> 98.06%             
client [95] (test)  loss: 2.4612 -> 0.1363   acc: 22.62% -> 95.24%             
client [53] (test)  loss: 0.9137 -> 0.1164   acc: 63.77% -> 98.55%             
client [22] (test)  loss: 1.2739 -> 0.3161   acc: 52.54% -> 86.44%             
client [25] (test)  loss: 2.4359 -> 0.3998   acc: 37.93% -> 81.61%             
client [69] (test)  loss: 3.0504 -> 0.1075   acc: 14.58% -> 96.42%             
client [46] (test)  loss: 0.5773 -> 0.1604   acc: 86.08% -> 94.94%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7245 -> 0.0487   acc: 77.33% -> 97.33%             
client [69] (test)  loss: 2.9822 -> 0.1041   acc: 20.72% -> 96.68%             
client [82] (test)  loss: 0.3762 -> 0.0797   acc: 90.23% -> 98.85%             
client [45] (test)  loss: 1.6841 -> 0.1395   acc: 33.04% -> 96.92%             
client [7] (test)  loss: 2.5141 -> 0.4711   acc: 20.69% -> 89.66%              
client [50] (test)  loss: 0.9067 -> 0.2209   acc: 71.67% -> 93.33%             
client [35] (test)  loss: 0.7180 -> 0.0952   acc: 78.57% -> 96.43%             
client [24] (test)  loss: 0.6695 -> 0.0617   acc: 79.03% -> 97.58%             
client [15] (test)  loss: 2.7920 -> 0.1760   acc: 6.98% -> 94.19%              
client [58] (test)  loss: 0.3886 -> 0.0742   acc: 88.89% -> 96.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.9338 -> 0.1982   acc: 68.38% -> 94.87%             
client [76] (test)  loss: 0.1962 -> 0.1547   acc: 94.44% -> 100.00%            
client [67] (test)  loss: 4.1205 -> 0.0591   acc: 2.20% -> 98.90%              
client [37] (test)  loss: 0.5998 -> 0.0552   acc: 80.90% -> 98.46%             
client [58] (test)  loss: 1.0526 -> 0.0874   acc: 74.07% -> 96.30%             
client [64] (test)  loss: 0.5729 -> 0.1950   acc: 77.19% -> 96.49%             
client [77] (test)  loss: 1.0746 -> 0.1860   acc: 64.35% -> 93.91%             
client [55] (test)  loss: 1.5631 -> 0.3070   acc: 57.14% -> 89.80%             
client [12] (test)  loss: 0.4099 -> 0.0088   acc: 87.65% -> 100.00%            
client [89] (test)  loss: 0.5667 -> 0.2168   acc: 86.84% -> 92.98%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1705 -> 0.8790   acc: 68.29% -> 75.61%             
client [51] (test)  loss: 1.9837 -> 0.2578   acc: 47.62% -> 95.24%             
client [8] (test)  loss: 0.9458 -> 0.1694   acc: 72.60% -> 94.52%              
client [18] (test)  loss: 0.9204 -> 0.1944   acc: 67.46% -> 95.24%             
client [94] (test)  loss: 1.2419 -> 0.2288   acc: 61.74% -> 91.67%             
client [81] (test)  loss: 1.5596 -> 0.9985   acc: 65.22% -> 73.91%             
client [3] (test)  loss: 1.6338 -> 0.0441   acc: 50.41% -> 98.37%              
client [11] (test)  loss: 0.6825 -> 0.2769   acc: 74.47% -> 91.49%             
client [95] (test)  loss: 1.2171 -> 0.0743   acc: 53.57% -> 96.43%             
client [67] (test)  loss: 3.7063 -> 0.0521   acc: 5.49% -> 98.90%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.5549 -> 1.2968   acc: 37.93% -> 68.97%             
client [79] (test)  loss: 0.6217 -> 0.0595   acc: 78.86% -> 98.66%             
client [58] (test)  loss: 1.2463 -> 0.1207   acc: 66.67% -> 96.30%             
client [88] (test)  loss: 1.1206 -> 0.5065   acc: 64.58% -> 83.33%             
client [46] (test)  loss: 0.8743 -> 0.1590   acc: 65.82% -> 94.94%             
client [11] (test)  loss: 0.5516 -> 0.2548   acc: 76.60% -> 95.74%             
client [55] (test)  loss: 2.3297 -> 0.3282   acc: 30.61% -> 89.80%             
client [13] (test)  loss: 1.6501 -> 0.2515   acc: 44.68% -> 91.49%             
client [31] (test)  loss: 1.3142 -> 0.1734   acc: 48.89% -> 96.67%             
client [75] (test)  loss: 0.8098 -> 0.2603   acc: 78.35% -> 91.75%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7673 -> 0.3312   acc: 77.42% -> 87.90%             
client [7] (test)  loss: 2.3891 -> 0.4865   acc: 37.93% -> 87.36%              
client [57] (test)  loss: 0.4269 -> 0.1848   acc: 88.14% -> 94.07%             
client [13] (test)  loss: 1.6293 -> 0.2497   acc: 55.32% -> 91.49%             
client [43] (test)  loss: 0.6496 -> 0.0883   acc: 75.00% -> 95.00%             
client [91] (test)  loss: 0.8394 -> 0.5459   acc: 72.92% -> 84.03%             
client [10] (test)  loss: 0.5191 -> 0.1904   acc: 84.21% -> 93.68%             
client [64] (test)  loss: 0.2979 -> 0.1823   acc: 91.23% -> 96.49%             
client [82] (test)  loss: 0.2082 -> 0.0854   acc: 94.83% -> 98.85%             
client [22] (test)  loss: 0.5348 -> 0.2420   acc: 88.14% -> 89.83%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6027 -> 0.1256   acc: 80.87% -> 93.91%             
client [23] (test)  loss: 0.5365 -> 0.2579   acc: 87.04% -> 94.44%             
client [88] (test)  loss: 1.5279 -> 0.5304   acc: 58.33% -> 83.33%             
client [98] (test)  loss: 2.2443 -> 0.0735   acc: 39.19% -> 97.30%             
client [79] (test)  loss: 0.1851 -> 0.0574   acc: 96.64% -> 98.32%             
client [21] (test)  loss: 0.9241 -> 0.7731   acc: 68.97% -> 65.52%             
client [92] (test)  loss: 5.2677 -> 0.0060   acc: 6.80% -> 100.00%             
client [56] (test)  loss: 0.7919 -> 0.4411   acc: 72.09% -> 88.37%             
client [5] (test)  loss: 0.6801 -> 1.3548   acc: 80.00% -> 80.00%              
client [52] (test)  loss: 2.8211 -> 0.3553   acc: 38.46% -> 82.05%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '1.3740 -> 0.0000', 'accuracy': '57.35% -> 0.00%'},          
    200: {'loss': '1.3889 -> 0.0000', 'accuracy': '57.83% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(11.82%) at epoch: 0                                     
FedProx achieved 20.0%(26.51%) at epoch: 4                                     
FedProx achieved 50.0%(51.42%) at epoch: 7                                     
FedProx achieved 60.0%(68.49%) at epoch: 62                                    
FedProx achieved 70.0%(75.81%) at epoch: 114                                   
FedProx achieved 80.0%(81.65%) at epoch: 175                                   
Convergence (test_after):                                                      
FedProx achieved 60.0%(64.11%) at epoch: 0                                     
FedProx achieved 70.0%(74.43%) at epoch: 1                                     
FedProx achieved 80.0%(85.39%) at epoch: 5                                     
FedProx achieved 90.0%(91.87%) at epoch: 16                                    
