==================== ALGORITHM: FedBabu ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5217 -> 0.0146   acc: 88.17% -> 100.00%            
client [81] (test)  loss: 1.6187 -> 0.4412   acc: 19.09% -> 86.36%             
client [21] (test)  loss: 27.1132 -> 0.3666   acc: 24.40% -> 87.44%            
client [68] (test)  loss: 0.8298 -> 0.1889   acc: 91.99% -> 95.12%             
client [93] (test)  loss: 2.5312 -> 0.2227   acc: 3.20% -> 96.80%              
client [31] (test)  loss: 1.8938 -> 0.3317   acc: 5.56% -> 92.78%              
client [20] (test)  loss: 1.4333 -> 0.0927   acc: 32.17% -> 96.83%             
client [59] (test)  loss: 19.1259 -> 0.4482   acc: 17.74% -> 87.42%            
client [48] (test)  loss: 1.9714 -> 0.0979   acc: 0.00% -> 98.75%              
client [34] (test)  loss: 1.2689 -> 0.3173   acc: 80.88% -> 97.06%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.3459 -> 0.2078   acc: 53.87% -> 95.20%             
client [99] (test)  loss: 2.8418 -> 0.0849   acc: 10.23% -> 98.30%             
client [67] (test)  loss: 2.3843 -> 0.1639   acc: 8.93% -> 94.79%              
client [0] (test)  loss: 0.8547 -> 0.5205   acc: 79.44% -> 81.31%              
client [76] (test)  loss: 1.0962 -> 0.4091   acc: 76.32% -> 94.74%             
client [41] (test)  loss: 1.0593 -> 0.2866   acc: 71.89% -> 89.77%             
client [62] (test)  loss: 33.3544 -> 0.6671   acc: 35.71% -> 92.86%            
client [2] (test)  loss: 19.9035 -> 0.0019   acc: 10.59% -> 100.00%            
client [14] (test)  loss: 3.1882 -> 0.1086   acc: 5.64% -> 96.78%              
client [46] (test)  loss: 2.7793 -> 0.3066   acc: 7.49% -> 91.19%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0654 -> 0.4534   acc: 59.84% -> 83.94%             
client [68] (test)  loss: 0.5080 -> 0.1119   acc: 83.62% -> 96.86%             
client [57] (test)  loss: 0.5599 -> 0.0307   acc: 91.17% -> 99.25%             
client [17] (test)  loss: 1.2239 -> 0.1672   acc: 36.19% -> 96.13%             
client [54] (test)  loss: 0.5123 -> 0.2139   acc: 77.72% -> 92.75%             
client [23] (test)  loss: 4.7795 -> 0.1239   acc: 72.56% -> 96.99%             
client [35] (test)  loss: 1.1993 -> 0.1834   acc: 46.06% -> 95.15%             
client [59] (test)  loss: 0.9767 -> 0.2932   acc: 47.10% -> 91.29%             
client [31] (test)  loss: 1.0392 -> 0.2042   acc: 50.56% -> 93.89%             
client [9] (test)  loss: 0.5950 -> 0.0445   acc: 81.33% -> 98.76%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7056 -> 0.1779   acc: 82.65% -> 94.12%             
client [33] (test)  loss: 0.4160 -> 0.0806   acc: 84.47% -> 97.03%             
client [16] (test)  loss: 0.9240 -> 0.0542   acc: 51.40% -> 99.30%             
client [44] (test)  loss: 0.9484 -> 0.1472   acc: 68.13% -> 95.60%             
client [8] (test)  loss: 0.7236 -> 0.0028   acc: 75.45% -> 100.00%             
client [31] (test)  loss: 0.8195 -> 0.1823   acc: 73.33% -> 94.44%             
client [47] (test)  loss: 0.4706 -> 0.0253   acc: 83.82% -> 99.63%             
client [36] (test)  loss: 0.1254 -> 0.0085   acc: 97.79% -> 99.75%             
client [20] (test)  loss: 1.0021 -> 0.0178   acc: 60.00% -> 99.33%             
client [56] (test)  loss: 0.6818 -> 0.2857   acc: 81.71% -> 90.65%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7843 -> 0.1170   acc: 74.74% -> 96.54%              
client [60] (test)  loss: 2.9197 -> 0.0791   acc: 13.15% -> 97.68%             
client [28] (test)  loss: 0.2586 -> 0.0642   acc: 93.75% -> 97.32%             
client [25] (test)  loss: 1.4852 -> 0.1267   acc: 45.64% -> 95.82%             
client [58] (test)  loss: 1.7978 -> 0.1002   acc: 43.80% -> 97.45%             
client [44] (test)  loss: 1.4474 -> 0.1450   acc: 44.69% -> 95.60%             
client [39] (test)  loss: 0.5413 -> 0.1086   acc: 75.00% -> 94.44%             
client [29] (test)  loss: 2.1031 -> 0.2739   acc: 27.40% -> 90.41%             
client [3] (test)  loss: 0.5688 -> 0.1595   acc: 78.08% -> 94.20%              
client [84] (test)  loss: 2.2078 -> 0.0262   acc: 24.31% -> 99.08%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7537 -> 0.2319   acc: 70.29% -> 90.82%             
client [84] (test)  loss: 1.2229 -> 0.0252   acc: 50.92% -> 99.54%             
client [10] (test)  loss: 0.3103 -> 0.0665   acc: 91.30% -> 97.10%             
client [36] (test)  loss: 0.0751 -> 0.0065   acc: 98.53% -> 99.75%             
client [65] (test)  loss: 1.6270 -> 0.2096   acc: 28.57% -> 94.05%             
client [81] (test)  loss: 0.7580 -> 0.1246   acc: 75.45% -> 96.36%             
client [79] (test)  loss: 1.1284 -> 0.3328   acc: 53.56% -> 86.98%             
client [42] (test)  loss: 0.8568 -> 0.0327   acc: 67.10% -> 98.87%             
client [11] (test)  loss: 0.9644 -> 0.4202   acc: 65.11% -> 83.56%             
client [96] (test)  loss: 0.4471 -> 0.2169   acc: 83.71% -> 93.54%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3741 -> 0.0022   acc: 88.74% -> 100.00%             
client [53] (test)  loss: 0.3955 -> 0.0373   acc: 85.74% -> 99.19%             
client [52] (test)  loss: 0.8789 -> 0.2661   acc: 59.69% -> 86.82%             
client [42] (test)  loss: 0.2007 -> 0.0316   acc: 96.19% -> 98.93%             
client [69] (test)  loss: 0.5522 -> 0.1495   acc: 84.80% -> 96.00%             
client [59] (test)  loss: 0.7239 -> 0.2521   acc: 70.97% -> 91.94%             
client [7] (test)  loss: 0.3462 -> 0.0472   acc: 88.77% -> 98.34%              
client [26] (test)  loss: 0.4000 -> 0.0108   acc: 90.73% -> 99.84%             
client [49] (test)  loss: 0.8733 -> 0.0020   acc: 73.04% -> 100.00%            
client [98] (test)  loss: 0.6833 -> 0.5843   acc: 82.00% -> 72.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.0263 -> 0.2762   acc: 61.00% -> 92.00%             
client [47] (test)  loss: 0.5101 -> 0.0249   acc: 81.99% -> 99.26%             
client [21] (test)  loss: 0.5368 -> 0.2032   acc: 79.71% -> 92.03%             
client [77] (test)  loss: 0.1827 -> 0.0189   acc: 94.37% -> 99.72%             
client [95] (test)  loss: 0.5622 -> 0.1385   acc: 78.95% -> 93.98%             
client [91] (test)  loss: 0.7646 -> 0.1657   acc: 71.88% -> 90.62%             
client [14] (test)  loss: 0.1340 -> 0.0903   acc: 97.58% -> 97.85%             
client [99] (test)  loss: 0.1218 -> 0.0692   acc: 97.73% -> 98.58%             
client [20] (test)  loss: 2.6793 -> 0.0098   acc: 4.83% -> 99.67%              
client [39] (test)  loss: 0.2432 -> 0.0762   acc: 97.22% -> 97.22%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7916 -> 0.2639   acc: 74.42% -> 86.05%             
client [62] (test)  loss: 0.8504 -> 0.2157   acc: 64.29% -> 92.86%             
client [71] (test)  loss: 0.1732 -> 0.0419   acc: 94.39% -> 98.37%             
client [97] (test)  loss: 0.2015 -> 0.0547   acc: 94.58% -> 99.01%             
client [30] (test)  loss: 0.2293 -> 0.1218   acc: 95.13% -> 96.63%             
client [88] (test)  loss: 1.3549 -> 0.3835   acc: 44.75% -> 84.53%             
client [60] (test)  loss: 1.4751 -> 0.0714   acc: 38.30% -> 98.26%             
client [82] (test)  loss: 1.4705 -> 0.0282   acc: 51.60% -> 99.36%             
client [91] (test)  loss: 0.8515 -> 0.0649   acc: 56.25% -> 100.00%            
client [57] (test)  loss: 1.2160 -> 0.0265   acc: 58.27% -> 99.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7507 -> 0.1406   acc: 72.78% -> 95.56%             
client [15] (test)  loss: 0.7273 -> 0.1730   acc: 66.45% -> 92.99%             
client [71] (test)  loss: 0.2655 -> 0.0408   acc: 90.24% -> 98.37%             
client [97] (test)  loss: 0.3872 -> 0.0524   acc: 89.49% -> 99.18%             
client [53] (test)  loss: 0.2413 -> 0.0357   acc: 93.02% -> 99.09%             
client [77] (test)  loss: 0.0475 -> 0.0130   acc: 99.15% -> 99.44%             
client [76] (test)  loss: 0.3313 -> 0.1689   acc: 84.21% -> 94.74%             
client [79] (test)  loss: 1.0210 -> 0.3023   acc: 54.79% -> 87.71%             
client [28] (test)  loss: 0.3556 -> 0.0491   acc: 87.50% -> 98.21%             
client [99] (test)  loss: 0.8627 -> 0.0651   acc: 62.78% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4052 -> 0.0500   acc: 84.89% -> 99.18%             
client [86] (test)  loss: 0.2718 -> 0.0928   acc: 94.74% -> 98.25%             
client [34] (test)  loss: 0.1518 -> 0.0705   acc: 98.53% -> 97.06%             
client [73] (test)  loss: 0.9731 -> 0.0374   acc: 62.50% -> 99.64%             
client [5] (test)  loss: 0.5600 -> 0.0452   acc: 78.17% -> 98.91%              
client [96] (test)  loss: 0.4588 -> 0.1948   acc: 82.87% -> 94.10%             
client [22] (test)  loss: 0.8169 -> 0.1023   acc: 71.23% -> 96.70%             
client [60] (test)  loss: 0.8129 -> 0.0755   acc: 71.18% -> 97.68%             
client [66] (test)  loss: 0.9317 -> 0.0034   acc: 72.99% -> 100.00%            
client [83] (test)  loss: 0.4103 -> 0.0441   acc: 84.36% -> 98.73%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1889 -> 0.1674   acc: 92.11% -> 94.74%             
client [65] (test)  loss: 1.0588 -> 0.2014   acc: 51.19% -> 95.24%             
client [95] (test)  loss: 0.2073 -> 0.1085   acc: 93.98% -> 96.24%             
client [17] (test)  loss: 0.4004 -> 0.1010   acc: 89.23% -> 95.86%             
client [8] (test)  loss: 0.5177 -> 0.0014   acc: 85.14% -> 100.00%             
client [35] (test)  loss: 0.4582 -> 0.1782   acc: 84.85% -> 93.94%             
client [98] (test)  loss: 0.6041 -> 0.2950   acc: 83.00% -> 88.00%             
client [53] (test)  loss: 0.1643 -> 0.0345   acc: 95.45% -> 99.09%             
client [43] (test)  loss: 1.7503 -> 0.1365   acc: 31.11% -> 95.56%             
client [64] (test)  loss: 0.2216 -> 0.1183   acc: 93.53% -> 95.88%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4709 -> 0.1720   acc: 83.33% -> 93.72%             
client [88] (test)  loss: 1.0240 -> 0.3531   acc: 62.43% -> 87.29%             
client [38] (test)  loss: 1.0945 -> 0.3748   acc: 58.79% -> 88.48%             
client [3] (test)  loss: 0.5314 -> 0.1349   acc: 79.53% -> 95.29%              
client [5] (test)  loss: 0.7070 -> 0.0451   acc: 72.93% -> 99.13%              
client [41] (test)  loss: 0.3535 -> 0.1810   acc: 89.38% -> 93.65%             
client [7] (test)  loss: 0.8075 -> 0.0335   acc: 72.01% -> 98.71%              
client [37] (test)  loss: 0.4338 -> 0.0927   acc: 84.02% -> 96.91%             
client [45] (test)  loss: 0.4739 -> 0.3222   acc: 80.77% -> 84.62%             
client [47] (test)  loss: 0.7040 -> 0.0179   acc: 70.77% -> 99.26%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.0950 -> 0.0376   acc: 38.46% -> 98.60%             
client [11] (test)  loss: 3.1645 -> 0.2599   acc: 5.33% -> 90.00%              
client [37] (test)  loss: 2.6539 -> 0.0889   acc: 10.82% -> 96.91%             
client [41] (test)  loss: 1.4893 -> 0.1721   acc: 45.98% -> 93.39%             
client [95] (test)  loss: 0.8182 -> 0.1124   acc: 69.92% -> 96.24%             
client [53] (test)  loss: 0.3673 -> 0.0362   acc: 87.77% -> 99.09%             
client [22] (test)  loss: 2.0869 -> 0.1024   acc: 23.58% -> 97.64%             
client [25] (test)  loss: 0.9017 -> 0.0808   acc: 68.29% -> 97.91%             
client [69] (test)  loss: 0.6467 -> 0.1316   acc: 79.73% -> 95.73%             
client [46] (test)  loss: 0.3386 -> 0.2772   acc: 90.75% -> 91.63%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4255 -> 0.0209   acc: 82.54% -> 99.26%             
client [69] (test)  loss: 0.9019 -> 0.1253   acc: 69.07% -> 95.73%             
client [82] (test)  loss: 0.6968 -> 0.0255   acc: 75.80% -> 99.52%             
client [45] (test)  loss: 0.4035 -> 0.2873   acc: 85.90% -> 87.18%             
client [7] (test)  loss: 0.5098 -> 0.0322   acc: 79.19% -> 98.53%              
client [50] (test)  loss: 0.9892 -> 0.0039   acc: 54.26% -> 99.78%             
client [35] (test)  loss: 0.6639 -> 0.1577   acc: 69.70% -> 95.15%             
client [24] (test)  loss: 0.6598 -> 0.4171   acc: 75.39% -> 84.20%             
client [15] (test)  loss: 1.1228 -> 0.1908   acc: 54.35% -> 92.78%             
client [58] (test)  loss: 0.4150 -> 0.0675   acc: 85.40% -> 98.18%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2368 -> 0.0391   acc: 95.00% -> 98.75%             
client [76] (test)  loss: 0.2438 -> 0.1656   acc: 92.11% -> 94.74%             
client [67] (test)  loss: 1.5212 -> 0.1199   acc: 38.84% -> 96.13%             
client [37] (test)  loss: 0.1915 -> 0.0824   acc: 95.36% -> 96.91%             
client [58] (test)  loss: 0.2374 -> 0.0659   acc: 93.25% -> 97.99%             
client [64] (test)  loss: 0.2275 -> 0.1207   acc: 92.35% -> 95.88%             
client [77] (test)  loss: 0.0763 -> 0.0142   acc: 98.87% -> 99.44%             
client [55] (test)  loss: 0.0998 -> 0.0089   acc: 97.80% -> 99.71%             
client [12] (test)  loss: 2.0076 -> 0.2819   acc: 25.09% -> 90.27%             
client [89] (test)  loss: 1.4959 -> 0.6039   acc: 54.76% -> 85.71%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4846 -> 0.0147   acc: 80.28% -> 99.54%             
client [51] (test)  loss: 0.5451 -> 0.0099   acc: 80.77% -> 99.49%             
client [8] (test)  loss: 0.6531 -> 0.0016   acc: 79.05% -> 100.00%             
client [18] (test)  loss: 0.1222 -> 0.0046   acc: 96.36% -> 99.76%             
client [94] (test)  loss: 0.5660 -> 0.1228   acc: 81.56% -> 96.45%             
client [81] (test)  loss: 0.6705 -> 0.0568   acc: 77.27% -> 97.27%             
client [3] (test)  loss: 0.4099 -> 0.1230   acc: 84.78% -> 95.65%              
client [11] (test)  loss: 1.0550 -> 0.2553   acc: 62.67% -> 90.44%             
client [95] (test)  loss: 0.3637 -> 0.1124   acc: 91.73% -> 96.99%             
client [67] (test)  loss: 1.1262 -> 0.1195   acc: 51.79% -> 96.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5209 -> 0.1616   acc: 80.43% -> 93.24%             
client [79] (test)  loss: 1.1883 -> 0.2833   acc: 56.02% -> 88.94%             
client [58] (test)  loss: 0.1928 -> 0.0632   acc: 94.53% -> 98.36%             
client [88] (test)  loss: 1.3661 -> 0.3453   acc: 45.86% -> 86.74%             
client [46] (test)  loss: 1.8679 -> 0.2872   acc: 28.63% -> 89.87%             
client [11] (test)  loss: 1.2142 -> 0.2378   acc: 57.33% -> 91.78%             
client [55] (test)  loss: 0.0906 -> 0.0083   acc: 97.89% -> 99.81%             
client [13] (test)  loss: 0.4579 -> 0.0017   acc: 87.98% -> 100.00%            
client [31] (test)  loss: 0.4354 -> 0.1054   acc: 85.56% -> 95.56%             
client [75] (test)  loss: 0.7580 -> 0.2470   acc: 71.91% -> 91.28%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4234 -> 0.2411   acc: 83.46% -> 91.34%             
client [7] (test)  loss: 0.3797 -> 0.0320   acc: 86.56% -> 98.34%              
client [57] (test)  loss: 0.7417 -> 0.0219   acc: 66.92% -> 99.62%             
client [13] (test)  loss: 0.9199 -> 0.0014   acc: 59.84% -> 100.00%            
client [43] (test)  loss: 1.8864 -> 0.1223   acc: 32.59% -> 96.30%             
client [91] (test)  loss: 0.2359 -> 0.0734   acc: 96.88% -> 96.88%             
client [10] (test)  loss: 0.2002 -> 0.0463   acc: 94.20% -> 97.83%             
client [64] (test)  loss: 0.3561 -> 0.1187   acc: 87.94% -> 96.47%             
client [82] (test)  loss: 0.6881 -> 0.0269   acc: 75.00% -> 99.52%             
client [22] (test)  loss: 0.8351 -> 0.1150   acc: 67.45% -> 97.17%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.2576 -> 0.0096   acc: 14.00% -> 99.67%             
client [23] (test)  loss: 0.6798 -> 0.0873   acc: 70.68% -> 97.37%             
client [88] (test)  loss: 1.1020 -> 0.3866   acc: 56.91% -> 86.19%             
client [98] (test)  loss: 1.8950 -> 0.2791   acc: 25.00% -> 88.00%             
client [79] (test)  loss: 1.4708 -> 0.2819   acc: 50.12% -> 89.19%             
client [21] (test)  loss: 0.2782 -> 0.1547   acc: 89.86% -> 92.75%             
client [92] (test)  loss: 0.2538 -> 0.1203   acc: 95.89% -> 95.55%             
client [56] (test)  loss: 1.6093 -> 0.2735   acc: 32.93% -> 91.46%             
client [5] (test)  loss: 0.6185 -> 0.0452   acc: 77.73% -> 98.91%              
client [52] (test)  loss: 0.3595 -> 0.2232   acc: 89.15% -> 89.92%             
==================== FedBabu TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.6477 -> 0.3533', 'accuracy': '75.06% -> 93.65%'},         
    200: {'loss': '0.8449 -> 0.6138', 'accuracy': '68.83% -> 93.49%'}          
}                                                                              
Convergence (test_before):                                                     
FedBabu achieved 10.0%(11.19%) at epoch: 0                                     
FedBabu achieved 30.0%(35.43%) at epoch: 4                                     
FedBabu achieved 50.0%(59.27%) at epoch: 8                                     
FedBabu achieved 60.0%(60.10%) at epoch: 11                                    
FedBabu achieved 70.0%(71.43%) at epoch: 13                                    
FedBabu achieved 80.0%(83.80%) at epoch: 48                                    
FedBabu achieved 90.0%(91.83%) at epoch: 67                                    
Convergence (test_after):                                                      
FedBabu achieved 70.0%(76.60%) at epoch: 0                                     
FedBabu achieved 90.0%(91.19%) at epoch: 2                                     
