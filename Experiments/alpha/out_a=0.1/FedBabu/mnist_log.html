==================== ALGORITHM: FedBabu ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.1990 -> 0.0080   acc: 75.54% -> 100.00%            
client [81] (test)  loss: 1.6456 -> 0.2011   acc: 50.00% -> 91.18%             
client [21] (test)  loss: 0.9815 -> 0.0212   acc: 95.73% -> 99.35%             
client [68] (test)  loss: 2.3222 -> 0.7301   acc: 17.65% -> 76.47%             
client [93] (test)  loss: 0.7918 -> 0.2366   acc: 91.48% -> 95.41%             
client [31] (test)  loss: 1.7594 -> 0.3939   acc: 47.71% -> 90.37%             
client [20] (test)  loss: 2.6110 -> 0.2686   acc: 12.50% -> 95.83%             
client [59] (test)  loss: 7.9553 -> 0.1805   acc: 72.68% -> 98.05%             
client [48] (test)  loss: 1.3948 -> 0.5808   acc: 53.10% -> 82.17%             
client [34] (test)  loss: 2.0308 -> 0.1634   acc: 17.16% -> 96.57%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5339 -> 0.1094   acc: 89.17% -> 97.78%             
client [99] (test)  loss: 0.4456 -> 0.0383   acc: 93.02% -> 98.95%             
client [67] (test)  loss: 1.2485 -> 0.2805   acc: 59.73% -> 92.92%             
client [0] (test)  loss: 1.9567 -> 0.0317   acc: 4.65% -> 98.84%               
client [76] (test)  loss: 0.5411 -> 0.2049   acc: 91.67% -> 94.44%             
client [41] (test)  loss: 0.6052 -> 0.0526   acc: 80.71% -> 99.06%             
client [62] (test)  loss: 42.5092 -> 0.1724   acc: 42.86% -> 96.36%            
client [2] (test)  loss: 5.0199 -> 0.0861   acc: 90.70% -> 97.67%              
client [14] (test)  loss: 1.3834 -> 0.1907   acc: 50.41% -> 93.85%             
client [46] (test)  loss: 0.7800 -> 0.1689   acc: 74.86% -> 96.24%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4980 -> 0.2439   acc: 84.00% -> 94.00%             
client [68] (test)  loss: 1.4893 -> 0.1967   acc: 41.18% -> 96.73%             
client [57] (test)  loss: 0.3744 -> 0.0405   acc: 95.22% -> 98.92%             
client [17] (test)  loss: 0.1316 -> 0.1199   acc: 95.56% -> 97.78%             
client [54] (test)  loss: 1.0964 -> 0.1186   acc: 58.70% -> 95.65%             
client [23] (test)  loss: 57.5320 -> 0.3507   acc: 43.08% -> 93.85%            
client [35] (test)  loss: 0.5760 -> 0.1582   acc: 76.62% -> 95.67%             
client [59] (test)  loss: 0.1610 -> 0.0255   acc: 98.78% -> 99.51%             
client [31] (test)  loss: 0.5580 -> 0.1290   acc: 88.07% -> 97.71%             
client [9] (test)  loss: 2.0722 -> 0.0965   acc: 14.14% -> 98.54%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1457 -> 0.0012   acc: 97.01% -> 100.00%            
client [33] (test)  loss: 0.5094 -> 0.0582   acc: 84.88% -> 98.63%             
client [16] (test)  loss: 0.8282 -> 0.0276   acc: 70.22% -> 99.45%             
client [44] (test)  loss: 0.3264 -> 0.0025   acc: 92.29% -> 100.00%            
client [8] (test)  loss: 1.0129 -> 0.1412   acc: 65.17% -> 95.79%              
client [31] (test)  loss: 0.5456 -> 0.1034   acc: 82.57% -> 97.71%             
client [47] (test)  loss: 0.1489 -> 0.0049   acc: 97.76% -> 100.00%            
client [36] (test)  loss: 0.3827 -> 0.0384   acc: 100.00% -> 100.00%           
client [20] (test)  loss: 0.1547 -> 0.0617   acc: 97.22% -> 98.61%             
client [56] (test)  loss: 0.5159 -> 0.0980   acc: 84.38% -> 98.44%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4552 -> 0.0034   acc: 86.62% -> 100.00%             
client [60] (test)  loss: 0.4861 -> 0.0032   acc: 91.49% -> 100.00%            
client [28] (test)  loss: 0.1305 -> 0.0843   acc: 96.43% -> 98.81%             
client [25] (test)  loss: 0.3867 -> 0.0799   acc: 87.80% -> 97.60%             
client [58] (test)  loss: 0.3876 -> 0.0812   acc: 89.64% -> 97.20%             
client [44] (test)  loss: 0.2322 -> 0.0021   acc: 95.64% -> 100.00%            
client [39] (test)  loss: 0.3667 -> 0.0961   acc: 88.50% -> 97.35%             
client [29] (test)  loss: 0.2390 -> 0.0122   acc: 96.37% -> 99.76%             
client [3] (test)  loss: 0.2448 -> 0.0016   acc: 94.46% -> 100.00%             
client [84] (test)  loss: 0.2446 -> 0.0067   acc: 95.50% -> 100.00%            
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3120 -> 0.0045   acc: 91.32% -> 99.87%             
client [84] (test)  loss: 0.0909 -> 0.0047   acc: 98.72% -> 100.00%            
client [10] (test)  loss: 0.9924 -> 0.0942   acc: 65.33% -> 96.00%             
client [36] (test)  loss: 0.0929 -> 0.0053   acc: 100.00% -> 100.00%           
client [65] (test)  loss: 0.7805 -> 0.0485   acc: 70.62% -> 98.31%             
client [81] (test)  loss: 1.9265 -> 0.0122   acc: 32.35% -> 100.00%            
client [79] (test)  loss: 0.9279 -> 0.0833   acc: 65.34% -> 97.26%             
client [42] (test)  loss: 0.4538 -> 0.0677   acc: 88.37% -> 98.84%             
client [11] (test)  loss: 0.8598 -> 0.0878   acc: 73.80% -> 98.40%             
client [96] (test)  loss: 0.7337 -> 0.0728   acc: 70.77% -> 98.28%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7281 -> 0.0958   acc: 77.53% -> 97.47%              
client [53] (test)  loss: 0.3823 -> 0.0835   acc: 82.30% -> 98.56%             
client [52] (test)  loss: 0.1405 -> 0.1125   acc: 97.40% -> 97.40%             
client [42] (test)  loss: 0.2589 -> 0.0576   acc: 88.37% -> 97.67%             
client [69] (test)  loss: 0.2090 -> 0.0348   acc: 93.61% -> 99.17%             
client [59] (test)  loss: 0.2652 -> 0.0073   acc: 91.46% -> 100.00%            
client [7] (test)  loss: 0.6520 -> 0.0084   acc: 79.58% -> 99.86%              
client [26] (test)  loss: 0.0804 -> 0.0265   acc: 98.81% -> 99.28%             
client [49] (test)  loss: 0.4609 -> 0.0626   acc: 84.64% -> 97.77%             
client [98] (test)  loss: 0.3670 -> 0.1261   acc: 85.29% -> 97.06%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2925 -> 0.0763   acc: 91.18% -> 100.00%            
client [47] (test)  loss: 0.1072 -> 0.0033   acc: 97.76% -> 100.00%            
client [21] (test)  loss: 0.3745 -> 0.0039   acc: 89.12% -> 99.87%             
client [77] (test)  loss: 0.1357 -> 0.0021   acc: 97.01% -> 100.00%            
client [95] (test)  loss: 0.2490 -> 0.0095   acc: 93.65% -> 99.83%             
client [91] (test)  loss: 0.2061 -> 0.0762   acc: 95.80% -> 97.48%             
client [14] (test)  loss: 0.2271 -> 0.0681   acc: 94.67% -> 97.54%             
client [99] (test)  loss: 0.2321 -> 0.0101   acc: 93.41% -> 99.47%             
client [20] (test)  loss: 0.7183 -> 0.0323   acc: 75.00% -> 98.61%             
client [39] (test)  loss: 0.7227 -> 0.0742   acc: 74.34% -> 97.79%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1911 -> 0.1257   acc: 94.81% -> 97.40%             
client [62] (test)  loss: 0.2594 -> 0.0952   acc: 92.16% -> 96.92%             
client [71] (test)  loss: 0.1621 -> 0.0437   acc: 95.72% -> 98.74%             
client [97] (test)  loss: 0.2440 -> 0.0104   acc: 94.64% -> 99.73%             
client [30] (test)  loss: 0.3098 -> 0.0668   acc: 89.06% -> 98.44%             
client [88] (test)  loss: 0.2028 -> 0.0285   acc: 94.79% -> 99.45%             
client [60] (test)  loss: 1.0392 -> 0.0016   acc: 68.91% -> 100.00%            
client [82] (test)  loss: 0.1821 -> 0.0325   acc: 97.06% -> 99.02%             
client [91] (test)  loss: 0.2620 -> 0.0787   acc: 93.28% -> 97.48%             
client [57] (test)  loss: 0.9899 -> 0.0101   acc: 63.73% -> 99.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1916 -> 0.0487   acc: 94.95% -> 99.08%             
client [15] (test)  loss: 0.1153 -> 0.0183   acc: 100.00% -> 100.00%           
client [71] (test)  loss: 0.2384 -> 0.0420   acc: 94.08% -> 98.87%             
client [97] (test)  loss: 0.1647 -> 0.0093   acc: 95.71% -> 99.73%             
client [53] (test)  loss: 0.1696 -> 0.0625   acc: 93.30% -> 99.04%             
client [77] (test)  loss: 0.0460 -> 0.0018   acc: 98.64% -> 100.00%            
client [76] (test)  loss: 0.1270 -> 0.0727   acc: 97.22% -> 97.22%             
client [79] (test)  loss: 0.3142 -> 0.0571   acc: 90.52% -> 97.76%             
client [28] (test)  loss: 0.2520 -> 0.1220   acc: 94.05% -> 96.43%             
client [99] (test)  loss: 0.1756 -> 0.0090   acc: 95.39% -> 99.47%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2295 -> 0.0081   acc: 93.83% -> 99.73%             
client [86] (test)  loss: 0.0976 -> 0.0054   acc: 100.00% -> 100.00%           
client [34] (test)  loss: 0.1959 -> 0.0115   acc: 95.10% -> 100.00%            
client [73] (test)  loss: 0.2243 -> 0.0340   acc: 96.06% -> 98.59%             
client [5] (test)  loss: 0.2273 -> 0.1091   acc: 93.95% -> 97.21%              
client [96] (test)  loss: 0.3724 -> 0.0460   acc: 85.96% -> 98.57%             
client [22] (test)  loss: 0.2675 -> 0.0094   acc: 92.35% -> 99.56%             
client [60] (test)  loss: 0.6004 -> 0.0023   acc: 89.11% -> 100.00%            
client [66] (test)  loss: 0.1822 -> 0.1143   acc: 93.75% -> 97.92%             
client [83] (test)  loss: 0.0881 -> 0.0570   acc: 97.97% -> 98.48%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1674 -> 0.0748   acc: 97.22% -> 97.22%             
client [65] (test)  loss: 0.2040 -> 0.0325   acc: 96.05% -> 98.87%             
client [95] (test)  loss: 0.1237 -> 0.0069   acc: 96.49% -> 99.83%             
client [17] (test)  loss: 0.0750 -> 0.0122   acc: 97.78% -> 100.00%            
client [8] (test)  loss: 0.5391 -> 0.0691   acc: 84.27% -> 97.47%              
client [35] (test)  loss: 0.1969 -> 0.0510   acc: 93.07% -> 98.27%             
client [98] (test)  loss: 0.2470 -> 0.1057   acc: 88.24% -> 97.06%             
client [53] (test)  loss: 0.2139 -> 0.0526   acc: 90.91% -> 98.56%             
client [43] (test)  loss: 1.0654 -> 0.0368   acc: 61.29% -> 98.62%             
client [64] (test)  loss: 0.1440 -> 0.0016   acc: 95.74% -> 100.00%            
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1775 -> 0.0029   acc: 95.34% -> 99.87%             
client [88] (test)  loss: 0.0714 -> 0.0255   acc: 98.90% -> 99.18%             
client [38] (test)  loss: 0.2544 -> 0.0098   acc: 92.79% -> 99.75%             
client [3] (test)  loss: 0.1524 -> 0.0008   acc: 95.84% -> 100.00%             
client [5] (test)  loss: 0.3531 -> 0.1063   acc: 87.91% -> 96.74%              
client [41] (test)  loss: 0.2549 -> 0.0164   acc: 91.76% -> 99.53%             
client [7] (test)  loss: 0.4859 -> 0.0062   acc: 83.89% -> 100.00%             
client [37] (test)  loss: 0.4550 -> 0.1464   acc: 88.16% -> 94.74%             
client [45] (test)  loss: 0.1842 -> 0.0054   acc: 94.23% -> 100.00%            
client [47] (test)  loss: 0.1239 -> 0.0021   acc: 96.92% -> 100.00%            
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3205 -> 0.0085   acc: 89.62% -> 100.00%            
client [11] (test)  loss: 0.3184 -> 0.0684   acc: 90.64% -> 98.40%             
client [37] (test)  loss: 0.3771 -> 0.1471   acc: 88.16% -> 94.74%             
client [41] (test)  loss: 0.1039 -> 0.0134   acc: 97.41% -> 99.53%             
client [95] (test)  loss: 0.0842 -> 0.0062   acc: 97.83% -> 100.00%            
client [53] (test)  loss: 0.0998 -> 0.0486   acc: 96.65% -> 99.04%             
client [22] (test)  loss: 0.2118 -> 0.0080   acc: 93.68% -> 99.71%             
client [25] (test)  loss: 0.1553 -> 0.0484   acc: 95.19% -> 98.52%             
client [69] (test)  loss: 0.1256 -> 0.0211   acc: 96.94% -> 99.17%             
client [46] (test)  loss: 0.1052 -> 0.0416   acc: 98.84% -> 99.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1275 -> 0.0014   acc: 96.08% -> 100.00%            
client [69] (test)  loss: 0.2102 -> 0.0205   acc: 92.78% -> 99.17%             
client [82] (test)  loss: 0.0850 -> 0.0288   acc: 96.08% -> 97.06%             
client [45] (test)  loss: 0.1472 -> 0.0051   acc: 95.33% -> 100.00%            
client [7] (test)  loss: 0.5023 -> 0.0058   acc: 81.67% -> 100.00%             
client [50] (test)  loss: 0.1921 -> 0.0271   acc: 93.98% -> 99.62%             
client [35] (test)  loss: 0.2062 -> 0.0458   acc: 92.64% -> 98.27%             
client [24] (test)  loss: 0.5022 -> 0.1229   acc: 86.00% -> 98.00%             
client [15] (test)  loss: 0.0529 -> 0.0079   acc: 100.00% -> 100.00%           
client [58] (test)  loss: 0.1442 -> 0.0449   acc: 95.80% -> 98.32%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1046 -> 0.0441   acc: 96.51% -> 98.84%             
client [76] (test)  loss: 0.0940 -> 0.0643   acc: 97.22% -> 97.22%             
client [67] (test)  loss: 0.3066 -> 0.0545   acc: 90.27% -> 99.12%             
client [37] (test)  loss: 0.2246 -> 0.1197   acc: 93.42% -> 96.05%             
client [58] (test)  loss: 0.0747 -> 0.0409   acc: 98.32% -> 99.16%             
client [64] (test)  loss: 0.0731 -> 0.0018   acc: 97.87% -> 100.00%            
client [77] (test)  loss: 0.1205 -> 0.0016   acc: 96.74% -> 100.00%            
client [55] (test)  loss: 0.5345 -> 0.0257   acc: 80.90% -> 99.50%             
client [12] (test)  loss: 0.0244 -> 0.0181   acc: 100.00% -> 100.00%           
client [89] (test)  loss: 0.2791 -> 0.0283   acc: 90.83% -> 99.39%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1165 -> 0.0035   acc: 97.22% -> 100.00%            
client [51] (test)  loss: 0.1936 -> 0.0382   acc: 93.45% -> 98.46%             
client [8] (test)  loss: 0.1665 -> 0.0552   acc: 94.94% -> 98.03%              
client [18] (test)  loss: 0.2455 -> 0.0415   acc: 93.18% -> 99.24%             
client [94] (test)  loss: 0.1963 -> 0.0812   acc: 94.69% -> 98.78%             
client [81] (test)  loss: 0.4381 -> 0.0110   acc: 82.35% -> 100.00%            
client [3] (test)  loss: 0.0181 -> 0.0008   acc: 99.72% -> 100.00%             
client [11] (test)  loss: 0.1888 -> 0.0648   acc: 96.26% -> 98.40%             
client [95] (test)  loss: 0.1284 -> 0.0056   acc: 96.82% -> 100.00%            
client [67] (test)  loss: 0.2997 -> 0.0522   acc: 91.15% -> 98.23%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1544 -> 0.0024   acc: 95.73% -> 99.87%             
client [79] (test)  loss: 0.4428 -> 0.0452   acc: 84.29% -> 98.00%             
client [58] (test)  loss: 0.0583 -> 0.0418   acc: 98.04% -> 98.88%             
client [88] (test)  loss: 0.0524 -> 0.0322   acc: 98.90% -> 98.90%             
client [46] (test)  loss: 0.1059 -> 0.0465   acc: 97.98% -> 98.84%             
client [11] (test)  loss: 0.3711 -> 0.0591   acc: 90.37% -> 98.93%             
client [55] (test)  loss: 0.9132 -> 0.0241   acc: 68.59% -> 99.50%             
client [13] (test)  loss: 0.9825 -> 0.0177   acc: 69.39% -> 99.80%             
client [31] (test)  loss: 0.1948 -> 0.0398   acc: 93.12% -> 99.08%             
client [75] (test)  loss: 0.0841 -> 0.0396   acc: 97.00% -> 99.25%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3110 -> 0.0234   acc: 89.76% -> 99.41%             
client [7] (test)  loss: 0.0492 -> 0.0060   acc: 98.75% -> 99.86%              
client [57] (test)  loss: 0.1024 -> 0.0060   acc: 97.22% -> 99.85%             
client [13] (test)  loss: 1.8802 -> 0.0158   acc: 44.90% -> 99.80%             
client [43] (test)  loss: 0.9784 -> 0.0317   acc: 66.82% -> 99.54%             
client [91] (test)  loss: 0.2006 -> 0.0775   acc: 94.12% -> 97.48%             
client [10] (test)  loss: 0.3089 -> 0.0487   acc: 94.67% -> 98.67%             
client [64] (test)  loss: 0.0224 -> 0.0019   acc: 99.36% -> 100.00%            
client [82] (test)  loss: 0.1062 -> 0.0094   acc: 98.04% -> 100.00%            
client [22] (test)  loss: 0.4192 -> 0.0064   acc: 88.09% -> 99.71%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1619 -> 0.0396   acc: 93.06% -> 98.61%             
client [23] (test)  loss: 0.1792 -> 0.0961   acc: 95.38% -> 95.38%             
client [88] (test)  loss: 0.1186 -> 0.0308   acc: 96.71% -> 98.90%             
client [98] (test)  loss: 0.1310 -> 0.0758   acc: 94.12% -> 97.06%             
client [79] (test)  loss: 0.1327 -> 0.0430   acc: 95.51% -> 98.50%             
client [21] (test)  loss: 0.2716 -> 0.0023   acc: 92.10% -> 99.87%             
client [92] (test)  loss: 0.1364 -> 0.0347   acc: 96.10% -> 98.67%             
client [56] (test)  loss: 0.2438 -> 0.0285   acc: 90.62% -> 100.00%            
client [5] (test)  loss: 0.1763 -> 0.0923   acc: 95.35% -> 97.67%              
client [52] (test)  loss: 0.0942 -> 0.0700   acc: 98.70% -> 98.70%             
==================== FedBabu TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.3021 -> 0.5597', 'accuracy': '91.12% -> 96.59%'},         
    200: {'loss': '0.1985 -> 0.9150', 'accuracy': '93.89% -> 96.17%'}          
}                                                                              
Convergence (test_before):                                                     
FedBabu achieved 10.0%(14.48%) at epoch: 1                                     
FedBabu achieved 20.0%(20.62%) at epoch: 2                                     
FedBabu achieved 50.0%(57.64%) at epoch: 7                                     
FedBabu achieved 60.0%(68.83%) at epoch: 9                                     
FedBabu achieved 70.0%(74.02%) at epoch: 16                                    
FedBabu achieved 80.0%(85.85%) at epoch: 18                                    
FedBabu achieved 90.0%(90.27%) at epoch: 37                                    
Convergence (test_after):                                                      
FedBabu achieved 70.0%(75.71%) at epoch: 0                                     
FedBabu achieved 80.0%(86.11%) at epoch: 1                                     
FedBabu achieved 90.0%(90.15%) at epoch: 4                                     
