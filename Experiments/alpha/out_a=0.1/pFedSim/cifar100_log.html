==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.7842 -> 2.3927   acc: 0.00% -> 31.97%              
client [81] (test)  loss: 4.5056 -> 2.7966   acc: 0.00% -> 27.22%              
client [21] (test)  loss: 48.3145 -> 2.5408   acc: 0.29% -> 27.95%             
client [68] (test)  loss: 4.5363 -> 2.2613   acc: 4.79% -> 34.82%              
client [93] (test)  loss: 4.8446 -> 3.1271   acc: 1.02% -> 16.67%              
client [31] (test)  loss: 4.6061 -> 2.5878   acc: 0.64% -> 23.47%              
client [20] (test)  loss: 4.2218 -> 1.6268   acc: 5.92% -> 49.67%              
client [59] (test)  loss: 43.3160 -> 2.2941   acc: 0.32% -> 40.97%             
client [48] (test)  loss: 4.4385 -> 3.0770   acc: 3.59% -> 19.28%              
client [34] (test)  loss: 4.3537 -> 2.9427   acc: 6.29% -> 11.92%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.4127 -> 1.7262   acc: 1.70% -> 55.24%              
client [99] (test)  loss: 4.9869 -> 3.1541   acc: 0.32% -> 19.75%              
client [67] (test)  loss: 4.4077 -> 2.1722   acc: 1.57% -> 37.30%              
client [0] (test)  loss: 4.3099 -> 2.8418   acc: 3.15% -> 22.97%               
client [76] (test)  loss: 5.0084 -> 2.4534   acc: 0.33% -> 39.53%              
client [41] (test)  loss: 4.8530 -> 2.8220   acc: 0.33% -> 19.00%              
client [62] (test)  loss: 132.3344 -> 2.5691   acc: 0.00% -> 29.18%            
client [2] (test)  loss: 114.2861 -> 2.9989   acc: 3.08% -> 26.15%             
client [14] (test)  loss: 4.9264 -> 3.0069   acc: 0.00% -> 26.47%              
client [46] (test)  loss: 5.0502 -> 2.4872   acc: 0.80% -> 37.60%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.0984 -> 2.7488   acc: 6.46% -> 29.66%              
client [68] (test)  loss: 4.8172 -> 2.0805   acc: 4.79% -> 38.66%              
client [57] (test)  loss: 5.0726 -> 2.7275   acc: 2.64% -> 28.38%              
client [17] (test)  loss: 7.2100 -> 2.4052   acc: 0.00% -> 29.21%              
client [54] (test)  loss: 4.4349 -> 2.7997   acc: 5.98% -> 22.83%              
client [23] (test)  loss: 188.8764 -> 2.5684   acc: 2.73% -> 26.56%            
client [35] (test)  loss: 5.2890 -> 1.9469   acc: 0.00% -> 44.33%              
client [59] (test)  loss: 4.6527 -> 1.9902   acc: 4.19% -> 45.48%              
client [31] (test)  loss: 3.6444 -> 2.4168   acc: 19.94% -> 33.12%             
client [9] (test)  loss: 4.6552 -> 2.5954   acc: 4.23% -> 22.36%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.4055 -> 2.3402   acc: 1.40% -> 37.82%              
client [33] (test)  loss: 4.6360 -> 2.7364   acc: 4.10% -> 41.04%              
client [16] (test)  loss: 4.7998 -> 3.4781   acc: 5.63% -> 13.52%              
client [44] (test)  loss: 5.3562 -> 2.9425   acc: 0.00% -> 14.38%              
client [8] (test)  loss: 4.6711 -> 2.2238   acc: 6.09% -> 38.46%               
client [31] (test)  loss: 4.1212 -> 2.2044   acc: 8.36% -> 36.66%              
client [47] (test)  loss: 4.2546 -> 2.4800   acc: 6.02% -> 31.20%              
client [36] (test)  loss: 4.6676 -> 2.8792   acc: 2.08% -> 20.83%              
client [20] (test)  loss: 4.5923 -> 1.7243   acc: 10.20% -> 45.72%             
client [56] (test)  loss: 4.5390 -> 3.3271   acc: 2.97% -> 18.32%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.8886 -> 1.8714   acc: 5.41% -> 45.86%               
client [60] (test)  loss: 4.8669 -> 2.7216   acc: 3.21% -> 27.56%              
client [28] (test)  loss: 5.7411 -> 2.3802   acc: 3.14% -> 36.59%              
client [25] (test)  loss: 5.5877 -> 2.1975   acc: 0.84% -> 42.62%              
client [58] (test)  loss: 4.9379 -> 2.5937   acc: 2.22% -> 25.32%              
client [44] (test)  loss: 5.6161 -> 2.6408   acc: 0.98% -> 21.24%              
client [39] (test)  loss: 4.3719 -> 2.6272   acc: 6.47% -> 25.89%              
client [29] (test)  loss: 5.2070 -> 2.3566   acc: 4.00% -> 35.43%              
client [3] (test)  loss: 4.0706 -> 2.2886   acc: 8.56% -> 32.42%               
client [84] (test)  loss: 4.2293 -> 2.3219   acc: 6.52% -> 40.37%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 6.3987 -> 2.1640   acc: 3.75% -> 37.18%              
client [84] (test)  loss: 4.1373 -> 2.3443   acc: 13.04% -> 38.51%             
client [10] (test)  loss: 3.9765 -> 2.4623   acc: 4.76% -> 36.51%              
client [36] (test)  loss: 4.6809 -> 2.6504   acc: 3.12% -> 27.78%              
client [65] (test)  loss: 4.0074 -> 3.0694   acc: 5.67% -> 22.67%              
client [81] (test)  loss: 4.0901 -> 2.2986   acc: 12.03% -> 39.24%             
client [79] (test)  loss: 3.9345 -> 1.8008   acc: 22.03% -> 51.13%             
client [42] (test)  loss: 4.8612 -> 2.3993   acc: 2.61% -> 38.11%              
client [11] (test)  loss: 4.3366 -> 2.4760   acc: 3.99% -> 35.58%              
client [96] (test)  loss: 6.1767 -> 1.9727   acc: 0.62% -> 47.37%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0358 -> 2.0577   acc: 8.33% -> 45.51%               
client [53] (test)  loss: 5.1136 -> 2.2088   acc: 3.89% -> 41.92%              
client [52] (test)  loss: 4.3714 -> 2.7173   acc: 4.32% -> 39.53%              
client [42] (test)  loss: 4.7951 -> 2.2686   acc: 4.56% -> 41.04%              
client [69] (test)  loss: 3.9614 -> 1.6938   acc: 15.01% -> 58.36%             
client [59] (test)  loss: 4.4448 -> 1.7803   acc: 6.77% -> 50.00%              
client [7] (test)  loss: 4.3920 -> 2.0378   acc: 3.88% -> 41.10%               
client [26] (test)  loss: 3.9453 -> 2.5958   acc: 5.38% -> 29.23%              
client [49] (test)  loss: 3.8709 -> 2.1846   acc: 8.33% -> 43.10%              
client [98] (test)  loss: 3.8349 -> 3.1411   acc: 10.31% -> 25.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.7457 -> 2.9338   acc: 9.06% -> 27.19%              
client [47] (test)  loss: 4.3704 -> 2.3939   acc: 7.52% -> 32.71%              
client [21] (test)  loss: 4.2971 -> 2.0503   acc: 8.93% -> 40.63%              
client [77] (test)  loss: 3.9056 -> 2.1546   acc: 10.34% -> 46.08%             
client [95] (test)  loss: 4.3542 -> 2.0684   acc: 9.57% -> 46.53%              
client [91] (test)  loss: 3.7110 -> 2.4208   acc: 7.72% -> 36.98%              
client [14] (test)  loss: 3.6180 -> 2.3080   acc: 12.94% -> 41.18%             
client [99] (test)  loss: 4.4991 -> 3.3797   acc: 6.37% -> 27.71%              
client [20] (test)  loss: 4.6131 -> 1.7449   acc: 5.59% -> 43.09%              
client [39] (test)  loss: 5.1227 -> 2.9946   acc: 3.56% -> 16.18%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.7698 -> 2.5757   acc: 11.63% -> 41.20%             
client [62] (test)  loss: 3.8176 -> 2.2714   acc: 13.11% -> 38.03%             
client [71] (test)  loss: 3.7644 -> 2.6931   acc: 15.91% -> 29.22%             
client [97] (test)  loss: 3.8665 -> 2.5059   acc: 11.21% -> 29.74%             
client [30] (test)  loss: 3.6210 -> 2.3960   acc: 15.19% -> 30.06%             
client [88] (test)  loss: 4.3043 -> 2.0620   acc: 6.62% -> 45.03%              
client [60] (test)  loss: 4.2969 -> 2.3418   acc: 2.56% -> 39.74%              
client [82] (test)  loss: 4.6531 -> 2.1621   acc: 7.96% -> 40.48%              
client [91] (test)  loss: 3.6274 -> 2.2022   acc: 12.86% -> 42.77%             
client [57] (test)  loss: 3.9556 -> 2.1625   acc: 9.57% -> 44.55%              
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.6820 -> 1.9123   acc: 15.43% -> 45.02%             
client [15] (test)  loss: 4.5952 -> 2.2898   acc: 4.11% -> 39.24%              
client [71] (test)  loss: 4.3148 -> 2.6648   acc: 6.82% -> 30.19%              
client [97] (test)  loss: 3.7767 -> 2.4685   acc: 15.95% -> 31.90%             
client [53] (test)  loss: 4.5081 -> 2.0774   acc: 8.98% -> 46.11%              
client [77] (test)  loss: 3.5952 -> 2.3571   acc: 15.05% -> 43.89%             
client [76] (test)  loss: 4.2007 -> 2.3615   acc: 5.98% -> 35.22%              
client [79] (test)  loss: 4.0497 -> 1.5954   acc: 5.37% -> 55.08%              
client [28] (test)  loss: 4.6447 -> 2.3517   acc: 5.57% -> 40.42%              
client [99] (test)  loss: 4.2900 -> 3.4213   acc: 11.46% -> 27.07%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 2.5711 -> 2.4817   acc: 29.74% -> 29.74%             
client [86] (test)  loss: 3.5557 -> 2.4443   acc: 22.69% -> 36.72%             
client [34] (test)  loss: 2.5478 -> 2.3085   acc: 32.45% -> 35.10%             
client [73] (test)  loss: 2.7218 -> 2.6205   acc: 30.67% -> 31.33%             
client [5] (test)  loss: 1.9887 -> 2.0153   acc: 39.30% -> 45.05%              
client [96] (test)  loss: 4.2636 -> 1.8604   acc: 6.50% -> 48.30%              
client [22] (test)  loss: 2.3580 -> 2.4424   acc: 39.56% -> 35.20%             
client [60] (test)  loss: 2.6172 -> 2.3513   acc: 27.56% -> 44.23%             
client [66] (test)  loss: 2.0211 -> 2.1639   acc: 48.87% -> 44.66%             
client [83] (test)  loss: 5.5578 -> 1.7238   acc: 5.30% -> 51.32%              
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 2.1270 -> 2.5980   acc: 47.18% -> 33.22%             
client [65] (test)  loss: 2.4747 -> 2.5730   acc: 34.01% -> 34.82%             
client [95] (test)  loss: 2.0262 -> 1.9945   acc: 47.52% -> 50.17%             
client [17] (test)  loss: 4.6655 -> 2.4782   acc: 7.94% -> 27.62%              
client [8] (test)  loss: 3.7667 -> 1.9949   acc: 17.31% -> 48.40%              
client [35] (test)  loss: 2.4984 -> 1.8311   acc: 36.33% -> 47.33%             
client [98] (test)  loss: 2.6748 -> 2.5836   acc: 30.31% -> 33.75%             
client [53] (test)  loss: 2.3564 -> 2.0635   acc: 35.33% -> 46.11%             
client [43] (test)  loss: 4.4891 -> 2.2244   acc: 6.67% -> 40.00%              
client [64] (test)  loss: 2.1831 -> 2.0655   acc: 43.98% -> 49.58%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 2.3532 -> 2.0418   acc: 35.45% -> 41.50%             
client [88] (test)  loss: 2.2888 -> 2.1547   acc: 37.75% -> 45.03%             
client [38] (test)  loss: 2.0739 -> 2.1725   acc: 41.36% -> 41.93%             
client [3] (test)  loss: 2.6642 -> 2.5181   acc: 31.19% -> 37.31%              
client [5] (test)  loss: 1.9075 -> 2.0605   acc: 42.17% -> 45.05%              
client [41] (test)  loss: 2.4947 -> 2.3101   acc: 36.00% -> 36.33%             
client [7] (test)  loss: 2.4216 -> 1.8534   acc: 35.28% -> 48.22%              
client [37] (test)  loss: 2.3340 -> 2.3598   acc: 39.23% -> 39.87%             
client [45] (test)  loss: 4.8197 -> 2.2485   acc: 5.33% -> 38.00%              
client [47] (test)  loss: 4.2063 -> 2.3196   acc: 11.28% -> 38.35%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 2.6094 -> 2.2551   acc: 30.70% -> 36.90%             
client [11] (test)  loss: 2.0781 -> 2.4355   acc: 42.64% -> 40.80%             
client [37] (test)  loss: 2.5733 -> 3.0919   acc: 32.80% -> 27.01%             
client [41] (test)  loss: 2.5240 -> 2.3750   acc: 34.00% -> 36.67%             
client [95] (test)  loss: 2.2313 -> 2.0694   acc: 46.20% -> 50.83%             
client [53] (test)  loss: 2.3966 -> 2.0708   acc: 33.53% -> 46.11%             
client [22] (test)  loss: 2.4067 -> 2.5649   acc: 37.38% -> 32.71%             
client [25] (test)  loss: 1.9785 -> 2.1046   acc: 40.93% -> 43.04%             
client [69] (test)  loss: 2.4414 -> 1.9737   acc: 49.29% -> 64.31%             
client [46] (test)  loss: 2.0514 -> 1.9454   acc: 49.20% -> 51.20%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 2.5917 -> 2.4185   acc: 33.08% -> 39.10%             
client [69] (test)  loss: 2.5534 -> 2.1017   acc: 49.01% -> 64.02%             
client [82] (test)  loss: 2.2814 -> 2.4484   acc: 40.14% -> 32.18%             
client [45] (test)  loss: 2.7346 -> 1.9724   acc: 26.33% -> 44.67%             
client [7] (test)  loss: 2.4100 -> 1.8409   acc: 36.89% -> 47.57%              
client [50] (test)  loss: 2.1778 -> 2.0090   acc: 40.86% -> 51.61%             
client [35] (test)  loss: 2.9458 -> 1.9068   acc: 36.00% -> 47.67%             
client [24] (test)  loss: 2.2797 -> 2.2900   acc: 39.92% -> 43.73%             
client [15] (test)  loss: 2.8743 -> 2.4171   acc: 25.00% -> 36.71%             
client [58] (test)  loss: 2.9988 -> 2.4133   acc: 32.91% -> 36.71%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 2.8338 -> 2.5619   acc: 32.03% -> 34.97%             
client [76] (test)  loss: 2.2877 -> 2.5288   acc: 42.52% -> 35.55%             
client [67] (test)  loss: 2.4630 -> 1.7307   acc: 31.35% -> 52.66%             
client [37] (test)  loss: 2.8011 -> 2.9057   acc: 31.51% -> 31.19%             
client [58] (test)  loss: 3.1090 -> 2.3083   acc: 31.01% -> 39.56%             
client [64] (test)  loss: 2.7269 -> 2.1022   acc: 39.22% -> 51.54%             
client [77] (test)  loss: 1.8156 -> 2.3771   acc: 47.65% -> 42.01%             
client [55] (test)  loss: 2.3865 -> 1.8446   acc: 42.86% -> 53.42%             
client [12] (test)  loss: 2.0911 -> 2.8708   acc: 43.75% -> 34.21%             
client [89] (test)  loss: 2.6291 -> 2.6382   acc: 35.78% -> 36.70%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 3.9752 -> 2.5242   acc: 31.06% -> 39.44%             
client [51] (test)  loss: 2.7100 -> 2.3116   acc: 32.35% -> 39.54%             
client [8] (test)  loss: 2.4898 -> 2.1493   acc: 44.87% -> 48.08%              
client [18] (test)  loss: 5.5076 -> 2.0857   acc: 16.67% -> 51.82%             
client [94] (test)  loss: 2.0981 -> 2.2267   acc: 43.27% -> 40.06%             
client [81] (test)  loss: 2.4195 -> 2.2535   acc: 43.35% -> 46.84%             
client [3] (test)  loss: 2.6897 -> 3.4312   acc: 36.39% -> 32.11%              
client [11] (test)  loss: 2.3682 -> 2.4746   acc: 40.49% -> 42.64%             
client [95] (test)  loss: 2.3835 -> 2.2494   acc: 44.22% -> 48.51%             
client [67] (test)  loss: 2.4419 -> 1.7462   acc: 34.17% -> 51.72%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 2.1984 -> 2.1220   acc: 43.23% -> 40.92%             
client [79] (test)  loss: 1.7886 -> 1.8628   acc: 57.06% -> 54.52%             
client [58] (test)  loss: 3.2933 -> 2.3646   acc: 29.43% -> 37.34%             
client [88] (test)  loss: 2.4835 -> 2.2029   acc: 37.09% -> 46.69%             
client [46] (test)  loss: 2.1080 -> 1.9498   acc: 50.40% -> 51.60%             
client [11] (test)  loss: 2.4167 -> 2.5379   acc: 39.88% -> 41.72%             
client [55] (test)  loss: 2.5229 -> 2.0292   acc: 45.96% -> 51.24%             
client [13] (test)  loss: 2.4414 -> 2.1206   acc: 37.69% -> 44.98%             
client [31] (test)  loss: 2.2164 -> 2.0127   acc: 41.16% -> 45.34%             
client [75] (test)  loss: 2.1302 -> 1.7013   acc: 47.84% -> 60.80%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 2.4035 -> 2.5253   acc: 41.69% -> 40.39%             
client [7] (test)  loss: 2.6138 -> 1.9840   acc: 37.54% -> 46.28%              
client [57] (test)  loss: 2.5615 -> 2.3365   acc: 40.59% -> 47.85%             
client [13] (test)  loss: 2.4355 -> 2.1869   acc: 39.51% -> 44.07%             
client [43] (test)  loss: 2.6590 -> 2.4834   acc: 32.42% -> 41.52%             
client [91] (test)  loss: 1.9523 -> 1.8837   acc: 45.34% -> 47.59%             
client [10] (test)  loss: 2.2411 -> 2.3016   acc: 44.44% -> 46.03%             
client [64] (test)  loss: 2.8818 -> 2.1731   acc: 36.69% -> 51.54%             
client [82] (test)  loss: 2.4483 -> 2.3804   acc: 40.14% -> 38.75%             
client [22] (test)  loss: 2.2817 -> 2.4389   acc: 40.81% -> 35.20%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 2.2507 -> 1.3227   acc: 46.38% -> 60.20%             
client [23] (test)  loss: 2.5227 -> 2.5606   acc: 38.67% -> 38.28%             
client [88] (test)  loss: 2.4952 -> 2.2230   acc: 38.74% -> 46.69%             
client [98] (test)  loss: 2.3998 -> 2.9799   acc: 37.19% -> 33.75%             
client [79] (test)  loss: 1.7721 -> 1.9176   acc: 56.50% -> 55.37%             
client [21] (test)  loss: 2.3617 -> 2.1662   acc: 42.07% -> 40.63%             
client [92] (test)  loss: 2.7162 -> 2.9252   acc: 33.05% -> 38.49%             
client [56] (test)  loss: 3.1566 -> 2.3526   acc: 35.15% -> 46.04%             
client [5] (test)  loss: 2.0806 -> 2.2946   acc: 43.45% -> 43.45%              
client [52] (test)  loss: 2.2970 -> 2.4284   acc: 48.17% -> 47.84%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '4.3172 -> 0.0000', 'accuracy': '8.23% -> 0.00%'},           
    200: {'loss': '2.3408 -> 0.0000', 'accuracy': '42.56% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(10.67%) at epoch: 85                                    
pFedSim achieved 30.0%(31.56%) at epoch: 104                                   
pFedSim achieved 40.0%(41.33%) at epoch: 114                                   
Convergence (test_after):                                                      
pFedSim achieved 10.0%(18.39%) at epoch: 0                                     
pFedSim achieved 20.0%(26.76%) at epoch: 1                                     
pFedSim achieved 30.0%(34.81%) at epoch: 14                                    
pFedSim achieved 40.0%(42.08%) at epoch: 40                                    
pFedSim achieved 50.0%(51.68%) at epoch: 104                                   
