==================== ALGORITHM: FedBN ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.3004 -> 3.4956   acc: 0.69% -> 8.42%               
client [81] (test)  loss: 5.1978 -> 3.3317   acc: 2.67% -> 14.23%              
client [21] (test)  loss: 5.3345 -> 3.3094   acc: 1.80% -> 26.00%              
client [68] (test)  loss: 5.6288 -> 3.5418   acc: 0.33% -> 15.61%              
client [93] (test)  loss: 5.3418 -> 3.3187   acc: 0.74% -> 20.96%              
client [31] (test)  loss: 6.0022 -> 2.8374   acc: 0.87% -> 33.45%              
client [20] (test)  loss: 4.8689 -> 3.6951   acc: 6.92% -> 9.86%               
client [59] (test)  loss: 5.2569 -> 3.3824   acc: 0.70% -> 13.56%              
client [48] (test)  loss: 5.2232 -> 3.2085   acc: 2.19% -> 30.85%              
client [34] (test)  loss: 5.0428 -> 3.4513   acc: 2.32% -> 17.63%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.7208 -> 3.6095   acc: 0.27% -> 13.56%              
client [99] (test)  loss: 5.2752 -> 3.9940   acc: 1.64% -> 13.70%              
client [67] (test)  loss: 5.1504 -> 3.0537   acc: 1.23% -> 21.69%              
client [0] (test)  loss: 4.9718 -> 3.3447   acc: 5.20% -> 17.56%               
client [76] (test)  loss: 5.0559 -> 3.3431   acc: 1.45% -> 15.09%              
client [41] (test)  loss: 5.0027 -> 2.9425   acc: 1.96% -> 28.29%              
client [62] (test)  loss: 5.2784 -> 3.7994   acc: 1.20% -> 9.06%               
client [2] (test)  loss: 5.2220 -> 3.0142   acc: 0.43% -> 22.61%               
client [14] (test)  loss: 5.0007 -> 2.7721   acc: 1.42% -> 29.36%              
client [46] (test)  loss: 4.8468 -> 3.7448   acc: 3.60% -> 13.33%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.5863 -> 3.0661   acc: 3.56% -> 21.92%              
client [68] (test)  loss: 5.3752 -> 3.2606   acc: 2.44% -> 24.23%              
client [57] (test)  loss: 4.9440 -> 3.3722   acc: 5.09% -> 19.64%              
client [17] (test)  loss: 6.4369 -> 2.7526   acc: 0.95% -> 27.96%              
client [54] (test)  loss: 5.1663 -> 3.2072   acc: 2.62% -> 20.52%              
client [23] (test)  loss: 5.2099 -> 2.5844   acc: 1.95% -> 31.86%              
client [35] (test)  loss: 5.3593 -> 3.0613   acc: 2.61% -> 17.27%              
client [59] (test)  loss: 4.9948 -> 3.1237   acc: 1.41% -> 23.06%              
client [31] (test)  loss: 4.4552 -> 2.5116   acc: 5.40% -> 40.59%              
client [9] (test)  loss: 4.6179 -> 4.1196   acc: 6.00% -> 14.36%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.0402 -> 2.7760   acc: 3.47% -> 32.34%              
client [33] (test)  loss: 4.6925 -> 3.0390   acc: 6.36% -> 27.50%              
client [16] (test)  loss: 4.7158 -> 3.0421   acc: 5.28% -> 25.68%              
client [44] (test)  loss: 9.0931 -> 2.8392   acc: 1.77% -> 28.82%              
client [8] (test)  loss: 4.8460 -> 2.7510   acc: 3.82% -> 31.64%               
client [31] (test)  loss: 4.8546 -> 2.4607   acc: 3.83% -> 41.46%              
client [47] (test)  loss: 5.2982 -> 2.1714   acc: 2.71% -> 46.84%              
client [36] (test)  loss: 4.4273 -> 2.3027   acc: 10.33% -> 40.58%             
client [20] (test)  loss: 4.9146 -> 2.9463   acc: 7.27% -> 25.61%              
client [56] (test)  loss: 5.0307 -> 3.1607   acc: 3.56% -> 19.22%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.2801 -> 3.4143   acc: 1.99% -> 22.97%               
client [60] (test)  loss: 5.3506 -> 2.8239   acc: 3.09% -> 31.64%              
client [28] (test)  loss: 4.7803 -> 2.7700   acc: 7.59% -> 31.65%              
client [25] (test)  loss: 5.9413 -> 3.0150   acc: 5.57% -> 27.65%              
client [58] (test)  loss: 4.8572 -> 2.8918   acc: 4.24% -> 28.09%              
client [44] (test)  loss: 4.6783 -> 2.7977   acc: 7.57% -> 30.60%              
client [39] (test)  loss: 5.1132 -> 3.1474   acc: 4.29% -> 25.41%              
client [29] (test)  loss: 5.3343 -> 2.7763   acc: 12.93% -> 27.21%             
client [3] (test)  loss: 4.7293 -> 2.7842   acc: 8.17% -> 27.29%               
client [84] (test)  loss: 4.9336 -> 2.8264   acc: 5.50% -> 31.21%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.7829 -> 2.9982   acc: 1.80% -> 28.60%              
client [84] (test)  loss: 4.4417 -> 2.7776   acc: 8.16% -> 32.27%              
client [10] (test)  loss: 5.0490 -> 2.7181   acc: 5.41% -> 30.60%              
client [36] (test)  loss: 4.3826 -> 2.2172   acc: 7.25% -> 41.30%              
client [65] (test)  loss: 4.3622 -> 3.3585   acc: 8.60% -> 20.79%              
client [81] (test)  loss: 5.3149 -> 2.7661   acc: 6.76% -> 28.29%              
client [79] (test)  loss: 4.8570 -> 3.1763   acc: 3.21% -> 21.37%              
client [42] (test)  loss: 4.6917 -> 2.8406   acc: 5.55% -> 27.91%              
client [11] (test)  loss: 4.6979 -> 3.1614   acc: 6.75% -> 22.66%              
client [96] (test)  loss: 4.9227 -> 2.3418   acc: 4.14% -> 34.35%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.1983 -> 2.6394   acc: 4.93% -> 36.41%               
client [53] (test)  loss: 4.9033 -> 2.7005   acc: 6.98% -> 35.85%              
client [52] (test)  loss: 4.4603 -> 3.0352   acc: 12.06% -> 28.55%             
client [42] (test)  loss: 4.1564 -> 2.8470   acc: 11.99% -> 28.09%             
client [69] (test)  loss: 4.7507 -> 3.4870   acc: 7.45% -> 21.28%              
client [59] (test)  loss: 4.3169 -> 2.9479   acc: 7.75% -> 26.76%              
client [7] (test)  loss: 6.0438 -> 3.2677   acc: 5.75% -> 21.01%               
client [26] (test)  loss: 4.5538 -> 2.7562   acc: 10.96% -> 33.90%             
client [49] (test)  loss: 4.1330 -> 2.9906   acc: 10.84% -> 28.67%             
client [98] (test)  loss: 4.7485 -> 2.6354   acc: 7.18% -> 36.86%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.5996 -> 2.6331   acc: 8.51% -> 37.43%              
client [47] (test)  loss: 5.1604 -> 2.1085   acc: 4.34% -> 47.20%              
client [21] (test)  loss: 4.9928 -> 2.9308   acc: 5.20% -> 31.00%              
client [77] (test)  loss: 4.5061 -> 2.5267   acc: 5.33% -> 33.51%              
client [95] (test)  loss: 4.4316 -> 2.5190   acc: 13.89% -> 45.26%             
client [91] (test)  loss: 4.5121 -> 2.5344   acc: 11.17% -> 37.06%             
client [14] (test)  loss: 3.9537 -> 2.5406   acc: 14.77% -> 37.01%             
client [99] (test)  loss: 4.6137 -> 3.4453   acc: 7.16% -> 26.18%              
client [20] (test)  loss: 4.5188 -> 3.0526   acc: 8.48% -> 29.07%              
client [39] (test)  loss: 5.2698 -> 3.0522   acc: 3.63% -> 25.74%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.8599 -> 2.9693   acc: 10.64% -> 30.85%             
client [62] (test)  loss: 4.4579 -> 3.2101   acc: 8.21% -> 26.32%              
client [71] (test)  loss: 4.0619 -> 3.1082   acc: 16.91% -> 25.12%             
client [97] (test)  loss: 4.6429 -> 2.7812   acc: 8.78% -> 30.34%              
client [30] (test)  loss: 4.0059 -> 2.9924   acc: 16.94% -> 31.09%             
client [88] (test)  loss: 4.8055 -> 3.0649   acc: 11.60% -> 28.67%             
client [60] (test)  loss: 4.6853 -> 2.5263   acc: 4.55% -> 39.45%              
client [82] (test)  loss: 4.5254 -> 2.7496   acc: 9.74% -> 34.90%              
client [91] (test)  loss: 4.3333 -> 2.5560   acc: 13.87% -> 38.41%             
client [57] (test)  loss: 4.1690 -> 2.8930   acc: 15.09% -> 29.82%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.4184 -> 2.2727   acc: 10.45% -> 49.65%             
client [15] (test)  loss: 4.1495 -> 2.8969   acc: 13.11% -> 31.47%             
client [71] (test)  loss: 4.4458 -> 3.1447   acc: 10.14% -> 25.12%             
client [97] (test)  loss: 4.5489 -> 2.8303   acc: 7.06% -> 30.73%              
client [53] (test)  loss: 4.9136 -> 2.7587   acc: 5.81% -> 37.40%              
client [77] (test)  loss: 4.4740 -> 2.5500   acc: 10.82% -> 33.33%             
client [76] (test)  loss: 4.5083 -> 2.7025   acc: 9.09% -> 38.36%              
client [79] (test)  loss: 5.1807 -> 3.3902   acc: 4.06% -> 19.44%              
client [28] (test)  loss: 4.9301 -> 2.7434   acc: 4.52% -> 31.83%              
client [99] (test)  loss: 4.8540 -> 3.4726   acc: 7.16% -> 25.97%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.4616 -> 2.9006   acc: 9.35% -> 31.30%              
client [86] (test)  loss: 4.4138 -> 2.6895   acc: 13.09% -> 38.45%             
client [34] (test)  loss: 4.7287 -> 3.2995   acc: 8.35% -> 29.00%              
client [73] (test)  loss: 4.3550 -> 2.7081   acc: 12.72% -> 35.45%             
client [5] (test)  loss: 4.6582 -> 2.7804   acc: 8.29% -> 32.43%               
client [96] (test)  loss: 4.2761 -> 2.3186   acc: 13.49% -> 39.21%             
client [22] (test)  loss: 4.6954 -> 2.8726   acc: 9.07% -> 35.70%              
client [60] (test)  loss: 4.4425 -> 2.4943   acc: 7.09% -> 41.64%              
client [66] (test)  loss: 4.6017 -> 3.1645   acc: 6.42% -> 25.49%              
client [83] (test)  loss: 4.6948 -> 3.2308   acc: 11.57% -> 27.13%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.4921 -> 2.8167   acc: 10.91% -> 36.00%             
client [65] (test)  loss: 4.2886 -> 3.3307   acc: 13.62% -> 23.66%             
client [95] (test)  loss: 4.9379 -> 2.5428   acc: 7.16% -> 43.58%              
client [17] (test)  loss: 4.5947 -> 2.6368   acc: 15.48% -> 35.70%             
client [8] (test)  loss: 4.9996 -> 2.7947   acc: 7.00% -> 35.29%               
client [35] (test)  loss: 5.2834 -> 2.7944   acc: 5.82% -> 33.94%              
client [98] (test)  loss: 4.9867 -> 2.7155   acc: 7.56% -> 36.67%              
client [53] (test)  loss: 4.3359 -> 2.8525   acc: 13.37% -> 36.82%             
client [43] (test)  loss: 4.3782 -> 2.8644   acc: 11.82% -> 33.39%             
client [64] (test)  loss: 4.6056 -> 2.7485   acc: 8.25% -> 39.77%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.0196 -> 3.0224   acc: 6.20% -> 32.00%              
client [88] (test)  loss: 4.9055 -> 3.2664   acc: 11.43% -> 30.89%             
client [38] (test)  loss: 4.6994 -> 3.2369   acc: 9.23% -> 27.53%              
client [3] (test)  loss: 4.5189 -> 2.8401   acc: 9.97% -> 32.35%               
client [5] (test)  loss: 5.2823 -> 2.8552   acc: 5.95% -> 31.53%               
client [41] (test)  loss: 4.6369 -> 3.0232   acc: 8.72% -> 30.43%              
client [7] (test)  loss: 5.4100 -> 3.0747   acc: 8.80% -> 32.14%               
client [37] (test)  loss: 4.8104 -> 2.8212   acc: 6.66% -> 31.82%              
client [45] (test)  loss: 5.2813 -> 2.9384   acc: 7.71% -> 29.41%              
client [47] (test)  loss: 5.4606 -> 2.1055   acc: 3.62% -> 47.56%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.9146 -> 3.0564   acc: 10.75% -> 30.97%             
client [11] (test)  loss: 4.8846 -> 3.3141   acc: 8.82% -> 26.82%              
client [37] (test)  loss: 4.7835 -> 2.9414   acc: 7.63% -> 30.36%              
client [41] (test)  loss: 5.1448 -> 3.0682   acc: 4.63% -> 30.78%              
client [95] (test)  loss: 5.1459 -> 2.6390   acc: 7.37% -> 43.58%              
client [53] (test)  loss: 5.3431 -> 2.9507   acc: 8.53% -> 36.24%              
client [22] (test)  loss: 4.4831 -> 3.0063   acc: 12.62% -> 35.31%             
client [25] (test)  loss: 5.0083 -> 3.2436   acc: 8.52% -> 28.00%              
client [69] (test)  loss: 5.0006 -> 3.6717   acc: 8.51% -> 23.94%              
client [46] (test)  loss: 4.0938 -> 3.0757   acc: 17.30% -> 31.71%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.3643 -> 2.2593   acc: 9.76% -> 46.47%              
client [69] (test)  loss: 5.0436 -> 3.7682   acc: 7.45% -> 23.94%              
client [82] (test)  loss: 4.5717 -> 2.9750   acc: 8.28% -> 37.18%              
client [45] (test)  loss: 4.8646 -> 3.0705   acc: 10.55% -> 27.59%             
client [7] (test)  loss: 5.5100 -> 3.1441   acc: 6.28% -> 30.88%               
client [50] (test)  loss: 4.7065 -> 2.8621   acc: 10.71% -> 32.64%             
client [35] (test)  loss: 4.8372 -> 2.9638   acc: 10.64% -> 32.13%             
client [24] (test)  loss: 5.2816 -> 2.7344   acc: 7.95% -> 39.73%              
client [15] (test)  loss: 4.3534 -> 2.8479   acc: 13.11% -> 34.27%             
client [58] (test)  loss: 5.8204 -> 3.3399   acc: 7.24% -> 30.39%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.7475 -> 2.4582   acc: 12.04% -> 42.45%             
client [76] (test)  loss: 4.8504 -> 2.9482   acc: 13.45% -> 38.00%             
client [67] (test)  loss: 4.9474 -> 3.0948   acc: 10.58% -> 31.39%             
client [37] (test)  loss: 5.1746 -> 3.1035   acc: 6.66% -> 29.87%              
client [58] (test)  loss: 5.3766 -> 3.4446   acc: 6.89% -> 28.98%              
client [64] (test)  loss: 4.6235 -> 2.8383   acc: 7.10% -> 39.93%              
client [77] (test)  loss: 4.5342 -> 2.8183   acc: 11.17% -> 31.96%             
client [55] (test)  loss: 5.6108 -> 3.2468   acc: 9.31% -> 29.74%              
client [12] (test)  loss: 5.2276 -> 2.7062   acc: 5.96% -> 39.45%              
client [89] (test)  loss: 4.5094 -> 2.8351   acc: 11.21% -> 36.17%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.4755 -> 3.4084   acc: 10.11% -> 32.98%             
client [51] (test)  loss: 5.4881 -> 2.5968   acc: 11.82% -> 40.36%             
client [8] (test)  loss: 5.4235 -> 2.9644   acc: 6.68% -> 40.06%               
client [18] (test)  loss: 4.5637 -> 3.4193   acc: 8.94% -> 30.95%              
client [94] (test)  loss: 4.4712 -> 3.0793   acc: 14.94% -> 37.16%             
client [81] (test)  loss: 5.5406 -> 3.0437   acc: 9.61% -> 31.67%              
client [3] (test)  loss: 4.6155 -> 3.1191   acc: 10.46% -> 32.03%              
client [11] (test)  loss: 4.8488 -> 3.6180   acc: 9.69% -> 26.82%              
client [95] (test)  loss: 4.7524 -> 2.8126   acc: 13.26% -> 44.00%             
client [67] (test)  loss: 5.3085 -> 3.1140   acc: 5.11% -> 31.75%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.2173 -> 3.1411   acc: 7.80% -> 31.00%              
client [79] (test)  loss: 5.3794 -> 3.7077   acc: 8.33% -> 24.79%              
client [58] (test)  loss: 5.8560 -> 3.6053   acc: 5.30% -> 29.68%              
client [88] (test)  loss: 5.0972 -> 3.6515   acc: 12.80% -> 29.69%             
client [46] (test)  loss: 4.4714 -> 3.1937   acc: 14.59% -> 34.59%             
client [11] (test)  loss: 4.8256 -> 3.6977   acc: 10.38% -> 26.30%             
client [55] (test)  loss: 4.9288 -> 3.4739   acc: 12.04% -> 29.74%             
client [13] (test)  loss: 5.2376 -> 3.5438   acc: 12.97% -> 35.49%             
client [31] (test)  loss: 5.0888 -> 2.5522   acc: 7.84% -> 46.86%              
client [75] (test)  loss: 5.3183 -> 3.1937   acc: 9.04% -> 35.13%              
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.7548 -> 3.3701   acc: 14.57% -> 34.53%             
client [7] (test)  loss: 5.7907 -> 3.4679   acc: 6.28% -> 30.34%               
client [57] (test)  loss: 4.1824 -> 3.3129   acc: 15.64% -> 28.36%             
client [13] (test)  loss: 5.4202 -> 3.6006   acc: 13.65% -> 35.49%             
client [43] (test)  loss: 4.7335 -> 3.1589   acc: 11.66% -> 35.78%             
client [91] (test)  loss: 4.7261 -> 2.7891   acc: 14.72% -> 39.26%             
client [10] (test)  loss: 4.8096 -> 2.9827   acc: 14.37% -> 33.96%             
client [64] (test)  loss: 4.4612 -> 2.9104   acc: 11.06% -> 40.76%             
client [82] (test)  loss: 4.6410 -> 3.2686   acc: 12.82% -> 35.88%             
client [22] (test)  loss: 4.8909 -> 3.2652   acc: 12.62% -> 35.50%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.0359 -> 3.2709   acc: 10.21% -> 29.41%             
client [23] (test)  loss: 4.1742 -> 2.6679   acc: 18.23% -> 42.12%             
client [88] (test)  loss: 5.4958 -> 3.7542   acc: 13.14% -> 29.86%             
client [98] (test)  loss: 4.6496 -> 2.9960   acc: 16.82% -> 38.94%             
client [79] (test)  loss: 5.1769 -> 3.8962   acc: 10.04% -> 23.50%             
client [21] (test)  loss: 5.2374 -> 3.2290   acc: 6.60% -> 31.80%              
client [92] (test)  loss: 5.3086 -> 2.9802   acc: 7.61% -> 35.64%              
client [56] (test)  loss: 5.3896 -> 3.9840   acc: 11.03% -> 24.20%             
client [5] (test)  loss: 5.5225 -> 3.1439   acc: 7.57% -> 33.51%               
client [52] (test)  loss: 5.2056 -> 3.5033   acc: 11.17% -> 35.28%             
==================== FedBN TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '4.6549 -> 0.0000', 'accuracy': '8.86% -> 0.00%'},           
    200: {'loss': '5.2408 -> 0.0000', 'accuracy': '9.78% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
FedBN achieved 10.0%(11.15%) at epoch: 64                                      
Convergence (test_after):                                                      
FedBN achieved 10.0%(15.54%) at epoch: 0                                       
FedBN achieved 20.0%(20.69%) at epoch: 11                                      
FedBN achieved 30.0%(32.01%) at epoch: 39                                      
