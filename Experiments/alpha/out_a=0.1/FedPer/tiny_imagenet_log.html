==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.7648 -> 3.2012   acc: 8.42% -> 13.23%              
client [81] (test)  loss: 3.7994 -> 3.2812   acc: 7.47% -> 16.73%              
client [21] (test)  loss: 5.2751 -> 3.3499   acc: 1.00% -> 25.00%              
client [68] (test)  loss: 3.7475 -> 3.4431   acc: 9.43% -> 17.56%              
client [93] (test)  loss: 3.9469 -> 3.2980   acc: 12.50% -> 21.32%             
client [31] (test)  loss: 3.9941 -> 2.7763   acc: 6.62% -> 35.19%              
client [20] (test)  loss: 3.6535 -> 3.2671   acc: 8.30% -> 17.30%              
client [59] (test)  loss: 5.3270 -> 3.3544   acc: 2.29% -> 15.67%              
client [48] (test)  loss: 3.0777 -> 3.0191   acc: 27.79% -> 31.51%             
client [34] (test)  loss: 3.7020 -> 3.4518   acc: 13.92% -> 18.33%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.1502 -> 3.7392   acc: 5.59% -> 12.50%              
client [99] (test)  loss: 4.4106 -> 4.0407   acc: 8.79% -> 15.34%              
client [67] (test)  loss: 3.6380 -> 3.1107   acc: 17.28% -> 22.22%             
client [0] (test)  loss: 3.4005 -> 3.3021   acc: 19.53% -> 17.74%              
client [76] (test)  loss: 3.3085 -> 3.1845   acc: 20.00% -> 21.45%             
client [41] (test)  loss: 3.6073 -> 2.9250   acc: 15.30% -> 29.18%             
client [62] (test)  loss: 5.2339 -> 3.8608   acc: 0.68% -> 9.06%               
client [2] (test)  loss: 5.2818 -> 3.0264   acc: 0.00% -> 23.04%               
client [14] (test)  loss: 3.0362 -> 2.7429   acc: 24.56% -> 29.72%             
client [46] (test)  loss: 3.6397 -> 3.3670   acc: 10.27% -> 16.40%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.2516 -> 3.1423   acc: 19.73% -> 23.84%             
client [68] (test)  loss: 3.6022 -> 3.1300   acc: 18.70% -> 28.62%             
client [57] (test)  loss: 3.4004 -> 3.3239   acc: 22.00% -> 22.00%             
client [17] (test)  loss: 5.4787 -> 2.8124   acc: 16.90% -> 28.12%             
client [54] (test)  loss: 3.6510 -> 3.1193   acc: 18.98% -> 28.09%             
client [23] (test)  loss: 5.3227 -> 2.7523   acc: 0.18% -> 30.27%              
client [35] (test)  loss: 2.9707 -> 2.9333   acc: 25.90% -> 23.49%             
client [59] (test)  loss: 3.2055 -> 3.0808   acc: 22.36% -> 25.00%             
client [31] (test)  loss: 3.2854 -> 2.5139   acc: 34.67% -> 42.51%             
client [9] (test)  loss: 3.8444 -> 3.5431   acc: 16.91% -> 22.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.8789 -> 2.9983   acc: 31.19% -> 30.53%             
client [33] (test)  loss: 3.2591 -> 3.3946   acc: 25.45% -> 28.18%             
client [16] (test)  loss: 3.3428 -> 3.1957   acc: 22.59% -> 26.59%             
client [44] (test)  loss: 5.2372 -> 2.9711   acc: 7.25% -> 28.34%              
client [8] (test)  loss: 2.9761 -> 2.9449   acc: 30.52% -> 32.43%              
client [31] (test)  loss: 3.4906 -> 2.5756   acc: 36.93% -> 42.86%             
client [47] (test)  loss: 3.5002 -> 2.2074   acc: 33.82% -> 46.11%             
client [36] (test)  loss: 2.9728 -> 2.3185   acc: 28.80% -> 40.94%             
client [20] (test)  loss: 3.3009 -> 3.1067   acc: 21.97% -> 26.82%             
client [56] (test)  loss: 3.5553 -> 3.3154   acc: 16.73% -> 20.46%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.5002 -> 3.2370   acc: 18.08% -> 26.58%              
client [60] (test)  loss: 3.9196 -> 2.8667   acc: 22.73% -> 33.45%             
client [28] (test)  loss: 4.1203 -> 2.8893   acc: 24.77% -> 29.84%             
client [25] (test)  loss: 5.4763 -> 3.2890   acc: 16.70% -> 27.30%             
client [58] (test)  loss: 3.3828 -> 3.2810   acc: 22.08% -> 27.39%             
client [44] (test)  loss: 3.3521 -> 2.9165   acc: 19.00% -> 29.79%             
client [39] (test)  loss: 3.6595 -> 3.5721   acc: 21.12% -> 23.43%             
client [29] (test)  loss: 4.8009 -> 2.7837   acc: 19.90% -> 30.44%             
client [3] (test)  loss: 2.9530 -> 3.0903   acc: 24.18% -> 23.53%              
client [84] (test)  loss: 3.4755 -> 3.1159   acc: 25.71% -> 30.67%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.8124 -> 3.1967   acc: 26.80% -> 28.20%             
client [84] (test)  loss: 3.4209 -> 3.2858   acc: 28.72% -> 32.45%             
client [10] (test)  loss: 3.6487 -> 2.9819   acc: 24.81% -> 26.49%             
client [36] (test)  loss: 2.4173 -> 2.3278   acc: 38.59% -> 40.76%             
client [65] (test)  loss: 3.5413 -> 3.6611   acc: 21.51% -> 22.22%             
client [81] (test)  loss: 3.6678 -> 3.0084   acc: 21.35% -> 26.87%             
client [79] (test)  loss: 4.1808 -> 3.6882   acc: 13.89% -> 18.38%             
client [42] (test)  loss: 3.5036 -> 3.2545   acc: 25.22% -> 27.91%             
client [11] (test)  loss: 3.8675 -> 3.4108   acc: 17.30% -> 21.11%             
client [96] (test)  loss: 3.3860 -> 2.6220   acc: 30.22% -> 32.73%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.4903 -> 3.3429   acc: 27.50% -> 33.23%              
client [53] (test)  loss: 3.1117 -> 3.2021   acc: 33.72% -> 35.08%             
client [52] (test)  loss: 3.3542 -> 3.3480   acc: 28.72% -> 29.61%             
client [42] (test)  loss: 3.7112 -> 3.4681   acc: 24.87% -> 27.91%             
client [69] (test)  loss: 4.0909 -> 4.2557   acc: 19.95% -> 17.55%             
client [59] (test)  loss: 3.3308 -> 3.4027   acc: 26.06% -> 25.88%             
client [7] (test)  loss: 5.7300 -> 3.7848   acc: 19.03% -> 24.06%              
client [26] (test)  loss: 3.5558 -> 3.1708   acc: 28.67% -> 31.37%             
client [49] (test)  loss: 3.5245 -> 3.3860   acc: 25.35% -> 27.27%             
client [98] (test)  loss: 3.0917 -> 3.1932   acc: 34.78% -> 33.27%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.4439 -> 3.3373   acc: 31.38% -> 32.70%             
client [47] (test)  loss: 3.7849 -> 2.2698   acc: 35.99% -> 47.74%             
client [21] (test)  loss: 3.4360 -> 3.4016   acc: 29.00% -> 28.80%             
client [77] (test)  loss: 3.4866 -> 3.1350   acc: 25.95% -> 29.04%             
client [95] (test)  loss: 3.8096 -> 3.4640   acc: 35.37% -> 36.42%             
client [91] (test)  loss: 3.2237 -> 3.0977   acc: 33.50% -> 34.86%             
client [14] (test)  loss: 3.0188 -> 3.0886   acc: 33.63% -> 37.19%             
client [99] (test)  loss: 4.6301 -> 4.7810   acc: 17.38% -> 23.52%             
client [20] (test)  loss: 4.1716 -> 3.7773   acc: 21.45% -> 26.99%             
client [39] (test)  loss: 4.2726 -> 4.0382   acc: 26.40% -> 23.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.8678 -> 3.6530   acc: 26.77% -> 28.72%             
client [62] (test)  loss: 3.9489 -> 4.1807   acc: 22.39% -> 23.08%             
client [71] (test)  loss: 4.1715 -> 4.3137   acc: 19.81% -> 22.95%             
client [97] (test)  loss: 4.3265 -> 3.6063   acc: 24.24% -> 26.91%             
client [30] (test)  loss: 3.9091 -> 4.1118   acc: 27.61% -> 29.70%             
client [88] (test)  loss: 3.9978 -> 4.0445   acc: 24.57% -> 25.77%             
client [60] (test)  loss: 3.3967 -> 3.2918   acc: 33.27% -> 34.91%             
client [82] (test)  loss: 3.7470 -> 3.6737   acc: 30.03% -> 32.47%             
client [91] (test)  loss: 3.5044 -> 3.3970   acc: 31.64% -> 33.33%             
client [57] (test)  loss: 3.7203 -> 3.7650   acc: 28.00% -> 24.91%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.3287 -> 3.5559   acc: 39.20% -> 43.38%             
client [15] (test)  loss: 4.0263 -> 3.7536   acc: 26.05% -> 30.59%             
client [71] (test)  loss: 4.4856 -> 4.5629   acc: 20.77% -> 22.22%             
client [97] (test)  loss: 4.5830 -> 4.0619   acc: 24.05% -> 27.86%             
client [53] (test)  loss: 4.2182 -> 3.9992   acc: 31.40% -> 31.20%             
client [77] (test)  loss: 3.9064 -> 3.3808   acc: 25.95% -> 29.55%             
client [76] (test)  loss: 4.3604 -> 3.8383   acc: 23.27% -> 29.64%             
client [79] (test)  loss: 5.2472 -> 4.5307   acc: 16.03% -> 19.66%             
client [28] (test)  loss: 4.0841 -> 3.9069   acc: 29.11% -> 28.75%             
client [99] (test)  loss: 5.3180 -> 5.4166   acc: 17.59% -> 22.70%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.8555 -> 4.3458   acc: 23.66% -> 28.24%             
client [86] (test)  loss: 3.8507 -> 3.8312   acc: 30.53% -> 36.35%             
client [34] (test)  loss: 4.6861 -> 4.5526   acc: 26.45% -> 26.22%             
client [73] (test)  loss: 4.2637 -> 3.9139   acc: 28.78% -> 33.39%             
client [5] (test)  loss: 4.0864 -> 3.8542   acc: 27.39% -> 26.85%              
client [96] (test)  loss: 4.0439 -> 3.5381   acc: 31.83% -> 31.65%             
client [22] (test)  loss: 3.9321 -> 3.7995   acc: 26.23% -> 30.77%             
client [60] (test)  loss: 4.0090 -> 3.7093   acc: 32.18% -> 33.27%             
client [66] (test)  loss: 4.4606 -> 4.0981   acc: 24.78% -> 24.96%             
client [83] (test)  loss: 5.3502 -> 4.7753   acc: 21.82% -> 19.54%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.4578 -> 4.4170   acc: 22.18% -> 30.55%             
client [65] (test)  loss: 4.8332 -> 4.6800   acc: 20.79% -> 22.94%             
client [95] (test)  loss: 5.1678 -> 4.2992   acc: 33.47% -> 34.74%             
client [17] (test)  loss: 5.1895 -> 3.5880   acc: 30.02% -> 30.96%             
client [8] (test)  loss: 4.5888 -> 4.1956   acc: 27.82% -> 32.59%              
client [35] (test)  loss: 4.9254 -> 4.4617   acc: 22.29% -> 27.91%             
client [98] (test)  loss: 4.3862 -> 3.8270   acc: 26.47% -> 34.59%             
client [53] (test)  loss: 4.3504 -> 4.5355   acc: 31.78% -> 31.78%             
client [43] (test)  loss: 4.6294 -> 4.0464   acc: 28.43% -> 31.63%             
client [64] (test)  loss: 3.5726 -> 3.7821   acc: 34.65% -> 36.14%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.3817 -> 4.1316   acc: 25.40% -> 26.20%             
client [88] (test)  loss: 5.3761 -> 5.4106   acc: 23.55% -> 26.62%             
client [38] (test)  loss: 5.4124 -> 5.0087   acc: 18.82% -> 20.03%             
client [3] (test)  loss: 4.7984 -> 4.7394   acc: 22.22% -> 28.10%              
client [5] (test)  loss: 4.3332 -> 4.2068   acc: 26.49% -> 26.67%              
client [41] (test)  loss: 4.0608 -> 3.9665   acc: 27.76% -> 31.67%             
client [7] (test)  loss: 5.4466 -> 4.9969   acc: 22.98% -> 23.34%              
client [37] (test)  loss: 4.7994 -> 4.0985   acc: 23.21% -> 31.17%             
client [45] (test)  loss: 5.4538 -> 4.2588   acc: 21.91% -> 25.76%             
client [47] (test)  loss: 3.8007 -> 2.8700   acc: 38.16% -> 41.41%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.4994 -> 4.9713   acc: 22.95% -> 26.96%             
client [11] (test)  loss: 5.3255 -> 5.4345   acc: 19.38% -> 19.90%             
client [37] (test)  loss: 5.2276 -> 4.5403   acc: 24.68% -> 28.73%             
client [41] (test)  loss: 4.3623 -> 4.1133   acc: 26.33% -> 31.32%             
client [95] (test)  loss: 5.8198 -> 4.8082   acc: 33.89% -> 35.58%             
client [53] (test)  loss: 5.2155 -> 4.9388   acc: 28.29% -> 31.40%             
client [22] (test)  loss: 4.5249 -> 4.3943   acc: 27.61% -> 28.40%             
client [25] (test)  loss: 5.4196 -> 5.3512   acc: 21.74% -> 23.13%             
client [69] (test)  loss: 6.4402 -> 6.5135   acc: 17.82% -> 17.82%             
client [46] (test)  loss: 4.3825 -> 4.3539   acc: 23.42% -> 27.57%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.6108 -> 3.2522   acc: 40.33% -> 41.41%             
client [69] (test)  loss: 6.5544 -> 6.8449   acc: 16.49% -> 17.29%             
client [82] (test)  loss: 4.7446 -> 4.8583   acc: 29.87% -> 32.14%             
client [45] (test)  loss: 5.2425 -> 4.7679   acc: 21.70% -> 26.77%             
client [7] (test)  loss: 5.4565 -> 5.3532   acc: 21.90% -> 21.90%              
client [50] (test)  loss: 4.4117 -> 4.1696   acc: 22.63% -> 28.15%             
client [35] (test)  loss: 4.9200 -> 4.9320   acc: 24.90% -> 27.31%             
client [24] (test)  loss: 5.6089 -> 5.5491   acc: 28.77% -> 27.67%             
client [15] (test)  loss: 4.4720 -> 4.6783   acc: 30.07% -> 30.59%             
client [58] (test)  loss: 5.8946 -> 5.9107   acc: 21.20% -> 23.14%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.1644 -> 4.3181   acc: 31.29% -> 37.20%             
client [76] (test)  loss: 6.1061 -> 5.2309   acc: 24.36% -> 28.00%             
client [67] (test)  loss: 5.1227 -> 4.8315   acc: 23.63% -> 27.87%             
client [37] (test)  loss: 6.0514 -> 4.9059   acc: 23.21% -> 29.71%             
client [58] (test)  loss: 6.2224 -> 6.2770   acc: 21.73% -> 23.85%             
client [64] (test)  loss: 4.1077 -> 4.3888   acc: 36.30% -> 36.80%             
client [77] (test)  loss: 4.8441 -> 4.5251   acc: 21.31% -> 26.29%             
client [55] (test)  loss: 7.1119 -> 5.8056   acc: 20.26% -> 26.46%             
client [12] (test)  loss: 5.1383 -> 4.4626   acc: 33.18% -> 35.78%             
client [89] (test)  loss: 5.7939 -> 5.1828   acc: 28.57% -> 29.84%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.6543 -> 5.7733   acc: 28.90% -> 31.91%             
client [51] (test)  loss: 5.0917 -> 4.6472   acc: 35.64% -> 34.00%             
client [8] (test)  loss: 5.1196 -> 5.2039   acc: 28.93% -> 32.43%              
client [18] (test)  loss: 5.2134 -> 5.4471   acc: 23.79% -> 25.58%             
client [94] (test)  loss: 4.9777 -> 5.0392   acc: 29.14% -> 31.33%             
client [81] (test)  loss: 6.3839 -> 4.9993   acc: 18.86% -> 30.43%             
client [3] (test)  loss: 5.6034 -> 5.5957   acc: 23.20% -> 28.59%              
client [11] (test)  loss: 6.1282 -> 6.2734   acc: 16.78% -> 19.38%             
client [95] (test)  loss: 6.5621 -> 5.6069   acc: 33.47% -> 33.05%             
client [67] (test)  loss: 5.2440 -> 4.9967   acc: 22.40% -> 28.57%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.4699 -> 5.0135   acc: 25.60% -> 25.60%             
client [79] (test)  loss: 6.9320 -> 6.5700   acc: 13.89% -> 16.67%             
client [58] (test)  loss: 6.6037 -> 6.8589   acc: 21.55% -> 24.56%             
client [88] (test)  loss: 6.6442 -> 6.4731   acc: 23.38% -> 26.45%             
client [46] (test)  loss: 5.6794 -> 5.1996   acc: 21.80% -> 26.67%             
client [11] (test)  loss: 6.2203 -> 6.4379   acc: 17.82% -> 19.72%             
client [55] (test)  loss: 6.4154 -> 6.4939   acc: 23.18% -> 25.55%             
client [13] (test)  loss: 5.9011 -> 6.1543   acc: 28.33% -> 32.42%             
client [31] (test)  loss: 5.2165 -> 4.5622   acc: 42.51% -> 43.73%             
client [75] (test)  loss: 5.8490 -> 5.1804   acc: 29.39% -> 33.74%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 6.4705 -> 6.0167   acc: 26.98% -> 28.06%             
client [7] (test)  loss: 6.6884 -> 6.3338   acc: 22.08% -> 21.18%              
client [57] (test)  loss: 5.9323 -> 5.8939   acc: 24.00% -> 22.18%             
client [13] (test)  loss: 6.3480 -> 6.4223   acc: 28.16% -> 31.40%             
client [43] (test)  loss: 5.9029 -> 5.1724   acc: 29.55% -> 31.15%             
client [91] (test)  loss: 5.0994 -> 4.5726   acc: 32.15% -> 33.67%             
client [10] (test)  loss: 5.6000 -> 5.2099   acc: 27.80% -> 28.73%             
client [64] (test)  loss: 4.8229 -> 5.0739   acc: 37.29% -> 37.95%             
client [82] (test)  loss: 5.8513 -> 5.8719   acc: 28.41% -> 30.52%             
client [22] (test)  loss: 5.6617 -> 5.4250   acc: 26.04% -> 29.39%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.8627 -> 5.9534   acc: 20.59% -> 24.39%             
client [23] (test)  loss: 4.4576 -> 4.1306   acc: 34.69% -> 36.28%             
client [88] (test)  loss: 7.3862 -> 6.7881   acc: 20.99% -> 25.94%             
client [98] (test)  loss: 5.2881 -> 4.9751   acc: 31.19% -> 37.05%             
client [79] (test)  loss: 7.3166 -> 7.1459   acc: 14.53% -> 16.67%             
client [21] (test)  loss: 5.5469 -> 5.3946   acc: 24.80% -> 25.80%             
client [92] (test)  loss: 6.2302 -> 5.2054   acc: 26.47% -> 29.93%             
client [56] (test)  loss: 7.5351 -> 7.1734   acc: 18.15% -> 20.11%             
client [5] (test)  loss: 5.7508 -> 5.5188   acc: 25.95% -> 27.75%              
client [52] (test)  loss: 6.0478 -> 5.8849   acc: 26.24% -> 29.79%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '4.1507 -> 0.0000', 'accuracy': '27.07% -> 0.00%'},          
    200: {'loss': '6.1939 -> 0.0000', 'accuracy': '26.31% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(10.05%) at epoch: 7                                      
FedPer achieved 20.0%(22.08%) at epoch: 28                                     
FedPer achieved 30.0%(30.38%) at epoch: 78                                     
Convergence (test_after):                                                      
FedPer achieved 10.0%(15.54%) at epoch: 0                                      
FedPer achieved 20.0%(20.01%) at epoch: 7                                      
FedPer achieved 30.0%(32.34%) at epoch: 39                                     
