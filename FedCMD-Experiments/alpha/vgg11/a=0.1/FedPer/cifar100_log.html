==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.8221 -> 1.9336   acc: 32.29% -> 59.87%             
client [81] (test)  loss: 3.2905 -> 2.4000   acc: 32.91% -> 56.33%             
client [21] (test)  loss: 5.1891 -> 2.5209   acc: 5.76% -> 43.23%              
client [68] (test)  loss: 3.5618 -> 1.9141   acc: 16.93% -> 56.55%             
client [93] (test)  loss: 4.0015 -> 3.4139   acc: 9.86% -> 32.65%              
client [31] (test)  loss: 3.3552 -> 2.1279   acc: 28.30% -> 51.77%             
client [20] (test)  loss: 2.4034 -> 1.0718   acc: 44.08% -> 72.70%             
client [59] (test)  loss: 3.8724 -> 2.0533   acc: 11.29% -> 54.19%             
client [48] (test)  loss: 3.5680 -> 3.0673   acc: 16.67% -> 35.62%             
client [34] (test)  loss: 3.4928 -> 2.2512   acc: 17.22% -> 45.36%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9050 -> 1.0714   acc: 55.81% -> 78.19%             
client [99] (test)  loss: 3.9885 -> 3.2461   acc: 17.20% -> 35.03%             
client [67] (test)  loss: 2.9531 -> 2.1968   acc: 30.72% -> 53.61%             
client [0] (test)  loss: 2.7016 -> 2.4920   acc: 40.09% -> 47.75%              
client [76] (test)  loss: 3.1475 -> 2.7528   acc: 27.24% -> 48.50%             
client [41] (test)  loss: 3.2540 -> 2.4939   acc: 25.33% -> 49.00%             
client [62] (test)  loss: 4.5168 -> 2.4617   acc: 10.49% -> 41.97%             
client [2] (test)  loss: 4.4426 -> 2.4808   acc: 15.00% -> 44.62%              
client [14] (test)  loss: 3.0762 -> 2.7827   acc: 35.29% -> 47.65%             
client [46] (test)  loss: 2.5786 -> 2.0245   acc: 36.40% -> 64.00%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.9612 -> 1.9000   acc: 51.71% -> 58.56%             
client [68] (test)  loss: 1.7945 -> 1.6312   acc: 55.91% -> 64.86%             
client [57] (test)  loss: 2.1914 -> 2.2703   acc: 50.83% -> 57.76%             
client [17] (test)  loss: 2.5635 -> 2.4029   acc: 39.37% -> 45.71%             
client [54] (test)  loss: 1.8512 -> 1.9921   acc: 56.25% -> 58.42%             
client [23] (test)  loss: 4.2402 -> 2.4785   acc: 26.56% -> 48.83%             
client [35] (test)  loss: 2.1559 -> 1.9535   acc: 48.67% -> 58.00%             
client [59] (test)  loss: 1.6542 -> 1.6266   acc: 58.71% -> 64.52%             
client [31] (test)  loss: 2.0535 -> 2.1750   acc: 49.52% -> 55.63%             
client [9] (test)  loss: 2.2341 -> 2.0052   acc: 46.22% -> 57.10%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.9550 -> 1.8527   acc: 55.46% -> 62.75%             
client [33] (test)  loss: 2.1448 -> 2.5519   acc: 55.60% -> 58.58%             
client [16] (test)  loss: 2.1561 -> 1.9621   acc: 51.83% -> 60.56%             
client [44] (test)  loss: 3.1593 -> 2.3649   acc: 37.58% -> 48.04%             
client [8] (test)  loss: 1.9612 -> 2.2367   acc: 56.73% -> 58.97%              
client [31] (test)  loss: 1.8988 -> 2.0624   acc: 55.31% -> 57.56%             
client [47] (test)  loss: 2.8193 -> 2.2618   acc: 32.33% -> 53.01%             
client [36] (test)  loss: 2.9743 -> 2.4285   acc: 32.64% -> 49.31%             
client [20] (test)  loss: 1.2022 -> 1.0243   acc: 70.07% -> 77.63%             
client [56] (test)  loss: 2.2386 -> 2.1413   acc: 50.99% -> 53.96%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.5509 -> 1.4582   acc: 64.33% -> 70.38%              
client [60] (test)  loss: 3.1644 -> 2.6196   acc: 33.33% -> 49.36%             
client [28] (test)  loss: 2.1518 -> 2.1939   acc: 50.52% -> 57.14%             
client [25] (test)  loss: 2.1931 -> 1.8142   acc: 48.95% -> 60.76%             
client [58] (test)  loss: 2.0673 -> 2.2862   acc: 47.15% -> 52.22%             
client [44] (test)  loss: 2.7043 -> 2.3082   acc: 38.56% -> 49.35%             
client [39] (test)  loss: 1.8600 -> 2.2856   acc: 54.69% -> 50.49%             
client [29] (test)  loss: 2.1379 -> 2.1428   acc: 50.57% -> 53.71%             
client [3] (test)  loss: 2.0062 -> 1.8043   acc: 60.24% -> 64.22%              
client [84] (test)  loss: 2.2296 -> 2.5361   acc: 51.55% -> 52.48%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.2137 -> 1.8209   acc: 49.28% -> 58.21%             
client [84] (test)  loss: 2.2371 -> 2.6294   acc: 52.48% -> 51.55%             
client [10] (test)  loss: 2.1839 -> 2.3979   acc: 53.57% -> 59.13%             
client [36] (test)  loss: 2.4780 -> 2.4232   acc: 47.57% -> 50.69%             
client [65] (test)  loss: 2.3276 -> 2.6038   acc: 52.23% -> 50.20%             
client [81] (test)  loss: 2.1056 -> 1.9741   acc: 56.96% -> 62.03%             
client [79] (test)  loss: 1.1772 -> 1.1880   acc: 73.45% -> 76.84%             
client [42] (test)  loss: 1.6645 -> 1.9585   acc: 64.82% -> 63.84%             
client [11] (test)  loss: 1.9763 -> 2.0475   acc: 58.28% -> 62.58%             
client [96] (test)  loss: 1.6782 -> 1.6685   acc: 62.85% -> 65.63%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.0055 -> 2.2330   acc: 57.69% -> 58.65%              
client [53] (test)  loss: 1.9936 -> 1.8854   acc: 56.89% -> 62.87%             
client [52] (test)  loss: 2.0299 -> 2.2247   acc: 59.80% -> 58.14%             
client [42] (test)  loss: 1.6300 -> 1.9336   acc: 65.47% -> 64.50%             
client [69] (test)  loss: 0.9492 -> 1.0142   acc: 76.77% -> 79.32%             
client [59] (test)  loss: 1.4851 -> 1.5745   acc: 65.48% -> 68.71%             
client [7] (test)  loss: 1.9133 -> 1.9688   acc: 56.96% -> 61.49%              
client [26] (test)  loss: 2.3713 -> 2.5716   acc: 46.92% -> 52.31%             
client [49] (test)  loss: 1.9159 -> 2.1858   acc: 62.36% -> 63.51%             
client [98] (test)  loss: 2.5199 -> 2.9231   acc: 52.50% -> 50.31%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.6567 -> 2.9650   acc: 50.94% -> 49.06%             
client [47] (test)  loss: 2.5087 -> 2.1963   acc: 44.36% -> 54.14%             
client [21] (test)  loss: 1.9409 -> 1.8973   acc: 54.76% -> 59.65%             
client [77] (test)  loss: 1.8899 -> 1.9289   acc: 59.87% -> 65.20%             
client [95] (test)  loss: 1.8598 -> 2.0667   acc: 60.07% -> 60.40%             
client [91] (test)  loss: 1.8692 -> 2.0201   acc: 61.09% -> 63.99%             
client [14] (test)  loss: 2.6771 -> 2.8499   acc: 54.12% -> 52.94%             
client [99] (test)  loss: 2.9596 -> 3.3699   acc: 41.72% -> 39.81%             
client [20] (test)  loss: 1.2024 -> 1.1030   acc: 75.33% -> 77.96%             
client [39] (test)  loss: 1.8518 -> 2.2023   acc: 55.99% -> 53.40%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.1728 -> 2.3047   acc: 63.46% -> 59.80%             
client [62] (test)  loss: 2.3386 -> 2.3882   acc: 53.44% -> 48.85%             
client [71] (test)  loss: 2.7643 -> 2.9551   acc: 50.32% -> 50.00%             
client [97] (test)  loss: 2.2429 -> 2.3358   acc: 55.60% -> 52.59%             
client [30] (test)  loss: 2.3732 -> 2.4815   acc: 54.11% -> 54.11%             
client [88] (test)  loss: 1.7090 -> 1.9694   acc: 65.23% -> 62.58%             
client [60] (test)  loss: 2.7791 -> 2.8635   acc: 46.15% -> 51.92%             
client [82] (test)  loss: 2.0368 -> 2.1290   acc: 60.55% -> 61.59%             
client [91] (test)  loss: 1.8110 -> 1.9814   acc: 64.95% -> 66.56%             
client [57] (test)  loss: 2.0760 -> 2.2408   acc: 59.41% -> 56.77%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.9496 -> 2.1394   acc: 61.09% -> 59.49%             
client [15] (test)  loss: 2.4451 -> 2.5063   acc: 50.95% -> 54.75%             
client [71] (test)  loss: 2.7489 -> 3.0624   acc: 49.03% -> 50.00%             
client [97] (test)  loss: 2.1533 -> 2.3090   acc: 56.03% -> 55.17%             
client [53] (test)  loss: 1.9021 -> 1.9953   acc: 58.68% -> 64.97%             
client [77] (test)  loss: 1.8740 -> 1.9537   acc: 61.44% -> 66.77%             
client [76] (test)  loss: 2.5437 -> 2.6335   acc: 50.50% -> 54.49%             
client [79] (test)  loss: 1.1526 -> 1.2552   acc: 75.14% -> 78.25%             
client [28] (test)  loss: 2.1755 -> 2.2893   acc: 57.14% -> 62.72%             
client [99] (test)  loss: 2.9735 -> 3.2595   acc: 41.08% -> 42.36%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.2840 -> 2.4176   acc: 56.90% -> 56.90%             
client [86] (test)  loss: 2.1263 -> 2.2590   acc: 59.70% -> 60.60%             
client [34] (test)  loss: 2.1309 -> 2.2329   acc: 59.93% -> 58.28%             
client [73] (test)  loss: 2.3007 -> 2.3457   acc: 55.67% -> 56.00%             
client [5] (test)  loss: 1.9500 -> 2.2022   acc: 61.02% -> 62.62%              
client [96] (test)  loss: 1.8062 -> 1.9865   acc: 64.40% -> 64.71%             
client [22] (test)  loss: 2.6940 -> 2.7900   acc: 48.91% -> 47.04%             
client [60] (test)  loss: 2.8818 -> 3.0230   acc: 48.72% -> 51.92%             
client [66] (test)  loss: 1.7335 -> 1.9156   acc: 65.05% -> 67.96%             
client [83] (test)  loss: 2.3662 -> 2.2448   acc: 59.27% -> 58.94%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.7093 -> 2.8951   acc: 54.15% -> 55.48%             
client [65] (test)  loss: 2.5154 -> 2.8188   acc: 53.04% -> 53.85%             
client [95] (test)  loss: 1.9228 -> 2.1926   acc: 63.37% -> 61.72%             
client [17] (test)  loss: 2.4303 -> 2.3637   acc: 51.75% -> 53.97%             
client [8] (test)  loss: 2.2428 -> 2.4152   acc: 60.90% -> 61.54%              
client [35] (test)  loss: 2.1404 -> 2.4604   acc: 61.00% -> 61.67%             
client [98] (test)  loss: 2.8298 -> 3.0423   acc: 54.69% -> 52.50%             
client [53] (test)  loss: 1.8850 -> 2.0600   acc: 61.08% -> 62.28%             
client [43] (test)  loss: 2.6803 -> 2.9797   acc: 53.64% -> 55.76%             
client [64] (test)  loss: 1.9499 -> 1.9948   acc: 64.43% -> 65.83%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.1631 -> 2.1048   acc: 57.06% -> 59.65%             
client [88] (test)  loss: 1.9811 -> 2.0988   acc: 64.24% -> 65.56%             
client [38] (test)  loss: 2.2785 -> 2.3600   acc: 59.49% -> 60.06%             
client [3] (test)  loss: 1.9027 -> 1.9192   acc: 66.67% -> 66.06%              
client [5] (test)  loss: 2.0835 -> 2.3117   acc: 61.34% -> 62.30%              
client [41] (test)  loss: 2.2722 -> 2.3253   acc: 59.00% -> 59.00%             
client [7] (test)  loss: 2.1126 -> 2.1649   acc: 62.14% -> 59.55%              
client [37] (test)  loss: 2.7780 -> 2.6512   acc: 53.70% -> 54.02%             
client [45] (test)  loss: 2.3024 -> 2.3243   acc: 53.33% -> 59.33%             
client [47] (test)  loss: 2.3674 -> 2.2391   acc: 51.88% -> 57.14%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.3486 -> 2.3870   acc: 59.15% -> 59.44%             
client [11] (test)  loss: 2.1768 -> 2.2970   acc: 65.64% -> 67.48%             
client [37] (test)  loss: 2.7399 -> 2.6885   acc: 54.98% -> 56.91%             
client [41] (test)  loss: 2.2553 -> 2.3689   acc: 58.33% -> 58.33%             
client [95] (test)  loss: 2.0659 -> 2.1817   acc: 60.07% -> 60.73%             
client [53] (test)  loss: 1.9437 -> 2.1413   acc: 63.17% -> 64.07%             
client [22] (test)  loss: 2.7858 -> 2.9127   acc: 51.40% -> 49.84%             
client [25] (test)  loss: 1.8322 -> 2.0774   acc: 67.09% -> 63.29%             
client [69] (test)  loss: 1.0008 -> 1.0940   acc: 77.62% -> 79.32%             
client [46] (test)  loss: 1.8335 -> 2.0441   acc: 69.60% -> 67.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.4086 -> 2.4063   acc: 54.89% -> 56.02%             
client [69] (test)  loss: 1.0785 -> 1.1429   acc: 78.47% -> 78.75%             
client [82] (test)  loss: 2.4451 -> 2.5498   acc: 60.55% -> 61.94%             
client [45] (test)  loss: 2.3617 -> 2.5314   acc: 56.67% -> 58.00%             
client [7] (test)  loss: 2.2489 -> 2.3237   acc: 60.84% -> 58.90%              
client [50] (test)  loss: 2.2067 -> 2.3181   acc: 63.44% -> 60.93%             
client [35] (test)  loss: 2.3894 -> 2.6247   acc: 62.00% -> 60.67%             
client [24] (test)  loss: 2.0353 -> 2.2158   acc: 66.16% -> 66.16%             
client [15] (test)  loss: 2.8229 -> 2.8311   acc: 53.48% -> 53.80%             
client [58] (test)  loss: 2.4250 -> 2.5135   acc: 52.85% -> 53.80%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.8709 -> 3.0360   acc: 51.31% -> 54.25%             
client [76] (test)  loss: 3.1158 -> 3.2552   acc: 56.15% -> 54.82%             
client [67] (test)  loss: 2.0129 -> 2.1745   acc: 66.77% -> 66.14%             
client [37] (test)  loss: 2.9971 -> 2.8377   acc: 55.63% -> 55.95%             
client [58] (test)  loss: 2.5231 -> 2.4973   acc: 54.43% -> 53.48%             
client [64] (test)  loss: 2.0816 -> 2.1706   acc: 63.87% -> 63.59%             
client [77] (test)  loss: 2.2256 -> 2.3347   acc: 64.58% -> 65.83%             
client [55] (test)  loss: 2.0719 -> 2.0535   acc: 68.32% -> 68.94%             
client [12] (test)  loss: 1.8639 -> 1.8562   acc: 71.05% -> 72.70%             
client [89] (test)  loss: 3.0003 -> 3.1912   acc: 53.82% -> 55.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.7781 -> 2.8864   acc: 56.21% -> 56.21%             
client [51] (test)  loss: 3.4396 -> 3.3758   acc: 49.67% -> 49.67%             
client [8] (test)  loss: 2.7065 -> 2.8140   acc: 59.62% -> 60.90%              
client [18] (test)  loss: 1.8380 -> 1.9393   acc: 66.15% -> 67.97%             
client [94] (test)  loss: 2.3966 -> 2.6309   acc: 56.73% -> 57.69%             
client [81] (test)  loss: 2.3737 -> 2.5180   acc: 61.39% -> 62.97%             
client [3] (test)  loss: 2.0505 -> 2.0784   acc: 65.44% -> 67.89%              
client [11] (test)  loss: 2.4098 -> 2.4533   acc: 63.80% -> 65.34%             
client [95] (test)  loss: 2.1632 -> 2.3209   acc: 61.72% -> 60.07%             
client [67] (test)  loss: 2.0314 -> 2.1099   acc: 64.26% -> 63.95%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.4634 -> 2.2436   acc: 58.79% -> 59.65%             
client [79] (test)  loss: 1.4951 -> 1.5138   acc: 78.53% -> 78.81%             
client [58] (test)  loss: 2.5631 -> 2.5940   acc: 55.38% -> 54.75%             
client [88] (test)  loss: 2.2278 -> 2.2616   acc: 65.23% -> 66.56%             
client [46] (test)  loss: 2.1646 -> 2.1522   acc: 70.40% -> 66.80%             
client [11] (test)  loss: 2.5129 -> 2.5639   acc: 65.34% -> 66.26%             
client [55] (test)  loss: 2.2225 -> 2.2139   acc: 68.32% -> 68.94%             
client [13] (test)  loss: 2.4034 -> 2.5375   acc: 62.01% -> 62.92%             
client [31] (test)  loss: 2.4578 -> 2.6257   acc: 63.99% -> 61.74%             
client [75] (test)  loss: 2.0210 -> 2.0518   acc: 69.77% -> 70.76%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.9617 -> 3.0795   acc: 56.35% -> 55.70%             
client [7] (test)  loss: 2.5739 -> 2.5551   acc: 61.81% -> 61.81%              
client [57] (test)  loss: 2.7482 -> 2.7338   acc: 61.39% -> 62.38%             
client [13] (test)  loss: 2.5469 -> 2.6446   acc: 62.01% -> 60.79%             
client [43] (test)  loss: 3.4034 -> 3.5277   acc: 56.67% -> 56.67%             
client [91] (test)  loss: 2.3325 -> 2.5136   acc: 66.88% -> 65.59%             
client [10] (test)  loss: 2.9732 -> 3.1606   acc: 57.94% -> 59.92%             
client [64] (test)  loss: 2.2504 -> 2.3050   acc: 64.71% -> 64.71%             
client [82] (test)  loss: 2.7305 -> 2.7480   acc: 61.25% -> 62.28%             
client [22] (test)  loss: 3.3704 -> 3.4564   acc: 52.02% -> 51.09%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.4264 -> 1.3890   acc: 78.95% -> 76.97%             
client [23] (test)  loss: 3.2427 -> 2.9496   acc: 56.25% -> 54.69%             
client [88] (test)  loss: 2.2273 -> 2.2889   acc: 65.56% -> 67.55%             
client [98] (test)  loss: 3.4593 -> 3.5509   acc: 54.37% -> 54.69%             
client [79] (test)  loss: 1.5358 -> 1.5514   acc: 77.97% -> 78.25%             
client [21] (test)  loss: 2.5469 -> 2.4617   acc: 59.94% -> 58.21%             
client [92] (test)  loss: 3.2376 -> 3.2786   acc: 50.63% -> 50.63%             
client [56] (test)  loss: 2.6618 -> 2.7965   acc: 61.88% -> 61.39%             
client [5] (test)  loss: 2.4667 -> 2.5720   acc: 62.30% -> 61.02%              
client [52] (test)  loss: 2.7496 -> 2.7507   acc: 64.45% -> 64.12%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '2.0404 -> 0.0000', 'accuracy': '58.79% -> 0.00%'},          
    200: {'loss': '2.6664 -> 0.0000', 'accuracy': '61.02% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(10.53%) at epoch: 6                                      
FedPer achieved 20.0%(21.43%) at epoch: 9                                      
FedPer achieved 30.0%(30.23%) at epoch: 16                                     
FedPer achieved 40.0%(40.55%) at epoch: 22                                     
FedPer achieved 50.0%(52.06%) at epoch: 30                                     
FedPer achieved 60.0%(60.87%) at epoch: 54                                     
Convergence (test_after):                                                      
FedPer achieved 30.0%(35.64%) at epoch: 0                                      
FedPer achieved 40.0%(43.26%) at epoch: 1                                      
FedPer achieved 50.0%(50.64%) at epoch: 6                                      
FedPer achieved 60.0%(61.40%) at epoch: 38                                     
