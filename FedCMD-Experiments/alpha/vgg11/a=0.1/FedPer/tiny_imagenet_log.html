==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.8215 -> 2.0574   acc: 37.97% -> 53.95%             
client [81] (test)  loss: 3.0677 -> 2.1401   acc: 29.00% -> 55.16%             
client [21] (test)  loss: 4.8394 -> 2.4840   acc: 12.40% -> 50.00%             
client [68] (test)  loss: 3.7427 -> 2.2920   acc: 20.33% -> 51.06%             
client [93] (test)  loss: 3.7278 -> 2.3267   acc: 23.35% -> 51.29%             
client [31] (test)  loss: 3.8433 -> 1.5076   acc: 23.34% -> 67.07%             
client [20] (test)  loss: 2.8753 -> 1.9884   acc: 35.29% -> 54.50%             
client [59] (test)  loss: 4.7810 -> 2.1277   acc: 11.27% -> 51.94%             
client [48] (test)  loss: 2.4587 -> 1.6510   acc: 48.36% -> 65.43%             
client [34] (test)  loss: 3.7554 -> 2.5954   acc: 22.51% -> 48.49%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.5132 -> 2.8314   acc: 33.78% -> 47.07%             
client [99] (test)  loss: 3.6277 -> 3.0579   acc: 28.83% -> 47.85%             
client [67] (test)  loss: 2.9214 -> 2.0517   acc: 36.68% -> 59.08%             
client [0] (test)  loss: 2.9682 -> 2.2446   acc: 34.95% -> 52.51%              
client [76] (test)  loss: 3.0022 -> 2.2148   acc: 38.18% -> 52.73%             
client [41] (test)  loss: 2.8155 -> 1.9190   acc: 35.41% -> 57.65%             
client [62] (test)  loss: 5.1066 -> 2.5985   acc: 14.87% -> 48.21%             
client [2] (test)  loss: 5.6331 -> 2.0613   acc: 10.22% -> 57.39%              
client [14] (test)  loss: 2.3139 -> 1.7888   acc: 47.69% -> 61.03%             
client [46] (test)  loss: 2.1255 -> 1.9591   acc: 47.93% -> 59.10%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.4154 -> 2.2346   acc: 47.95% -> 55.34%             
client [68] (test)  loss: 2.3484 -> 2.2240   acc: 48.13% -> 56.59%             
client [57] (test)  loss: 2.9618 -> 2.3618   acc: 41.09% -> 53.82%             
client [17] (test)  loss: 2.0825 -> 1.7209   acc: 50.55% -> 63.98%             
client [54] (test)  loss: 2.1735 -> 2.1704   acc: 52.31% -> 55.71%             
client [23] (test)  loss: 4.0037 -> 1.6396   acc: 26.19% -> 63.72%             
client [35] (test)  loss: 2.1321 -> 1.9664   acc: 51.61% -> 58.43%             
client [59] (test)  loss: 2.0169 -> 2.0435   acc: 54.23% -> 60.21%             
client [31] (test)  loss: 1.4420 -> 1.5011   acc: 66.20% -> 71.25%             
client [9] (test)  loss: 2.2786 -> 2.3102   acc: 48.36% -> 55.45%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.8496 -> 1.7090   acc: 57.92% -> 65.51%             
client [33] (test)  loss: 2.1880 -> 2.4169   acc: 54.77% -> 54.09%             
client [16] (test)  loss: 2.1212 -> 2.0137   acc: 53.37% -> 57.74%             
client [44] (test)  loss: 2.5412 -> 1.9116   acc: 45.25% -> 58.62%             
client [8] (test)  loss: 1.9492 -> 1.9165   acc: 59.30% -> 63.28%              
client [31] (test)  loss: 1.4700 -> 1.4337   acc: 65.33% -> 72.47%             
client [47] (test)  loss: 1.8047 -> 1.3501   acc: 59.67% -> 69.26%             
client [36] (test)  loss: 2.5788 -> 1.6061   acc: 45.29% -> 63.77%             
client [20] (test)  loss: 1.6845 -> 1.7464   acc: 59.34% -> 62.80%             
client [56] (test)  loss: 2.6587 -> 2.4351   acc: 43.77% -> 53.56%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.1400 -> 2.1700   acc: 53.71% -> 57.69%              
client [60] (test)  loss: 2.4665 -> 2.1228   acc: 47.09% -> 56.00%             
client [28] (test)  loss: 2.3719 -> 2.3156   acc: 51.72% -> 56.78%             
client [25] (test)  loss: 2.5322 -> 2.2667   acc: 49.74% -> 53.39%             
client [58] (test)  loss: 2.2962 -> 2.5808   acc: 54.42% -> 52.30%             
client [44] (test)  loss: 2.0527 -> 1.8723   acc: 53.30% -> 60.55%             
client [39] (test)  loss: 2.3881 -> 2.2078   acc: 53.47% -> 57.76%             
client [29] (test)  loss: 1.7019 -> 1.6892   acc: 62.07% -> 64.63%             
client [3] (test)  loss: 1.8793 -> 1.7516   acc: 58.17% -> 63.07%              
client [84] (test)  loss: 2.1292 -> 2.1111   acc: 57.98% -> 60.46%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.4141 -> 2.1798   acc: 49.60% -> 55.60%             
client [84] (test)  loss: 2.0551 -> 2.1156   acc: 60.46% -> 61.35%             
client [10] (test)  loss: 1.8895 -> 1.9278   acc: 60.07% -> 60.63%             
client [36] (test)  loss: 1.9168 -> 1.6258   acc: 57.07% -> 63.59%             
client [65] (test)  loss: 2.2286 -> 2.2469   acc: 52.15% -> 56.99%             
client [81] (test)  loss: 1.7718 -> 1.7511   acc: 60.14% -> 64.23%             
client [79] (test)  loss: 2.7144 -> 2.7300   acc: 44.23% -> 49.79%             
client [42] (test)  loss: 2.0539 -> 2.1761   acc: 54.38% -> 58.14%             
client [11] (test)  loss: 2.2194 -> 2.3298   acc: 54.67% -> 57.79%             
client [96] (test)  loss: 1.7016 -> 1.7186   acc: 61.33% -> 63.31%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.7689 -> 1.9292   acc: 64.39% -> 63.91%              
client [53] (test)  loss: 2.3184 -> 2.2362   acc: 55.81% -> 61.82%             
client [52] (test)  loss: 1.9158 -> 1.9371   acc: 59.93% -> 62.41%             
client [42] (test)  loss: 2.0459 -> 2.1971   acc: 56.89% -> 58.50%             
client [69] (test)  loss: 2.5290 -> 2.7554   acc: 50.00% -> 51.06%             
client [59] (test)  loss: 1.7878 -> 1.9924   acc: 60.92% -> 62.50%             
client [7] (test)  loss: 2.2995 -> 2.3598   acc: 55.12% -> 54.94%              
client [26] (test)  loss: 1.6683 -> 1.7980   acc: 63.58% -> 64.92%             
client [49] (test)  loss: 2.0766 -> 2.2918   acc: 59.62% -> 60.49%             
client [98] (test)  loss: 1.7293 -> 1.9368   acc: 65.60% -> 65.60%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.7536 -> 1.9510   acc: 67.11% -> 66.73%             
client [47] (test)  loss: 1.6037 -> 1.3518   acc: 66.91% -> 70.71%             
client [21] (test)  loss: 2.3026 -> 2.2504   acc: 55.00% -> 56.20%             
client [77] (test)  loss: 1.8081 -> 1.8148   acc: 61.17% -> 65.81%             
client [95] (test)  loss: 2.0428 -> 2.2082   acc: 60.84% -> 62.32%             
client [91] (test)  loss: 1.8259 -> 1.8316   acc: 61.76% -> 63.45%             
client [14] (test)  loss: 1.7061 -> 1.7635   acc: 64.77% -> 64.59%             
client [99] (test)  loss: 2.8096 -> 2.8891   acc: 52.56% -> 53.17%             
client [20] (test)  loss: 1.6025 -> 1.7892   acc: 65.40% -> 64.53%             
client [39] (test)  loss: 2.4049 -> 2.2483   acc: 53.80% -> 56.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.9060 -> 1.9344   acc: 62.41% -> 62.77%             
client [62] (test)  loss: 2.4168 -> 2.6154   acc: 53.85% -> 52.31%             
client [71] (test)  loss: 2.2307 -> 2.6416   acc: 55.07% -> 51.93%             
client [97] (test)  loss: 2.2132 -> 2.2317   acc: 57.25% -> 59.16%             
client [30] (test)  loss: 2.3314 -> 2.5615   acc: 55.22% -> 54.99%             
client [88] (test)  loss: 1.9971 -> 2.1997   acc: 59.73% -> 59.56%             
client [60] (test)  loss: 2.2112 -> 2.3034   acc: 57.82% -> 57.82%             
client [82] (test)  loss: 1.9541 -> 2.1757   acc: 61.85% -> 62.82%             
client [91] (test)  loss: 1.7631 -> 1.8934   acc: 63.62% -> 63.28%             
client [57] (test)  loss: 2.3863 -> 2.3049   acc: 52.73% -> 55.64%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.4084 -> 1.5527   acc: 71.60% -> 72.65%             
client [15] (test)  loss: 2.0390 -> 2.1736   acc: 59.62% -> 59.27%             
client [71] (test)  loss: 2.4437 -> 2.5697   acc: 51.93% -> 51.93%             
client [97] (test)  loss: 2.3581 -> 2.4412   acc: 56.68% -> 58.59%             
client [53] (test)  loss: 2.4273 -> 2.3577   acc: 60.66% -> 61.43%             
client [77] (test)  loss: 1.8433 -> 1.8481   acc: 65.12% -> 67.35%             
client [76] (test)  loss: 2.0923 -> 2.1462   acc: 61.09% -> 61.09%             
client [79] (test)  loss: 2.8384 -> 2.8798   acc: 48.50% -> 50.21%             
client [28] (test)  loss: 2.5283 -> 2.6665   acc: 53.89% -> 55.15%             
client [99] (test)  loss: 2.9419 -> 2.9473   acc: 51.12% -> 54.40%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.2753 -> 2.5479   acc: 58.21% -> 58.02%             
client [86] (test)  loss: 1.8332 -> 1.9677   acc: 63.65% -> 65.27%             
client [34] (test)  loss: 2.4318 -> 2.6682   acc: 54.29% -> 53.60%             
client [73] (test)  loss: 1.8945 -> 2.0842   acc: 61.53% -> 61.21%             
client [5] (test)  loss: 1.9942 -> 2.1783   acc: 61.44% -> 61.08%              
client [96] (test)  loss: 1.7985 -> 1.9485   acc: 63.31% -> 64.21%             
client [22] (test)  loss: 1.8471 -> 2.0860   acc: 65.09% -> 64.69%             
client [60] (test)  loss: 2.2798 -> 2.4450   acc: 56.55% -> 57.64%             
client [66] (test)  loss: 2.1266 -> 2.1965   acc: 57.04% -> 60.07%             
client [83] (test)  loss: 2.4160 -> 2.6117   acc: 54.65% -> 55.41%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.1614 -> 2.3116   acc: 60.55% -> 61.27%             
client [65] (test)  loss: 2.3439 -> 2.3915   acc: 55.91% -> 58.60%             
client [95] (test)  loss: 2.1802 -> 2.4286   acc: 60.00% -> 62.95%             
client [17] (test)  loss: 1.7389 -> 1.7329   acc: 65.72% -> 65.88%             
client [8] (test)  loss: 1.9272 -> 2.1427   acc: 66.93% -> 65.98%              
client [35] (test)  loss: 2.0605 -> 2.2301   acc: 61.65% -> 61.85%             
client [98] (test)  loss: 1.9140 -> 2.1222   acc: 68.43% -> 67.11%             
client [53] (test)  loss: 2.4840 -> 2.5080   acc: 60.27% -> 60.47%             
client [43] (test)  loss: 2.3449 -> 2.4959   acc: 61.66% -> 60.70%             
client [64] (test)  loss: 1.8690 -> 1.9128   acc: 65.02% -> 65.35%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.5705 -> 2.3144   acc: 55.40% -> 57.20%             
client [88] (test)  loss: 2.2947 -> 2.5134   acc: 59.90% -> 60.58%             
client [38] (test)  loss: 2.7699 -> 2.8466   acc: 55.23% -> 55.40%             
client [3] (test)  loss: 2.0204 -> 1.9016   acc: 63.56% -> 63.73%              
client [5] (test)  loss: 2.1549 -> 2.2897   acc: 62.16% -> 61.08%              
client [41] (test)  loss: 1.9547 -> 1.9577   acc: 61.92% -> 61.74%             
client [7] (test)  loss: 2.6143 -> 2.6036   acc: 56.01% -> 56.37%              
client [37] (test)  loss: 2.3766 -> 2.1572   acc: 59.74% -> 61.85%             
client [45] (test)  loss: 2.5291 -> 2.2803   acc: 57.81% -> 57.61%             
client [47] (test)  loss: 1.6722 -> 1.4312   acc: 71.07% -> 70.89%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.1221 -> 2.3071   acc: 63.39% -> 59.93%             
client [11] (test)  loss: 2.4758 -> 2.7410   acc: 56.92% -> 57.79%             
client [37] (test)  loss: 2.2776 -> 2.4233   acc: 61.69% -> 61.04%             
client [41] (test)  loss: 1.8505 -> 2.0095   acc: 62.81% -> 62.63%             
client [95] (test)  loss: 2.2229 -> 2.4863   acc: 60.63% -> 62.95%             
client [53] (test)  loss: 2.5404 -> 2.5256   acc: 60.85% -> 61.82%             
client [22] (test)  loss: 1.9890 -> 2.1578   acc: 64.50% -> 64.69%             
client [25] (test)  loss: 2.5154 -> 2.6136   acc: 55.65% -> 54.96%             
client [69] (test)  loss: 2.9315 -> 3.1810   acc: 52.93% -> 52.93%             
client [46] (test)  loss: 1.8096 -> 1.9502   acc: 64.32% -> 63.24%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.6505 -> 1.6637   acc: 72.69% -> 72.51%             
client [69] (test)  loss: 3.1421 -> 3.3256   acc: 53.19% -> 51.33%             
client [82] (test)  loss: 2.3190 -> 2.5326   acc: 62.99% -> 63.47%             
client [45] (test)  loss: 2.6243 -> 2.4753   acc: 57.40% -> 57.81%             
client [7] (test)  loss: 2.7992 -> 2.5190   acc: 57.27% -> 55.66%              
client [50] (test)  loss: 2.1650 -> 1.9824   acc: 62.52% -> 63.90%             
client [35] (test)  loss: 2.2735 -> 2.3750   acc: 61.65% -> 61.85%             
client [24] (test)  loss: 2.7128 -> 2.7327   acc: 60.55% -> 60.27%             
client [15] (test)  loss: 2.4145 -> 2.5186   acc: 60.49% -> 59.79%             
client [58] (test)  loss: 2.8581 -> 3.0913   acc: 54.24% -> 54.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.8465 -> 1.8290   acc: 70.24% -> 70.90%             
client [76] (test)  loss: 2.4778 -> 2.5902   acc: 62.00% -> 61.27%             
client [67] (test)  loss: 2.3143 -> 2.2717   acc: 63.32% -> 63.49%             
client [37] (test)  loss: 2.5932 -> 2.5632   acc: 61.20% -> 62.01%             
client [58] (test)  loss: 3.0521 -> 3.1854   acc: 53.18% -> 54.24%             
client [64] (test)  loss: 2.1336 -> 1.9087   acc: 65.02% -> 65.02%             
client [77] (test)  loss: 2.1713 -> 2.2869   acc: 66.15% -> 66.15%             
client [55] (test)  loss: 2.5132 -> 2.5263   acc: 62.59% -> 62.41%             
client [12] (test)  loss: 2.3040 -> 2.3775   acc: 65.44% -> 65.75%             
client [89] (test)  loss: 2.6733 -> 2.7154   acc: 58.95% -> 56.96%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.5427 -> 2.6595   acc: 63.30% -> 63.48%             
client [51] (test)  loss: 2.3979 -> 2.3757   acc: 62.18% -> 62.00%             
client [8] (test)  loss: 2.1819 -> 2.3532   acc: 67.89% -> 67.73%              
client [18] (test)  loss: 2.7244 -> 3.0012   acc: 60.47% -> 58.50%             
client [94] (test)  loss: 2.5223 -> 2.4370   acc: 62.48% -> 63.02%             
client [81] (test)  loss: 2.1249 -> 2.1733   acc: 65.12% -> 64.59%             
client [3] (test)  loss: 2.2105 -> 2.2653   acc: 64.54% -> 64.54%              
client [11] (test)  loss: 2.8742 -> 3.0279   acc: 58.48% -> 58.48%             
client [95] (test)  loss: 2.4787 -> 2.6683   acc: 61.05% -> 62.32%             
client [67] (test)  loss: 2.2337 -> 2.2919   acc: 63.49% -> 62.08%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.8556 -> 2.4564   acc: 57.40% -> 58.00%             
client [79] (test)  loss: 3.4424 -> 3.4803   acc: 48.93% -> 48.29%             
client [58] (test)  loss: 3.1479 -> 3.2803   acc: 54.06% -> 54.77%             
client [88] (test)  loss: 2.5750 -> 2.5175   acc: 59.56% -> 60.07%             
client [46] (test)  loss: 2.0641 -> 2.2130   acc: 64.86% -> 62.34%             
client [11] (test)  loss: 2.9471 -> 3.0877   acc: 57.79% -> 57.96%             
client [55] (test)  loss: 2.5370 -> 2.6252   acc: 63.32% -> 63.14%             
client [13] (test)  loss: 2.7474 -> 2.9060   acc: 62.29% -> 62.46%             
client [31] (test)  loss: 1.7269 -> 1.8809   acc: 72.30% -> 73.00%             
client [75] (test)  loss: 2.5290 -> 2.6683   acc: 61.74% -> 62.09%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.8439 -> 2.9866   acc: 58.99% -> 58.99%             
client [7] (test)  loss: 3.1630 -> 3.1676   acc: 57.81% -> 57.27%              
client [57] (test)  loss: 3.0692 -> 3.0989   acc: 54.73% -> 56.18%             
client [13] (test)  loss: 2.8903 -> 3.0006   acc: 61.09% -> 62.63%             
client [43] (test)  loss: 2.9524 -> 2.8115   acc: 61.18% -> 60.86%             
client [91] (test)  loss: 2.2856 -> 2.1128   acc: 65.48% -> 63.28%             
client [10] (test)  loss: 2.5263 -> 2.6234   acc: 64.37% -> 64.55%             
client [64] (test)  loss: 2.2654 -> 2.3080   acc: 65.02% -> 65.51%             
client [82] (test)  loss: 2.5348 -> 2.6998   acc: 63.96% -> 64.12%             
client [22] (test)  loss: 2.3958 -> 2.4911   acc: 65.29% -> 66.07%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.1702 -> 2.2856   acc: 65.05% -> 65.22%             
client [23] (test)  loss: 2.0356 -> 1.8476   acc: 69.03% -> 66.37%             
client [88] (test)  loss: 2.7275 -> 2.8360   acc: 60.24% -> 60.75%             
client [98] (test)  loss: 2.4103 -> 2.5078   acc: 66.73% -> 66.73%             
client [79] (test)  loss: 3.5777 -> 3.6484   acc: 50.85% -> 49.57%             
client [21] (test)  loss: 3.0137 -> 2.6211   acc: 57.20% -> 59.20%             
client [92] (test)  loss: 2.3529 -> 2.3982   acc: 63.15% -> 63.67%             
client [56] (test)  loss: 3.2774 -> 3.3968   acc: 52.31% -> 53.20%             
client [5] (test)  loss: 2.5289 -> 2.6855   acc: 61.98% -> 61.98%              
client [52] (test)  loss: 2.5396 -> 2.6246   acc: 63.48% -> 63.83%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '2.0934 -> 0.0000', 'accuracy': '60.61% -> 0.00%'},          
    200: {'loss': '2.7031 -> 0.0000', 'accuracy': '61.61% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 20.0%(20.27%) at epoch: 7                                      
FedPer achieved 30.0%(31.21%) at epoch: 13                                     
FedPer achieved 40.0%(40.06%) at epoch: 18                                     
FedPer achieved 50.0%(52.44%) at epoch: 28                                     
FedPer achieved 60.0%(61.57%) at epoch: 74                                     
Convergence (test_after):                                                      
FedPer achieved 10.0%(17.80%) at epoch: 0                                      
FedPer achieved 20.0%(20.95%) at epoch: 1                                      
FedPer achieved 30.0%(36.06%) at epoch: 2                                      
FedPer achieved 40.0%(43.98%) at epoch: 3                                      
FedPer achieved 50.0%(53.34%) at epoch: 7                                      
FedPer achieved 60.0%(61.01%) at epoch: 35                                     
