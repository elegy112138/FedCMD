==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5279 -> 0.4971   acc: 84.52% -> 85.31%             
client [81] (test)  loss: 0.3027 -> 0.1241   acc: 92.06% -> 96.96%             
client [21] (test)  loss: 2.0897 -> 0.4630   acc: 35.03% -> 87.52%             
client [68] (test)  loss: 1.5911 -> 0.4591   acc: 40.20% -> 83.88%             
client [93] (test)  loss: 1.0780 -> 0.4215   acc: 61.45% -> 87.90%             
client [31] (test)  loss: 7.6922 -> 0.7418   acc: 41.98% -> 70.37%             
client [20] (test)  loss: 0.5692 -> 0.3204   acc: 83.54% -> 92.00%             
client [59] (test)  loss: 1.9537 -> 1.0981   acc: 38.97% -> 62.49%             
client [48] (test)  loss: 1.8785 -> 0.8711   acc: 22.22% -> 66.67%             
client [34] (test)  loss: 0.5744 -> 0.0481   acc: 83.39% -> 99.32%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5397 -> 1.5199   acc: 55.17% -> 62.07%             
client [99] (test)  loss: 0.9462 -> 0.3394   acc: 68.10% -> 91.45%             
client [67] (test)  loss: 0.6835 -> 0.3965   acc: 78.45% -> 89.43%             
client [0] (test)  loss: 0.4868 -> 0.5183   acc: 84.38% -> 86.00%              
client [76] (test)  loss: 0.9822 -> 0.9636   acc: 65.30% -> 67.12%             
client [41] (test)  loss: 1.2862 -> 1.0382   acc: 53.73% -> 68.51%             
client [62] (test)  loss: 1.9343 -> 0.1573   acc: 30.56% -> 95.92%             
client [2] (test)  loss: 1.5982 -> 0.2939   acc: 43.33% -> 96.67%              
client [14] (test)  loss: 1.0727 -> 1.1321   acc: 64.11% -> 68.84%             
client [46] (test)  loss: 0.1238 -> 0.0076   acc: 96.16% -> 99.86%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9476 -> 0.7106   acc: 65.77% -> 70.72%             
client [68] (test)  loss: 0.7007 -> 0.5421   acc: 72.63% -> 84.80%             
client [57] (test)  loss: 0.4992 -> 0.3845   acc: 90.00% -> 90.00%             
client [17] (test)  loss: 0.7119 -> 0.5449   acc: 75.58% -> 86.17%             
client [54] (test)  loss: 0.4729 -> 0.4496   acc: 83.35% -> 90.02%             
client [23] (test)  loss: 1.3576 -> 0.0984   acc: 57.30% -> 98.57%             
client [35] (test)  loss: 0.9238 -> 0.8373   acc: 72.43% -> 74.16%             
client [59] (test)  loss: 1.2365 -> 1.3596   acc: 63.36% -> 62.69%             
client [31] (test)  loss: 2.1399 -> 0.6075   acc: 54.32% -> 80.25%             
client [9] (test)  loss: 0.2713 -> 0.1972   acc: 91.16% -> 94.83%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9931 -> 0.8784   acc: 68.51% -> 79.72%             
client [33] (test)  loss: 0.0119 -> 0.0005   acc: 99.76% -> 100.00%            
client [16] (test)  loss: 1.0956 -> 0.9662   acc: 69.11% -> 71.54%             
client [44] (test)  loss: 0.6211 -> 0.3432   acc: 81.49% -> 90.26%             
client [8] (test)  loss: 0.1880 -> 0.2171   acc: 96.73% -> 97.09%              
client [31] (test)  loss: 2.1219 -> 0.6164   acc: 56.79% -> 76.54%             
client [47] (test)  loss: 0.5636 -> 0.5478   acc: 84.70% -> 86.25%             
client [36] (test)  loss: 0.9662 -> 0.4002   acc: 67.91% -> 89.57%             
client [20] (test)  loss: 0.2731 -> 0.3224   acc: 92.84% -> 94.02%             
client [56] (test)  loss: 0.9456 -> 0.9942   acc: 68.33% -> 72.04%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4516 -> 0.4204   acc: 85.38% -> 91.69%              
client [60] (test)  loss: 0.7523 -> 0.7157   acc: 77.57% -> 83.12%             
client [28] (test)  loss: 0.0007 -> 0.0002   acc: 100.00% -> 100.00%           
client [25] (test)  loss: 0.6572 -> 0.6557   acc: 82.13% -> 86.67%             
client [58] (test)  loss: 0.7490 -> 0.8730   acc: 77.61% -> 75.91%             
client [44] (test)  loss: 0.3379 -> 0.3558   acc: 90.70% -> 91.05%             
client [39] (test)  loss: 0.3075 -> 0.3397   acc: 90.96% -> 91.68%             
client [29] (test)  loss: 0.0473 -> 0.0282   acc: 99.14% -> 99.71%             
client [3] (test)  loss: 0.8563 -> 0.7121   acc: 72.93% -> 77.13%              
client [84] (test)  loss: 0.4318 -> 0.4978   acc: 89.48% -> 90.08%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6121 -> 0.5124   acc: 83.36% -> 90.34%             
client [84] (test)  loss: 0.4871 -> 0.5331   acc: 89.84% -> 89.72%             
client [10] (test)  loss: 0.4846 -> 0.4833   acc: 86.24% -> 88.39%             
client [36] (test)  loss: 0.4004 -> 0.4126   acc: 88.78% -> 89.37%             
client [65] (test)  loss: 0.0191 -> 0.0010   acc: 99.43% -> 100.00%            
client [81] (test)  loss: 0.1102 -> 0.1398   acc: 97.40% -> 97.84%             
client [79] (test)  loss: 0.6230 -> 0.6560   acc: 81.53% -> 81.53%             
client [42] (test)  loss: 0.4788 -> 0.4633   acc: 86.12% -> 85.41%             
client [11] (test)  loss: 0.1137 -> 0.0813   acc: 96.81% -> 97.94%             
client [96] (test)  loss: 0.7186 -> 0.7501   acc: 79.01% -> 82.45%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1855 -> 0.2241   acc: 96.12% -> 96.73%              
client [53] (test)  loss: 0.2476 -> 0.2914   acc: 92.21% -> 93.29%             
client [52] (test)  loss: 0.5054 -> 0.5349   acc: 86.56% -> 87.37%             
client [42] (test)  loss: 0.4462 -> 0.4365   acc: 84.70% -> 85.77%             
client [69] (test)  loss: 1.3941 -> 1.4964   acc: 62.07% -> 60.92%             
client [59] (test)  loss: 1.3053 -> 1.4731   acc: 66.62% -> 65.89%             
client [7] (test)  loss: 0.0109 -> 0.0004   acc: 99.67% -> 100.00%             
client [26] (test)  loss: 0.6061 -> 0.6484   acc: 84.20% -> 83.56%             
client [49] (test)  loss: 0.5285 -> 0.6000   acc: 85.29% -> 86.23%             
client [98] (test)  loss: 0.7955 -> 0.7786   acc: 74.37% -> 78.05%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7960 -> 0.7850   acc: 74.62% -> 78.30%             
client [47] (test)  loss: 0.5532 -> 0.5587   acc: 86.47% -> 86.70%             
client [21] (test)  loss: 0.5619 -> 0.5346   acc: 85.64% -> 89.93%             
client [77] (test)  loss: 0.3750 -> 0.4629   acc: 89.16% -> 88.59%             
client [95] (test)  loss: 0.3498 -> 0.3809   acc: 89.53% -> 93.44%             
client [91] (test)  loss: 0.8925 -> 0.9172   acc: 78.06% -> 78.96%             
client [14] (test)  loss: 1.1857 -> 1.1380   acc: 70.39% -> 72.84%             
client [99] (test)  loss: 0.4029 -> 0.3300   acc: 86.52% -> 92.14%             
client [20] (test)  loss: 0.2798 -> 0.3435   acc: 94.31% -> 94.93%             
client [39] (test)  loss: 0.3218 -> 0.3775   acc: 91.37% -> 91.68%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5200 -> 0.5455   acc: 87.03% -> 86.99%             
client [62] (test)  loss: 0.2285 -> 0.1949   acc: 95.01% -> 96.56%             
client [71] (test)  loss: 1.0270 -> 1.1048   acc: 74.66% -> 75.73%             
client [97] (test)  loss: 0.8061 -> 0.6537   acc: 74.52% -> 81.94%             
client [30] (test)  loss: 0.2542 -> 0.2213   acc: 93.24% -> 95.63%             
client [88] (test)  loss: 0.4099 -> 0.3814   acc: 88.67% -> 90.44%             
client [60] (test)  loss: 0.6933 -> 0.7890   acc: 83.81% -> 84.67%             
client [82] (test)  loss: 0.9189 -> 0.9929   acc: 75.84% -> 77.91%             
client [91] (test)  loss: 0.8459 -> 0.9456   acc: 78.71% -> 79.53%             
client [57] (test)  loss: 0.4640 -> 0.5101   acc: 90.00% -> 85.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4764 -> 0.5618   acc: 83.95% -> 82.72%             
client [15] (test)  loss: 0.3961 -> 0.4591   acc: 91.76% -> 92.02%             
client [71] (test)  loss: 1.0995 -> 1.1241   acc: 72.95% -> 75.45%             
client [97] (test)  loss: 0.7092 -> 0.6437   acc: 80.65% -> 82.90%             
client [53] (test)  loss: 0.2650 -> 0.3295   acc: 92.99% -> 93.29%             
client [77] (test)  loss: 0.3639 -> 0.4338   acc: 89.87% -> 88.80%             
client [76] (test)  loss: 1.1277 -> 1.1427   acc: 71.50% -> 73.38%             
client [79] (test)  loss: 0.7462 -> 0.7555   acc: 82.65% -> 80.60%             
client [28] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [99] (test)  loss: 0.3670 -> 0.3368   acc: 87.83% -> 91.91%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7191 -> 0.6687   acc: 78.06% -> 82.26%             
client [86] (test)  loss: 0.3375 -> 0.3138   acc: 94.00% -> 94.00%             
client [34] (test)  loss: 0.0625 -> 0.0729   acc: 99.28% -> 99.32%             
client [73] (test)  loss: 0.2984 -> 0.3568   acc: 92.55% -> 93.70%             
client [5] (test)  loss: 0.6827 -> 0.8172   acc: 80.53% -> 83.76%              
client [96] (test)  loss: 0.8315 -> 0.8842   acc: 81.72% -> 82.85%             
client [22] (test)  loss: 0.4824 -> 0.5484   acc: 88.15% -> 87.17%             
client [60] (test)  loss: 0.7136 -> 0.8588   acc: 83.87% -> 84.55%             
client [66] (test)  loss: 1.3051 -> 1.2771   acc: 67.52% -> 68.01%             
client [83] (test)  loss: 0.0034 -> 0.0010   acc: 99.89% -> 99.95%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.2360 -> 1.2717   acc: 70.89% -> 71.50%             
client [65] (test)  loss: 0.0122 -> 0.0018   acc: 99.50% -> 99.94%             
client [95] (test)  loss: 0.3615 -> 0.4082   acc: 90.07% -> 93.26%             
client [17] (test)  loss: 0.6174 -> 0.6662   acc: 85.02% -> 86.55%             
client [8] (test)  loss: 0.1993 -> 0.2284   acc: 95.88% -> 96.97%              
client [35] (test)  loss: 0.8870 -> 0.9634   acc: 77.04% -> 78.00%             
client [98] (test)  loss: 0.8717 -> 0.7777   acc: 76.27% -> 78.68%             
client [53] (test)  loss: 0.2736 -> 0.3526   acc: 92.81% -> 93.47%             
client [43] (test)  loss: 0.4149 -> 0.5023   acc: 89.94% -> 89.51%             
client [64] (test)  loss: 0.9017 -> 0.9579   acc: 77.58% -> 81.61%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5542 -> 0.5602   acc: 89.26% -> 90.07%             
client [88] (test)  loss: 0.4529 -> 0.4213   acc: 88.49% -> 91.27%             
client [38] (test)  loss: 0.2744 -> 0.2949   acc: 93.68% -> 95.81%             
client [3] (test)  loss: 1.0839 -> 0.9087   acc: 75.89% -> 79.02%              
client [5] (test)  loss: 0.7619 -> 0.8589   acc: 80.79% -> 83.83%              
client [41] (test)  loss: 1.0445 -> 1.1927   acc: 71.10% -> 71.43%             
client [7] (test)  loss: 0.0077 -> 0.0016   acc: 99.73% -> 99.97%              
client [37] (test)  loss: 0.2370 -> 0.2868   acc: 94.56% -> 94.14%             
client [45] (test)  loss: 0.7344 -> 0.6758   acc: 80.45% -> 81.01%             
client [47] (test)  loss: 0.6068 -> 0.5972   acc: 86.70% -> 86.70%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0307 -> 1.1175   acc: 77.24% -> 75.61%             
client [11] (test)  loss: 0.0848 -> 0.0857   acc: 97.94% -> 97.80%             
client [37] (test)  loss: 0.2543 -> 0.2868   acc: 93.72% -> 92.89%             
client [41] (test)  loss: 1.0146 -> 1.1954   acc: 70.45% -> 72.56%             
client [95] (test)  loss: 0.3610 -> 0.4208   acc: 90.83% -> 93.02%             
client [53] (test)  loss: 0.2944 -> 0.3558   acc: 92.51% -> 93.05%             
client [22] (test)  loss: 0.4781 -> 0.5852   acc: 87.17% -> 85.90%             
client [25] (test)  loss: 0.6036 -> 0.7019   acc: 86.99% -> 87.68%             
client [69] (test)  loss: 1.5152 -> 1.7238   acc: 65.52% -> 62.07%             
client [46] (test)  loss: 0.0166 -> 0.0050   acc: 99.35% -> 99.93%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6147 -> 0.6474   acc: 87.14% -> 87.14%             
client [69] (test)  loss: 1.5833 -> 1.6314   acc: 65.52% -> 60.92%             
client [82] (test)  loss: 0.9351 -> 1.0739   acc: 76.91% -> 78.48%             
client [45] (test)  loss: 0.6783 -> 0.7329   acc: 80.17% -> 81.01%             
client [7] (test)  loss: 0.0060 -> 0.0019   acc: 99.79% -> 99.91%              
client [50] (test)  loss: 0.5846 -> 0.7066   acc: 88.00% -> 74.00%             
client [35] (test)  loss: 0.9390 -> 1.0281   acc: 75.89% -> 78.19%             
client [24] (test)  loss: 0.8228 -> 0.8086   acc: 69.82% -> 72.07%             
client [15] (test)  loss: 0.4114 -> 0.4608   acc: 93.35% -> 92.55%             
client [58] (test)  loss: 0.9759 -> 1.0642   acc: 77.85% -> 77.38%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4229 -> 0.4875   acc: 85.19% -> 88.89%             
client [76] (test)  loss: 1.4299 -> 1.3571   acc: 71.23% -> 72.51%             
client [67] (test)  loss: 0.4282 -> 0.4886   acc: 89.79% -> 91.16%             
client [37] (test)  loss: 0.2712 -> 0.2915   acc: 93.72% -> 92.89%             
client [58] (test)  loss: 1.0805 -> 1.1039   acc: 78.08% -> 78.00%             
client [64] (test)  loss: 0.9373 -> 1.0042   acc: 79.47% -> 81.36%             
client [77] (test)  loss: 0.4173 -> 0.4811   acc: 88.80% -> 89.66%             
client [55] (test)  loss: 0.2410 -> 0.2838   acc: 94.29% -> 95.25%             
client [12] (test)  loss: 0.9752 -> 1.0209   acc: 77.57% -> 79.31%             
client [89] (test)  loss: 0.9406 -> 1.0239   acc: 77.79% -> 80.53%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6198 -> 0.6555   acc: 90.45% -> 90.45%             
client [51] (test)  loss: 0.1295 -> 0.1533   acc: 97.45% -> 97.08%             
client [8] (test)  loss: 0.2397 -> 0.2515   acc: 95.76% -> 96.85%              
client [18] (test)  loss: 0.0897 -> 0.1082   acc: 97.32% -> 97.24%             
client [94] (test)  loss: 1.1069 -> 1.1453   acc: 74.27% -> 77.67%             
client [81] (test)  loss: 0.1357 -> 0.1516   acc: 97.99% -> 98.24%             
client [3] (test)  loss: 1.1040 -> 1.0448   acc: 77.66% -> 79.08%              
client [11] (test)  loss: 0.0855 -> 0.0799   acc: 97.80% -> 98.27%             
client [95] (test)  loss: 0.4018 -> 0.4498   acc: 91.96% -> 93.02%             
client [67] (test)  loss: 0.4593 -> 0.4862   acc: 88.34% -> 91.25%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6125 -> 0.6020   acc: 89.13% -> 90.20%             
client [79] (test)  loss: 0.9911 -> 0.8692   acc: 82.09% -> 80.60%             
client [58] (test)  loss: 1.1538 -> 1.1406   acc: 78.00% -> 77.54%             
client [88] (test)  loss: 0.5134 -> 0.4574   acc: 88.12% -> 90.34%             
client [46] (test)  loss: 0.0097 -> 0.0054   acc: 99.71% -> 99.93%             
client [11] (test)  loss: 0.0792 -> 0.0810   acc: 98.07% -> 98.27%             
client [55] (test)  loss: 0.2563 -> 0.2869   acc: 95.05% -> 95.46%             
client [13] (test)  loss: 0.2537 -> 0.2399   acc: 95.99% -> 96.27%             
client [31] (test)  loss: 0.5669 -> 0.6304   acc: 86.42% -> 83.95%             
client [75] (test)  loss: 1.3349 -> 1.2671   acc: 74.26% -> 73.60%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.1728 -> 1.0936   acc: 75.90% -> 79.83%             
client [7] (test)  loss: 0.0034 -> 0.0023   acc: 99.91% -> 99.97%              
client [57] (test)  loss: 0.6233 -> 0.6260   acc: 85.00% -> 85.00%             
client [13] (test)  loss: 0.2667 -> 0.2447   acc: 95.75% -> 96.52%             
client [43] (test)  loss: 0.5118 -> 0.5199   acc: 89.94% -> 90.58%             
client [91] (test)  loss: 1.0634 -> 1.0194   acc: 77.57% -> 78.71%             
client [10] (test)  loss: 0.5829 -> 0.6093   acc: 88.70% -> 89.25%             
client [64] (test)  loss: 1.0017 -> 1.0777   acc: 80.10% -> 81.23%             
client [82] (test)  loss: 1.1545 -> 1.1761   acc: 75.98% -> 78.56%             
client [22] (test)  loss: 0.5642 -> 0.6030   acc: 87.87% -> 88.15%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3468 -> 0.3911   acc: 94.87% -> 95.10%             
client [23] (test)  loss: 0.1072 -> 0.1195   acc: 97.73% -> 98.74%             
client [88] (test)  loss: 0.4935 -> 0.4761   acc: 89.04% -> 89.69%             
client [98] (test)  loss: 0.9968 -> 0.9551   acc: 75.51% -> 77.79%             
client [79] (test)  loss: 0.8861 -> 0.9431   acc: 82.46% -> 81.34%             
client [21] (test)  loss: 0.6158 -> 0.6361   acc: 89.80% -> 90.20%             
client [92] (test)  loss: 0.4231 -> 0.4490   acc: 92.66% -> 92.17%             
client [56] (test)  loss: 1.5021 -> 1.2120   acc: 72.58% -> 75.20%             
client [5] (test)  loss: 0.8921 -> 1.0016   acc: 79.54% -> 83.10%              
client [52] (test)  loss: 0.6753 -> 0.6890   acc: 87.61% -> 87.13%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4305 -> 0.0000', 'accuracy': '89.28% -> 0.00%'},          
    200: {'loss': '0.5251 -> 0.0000', 'accuracy': '89.62% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(15.86%) at epoch: 0                                      
FedPer achieved 30.0%(39.40%) at epoch: 2                                      
FedPer achieved 40.0%(42.05%) at epoch: 4                                      
FedPer achieved 70.0%(70.27%) at epoch: 7                                      
FedPer achieved 80.0%(80.01%) at epoch: 23                                     
FedPer achieved 90.0%(90.91%) at epoch: 56                                     
Convergence (test_after):                                                      
FedPer achieved 80.0%(86.16%) at epoch: 0                                      
FedPer achieved 90.0%(90.39%) at epoch: 5                                      
