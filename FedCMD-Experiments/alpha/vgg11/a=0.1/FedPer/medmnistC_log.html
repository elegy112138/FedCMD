==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7077 -> 0.7223   acc: 75.65% -> 75.65%             
client [81] (test)  loss: 1.6827 -> 1.3777   acc: 26.09% -> 47.83%             
client [21] (test)  loss: 2.3759 -> 1.3257   acc: 0.00% -> 58.62%              
client [68] (test)  loss: 0.3269 -> 0.3297   acc: 89.80% -> 89.80%             
client [93] (test)  loss: 0.8559 -> 0.5564   acc: 81.32% -> 82.42%             
client [31] (test)  loss: 2.3956 -> 0.4864   acc: 0.00% -> 86.67%              
client [20] (test)  loss: 0.5291 -> 0.4232   acc: 85.22% -> 87.83%             
client [59] (test)  loss: 2.0951 -> 0.0390   acc: 0.00% -> 100.00%             
client [48] (test)  loss: 0.5134 -> 0.4477   acc: 83.76% -> 87.18%             
client [34] (test)  loss: 1.3896 -> 0.9133   acc: 47.97% -> 71.54%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.2750 -> 0.1926   acc: 91.05% -> 93.86%             
client [99] (test)  loss: 0.2769 -> 0.2509   acc: 95.31% -> 95.31%             
client [67] (test)  loss: 0.2234 -> 0.1835   acc: 97.80% -> 97.80%             
client [0] (test)  loss: 0.8760 -> 0.9628   acc: 62.71% -> 44.07%              
client [76] (test)  loss: 0.5130 -> 0.2766   acc: 88.89% -> 91.67%             
client [41] (test)  loss: 0.5102 -> 0.5057   acc: 87.38% -> 87.38%             
client [62] (test)  loss: 1.0797 -> 0.0024   acc: 83.22% -> 100.00%            
client [2] (test)  loss: 2.3521 -> 0.2706   acc: 17.81% -> 94.52%              
client [14] (test)  loss: 1.0080 -> 0.9830   acc: 60.56% -> 59.15%             
client [46] (test)  loss: 0.6187 -> 0.5609   acc: 79.75% -> 82.28%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.1910 -> 0.1352   acc: 93.55% -> 95.97%             
client [68] (test)  loss: 0.2177 -> 0.2959   acc: 90.82% -> 90.82%             
client [57] (test)  loss: 0.2669 -> 0.2226   acc: 94.07% -> 95.76%             
client [17] (test)  loss: 0.7389 -> 0.6289   acc: 79.79% -> 77.66%             
client [54] (test)  loss: 0.7951 -> 0.7316   acc: 75.65% -> 76.52%             
client [23] (test)  loss: 1.2096 -> 0.8118   acc: 53.70% -> 62.96%             
client [35] (test)  loss: 0.1240 -> 0.0800   acc: 96.43% -> 100.00%            
client [59] (test)  loss: 0.0301 -> 0.0274   acc: 99.18% -> 99.18%             
client [31] (test)  loss: 0.2407 -> 0.2661   acc: 94.44% -> 94.44%             
client [9] (test)  loss: 0.1620 -> 0.1221   acc: 95.24% -> 95.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3239 -> 0.1605   acc: 89.47% -> 96.49%             
client [33] (test)  loss: 0.4685 -> 0.4338   acc: 88.14% -> 91.53%             
client [16] (test)  loss: 0.5013 -> 0.4007   acc: 81.08% -> 89.19%             
client [44] (test)  loss: 0.1859 -> 0.1305   acc: 94.69% -> 94.69%             
client [8] (test)  loss: 0.4517 -> 0.3557   acc: 78.08% -> 89.04%              
client [31] (test)  loss: 0.2312 -> 0.1916   acc: 95.56% -> 95.56%             
client [47] (test)  loss: 0.1955 -> 0.1406   acc: 93.33% -> 92.00%             
client [36] (test)  loss: 0.3844 -> 0.2021   acc: 88.57% -> 93.14%             
client [20] (test)  loss: 0.2003 -> 0.1558   acc: 94.78% -> 97.39%             
client [56] (test)  loss: 0.4088 -> 0.2280   acc: 88.37% -> 93.02%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1388 -> 0.0847   acc: 96.15% -> 96.15%              
client [60] (test)  loss: 0.2499 -> 0.2178   acc: 91.11% -> 91.11%             
client [28] (test)  loss: 0.4092 -> 0.4812   acc: 88.00% -> 88.00%             
client [25] (test)  loss: 0.4263 -> 0.6105   acc: 83.91% -> 78.16%             
client [58] (test)  loss: 0.2088 -> 0.0969   acc: 96.30% -> 96.30%             
client [44] (test)  loss: 0.1027 -> 0.0923   acc: 97.10% -> 97.58%             
client [39] (test)  loss: 0.4989 -> 0.4429   acc: 79.20% -> 77.60%             
client [29] (test)  loss: 0.6393 -> 0.6036   acc: 80.36% -> 83.93%             
client [3] (test)  loss: 0.0717 -> 0.0671   acc: 98.37% -> 98.37%              
client [84] (test)  loss: 0.5452 -> 0.5484   acc: 78.05% -> 75.61%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6424 -> 0.7062   acc: 79.31% -> 79.31%             
client [84] (test)  loss: 0.5116 -> 0.4938   acc: 78.05% -> 82.93%             
client [10] (test)  loss: 0.2339 -> 0.2452   acc: 94.74% -> 93.68%             
client [36] (test)  loss: 0.1263 -> 0.0921   acc: 96.57% -> 98.29%             
client [65] (test)  loss: 0.1467 -> 0.1546   acc: 95.83% -> 96.67%             
client [81] (test)  loss: 1.0459 -> 1.1527   acc: 56.52% -> 60.87%             
client [79] (test)  loss: 0.0433 -> 0.0454   acc: 98.32% -> 98.66%             
client [42] (test)  loss: 0.1965 -> 0.2505   acc: 94.34% -> 93.96%             
client [11] (test)  loss: 0.1815 -> 0.4202   acc: 93.62% -> 85.11%             
client [96] (test)  loss: 0.1217 -> 0.1366   acc: 98.53% -> 98.53%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2721 -> 0.2194   acc: 89.04% -> 93.15%              
client [53] (test)  loss: 0.1612 -> 0.1641   acc: 97.10% -> 95.65%             
client [52] (test)  loss: 0.6121 -> 0.4376   acc: 76.92% -> 76.92%             
client [42] (test)  loss: 0.2176 -> 0.2582   acc: 93.96% -> 93.96%             
client [69] (test)  loss: 0.1147 -> 0.0928   acc: 95.91% -> 96.93%             
client [59] (test)  loss: 0.0225 -> 0.0164   acc: 99.18% -> 99.18%             
client [7] (test)  loss: 0.5338 -> 0.4960   acc: 81.61% -> 83.91%              
client [26] (test)  loss: 0.0625 -> 0.0525   acc: 98.62% -> 98.62%             
client [49] (test)  loss: 0.0469 -> 0.0570   acc: 98.50% -> 98.05%             
client [98] (test)  loss: 0.0901 -> 0.0969   acc: 98.65% -> 97.30%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.0928 -> 0.0877   acc: 98.65% -> 98.65%             
client [47] (test)  loss: 0.0446 -> 0.0599   acc: 97.33% -> 97.33%             
client [21] (test)  loss: 0.5590 -> 0.6141   acc: 82.76% -> 86.21%             
client [77] (test)  loss: 0.3628 -> 0.3950   acc: 93.04% -> 87.83%             
client [95] (test)  loss: 0.1544 -> 0.1577   acc: 97.62% -> 95.24%             
client [91] (test)  loss: 0.7967 -> 0.5999   acc: 70.14% -> 79.17%             
client [14] (test)  loss: 0.6051 -> 0.6167   acc: 74.65% -> 73.24%             
client [99] (test)  loss: 0.1073 -> 0.1168   acc: 96.88% -> 95.31%             
client [20] (test)  loss: 0.0668 -> 0.0480   acc: 98.26% -> 98.26%             
client [39] (test)  loss: 0.3758 -> 0.3528   acc: 85.60% -> 81.60%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5425 -> 0.4231   acc: 76.92% -> 76.92%             
client [62] (test)  loss: 0.0033 -> 0.0011   acc: 100.00% -> 100.00%           
client [71] (test)  loss: 0.0367 -> 0.0390   acc: 99.19% -> 99.19%             
client [97] (test)  loss: 0.3179 -> 0.3041   acc: 91.82% -> 91.19%             
client [30] (test)  loss: 0.1204 -> 0.1159   acc: 97.33% -> 97.86%             
client [88] (test)  loss: 0.4610 -> 0.4817   acc: 81.25% -> 81.25%             
client [60] (test)  loss: 0.2179 -> 0.2402   acc: 91.11% -> 91.11%             
client [82] (test)  loss: 0.0008 -> 0.0014   acc: 100.00% -> 100.00%           
client [91] (test)  loss: 0.6631 -> 0.5608   acc: 76.39% -> 79.17%             
client [57] (test)  loss: 0.1424 -> 0.1539   acc: 96.61% -> 96.61%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0972 -> 0.0923   acc: 96.67% -> 97.78%             
client [15] (test)  loss: 0.0499 -> 0.0708   acc: 97.67% -> 97.67%             
client [71] (test)  loss: 0.0391 -> 0.0408   acc: 99.19% -> 99.19%             
client [97] (test)  loss: 0.3265 -> 0.3028   acc: 92.45% -> 89.94%             
client [53] (test)  loss: 0.1790 -> 0.1688   acc: 95.65% -> 95.65%             
client [77] (test)  loss: 0.3469 -> 0.4602   acc: 88.70% -> 83.48%             
client [76] (test)  loss: 0.1327 -> 0.1104   acc: 97.22% -> 97.22%             
client [79] (test)  loss: 0.0367 -> 0.0349   acc: 98.99% -> 99.33%             
client [28] (test)  loss: 0.5504 -> 0.5213   acc: 80.00% -> 80.00%             
client [99] (test)  loss: 0.0960 -> 0.1080   acc: 97.66% -> 96.09%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6615 -> 0.2773   acc: 76.10% -> 89.94%             
client [86] (test)  loss: 0.4508 -> 0.3448   acc: 82.76% -> 90.80%             
client [34] (test)  loss: 0.3313 -> 0.3408   acc: 90.24% -> 91.06%             
client [73] (test)  loss: 0.2249 -> 0.1109   acc: 96.83% -> 96.83%             
client [5] (test)  loss: 1.7221 -> 1.0928   acc: 45.71% -> 65.71%              
client [96] (test)  loss: 0.2010 -> 0.1764   acc: 94.12% -> 97.06%             
client [22] (test)  loss: 0.6693 -> 0.4827   acc: 72.88% -> 84.75%             
client [60] (test)  loss: 0.2855 -> 0.2348   acc: 93.33% -> 91.11%             
client [66] (test)  loss: 0.2058 -> 0.1636   acc: 97.14% -> 97.14%             
client [83] (test)  loss: 0.0133 -> 0.0021   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0799 -> 0.0844   acc: 97.22% -> 97.22%             
client [65] (test)  loss: 0.1172 -> 0.1125   acc: 97.50% -> 97.50%             
client [95] (test)  loss: 0.1409 -> 0.1416   acc: 96.43% -> 96.43%             
client [17] (test)  loss: 0.2016 -> 0.2472   acc: 92.55% -> 91.49%             
client [8] (test)  loss: 0.1690 -> 0.2315   acc: 95.89% -> 94.52%              
client [35] (test)  loss: 0.0068 -> 0.0040   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.0925 -> 0.0715   acc: 98.65% -> 98.65%             
client [53] (test)  loss: 0.1930 -> 0.1649   acc: 97.10% -> 97.10%             
client [43] (test)  loss: 0.0862 -> 0.0869   acc: 95.00% -> 95.00%             
client [64] (test)  loss: 0.1660 -> 0.1396   acc: 94.74% -> 96.49%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5091 -> 0.6964   acc: 82.76% -> 79.31%             
client [88] (test)  loss: 0.4709 -> 0.4958   acc: 84.38% -> 86.46%             
client [38] (test)  loss: 0.0466 -> 0.0581   acc: 99.19% -> 98.39%             
client [3] (test)  loss: 0.0515 -> 0.0529   acc: 99.19% -> 99.19%              
client [5] (test)  loss: 2.8089 -> 1.1547   acc: 42.86% -> 71.43%              
client [41] (test)  loss: 0.0917 -> 0.0673   acc: 96.12% -> 98.06%             
client [7] (test)  loss: 0.4969 -> 0.4877   acc: 86.21% -> 83.91%              
client [37] (test)  loss: 0.0556 -> 0.0635   acc: 98.31% -> 98.31%             
client [45] (test)  loss: 0.0916 -> 0.0579   acc: 95.59% -> 97.36%             
client [47] (test)  loss: 0.0251 -> 0.0331   acc: 98.67% -> 97.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2713 -> 0.2987   acc: 91.89% -> 91.89%             
client [11] (test)  loss: 0.1082 -> 0.1004   acc: 97.87% -> 95.74%             
client [37] (test)  loss: 0.0559 -> 0.0654   acc: 98.60% -> 98.46%             
client [41] (test)  loss: 0.0830 -> 0.0684   acc: 96.12% -> 98.06%             
client [95] (test)  loss: 0.1401 -> 0.1390   acc: 97.62% -> 97.62%             
client [53] (test)  loss: 0.1727 -> 0.1632   acc: 97.10% -> 97.10%             
client [22] (test)  loss: 0.4741 -> 0.4846   acc: 79.66% -> 81.36%             
client [25] (test)  loss: 0.4115 -> 0.5158   acc: 87.36% -> 86.21%             
client [69] (test)  loss: 0.1679 -> 0.0712   acc: 94.88% -> 97.95%             
client [46] (test)  loss: 0.1238 -> 0.1615   acc: 94.94% -> 94.94%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0275 -> 0.0580   acc: 98.67% -> 98.67%             
client [69] (test)  loss: 0.0934 -> 0.0702   acc: 97.19% -> 97.95%             
client [82] (test)  loss: 0.0013 -> 0.0025   acc: 100.00% -> 100.00%           
client [45] (test)  loss: 0.0853 -> 0.0661   acc: 96.48% -> 97.36%             
client [7] (test)  loss: 0.5095 -> 0.5084   acc: 86.21% -> 85.06%              
client [50] (test)  loss: 0.2179 -> 0.2096   acc: 95.00% -> 95.00%             
client [35] (test)  loss: 0.0033 -> 0.0015   acc: 100.00% -> 100.00%           
client [24] (test)  loss: 0.0586 -> 0.0493   acc: 98.39% -> 98.39%             
client [15] (test)  loss: 0.0471 -> 0.0619   acc: 98.84% -> 98.84%             
client [58] (test)  loss: 0.0143 -> 0.0146   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1751 -> 0.1618   acc: 97.44% -> 98.29%             
client [76] (test)  loss: 0.1383 -> 0.0924   acc: 97.22% -> 97.22%             
client [67] (test)  loss: 0.0552 -> 0.0572   acc: 97.80% -> 97.80%             
client [37] (test)  loss: 0.0601 -> 0.0670   acc: 98.46% -> 98.31%             
client [58] (test)  loss: 0.0173 -> 0.0155   acc: 100.00% -> 100.00%           
client [64] (test)  loss: 0.1373 -> 0.1463   acc: 96.49% -> 96.49%             
client [77] (test)  loss: 0.3602 -> 0.4317   acc: 89.57% -> 89.57%             
client [55] (test)  loss: 0.1861 -> 0.2038   acc: 91.84% -> 87.76%             
client [12] (test)  loss: 0.0068 -> 0.0047   acc: 100.00% -> 100.00%           
client [89] (test)  loss: 0.2848 -> 0.3165   acc: 90.35% -> 90.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3286 -> 0.3597   acc: 95.12% -> 92.68%             
client [51] (test)  loss: 0.0268 -> 0.0269   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.1293 -> 0.1459   acc: 97.26% -> 95.89%              
client [18] (test)  loss: 0.2355 -> 0.2344   acc: 92.86% -> 93.65%             
client [94] (test)  loss: 0.3045 -> 0.3715   acc: 89.77% -> 88.64%             
client [81] (test)  loss: 0.8678 -> 1.2694   acc: 73.91% -> 65.22%             
client [3] (test)  loss: 0.0533 -> 0.0546   acc: 99.19% -> 99.19%              
client [11] (test)  loss: 0.1034 -> 0.1107   acc: 95.74% -> 95.74%             
client [95] (test)  loss: 0.1108 -> 0.1137   acc: 97.62% -> 97.62%             
client [67] (test)  loss: 0.0515 -> 0.0527   acc: 97.80% -> 97.80%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6552 -> 0.7752   acc: 79.31% -> 79.31%             
client [79] (test)  loss: 0.0565 -> 0.0396   acc: 97.65% -> 99.33%             
client [58] (test)  loss: 0.0191 -> 0.0154   acc: 100.00% -> 100.00%           
client [88] (test)  loss: 0.4753 -> 0.4530   acc: 84.38% -> 87.50%             
client [46] (test)  loss: 0.1301 -> 0.1557   acc: 93.67% -> 94.94%             
client [11] (test)  loss: 0.1057 -> 0.1094   acc: 93.62% -> 93.62%             
client [55] (test)  loss: 0.2243 -> 0.2209   acc: 91.84% -> 85.71%             
client [13] (test)  loss: 0.1936 -> 0.2558   acc: 91.49% -> 93.62%             
client [31] (test)  loss: 0.0601 -> 0.0504   acc: 96.67% -> 97.78%             
client [75] (test)  loss: 0.1944 -> 0.1771   acc: 94.85% -> 94.85%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3077 -> 0.3024   acc: 93.55% -> 94.35%             
client [7] (test)  loss: 0.5602 -> 0.5771   acc: 83.91% -> 85.06%              
client [57] (test)  loss: 0.1668 -> 0.1905   acc: 96.61% -> 96.61%             
client [13] (test)  loss: 0.2198 -> 0.2736   acc: 91.49% -> 93.62%             
client [43] (test)  loss: 0.0480 -> 0.0482   acc: 95.00% -> 95.00%             
client [91] (test)  loss: 0.5425 -> 0.5538   acc: 82.64% -> 81.25%             
client [10] (test)  loss: 0.1877 -> 0.2037   acc: 94.74% -> 94.74%             
client [64] (test)  loss: 0.1288 -> 0.1579   acc: 96.49% -> 96.49%             
client [82] (test)  loss: 0.0011 -> 0.0013   acc: 100.00% -> 100.00%           
client [22] (test)  loss: 0.4573 -> 0.4884   acc: 83.05% -> 84.75%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0210 -> 0.0176   acc: 100.00% -> 100.00%           
client [23] (test)  loss: 0.3288 -> 0.3296   acc: 87.04% -> 87.04%             
client [88] (test)  loss: 0.4717 -> 0.4664   acc: 87.50% -> 87.50%             
client [98] (test)  loss: 0.0499 -> 0.0562   acc: 98.65% -> 98.65%             
client [79] (test)  loss: 0.0338 -> 0.0373   acc: 98.99% -> 99.33%             
client [21] (test)  loss: 0.5661 -> 0.8785   acc: 86.21% -> 75.86%             
client [92] (test)  loss: 0.0007 -> 0.0003   acc: 100.00% -> 100.00%           
client [56] (test)  loss: 0.1500 -> 0.2018   acc: 93.02% -> 90.70%             
client [5] (test)  loss: 3.3510 -> 1.5520   acc: 54.29% -> 68.57%              
client [52] (test)  loss: 0.8322 -> 0.5893   acc: 74.36% -> 74.36%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1755 -> 0.0000', 'accuracy': '94.58% -> 0.00%'},          
    200: {'loss': '0.1709 -> 0.0000', 'accuracy': '95.37% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 20.0%(23.92%) at epoch: 1                                      
FedPer achieved 30.0%(38.08%) at epoch: 2                                      
FedPer achieved 70.0%(79.24%) at epoch: 7                                      
FedPer achieved 80.0%(88.26%) at epoch: 16                                     
FedPer achieved 90.0%(90.97%) at epoch: 26                                     
Convergence (test_after):                                                      
FedPer achieved 60.0%(61.87%) at epoch: 0                                      
FedPer achieved 70.0%(72.38%) at epoch: 1                                      
FedPer achieved 80.0%(83.50%) at epoch: 5                                      
FedPer achieved 90.0%(90.28%) at epoch: 15                                     
