==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6338 -> 0.1947   acc: 82.96% -> 95.63%             
client [81] (test)  loss: 0.2151 -> 0.2573   acc: 91.73% -> 91.53%             
client [21] (test)  loss: 4.3188 -> 0.1364   acc: 0.00% -> 96.43%              
client [68] (test)  loss: 0.5567 -> 0.5199   acc: 86.07% -> 88.76%             
client [93] (test)  loss: 0.0772 -> 0.0793   acc: 98.05% -> 98.27%             
client [31] (test)  loss: 0.3185 -> 0.2295   acc: 92.26% -> 93.56%             
client [20] (test)  loss: 0.1949 -> 7.7211   acc: 95.67% -> 58.92%             
client [59] (test)  loss: 2.8245 -> 0.3206   acc: 55.56% -> 89.12%             
client [48] (test)  loss: 0.8329 -> 1.1853   acc: 79.23% -> 71.75%             
client [34] (test)  loss: 0.1609 -> 0.1964   acc: 96.24% -> 96.37%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4158 -> 0.4228   acc: 90.20% -> 91.58%             
client [99] (test)  loss: 0.0995 -> 0.1109   acc: 98.37% -> 97.31%             
client [67] (test)  loss: 1.7182 -> 0.6114   acc: 51.60% -> 82.66%             
client [0] (test)  loss: 0.2381 -> 0.2309   acc: 94.52% -> 95.21%              
client [76] (test)  loss: 0.3667 -> 0.4257   acc: 91.64% -> 93.06%             
client [41] (test)  loss: 0.3657 -> 0.3657   acc: 86.59% -> 87.18%             
client [62] (test)  loss: 3.2446 -> 0.1727   acc: 63.27% -> 96.22%             
client [2] (test)  loss: 5.0502 -> 0.2845   acc: 0.32% -> 92.09%               
client [14] (test)  loss: 0.3249 -> 0.4229   acc: 92.37% -> 93.01%             
client [46] (test)  loss: 0.0883 -> 0.0935   acc: 98.88% -> 98.91%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3191 -> 0.4562   acc: 90.46% -> 90.99%             
client [68] (test)  loss: 0.7352 -> 0.6929   acc: 88.40% -> 89.74%             
client [57] (test)  loss: 0.2160 -> 0.2295   acc: 95.43% -> 96.16%             
client [17] (test)  loss: 0.2628 -> 0.2735   acc: 93.94% -> 94.06%             
client [54] (test)  loss: 0.7233 -> 0.7441   acc: 91.79% -> 91.79%             
client [23] (test)  loss: 4.5347 -> 0.3196   acc: 9.68% -> 90.93%              
client [35] (test)  loss: 0.0652 -> 0.0704   acc: 98.84% -> 98.94%             
client [59] (test)  loss: 0.3819 -> 0.4282   acc: 90.15% -> 90.32%             
client [31] (test)  loss: 0.2743 -> 0.3128   acc: 94.27% -> 94.53%             
client [9] (test)  loss: 0.3289 -> 0.3750   acc: 92.77% -> 93.86%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5660 -> 0.5643   acc: 87.93% -> 88.22%             
client [33] (test)  loss: 0.1859 -> 0.1903   acc: 97.84% -> 97.86%             
client [16] (test)  loss: 0.4896 -> 0.5598   acc: 90.03% -> 89.15%             
client [44] (test)  loss: 0.6788 -> 0.5268   acc: 81.49% -> 85.88%             
client [8] (test)  loss: 0.6052 -> 0.5359   acc: 88.48% -> 87.87%              
client [31] (test)  loss: 0.3189 -> 0.3227   acc: 94.36% -> 94.92%             
client [47] (test)  loss: 0.4310 -> 0.4539   acc: 90.67% -> 91.90%             
client [36] (test)  loss: 0.3033 -> 0.2998   acc: 92.76% -> 93.86%             
client [20] (test)  loss: 0.2239 -> 0.2295   acc: 96.60% -> 96.62%             
client [56] (test)  loss: 0.0611 -> 0.0763   acc: 98.56% -> 98.47%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6388 -> 0.7167   acc: 82.46% -> 83.67%              
client [60] (test)  loss: 0.3012 -> 0.3112   acc: 93.87% -> 94.41%             
client [28] (test)  loss: 0.0089 -> 0.0094   acc: 99.87% -> 99.87%             
client [25] (test)  loss: 0.2796 -> 0.2693   acc: 93.95% -> 94.78%             
client [58] (test)  loss: nan -> nan   acc: 0.04% -> 0.04%                     
client [44] (test)  loss: 0.5268 -> 0.5690   acc: 85.88% -> 87.27%             
client [39] (test)  loss: 0.2373 -> 0.2080   acc: 95.68% -> 96.22%             
client [29] (test)  loss: 0.3288 -> 0.3195   acc: 92.14% -> 92.45%             
client [3] (test)  loss: 0.0320 -> 0.0336   acc: 99.61% -> 99.61%              
client [84] (test)  loss: 0.4201 -> 0.4999   acc: 90.63% -> 91.21%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.1469 -> 0.1563   acc: 97.77% -> 97.74%             
client [84] (test)  loss: 0.5529 -> 0.5331   acc: 91.58% -> 91.52%             
client [10] (test)  loss: 0.6830 -> 0.7721   acc: 83.73% -> 83.09%             
client [36] (test)  loss: 0.4070 -> 0.3132   acc: 93.59% -> 92.19%             
client [65] (test)  loss: 0.6505 -> 0.6594   acc: 82.76% -> 85.71%             
client [81] (test)  loss: 0.7597 -> 0.3658   acc: 87.86% -> 91.82%             
client [79] (test)  loss: 0.4774 -> 0.6642   acc: 90.22% -> 86.36%             
client [42] (test)  loss: 0.4621 -> 0.3581   acc: 92.25% -> 91.84%             
client [11] (test)  loss: 0.2371 -> 0.2449   acc: 97.06% -> 97.06%             
client [96] (test)  loss: 0.3201 -> 0.2724   acc: 94.29% -> 95.64%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7202 -> 0.7760   acc: 88.63% -> 88.48%              
client [53] (test)  loss: 0.1718 -> 0.1780   acc: 98.03% -> 98.01%             
client [52] (test)  loss: 1.0694 -> 1.1226   acc: 87.25% -> 87.17%             
client [42] (test)  loss: 0.4143 -> 0.4613   acc: 92.16% -> 92.04%             
client [69] (test)  loss: 0.6574 -> 0.6668   acc: 91.89% -> 91.93%             
client [59] (test)  loss: 0.3952 -> 0.5106   acc: 90.15% -> 90.22%             
client [7] (test)  loss: 0.5598 -> 0.4977   acc: 90.39% -> 90.36%              
client [26] (test)  loss: 0.2466 -> 0.2974   acc: 93.50% -> 93.52%             
client [49] (test)  loss: 0.0001 -> 0.0000   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.2302 -> 0.2331   acc: 97.64% -> 97.64%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2331 -> 0.2356   acc: 97.64% -> 97.64%             
client [47] (test)  loss: 0.4575 -> 0.4480   acc: 91.93% -> 91.90%             
client [21] (test)  loss: 0.1717 -> 0.1671   acc: 97.65% -> 97.74%             
client [77] (test)  loss: 0.3135 -> 0.3198   acc: 96.28% -> 96.32%             
client [95] (test)  loss: 0.2993 -> 0.3030   acc: 96.96% -> 96.96%             
client [91] (test)  loss: 0.2518 -> 0.2572   acc: 97.14% -> 97.10%             
client [14] (test)  loss: 0.4772 -> 0.5285   acc: 92.89% -> 93.37%             
client [99] (test)  loss: 0.1194 -> 0.1323   acc: 98.78% -> 98.75%             
client [20] (test)  loss: 0.2436 -> 0.2460   acc: 96.65% -> 96.65%             
client [39] (test)  loss: 0.2526 -> 0.2610   acc: 96.32% -> 96.34%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1226 -> 1.1593   acc: 87.17% -> 87.09%             
client [62] (test)  loss: 0.2556 -> 0.2582   acc: 97.23% -> 97.23%             
client [71] (test)  loss: 0.0186 -> 0.0189   acc: 99.64% -> 99.64%             
client [97] (test)  loss: 0.0121 -> 0.0123   acc: 99.61% -> 99.61%             
client [30] (test)  loss: 0.3077 -> 0.2890   acc: 93.74% -> 95.63%             
client [88] (test)  loss: 0.5237 -> 0.5170   acc: 89.65% -> 89.54%             
client [60] (test)  loss: 0.3439 -> 0.3507   acc: 95.19% -> 95.16%             
client [82] (test)  loss: 0.8607 -> 1.1802   acc: 69.02% -> 63.52%             
client [91] (test)  loss: 0.2616 -> 0.2654   acc: 97.12% -> 97.12%             
client [57] (test)  loss: 0.3088 -> 0.3210   acc: 95.97% -> 96.01%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4305 -> 0.4336   acc: 94.89% -> 94.89%             
client [15] (test)  loss: 0.0732 -> 0.0756   acc: 98.94% -> 98.94%             
client [71] (test)  loss: 0.0189 -> 0.0191   acc: 99.64% -> 99.64%             
client [97] (test)  loss: 0.0126 -> 0.0127   acc: 99.61% -> 99.61%             
client [53] (test)  loss: 0.1891 -> 0.1918   acc: 98.03% -> 98.03%             
client [77] (test)  loss: 0.3198 -> 0.3251   acc: 96.32% -> 96.32%             
client [76] (test)  loss: 0.5622 -> 0.4332   acc: 92.86% -> 92.80%             
client [79] (test)  loss: 0.5219 -> 0.7004   acc: 91.63% -> 89.41%             
client [28] (test)  loss: 0.0107 -> 0.0108   acc: 99.88% -> 99.88%             
client [99] (test)  loss: 0.1408 -> 0.1471   acc: 98.78% -> 98.80%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0129 -> 0.0130   acc: 99.64% -> 99.64%             
client [86] (test)  loss: 1.1362 -> 1.1567   acc: 86.58% -> 86.54%             
client [34] (test)  loss: 0.2748 -> 0.2769   acc: 96.78% -> 96.78%             
client [73] (test)  loss: 0.5571 -> 0.5477   acc: 91.30% -> 91.30%             
client [5] (test)  loss: 0.2743 -> 0.2724   acc: 95.74% -> 95.67%              
client [96] (test)  loss: 0.3564 -> 0.3599   acc: 95.76% -> 95.76%             
client [22] (test)  loss: 0.2986 -> 0.2974   acc: 94.58% -> 94.94%             
client [60] (test)  loss: 0.3653 -> 0.3689   acc: 95.22% -> 95.22%             
client [66] (test)  loss: 0.4344 -> 0.4097   acc: 93.69% -> 93.93%             
client [83] (test)  loss: 0.2228 -> 0.2488   acc: 95.69% -> 94.15%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5606 -> 0.5574   acc: 92.74% -> 92.71%             
client [65] (test)  loss: 0.7727 -> 0.7650   acc: 84.76% -> 86.91%             
client [95] (test)  loss: 0.3123 -> 0.3147   acc: 96.96% -> 96.96%             
client [17] (test)  loss: 0.2589 -> 0.2968   acc: 94.30% -> 93.84%             
client [8] (test)  loss: 0.8464 -> 0.8619   acc: 88.36% -> 88.53%              
client [35] (test)  loss: 0.0858 -> 0.0863   acc: 98.92% -> 98.92%             
client [98] (test)  loss: 0.2399 -> 0.2418   acc: 97.64% -> 97.64%             
client [53] (test)  loss: 0.1941 -> 0.1961   acc: 98.03% -> 98.03%             
client [43] (test)  loss: 0.8211 -> 0.8507   acc: 86.82% -> 87.25%             
client [64] (test)  loss: 0.8084 -> 0.7975   acc: 87.65% -> 87.44%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1707 -> 0.1757   acc: 97.82% -> 97.77%             
client [88] (test)  loss: 0.6430 -> 0.6005   acc: 89.65% -> 89.62%             
client [38] (test)  loss: 0.6604 -> 0.6683   acc: 93.13% -> 93.17%             
client [3] (test)  loss: 0.0393 -> 0.0396   acc: 99.58% -> 99.58%              
client [5] (test)  loss: 0.3156 -> 0.3436   acc: 95.80% -> 95.89%              
client [41] (test)  loss: 0.7657 -> 0.7908   acc: 89.69% -> 89.72%             
client [7] (test)  loss: 0.6588 -> 0.5356   acc: 90.78% -> 90.34%              
client [37] (test)  loss: 0.0835 -> 0.0842   acc: 98.58% -> 98.58%             
client [45] (test)  loss: 0.7467 -> 0.7315   acc: 86.43% -> 86.57%             
client [47] (test)  loss: 0.5735 -> 0.5238   acc: 92.12% -> 91.32%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7714 -> 0.7410   acc: 89.15% -> 89.84%             
client [11] (test)  loss: 0.2732 -> 0.2756   acc: 97.08% -> 97.08%             
client [37] (test)  loss: 0.0854 -> 0.0860   acc: 98.55% -> 98.55%             
client [41] (test)  loss: 0.7908 -> 0.8103   acc: 89.72% -> 89.65%             
client [95] (test)  loss: 0.3208 -> 0.3227   acc: 96.96% -> 96.96%             
client [53] (test)  loss: 0.1961 -> 0.1980   acc: 98.03% -> 98.03%             
client [22] (test)  loss: 0.3260 -> 0.2736   acc: 94.58% -> 94.68%             
client [25] (test)  loss: 0.3738 -> 0.3797   acc: 94.81% -> 94.85%             
client [69] (test)  loss: 0.7156 -> 0.7201   acc: 91.89% -> 91.85%             
client [46] (test)  loss: 0.1041 -> 0.1051   acc: 98.86% -> 98.86%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6778 -> 0.6930   acc: 92.09% -> 92.06%             
client [69] (test)  loss: 0.7241 -> 0.7279   acc: 91.85% -> 91.85%             
client [82] (test)  loss: 1.0465 -> 1.2275   acc: 68.11% -> 67.55%             
client [45] (test)  loss: 0.8013 -> 0.7953   acc: 85.47% -> 85.36%             
client [7] (test)  loss: 0.5356 -> 0.6278   acc: 90.34% -> 90.96%              
client [50] (test)  loss: 0.2852 -> 0.3163   acc: 96.03% -> 95.92%             
client [35] (test)  loss: 0.0873 -> 0.0878   acc: 98.92% -> 98.92%             
client [24] (test)  loss: 0.6755 -> 0.6806   acc: 92.41% -> 92.44%             
client [15] (test)  loss: 0.0816 -> 0.0825   acc: 98.92% -> 98.92%             
client [58] (test)  loss: nan -> nan   acc: 0.04% -> 0.04%                     
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.9014 -> 1.9241   acc: 78.75% -> 78.75%             
client [76] (test)  loss: 0.5972 -> 0.6164   acc: 92.86% -> 92.89%             
client [67] (test)  loss: 0.8738 -> 0.9361   acc: 84.23% -> 85.67%             
client [37] (test)  loss: 0.0865 -> 0.0870   acc: 98.55% -> 98.55%             
client [58] (test)  loss: nan -> nan   acc: 0.04% -> 0.04%                     
client [64] (test)  loss: 0.9586 -> 0.9838   acc: 87.72% -> 87.58%             
client [77] (test)  loss: 0.3405 -> 0.3433   acc: 96.34% -> 96.32%             
client [55] (test)  loss: 0.2523 -> 0.2543   acc: 97.31% -> 97.31%             
client [12] (test)  loss: 0.9789 -> 0.9877   acc: 89.49% -> 89.49%             
client [89] (test)  loss: 0.5739 -> 0.5985   acc: 88.01% -> 87.97%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6507 -> 0.6578   acc: 91.68% -> 91.63%             
client [51] (test)  loss: 0.9291 -> 0.9609   acc: 89.91% -> 89.96%             
client [8] (test)  loss: 0.8535 -> 0.6941   acc: 88.73% -> 88.21%              
client [18] (test)  loss: 0.0643 -> 0.0647   acc: 98.81% -> 98.81%             
client [94] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.6755 -> 0.6829   acc: 92.80% -> 92.76%             
client [3] (test)  loss: 0.0407 -> 0.0409   acc: 99.58% -> 99.58%              
client [11] (test)  loss: 0.2817 -> 0.2835   acc: 97.08% -> 97.08%             
client [95] (test)  loss: 0.3317 -> 0.3329   acc: 96.94% -> 96.94%             
client [67] (test)  loss: 0.9361 -> 0.6395   acc: 85.67% -> 83.14%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1825 -> 0.1851   acc: 97.77% -> 97.77%             
client [79] (test)  loss: 0.8110 -> 0.8182   acc: 91.56% -> 91.63%             
client [58] (test)  loss: nan -> nan   acc: 0.04% -> 0.04%                     
client [88] (test)  loss: 0.6251 -> 0.6070   acc: 90.12% -> 90.42%             
client [46] (test)  loss: 0.1076 -> 0.1082   acc: 98.86% -> 98.86%             
client [11] (test)  loss: 0.2835 -> 0.2852   acc: 97.08% -> 97.08%             
client [55] (test)  loss: 0.2631 -> 0.2644   acc: 97.28% -> 97.28%             
client [13] (test)  loss: 0.2745 -> 0.2761   acc: 96.92% -> 96.89%             
client [31] (test)  loss: 0.4415 -> 0.4438   acc: 94.89% -> 94.89%             
client [75] (test)  loss: 0.6999 -> 0.7041   acc: 92.13% -> 92.13%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1789 -> 0.1798   acc: 97.93% -> 97.91%             
client [7] (test)  loss: 0.7220 -> 0.6183   acc: 91.38% -> 90.26%              
client [57] (test)  loss: 0.3763 -> 0.3790   acc: 96.01% -> 96.04%             
client [13] (test)  loss: 0.2774 -> 0.2787   acc: 96.89% -> 96.89%             
client [43] (test)  loss: 1.0270 -> 0.9548   acc: 86.86% -> 86.74%             
client [91] (test)  loss: 0.2765 -> 0.2787   acc: 97.05% -> 97.05%             
client [10] (test)  loss: 0.9115 -> 1.0383   acc: 84.80% -> 84.95%             
client [64] (test)  loss: 1.0572 -> 1.0666   acc: 87.58% -> 87.58%             
client [82] (test)  loss: 1.5475 -> 1.7800   acc: 68.91% -> 67.88%             
client [22] (test)  loss: 0.4448 -> 0.4530   acc: 94.91% -> 94.94%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2579 -> 0.2592   acc: 96.65% -> 96.65%             
client [23] (test)  loss: 0.1642 -> 0.1681   acc: 95.48% -> 95.62%             
client [88] (test)  loss: 0.6070 -> 0.7005   acc: 90.42% -> 90.56%             
client [98] (test)  loss: 0.2528 -> 0.2539   acc: 97.68% -> 97.68%             
client [79] (test)  loss: 0.8308 -> 0.8365   acc: 91.66% -> 91.63%             
client [21] (test)  loss: 0.1873 -> 0.1893   acc: 97.72% -> 97.72%             
client [92] (test)  loss: 0.2162 -> 0.2173   acc: 97.77% -> 97.77%             
client [56] (test)  loss: 0.1072 -> 0.1075   acc: 98.47% -> 98.47%             
client [5] (test)  loss: 0.3929 -> 0.3972   acc: 95.74% -> 95.74%              
client [52] (test)  loss: 1.3284 -> 1.3359   acc: 87.13% -> 87.13%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': 'nan -> 0.0000', 'accuracy': '92.30% -> 0.00%'},             
    200: {'loss': 'nan -> 0.0000', 'accuracy': '92.66% -> 0.00%'}              
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 30.0%(33.96%) at epoch: 1                                     
FedFomo achieved 40.0%(49.13%) at epoch: 2                                     
FedFomo achieved 60.0%(66.34%) at epoch: 4                                     
FedFomo achieved 70.0%(77.12%) at epoch: 9                                     
FedFomo achieved 80.0%(80.66%) at epoch: 13                                    
FedFomo achieved 90.0%(91.02%) at epoch: 22                                    
Convergence (test_after):                                                      
FedFomo achieved 90.0%(94.74%) at epoch: 0                                     
