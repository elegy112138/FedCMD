==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8402 -> 0.9403   acc: 79.30% -> 78.85%             
client [81] (test)  loss: 1.7610 -> 2.0971   acc: 42.41% -> 43.30%             
client [21] (test)  loss: 2.8860 -> 0.6719   acc: 3.27% -> 80.84%              
client [68] (test)  loss: 0.9627 -> 1.1706   acc: 57.69% -> 57.69%             
client [93] (test)  loss: 0.5516 -> 0.4257   acc: 81.31% -> 87.54%             
client [31] (test)  loss: 4.8165 -> 0.8284   acc: 56.82% -> 72.73%             
client [20] (test)  loss: 0.2590 -> 0.2717   acc: 94.36% -> 94.36%             
client [59] (test)  loss: 20.8560 -> 0.2198   acc: 0.00% -> 96.80%             
client [48] (test)  loss: 1.0522 -> 1.0734   acc: 66.28% -> 66.28%             
client [34] (test)  loss: 1.0167 -> 0.9176   acc: 69.79% -> 73.26%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.7864 -> 0.8283   acc: 77.70% -> 76.58%             
client [99] (test)  loss: 2.0311 -> 1.9427   acc: 31.18% -> 31.18%             
client [67] (test)  loss: 1.4911 -> 1.6129   acc: 60.98% -> 60.98%             
client [0] (test)  loss: 0.6792 -> 0.7626   acc: 82.12% -> 83.40%              
client [76] (test)  loss: 0.5403 -> 0.5414   acc: 80.92% -> 80.92%             
client [41] (test)  loss: 1.2037 -> 0.9596   acc: 57.49% -> 65.51%             
client [62] (test)  loss: 23.0938 -> 0.2346   acc: 8.87% -> 93.35%             
client [2] (test)  loss: 1.6233 -> 0.9843   acc: 52.50% -> 65.00%              
client [14] (test)  loss: 0.1205 -> 0.1256   acc: 98.13% -> 98.47%             
client [46] (test)  loss: 0.2416 -> 0.1649   acc: 90.52% -> 94.31%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0988 -> 0.6871   acc: 79.47% -> 82.29%             
client [68] (test)  loss: 0.6938 -> 0.6105   acc: 78.63% -> 83.76%             
client [57] (test)  loss: 0.5959 -> 0.6351   acc: 81.68% -> 83.79%             
client [17] (test)  loss: 0.2299 -> 0.2402   acc: 94.78% -> 94.51%             
client [54] (test)  loss: 0.6428 -> 0.6932   acc: 82.78% -> 83.11%             
client [23] (test)  loss: 2.5152 -> 1.4172   acc: 17.14% -> 51.43%             
client [35] (test)  loss: 0.5351 -> 0.5244   acc: 84.51% -> 84.51%             
client [59] (test)  loss: 0.2580 -> 0.2692   acc: 96.63% -> 96.46%             
client [31] (test)  loss: 0.9437 -> 0.9775   acc: 75.57% -> 76.14%             
client [9] (test)  loss: 0.2537 -> 0.2808   acc: 91.42% -> 90.82%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.3108 -> 1.3274   acc: 62.96% -> 62.96%             
client [33] (test)  loss: 0.6877 -> 0.7100   acc: 86.27% -> 86.27%             
client [16] (test)  loss: 0.7272 -> 0.7522   acc: 86.59% -> 86.59%             
client [44] (test)  loss: 0.1563 -> 0.1731   acc: 98.66% -> 98.66%             
client [8] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 1.0068 -> 1.0315   acc: 76.14% -> 76.14%             
client [47] (test)  loss: 0.8936 -> 0.9285   acc: 78.85% -> 79.57%             
client [36] (test)  loss: 0.5188 -> 0.5456   acc: 83.48% -> 83.48%             
client [20] (test)  loss: 0.3138 -> 0.3202   acc: 94.87% -> 94.87%             
client [56] (test)  loss: 0.4607 -> 0.4218   acc: 89.77% -> 90.34%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1070 -> 1.1366   acc: 87.11% -> 87.11%              
client [60] (test)  loss: 0.3937 -> 0.4091   acc: 92.92% -> 92.92%             
client [28] (test)  loss: 1.3083 -> 1.3977   acc: 64.17% -> 64.17%             
client [25] (test)  loss: 0.5758 -> 0.6270   acc: 82.86% -> 82.38%             
client [58] (test)  loss: 1.5913 -> 1.6284   acc: 68.72% -> 68.72%             
client [44] (test)  loss: 0.1731 -> 0.1811   acc: 98.66% -> 98.66%             
client [39] (test)  loss: 0.4433 -> 0.4604   acc: 84.80% -> 85.71%             
client [29] (test)  loss: 0.8533 -> 0.5017   acc: 84.29% -> 86.19%             
client [3] (test)  loss: 0.4606 -> 0.4749   acc: 88.71% -> 88.71%              
client [84] (test)  loss: 1.1175 -> 1.1339   acc: 68.93% -> 67.23%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5213 -> 0.5516   acc: 83.64% -> 82.24%             
client [84] (test)  loss: 1.2148 -> 1.2770   acc: 67.80% -> 67.80%             
client [10] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [36] (test)  loss: 0.5924 -> 0.6123   acc: 86.09% -> 86.09%             
client [65] (test)  loss: 0.7140 -> 0.7306   acc: 80.78% -> 81.18%             
client [81] (test)  loss: 1.8597 -> 1.9265   acc: 55.80% -> 55.80%             
client [79] (test)  loss: 1.2394 -> 1.3090   acc: 61.99% -> 61.99%             
client [42] (test)  loss: 0.1679 -> 0.1735   acc: 97.87% -> 97.87%             
client [11] (test)  loss: 1.0743 -> 1.1372   acc: 74.43% -> 74.94%             
client [96] (test)  loss: 1.3095 -> 1.3443   acc: 57.69% -> 56.73%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0003 -> 0.0002   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.2174 -> 0.2184   acc: 94.39% -> 94.39%             
client [52] (test)  loss: 0.5442 -> 0.5553   acc: 87.46% -> 87.46%             
client [42] (test)  loss: 0.1782 -> 0.1819   acc: 97.87% -> 97.87%             
client [69] (test)  loss: 1.0239 -> 1.0381   acc: 77.70% -> 77.32%             
client [59] (test)  loss: 0.2891 -> 0.2938   acc: 96.13% -> 96.13%             
client [7] (test)  loss: 0.8522 -> 0.9232   acc: 65.28% -> 61.11%              
client [26] (test)  loss: 0.9396 -> 0.9444   acc: 76.32% -> 78.95%             
client [49] (test)  loss: 0.0982 -> 0.0993   acc: 99.64% -> 99.64%             
client [98] (test)  loss: 0.9000 -> 0.9462   acc: 73.13% -> 74.63%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9462 -> 0.9880   acc: 74.63% -> 74.63%             
client [47] (test)  loss: 0.9868 -> 1.0405   acc: 79.21% -> 79.57%             
client [21] (test)  loss: 0.5812 -> 0.6147   acc: 83.18% -> 85.05%             
client [77] (test)  loss: 1.3645 -> 1.3971   acc: 78.85% -> 78.85%             
client [95] (test)  loss: 0.6876 -> 0.7062   acc: 85.08% -> 85.08%             
client [91] (test)  loss: 0.8946 -> 0.9243   acc: 81.33% -> 80.67%             
client [14] (test)  loss: 0.1391 -> 0.1408   acc: 98.30% -> 98.30%             
client [99] (test)  loss: 2.1754 -> 2.2311   acc: 37.06% -> 41.18%             
client [20] (test)  loss: 0.3396 -> 0.3433   acc: 94.87% -> 94.87%             
client [39] (test)  loss: 0.4543 -> 0.4699   acc: 86.32% -> 86.32%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5553 -> 0.5645   acc: 87.46% -> 87.62%             
client [62] (test)  loss: 0.2669 -> 0.2690   acc: 94.76% -> 94.76%             
client [71] (test)  loss: 0.2970 -> 0.2984   acc: 97.97% -> 97.97%             
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 1.5884 -> 1.6108   acc: 72.00% -> 72.00%             
client [88] (test)  loss: 0.8373 -> 0.8378   acc: 81.16% -> 81.16%             
client [60] (test)  loss: 0.4441 -> 0.4484   acc: 92.92% -> 92.92%             
client [82] (test)  loss: 1.5763 -> 1.6271   acc: 61.80% -> 62.92%             
client [91] (test)  loss: 0.9501 -> 0.9721   acc: 80.67% -> 80.00%             
client [57] (test)  loss: 0.7578 -> 0.7841   acc: 84.21% -> 84.21%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.1819 -> 1.1902   acc: 76.70% -> 76.70%             
client [15] (test)  loss: 1.0009 -> 1.0423   acc: 72.29% -> 72.29%             
client [71] (test)  loss: 0.2984 -> 0.2997   acc: 97.97% -> 97.97%             
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.2265 -> 0.2292   acc: 94.39% -> 95.33%             
client [77] (test)  loss: 1.3971 -> 1.4255   acc: 78.85% -> 78.85%             
client [76] (test)  loss: 0.8894 -> 0.9151   acc: 83.45% -> 83.45%             
client [79] (test)  loss: 1.4318 -> 1.4829   acc: 61.99% -> 61.99%             
client [28] (test)  loss: 1.6722 -> 1.6954   acc: 63.10% -> 63.10%             
client [99] (test)  loss: 2.3386 -> 2.4297   acc: 40.59% -> 40.00%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 1.5515 -> 1.5734   acc: 60.21% -> 60.73%             
client [34] (test)  loss: 0.8013 -> 0.8167   acc: 85.07% -> 85.07%             
client [73] (test)  loss: 1.6310 -> 1.4344   acc: 36.36% -> 47.73%             
client [5] (test)  loss: 0.7066 -> 0.7330   acc: 76.34% -> 78.49%              
client [96] (test)  loss: 1.5045 -> 1.5174   acc: 57.69% -> 57.69%             
client [22] (test)  loss: 0.4543 -> 0.4626   acc: 88.72% -> 88.72%             
client [60] (test)  loss: 0.4588 -> 0.4618   acc: 92.92% -> 92.92%             
client [66] (test)  loss: 0.3981 -> 0.4084   acc: 92.34% -> 92.34%             
client [83] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.9731 -> 0.9884   acc: 83.91% -> 83.91%             
client [65] (test)  loss: 0.7565 -> 0.7673   acc: 81.96% -> 81.96%             
client [95] (test)  loss: 0.7502 -> 0.7610   acc: 85.08% -> 85.08%             
client [17] (test)  loss: 0.2824 -> 0.2891   acc: 95.05% -> 95.05%             
client [8] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 1.3834 -> 0.6908   acc: 87.32% -> 78.87%             
client [98] (test)  loss: 1.0625 -> 1.0895   acc: 74.63% -> 76.12%             
client [53] (test)  loss: 0.2316 -> 0.2340   acc: 95.33% -> 95.33%             
client [43] (test)  loss: 1.1497 -> 1.1218   acc: 70.66% -> 71.07%             
client [64] (test)  loss: 1.4039 -> 1.4148   acc: 66.67% -> 66.67%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6442 -> 0.6688   acc: 85.05% -> 85.05%             
client [88] (test)  loss: 1.0246 -> 1.0604   acc: 82.61% -> 84.06%             
client [38] (test)  loss: 1.9881 -> 2.0393   acc: 31.43% -> 31.43%             
client [3] (test)  loss: 0.5399 -> 0.5441   acc: 89.03% -> 89.03%              
client [5] (test)  loss: 0.7591 -> 0.7868   acc: 78.49% -> 79.57%              
client [41] (test)  loss: 1.2832 -> 1.3149   acc: 68.99% -> 68.64%             
client [7] (test)  loss: 0.9470 -> 0.9620   acc: 66.67% -> 65.28%              
client [37] (test)  loss: 1.5478 -> 1.6229   acc: 63.16% -> 62.63%             
client [45] (test)  loss: 0.3870 -> 0.3984   acc: 92.45% -> 92.62%             
client [47] (test)  loss: 1.1161 -> 1.1444   acc: 79.21% -> 79.21%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7037 -> 0.7172   acc: 85.47% -> 85.47%             
client [11] (test)  loss: 1.3713 -> 1.3904   acc: 74.94% -> 74.94%             
client [37] (test)  loss: 1.7491 -> 1.7986   acc: 63.16% -> 63.16%             
client [41] (test)  loss: 1.3149 -> 1.3424   acc: 68.64% -> 68.29%             
client [95] (test)  loss: 0.7902 -> 0.7990   acc: 85.08% -> 85.08%             
client [53] (test)  loss: 0.2340 -> 0.2361   acc: 95.33% -> 95.33%             
client [22] (test)  loss: 0.4690 -> 0.4760   acc: 88.72% -> 88.72%             
client [25] (test)  loss: 0.8712 -> 0.8943   acc: 83.02% -> 83.02%             
client [69] (test)  loss: 1.1187 -> 1.1265   acc: 78.81% -> 78.81%             
client [46] (test)  loss: 0.1610 -> 0.1640   acc: 95.73% -> 95.73%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.2242 -> 1.2397   acc: 79.21% -> 79.21%             
client [69] (test)  loss: 1.1336 -> 1.1399   acc: 78.81% -> 78.81%             
client [82] (test)  loss: 1.7699 -> 1.8001   acc: 65.73% -> 65.73%             
client [45] (test)  loss: 0.4167 -> 0.4243   acc: 92.62% -> 92.45%             
client [7] (test)  loss: 0.9620 -> 0.9747   acc: 65.28% -> 66.67%              
client [50] (test)  loss: 0.4959 -> 0.5069   acc: 89.38% -> 89.68%             
client [35] (test)  loss: 0.6617 -> 0.5991   acc: 80.28% -> 85.92%             
client [24] (test)  loss: 1.0408 -> 1.0576   acc: 83.23% -> 83.23%             
client [15] (test)  loss: 1.1664 -> 1.1851   acc: 73.49% -> 72.29%             
client [58] (test)  loss: 1.8963 -> 1.9079   acc: 68.72% -> 68.72%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.2788 -> 1.2867   acc: 68.60% -> 68.60%             
client [76] (test)  loss: 1.0149 -> 1.0278   acc: 83.91% -> 83.91%             
client [67] (test)  loss: 2.1398 -> 2.1690   acc: 65.85% -> 65.85%             
client [37] (test)  loss: 1.8424 -> 1.8821   acc: 63.16% -> 63.16%             
client [58] (test)  loss: 1.9196 -> 1.9304   acc: 68.72% -> 68.72%             
client [64] (test)  loss: 1.4397 -> 1.4467   acc: 66.67% -> 66.67%             
client [77] (test)  loss: 0.9501 -> 0.9467   acc: 74.45% -> 77.97%             
client [55] (test)  loss: 1.4324 -> 1.4658   acc: 60.32% -> 60.32%             
client [12] (test)  loss: 1.2960 -> 1.3066   acc: 70.63% -> 69.84%             
client [89] (test)  loss: 0.7446 -> 0.7462   acc: 78.18% -> 78.18%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.6427 -> 1.6546   acc: 67.80% -> 67.80%             
client [51] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 1.7736 -> 1.8297   acc: 61.41% -> 61.41%             
client [94] (test)  loss: 0.8895 -> 0.9127   acc: 80.77% -> 80.77%             
client [81] (test)  loss: 2.3300 -> 2.3470   acc: 57.59% -> 57.59%             
client [3] (test)  loss: 0.5570 -> 0.5596   acc: 89.03% -> 89.03%              
client [11] (test)  loss: 1.4391 -> 1.4532   acc: 74.94% -> 74.94%             
client [95] (test)  loss: 0.8384 -> 0.8441   acc: 85.08% -> 85.08%             
client [67] (test)  loss: 2.1690 -> 2.1916   acc: 65.85% -> 65.85%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7020 -> 0.7153   acc: 85.05% -> 85.05%             
client [79] (test)  loss: 1.7310 -> 1.7438   acc: 61.40% -> 61.40%             
client [58] (test)  loss: 1.9591 -> 1.9677   acc: 68.72% -> 68.16%             
client [88] (test)  loss: 1.1128 -> 1.1390   acc: 84.06% -> 84.06%             
client [46] (test)  loss: 0.1710 -> 0.1733   acc: 95.73% -> 96.21%             
client [11] (test)  loss: 1.4532 -> 1.4660   acc: 74.94% -> 74.94%             
client [55] (test)  loss: 1.5926 -> 1.6127   acc: 61.90% -> 61.90%             
client [13] (test)  loss: 1.7485 -> 1.7610   acc: 71.10% -> 71.10%             
client [31] (test)  loss: 1.2140 -> 1.2208   acc: 76.70% -> 76.70%             
client [75] (test)  loss: 0.4203 -> 0.4233   acc: 92.33% -> 92.33%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.9860 -> 0.9921   acc: 78.63% -> 78.63%             
client [7] (test)  loss: 1.0525 -> 1.0665   acc: 65.28% -> 65.28%              
client [57] (test)  loss: 0.8942 -> 0.9023   acc: 84.42% -> 84.63%             
client [13] (test)  loss: 1.7740 -> 1.7855   acc: 71.10% -> 71.10%             
client [43] (test)  loss: 1.3294 -> 1.3982   acc: 76.45% -> 76.45%             
client [91] (test)  loss: 1.0362 -> 1.0491   acc: 79.33% -> 79.33%             
client [10] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [64] (test)  loss: 1.4771 -> 1.4812   acc: 66.67% -> 66.67%             
client [82] (test)  loss: 1.9138 -> 1.9284   acc: 65.73% -> 65.73%             
client [22] (test)  loss: 0.5030 -> 0.5074   acc: 88.72% -> 89.47%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3641 -> 0.3665   acc: 94.87% -> 94.87%             
client [23] (test)  loss: 1.8060 -> 1.8491   acc: 51.43% -> 51.43%             
client [88] (test)  loss: 1.1390 -> 1.1511   acc: 84.06% -> 84.06%             
client [98] (test)  loss: 1.2679 -> 1.2831   acc: 74.63% -> 74.63%             
client [79] (test)  loss: 1.7671 -> 1.7775   acc: 61.40% -> 61.40%             
client [21] (test)  loss: 0.7273 -> 0.7370   acc: 85.05% -> 85.05%             
client [92] (test)  loss: 0.0815 -> 0.0822   acc: 99.22% -> 99.22%             
client [56] (test)  loss: 0.5601 -> 0.5735   acc: 92.61% -> 92.61%             
client [5] (test)  loss: 0.4687 -> 0.4218   acc: 84.95% -> 84.95%              
client [52] (test)  loss: 0.6293 -> 0.6327   acc: 88.08% -> 88.24%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': 'nan -> 0.0000', 'accuracy': '85.63% -> 0.00%'},             
    200: {'loss': 'nan -> 0.0000', 'accuracy': '85.79% -> 0.00%'}              
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 20.0%(20.12%) at epoch: 1                                     
FedFomo achieved 30.0%(36.54%) at epoch: 2                                     
FedFomo achieved 50.0%(53.65%) at epoch: 4                                     
FedFomo achieved 80.0%(80.81%) at epoch: 13                                    
FedFomo achieved 90.0%(91.91%) at epoch: 39                                    
Convergence (test_after):                                                      
FedFomo achieved 70.0%(77.10%) at epoch: 0                                     
FedFomo achieved 80.0%(85.30%) at epoch: 1                                     
FedFomo achieved 90.0%(94.78%) at epoch: 11                                    
