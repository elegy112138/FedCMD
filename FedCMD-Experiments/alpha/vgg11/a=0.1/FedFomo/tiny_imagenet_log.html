==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3906 -> 2.5532   acc: 16.15% -> 40.38%             
client [81] (test)  loss: 3.4710 -> 2.7968   acc: 32.74% -> 38.08%             
client [21] (test)  loss: 5.2948 -> 5.2262   acc: 0.20% -> 3.40%               
client [68] (test)  loss: 4.7220 -> 3.0807   acc: 15.61% -> 35.77%             
client [93] (test)  loss: 5.2592 -> 4.8458   acc: 7.54% -> 16.91%              
client [31] (test)  loss: 3.9965 -> 2.3025   acc: 22.30% -> 51.92%             
client [20] (test)  loss: 3.5803 -> 2.6907   acc: 34.78% -> 45.85%             
client [59] (test)  loss: 5.2533 -> 4.6375   acc: 7.39% -> 11.97%              
client [48] (test)  loss: 2.4834 -> 2.0836   acc: 54.05% -> 57.99%             
client [34] (test)  loss: 5.2228 -> 4.9778   acc: 3.94% -> 16.47%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.0975 -> 4.2292   acc: 7.98% -> 15.69%              
client [99] (test)  loss: 5.2061 -> 4.8592   acc: 8.59% -> 21.68%              
client [67] (test)  loss: 5.1939 -> 4.3191   acc: 10.05% -> 11.99%             
client [0] (test)  loss: 4.9817 -> 3.2724   acc: 12.72% -> 32.97%              
client [76] (test)  loss: 5.0045 -> 3.2071   acc: 15.27% -> 36.91%             
client [41] (test)  loss: 5.2136 -> 4.0809   acc: 7.83% -> 24.73%              
client [62] (test)  loss: 5.2820 -> 5.0352   acc: 1.37% -> 14.02%              
client [2] (test)  loss: 5.3086 -> 5.2303   acc: 0.65% -> 9.35%                
client [14] (test)  loss: 2.9180 -> 2.0125   acc: 44.13% -> 54.09%             
client [46] (test)  loss: 3.1472 -> 2.6415   acc: 37.30% -> 42.16%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.5484 -> 3.1948   acc: 23.84% -> 40.55%             
client [68] (test)  loss: 2.6525 -> 2.8794   acc: 49.27% -> 49.76%             
client [57] (test)  loss: 4.4425 -> 3.4111   acc: 20.18% -> 34.36%             
client [17] (test)  loss: 2.3245 -> 2.1149   acc: 49.29% -> 54.82%             
client [54] (test)  loss: 2.9677 -> 3.1042   acc: 47.38% -> 47.07%             
client [23] (test)  loss: 5.3137 -> 5.1985   acc: 1.95% -> 10.97%              
client [35] (test)  loss: 2.4653 -> 2.5243   acc: 44.38% -> 47.39%             
client [59] (test)  loss: 2.4025 -> 2.4421   acc: 50.53% -> 50.53%             
client [31] (test)  loss: 1.9551 -> 2.0241   acc: 63.76% -> 64.29%             
client [9] (test)  loss: 3.2277 -> 2.7561   acc: 36.91% -> 44.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.0724 -> 2.2435   acc: 57.10% -> 56.93%             
client [33] (test)  loss: 3.5970 -> 3.6791   acc: 45.45% -> 45.45%             
client [16] (test)  loss: 3.1691 -> 2.5418   acc: 38.98% -> 48.09%             
client [44] (test)  loss: 5.1303 -> 4.0135   acc: 9.66% -> 22.71%              
client [8] (test)  loss: 2.6458 -> 2.7327   acc: 53.58% -> 53.58%              
client [31] (test)  loss: 2.0712 -> 2.1111   acc: 64.29% -> 63.94%             
client [47] (test)  loss: 1.9056 -> 1.6986   acc: 58.41% -> 62.57%             
client [36] (test)  loss: 5.1460 -> 3.7490   acc: 15.76% -> 29.53%             
client [20] (test)  loss: 2.6662 -> 2.7348   acc: 53.81% -> 53.63%             
client [56] (test)  loss: 4.3154 -> 3.3171   acc: 17.97% -> 32.21%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.8906 -> 2.7417   acc: 39.96% -> 45.75%              
client [60] (test)  loss: 3.3816 -> 2.6061   acc: 31.45% -> 47.45%             
client [28] (test)  loss: 3.0647 -> 3.2705   acc: 47.92% -> 47.92%             
client [25] (test)  loss: 3.4582 -> 2.8584   acc: 31.13% -> 41.39%             
client [58] (test)  loss: 3.4153 -> 3.5530   acc: 45.76% -> 45.94%             
client [44] (test)  loss: 4.0135 -> 2.8444   acc: 22.71% -> 43.64%             
client [39] (test)  loss: 4.8225 -> 3.9347   acc: 17.82% -> 26.73%             
client [29] (test)  loss: 2.0481 -> 2.1336   acc: 57.48% -> 57.99%             
client [3] (test)  loss: 2.2224 -> 2.2938   acc: 49.84% -> 52.78%              
client [84] (test)  loss: 2.5854 -> 2.7245   acc: 49.82% -> 50.71%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.5719 -> 3.0189   acc: 32.40% -> 41.40%             
client [84] (test)  loss: 2.8193 -> 2.8881   acc: 50.53% -> 50.71%             
client [10] (test)  loss: 2.4738 -> 2.6645   acc: 50.37% -> 50.37%             
client [36] (test)  loss: 1.9259 -> 2.1408   acc: 55.98% -> 53.62%             
client [65] (test)  loss: 2.9423 -> 3.1918   acc: 41.94% -> 41.94%             
client [81] (test)  loss: 2.5791 -> 2.6933   acc: 51.42% -> 51.42%             
client [79] (test)  loss: 3.2746 -> 3.5041   acc: 36.11% -> 35.04%             
client [42] (test)  loss: 3.0459 -> 3.1557   acc: 45.97% -> 46.51%             
client [11] (test)  loss: 2.8212 -> 3.1141   acc: 40.83% -> 43.08%             
client [96] (test)  loss: 1.9578 -> 2.0687   acc: 53.96% -> 54.50%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.8542 -> 2.8995   acc: 53.74% -> 53.58%              
client [53] (test)  loss: 2.5453 -> 2.5933   acc: 51.36% -> 50.78%             
client [52] (test)  loss: 2.6242 -> 2.7838   acc: 47.34% -> 47.52%             
client [42] (test)  loss: 3.2541 -> 3.3344   acc: 46.69% -> 46.15%             
client [69] (test)  loss: 3.6933 -> 3.7586   acc: 39.89% -> 40.16%             
client [59] (test)  loss: 2.8519 -> 2.9243   acc: 51.06% -> 50.88%             
client [7] (test)  loss: 2.8120 -> 3.0255   acc: 48.47% -> 48.47%              
client [26] (test)  loss: 2.4384 -> 2.5238   acc: 51.94% -> 51.43%             
client [49] (test)  loss: 2.8432 -> 2.9713   acc: 46.50% -> 48.60%             
client [98] (test)  loss: 2.4769 -> 2.5295   acc: 58.98% -> 58.79%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.5295 -> 2.5751   acc: 58.79% -> 59.17%             
client [47] (test)  loss: 1.7154 -> 1.8547   acc: 63.29% -> 64.20%             
client [21] (test)  loss: 2.9663 -> 3.1228   acc: 46.60% -> 49.80%             
client [77] (test)  loss: 2.7368 -> 2.8005   acc: 53.26% -> 53.61%             
client [95] (test)  loss: 3.3650 -> 3.4425   acc: 52.63% -> 52.84%             
client [91] (test)  loss: 2.2893 -> 2.3532   acc: 57.02% -> 57.02%             
client [14] (test)  loss: 2.3291 -> 2.3919   acc: 57.83% -> 58.19%             
client [99] (test)  loss: 3.9281 -> 4.3205   acc: 42.54% -> 41.72%             
client [20] (test)  loss: 2.9200 -> 2.9523   acc: 53.63% -> 53.63%             
client [39] (test)  loss: 3.1569 -> 3.1922   acc: 38.28% -> 38.28%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.7838 -> 2.8952   acc: 47.52% -> 47.87%             
client [62] (test)  loss: 3.7270 -> 3.7743   acc: 43.59% -> 43.42%             
client [71] (test)  loss: 4.1492 -> 4.2404   acc: 31.88% -> 31.64%             
client [97] (test)  loss: 3.0528 -> 3.1709   acc: 48.66% -> 48.47%             
client [30] (test)  loss: 4.0116 -> 4.0725   acc: 43.85% -> 43.62%             
client [88] (test)  loss: 2.9328 -> 3.0699   acc: 48.29% -> 49.32%             
client [60] (test)  loss: 2.9820 -> 3.0684   acc: 52.18% -> 51.64%             
client [82] (test)  loss: 3.0359 -> 3.1173   acc: 51.46% -> 51.62%             
client [91] (test)  loss: 2.4040 -> 2.4467   acc: 57.53% -> 57.53%             
client [57] (test)  loss: 3.2112 -> 3.4831   acc: 40.00% -> 39.27%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.3441 -> 2.3571   acc: 63.41% -> 63.41%             
client [15] (test)  loss: 3.1350 -> 3.2619   acc: 51.22% -> 50.70%             
client [71] (test)  loss: 4.2404 -> 4.3162   acc: 31.64% -> 31.88%             
client [97] (test)  loss: 3.3393 -> 3.4033   acc: 48.66% -> 48.66%             
client [53] (test)  loss: 3.1410 -> 3.2354   acc: 51.36% -> 51.16%             
client [77] (test)  loss: 2.8005 -> 2.8561   acc: 53.61% -> 54.12%             
client [76] (test)  loss: 2.9783 -> 3.0583   acc: 48.91% -> 49.09%             
client [79] (test)  loss: 3.9177 -> 4.0610   acc: 36.11% -> 36.75%             
client [28] (test)  loss: 3.7207 -> 3.7615   acc: 47.20% -> 47.20%             
client [99] (test)  loss: 4.5968 -> 4.8162   acc: 41.92% -> 42.13%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.4590 -> 3.5069   acc: 48.66% -> 48.66%             
client [86] (test)  loss: 2.7283 -> 2.7727   acc: 58.32% -> 58.64%             
client [34] (test)  loss: 4.0068 -> 4.0620   acc: 44.78% -> 44.55%             
client [73] (test)  loss: 2.7732 -> 2.8257   acc: 51.67% -> 51.67%             
client [5] (test)  loss: 3.2246 -> 3.2780   acc: 47.93% -> 47.93%              
client [96] (test)  loss: 2.5045 -> 2.5303   acc: 55.58% -> 55.22%             
client [22] (test)  loss: 3.0439 -> 3.1093   acc: 52.47% -> 52.86%             
client [60] (test)  loss: 3.2569 -> 3.3033   acc: 51.64% -> 51.64%             
client [66] (test)  loss: 2.9244 -> 3.0255   acc: 46.88% -> 47.24%             
client [83] (test)  loss: 4.0079 -> 4.0702   acc: 39.09% -> 39.28%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.2260 -> 3.2671   acc: 49.27% -> 49.27%             
client [65] (test)  loss: 3.4455 -> 3.5232   acc: 42.47% -> 42.47%             
client [95] (test)  loss: 3.6068 -> 3.6484   acc: 52.84% -> 52.84%             
client [17] (test)  loss: 2.8126 -> 2.9040   acc: 56.08% -> 56.40%             
client [8] (test)  loss: 3.0081 -> 3.0372   acc: 53.58% -> 53.42%              
client [35] (test)  loss: 3.4205 -> 3.4509   acc: 48.80% -> 48.80%             
client [98] (test)  loss: 2.6498 -> 2.6814   acc: 59.36% -> 59.36%             
client [53] (test)  loss: 3.3084 -> 3.3700   acc: 50.97% -> 51.36%             
client [43] (test)  loss: 3.7736 -> 3.8354   acc: 50.64% -> 50.80%             
client [64] (test)  loss: 2.5007 -> 2.5422   acc: 57.26% -> 57.26%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.3131 -> 3.4635   acc: 50.00% -> 49.20%             
client [88] (test)  loss: 3.5335 -> 3.5790   acc: 50.17% -> 50.17%             
client [38] (test)  loss: 3.5462 -> 3.5938   acc: 45.47% -> 45.30%             
client [3] (test)  loss: 2.9809 -> 3.0105   acc: 52.45% -> 52.45%              
client [5] (test)  loss: 3.3264 -> 3.3688   acc: 47.93% -> 48.11%              
client [41] (test)  loss: 2.8403 -> 2.8885   acc: 50.00% -> 50.18%             
client [7] (test)  loss: 3.2306 -> 3.2984   acc: 48.29% -> 48.11%              
client [37] (test)  loss: 3.1398 -> 3.1779   acc: 50.81% -> 50.49%             
client [45] (test)  loss: 3.0770 -> 3.2134   acc: 45.84% -> 46.86%             
client [47] (test)  loss: 2.0466 -> 2.1068   acc: 64.92% -> 64.74%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.1603 -> 3.1921   acc: 51.00% -> 51.00%             
client [11] (test)  loss: 3.8185 -> 3.8657   acc: 40.83% -> 40.66%             
client [37] (test)  loss: 3.2428 -> 3.2715   acc: 50.49% -> 50.16%             
client [41] (test)  loss: 2.8885 -> 2.9302   acc: 50.18% -> 50.36%             
client [95] (test)  loss: 3.7488 -> 3.7762   acc: 52.84% -> 52.84%             
client [53] (test)  loss: 3.3700 -> 3.4223   acc: 51.36% -> 51.74%             
client [22] (test)  loss: 3.1644 -> 3.2121   acc: 52.86% -> 52.66%             
client [25] (test)  loss: 3.5722 -> 3.6320   acc: 44.17% -> 44.00%             
client [69] (test)  loss: 4.0899 -> 4.1158   acc: 40.43% -> 40.43%             
client [46] (test)  loss: 3.1829 -> 3.2451   acc: 48.11% -> 48.29%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.2684 -> 2.2961   acc: 64.74% -> 64.92%             
client [69] (test)  loss: 4.1399 -> 4.1624   acc: 40.43% -> 40.43%             
client [82] (test)  loss: 3.3251 -> 3.3620   acc: 51.79% -> 51.62%             
client [45] (test)  loss: 3.3932 -> 3.4577   acc: 46.86% -> 46.65%             
client [7] (test)  loss: 3.2984 -> 3.3550   acc: 48.11% -> 48.29%              
client [50] (test)  loss: 2.7643 -> 2.8227   acc: 50.43% -> 50.60%             
client [35] (test)  loss: 3.5042 -> 3.5276   acc: 48.59% -> 48.59%             
client [24] (test)  loss: 3.3991 -> 3.4232   acc: 49.59% -> 49.59%             
client [15] (test)  loss: 3.5520 -> 3.5995   acc: 50.87% -> 50.70%             
client [58] (test)  loss: 4.3320 -> 4.3570   acc: 46.29% -> 46.29%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.5756 -> 2.5915   acc: 61.49% -> 61.49%             
client [76] (test)  loss: 3.3359 -> 3.3660   acc: 49.45% -> 49.27%             
client [67] (test)  loss: 2.9690 -> 3.0093   acc: 53.09% -> 53.26%             
client [37] (test)  loss: 3.2974 -> 3.3221   acc: 50.16% -> 50.16%             
client [58] (test)  loss: 4.3812 -> 4.4040   acc: 46.29% -> 46.11%             
client [64] (test)  loss: 2.6409 -> 2.6677   acc: 57.26% -> 57.26%             
client [77] (test)  loss: 3.0162 -> 3.0474   acc: 54.64% -> 54.64%             
client [55] (test)  loss: 3.7175 -> 3.7505   acc: 47.63% -> 47.63%             
client [12] (test)  loss: 3.2220 -> 3.2519   acc: 55.05% -> 55.20%             
client [89] (test)  loss: 3.5635 -> 3.5832   acc: 49.01% -> 49.01%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.3260 -> 3.3404   acc: 51.42% -> 51.42%             
client [51] (test)  loss: 2.9493 -> 2.9701   acc: 53.64% -> 53.64%             
client [8] (test)  loss: 3.1687 -> 3.1858   acc: 53.74% -> 53.74%              
client [18] (test)  loss: 3.8325 -> 3.8800   acc: 46.69% -> 46.69%             
client [94] (test)  loss: 3.7115 -> 3.7477   acc: 50.64% -> 50.64%             
client [81] (test)  loss: 3.1770 -> 3.1970   acc: 51.42% -> 51.60%             
client [3] (test)  loss: 3.1045 -> 3.1239   acc: 52.61% -> 52.61%              
client [11] (test)  loss: 3.9852 -> 4.0186   acc: 40.48% -> 40.66%             
client [95] (test)  loss: 3.9101 -> 3.9281   acc: 52.63% -> 52.84%             
client [67] (test)  loss: 3.0093 -> 3.0452   acc: 53.26% -> 53.26%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.6631 -> 3.7337   acc: 48.80% -> 49.20%             
client [79] (test)  loss: 4.6645 -> 4.6974   acc: 37.39% -> 37.39%             
client [58] (test)  loss: 4.4663 -> 4.4856   acc: 46.11% -> 45.94%             
client [88] (test)  loss: 3.6927 -> 3.7243   acc: 49.66% -> 49.66%             
client [46] (test)  loss: 3.3805 -> 3.4157   acc: 48.47% -> 48.65%             
client [11] (test)  loss: 4.0186 -> 4.0499   acc: 40.66% -> 40.66%             
client [55] (test)  loss: 3.8821 -> 3.9038   acc: 47.26% -> 47.26%             
client [13] (test)  loss: 3.7072 -> 3.7322   acc: 51.54% -> 51.54%             
client [31] (test)  loss: 2.3926 -> 2.4032   acc: 63.24% -> 63.24%             
client [75] (test)  loss: 3.4927 -> 3.5140   acc: 51.48% -> 51.30%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.6137 -> 3.6338   acc: 46.22% -> 46.40%             
client [7] (test)  loss: 3.5454 -> 3.5731   acc: 48.11% -> 48.11%              
client [57] (test)  loss: 4.0741 -> 4.1094   acc: 39.82% -> 39.82%             
client [13] (test)  loss: 3.7554 -> 3.7774   acc: 51.54% -> 51.54%             
client [43] (test)  loss: 4.0832 -> 4.1132   acc: 50.80% -> 50.80%             
client [91] (test)  loss: 2.5690 -> 2.5924   acc: 57.36% -> 57.36%             
client [10] (test)  loss: 3.3479 -> 3.3675   acc: 49.81% -> 49.44%             
client [64] (test)  loss: 2.7753 -> 2.7927   acc: 56.93% -> 56.93%             
client [82] (test)  loss: 3.5253 -> 3.5460   acc: 51.46% -> 51.30%             
client [22] (test)  loss: 3.3829 -> 3.4097   acc: 52.47% -> 52.47%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.1121 -> 3.1296   acc: 54.15% -> 54.33%             
client [23] (test)  loss: 2.2340 -> 2.2633   acc: 60.35% -> 60.18%             
client [88] (test)  loss: 3.7243 -> 3.7538   acc: 49.66% -> 49.49%             
client [98] (test)  loss: 2.8554 -> 2.8710   acc: 59.55% -> 59.36%             
client [79] (test)  loss: 4.7568 -> 4.7843   acc: 37.39% -> 37.39%             
client [21] (test)  loss: 3.7942 -> 3.8457   acc: 49.00% -> 49.00%             
client [92] (test)  loss: 3.5054 -> 3.5280   acc: 51.73% -> 51.73%             
client [56] (test)  loss: 4.7209 -> 4.7454   acc: 39.50% -> 39.50%             
client [5] (test)  loss: 3.5827 -> 3.6057   acc: 47.39% -> 47.39%              
client [52] (test)  loss: 3.4038 -> 3.4254   acc: 48.94% -> 48.94%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '3.0900 -> 0.0000', 'accuracy': '49.97% -> 0.00%'},          
    200: {'loss': '3.4841 -> 0.0000', 'accuracy': '50.28% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(18.94%) at epoch: 7                                     
FedFomo achieved 20.0%(23.18%) at epoch: 13                                    
FedFomo achieved 40.0%(40.94%) at epoch: 28                                    
FedFomo achieved 50.0%(50.40%) at epoch: 68                                    
Convergence (test_after):                                                      
FedFomo achieved 10.0%(12.30%) at epoch: 0                                     
FedFomo achieved 30.0%(32.98%) at epoch: 7                                     
FedFomo achieved 40.0%(42.44%) at epoch: 16                                    
FedFomo achieved 50.0%(50.85%) at epoch: 41                                    
