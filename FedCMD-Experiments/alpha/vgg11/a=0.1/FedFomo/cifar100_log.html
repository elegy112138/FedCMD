==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.6478 -> 2.2417   acc: 33.54% -> 51.41%             
client [81] (test)  loss: 2.8841 -> 3.1868   acc: 48.73% -> 48.10%             
client [21] (test)  loss: 37.9004 -> 2.8014   acc: 1.73% -> 24.78%             
client [68] (test)  loss: 2.4431 -> 2.7039   acc: 41.21% -> 46.33%             
client [93] (test)  loss: 3.3144 -> 3.4372   acc: 23.13% -> 25.17%             
client [31] (test)  loss: 3.3618 -> 2.7948   acc: 35.69% -> 41.16%             
client [20] (test)  loss: 1.4313 -> 1.5669   acc: 65.13% -> 64.14%             
client [59] (test)  loss: 5.2798 -> 2.8069   acc: 0.00% -> 44.84%              
client [48] (test)  loss: 4.0452 -> 4.3176   acc: 33.99% -> 33.66%             
client [34] (test)  loss: 3.0862 -> 4.0676   acc: 35.76% -> 22.52%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4992 -> 1.5878   acc: 65.72% -> 67.14%             
client [99] (test)  loss: 3.7730 -> 3.9639   acc: 22.93% -> 27.07%             
client [67] (test)  loss: 2.7144 -> 2.4735   acc: 34.48% -> 43.57%             
client [0] (test)  loss: 3.1304 -> 3.3860   acc: 37.39% -> 38.74%              
client [76] (test)  loss: 3.0323 -> 3.1910   acc: 40.86% -> 38.87%             
client [41] (test)  loss: 2.9063 -> 3.4028   acc: 28.67% -> 26.67%             
client [62] (test)  loss: 29.8174 -> 3.2733   acc: 2.62% -> 23.93%             
client [2] (test)  loss: 28.0631 -> 3.3770   acc: 0.00% -> 25.77%              
client [14] (test)  loss: 4.1916 -> 4.5240   acc: 34.12% -> 32.94%             
client [46] (test)  loss: 2.9224 -> 2.6334   acc: 45.60% -> 46.80%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.0100 -> 3.0169   acc: 41.44% -> 44.49%             
client [68] (test)  loss: 2.9711 -> 3.1154   acc: 57.19% -> 55.59%             
client [57] (test)  loss: 2.5673 -> 2.9832   acc: 44.55% -> 46.53%             
client [17] (test)  loss: 2.9328 -> 3.4002   acc: 36.83% -> 39.68%             
client [54] (test)  loss: 3.1463 -> 3.2133   acc: 50.00% -> 50.00%             
client [23] (test)  loss: 39.4717 -> 3.2367   acc: 0.39% -> 25.78%             
client [35] (test)  loss: 2.7099 -> 2.9200   acc: 46.33% -> 46.33%             
client [59] (test)  loss: 2.7694 -> 2.9130   acc: 52.90% -> 54.52%             
client [31] (test)  loss: 3.4231 -> 3.5213   acc: 44.69% -> 45.98%             
client [9] (test)  loss: 2.6137 -> 2.5983   acc: 36.56% -> 39.27%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.6292 -> 2.7737   acc: 47.06% -> 47.34%             
client [33] (test)  loss: 4.4061 -> 4.5308   acc: 41.42% -> 41.04%             
client [16] (test)  loss: 3.1023 -> 3.2651   acc: 45.63% -> 44.79%             
client [44] (test)  loss: 2.8513 -> 2.9073   acc: 27.12% -> 34.97%             
client [8] (test)  loss: 3.6103 -> 3.6806   acc: 44.55% -> 44.87%              
client [31] (test)  loss: 3.5966 -> 3.6591   acc: 46.95% -> 46.62%             
client [47] (test)  loss: 3.9475 -> 4.1024   acc: 34.21% -> 37.22%             
client [36] (test)  loss: 4.0392 -> 3.5698   acc: 22.22% -> 40.62%             
client [20] (test)  loss: 1.9041 -> 1.9407   acc: 64.47% -> 64.47%             
client [56] (test)  loss: 3.0986 -> 3.3272   acc: 40.10% -> 38.61%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.4632 -> 2.6492   acc: 50.64% -> 52.55%              
client [60] (test)  loss: 3.7614 -> 4.1405   acc: 33.33% -> 36.54%             
client [28] (test)  loss: 4.1144 -> 4.1997   acc: 42.86% -> 42.86%             
client [25] (test)  loss: 2.7403 -> 2.8110   acc: 42.62% -> 45.57%             
client [58] (test)  loss: 3.3945 -> 3.4737   acc: 43.35% -> 43.35%             
client [44] (test)  loss: 2.9073 -> 3.1370   acc: 34.97% -> 36.93%             
client [39] (test)  loss: 3.6969 -> 4.2128   acc: 32.04% -> 32.36%             
client [29] (test)  loss: 3.6767 -> 3.7385   acc: 43.14% -> 43.14%             
client [3] (test)  loss: 3.6804 -> 3.9447   acc: 48.62% -> 47.71%              
client [84] (test)  loss: 3.8853 -> 3.9907   acc: 35.40% -> 36.34%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.0237 -> 3.4258   acc: 34.87% -> 35.73%             
client [84] (test)  loss: 4.0715 -> 4.1386   acc: 36.34% -> 36.34%             
client [10] (test)  loss: 4.0560 -> 4.1700   acc: 46.03% -> 46.03%             
client [36] (test)  loss: 4.1072 -> 4.2705   acc: 36.46% -> 37.50%             
client [65] (test)  loss: 4.8228 -> 4.9711   acc: 38.06% -> 37.65%             
client [81] (test)  loss: 3.8195 -> 3.8909   acc: 48.73% -> 49.05%             
client [79] (test)  loss: 2.0009 -> 2.0480   acc: 65.25% -> 65.54%             
client [42] (test)  loss: 2.8990 -> 2.9469   acc: 55.37% -> 55.37%             
client [11] (test)  loss: 3.4903 -> 3.5927   acc: 44.79% -> 45.71%             
client [96] (test)  loss: 2.7527 -> 2.8158   acc: 50.77% -> 50.77%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.7944 -> 3.8427   acc: 45.19% -> 45.19%              
client [53] (test)  loss: 3.4301 -> 3.6283   acc: 48.80% -> 48.20%             
client [52] (test)  loss: 4.1697 -> 4.3044   acc: 46.84% -> 47.51%             
client [42] (test)  loss: 2.9872 -> 3.0219   acc: 55.70% -> 56.35%             
client [69] (test)  loss: 1.9286 -> 1.9504   acc: 69.41% -> 69.41%             
client [59] (test)  loss: 3.1319 -> 3.1780   acc: 55.81% -> 55.48%             
client [7] (test)  loss: 3.3205 -> 3.3699   acc: 49.84% -> 49.84%              
client [26] (test)  loss: 4.1248 -> 4.2197   acc: 32.69% -> 32.69%             
client [49] (test)  loss: 3.8221 -> 3.9730   acc: 53.16% -> 53.45%             
client [98] (test)  loss: 5.0126 -> 5.0802   acc: 31.25% -> 31.25%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 5.0802 -> 5.1392   acc: 31.25% -> 31.25%             
client [47] (test)  loss: 4.2199 -> 4.3023   acc: 36.84% -> 36.47%             
client [21] (test)  loss: 3.7437 -> 3.9710   acc: 35.45% -> 36.31%             
client [77] (test)  loss: 3.2460 -> 3.3133   acc: 52.04% -> 52.98%             
client [95] (test)  loss: 3.9901 -> 4.0437   acc: 38.94% -> 38.94%             
client [91] (test)  loss: 3.5701 -> 3.6273   acc: 54.02% -> 53.38%             
client [14] (test)  loss: 5.1830 -> 5.2511   acc: 33.53% -> 33.53%             
client [99] (test)  loss: 5.5212 -> 5.6548   acc: 31.53% -> 31.85%             
client [20] (test)  loss: 2.0390 -> 2.0584   acc: 64.47% -> 64.47%             
client [39] (test)  loss: 4.3606 -> 4.4617   acc: 34.30% -> 34.30%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.3044 -> 4.4094   acc: 47.51% -> 47.51%             
client [62] (test)  loss: 4.6538 -> 4.7120   acc: 34.43% -> 34.43%             
client [71] (test)  loss: 4.7821 -> 4.8443   acc: 34.42% -> 34.74%             
client [97] (test)  loss: 4.0632 -> 4.1275   acc: 29.31% -> 29.74%             
client [30] (test)  loss: 4.7017 -> 4.7463   acc: 38.61% -> 38.92%             
client [88] (test)  loss: 3.6705 -> 3.7390   acc: 48.34% -> 48.34%             
client [60] (test)  loss: 4.7905 -> 4.8541   acc: 36.54% -> 36.54%             
client [82] (test)  loss: 3.9865 -> 4.0464   acc: 46.71% -> 46.71%             
client [91] (test)  loss: 3.6769 -> 3.7206   acc: 53.05% -> 53.05%             
client [57] (test)  loss: 3.5544 -> 3.6558   acc: 46.20% -> 46.20%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.0312 -> 4.0516   acc: 47.27% -> 47.27%             
client [15] (test)  loss: 4.2139 -> 4.3118   acc: 39.24% -> 39.56%             
client [71] (test)  loss: 4.8443 -> 4.8993   acc: 34.74% -> 34.42%             
client [97] (test)  loss: 4.2305 -> 4.2739   acc: 30.17% -> 30.17%             
client [53] (test)  loss: 3.9162 -> 3.9748   acc: 48.50% -> 48.50%             
client [77] (test)  loss: 3.3133 -> 3.3683   acc: 52.98% -> 52.98%             
client [76] (test)  loss: 4.1479 -> 4.2083   acc: 40.20% -> 40.20%             
client [79] (test)  loss: 2.1179 -> 2.1459   acc: 66.10% -> 66.10%             
client [28] (test)  loss: 4.4897 -> 4.5222   acc: 42.86% -> 42.86%             
client [99] (test)  loss: 5.7639 -> 5.8529   acc: 31.53% -> 31.53%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.3138 -> 4.3500   acc: 30.17% -> 30.17%             
client [86] (test)  loss: 3.7002 -> 3.7454   acc: 52.54% -> 52.24%             
client [34] (test)  loss: 4.2610 -> 4.2933   acc: 44.70% -> 44.70%             
client [73] (test)  loss: 4.7423 -> 4.7957   acc: 37.33% -> 37.33%             
client [5] (test)  loss: 3.6785 -> 3.7189   acc: 43.13% -> 43.45%              
client [96] (test)  loss: 3.0823 -> 3.1034   acc: 52.01% -> 52.01%             
client [22] (test)  loss: 4.5450 -> 4.6223   acc: 32.71% -> 33.02%             
client [60] (test)  loss: 5.0096 -> 5.0536   acc: 36.54% -> 37.18%             
client [66] (test)  loss: 3.2742 -> 3.3165   acc: 54.69% -> 54.69%             
client [83] (test)  loss: 3.6867 -> 3.7630   acc: 52.32% -> 51.99%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.3515 -> 4.3904   acc: 40.20% -> 40.20%             
client [65] (test)  loss: 5.1788 -> 5.2513   acc: 37.65% -> 37.25%             
client [95] (test)  loss: 4.1652 -> 4.1980   acc: 39.60% -> 39.60%             
client [17] (test)  loss: 4.0556 -> 4.1295   acc: 40.63% -> 40.95%             
client [8] (test)  loss: 3.9584 -> 3.9900   acc: 44.87% -> 44.87%              
client [35] (test)  loss: 3.5816 -> 3.6085   acc: 49.67% -> 49.67%             
client [98] (test)  loss: 5.2366 -> 5.2799   acc: 31.25% -> 31.25%             
client [53] (test)  loss: 4.0245 -> 4.0689   acc: 48.50% -> 48.50%             
client [43] (test)  loss: 4.5476 -> 4.5963   acc: 40.00% -> 40.00%             
client [64] (test)  loss: 3.1236 -> 3.1647   acc: 47.62% -> 47.90%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.1171 -> 4.2220   acc: 36.31% -> 36.31%             
client [88] (test)  loss: 3.9948 -> 4.0244   acc: 49.01% -> 49.01%             
client [38] (test)  loss: 4.0976 -> 4.1612   acc: 47.31% -> 47.88%             
client [3] (test)  loss: 4.6382 -> 4.6701   acc: 47.40% -> 48.01%              
client [5] (test)  loss: 3.7544 -> 3.7893   acc: 43.45% -> 43.45%              
client [41] (test)  loss: 4.4838 -> 4.5256   acc: 36.67% -> 36.67%             
client [7] (test)  loss: 3.4508 -> 3.4842   acc: 50.16% -> 50.16%              
client [37] (test)  loss: 4.1299 -> 4.1831   acc: 45.34% -> 45.34%             
client [45] (test)  loss: 3.0734 -> 3.1306   acc: 45.33% -> 46.00%             
client [47] (test)  loss: 4.4228 -> 4.4698   acc: 36.84% -> 36.84%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.7814 -> 3.8120   acc: 46.48% -> 46.48%             
client [11] (test)  loss: 3.9437 -> 3.9739   acc: 46.32% -> 46.32%             
client [37] (test)  loss: 4.2730 -> 4.3109   acc: 45.66% -> 45.66%             
client [41] (test)  loss: 4.5256 -> 4.5635   acc: 36.67% -> 36.67%             
client [95] (test)  loss: 4.2806 -> 4.3047   acc: 39.27% -> 39.60%             
client [53] (test)  loss: 4.0689 -> 4.1066   acc: 48.50% -> 48.50%             
client [22] (test)  loss: 4.6889 -> 4.7459   acc: 33.02% -> 33.02%             
client [25] (test)  loss: 3.2484 -> 3.2839   acc: 50.63% -> 50.63%             
client [69] (test)  loss: 2.0652 -> 2.0752   acc: 69.41% -> 69.12%             
client [46] (test)  loss: 3.3877 -> 3.4338   acc: 47.20% -> 47.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.6144 -> 4.6420   acc: 37.22% -> 37.22%             
client [69] (test)  loss: 2.0852 -> 2.0944   acc: 69.12% -> 69.12%             
client [82] (test)  loss: 4.2219 -> 4.2558   acc: 46.37% -> 46.37%             
client [45] (test)  loss: 3.2225 -> 3.2602   acc: 46.00% -> 46.00%             
client [7] (test)  loss: 3.4842 -> 3.5149   acc: 50.16% -> 50.16%              
client [50] (test)  loss: 3.4836 -> 3.5414   acc: 50.90% -> 50.90%             
client [35] (test)  loss: 3.6598 -> 3.6834   acc: 49.67% -> 49.67%             
client [24] (test)  loss: 3.7701 -> 3.7928   acc: 48.29% -> 48.67%             
client [15] (test)  loss: 4.5658 -> 4.6113   acc: 39.87% -> 40.19%             
client [58] (test)  loss: 3.9715 -> 3.9901   acc: 43.99% -> 43.99%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.2159 -> 5.2410   acc: 33.66% -> 33.66%             
client [76] (test)  loss: 4.4609 -> 4.4916   acc: 40.20% -> 40.20%             
client [67] (test)  loss: 3.5683 -> 3.5986   acc: 46.71% -> 46.71%             
client [37] (test)  loss: 4.3465 -> 4.3788   acc: 45.66% -> 45.98%             
client [58] (test)  loss: 4.0086 -> 4.0250   acc: 43.99% -> 44.30%             
client [64] (test)  loss: 3.2648 -> 3.2927   acc: 47.62% -> 47.90%             
client [77] (test)  loss: 3.5335 -> 3.5660   acc: 53.29% -> 53.61%             
client [55] (test)  loss: 3.4415 -> 3.4635   acc: 54.66% -> 54.66%             
client [12] (test)  loss: 3.0100 -> 3.0294   acc: 55.59% -> 55.92%             
client [89] (test)  loss: 5.7097 -> 5.7382   acc: 31.50% -> 31.80%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.6481 -> 4.6665   acc: 36.96% -> 36.96%             
client [51] (test)  loss: 5.1017 -> 5.1321   acc: 33.33% -> 33.33%             
client [8] (test)  loss: 4.1379 -> 4.1578   acc: 44.87% -> 44.87%              
client [18] (test)  loss: 3.0627 -> 3.0888   acc: 53.91% -> 53.91%             
client [94] (test)  loss: 4.5000 -> 4.5281   acc: 42.63% -> 43.27%             
client [81] (test)  loss: 4.3188 -> 4.3403   acc: 48.42% -> 48.10%             
client [3] (test)  loss: 4.7831 -> 4.8072   acc: 48.32% -> 48.32%              
client [11] (test)  loss: 4.0523 -> 4.0749   acc: 46.32% -> 46.63%             
client [95] (test)  loss: 4.4227 -> 4.4386   acc: 39.93% -> 39.93%             
client [67] (test)  loss: 3.5986 -> 3.6250   acc: 46.71% -> 47.65%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.3822 -> 4.4458   acc: 36.31% -> 36.31%             
client [79] (test)  loss: 2.3089 -> 2.3196   acc: 66.38% -> 66.38%             
client [58] (test)  loss: 4.0743 -> 4.0887   acc: 43.67% -> 43.67%             
client [88] (test)  loss: 4.0978 -> 4.1185   acc: 48.34% -> 48.34%             
client [46] (test)  loss: 3.5454 -> 3.5756   acc: 48.00% -> 48.00%             
client [11] (test)  loss: 4.0749 -> 4.0958   acc: 46.63% -> 46.93%             
client [55] (test)  loss: 3.5586 -> 3.5742   acc: 54.97% -> 54.97%             
client [13] (test)  loss: 4.2004 -> 4.2255   acc: 47.11% -> 47.11%             
client [31] (test)  loss: 4.1069 -> 4.1237   acc: 47.27% -> 47.27%             
client [75] (test)  loss: 3.4855 -> 3.5051   acc: 52.49% -> 52.49%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.8425 -> 4.8679   acc: 44.63% -> 44.30%             
client [7] (test)  loss: 3.6351 -> 3.6541   acc: 50.16% -> 49.84%              
client [57] (test)  loss: 4.0605 -> 4.0910   acc: 46.86% -> 46.86%             
client [13] (test)  loss: 4.2504 -> 4.2727   acc: 47.11% -> 47.11%             
client [43] (test)  loss: 4.8137 -> 4.8417   acc: 39.70% -> 39.70%             
client [91] (test)  loss: 3.8565 -> 3.8848   acc: 53.05% -> 53.05%             
client [10] (test)  loss: 4.7536 -> 4.7747   acc: 46.43% -> 46.43%             
client [64] (test)  loss: 3.4024 -> 3.4203   acc: 48.18% -> 48.18%             
client [82] (test)  loss: 4.4131 -> 4.4344   acc: 47.75% -> 48.10%             
client [22] (test)  loss: 4.9593 -> 4.9910   acc: 33.02% -> 33.33%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.1550 -> 2.1656   acc: 64.80% -> 65.13%             
client [23] (test)  loss: 4.3078 -> 4.3518   acc: 42.19% -> 42.19%             
client [88] (test)  loss: 4.1185 -> 4.1389   acc: 48.34% -> 48.34%             
client [98] (test)  loss: 5.5294 -> 5.5528   acc: 31.87% -> 31.87%             
client [79] (test)  loss: 2.3395 -> 2.3487   acc: 66.67% -> 66.67%             
client [21] (test)  loss: 4.5036 -> 4.5543   acc: 36.31% -> 36.60%             
client [92] (test)  loss: 5.2189 -> 5.2428   acc: 34.73% -> 34.73%             
client [56] (test)  loss: 4.1219 -> 4.1371   acc: 42.08% -> 42.08%             
client [5] (test)  loss: 3.9705 -> 3.9909   acc: 44.09% -> 44.09%              
client [52] (test)  loss: 4.9410 -> 4.9664   acc: 47.84% -> 47.51%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '3.9104 -> 0.0000', 'accuracy': '44.99% -> 0.00%'},          
    200: {'loss': '4.2494 -> 0.0000', 'accuracy': '45.33% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(15.07%) at epoch: 2                                     
FedFomo achieved 20.0%(20.33%) at epoch: 4                                     
FedFomo achieved 30.0%(31.87%) at epoch: 7                                     
FedFomo achieved 40.0%(41.58%) at epoch: 18                                    
FedFomo achieved 50.0%(51.91%) at epoch: 104                                   
Convergence (test_after):                                                      
FedFomo achieved 30.0%(31.81%) at epoch: 0                                     
FedFomo achieved 40.0%(41.63%) at epoch: 1                                     
FedFomo achieved 50.0%(50.09%) at epoch: 40                                    
