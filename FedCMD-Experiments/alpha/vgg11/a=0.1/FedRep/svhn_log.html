==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.0001,                                                        
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5252 -> 0.4800   acc: 80.49% -> 82.46%             
client [81] (test)  loss: 0.7166 -> 0.6128   acc: 89.11% -> 89.11%             
client [21] (test)  loss: 3.8151 -> 1.2811   acc: 9.78% -> 50.00%              
client [68] (test)  loss: 0.5429 -> 0.4151   acc: 93.14% -> 93.14%             
client [93] (test)  loss: 1.3576 -> 1.3997   acc: 45.76% -> 47.00%             
client [31] (test)  loss: 1.2409 -> 1.3190   acc: 58.54% -> 43.90%             
client [20] (test)  loss: 1.1599 -> 1.1754   acc: 68.06% -> 68.63%             
client [59] (test)  loss: 5.1219 -> 1.4742   acc: 1.26% -> 45.67%              
client [48] (test)  loss: 2.0319 -> 1.9648   acc: 31.96% -> 32.99%             
client [34] (test)  loss: 1.9350 -> 1.8371   acc: 36.73% -> 38.78%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.5121 -> 2.8732   acc: 44.92% -> 45.20%             
client [99] (test)  loss: 0.2986 -> 0.2690   acc: 95.26% -> 95.26%             
client [67] (test)  loss: 0.9680 -> 0.9305   acc: 63.27% -> 64.24%             
client [0] (test)  loss: 1.1179 -> 1.1120   acc: 58.10% -> 59.49%              
client [76] (test)  loss: 0.0906 -> 0.0853   acc: 99.10% -> 98.92%             
client [41] (test)  loss: 0.5476 -> 0.4814   acc: 87.33% -> 83.56%             
client [62] (test)  loss: 4.7903 -> 1.4225   acc: 4.40% -> 45.00%              
client [2] (test)  loss: 3.8344 -> 0.0090   acc: 3.47% -> 99.80%               
client [14] (test)  loss: 0.7726 -> 0.7621   acc: 86.96% -> 86.96%             
client [46] (test)  loss: 1.3513 -> 1.4325   acc: 64.17% -> 63.33%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4975 -> 0.5544   acc: 84.70% -> 84.43%             
client [68] (test)  loss: 0.4147 -> 0.3570   acc: 93.14% -> 93.14%             
client [57] (test)  loss: 0.8680 -> 0.8106   acc: 66.38% -> 69.53%             
client [17] (test)  loss: 0.4166 -> 0.4038   acc: 91.83% -> 91.83%             
client [54] (test)  loss: 0.5282 -> 0.5375   acc: 91.64% -> 91.64%             
client [23] (test)  loss: 2.2920 -> 0.8566   acc: 53.44% -> 70.99%             
client [35] (test)  loss: 0.0444 -> 0.0465   acc: 99.62% -> 99.62%             
client [59] (test)  loss: 1.1724 -> 1.2103   acc: 57.04% -> 50.72%             
client [31] (test)  loss: 0.9726 -> 1.4837   acc: 57.32% -> 41.46%             
client [9] (test)  loss: 1.3281 -> 1.2536   acc: 49.36% -> 53.18%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1315 -> 1.1517   acc: 60.73% -> 56.50%             
client [33] (test)  loss: 0.1217 -> 0.1201   acc: 97.12% -> 97.29%             
client [16] (test)  loss: 0.6333 -> 0.9751   acc: 75.68% -> 63.78%             
client [44] (test)  loss: 1.8752 -> 1.1418   acc: 45.45% -> 58.26%             
client [8] (test)  loss: 0.7356 -> 0.7523   acc: 82.69% -> 82.69%              
client [31] (test)  loss: 0.9237 -> 1.4643   acc: 56.10% -> 41.46%             
client [47] (test)  loss: 0.0024 -> 0.0014   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 2.2264 -> 1.7649   acc: 50.00% -> 50.00%             
client [20] (test)  loss: 1.0239 -> 0.9961   acc: 67.30% -> 69.77%             
client [56] (test)  loss: 0.0341 -> 0.0307   acc: 99.54% -> 99.54%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0159 -> 0.0161   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.1689 -> 0.0543   acc: 98.11% -> 100.00%            
client [28] (test)  loss: 0.7033 -> 0.8553   acc: 71.43% -> 69.42%             
client [25] (test)  loss: 0.1927 -> 0.1688   acc: 98.32% -> 98.32%             
client [58] (test)  loss: 0.6104 -> 0.9983   acc: 76.95% -> 48.49%             
client [44] (test)  loss: 1.1852 -> 1.1949   acc: 57.85% -> 55.37%             
client [39] (test)  loss: 0.9835 -> 1.0338   acc: 52.94% -> 55.88%             
client [29] (test)  loss: 0.2967 -> 0.2866   acc: 93.05% -> 93.05%             
client [3] (test)  loss: 0.8279 -> 0.7918   acc: 71.10% -> 71.63%              
client [84] (test)  loss: 1.6459 -> 1.5718   acc: 38.40% -> 42.97%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9823 -> 0.9208   acc: 65.22% -> 64.13%             
client [84] (test)  loss: 1.5187 -> 1.5339   acc: 46.01% -> 44.49%             
client [10] (test)  loss: 0.1515 -> 0.1781   acc: 94.69% -> 92.83%             
client [36] (test)  loss: 1.7053 -> 1.5649   acc: 50.00% -> 58.33%             
client [65] (test)  loss: 0.0288 -> 0.0283   acc: 99.66% -> 99.66%             
client [81] (test)  loss: 0.4723 -> 0.4765   acc: 90.10% -> 90.10%             
client [79] (test)  loss: 0.3524 -> 0.3447   acc: 88.13% -> 88.19%             
client [42] (test)  loss: 0.9185 -> 1.0219   acc: 67.80% -> 63.05%             
client [11] (test)  loss: 1.1583 -> 1.1964   acc: 63.84% -> 60.45%             
client [96] (test)  loss: 0.2600 -> 0.2564   acc: 94.89% -> 94.89%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6951 -> 0.6596   acc: 78.85% -> 80.77%              
client [53] (test)  loss: 0.4973 -> 0.4940   acc: 84.65% -> 83.84%             
client [52] (test)  loss: 0.3244 -> 0.4100   acc: 87.78% -> 84.42%             
client [42] (test)  loss: 0.8982 -> 0.9667   acc: 69.49% -> 63.73%             
client [69] (test)  loss: 0.9811 -> 1.4103   acc: 66.10% -> 57.34%             
client [59] (test)  loss: 0.9967 -> 1.0555   acc: 64.26% -> 61.01%             
client [7] (test)  loss: 0.0599 -> 0.0569   acc: 99.04% -> 99.04%              
client [26] (test)  loss: 0.2743 -> 0.2742   acc: 92.62% -> 93.23%             
client [49] (test)  loss: 0.4501 -> 0.4736   acc: 87.86% -> 87.22%             
client [98] (test)  loss: 0.3846 -> 0.3849   acc: 87.98% -> 88.57%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3781 -> 0.3718   acc: 87.40% -> 88.76%             
client [47] (test)  loss: 0.0013 -> 0.0009   acc: 100.00% -> 100.00%           
client [21] (test)  loss: 0.8890 -> 0.8642   acc: 69.57% -> 70.65%             
client [77] (test)  loss: 0.3160 -> 0.3396   acc: 88.52% -> 88.20%             
client [95] (test)  loss: 0.5821 -> 0.6545   acc: 78.28% -> 73.76%             
client [91] (test)  loss: 0.8725 -> 0.9217   acc: 72.32% -> 72.06%             
client [14] (test)  loss: 0.6218 -> 0.6390   acc: 87.25% -> 87.25%             
client [99] (test)  loss: 0.2295 -> 0.2226   acc: 94.83% -> 95.55%             
client [20] (test)  loss: 0.9309 -> 0.9552   acc: 69.20% -> 69.58%             
client [39] (test)  loss: 0.9162 -> 1.0851   acc: 61.76% -> 57.35%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3006 -> 0.3806   acc: 88.64% -> 85.63%             
client [62] (test)  loss: 1.0240 -> 1.0698   acc: 63.40% -> 62.40%             
client [71] (test)  loss: 0.9394 -> 1.0295   acc: 60.82% -> 53.30%             
client [97] (test)  loss: 0.0005 -> 0.0004   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 0.1961 -> 0.2000   acc: 92.25% -> 93.80%             
client [88] (test)  loss: 0.1188 -> 0.1110   acc: 96.30% -> 96.43%             
client [60] (test)  loss: 0.0247 -> 0.0194   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.7882 -> 0.8007   acc: 63.41% -> 65.85%             
client [91] (test)  loss: 0.8492 -> 0.8816   acc: 72.85% -> 72.85%             
client [57] (test)  loss: 0.6939 -> 0.6805   acc: 75.07% -> 75.45%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7797 -> 1.2750   acc: 67.07% -> 52.44%             
client [15] (test)  loss: 0.3219 -> 0.3365   acc: 88.50% -> 86.97%             
client [71] (test)  loss: 0.9338 -> 0.9973   acc: 61.28% -> 55.81%             
client [97] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.4397 -> 0.4451   acc: 86.67% -> 86.06%             
client [77] (test)  loss: 0.3006 -> 0.3240   acc: 89.18% -> 88.85%             
client [76] (test)  loss: 0.0655 -> 0.0669   acc: 98.74% -> 99.10%             
client [79] (test)  loss: 0.3096 -> 0.2950   acc: 89.39% -> 89.87%             
client [28] (test)  loss: 0.5169 -> 0.6697   acc: 79.28% -> 75.65%             
client [99] (test)  loss: 0.2112 -> 0.2090   acc: 95.26% -> 95.69%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 0.6299 -> 1.1615   acc: 77.08% -> 50.63%             
client [34] (test)  loss: 1.1142 -> 1.4590   acc: 59.18% -> 46.94%             
client [73] (test)  loss: 0.0463 -> 0.0455   acc: 99.56% -> 99.56%             
client [5] (test)  loss: 0.5938 -> 0.5791   acc: 80.38% -> 81.65%              
client [96] (test)  loss: 0.2403 -> 0.2462   acc: 94.89% -> 94.89%             
client [22] (test)  loss: 0.9480 -> 1.3287   acc: 68.92% -> 54.05%             
client [60] (test)  loss: 0.0140 -> 0.0121   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.9175 -> 1.0625   acc: 68.26% -> 64.51%             
client [83] (test)  loss: 1.1094 -> 1.2983   acc: 55.00% -> 42.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0607 -> 0.0660   acc: 98.92% -> 99.10%             
client [65] (test)  loss: 0.0249 -> 0.0260   acc: 99.66% -> 99.66%             
client [95] (test)  loss: 0.4677 -> 0.5067   acc: 84.16% -> 80.09%             
client [17] (test)  loss: 0.3290 -> 0.3056   acc: 92.61% -> 93.00%             
client [8] (test)  loss: 0.5805 -> 0.5569   acc: 82.69% -> 80.77%              
client [35] (test)  loss: 0.0363 -> 0.0363   acc: 99.62% -> 99.62%             
client [98] (test)  loss: 0.3204 -> 0.3388   acc: 89.34% -> 88.95%             
client [53] (test)  loss: 0.4037 -> 0.4167   acc: 87.88% -> 87.47%             
client [43] (test)  loss: 0.3698 -> 0.4128   acc: 84.43% -> 85.16%             
client [64] (test)  loss: 0.8250 -> 0.8365   acc: 75.53% -> 74.62%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7652 -> 0.7554   acc: 77.17% -> 78.26%             
client [88] (test)  loss: 0.0934 -> 0.0923   acc: 96.84% -> 96.98%             
client [38] (test)  loss: 0.0020 -> 0.0017   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.6021 -> 0.6123   acc: 77.76% -> 78.46%              
client [5] (test)  loss: 0.5273 -> 0.5690   acc: 83.54% -> 82.91%              
client [41] (test)  loss: 0.2814 -> 0.2745   acc: 91.68% -> 91.68%             
client [7] (test)  loss: 0.0463 -> 0.0465   acc: 98.72% -> 99.04%              
client [37] (test)  loss: 0.0315 -> 0.0308   acc: 99.64% -> 99.64%             
client [45] (test)  loss: 0.1784 -> 0.1784   acc: 94.92% -> 95.34%             
client [47] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4035 -> 0.4963   acc: 85.41% -> 82.16%             
client [11] (test)  loss: 0.9543 -> 1.2084   acc: 67.80% -> 62.15%             
client [37] (test)  loss: 0.0303 -> 0.0300   acc: 99.64% -> 99.64%             
client [41] (test)  loss: 0.2749 -> 0.2700   acc: 92.08% -> 91.09%             
client [95] (test)  loss: 0.4220 -> 0.4867   acc: 86.43% -> 81.45%             
client [53] (test)  loss: 0.4004 -> 0.3985   acc: 88.69% -> 87.47%             
client [22] (test)  loss: 0.9278 -> 1.2992   acc: 67.57% -> 54.05%             
client [25] (test)  loss: 0.1576 -> 0.1311   acc: 96.64% -> 97.48%             
client [69] (test)  loss: 0.8578 -> 1.2229   acc: 71.19% -> 64.69%             
client [46] (test)  loss: 0.9563 -> 0.9872   acc: 69.17% -> 60.00%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [69] (test)  loss: 0.8070 -> 1.1859   acc: 72.60% -> 65.82%             
client [82] (test)  loss: 0.7659 -> 0.8305   acc: 63.41% -> 65.85%             
client [45] (test)  loss: 0.1700 -> 0.1777   acc: 95.34% -> 94.49%             
client [7] (test)  loss: 0.0463 -> 0.0457   acc: 99.04% -> 99.04%              
client [50] (test)  loss: 0.7014 -> 0.6763   acc: 77.45% -> 72.55%             
client [35] (test)  loss: 0.0346 -> 0.0343   acc: 99.62% -> 99.62%             
client [24] (test)  loss: 0.3531 -> 0.4033   acc: 88.19% -> 86.31%             
client [15] (test)  loss: 0.2768 -> 0.2747   acc: 90.45% -> 90.03%             
client [58] (test)  loss: 0.4047 -> 0.6009   acc: 84.10% -> 73.45%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.2945 -> 1.4099   acc: 47.42% -> 46.39%             
client [76] (test)  loss: 0.0551 -> 0.0615   acc: 99.28% -> 99.10%             
client [67] (test)  loss: 0.5792 -> 0.7327   acc: 81.23% -> 73.95%             
client [37] (test)  loss: 0.0308 -> 0.0302   acc: 99.64% -> 99.64%             
client [58] (test)  loss: 0.3800 -> 0.5804   acc: 85.69% -> 74.88%             
client [64] (test)  loss: 0.7506 -> 0.7718   acc: 79.15% -> 77.34%             
client [77] (test)  loss: 0.2478 -> 0.2663   acc: 91.64% -> 91.80%             
client [55] (test)  loss: 0.0628 -> 0.0625   acc: 98.84% -> 98.84%             
client [12] (test)  loss: 0.3876 -> 0.3944   acc: 93.75% -> 93.75%             
client [89] (test)  loss: 0.2027 -> 0.2152   acc: 93.64% -> 93.82%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1985 -> 1.2409   acc: 54.18% -> 54.37%             
client [51] (test)  loss: 0.4882 -> 0.4778   acc: 85.89% -> 86.07%             
client [8] (test)  loss: 0.4947 -> 0.4470   acc: 80.77% -> 82.69%              
client [18] (test)  loss: 0.5603 -> 0.5377   acc: 80.38% -> 82.15%             
client [94] (test)  loss: 0.1703 -> 0.1631   acc: 94.89% -> 94.60%             
client [81] (test)  loss: 0.2734 -> 0.2689   acc: 90.10% -> 90.10%             
client [3] (test)  loss: 0.5394 -> 0.5505   acc: 80.74% -> 81.26%              
client [11] (test)  loss: 0.9097 -> 1.2340   acc: 69.49% -> 63.28%             
client [95] (test)  loss: 0.4093 -> 0.4777   acc: 87.78% -> 81.90%             
client [67] (test)  loss: 0.5797 -> 0.6905   acc: 81.88% -> 76.05%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6939 -> 0.7153   acc: 81.52% -> 80.43%             
client [79] (test)  loss: 0.2603 -> 0.2460   acc: 91.67% -> 92.33%             
client [58] (test)  loss: 0.3587 -> 0.5825   acc: 86.49% -> 73.93%             
client [88] (test)  loss: 0.0758 -> 0.0738   acc: 96.57% -> 96.84%             
client [46] (test)  loss: 0.9608 -> 0.9533   acc: 71.67% -> 63.33%             
client [11] (test)  loss: 0.9032 -> 1.2181   acc: 71.19% -> 64.97%             
client [55] (test)  loss: 0.0595 -> 0.0596   acc: 98.70% -> 98.70%             
client [13] (test)  loss: 0.2526 -> 0.2969   acc: 93.30% -> 90.83%             
client [31] (test)  loss: 0.7159 -> 0.9805   acc: 73.17% -> 63.41%             
client [75] (test)  loss: 0.6914 -> 0.6916   acc: 79.78% -> 79.78%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4638 -> 0.4962   acc: 80.50% -> 77.48%             
client [7] (test)  loss: 0.0398 -> 0.0395   acc: 98.88% -> 98.88%              
client [57] (test)  loss: 0.5751 -> 0.5763   acc: 76.60% -> 79.37%             
client [13] (test)  loss: 0.2498 -> 0.2877   acc: 92.95% -> 91.36%             
client [43] (test)  loss: 0.3058 -> 0.2921   acc: 85.71% -> 88.10%             
client [91] (test)  loss: 0.6725 -> 0.7041   acc: 79.11% -> 79.11%             
client [10] (test)  loss: 0.1057 -> 0.1219   acc: 96.41% -> 94.98%             
client [64] (test)  loss: 0.6990 -> 0.7233   acc: 79.46% -> 78.85%             
client [82] (test)  loss: 0.7928 -> 0.9773   acc: 60.98% -> 60.98%             
client [22] (test)  loss: 0.9575 -> 1.1424   acc: 67.57% -> 59.46%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7768 -> 0.8965   acc: 74.33% -> 71.48%             
client [23] (test)  loss: 0.4234 -> 0.4322   acc: 86.64% -> 84.73%             
client [88] (test)  loss: 0.0751 -> 0.0730   acc: 96.98% -> 96.98%             
client [98] (test)  loss: 0.2843 -> 0.3034   acc: 91.28% -> 90.31%             
client [79] (test)  loss: 0.2397 -> 0.2393   acc: 92.81% -> 92.87%             
client [21] (test)  loss: 0.7156 -> 0.6933   acc: 77.17% -> 80.43%             
client [92] (test)  loss: 0.7031 -> 0.8669   acc: 75.77% -> 71.65%             
client [56] (test)  loss: 0.0199 -> 0.0193   acc: 99.54% -> 99.63%             
client [5] (test)  loss: 0.5188 -> 0.5212   acc: 84.18% -> 84.18%              
client [52] (test)  loss: 0.2057 -> 0.2228   acc: 93.03% -> 92.51%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3965 -> 0.0000', 'accuracy': '86.42% -> 0.00%'},          
    200: {'loss': '0.3229 -> 0.0000', 'accuracy': '89.14% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 20.0%(26.71%) at epoch: 1                                      
FedRep achieved 40.0%(45.26%) at epoch: 3                                      
FedRep achieved 60.0%(60.13%) at epoch: 4                                      
FedRep achieved 80.0%(81.26%) at epoch: 7                                      
FedRep achieved 90.0%(91.08%) at epoch: 46                                     
Convergence (test_after):                                                      
FedRep achieved 70.0%(73.16%) at epoch: 0                                      
FedRep achieved 80.0%(81.11%) at epoch: 3                                      
FedRep achieved 90.0%(90.73%) at epoch: 46                                     
