==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8000 -> 0.9158   acc: 66.96% -> 71.37%             
client [81] (test)  loss: 1.7042 -> 1.3933   acc: 52.23% -> 52.23%             
client [21] (test)  loss: 2.5880 -> 0.5370   acc: 20.56% -> 86.45%             
client [68] (test)  loss: 0.8570 -> 0.8611   acc: 72.22% -> 74.36%             
client [93] (test)  loss: 0.5336 -> 0.5713   acc: 85.16% -> 83.98%             
client [31] (test)  loss: 2.3180 -> 2.2149   acc: 57.95% -> 58.52%             
client [20] (test)  loss: 0.2659 -> 0.2510   acc: 93.33% -> 93.85%             
client [59] (test)  loss: 2.4597 -> 0.1847   acc: 15.82% -> 96.97%             
client [48] (test)  loss: 0.9921 -> 0.8991   acc: 74.42% -> 75.58%             
client [34] (test)  loss: 0.6360 -> 0.5967   acc: 81.25% -> 83.33%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.0000 -> 0.6997   acc: 70.63% -> 77.32%             
client [99] (test)  loss: 1.6506 -> 1.7200   acc: 42.94% -> 39.41%             
client [67] (test)  loss: 1.4084 -> 1.6712   acc: 68.29% -> 68.29%             
client [0] (test)  loss: 0.6782 -> 0.6494   acc: 78.49% -> 80.26%              
client [76] (test)  loss: 0.5872 -> 0.5683   acc: 73.56% -> 74.71%             
client [41] (test)  loss: 1.0343 -> 1.0694   acc: 66.55% -> 67.60%             
client [62] (test)  loss: 2.0430 -> 0.3923   acc: 30.04% -> 87.90%             
client [2] (test)  loss: 2.5795 -> 1.2190   acc: 22.50% -> 67.50%              
client [14] (test)  loss: 0.0836 -> 0.0812   acc: 96.94% -> 97.11%             
client [46] (test)  loss: 0.2528 -> 0.2370   acc: 91.00% -> 92.89%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6650 -> 0.8177   acc: 77.43% -> 77.12%             
client [68] (test)  loss: 0.6583 -> 0.7447   acc: 80.34% -> 77.78%             
client [57] (test)  loss: 0.4990 -> 0.4962   acc: 77.26% -> 81.05%             
client [17] (test)  loss: 0.1811 -> 0.1612   acc: 94.09% -> 94.23%             
client [54] (test)  loss: 0.4731 -> 0.4911   acc: 83.28% -> 82.28%             
client [23] (test)  loss: 2.1161 -> 1.5922   acc: 37.14% -> 51.43%             
client [35] (test)  loss: 0.5982 -> 0.6268   acc: 81.69% -> 78.87%             
client [59] (test)  loss: 0.1478 -> 0.1424   acc: 96.46% -> 97.14%             
client [31] (test)  loss: 0.8201 -> 1.2270   acc: 67.61% -> 61.93%             
client [9] (test)  loss: 0.2178 -> 0.1908   acc: 93.61% -> 94.81%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7823 -> 0.8257   acc: 70.37% -> 74.07%             
client [33] (test)  loss: 0.5386 -> 0.6990   acc: 84.31% -> 88.89%             
client [16] (test)  loss: 0.3950 -> 0.4086   acc: 89.94% -> 89.94%             
client [44] (test)  loss: 0.0848 -> 0.0765   acc: 98.78% -> 98.78%             
client [8] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.8164 -> 1.4057   acc: 72.16% -> 61.36%             
client [47] (test)  loss: 0.7136 -> 0.6749   acc: 83.15% -> 83.51%             
client [36] (test)  loss: 0.2740 -> 0.2777   acc: 93.04% -> 92.17%             
client [20] (test)  loss: 0.1700 -> 0.1515   acc: 96.92% -> 96.41%             
client [56] (test)  loss: 0.3359 -> 0.5075   acc: 91.48% -> 88.64%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4289 -> 0.4634   acc: 90.67% -> 89.78%              
client [60] (test)  loss: 0.3372 -> 0.3396   acc: 91.67% -> 91.25%             
client [28] (test)  loss: 0.9599 -> 1.0255   acc: 68.98% -> 68.45%             
client [25] (test)  loss: 0.5433 -> 0.5070   acc: 81.43% -> 83.33%             
client [58] (test)  loss: 1.0580 -> 1.0409   acc: 71.51% -> 69.27%             
client [44] (test)  loss: 0.0799 -> 0.0790   acc: 98.78% -> 98.66%             
client [39] (test)  loss: 0.4084 -> 0.4659   acc: 87.23% -> 86.02%             
client [29] (test)  loss: 0.5885 -> 0.6093   acc: 87.14% -> 86.19%             
client [3] (test)  loss: 0.3430 -> 0.3311   acc: 89.35% -> 89.03%              
client [84] (test)  loss: 0.8455 -> 0.9473   acc: 75.71% -> 75.14%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4595 -> 0.6343   acc: 85.98% -> 85.05%             
client [84] (test)  loss: 0.8232 -> 0.9362   acc: 74.01% -> 75.14%             
client [10] (test)  loss: 0.4094 -> 0.4153   acc: 83.24% -> 82.85%             
client [36] (test)  loss: 0.2748 -> 0.2710   acc: 92.17% -> 91.30%             
client [65] (test)  loss: 0.4836 -> 0.6240   acc: 83.14% -> 78.82%             
client [81] (test)  loss: 1.0869 -> 1.2782   acc: 60.71% -> 56.25%             
client [79] (test)  loss: 0.8890 -> 0.9401   acc: 72.51% -> 74.27%             
client [42] (test)  loss: 0.0878 -> 0.0913   acc: 97.87% -> 97.87%             
client [11] (test)  loss: 0.6995 -> 0.6801   acc: 78.48% -> 79.24%             
client [96] (test)  loss: 0.7352 -> 0.8278   acc: 72.12% -> 72.12%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.0804 -> 0.0833   acc: 96.26% -> 97.20%             
client [52] (test)  loss: 0.3523 -> 0.3442   acc: 88.85% -> 88.70%             
client [42] (test)  loss: 0.0889 -> 0.0943   acc: 97.55% -> 97.65%             
client [69] (test)  loss: 0.5797 -> 0.5833   acc: 82.90% -> 81.41%             
client [59] (test)  loss: 0.1198 -> 0.1172   acc: 97.31% -> 97.31%             
client [7] (test)  loss: 0.7828 -> 0.8776   acc: 75.00% -> 75.00%              
client [26] (test)  loss: 0.6344 -> 0.6148   acc: 82.89% -> 81.58%             
client [49] (test)  loss: 0.0314 -> 0.0319   acc: 99.64% -> 99.64%             
client [98] (test)  loss: 0.7529 -> 2.9752   acc: 70.15% -> 70.15%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7899 -> 1.6602   acc: 73.13% -> 71.64%             
client [47] (test)  loss: 0.6550 -> 0.6833   acc: 84.95% -> 83.15%             
client [21] (test)  loss: 0.4658 -> 0.6829   acc: 85.05% -> 84.11%             
client [77] (test)  loss: 0.4613 -> 0.5301   acc: 84.58% -> 82.82%             
client [95] (test)  loss: 0.4290 -> 0.4289   acc: 89.83% -> 88.47%             
client [91] (test)  loss: 0.4339 -> 0.4784   acc: 88.67% -> 84.67%             
client [14] (test)  loss: 0.0304 -> 0.0294   acc: 98.64% -> 98.81%             
client [99] (test)  loss: 1.4699 -> 1.6941   acc: 55.29% -> 50.00%             
client [20] (test)  loss: 0.1574 -> 0.1416   acc: 96.41% -> 96.92%             
client [39] (test)  loss: 0.4819 -> 0.4074   acc: 86.93% -> 90.27%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3514 -> 0.3483   acc: 89.01% -> 90.40%             
client [62] (test)  loss: 0.1664 -> 0.1730   acc: 96.17% -> 95.97%             
client [71] (test)  loss: 0.1428 -> 0.1347   acc: 97.56% -> 97.97%             
client [97] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 0.2913 -> 0.2853   acc: 84.00% -> 88.00%             
client [88] (test)  loss: 0.4442 -> 0.5041   acc: 89.86% -> 84.06%             
client [60] (test)  loss: 0.3177 -> 0.3313   acc: 93.33% -> 92.92%             
client [82] (test)  loss: 0.8855 -> 0.9652   acc: 70.79% -> 68.54%             
client [91] (test)  loss: 0.4381 -> 0.5120   acc: 90.00% -> 85.33%             
client [57] (test)  loss: 0.4793 -> 0.4882   acc: 82.11% -> 84.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9291 -> 1.1740   acc: 76.14% -> 73.30%             
client [15] (test)  loss: 0.5371 -> 0.5342   acc: 81.93% -> 83.13%             
client [71] (test)  loss: 0.1312 -> 0.1264   acc: 97.56% -> 97.97%             
client [97] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.0523 -> 0.0492   acc: 99.07% -> 99.07%             
client [77] (test)  loss: 0.4557 -> 0.4977   acc: 85.02% -> 83.70%             
client [76] (test)  loss: 0.5438 -> 0.5285   acc: 78.16% -> 80.92%             
client [79] (test)  loss: 0.9763 -> 0.9634   acc: 74.85% -> 74.85%             
client [28] (test)  loss: 0.9821 -> 1.0942   acc: 68.98% -> 66.31%             
client [99] (test)  loss: 1.5372 -> 1.7875   acc: 57.65% -> 46.47%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 0.9796 -> 1.0432   acc: 70.16% -> 70.16%             
client [34] (test)  loss: 0.5059 -> 0.4767   acc: 86.11% -> 87.85%             
client [73] (test)  loss: 1.2113 -> 1.2924   acc: 61.36% -> 56.82%             
client [5] (test)  loss: 0.4360 -> 0.4663   acc: 82.80% -> 83.87%              
client [96] (test)  loss: 0.7820 -> 0.8441   acc: 73.08% -> 74.04%             
client [22] (test)  loss: 0.1357 -> 0.1420   acc: 96.99% -> 96.99%             
client [60] (test)  loss: 0.3299 -> 0.3358   acc: 94.17% -> 93.75%             
client [66] (test)  loss: 0.2997 -> 0.2949   acc: 91.79% -> 92.07%             
client [83] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5602 -> 0.5090   acc: 81.38% -> 78.85%             
client [65] (test)  loss: 0.4627 -> 0.6181   acc: 83.53% -> 80.78%             
client [95] (test)  loss: 0.5148 -> 0.4460   acc: 89.49% -> 89.83%             
client [17] (test)  loss: 0.1369 -> 0.1329   acc: 96.29% -> 95.60%             
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.5372 -> 0.5928   acc: 81.69% -> 78.87%             
client [98] (test)  loss: 0.6982 -> 2.8902   acc: 74.63% -> 71.64%             
client [53] (test)  loss: 0.0469 -> 0.0467   acc: 98.13% -> 98.13%             
client [43] (test)  loss: 0.7874 -> 1.5921   acc: 76.03% -> 68.18%             
client [64] (test)  loss: 0.4859 -> 0.4861   acc: 81.48% -> 77.78%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5060 -> 0.5698   acc: 88.32% -> 83.64%             
client [88] (test)  loss: 0.4840 -> 0.5219   acc: 88.41% -> 86.96%             
client [38] (test)  loss: 1.7697 -> 1.7692   acc: 71.43% -> 71.43%             
client [3] (test)  loss: 0.3227 -> 0.3254   acc: 90.00% -> 90.32%              
client [5] (test)  loss: 0.4000 -> 0.4191   acc: 84.95% -> 86.02%              
client [41] (test)  loss: 0.9198 -> 0.9283   acc: 75.61% -> 71.78%             
client [7] (test)  loss: 0.8292 -> 0.8424   acc: 83.33% -> 79.17%              
client [37] (test)  loss: 0.9028 -> 0.8486   acc: 71.58% -> 73.16%             
client [45] (test)  loss: 0.1982 -> 0.1830   acc: 93.31% -> 92.97%             
client [47] (test)  loss: 0.6740 -> 0.6902   acc: 86.38% -> 84.59%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4469 -> 0.4737   acc: 85.47% -> 86.03%             
client [11] (test)  loss: 0.8321 -> 0.8407   acc: 82.03% -> 80.76%             
client [37] (test)  loss: 0.9457 -> 0.8923   acc: 72.63% -> 70.53%             
client [41] (test)  loss: 0.9078 -> 0.9465   acc: 73.87% -> 71.43%             
client [95] (test)  loss: 0.5680 -> 0.4891   acc: 88.81% -> 89.49%             
client [53] (test)  loss: 0.0406 -> 0.0403   acc: 99.07% -> 99.07%             
client [22] (test)  loss: 0.1798 -> 0.1747   acc: 96.24% -> 95.49%             
client [25] (test)  loss: 0.5648 -> 0.5136   acc: 80.16% -> 83.97%             
client [69] (test)  loss: 0.6664 -> 0.6624   acc: 84.76% -> 82.90%             
client [46] (test)  loss: 0.1848 -> 0.1655   acc: 93.84% -> 95.73%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7108 -> 0.7413   acc: 84.23% -> 84.23%             
client [69] (test)  loss: 0.6669 -> 0.7024   acc: 84.01% -> 84.01%             
client [82] (test)  loss: 0.9357 -> 1.0124   acc: 71.35% -> 69.10%             
client [45] (test)  loss: 0.1944 -> 0.1871   acc: 93.14% -> 93.48%             
client [7] (test)  loss: 0.8122 -> 0.8062   acc: 81.94% -> 80.56%              
client [50] (test)  loss: 0.2511 -> 0.2375   acc: 92.92% -> 93.22%             
client [35] (test)  loss: 0.4926 -> 0.5394   acc: 85.92% -> 80.28%             
client [24] (test)  loss: 0.7030 -> 0.7380   acc: 83.86% -> 82.45%             
client [15] (test)  loss: 0.5893 -> 0.5897   acc: 83.13% -> 85.54%             
client [58] (test)  loss: 1.3326 -> 1.3412   acc: 75.98% -> 74.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5971 -> 0.5828   acc: 81.40% -> 83.72%             
client [76] (test)  loss: 0.5718 -> 0.6312   acc: 82.30% -> 83.91%             
client [67] (test)  loss: 0.8643 -> 1.0479   acc: 70.73% -> 70.73%             
client [37] (test)  loss: 0.9351 -> 0.9389   acc: 71.58% -> 72.63%             
client [58] (test)  loss: 1.3528 -> 1.3505   acc: 76.54% -> 74.86%             
client [64] (test)  loss: 0.4343 -> 0.4315   acc: 81.48% -> 85.19%             
client [77] (test)  loss: 0.4718 -> 0.5308   acc: 84.58% -> 84.14%             
client [55] (test)  loss: 1.3469 -> 1.4327   acc: 55.56% -> 57.14%             
client [12] (test)  loss: 0.8030 -> 1.7249   acc: 81.75% -> 61.11%             
client [89] (test)  loss: 0.3406 -> 0.3820   acc: 89.09% -> 89.09%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9402 -> 0.9788   acc: 77.40% -> 76.27%             
client [51] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 1.0137 -> 1.0691   acc: 70.11% -> 70.65%             
client [94] (test)  loss: 0.4061 -> 0.4066   acc: 88.46% -> 88.46%             
client [81] (test)  loss: 1.4160 -> 1.7187   acc: 63.84% -> 59.38%             
client [3] (test)  loss: 0.3172 -> 0.3269   acc: 90.97% -> 91.29%              
client [11] (test)  loss: 0.8921 -> 0.9301   acc: 81.77% -> 81.27%             
client [95] (test)  loss: 0.5802 -> 0.5561   acc: 89.15% -> 89.49%             
client [67] (test)  loss: 0.8929 -> 1.0791   acc: 70.73% -> 68.29%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5571 -> 0.6028   acc: 84.58% -> 85.98%             
client [79] (test)  loss: 1.1879 -> 1.1799   acc: 76.02% -> 73.68%             
client [58] (test)  loss: 1.4731 -> 1.4729   acc: 75.42% -> 75.42%             
client [88] (test)  loss: 0.5331 -> 0.6021   acc: 88.41% -> 86.96%             
client [46] (test)  loss: 0.1692 -> 0.1707   acc: 97.16% -> 96.68%             
client [11] (test)  loss: 0.9307 -> 0.9543   acc: 81.77% -> 81.52%             
client [55] (test)  loss: 1.5055 -> 1.6148   acc: 57.14% -> 55.56%             
client [13] (test)  loss: 1.0321 -> 1.1753   acc: 74.28% -> 64.45%             
client [31] (test)  loss: 1.1378 -> 6.0709   acc: 80.11% -> 59.09%             
client [75] (test)  loss: 0.3370 -> 0.3087   acc: 93.86% -> 93.61%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7682 -> 0.7376   acc: 78.63% -> 81.20%             
client [7] (test)  loss: 0.8307 -> 0.8227   acc: 83.33% -> 83.33%              
client [57] (test)  loss: 0.5989 -> 0.6630   acc: 82.53% -> 81.26%             
client [13] (test)  loss: 1.0235 -> 1.3277   acc: 72.54% -> 69.65%             
client [43] (test)  loss: 0.8607 -> 1.0407   acc: 78.10% -> 78.51%             
client [91] (test)  loss: 0.5180 -> 0.5479   acc: 90.00% -> 87.33%             
client [10] (test)  loss: 0.5459 -> 0.5819   acc: 86.32% -> 84.01%             
client [64] (test)  loss: 0.4480 -> 0.4382   acc: 85.19% -> 81.48%             
client [82] (test)  loss: 1.0792 -> 1.0659   acc: 71.91% -> 71.35%             
client [22] (test)  loss: 0.1832 -> 0.1966   acc: 96.24% -> 95.49%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1474 -> 0.1436   acc: 97.44% -> 97.44%             
client [23] (test)  loss: 1.0088 -> 0.9325   acc: 77.14% -> 77.14%             
client [88] (test)  loss: 0.4896 -> 0.5522   acc: 88.41% -> 88.41%             
client [98] (test)  loss: 0.7550 -> 1.0104   acc: 74.63% -> 76.12%             
client [79] (test)  loss: 1.1843 -> 1.1801   acc: 74.27% -> 76.61%             
client [21] (test)  loss: 0.6360 -> 0.6154   acc: 82.24% -> 85.51%             
client [92] (test)  loss: 0.0983 -> 0.0998   acc: 98.60% -> 98.60%             
client [56] (test)  loss: 0.2856 -> 0.3158   acc: 94.32% -> 92.05%             
client [5] (test)  loss: 0.4331 -> 0.4378   acc: 84.95% -> 86.02%              
client [52] (test)  loss: 0.4401 -> 0.4478   acc: 91.33% -> 90.40%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3699 -> 0.0000', 'accuracy': '89.12% -> 0.00%'},          
    200: {'loss': '0.4360 -> 0.0000', 'accuracy': '89.66% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(13.05%) at epoch: 1                                      
FedRep achieved 20.0%(22.68%) at epoch: 2                                      
FedRep achieved 60.0%(61.29%) at epoch: 4                                      
FedRep achieved 80.0%(80.72%) at epoch: 13                                     
FedRep achieved 90.0%(93.01%) at epoch: 39                                     
Convergence (test_after):                                                      
FedRep achieved 70.0%(72.40%) at epoch: 0                                      
FedRep achieved 80.0%(83.01%) at epoch: 1                                      
FedRep achieved 90.0%(93.10%) at epoch: 11                                     
