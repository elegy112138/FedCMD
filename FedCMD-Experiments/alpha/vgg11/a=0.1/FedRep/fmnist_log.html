==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0020 -> 0.0009   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.9561 -> 1.1167   acc: 54.55% -> 35.45%             
client [21] (test)  loss: 2.3016 -> 1.1762   acc: 26.09% -> 40.34%             
client [68] (test)  loss: 0.6413 -> 0.2086   acc: 89.20% -> 94.08%             
client [93] (test)  loss: 0.4692 -> 0.2368   acc: 85.60% -> 97.60%             
client [31] (test)  loss: 1.3137 -> 1.0157   acc: 82.22% -> 60.56%             
client [20] (test)  loss: 0.2822 -> 0.1378   acc: 96.83% -> 96.83%             
client [59] (test)  loss: 2.0530 -> 0.7691   acc: 26.13% -> 75.48%             
client [48] (test)  loss: 0.1804 -> 0.4021   acc: 98.75% -> 98.75%             
client [34] (test)  loss: 0.3429 -> 0.2812   acc: 92.65% -> 92.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.3197 -> 0.7700   acc: 57.33% -> 63.47%             
client [99] (test)  loss: 0.1101 -> 0.1022   acc: 98.01% -> 98.01%             
client [67] (test)  loss: 0.2828 -> 0.2325   acc: 90.18% -> 91.82%             
client [0] (test)  loss: 1.1111 -> 1.5613   acc: 57.01% -> 32.71%              
client [76] (test)  loss: 0.6205 -> 0.4736   acc: 84.21% -> 84.21%             
client [41] (test)  loss: 0.5084 -> 0.3828   acc: 83.16% -> 83.16%             
client [62] (test)  loss: 0.9830 -> 0.4550   acc: 85.71% -> 92.86%             
client [2] (test)  loss: 2.7099 -> 0.0008   acc: 0.00% -> 100.00%              
client [14] (test)  loss: 0.1754 -> 0.1466   acc: 92.35% -> 94.23%             
client [46] (test)  loss: 0.6675 -> 0.4645   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5791 -> 0.5705   acc: 81.61% -> 81.35%             
client [68] (test)  loss: 0.1793 -> 0.1478   acc: 94.43% -> 94.43%             
client [57] (test)  loss: 0.0399 -> 0.0399   acc: 99.25% -> 99.44%             
client [17] (test)  loss: 0.6862 -> 0.5356   acc: 80.66% -> 83.70%             
client [54] (test)  loss: 0.2958 -> 0.2745   acc: 83.42% -> 85.49%             
client [23] (test)  loss: 2.0446 -> 0.1673   acc: 0.38% -> 95.49%              
client [35] (test)  loss: 0.2451 -> 0.3445   acc: 93.33% -> 89.09%             
client [59] (test)  loss: 0.5144 -> 0.5837   acc: 86.45% -> 81.29%             
client [31] (test)  loss: 0.3241 -> 0.6580   acc: 91.67% -> 68.89%             
client [9] (test)  loss: 0.0933 -> 0.0706   acc: 96.27% -> 96.89%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1815 -> 0.4886   acc: 94.71% -> 85.59%             
client [33] (test)  loss: 0.1581 -> 0.1499   acc: 95.66% -> 95.89%             
client [16] (test)  loss: 0.0698 -> 0.0712   acc: 97.90% -> 98.25%             
client [44] (test)  loss: 0.3681 -> 0.2039   acc: 91.58% -> 94.14%             
client [8] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.3780 -> 0.9789   acc: 85.56% -> 60.56%             
client [47] (test)  loss: 0.0339 -> 0.0333   acc: 99.08% -> 99.26%             
client [36] (test)  loss: 0.0742 -> 0.0345   acc: 97.79% -> 97.79%             
client [20] (test)  loss: 0.0551 -> 0.0513   acc: 96.83% -> 98.17%             
client [56] (test)  loss: 0.5133 -> 0.4405   acc: 80.08% -> 85.77%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1943 -> 0.1328   acc: 93.77% -> 94.46%              
client [60] (test)  loss: 0.1322 -> 0.1293   acc: 96.91% -> 97.10%             
client [28] (test)  loss: 0.1151 -> 0.1152   acc: 97.32% -> 95.54%             
client [25] (test)  loss: 0.6725 -> 0.1825   acc: 75.96% -> 94.77%             
client [58] (test)  loss: 0.1678 -> 0.1395   acc: 96.17% -> 95.62%             
client [44] (test)  loss: 0.2562 -> 0.2200   acc: 91.94% -> 93.04%             
client [39] (test)  loss: 0.2212 -> 0.2087   acc: 94.44% -> 94.44%             
client [29] (test)  loss: 0.3855 -> 0.5458   acc: 89.50% -> 79.00%             
client [3] (test)  loss: 0.7372 -> 0.6136   acc: 72.83% -> 79.53%              
client [84] (test)  loss: 0.0511 -> 0.0484   acc: 99.08% -> 99.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.0652 -> 1.0540   acc: 62.08% -> 64.49%             
client [84] (test)  loss: 0.0665 -> 0.0601   acc: 99.08% -> 99.54%             
client [10] (test)  loss: 0.1339 -> 0.0830   acc: 97.10% -> 96.38%             
client [36] (test)  loss: 0.0428 -> 0.0190   acc: 99.51% -> 99.51%             
client [65] (test)  loss: 0.2828 -> 0.2825   acc: 95.24% -> 94.05%             
client [81] (test)  loss: 0.2564 -> 0.2397   acc: 90.91% -> 90.00%             
client [79] (test)  loss: 0.5156 -> 0.4209   acc: 79.85% -> 83.54%             
client [42] (test)  loss: 0.0231 -> 0.0335   acc: 99.41% -> 98.27%             
client [11] (test)  loss: 0.5640 -> 1.2870   acc: 75.56% -> 68.00%             
client [96] (test)  loss: 0.3147 -> 0.3554   acc: 91.85% -> 90.73%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.0717 -> 0.0662   acc: 98.99% -> 99.09%             
client [52] (test)  loss: 0.3135 -> 0.2956   acc: 86.05% -> 86.82%             
client [42] (test)  loss: 0.0342 -> 0.0277   acc: 98.51% -> 98.75%             
client [69] (test)  loss: 0.5094 -> 1.8014   acc: 76.00% -> 47.73%             
client [59] (test)  loss: 0.3976 -> 0.4005   acc: 86.13% -> 87.42%             
client [7] (test)  loss: 0.0888 -> 0.0588   acc: 96.87% -> 97.79%              
client [26] (test)  loss: 0.0773 -> 0.4048   acc: 98.47% -> 94.84%             
client [49] (test)  loss: 0.0009 -> 0.0006   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.5505 -> 0.6479   acc: 64.00% -> 64.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6377 -> 0.5436   acc: 63.00% -> 63.00%             
client [47] (test)  loss: 0.0332 -> 0.0286   acc: 99.26% -> 99.26%             
client [21] (test)  loss: 0.5248 -> 0.5249   acc: 76.81% -> 80.68%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.2797 -> 0.2781   acc: 91.73% -> 93.23%             
client [91] (test)  loss: 0.0696 -> 0.0452   acc: 100.00% -> 100.00%           
client [14] (test)  loss: 0.1090 -> 0.1092   acc: 97.45% -> 97.58%             
client [99] (test)  loss: 0.0968 -> 0.0893   acc: 98.01% -> 98.30%             
client [20] (test)  loss: 0.0254 -> 0.0289   acc: 99.50% -> 99.33%             
client [39] (test)  loss: 0.1878 -> 0.1846   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3068 -> 0.2850   acc: 87.60% -> 86.82%             
client [62] (test)  loss: 0.2615 -> 0.2558   acc: 92.86% -> 92.86%             
client [71] (test)  loss: 0.0502 -> 0.0482   acc: 97.65% -> 97.65%             
client [97] (test)  loss: 0.0831 -> 0.0760   acc: 98.19% -> 98.52%             
client [30] (test)  loss: 0.1413 -> 0.1467   acc: 94.38% -> 94.76%             
client [88] (test)  loss: 0.6215 -> 0.7324   acc: 69.06% -> 64.09%             
client [60] (test)  loss: 0.1078 -> 0.1593   acc: 96.71% -> 97.10%             
client [82] (test)  loss: 0.0292 -> 0.0304   acc: 99.68% -> 99.68%             
client [91] (test)  loss: 0.0447 -> 0.0310   acc: 100.00% -> 100.00%           
client [57] (test)  loss: 0.0306 -> 0.0443   acc: 99.25% -> 99.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1553 -> 0.1591   acc: 93.89% -> 94.44%             
client [15] (test)  loss: 0.2311 -> 0.1985   acc: 90.87% -> 89.17%             
client [71] (test)  loss: 0.0477 -> 0.0468   acc: 97.83% -> 97.65%             
client [97] (test)  loss: 0.0967 -> 0.0766   acc: 98.52% -> 98.69%             
client [53] (test)  loss: 0.0656 -> 0.0611   acc: 98.99% -> 98.99%             
client [77] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.2063 -> 0.1933   acc: 94.74% -> 94.74%             
client [79] (test)  loss: 0.4915 -> 0.3992   acc: 84.77% -> 84.03%             
client [28] (test)  loss: 0.0533 -> 0.0543   acc: 97.32% -> 98.21%             
client [99] (test)  loss: 0.1105 -> 0.0900   acc: 98.01% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0729 -> 0.0677   acc: 98.52% -> 98.69%             
client [86] (test)  loss: 0.2686 -> 0.1984   acc: 92.98% -> 92.98%             
client [34] (test)  loss: 0.1537 -> 0.1570   acc: 89.71% -> 88.24%             
client [73] (test)  loss: 0.0511 -> 0.0264   acc: 99.29% -> 99.29%             
client [5] (test)  loss: 0.0411 -> 0.0371   acc: 99.34% -> 99.34%              
client [96] (test)  loss: 0.2337 -> 0.5041   acc: 92.98% -> 87.08%             
client [22] (test)  loss: 0.1586 -> 0.1369   acc: 94.81% -> 96.23%             
client [60] (test)  loss: 0.0990 -> 0.1279   acc: 96.71% -> 97.29%             
client [66] (test)  loss: 0.0019 -> 0.0011   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0484 -> 0.0445   acc: 98.52% -> 98.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2042 -> 0.1900   acc: 92.11% -> 94.74%             
client [65] (test)  loss: 0.2620 -> 0.2682   acc: 96.43% -> 96.43%             
client [95] (test)  loss: 0.2262 -> 0.2907   acc: 94.74% -> 92.48%             
client [17] (test)  loss: 0.1797 -> 0.9508   acc: 93.09% -> 62.15%             
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.1623 -> 0.1568   acc: 93.33% -> 93.94%             
client [98] (test)  loss: 0.6058 -> 0.4490   acc: 64.00% -> 67.00%             
client [53] (test)  loss: 0.0599 -> 0.0585   acc: 98.99% -> 99.09%             
client [43] (test)  loss: 0.2877 -> 0.2902   acc: 89.63% -> 91.11%             
client [64] (test)  loss: 0.1560 -> 0.2222   acc: 96.47% -> 94.71%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4921 -> 0.5011   acc: 81.64% -> 83.57%             
client [88] (test)  loss: 0.5287 -> 0.8812   acc: 76.24% -> 59.67%             
client [38] (test)  loss: 0.3982 -> 0.4219   acc: 87.27% -> 88.48%             
client [3] (test)  loss: 0.2972 -> 0.3669   acc: 88.77% -> 87.86%              
client [5] (test)  loss: 0.0338 -> 0.0348   acc: 99.34% -> 99.13%              
client [41] (test)  loss: 0.2367 -> 0.3801   acc: 91.58% -> 88.60%             
client [7] (test)  loss: 0.0580 -> 0.0452   acc: 97.42% -> 98.16%              
client [37] (test)  loss: 0.1242 -> 0.1239   acc: 94.33% -> 95.36%             
client [45] (test)  loss: 0.3354 -> 0.3510   acc: 87.18% -> 85.90%             
client [47] (test)  loss: 0.0301 -> 0.0261   acc: 99.26% -> 99.26%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0496 -> 0.0490   acc: 98.60% -> 98.25%             
client [11] (test)  loss: 0.3778 -> 0.4116   acc: 84.67% -> 83.33%             
client [37] (test)  loss: 0.1313 -> 0.1335   acc: 94.85% -> 95.36%             
client [41] (test)  loss: 0.2120 -> 0.4025   acc: 92.36% -> 87.31%             
client [95] (test)  loss: 0.2418 -> 0.2788   acc: 93.23% -> 92.48%             
client [53] (test)  loss: 0.0553 -> 0.0555   acc: 98.99% -> 99.09%             
client [22] (test)  loss: 0.1050 -> 0.1133   acc: 96.70% -> 97.17%             
client [25] (test)  loss: 0.1344 -> 0.1152   acc: 95.82% -> 96.86%             
client [69] (test)  loss: 0.2088 -> 0.2505   acc: 93.07% -> 92.00%             
client [46] (test)  loss: 0.3087 -> 0.3155   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0223 -> 0.0230   acc: 99.26% -> 99.26%             
client [69] (test)  loss: 0.1990 -> 0.2177   acc: 93.33% -> 93.07%             
client [82] (test)  loss: 0.0301 -> 0.0326   acc: 99.68% -> 99.68%             
client [45] (test)  loss: 0.3242 -> 0.3085   acc: 87.18% -> 87.18%             
client [7] (test)  loss: 0.0565 -> 0.0454   acc: 97.42% -> 98.16%              
client [50] (test)  loss: 0.0014 -> 0.0009   acc: 100.00% -> 100.00%           
client [35] (test)  loss: 0.1571 -> 0.1472   acc: 93.94% -> 95.15%             
client [24] (test)  loss: 0.4330 -> 0.4449   acc: 83.94% -> 84.46%             
client [15] (test)  loss: 0.2466 -> 0.1860   acc: 85.14% -> 89.38%             
client [58] (test)  loss: 0.0824 -> 0.0783   acc: 97.81% -> 97.45%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1023 -> 0.1183   acc: 98.12% -> 98.12%             
client [76] (test)  loss: 0.1855 -> 0.1717   acc: 94.74% -> 94.74%             
client [67] (test)  loss: 0.1260 -> 0.1272   acc: 95.83% -> 95.68%             
client [37] (test)  loss: 0.1309 -> 0.1101   acc: 92.78% -> 96.91%             
client [58] (test)  loss: 0.0917 -> 0.0883   acc: 96.90% -> 97.26%             
client [64] (test)  loss: 0.1544 -> 0.1932   acc: 96.76% -> 95.59%             
client [77] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.0137 -> 0.0081   acc: 99.52% -> 99.81%             
client [12] (test)  loss: 0.3528 -> 0.3443   acc: 89.08% -> 88.23%             
client [89] (test)  loss: 0.5374 -> 0.6838   acc: 78.57% -> 88.10%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0381 -> 0.0378   acc: 99.54% -> 99.54%             
client [51] (test)  loss: 0.0271 -> 0.0239   acc: 99.23% -> 99.23%             
client [8] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.0125 -> 0.0127   acc: 99.76% -> 99.76%             
client [94] (test)  loss: 0.2344 -> 0.2001   acc: 93.26% -> 95.04%             
client [81] (test)  loss: 0.0530 -> 0.1585   acc: 97.27% -> 93.64%             
client [3] (test)  loss: 0.2383 -> 0.2051   acc: 91.12% -> 93.30%              
client [11] (test)  loss: 0.3740 -> 0.5199   acc: 84.22% -> 71.11%             
client [95] (test)  loss: 0.2305 -> 0.2828   acc: 94.74% -> 92.48%             
client [67] (test)  loss: 0.1362 -> 0.1145   acc: 94.79% -> 96.73%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4005 -> 0.4303   acc: 85.27% -> 85.27%             
client [79] (test)  loss: 0.3694 -> 0.3597   acc: 86.73% -> 87.96%             
client [58] (test)  loss: 0.0800 -> 0.0933   acc: 97.45% -> 97.45%             
client [88] (test)  loss: 0.5049 -> 0.7276   acc: 77.35% -> 64.09%             
client [46] (test)  loss: 0.2948 -> 0.3666   acc: 91.19% -> 91.19%             
client [11] (test)  loss: 0.3990 -> 0.3647   acc: 83.78% -> 85.33%             
client [55] (test)  loss: 0.0053 -> 0.0045   acc: 99.90% -> 99.90%             
client [13] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [31] (test)  loss: 0.1313 -> 0.1284   acc: 95.56% -> 96.67%             
client [75] (test)  loss: 0.3288 -> 0.3057   acc: 88.86% -> 89.59%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3587 -> 0.3499   acc: 86.61% -> 88.98%             
client [7] (test)  loss: 0.0424 -> 0.0376   acc: 98.53% -> 98.71%              
client [57] (test)  loss: 0.0336 -> 0.0363   acc: 99.62% -> 99.62%             
client [13] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [43] (test)  loss: 0.2504 -> 0.2773   acc: 92.59% -> 92.59%             
client [91] (test)  loss: 0.0054 -> 0.0050   acc: 100.00% -> 100.00%           
client [10] (test)  loss: 0.0559 -> 0.0548   acc: 97.83% -> 97.83%             
client [64] (test)  loss: 0.1583 -> 0.1781   acc: 96.47% -> 95.88%             
client [82] (test)  loss: 0.0347 -> 0.0362   acc: 99.68% -> 99.68%             
client [22] (test)  loss: 0.0994 -> 0.1001   acc: 97.64% -> 97.17%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0241 -> 0.0302   acc: 99.17% -> 98.67%             
client [23] (test)  loss: 0.1087 -> 0.1171   acc: 97.37% -> 96.99%             
client [88] (test)  loss: 0.5298 -> 0.6168   acc: 75.69% -> 74.59%             
client [98] (test)  loss: 0.4084 -> 0.3612   acc: 81.00% -> 82.00%             
client [79] (test)  loss: 0.3411 -> 0.3545   acc: 86.73% -> 86.98%             
client [21] (test)  loss: 0.2769 -> 0.3510   acc: 89.37% -> 86.96%             
client [92] (test)  loss: 0.7463 -> 1.2095   acc: 46.58% -> 45.21%             
client [56] (test)  loss: 0.3292 -> 0.3458   acc: 90.24% -> 88.21%             
client [5] (test)  loss: 0.0341 -> 0.0318   acc: 99.34% -> 99.13%              
client [52] (test)  loss: 0.2683 -> 0.2534   acc: 88.37% -> 89.15%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1434 -> 0.0000', 'accuracy': '94.83% -> 0.00%'},          
    200: {'loss': '0.1231 -> 0.0000', 'accuracy': '95.56% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(15.89%) at epoch: 1                                      
FedRep achieved 30.0%(30.38%) at epoch: 3                                      
FedRep achieved 60.0%(60.52%) at epoch: 4                                      
FedRep achieved 70.0%(74.66%) at epoch: 7                                      
FedRep achieved 80.0%(81.15%) at epoch: 13                                     
FedRep achieved 90.0%(91.06%) at epoch: 24                                     
Convergence (test_after):                                                      
FedRep achieved 70.0%(70.01%) at epoch: 0                                      
FedRep achieved 80.0%(83.89%) at epoch: 3                                      
FedRep achieved 90.0%(94.02%) at epoch: 8                                      
