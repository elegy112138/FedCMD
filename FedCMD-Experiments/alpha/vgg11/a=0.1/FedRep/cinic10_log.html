==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.4913 -> 0.4369   acc: 84.66% -> 84.31%             
client [81] (test)  loss: 0.1408 -> 0.1233   acc: 95.64% -> 95.93%             
client [21] (test)  loss: 3.0916 -> 0.7979   acc: 6.98% -> 76.64%              
client [68] (test)  loss: 0.4944 -> 0.4747   acc: 80.79% -> 82.76%             
client [93] (test)  loss: 0.4784 -> 0.4133   acc: 82.21% -> 84.82%             
client [31] (test)  loss: 3.9747 -> 0.8219   acc: 40.74% -> 69.14%             
client [20] (test)  loss: 0.3263 -> 0.3453   acc: 89.29% -> 89.12%             
client [59] (test)  loss: 3.1280 -> 1.1078   acc: 14.06% -> 61.43%             
client [48] (test)  loss: 1.1567 -> 1.0461   acc: 55.56% -> 59.26%             
client [34] (test)  loss: 0.0554 -> 0.0457   acc: 99.18% -> 99.13%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5534 -> 1.1320   acc: 52.87% -> 60.92%             
client [99] (test)  loss: 0.3282 -> 0.2895   acc: 88.83% -> 90.76%             
client [67] (test)  loss: 0.3972 -> 0.3480   acc: 86.65% -> 89.02%             
client [0] (test)  loss: 0.5367 -> 0.5166   acc: 82.19% -> 84.10%              
client [76] (test)  loss: 0.8378 -> 0.9619   acc: 66.85% -> 64.29%             
client [41] (test)  loss: 1.0769 -> 1.1206   acc: 60.55% -> 55.03%             
client [62] (test)  loss: 1.9384 -> 0.1721   acc: 33.20% -> 95.28%             
client [2] (test)  loss: 1.6088 -> 0.5301   acc: 26.67% -> 93.33%              
client [14] (test)  loss: 1.0416 -> 1.1573   acc: 62.97% -> 59.87%             
client [46] (test)  loss: 0.0134 -> 0.0109   acc: 99.78% -> 99.78%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7064 -> 0.7906   acc: 71.17% -> 68.92%             
client [68] (test)  loss: 0.4338 -> 0.4698   acc: 84.54% -> 82.24%             
client [57] (test)  loss: 0.8006 -> 0.6947   acc: 75.00% -> 75.00%             
client [17] (test)  loss: 0.4819 -> 0.4803   acc: 85.35% -> 86.61%             
client [54] (test)  loss: 0.3325 -> 0.4512   acc: 88.68% -> 83.65%             
client [23] (test)  loss: 3.9137 -> 0.1187   acc: 4.28% -> 97.73%              
client [35] (test)  loss: 0.7613 -> 0.8622   acc: 71.95% -> 68.97%             
client [59] (test)  loss: 1.0277 -> 1.0319   acc: 63.96% -> 64.16%             
client [31] (test)  loss: 0.5688 -> 0.6150   acc: 81.48% -> 72.84%             
client [9] (test)  loss: 0.2178 -> 0.2192   acc: 92.08% -> 91.88%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6955 -> 0.7250   acc: 77.96% -> 77.46%             
client [33] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [16] (test)  loss: 0.8254 -> 0.8616   acc: 71.54% -> 70.73%             
client [44] (test)  loss: 0.3518 -> 0.3011   acc: 88.51% -> 88.98%             
client [8] (test)  loss: 0.1475 -> 0.1433   acc: 95.88% -> 96.24%              
client [31] (test)  loss: 0.5332 -> 0.5675   acc: 82.72% -> 79.01%             
client [47] (test)  loss: 0.4755 -> 0.4568   acc: 84.92% -> 86.25%             
client [36] (test)  loss: 0.4804 -> 0.4527   acc: 81.69% -> 83.46%             
client [20] (test)  loss: 0.2594 -> 0.2900   acc: 92.33% -> 91.83%             
client [56] (test)  loss: 0.8450 -> 0.9345   acc: 64.92% -> 59.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3072 -> 0.3541   acc: 92.69% -> 91.03%              
client [60] (test)  loss: 0.6014 -> 0.6012   acc: 79.58% -> 80.89%             
client [28] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [25] (test)  loss: 0.5383 -> 0.5687   acc: 83.82% -> 82.87%             
client [58] (test)  loss: 0.6597 -> 0.7082   acc: 75.45% -> 73.28%             
client [44] (test)  loss: 0.3105 -> 0.3006   acc: 89.30% -> 89.62%             
client [39] (test)  loss: 0.2992 -> 0.2919   acc: 90.05% -> 90.46%             
client [29] (test)  loss: 0.0251 -> 0.0257   acc: 99.78% -> 99.78%             
client [3] (test)  loss: 0.6103 -> 0.5921   acc: 75.06% -> 76.00%              
client [84] (test)  loss: 0.4418 -> 0.4400   acc: 87.67% -> 87.42%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4425 -> 0.6332   acc: 88.99% -> 83.89%             
client [84] (test)  loss: 0.4355 -> 0.4490   acc: 87.06% -> 87.79%             
client [10] (test)  loss: 0.3911 -> 0.3909   acc: 86.61% -> 87.59%             
client [36] (test)  loss: 0.4248 -> 0.4136   acc: 85.63% -> 86.02%             
client [65] (test)  loss: 0.0007 -> 0.0005   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.1123 -> 0.1109   acc: 96.86% -> 97.01%             
client [79] (test)  loss: 0.5730 -> 0.5817   acc: 81.34% -> 80.41%             
client [42] (test)  loss: 0.4672 -> 0.5227   acc: 83.63% -> 81.49%             
client [11] (test)  loss: 0.0964 -> 0.0998   acc: 96.74% -> 96.74%             
client [96] (test)  loss: 0.6051 -> 0.5642   acc: 79.74% -> 81.66%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1401 -> 0.1417   acc: 96.48% -> 96.61%              
client [53] (test)  loss: 0.2372 -> 0.2461   acc: 93.23% -> 93.29%             
client [52] (test)  loss: 0.4599 -> 0.4843   acc: 83.06% -> 81.96%             
client [42] (test)  loss: 0.4857 -> 0.5365   acc: 84.70% -> 81.85%             
client [69] (test)  loss: 1.0282 -> 1.0992   acc: 70.11% -> 67.82%             
client [59] (test)  loss: 1.0096 -> 1.0257   acc: 65.09% -> 65.69%             
client [7] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [26] (test)  loss: 0.5099 -> 0.5054   acc: 81.76% -> 82.08%             
client [49] (test)  loss: 0.4468 -> 0.4743   acc: 83.04% -> 83.98%             
client [98] (test)  loss: 0.5569 -> 0.5915   acc: 78.05% -> 76.40%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5682 -> 0.6051   acc: 77.03% -> 76.65%             
client [47] (test)  loss: 0.4740 -> 0.4310   acc: 85.59% -> 87.36%             
client [21] (test)  loss: 0.4493 -> 0.4692   acc: 88.19% -> 87.92%             
client [77] (test)  loss: 0.3505 -> 0.3394   acc: 88.16% -> 87.30%             
client [95] (test)  loss: 0.2478 -> 0.2599   acc: 92.73% -> 92.25%             
client [91] (test)  loss: 0.7097 -> 0.7252   acc: 77.24% -> 77.24%             
client [14] (test)  loss: 0.9395 -> 1.0749   acc: 69.09% -> 65.25%             
client [99] (test)  loss: 0.2889 -> 0.3092   acc: 91.45% -> 91.91%             
client [20] (test)  loss: 0.2894 -> 0.3133   acc: 93.01% -> 92.56%             
client [39] (test)  loss: 0.3181 -> 0.3189   acc: 90.20% -> 89.70%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4710 -> 0.4971   acc: 84.07% -> 81.87%             
client [62] (test)  loss: 0.1778 -> 0.1803   acc: 95.44% -> 95.73%             
client [71] (test)  loss: 0.9199 -> 1.2026   acc: 67.38% -> 58.96%             
client [97] (test)  loss: 0.6423 -> 0.7042   acc: 73.23% -> 71.94%             
client [30] (test)  loss: 0.1863 -> 0.1906   acc: 94.23% -> 94.43%             
client [88] (test)  loss: 0.3596 -> 0.3507   acc: 89.32% -> 88.95%             
client [60] (test)  loss: 0.6072 -> 0.6806   acc: 80.03% -> 79.69%             
client [82] (test)  loss: 0.7244 -> 0.7255   acc: 75.77% -> 75.63%             
client [91] (test)  loss: 0.7106 -> 0.7510   acc: 76.84% -> 77.90%             
client [57] (test)  loss: 0.6703 -> 0.6642   acc: 80.00% -> 80.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5515 -> 0.5793   acc: 85.19% -> 81.48%             
client [15] (test)  loss: 0.4352 -> 0.4113   acc: 91.49% -> 92.29%             
client [71] (test)  loss: 0.8664 -> 1.1807   acc: 68.45% -> 60.67%             
client [97] (test)  loss: 0.6044 -> 0.6827   acc: 77.10% -> 74.19%             
client [53] (test)  loss: 0.2555 -> 0.2639   acc: 93.17% -> 92.93%             
client [77] (test)  loss: 0.3439 -> 0.3469   acc: 87.80% -> 87.16%             
client [76] (test)  loss: 0.8438 -> 0.9775   acc: 69.41% -> 66.37%             
client [79] (test)  loss: 0.6225 -> 0.6359   acc: 80.22% -> 79.85%             
client [28] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [99] (test)  loss: 0.3177 -> 0.3270   acc: 91.14% -> 91.14%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6016 -> 0.6422   acc: 76.45% -> 74.84%             
client [86] (test)  loss: 0.3010 -> 0.2782   acc: 90.00% -> 92.00%             
client [34] (test)  loss: 0.0455 -> 0.0468   acc: 99.13% -> 99.18%             
client [73] (test)  loss: 0.2535 -> 0.2849   acc: 92.94% -> 92.46%             
client [5] (test)  loss: 0.5439 -> 0.5382   acc: 84.69% -> 84.09%              
client [96] (test)  loss: 0.6308 -> 0.6417   acc: 80.73% -> 81.46%             
client [22] (test)  loss: 0.5367 -> 0.6055   acc: 85.19% -> 83.64%             
client [60] (test)  loss: 0.6573 -> 0.6990   acc: 80.43% -> 80.38%             
client [66] (test)  loss: 0.9345 -> 0.9373   acc: 66.86% -> 66.86%             
client [83] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8688 -> 0.9971   acc: 70.75% -> 67.72%             
client [65] (test)  loss: 0.0003 -> 0.0002   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.2740 -> 0.2869   acc: 91.84% -> 92.49%             
client [17] (test)  loss: 0.5189 -> 0.4850   acc: 86.61% -> 87.05%             
client [8] (test)  loss: 0.1422 -> 0.1390   acc: 96.61% -> 96.73%              
client [35] (test)  loss: 0.7792 -> 0.8563   acc: 76.27% -> 73.58%             
client [98] (test)  loss: 0.5966 -> 0.5931   acc: 76.90% -> 75.89%             
client [53] (test)  loss: 0.2608 -> 0.2772   acc: 93.05% -> 92.93%             
client [43] (test)  loss: 0.4710 -> 0.4720   acc: 86.94% -> 87.79%             
client [64] (test)  loss: 0.7152 -> 0.7594   acc: 79.47% -> 79.72%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4614 -> 0.4884   acc: 88.72% -> 89.53%             
client [88] (test)  loss: 0.3679 -> 0.3846   acc: 89.42% -> 90.25%             
client [38] (test)  loss: 0.2374 -> 0.2567   acc: 94.94% -> 93.56%             
client [3] (test)  loss: 0.6883 -> 0.8266   acc: 74.94% -> 72.10%              
client [5] (test)  loss: 0.5907 -> 0.5799   acc: 84.75% -> 84.16%              
client [41] (test)  loss: 1.0507 -> 1.0590   acc: 67.53% -> 68.51%             
client [7] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [37] (test)  loss: 0.2817 -> 0.2875   acc: 91.21% -> 91.63%             
client [45] (test)  loss: 0.6754 -> 0.8129   acc: 77.93% -> 74.86%             
client [47] (test)  loss: 0.4890 -> 0.4382   acc: 87.14% -> 88.25%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8526 -> 0.8839   acc: 74.80% -> 73.98%             
client [11] (test)  loss: 0.0881 -> 0.0941   acc: 97.34% -> 97.41%             
client [37] (test)  loss: 0.2659 -> 0.2611   acc: 91.21% -> 92.05%             
client [41] (test)  loss: 1.0897 -> 1.0877   acc: 66.07% -> 68.51%             
client [95] (test)  loss: 0.2909 -> 0.3077   acc: 92.31% -> 92.55%             
client [53] (test)  loss: 0.2685 -> 0.2859   acc: 92.87% -> 93.05%             
client [22] (test)  loss: 0.5691 -> 0.6508   acc: 84.77% -> 82.65%             
client [25] (test)  loss: 0.5346 -> 0.5374   acc: 85.62% -> 85.93%             
client [69] (test)  loss: 1.1645 -> 1.1879   acc: 67.82% -> 66.67%             
client [46] (test)  loss: 0.0060 -> 0.0055   acc: 99.71% -> 99.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4559 -> 0.4592   acc: 87.58% -> 88.47%             
client [69] (test)  loss: 1.2341 -> 1.2637   acc: 66.67% -> 67.82%             
client [82] (test)  loss: 0.7885 -> 0.8030   acc: 75.20% -> 76.05%             
client [45] (test)  loss: 0.7241 -> 0.8351   acc: 77.09% -> 77.37%             
client [7] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [50] (test)  loss: 0.7938 -> 0.8096   acc: 68.00% -> 68.00%             
client [35] (test)  loss: 0.8518 -> 0.9257   acc: 74.16% -> 72.33%             
client [24] (test)  loss: 0.8399 -> 1.0266   acc: 70.27% -> 68.92%             
client [15] (test)  loss: 0.4349 -> 0.4337   acc: 91.49% -> 92.55%             
client [58] (test)  loss: 0.7550 -> 0.8427   acc: 75.76% -> 75.45%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0533 -> 1.0400   acc: 70.37% -> 70.37%             
client [76] (test)  loss: 0.9691 -> 1.0417   acc: 71.02% -> 68.53%             
client [67] (test)  loss: 0.3547 -> 0.3707   acc: 90.39% -> 89.93%             
client [37] (test)  loss: 0.2725 -> 0.2873   acc: 91.21% -> 92.05%             
client [58] (test)  loss: 0.7929 -> 0.8445   acc: 76.22% -> 75.99%             
client [64] (test)  loss: 0.7542 -> 0.8455   acc: 78.97% -> 78.46%             
client [77] (test)  loss: 0.3911 -> 0.3961   acc: 88.80% -> 87.73%             
client [55] (test)  loss: 0.2361 -> 0.2512   acc: 94.64% -> 94.56%             
client [12] (test)  loss: 0.7649 -> 0.8615   acc: 74.85% -> 70.76%             
client [89] (test)  loss: 0.7257 -> 0.8220   acc: 80.21% -> 79.89%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5367 -> 0.5676   acc: 88.39% -> 87.79%             
client [51] (test)  loss: 0.1232 -> 0.1246   acc: 96.72% -> 97.08%             
client [8] (test)  loss: 0.1638 -> 0.1562   acc: 96.61% -> 96.73%              
client [18] (test)  loss: 0.1043 -> 0.1054   acc: 97.32% -> 97.32%             
client [94] (test)  loss: 0.8875 -> 0.9729   acc: 73.79% -> 76.70%             
client [81] (test)  loss: 0.1529 -> 0.1598   acc: 97.01% -> 97.16%             
client [3] (test)  loss: 0.7496 -> 0.7615   acc: 75.53% -> 75.53%              
client [11] (test)  loss: 0.0976 -> 0.1006   acc: 97.34% -> 97.47%             
client [95] (test)  loss: 0.3237 -> 0.3416   acc: 92.13% -> 92.43%             
client [67] (test)  loss: 0.3682 -> 0.3871   acc: 90.48% -> 89.79%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5134 -> 0.5343   acc: 88.32% -> 88.86%             
client [79] (test)  loss: 0.7977 -> 0.8169   acc: 78.73% -> 77.24%             
client [58] (test)  loss: 0.8847 -> 0.9033   acc: 75.99% -> 76.61%             
client [88] (test)  loss: 0.4058 -> 0.4135   acc: 88.86% -> 89.69%             
client [46] (test)  loss: 0.0061 -> 0.0056   acc: 99.78% -> 99.71%             
client [11] (test)  loss: 0.0971 -> 0.1007   acc: 97.47% -> 97.54%             
client [55] (test)  loss: 0.2671 -> 0.2704   acc: 94.47% -> 94.18%             
client [13] (test)  loss: 0.1894 -> 0.1871   acc: 95.87% -> 96.15%             
client [31] (test)  loss: 0.6865 -> 0.7329   acc: 82.72% -> 80.25%             
client [75] (test)  loss: 1.0701 -> 1.2118   acc: 71.62% -> 67.82%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7712 -> 0.8626   acc: 74.99% -> 73.93%             
client [7] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [57] (test)  loss: 0.6452 -> 0.6486   acc: 90.00% -> 90.00%             
client [13] (test)  loss: 0.1827 -> 0.1897   acc: 96.12% -> 96.21%             
client [43] (test)  loss: 0.5017 -> 0.5175   acc: 86.94% -> 88.44%             
client [91] (test)  loss: 0.8699 -> 0.8898   acc: 76.18% -> 76.92%             
client [10] (test)  loss: 0.4941 -> 0.5273   acc: 87.53% -> 87.53%             
client [64] (test)  loss: 0.7788 -> 0.8582   acc: 79.09% -> 79.97%             
client [82] (test)  loss: 0.9165 -> 1.0082   acc: 75.77% -> 75.27%             
client [22] (test)  loss: 0.6434 -> 0.7345   acc: 83.64% -> 82.51%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3760 -> 0.3977   acc: 93.57% -> 93.52%             
client [23] (test)  loss: 0.0896 -> 0.1009   acc: 98.24% -> 98.32%             
client [88] (test)  loss: 0.4213 -> 0.4257   acc: 88.67% -> 89.42%             
client [98] (test)  loss: 0.6974 -> 0.7205   acc: 74.75% -> 74.49%             
client [79] (test)  loss: 0.8203 -> 0.8433   acc: 79.10% -> 77.05%             
client [21] (test)  loss: 0.5257 -> 0.5473   acc: 87.65% -> 89.40%             
client [92] (test)  loss: 0.4036 -> 0.4621   acc: 91.19% -> 91.06%             
client [56] (test)  loss: 1.0891 -> 1.1131   acc: 70.60% -> 67.74%             
client [5] (test)  loss: 0.7315 -> 0.7454   acc: 83.23% -> 84.29%              
client [52] (test)  loss: 0.6675 -> 0.6905   acc: 84.88% -> 81.77%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3564 -> 0.0000', 'accuracy': '88.89% -> 0.00%'},          
    200: {'loss': '0.4423 -> 0.0000', 'accuracy': '88.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(15.86%) at epoch: 0                                      
FedRep achieved 30.0%(34.70%) at epoch: 2                                      
FedRep achieved 50.0%(52.28%) at epoch: 3                                      
FedRep achieved 60.0%(60.49%) at epoch: 4                                      
FedRep achieved 70.0%(78.13%) at epoch: 7                                      
FedRep achieved 80.0%(86.29%) at epoch: 13                                     
FedRep achieved 90.0%(93.87%) at epoch: 24                                     
Convergence (test_after):                                                      
FedRep achieved 80.0%(81.99%) at epoch: 0                                      
FedRep achieved 90.0%(90.34%) at epoch: 10                                     
