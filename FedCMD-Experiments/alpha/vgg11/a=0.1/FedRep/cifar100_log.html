==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.4030 -> 2.1995   acc: 37.62% -> 45.45%             
client [81] (test)  loss: 2.7840 -> 2.5505   acc: 37.66% -> 39.56%             
client [21] (test)  loss: 5.1917 -> 2.3425   acc: 3.75% -> 36.60%              
client [68] (test)  loss: 2.4213 -> 2.2649   acc: 38.98% -> 37.38%             
client [93] (test)  loss: 3.2764 -> 3.0118   acc: 22.11% -> 24.49%             
client [31] (test)  loss: 5.5649 -> 2.6113   acc: 7.72% -> 34.73%              
client [20] (test)  loss: 1.5854 -> 1.5695   acc: 63.49% -> 54.93%             
client [59] (test)  loss: 3.9932 -> 2.1989   acc: 20.97% -> 46.45%             
client [48] (test)  loss: 2.9963 -> 3.0292   acc: 21.90% -> 21.90%             
client [34] (test)  loss: 2.7651 -> 2.5425   acc: 26.49% -> 30.46%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6278 -> 1.2089   acc: 66.29% -> 68.56%             
client [99] (test)  loss: 3.4207 -> 3.1153   acc: 25.16% -> 31.21%             
client [67] (test)  loss: 2.1240 -> 2.0161   acc: 43.26% -> 43.57%             
client [0] (test)  loss: 2.4716 -> 2.4910   acc: 42.34% -> 38.29%              
client [76] (test)  loss: 2.4418 -> 2.4324   acc: 35.22% -> 39.20%             
client [41] (test)  loss: 2.7155 -> 2.4424   acc: 31.67% -> 40.33%             
client [62] (test)  loss: 4.5340 -> 2.6027   acc: 6.23% -> 31.48%              
client [2] (test)  loss: 4.9518 -> 3.1209   acc: 1.92% -> 28.85%               
client [14] (test)  loss: 2.6711 -> 3.0124   acc: 32.94% -> 27.06%             
client [46] (test)  loss: 2.1954 -> 2.2720   acc: 46.80% -> 46.80%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.0612 -> 2.2082   acc: 41.44% -> 40.68%             
client [68] (test)  loss: 1.8037 -> 2.0073   acc: 53.35% -> 45.69%             
client [57] (test)  loss: 2.1625 -> 2.2869   acc: 46.20% -> 41.91%             
client [17] (test)  loss: 2.4480 -> 2.2269   acc: 31.75% -> 37.78%             
client [54] (test)  loss: 1.9239 -> 1.9036   acc: 52.72% -> 52.99%             
client [23] (test)  loss: 4.5804 -> 2.4534   acc: 11.72% -> 36.33%             
client [35] (test)  loss: 2.1529 -> 2.3807   acc: 39.33% -> 32.67%             
client [59] (test)  loss: 1.7472 -> 1.8069   acc: 52.26% -> 52.58%             
client [31] (test)  loss: 2.0091 -> 1.9954   acc: 46.30% -> 47.27%             
client [9] (test)  loss: 2.2124 -> 2.5731   acc: 38.37% -> 33.84%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.0121 -> 1.9386   acc: 47.62% -> 49.86%             
client [33] (test)  loss: 2.2165 -> 2.2633   acc: 47.39% -> 49.25%             
client [16] (test)  loss: 2.3107 -> 3.1286   acc: 37.46% -> 30.70%             
client [44] (test)  loss: 2.7489 -> 2.2348   acc: 33.01% -> 34.97%             
client [8] (test)  loss: 2.0199 -> 2.0357   acc: 43.91% -> 46.15%              
client [31] (test)  loss: 1.9749 -> 1.9457   acc: 48.87% -> 48.87%             
client [47] (test)  loss: 2.3174 -> 2.6731   acc: 39.85% -> 25.94%             
client [36] (test)  loss: 2.4723 -> 2.4663   acc: 38.19% -> 40.97%             
client [20] (test)  loss: 1.0493 -> 1.0221   acc: 71.71% -> 68.75%             
client [56] (test)  loss: 2.2057 -> 2.4042   acc: 48.02% -> 42.57%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.5993 -> 1.5626   acc: 59.24% -> 61.46%              
client [60] (test)  loss: 2.4116 -> 2.4012   acc: 38.46% -> 41.03%             
client [28] (test)  loss: 2.3328 -> 2.1627   acc: 44.60% -> 47.39%             
client [25] (test)  loss: 1.8977 -> 1.9952   acc: 53.59% -> 46.84%             
client [58] (test)  loss: 2.0151 -> 2.0023   acc: 40.51% -> 41.46%             
client [44] (test)  loss: 2.1447 -> 2.3420   acc: 41.50% -> 36.93%             
client [39] (test)  loss: 2.0445 -> 2.0972   acc: 39.81% -> 42.07%             
client [29] (test)  loss: 2.3093 -> 2.0515   acc: 41.71% -> 44.29%             
client [3] (test)  loss: 1.9286 -> 1.8739   acc: 49.85% -> 51.99%              
client [84] (test)  loss: 2.2374 -> 2.3853   acc: 44.10% -> 42.24%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.9679 -> 2.0271   acc: 47.26% -> 47.55%             
client [84] (test)  loss: 2.1299 -> 2.2679   acc: 44.72% -> 46.27%             
client [10] (test)  loss: 2.1379 -> 2.2311   acc: 54.37% -> 48.41%             
client [36] (test)  loss: 2.3387 -> 2.4316   acc: 45.49% -> 44.79%             
client [65] (test)  loss: 2.3529 -> 2.4815   acc: 42.51% -> 42.91%             
client [81] (test)  loss: 1.9462 -> 2.0627   acc: 52.53% -> 49.37%             
client [79] (test)  loss: 1.3356 -> 1.4047   acc: 69.49% -> 67.23%             
client [42] (test)  loss: 1.5426 -> 1.8642   acc: 57.98% -> 52.12%             
client [11] (test)  loss: 2.1577 -> 2.2804   acc: 52.45% -> 48.77%             
client [96] (test)  loss: 1.4899 -> 1.5111   acc: 62.23% -> 64.09%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.8646 -> 1.8734   acc: 52.24% -> 51.92%              
client [53] (test)  loss: 1.8261 -> 1.9666   acc: 52.40% -> 52.99%             
client [52] (test)  loss: 1.9918 -> 2.2039   acc: 56.48% -> 54.49%             
client [42] (test)  loss: 1.5854 -> 1.8127   acc: 58.31% -> 53.75%             
client [69] (test)  loss: 0.9448 -> 0.9596   acc: 75.07% -> 73.94%             
client [59] (test)  loss: 1.5319 -> 1.6512   acc: 59.03% -> 58.71%             
client [7] (test)  loss: 1.8324 -> 2.0221   acc: 58.90% -> 51.46%              
client [26] (test)  loss: 2.2302 -> 2.4401   acc: 46.54% -> 44.62%             
client [49] (test)  loss: 1.8496 -> 1.9499   acc: 59.20% -> 56.90%             
client [98] (test)  loss: 2.4139 -> 2.6941   acc: 41.25% -> 39.69%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.5806 -> 2.7766   acc: 41.56% -> 40.31%             
client [47] (test)  loss: 2.1114 -> 2.6440   acc: 47.37% -> 36.47%             
client [21] (test)  loss: 1.9508 -> 2.1468   acc: 48.70% -> 50.14%             
client [77] (test)  loss: 1.6621 -> 1.7196   acc: 57.68% -> 59.56%             
client [95] (test)  loss: 1.7661 -> 2.0382   acc: 58.75% -> 57.10%             
client [91] (test)  loss: 1.7206 -> 1.8050   acc: 60.13% -> 56.27%             
client [14] (test)  loss: 2.2893 -> 2.5128   acc: 50.59% -> 48.24%             
client [99] (test)  loss: 2.8850 -> 3.0093   acc: 42.36% -> 38.22%             
client [20] (test)  loss: 0.9089 -> 0.9786   acc: 75.99% -> 69.74%             
client [39] (test)  loss: 1.8980 -> 2.0416   acc: 48.87% -> 44.66%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.0141 -> 2.2380   acc: 60.13% -> 55.48%             
client [62] (test)  loss: 2.2185 -> 2.1309   acc: 42.30% -> 47.54%             
client [71] (test)  loss: 2.5534 -> 2.7077   acc: 40.91% -> 40.91%             
client [97] (test)  loss: 2.1246 -> 2.2429   acc: 48.71% -> 44.83%             
client [30] (test)  loss: 2.2384 -> 2.4352   acc: 44.94% -> 41.77%             
client [88] (test)  loss: 1.8336 -> 1.9303   acc: 60.26% -> 58.94%             
client [60] (test)  loss: 2.2058 -> 2.4481   acc: 48.72% -> 46.79%             
client [82] (test)  loss: 1.8649 -> 1.9545   acc: 54.67% -> 53.98%             
client [91] (test)  loss: 1.6726 -> 1.8624   acc: 61.41% -> 56.91%             
client [57] (test)  loss: 2.0236 -> 2.0432   acc: 56.11% -> 56.11%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.9893 -> 2.0950   acc: 54.34% -> 54.02%             
client [15] (test)  loss: 2.0271 -> 2.2772   acc: 49.68% -> 47.78%             
client [71] (test)  loss: 2.6632 -> 2.7386   acc: 41.23% -> 41.23%             
client [97] (test)  loss: 2.1233 -> 2.2388   acc: 50.86% -> 46.12%             
client [53] (test)  loss: 1.8266 -> 1.9146   acc: 55.69% -> 57.19%             
client [77] (test)  loss: 1.5838 -> 1.6994   acc: 61.44% -> 60.50%             
client [76] (test)  loss: 2.0890 -> 2.2892   acc: 51.16% -> 49.17%             
client [79] (test)  loss: 1.2708 -> 1.3100   acc: 73.16% -> 72.03%             
client [28] (test)  loss: 2.1099 -> 2.2250   acc: 52.26% -> 52.26%             
client [99] (test)  loss: 2.9821 -> 3.1735   acc: 42.99% -> 40.45%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.1970 -> 2.3736   acc: 50.00% -> 48.28%             
client [86] (test)  loss: 1.9682 -> 2.2316   acc: 54.63% -> 49.25%             
client [34] (test)  loss: 1.7407 -> 1.7597   acc: 54.30% -> 56.95%             
client [73] (test)  loss: 2.1858 -> 2.6935   acc: 50.00% -> 40.00%             
client [5] (test)  loss: 1.7443 -> 1.8636   acc: 57.51% -> 54.95%              
client [96] (test)  loss: 1.5701 -> 1.6172   acc: 65.33% -> 66.56%             
client [22] (test)  loss: 2.2781 -> 2.2542   acc: 45.79% -> 45.48%             
client [60] (test)  loss: 2.3418 -> 2.5786   acc: 51.28% -> 42.95%             
client [66] (test)  loss: 1.6782 -> 2.0078   acc: 61.81% -> 55.66%             
client [83] (test)  loss: 1.9369 -> 1.7654   acc: 59.93% -> 56.62%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.2719 -> 2.4764   acc: 50.17% -> 50.17%             
client [65] (test)  loss: 2.5445 -> 2.6427   acc: 48.58% -> 48.18%             
client [95] (test)  loss: 1.9309 -> 2.1074   acc: 61.06% -> 57.10%             
client [17] (test)  loss: 2.3000 -> 2.3160   acc: 42.54% -> 45.08%             
client [8] (test)  loss: 2.0559 -> 2.0119   acc: 58.33% -> 59.29%              
client [35] (test)  loss: 2.0494 -> 2.2713   acc: 54.67% -> 53.67%             
client [98] (test)  loss: 2.7384 -> 3.3727   acc: 44.69% -> 45.00%             
client [53] (test)  loss: 1.8892 -> 2.0150   acc: 57.49% -> 57.78%             
client [43] (test)  loss: 2.3093 -> 2.3379   acc: 49.70% -> 48.79%             
client [64] (test)  loss: 1.7881 -> 1.8167   acc: 57.42% -> 57.14%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.0742 -> 2.0230   acc: 53.03% -> 54.18%             
client [88] (test)  loss: 2.0091 -> 2.1403   acc: 60.26% -> 58.28%             
client [38] (test)  loss: 2.2293 -> 2.5817   acc: 56.09% -> 53.26%             
client [3] (test)  loss: 1.7858 -> 1.8036   acc: 61.47% -> 61.16%              
client [5] (test)  loss: 1.7698 -> 1.9402   acc: 60.06% -> 56.87%              
client [41] (test)  loss: 2.4725 -> 2.5296   acc: 53.00% -> 51.33%             
client [7] (test)  loss: 2.0759 -> 2.4147   acc: 62.46% -> 53.72%              
client [37] (test)  loss: 2.0449 -> 2.2215   acc: 52.41% -> 53.38%             
client [45] (test)  loss: 1.9704 -> 2.1213   acc: 48.67% -> 50.67%             
client [47] (test)  loss: 2.2600 -> 2.1746   acc: 50.00% -> 50.75%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.9652 -> 2.0860   acc: 54.93% -> 54.08%             
client [11] (test)  loss: 2.4563 -> 2.5447   acc: 60.12% -> 60.74%             
client [37] (test)  loss: 2.1093 -> 2.2336   acc: 54.98% -> 55.63%             
client [41] (test)  loss: 2.4985 -> 2.5522   acc: 52.67% -> 52.67%             
client [95] (test)  loss: 1.9503 -> 2.1316   acc: 62.38% -> 61.06%             
client [53] (test)  loss: 1.9093 -> 2.0530   acc: 57.49% -> 61.08%             
client [22] (test)  loss: 2.3739 -> 2.5059   acc: 45.48% -> 46.73%             
client [25] (test)  loss: 1.9491 -> 2.3496   acc: 55.27% -> 52.74%             
client [69] (test)  loss: 0.9380 -> 0.9982   acc: 77.05% -> 77.90%             
client [46] (test)  loss: 1.8235 -> 2.5967   acc: 62.40% -> 55.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.2328 -> 2.3746   acc: 47.37% -> 47.37%             
client [69] (test)  loss: 0.9529 -> 1.0276   acc: 78.19% -> 77.62%             
client [82] (test)  loss: 2.1984 -> 2.4330   acc: 56.40% -> 54.67%             
client [45] (test)  loss: 2.1443 -> 2.3272   acc: 50.33% -> 49.67%             
client [7] (test)  loss: 2.2141 -> 2.5009   acc: 59.22% -> 53.72%              
client [50] (test)  loss: 1.9591 -> 2.1188   acc: 55.91% -> 57.71%             
client [35] (test)  loss: 2.0996 -> 2.3785   acc: 58.33% -> 53.67%             
client [24] (test)  loss: 1.9180 -> 2.1140   acc: 61.22% -> 57.41%             
client [15] (test)  loss: 2.2657 -> 2.4482   acc: 52.85% -> 51.58%             
client [58] (test)  loss: 2.3696 -> 2.3920   acc: 49.05% -> 49.05%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.8561 -> 3.0821   acc: 45.75% -> 42.48%             
client [76] (test)  loss: 2.6225 -> 2.8157   acc: 49.83% -> 51.16%             
client [67] (test)  loss: 1.8211 -> 2.1903   acc: 63.95% -> 54.55%             
client [37] (test)  loss: 2.2094 -> 2.4061   acc: 54.02% -> 53.38%             
client [58] (test)  loss: 2.4929 -> 2.6040   acc: 49.37% -> 47.78%             
client [64] (test)  loss: 1.9182 -> 2.1304   acc: 57.98% -> 57.14%             
client [77] (test)  loss: 1.9019 -> 1.8966   acc: 62.07% -> 65.83%             
client [55] (test)  loss: 1.9661 -> 2.7523   acc: 65.53% -> 54.66%             
client [12] (test)  loss: 2.1160 -> 2.1803   acc: 62.83% -> 63.16%             
client [89] (test)  loss: 2.8443 -> 2.9988   acc: 48.32% -> 45.57%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.7839 -> 3.0196   acc: 50.62% -> 50.00%             
client [51] (test)  loss: 2.8816 -> 3.4322   acc: 46.41% -> 40.52%             
client [8] (test)  loss: 2.3111 -> 2.3833   acc: 61.54% -> 61.22%              
client [18] (test)  loss: 1.7929 -> 1.9524   acc: 61.46% -> 59.90%             
client [94] (test)  loss: 2.8467 -> 2.9194   acc: 53.85% -> 54.17%             
client [81] (test)  loss: 2.4584 -> 2.8820   acc: 57.28% -> 57.59%             
client [3] (test)  loss: 1.9595 -> 2.0545   acc: 59.94% -> 60.86%              
client [11] (test)  loss: 2.7951 -> 2.9548   acc: 60.43% -> 61.96%             
client [95] (test)  loss: 2.1787 -> 2.3641   acc: 60.73% -> 61.72%             
client [67] (test)  loss: 1.9278 -> 2.0285   acc: 63.64% -> 60.50%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.3584 -> 2.3005   acc: 55.04% -> 54.47%             
client [79] (test)  loss: 1.5589 -> 1.6138   acc: 75.99% -> 74.29%             
client [58] (test)  loss: 2.8180 -> 2.7498   acc: 49.68% -> 50.00%             
client [88] (test)  loss: 2.4112 -> 2.6739   acc: 56.95% -> 59.27%             
client [46] (test)  loss: 2.0464 -> 3.2077   acc: 62.00% -> 52.80%             
client [11] (test)  loss: 3.0067 -> 3.1203   acc: 60.74% -> 61.96%             
client [55] (test)  loss: 2.0409 -> 2.1458   acc: 67.39% -> 64.60%             
client [13] (test)  loss: 2.5195 -> 2.5916   acc: 57.14% -> 57.14%             
client [31] (test)  loss: 2.6521 -> 2.7147   acc: 56.59% -> 54.02%             
client [75] (test)  loss: 1.8561 -> 1.9196   acc: 68.11% -> 69.77%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.6758 -> 2.6473   acc: 54.40% -> 56.68%             
client [7] (test)  loss: 2.6609 -> 2.6634   acc: 62.78% -> 60.19%              
client [57] (test)  loss: 2.7169 -> 2.7989   acc: 60.40% -> 56.11%             
client [13] (test)  loss: 2.4348 -> 2.6748   acc: 59.88% -> 57.14%             
client [43] (test)  loss: 2.9079 -> 3.0321   acc: 52.42% -> 48.79%             
client [91] (test)  loss: 2.2229 -> 2.9680   acc: 61.41% -> 55.31%             
client [10] (test)  loss: 2.8408 -> 3.0034   acc: 57.94% -> 55.56%             
client [64] (test)  loss: 2.2000 -> 2.3045   acc: 59.94% -> 58.82%             
client [82] (test)  loss: 2.7426 -> 2.9359   acc: 57.09% -> 57.79%             
client [22] (test)  loss: 2.9605 -> 2.9663   acc: 44.86% -> 46.11%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1534 -> 1.6376   acc: 75.33% -> 67.11%             
client [23] (test)  loss: 3.1398 -> 3.3387   acc: 51.17% -> 48.44%             
client [88] (test)  loss: 2.5619 -> 2.8273   acc: 59.60% -> 52.65%             
client [98] (test)  loss: 3.8166 -> 3.9344   acc: 46.88% -> 46.88%             
client [79] (test)  loss: 1.6676 -> 1.7391   acc: 75.14% -> 75.71%             
client [21] (test)  loss: 2.5329 -> 2.5449   acc: 56.77% -> 55.04%             
client [92] (test)  loss: 3.3390 -> 3.4466   acc: 50.63% -> 47.28%             
client [56] (test)  loss: 2.6369 -> 2.5957   acc: 56.93% -> 57.92%             
client [5] (test)  loss: 2.3043 -> 2.3430   acc: 61.02% -> 57.19%              
client [52] (test)  loss: 3.0926 -> 3.1248   acc: 57.14% -> 56.48%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '1.9275 -> 0.0000', 'accuracy': '54.19% -> 0.00%'},          
    200: {'loss': '2.6995 -> 0.0000', 'accuracy': '56.90% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(11.62%) at epoch: 3                                      
FedRep achieved 20.0%(24.50%) at epoch: 7                                      
FedRep achieved 30.0%(34.54%) at epoch: 14                                     
FedRep achieved 40.0%(43.07%) at epoch: 22                                     
FedRep achieved 50.0%(50.24%) at epoch: 38                                     
FedRep achieved 60.0%(60.80%) at epoch: 104                                    
Convergence (test_after):                                                      
FedRep achieved 20.0%(20.42%) at epoch: 0                                      
FedRep achieved 30.0%(33.57%) at epoch: 1                                      
FedRep achieved 40.0%(41.75%) at epoch: 14                                     
FedRep achieved 50.0%(51.89%) at epoch: 40                                     
FedRep achieved 60.0%(61.34%) at epoch: 127                                    
