==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.4879 -> 0.2942   acc: 86.79% -> 91.18%             
client [81] (test)  loss: 0.3051 -> 0.2972   acc: 89.05% -> 90.41%             
client [21] (test)  loss: 1.1738 -> 0.1184   acc: 80.02% -> 96.48%             
client [68] (test)  loss: 0.7558 -> 0.4904   acc: 79.97% -> 86.12%             
client [93] (test)  loss: 0.2119 -> 0.1283   acc: 92.09% -> 95.53%             
client [31] (test)  loss: 0.5075 -> 0.4560   acc: 83.86% -> 86.16%             
client [20] (test)  loss: 0.3519 -> 0.3715   acc: 90.20% -> 89.21%             
client [59] (test)  loss: 4.1001 -> 0.3995   acc: 37.66% -> 86.98%             
client [48] (test)  loss: 0.8368 -> 0.7957   acc: 73.83% -> 75.61%             
client [34] (test)  loss: 0.2227 -> 0.1745   acc: 93.96% -> 95.09%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2710 -> 0.4553   acc: 67.28% -> 86.44%             
client [99] (test)  loss: 0.0740 -> 0.0637   acc: 97.96% -> 98.47%             
client [67] (test)  loss: 0.5030 -> 0.4127   acc: 82.25% -> 85.73%             
client [0] (test)  loss: 0.2167 -> 0.2287   acc: 93.77% -> 93.17%              
client [76] (test)  loss: 0.3204 -> 0.3557   acc: 91.46% -> 90.16%             
client [41] (test)  loss: 0.5129 -> 0.4888   acc: 80.55% -> 80.79%             
client [62] (test)  loss: 5.0335 -> 0.1740   acc: 3.54% -> 94.73%              
client [2] (test)  loss: 3.5507 -> 0.2881   acc: 10.94% -> 91.77%              
client [14] (test)  loss: 0.2992 -> 0.2829   acc: 91.44% -> 91.93%             
client [46] (test)  loss: 0.0497 -> 0.0411   acc: 98.70% -> 98.93%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.2294 -> 0.2519   acc: 92.59% -> 91.76%             
client [68] (test)  loss: 0.3251 -> 0.3504   acc: 89.94% -> 89.82%             
client [57] (test)  loss: 0.2710 -> 0.1780   acc: 92.47% -> 94.89%             
client [17] (test)  loss: 0.1993 -> 0.1960   acc: 93.51% -> 93.49%             
client [54] (test)  loss: 0.3405 -> 0.3350   acc: 90.76% -> 91.54%             
client [23] (test)  loss: 1.5767 -> 0.1280   acc: 57.72% -> 96.06%             
client [35] (test)  loss: 0.0418 -> 0.0475   acc: 98.80% -> 98.77%             
client [59] (test)  loss: 0.2704 -> 0.3128   acc: 90.17% -> 88.79%             
client [31] (test)  loss: 0.1424 -> 0.2241   acc: 94.85% -> 92.38%             
client [9] (test)  loss: 0.3072 -> 0.3070   acc: 89.88% -> 90.44%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3390 -> 0.3300   acc: 89.57% -> 89.99%             
client [33] (test)  loss: 0.0520 -> 0.0526   acc: 98.43% -> 98.54%             
client [16] (test)  loss: 0.3197 -> 0.3298   acc: 89.73% -> 89.35%             
client [44] (test)  loss: 1.1119 -> 0.5768   acc: 73.11% -> 80.89%             
client [8] (test)  loss: 0.4305 -> 0.6508   acc: 84.58% -> 76.99%              
client [31] (test)  loss: 0.1285 -> 0.2054   acc: 95.45% -> 93.20%             
client [47] (test)  loss: 0.2886 -> 0.3167   acc: 90.83% -> 90.12%             
client [36] (test)  loss: 0.2427 -> 0.2294   acc: 93.44% -> 93.84%             
client [20] (test)  loss: 0.1547 -> 0.1870   acc: 95.32% -> 94.84%             
client [56] (test)  loss: 0.0571 -> 0.0454   acc: 98.31% -> 98.62%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3780 -> 0.4158   acc: 85.20% -> 84.22%              
client [60] (test)  loss: 0.1838 -> 0.1909   acc: 95.04% -> 94.60%             
client [28] (test)  loss: 0.0033 -> 0.0024   acc: 99.90% -> 99.90%             
client [25] (test)  loss: 0.1738 -> 0.2124   acc: 95.25% -> 93.72%             
client [58] (test)  loss: 0.0247 -> 0.0180   acc: 99.14% -> 99.44%             
client [44] (test)  loss: 0.4046 -> 0.6734   acc: 87.12% -> 78.07%             
client [39] (test)  loss: 0.1382 -> 0.1738   acc: 95.93% -> 94.82%             
client [29] (test)  loss: 0.2175 -> 0.2234   acc: 92.89% -> 92.93%             
client [3] (test)  loss: 0.0296 -> 0.0229   acc: 99.32% -> 99.22%              
client [84] (test)  loss: 0.1899 -> 0.2277   acc: 94.40% -> 93.62%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0603 -> 0.0598   acc: 98.20% -> 98.18%             
client [84] (test)  loss: 0.1876 -> 0.2157   acc: 93.93% -> 93.62%             
client [10] (test)  loss: 0.3649 -> 0.3626   acc: 85.33% -> 85.49%             
client [36] (test)  loss: 0.1866 -> 0.1978   acc: 94.50% -> 94.31%             
client [65] (test)  loss: 0.3197 -> 0.3562   acc: 89.00% -> 87.97%             
client [81] (test)  loss: 0.1686 -> 0.2403   acc: 92.76% -> 91.51%             
client [79] (test)  loss: 0.2757 -> 0.3108   acc: 90.85% -> 90.57%             
client [42] (test)  loss: 0.2225 -> 0.2353   acc: 93.46% -> 92.98%             
client [11] (test)  loss: 0.1022 -> 0.0996   acc: 97.46% -> 97.35%             
client [96] (test)  loss: 0.1357 -> 0.1439   acc: 95.73% -> 95.39%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3703 -> 0.4190   acc: 86.46% -> 85.09%              
client [53] (test)  loss: 0.0656 -> 0.0623   acc: 98.18% -> 98.22%             
client [52] (test)  loss: 0.3553 -> 0.3957   acc: 87.17% -> 85.87%             
client [42] (test)  loss: 0.2144 -> 0.2347   acc: 93.71% -> 93.08%             
client [69] (test)  loss: 0.2710 -> 0.3302   acc: 91.73% -> 89.66%             
client [59] (test)  loss: 0.2203 -> 0.2455   acc: 91.84% -> 90.64%             
client [7] (test)  loss: 0.2792 -> 0.2918   acc: 92.00% -> 91.48%              
client [26] (test)  loss: 0.1606 -> 0.1970   acc: 94.62% -> 94.36%             
client [49] (test)  loss: 0.0004 -> 0.0005   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.0624 -> 0.0678   acc: 98.65% -> 98.56%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.0604 -> 0.0688   acc: 98.89% -> 98.58%             
client [47] (test)  loss: 0.2417 -> 0.2580   acc: 92.79% -> 91.78%             
client [21] (test)  loss: 0.0593 -> 0.0549   acc: 98.23% -> 98.30%             
client [77] (test)  loss: 0.1403 -> 0.1241   acc: 96.17% -> 96.48%             
client [95] (test)  loss: 0.0982 -> 0.1058   acc: 97.17% -> 97.07%             
client [91] (test)  loss: 0.0751 -> 0.0780   acc: 97.80% -> 97.92%             
client [14] (test)  loss: 0.1973 -> 0.2116   acc: 94.33% -> 93.96%             
client [99] (test)  loss: 0.0453 -> 0.0495   acc: 98.86% -> 98.82%             
client [20] (test)  loss: 0.1222 -> 0.1188   acc: 96.50% -> 96.70%             
client [39] (test)  loss: 0.1257 -> 0.1499   acc: 96.44% -> 95.68%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3296 -> 0.4028   acc: 89.17% -> 85.09%             
client [62] (test)  loss: 0.0904 -> 0.1210   acc: 97.52% -> 96.57%             
client [71] (test)  loss: 0.0113 -> 0.0133   acc: 99.70% -> 99.62%             
client [97] (test)  loss: 0.0069 -> 0.0073   acc: 99.82% -> 99.77%             
client [30] (test)  loss: 0.1304 -> 0.1369   acc: 96.26% -> 96.22%             
client [88] (test)  loss: 0.2550 -> 0.2721   acc: 90.77% -> 90.31%             
client [60] (test)  loss: 0.1276 -> 0.1400   acc: 96.67% -> 96.32%             
client [82] (test)  loss: 0.5829 -> 0.5860   acc: 69.29% -> 66.98%             
client [91] (test)  loss: 0.0723 -> 0.0783   acc: 97.95% -> 97.85%             
client [57] (test)  loss: 0.1285 -> 0.1232   acc: 96.51% -> 96.51%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1124 -> 0.1400   acc: 95.79% -> 94.87%             
client [15] (test)  loss: 0.0196 -> 0.0207   acc: 99.54% -> 99.52%             
client [71] (test)  loss: 0.0110 -> 0.0139   acc: 99.71% -> 99.66%             
client [97] (test)  loss: 0.0063 -> 0.0068   acc: 99.82% -> 99.75%             
client [53] (test)  loss: 0.0569 -> 0.0548   acc: 98.26% -> 98.26%             
client [77] (test)  loss: 0.1317 -> 0.1224   acc: 96.23% -> 96.56%             
client [76] (test)  loss: 0.1922 -> 0.2081   acc: 94.37% -> 94.13%             
client [79] (test)  loss: 0.2511 -> 0.2868   acc: 92.28% -> 91.38%             
client [28] (test)  loss: 0.0017 -> 0.0019   acc: 99.92% -> 99.92%             
client [99] (test)  loss: 0.0429 -> 0.0483   acc: 99.05% -> 98.90%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0069 -> 0.0068   acc: 99.82% -> 99.77%             
client [86] (test)  loss: 0.3415 -> 0.4036   acc: 88.18% -> 87.44%             
client [34] (test)  loss: 0.0744 -> 0.0778   acc: 97.81% -> 97.69%             
client [73] (test)  loss: 0.2147 -> 0.2233   acc: 92.23% -> 91.64%             
client [5] (test)  loss: 0.1194 -> 0.1286   acc: 96.56% -> 96.41%              
client [96] (test)  loss: 0.1242 -> 0.1354   acc: 96.12% -> 95.73%             
client [22] (test)  loss: 0.1369 -> 0.1673   acc: 94.88% -> 93.64%             
client [60] (test)  loss: 0.1201 -> 0.1295   acc: 96.67% -> 96.86%             
client [66] (test)  loss: 0.1827 -> 0.2010   acc: 94.82% -> 94.28%             
client [83] (test)  loss: 0.1151 -> 0.1232   acc: 96.52% -> 96.45%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1908 -> 0.2052   acc: 94.46% -> 94.16%             
client [65] (test)  loss: 0.3081 -> 0.3341   acc: 89.66% -> 88.34%             
client [95] (test)  loss: 0.0910 -> 0.0986   acc: 97.42% -> 97.27%             
client [17] (test)  loss: 0.1368 -> 0.1433   acc: 95.46% -> 94.90%             
client [8] (test)  loss: 0.2865 -> 0.3694   acc: 89.02% -> 86.31%              
client [35] (test)  loss: 0.0209 -> 0.0199   acc: 99.45% -> 99.39%             
client [98] (test)  loss: 0.0617 -> 0.0685   acc: 98.77% -> 98.72%             
client [53] (test)  loss: 0.0506 -> 0.0513   acc: 98.43% -> 98.35%             
client [43] (test)  loss: 0.3041 -> 0.3033   acc: 89.12% -> 89.12%             
client [64] (test)  loss: 0.2641 -> 0.2769   acc: 91.91% -> 91.41%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0519 -> 0.0521   acc: 98.52% -> 98.40%             
client [88] (test)  loss: 0.2505 -> 0.2716   acc: 90.83% -> 90.64%             
client [38] (test)  loss: 0.1997 -> 0.2081   acc: 94.41% -> 94.45%             
client [3] (test)  loss: 0.0131 -> 0.0144   acc: 99.59% -> 99.53%              
client [5] (test)  loss: 0.1223 -> 0.1259   acc: 96.59% -> 96.63%              
client [41] (test)  loss: 0.2983 -> 0.3252   acc: 88.18% -> 87.25%             
client [7] (test)  loss: 0.2443 -> 0.2802   acc: 93.22% -> 92.16%              
client [37] (test)  loss: 0.0434 -> 0.0465   acc: 98.64% -> 98.67%             
client [45] (test)  loss: 0.3211 -> 0.3502   acc: 88.77% -> 87.86%             
client [47] (test)  loss: 0.2249 -> 0.2386   acc: 93.19% -> 92.67%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2726 -> 0.2841   acc: 91.24% -> 91.02%             
client [11] (test)  loss: 0.0848 -> 0.0879   acc: 97.75% -> 97.79%             
client [37] (test)  loss: 0.0409 -> 0.0473   acc: 98.87% -> 98.67%             
client [41] (test)  loss: 0.3013 -> 0.3164   acc: 88.56% -> 87.68%             
client [95] (test)  loss: 0.0920 -> 0.0984   acc: 97.32% -> 97.34%             
client [53] (test)  loss: 0.0503 -> 0.0498   acc: 98.49% -> 98.49%             
client [22] (test)  loss: 0.1357 -> 0.1502   acc: 95.02% -> 94.56%             
client [25] (test)  loss: 0.1331 -> 0.1662   acc: 96.11% -> 94.81%             
client [69] (test)  loss: 0.2405 -> 0.2635   acc: 93.18% -> 91.73%             
client [46] (test)  loss: 0.0239 -> 0.0233   acc: 99.49% -> 99.44%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2217 -> 0.2455   acc: 93.62% -> 92.82%             
client [69] (test)  loss: 0.2517 -> 0.2559   acc: 92.99% -> 92.71%             
client [82] (test)  loss: 0.5710 -> 0.5751   acc: 69.50% -> 68.62%             
client [45] (test)  loss: 0.3259 -> 0.3491   acc: 88.66% -> 88.15%             
client [7] (test)  loss: 0.2537 -> 0.2719   acc: 93.17% -> 92.49%              
client [50] (test)  loss: 0.0908 -> 0.0969   acc: 97.53% -> 97.44%             
client [35] (test)  loss: 0.0215 -> 0.0186   acc: 99.47% -> 99.49%             
client [24] (test)  loss: 0.1953 -> 0.2205   acc: 94.26% -> 93.46%             
client [15] (test)  loss: 0.0184 -> 0.0194   acc: 99.59% -> 99.52%             
client [58] (test)  loss: 0.0124 -> 0.0121   acc: 99.63% -> 99.68%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4593 -> 0.4929   acc: 84.21% -> 83.68%             
client [76] (test)  loss: 0.1877 -> 0.2078   acc: 94.52% -> 94.46%             
client [67] (test)  loss: 0.2745 -> 0.3125   acc: 90.10% -> 89.28%             
client [37] (test)  loss: 0.0382 -> 0.0466   acc: 98.92% -> 98.71%             
client [58] (test)  loss: 0.0121 -> 0.0118   acc: 99.66% -> 99.66%             
client [64] (test)  loss: 0.2571 -> 0.2799   acc: 91.41% -> 91.63%             
client [77] (test)  loss: 0.1194 -> 0.1182   acc: 96.88% -> 97.05%             
client [55] (test)  loss: 0.0807 -> 0.0892   acc: 97.58% -> 97.39%             
client [12] (test)  loss: 0.2250 -> 0.2581   acc: 93.27% -> 92.43%             
client [89] (test)  loss: 0.2195 -> 0.2566   acc: 91.31% -> 89.10%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1949 -> 0.2337   acc: 94.82% -> 93.88%             
client [51] (test)  loss: 0.2650 -> 0.3026   acc: 92.11% -> 91.67%             
client [8] (test)  loss: 0.2788 -> 0.3408   acc: 89.85% -> 87.43%              
client [18] (test)  loss: 0.0254 -> 0.0278   acc: 99.22% -> 99.05%             
client [94] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.1525 -> 0.1653   acc: 93.26% -> 93.08%             
client [3] (test)  loss: 0.0112 -> 0.0128   acc: 99.66% -> 99.60%              
client [11] (test)  loss: 0.0818 -> 0.0880   acc: 98.02% -> 97.91%             
client [95] (test)  loss: 0.0888 -> 0.0977   acc: 97.64% -> 97.60%             
client [67] (test)  loss: 0.2853 -> 0.3143   acc: 90.03% -> 89.56%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0451 -> 0.0479   acc: 98.66% -> 98.49%             
client [79] (test)  loss: 0.2420 -> 0.2678   acc: 92.28% -> 92.50%             
client [58] (test)  loss: 0.0108 -> 0.0132   acc: 99.68% -> 99.53%             
client [88] (test)  loss: 0.2490 -> 0.2627   acc: 91.27% -> 91.08%             
client [46] (test)  loss: 0.0245 -> 0.0234   acc: 99.44% -> 99.47%             
client [11] (test)  loss: 0.0823 -> 0.0853   acc: 97.86% -> 97.91%             
client [55] (test)  loss: 0.0821 -> 0.0943   acc: 97.60% -> 97.28%             
client [13] (test)  loss: 0.0674 -> 0.0708   acc: 98.21% -> 98.31%             
client [31] (test)  loss: 0.1162 -> 0.1435   acc: 95.48% -> 95.04%             
client [75] (test)  loss: 0.2030 -> 0.2146   acc: 94.42% -> 94.26%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0697 -> 0.0664   acc: 98.15% -> 98.29%             
client [7] (test)  loss: 0.2394 -> 0.2656   acc: 93.66% -> 92.81%              
client [57] (test)  loss: 0.1032 -> 0.1090   acc: 97.08% -> 97.00%             
client [13] (test)  loss: 0.0705 -> 0.0703   acc: 98.00% -> 98.24%             
client [43] (test)  loss: 0.2922 -> 0.3134   acc: 89.51% -> 88.93%             
client [91] (test)  loss: 0.0628 -> 0.0705   acc: 98.13% -> 97.97%             
client [10] (test)  loss: 0.2953 -> 0.2941   acc: 87.19% -> 87.77%             
client [64] (test)  loss: 0.2559 -> 0.2867   acc: 91.77% -> 91.70%             
client [82] (test)  loss: 0.5539 -> 0.5739   acc: 71.62% -> 68.83%             
client [22] (test)  loss: 0.1369 -> 0.1507   acc: 94.88% -> 94.58%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1023 -> 0.1029   acc: 97.24% -> 97.29%             
client [23] (test)  loss: 0.0949 -> 0.1004   acc: 96.98% -> 96.83%             
client [88] (test)  loss: 0.2538 -> 0.2627   acc: 91.38% -> 91.13%             
client [98] (test)  loss: 0.0688 -> 0.0703   acc: 98.65% -> 98.65%             
client [79] (test)  loss: 0.2456 -> 0.2740   acc: 92.56% -> 92.43%             
client [21] (test)  loss: 0.0465 -> 0.0493   acc: 98.64% -> 98.47%             
client [92] (test)  loss: 0.0615 -> 0.0651   acc: 98.34% -> 98.34%             
client [56] (test)  loss: 0.0286 -> 0.0280   acc: 99.27% -> 99.22%             
client [5] (test)  loss: 0.1196 -> 0.1231   acc: 96.85% -> 96.83%              
client [52] (test)  loss: 0.3230 -> 0.3983   acc: 90.52% -> 85.58%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1397 -> 0.0000', 'accuracy': '95.35% -> 0.00%'},          
    200: {'loss': '0.1351 -> 0.0000', 'accuracy': '95.72% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 30.0%(31.36%) at epoch: 1                                      
FedRep achieved 50.0%(59.85%) at epoch: 4                                      
FedRep achieved 70.0%(77.97%) at epoch: 7                                      
FedRep achieved 80.0%(80.62%) at epoch: 9                                      
FedRep achieved 90.0%(93.68%) at epoch: 22                                     
Convergence (test_after):                                                      
FedRep achieved 80.0%(86.28%) at epoch: 0                                      
FedRep achieved 90.0%(91.27%) at epoch: 2                                      
