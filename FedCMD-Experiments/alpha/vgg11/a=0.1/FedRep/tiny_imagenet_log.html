==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2513 -> 5.1896   acc: 1.72% -> 6.36%               
client [81] (test)  loss: 5.1969 -> 5.0843   acc: 11.92% -> 19.93%             
client [21] (test)  loss: 5.2828 -> 5.2442   acc: 0.40% -> 2.20%               
client [68] (test)  loss: 5.2618 -> 5.1893   acc: 0.81% -> 9.11%               
client [93] (test)  loss: 5.3208 -> 5.2778   acc: 0.37% -> 1.65%               
client [31] (test)  loss: 5.2323 -> 4.9907   acc: 0.35% -> 22.13%              
client [20] (test)  loss: 5.2011 -> 5.1355   acc: 6.06% -> 14.19%              
client [59] (test)  loss: 5.2849 -> 5.2422   acc: 1.94% -> 3.35%               
client [48] (test)  loss: 5.1896 -> 5.0719   acc: 3.06% -> 29.32%              
client [34] (test)  loss: 5.2645 -> 5.2152   acc: 0.46% -> 1.62%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.5668 -> 3.9768   acc: 3.99% -> 15.16%              
client [99] (test)  loss: 5.8017 -> 4.1439   acc: 1.23% -> 18.00%              
client [67] (test)  loss: 4.7743 -> 3.1318   acc: 7.94% -> 30.34%              
client [0] (test)  loss: 4.4509 -> 3.4698   acc: 12.54% -> 21.68%              
client [76] (test)  loss: 5.0802 -> 3.4274   acc: 2.91% -> 21.82%              
client [41] (test)  loss: 5.8993 -> 3.3291   acc: 5.87% -> 23.31%              
client [62] (test)  loss: 5.5525 -> 3.7109   acc: 1.88% -> 18.80%              
client [2] (test)  loss: 5.9583 -> 3.4903   acc: 0.22% -> 22.61%               
client [14] (test)  loss: 4.2228 -> 2.9718   acc: 15.30% -> 34.70%             
client [46] (test)  loss: 5.3178 -> 3.7293   acc: 4.68% -> 15.14%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.7706 -> 2.5606   acc: 37.53% -> 38.90%             
client [68] (test)  loss: 3.2799 -> 3.2675   acc: 26.99% -> 28.13%             
client [57] (test)  loss: 3.3378 -> 2.9050   acc: 24.00% -> 32.91%             
client [17] (test)  loss: 5.4796 -> 2.2338   acc: 13.74% -> 45.97%             
client [54] (test)  loss: 2.8047 -> 2.7550   acc: 37.81% -> 40.43%             
client [23] (test)  loss: 6.1020 -> 2.2273   acc: 4.42% -> 49.20%              
client [35] (test)  loss: 2.9678 -> 2.6873   acc: 25.90% -> 31.33%             
client [59] (test)  loss: 2.9718 -> 2.4746   acc: 30.11% -> 39.26%             
client [31] (test)  loss: 2.0278 -> 1.9272   acc: 51.74% -> 54.70%             
client [9] (test)  loss: 3.1554 -> 3.0565   acc: 27.45% -> 31.09%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.2166 -> 2.1550   acc: 47.19% -> 49.17%             
client [33] (test)  loss: 2.4638 -> 2.4481   acc: 41.59% -> 42.05%             
client [16] (test)  loss: 2.3843 -> 2.3835   acc: 43.90% -> 45.36%             
client [44] (test)  loss: 5.7997 -> 2.7161   acc: 2.58% -> 35.43%              
client [8] (test)  loss: 2.1736 -> 2.1797   acc: 49.28% -> 49.60%              
client [31] (test)  loss: 1.7066 -> 1.6885   acc: 57.84% -> 61.67%             
client [47] (test)  loss: 2.5364 -> 1.8087   acc: 44.30% -> 55.88%             
client [36] (test)  loss: 2.2094 -> 1.9016   acc: 43.30% -> 50.72%             
client [20] (test)  loss: 2.6968 -> 3.1217   acc: 35.12% -> 30.97%             
client [56] (test)  loss: 2.7941 -> 2.5795   acc: 31.14% -> 36.65%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.7094 -> 2.6749   acc: 33.27% -> 34.72%              
client [60] (test)  loss: 3.0132 -> 2.1477   acc: 35.09% -> 47.09%             
client [28] (test)  loss: 2.8271 -> 2.4101   acc: 37.25% -> 45.03%             
client [25] (test)  loss: 3.0774 -> 2.2875   acc: 34.09% -> 44.87%             
client [58] (test)  loss: 2.3905 -> 2.5634   acc: 45.05% -> 39.40%             
client [44] (test)  loss: 2.5301 -> 2.5413   acc: 36.88% -> 39.61%             
client [39] (test)  loss: 2.8135 -> 2.9373   acc: 37.29% -> 30.36%             
client [29] (test)  loss: 2.6159 -> 2.0328   acc: 38.61% -> 48.98%             
client [3] (test)  loss: 2.1911 -> 1.9207   acc: 41.01% -> 48.53%              
client [84] (test)  loss: 2.0831 -> 2.0504   acc: 48.76% -> 51.77%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.7996 -> 2.3427   acc: 42.60% -> 47.20%             
client [84] (test)  loss: 1.9102 -> 1.9796   acc: 52.30% -> 53.37%             
client [10] (test)  loss: 2.0281 -> 2.2089   acc: 52.43% -> 45.90%             
client [36] (test)  loss: 1.5749 -> 1.5925   acc: 57.97% -> 57.25%             
client [65] (test)  loss: 2.0717 -> 2.1136   acc: 46.77% -> 47.49%             
client [81] (test)  loss: 1.8782 -> 1.8438   acc: 57.65% -> 56.58%             
client [79] (test)  loss: 2.4835 -> 2.4844   acc: 42.95% -> 43.16%             
client [42] (test)  loss: 1.9887 -> 2.0943   acc: 51.88% -> 49.73%             
client [11] (test)  loss: 2.3110 -> 2.3080   acc: 45.67% -> 42.73%             
client [96] (test)  loss: 1.7420 -> 1.5990   acc: 54.14% -> 58.09%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.7378 -> 1.8595   acc: 58.66% -> 56.28%              
client [53] (test)  loss: 2.1799 -> 2.3227   acc: 51.94% -> 51.16%             
client [52] (test)  loss: 1.8393 -> 2.0423   acc: 53.55% -> 49.29%             
client [42] (test)  loss: 1.9206 -> 2.0464   acc: 52.95% -> 50.98%             
client [69] (test)  loss: 2.3279 -> 2.4092   acc: 46.01% -> 46.54%             
client [59] (test)  loss: 1.6989 -> 1.7432   acc: 57.75% -> 57.04%             
client [7] (test)  loss: 2.2338 -> 2.1858   acc: 51.71% -> 46.32%              
client [26] (test)  loss: 1.6959 -> 1.7055   acc: 59.36% -> 59.02%             
client [49] (test)  loss: 1.9195 -> 2.1413   acc: 53.67% -> 50.52%             
client [98] (test)  loss: 1.4980 -> 1.5272   acc: 64.08% -> 62.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.5097 -> 1.5053   acc: 65.97% -> 62.57%             
client [47] (test)  loss: 1.5375 -> 1.4156   acc: 62.39% -> 65.64%             
client [21] (test)  loss: 2.1943 -> 2.2252   acc: 51.40% -> 50.60%             
client [77] (test)  loss: 1.6510 -> 1.6963   acc: 59.97% -> 58.42%             
client [95] (test)  loss: 1.7828 -> 1.9346   acc: 58.74% -> 56.00%             
client [91] (test)  loss: 1.5815 -> 1.5523   acc: 58.71% -> 59.73%             
client [14] (test)  loss: 1.4980 -> 1.5537   acc: 62.10% -> 61.03%             
client [99] (test)  loss: 2.8333 -> 3.0505   acc: 44.38% -> 42.74%             
client [20] (test)  loss: 1.6244 -> 1.7660   acc: 56.23% -> 52.77%             
client [39] (test)  loss: 2.4325 -> 2.7339   acc: 42.24% -> 35.97%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.7873 -> 1.9782   acc: 57.27% -> 52.13%             
client [62] (test)  loss: 2.0718 -> 2.1465   acc: 52.82% -> 53.16%             
client [71] (test)  loss: 2.2251 -> 2.3249   acc: 48.31% -> 48.31%             
client [97] (test)  loss: 1.9774 -> 2.0376   acc: 50.95% -> 52.48%             
client [30] (test)  loss: 1.9720 -> 2.1223   acc: 53.83% -> 52.20%             
client [88] (test)  loss: 1.8705 -> 1.9519   acc: 55.97% -> 53.24%             
client [60] (test)  loss: 1.8520 -> 1.8677   acc: 57.27% -> 55.09%             
client [82] (test)  loss: 1.8594 -> 1.9669   acc: 58.77% -> 54.87%             
client [91] (test)  loss: 1.4829 -> 1.5320   acc: 61.42% -> 60.58%             
client [57] (test)  loss: 2.0066 -> 1.9989   acc: 54.18% -> 54.18%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.3621 -> 1.5231   acc: 71.43% -> 68.47%             
client [15] (test)  loss: 1.8281 -> 2.0419   acc: 58.74% -> 53.85%             
client [71] (test)  loss: 2.2296 -> 2.3558   acc: 49.52% -> 47.83%             
client [97] (test)  loss: 1.8767 -> 2.0383   acc: 55.15% -> 53.05%             
client [53] (test)  loss: 2.0909 -> 2.1481   acc: 61.24% -> 60.47%             
client [77] (test)  loss: 1.6270 -> 1.6350   acc: 61.34% -> 60.48%             
client [76] (test)  loss: 1.7106 -> 1.7150   acc: 58.00% -> 58.18%             
client [79] (test)  loss: 2.4369 -> 2.5555   acc: 47.22% -> 47.65%             
client [28] (test)  loss: 2.0328 -> 2.1346   acc: 55.33% -> 54.79%             
client [99] (test)  loss: 2.8296 -> 3.1657   acc: 46.83% -> 43.15%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.8942 -> 2.0369   acc: 53.24% -> 54.20%             
client [86] (test)  loss: 1.7145 -> 1.8219   acc: 61.07% -> 61.07%             
client [34] (test)  loss: 2.1261 -> 2.2989   acc: 54.06% -> 53.13%             
client [73] (test)  loss: 1.6431 -> 1.8401   acc: 59.14% -> 57.55%             
client [5] (test)  loss: 1.7709 -> 1.9460   acc: 58.20% -> 55.14%              
client [96] (test)  loss: 1.3812 -> 1.4814   acc: 62.95% -> 63.31%             
client [22] (test)  loss: 1.7532 -> 1.8885   acc: 60.95% -> 60.36%             
client [60] (test)  loss: 1.8469 -> 1.9450   acc: 58.00% -> 56.73%             
client [66] (test)  loss: 1.8896 -> 2.0755   acc: 54.90% -> 50.98%             
client [83] (test)  loss: 2.2366 -> 2.3622   acc: 50.85% -> 51.04%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.7991 -> 1.8517   acc: 58.00% -> 57.45%             
client [65] (test)  loss: 1.9485 -> 1.9909   acc: 55.20% -> 56.63%             
client [95] (test)  loss: 1.8443 -> 1.9447   acc: 62.11% -> 61.05%             
client [17] (test)  loss: 1.5676 -> 1.4987   acc: 65.40% -> 64.14%             
client [8] (test)  loss: 1.7832 -> 1.7916   acc: 63.59% -> 61.37%              
client [35] (test)  loss: 1.9002 -> 2.0342   acc: 57.63% -> 57.43%             
client [98] (test)  loss: 1.5801 -> 1.5841   acc: 64.46% -> 63.89%             
client [53] (test)  loss: 2.2181 -> 2.2798   acc: 59.88% -> 60.66%             
client [43] (test)  loss: 2.2382 -> 2.2152   acc: 54.63% -> 52.88%             
client [64] (test)  loss: 1.6861 -> 1.7005   acc: 62.54% -> 64.19%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.1446 -> 2.2141   acc: 55.00% -> 54.20%             
client [88] (test)  loss: 1.9368 -> 2.0845   acc: 57.68% -> 56.31%             
client [38] (test)  loss: 2.1533 -> 2.3083   acc: 55.92% -> 52.26%             
client [3] (test)  loss: 1.7213 -> 1.7894   acc: 61.27% -> 60.95%              
client [5] (test)  loss: 1.8591 -> 1.9663   acc: 57.84% -> 56.94%              
client [41] (test)  loss: 1.5868 -> 2.1116   acc: 60.32% -> 52.31%             
client [7] (test)  loss: 2.1375 -> 2.2175   acc: 57.45% -> 53.50%              
client [37] (test)  loss: 1.9410 -> 1.8427   acc: 60.23% -> 60.55%             
client [45] (test)  loss: 2.0996 -> 2.1222   acc: 54.16% -> 50.30%             
client [47] (test)  loss: 1.3074 -> 1.3076   acc: 70.16% -> 69.62%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.0632 -> 2.1464   acc: 59.38% -> 57.38%             
client [11] (test)  loss: 2.1255 -> 2.2891   acc: 55.02% -> 52.94%             
client [37] (test)  loss: 1.9995 -> 1.9743   acc: 57.63% -> 59.58%             
client [41] (test)  loss: 1.6417 -> 2.1418   acc: 61.03% -> 52.14%             
client [95] (test)  loss: 1.9251 -> 2.0958   acc: 61.68% -> 61.05%             
client [53] (test)  loss: 2.3466 -> 2.4060   acc: 60.27% -> 60.47%             
client [22] (test)  loss: 1.8847 -> 2.0744   acc: 61.74% -> 61.93%             
client [25] (test)  loss: 1.9907 -> 2.1511   acc: 54.96% -> 52.35%             
client [69] (test)  loss: 2.6691 -> 2.9737   acc: 49.20% -> 48.40%             
client [46] (test)  loss: 1.5946 -> 1.6380   acc: 60.90% -> 61.26%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.4407 -> 1.4231   acc: 69.08% -> 69.44%             
client [69] (test)  loss: 2.8023 -> 3.1605   acc: 48.94% -> 48.94%             
client [82] (test)  loss: 2.0672 -> 2.1323   acc: 59.42% -> 59.09%             
client [45] (test)  loss: 2.1575 -> 2.3110   acc: 53.35% -> 49.90%             
client [7] (test)  loss: 2.3022 -> 2.3920   acc: 56.01% -> 52.78%              
client [50] (test)  loss: 1.6978 -> 1.7830   acc: 59.93% -> 59.07%             
client [35] (test)  loss: 2.0122 -> 2.1720   acc: 59.64% -> 58.84%             
client [24] (test)  loss: 2.2783 -> 3.2692   acc: 60.27% -> 49.04%             
client [15] (test)  loss: 2.1338 -> 2.4035   acc: 58.22% -> 53.50%             
client [58] (test)  loss: 2.5429 -> 2.9790   acc: 52.12% -> 50.71%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.5591 -> 1.7289   acc: 68.49% -> 68.05%             
client [76] (test)  loss: 2.0267 -> 2.0905   acc: 58.73% -> 57.09%             
client [67] (test)  loss: 1.9177 -> 1.8896   acc: 61.20% -> 60.32%             
client [37] (test)  loss: 2.2081 -> 2.1306   acc: 59.25% -> 58.28%             
client [58] (test)  loss: 2.7271 -> 3.0431   acc: 51.41% -> 51.41%             
client [64] (test)  loss: 1.8748 -> 1.9119   acc: 64.03% -> 64.69%             
client [77] (test)  loss: 1.9087 -> 1.9752   acc: 60.65% -> 57.90%             
client [55] (test)  loss: 2.2744 -> 2.2605   acc: 60.77% -> 58.39%             
client [12] (test)  loss: 1.9647 -> 2.2349   acc: 61.16% -> 60.70%             
client [89] (test)  loss: 2.1886 -> 2.3814   acc: 56.78% -> 56.42%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.3059 -> 2.5309   acc: 57.27% -> 56.56%             
client [51] (test)  loss: 1.9357 -> 2.0580   acc: 66.36% -> 64.00%             
client [8] (test)  loss: 2.0791 -> 2.2906   acc: 62.80% -> 61.21%              
client [18] (test)  loss: 2.3244 -> 2.5362   acc: 58.32% -> 55.99%             
client [94] (test)  loss: 2.3845 -> 2.4634   acc: 60.84% -> 61.20%             
client [81] (test)  loss: 2.0908 -> 2.0593   acc: 61.57% -> 58.90%             
client [3] (test)  loss: 1.9868 -> 2.1460   acc: 60.78% -> 60.29%              
client [11] (test)  loss: 2.4593 -> 2.6029   acc: 55.02% -> 54.67%             
client [95] (test)  loss: 2.2212 -> 2.4026   acc: 61.26% -> 60.21%             
client [67] (test)  loss: 1.9944 -> 1.9540   acc: 59.79% -> 59.79%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.3738 -> 2.4312   acc: 56.40% -> 55.80%             
client [79] (test)  loss: 3.2049 -> 3.4548   acc: 47.22% -> 47.65%             
client [58] (test)  loss: 2.9353 -> 3.1686   acc: 52.30% -> 52.83%             
client [88] (test)  loss: 2.3175 -> 2.4894   acc: 58.36% -> 58.02%             
client [46] (test)  loss: 1.8389 -> 1.9264   acc: 62.70% -> 59.82%             
client [11] (test)  loss: 2.5451 -> 2.7110   acc: 54.84% -> 54.50%             
client [55] (test)  loss: 2.3985 -> 2.5299   acc: 60.95% -> 60.22%             
client [13] (test)  loss: 2.5390 -> 2.7922   acc: 59.39% -> 59.22%             
client [31] (test)  loss: 1.7745 -> 1.9614   acc: 72.13% -> 66.55%             
client [75] (test)  loss: 2.4598 -> 2.7021   acc: 58.96% -> 58.78%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.5774 -> 2.8512   acc: 56.65% -> 55.76%             
client [7] (test)  loss: 2.6610 -> 2.9639   acc: 55.12% -> 51.53%              
client [57] (test)  loss: 2.8327 -> 2.8661   acc: 52.18% -> 54.55%             
client [13] (test)  loss: 2.7395 -> 2.9415   acc: 59.22% -> 58.87%             
client [43] (test)  loss: 2.9002 -> 3.0910   acc: 54.63% -> 54.15%             
client [91] (test)  loss: 1.9075 -> 1.8764   acc: 59.56% -> 61.93%             
client [10] (test)  loss: 2.2360 -> 4.1387   acc: 59.33% -> 50.37%             
client [64] (test)  loss: 2.0935 -> 2.2012   acc: 63.86% -> 62.54%             
client [82] (test)  loss: 2.4859 -> 2.7071   acc: 59.58% -> 58.12%             
client [22] (test)  loss: 2.2754 -> 2.5466   acc: 62.52% -> 60.36%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.0616 -> 2.2430   acc: 61.42% -> 60.03%             
client [23] (test)  loss: 1.8385 -> 1.5998   acc: 66.19% -> 65.49%             
client [88] (test)  loss: 2.5416 -> 2.6861   acc: 60.24% -> 54.27%             
client [98] (test)  loss: 2.1686 -> 2.2287   acc: 63.89% -> 62.19%             
client [79] (test)  loss: 3.5159 -> 3.7864   acc: 46.37% -> 47.22%             
client [21] (test)  loss: 2.6270 -> 2.5188   acc: 56.60% -> 56.40%             
client [92] (test)  loss: 2.3407 -> 2.1361   acc: 61.59% -> 57.96%             
client [56] (test)  loss: 3.2579 -> 3.4733   acc: 50.53% -> 50.71%             
client [5] (test)  loss: 2.5098 -> 2.6870   acc: 57.66% -> 57.48%              
client [52] (test)  loss: 2.4315 -> 2.7298   acc: 59.75% -> 59.04%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '1.8229 -> 0.0000', 'accuracy': '57.93% -> 0.00%'},          
    200: {'loss': '2.5402 -> 0.0000', 'accuracy': '58.73% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(10.30%) at epoch: 20                                     
FedRep achieved 30.0%(31.09%) at epoch: 28                                     
FedRep achieved 40.0%(42.12%) at epoch: 38                                     
FedRep achieved 50.0%(52.86%) at epoch: 56                                     
FedRep achieved 60.0%(60.02%) at epoch: 96                                     
Convergence (test_after):                                                      
FedRep achieved 10.0%(10.98%) at epoch: 9                                      
FedRep achieved 20.0%(22.35%) at epoch: 18                                     
FedRep achieved 30.0%(31.70%) at epoch: 23                                     
FedRep achieved 40.0%(40.83%) at epoch: 34                                     
FedRep achieved 50.0%(51.80%) at epoch: 56                                     
FedRep achieved 60.0%(60.14%) at epoch: 130                                    
