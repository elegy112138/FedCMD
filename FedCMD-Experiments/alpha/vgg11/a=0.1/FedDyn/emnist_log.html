==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9562 -> 0.1295   acc: 72.50% -> 97.41%             
client [81] (test)  loss: 0.8628 -> 0.1684   acc: 68.50% -> 93.85%             
client [21] (test)  loss: 0.2562 -> 0.0582   acc: 92.86% -> 98.62%             
client [68] (test)  loss: 1.3930 -> 0.3112   acc: 59.89% -> 93.16%             
client [93] (test)  loss: 0.1563 -> 0.0331   acc: 95.63% -> 99.27%             
client [31] (test)  loss: 0.4380 -> 0.1226   acc: 85.05% -> 94.80%             
client [20] (test)  loss: 1.4239 -> 0.1228   acc: 46.10% -> 97.72%             
client [59] (test)  loss: 0.7740 -> 0.2416   acc: 74.69% -> 91.77%             
client [48] (test)  loss: 2.6874 -> 0.6631   acc: 43.80% -> 86.29%             
client [34] (test)  loss: 1.0453 -> 0.0810   acc: 62.83% -> 98.21%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.1851 -> 0.2101   acc: 68.34% -> 94.91%             
client [99] (test)  loss: 0.1330 -> 0.0306   acc: 95.38% -> 99.35%             
client [67] (test)  loss: 0.6013 -> 0.2834   acc: 82.25% -> 89.35%             
client [0] (test)  loss: 0.4316 -> 0.1135   acc: 89.11% -> 97.16%              
client [76] (test)  loss: 0.8290 -> 0.2384   acc: 73.95% -> 95.32%             
client [41] (test)  loss: 0.9100 -> 0.3117   acc: 73.21% -> 90.81%             
client [62] (test)  loss: 0.2690 -> 0.0900   acc: 93.06% -> 98.20%             
client [2] (test)  loss: 0.7767 -> 0.1429   acc: 80.64% -> 97.19%              
client [14] (test)  loss: 0.8036 -> 0.1697   acc: 71.83% -> 96.43%             
client [46] (test)  loss: 0.6622 -> 0.0232   acc: 73.04% -> 99.54%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4422 -> 0.2160   acc: 87.93% -> 95.15%             
client [68] (test)  loss: 1.1797 -> 0.3033   acc: 58.75% -> 94.10%             
client [57] (test)  loss: 0.5938 -> 0.0957   acc: 80.30% -> 98.62%             
client [17] (test)  loss: 1.3802 -> 0.1666   acc: 62.63% -> 94.96%             
client [54] (test)  loss: 0.9291 -> 0.2478   acc: 72.07% -> 95.72%             
client [23] (test)  loss: 0.2466 -> 0.0914   acc: 93.08% -> 97.41%             
client [35] (test)  loss: 0.1905 -> 0.0127   acc: 94.95% -> 99.77%             
client [59] (test)  loss: 0.4188 -> 0.2316   acc: 87.84% -> 92.59%             
client [31] (test)  loss: 0.4577 -> 0.1199   acc: 87.32% -> 95.09%             
client [9] (test)  loss: 1.1395 -> 0.1554   acc: 71.43% -> 96.75%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7586 -> 0.3132   acc: 79.70% -> 92.33%             
client [33] (test)  loss: 0.6180 -> 0.0616   acc: 77.52% -> 98.88%             
client [16] (test)  loss: 1.1839 -> 0.3201   acc: 62.74% -> 91.05%             
client [44] (test)  loss: 1.0953 -> 0.2974   acc: 69.13% -> 92.68%             
client [8] (test)  loss: 1.1844 -> 0.3477   acc: 70.72% -> 89.02%              
client [31] (test)  loss: 0.3292 -> 0.1161   acc: 88.97% -> 95.84%             
client [47] (test)  loss: 1.2660 -> 0.2722   acc: 62.52% -> 94.17%             
client [36] (test)  loss: 0.8205 -> 0.1646   acc: 75.83% -> 96.18%             
client [20] (test)  loss: 0.9829 -> 0.0875   acc: 63.34% -> 98.38%             
client [56] (test)  loss: 1.1939 -> 0.0153   acc: 65.24% -> 99.65%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1730 -> 0.3898   acc: 74.17% -> 87.39%              
client [60] (test)  loss: 0.4872 -> 0.0802   acc: 85.77% -> 98.71%             
client [28] (test)  loss: 0.2176 -> 0.0027   acc: 93.38% -> 99.94%             
client [25] (test)  loss: 0.5828 -> 0.1124   acc: 82.98% -> 97.17%             
client [58] (test)  loss: 0.0948 -> 0.0063   acc: 97.48% -> 99.83%             
client [44] (test)  loss: 1.1815 -> 0.3448   acc: 69.96% -> 92.41%             
client [39] (test)  loss: 0.8042 -> 0.1157   acc: 73.66% -> 97.62%             
client [29] (test)  loss: 0.7676 -> 0.1928   acc: 81.82% -> 94.76%             
client [3] (test)  loss: 0.0945 -> 0.0078   acc: 97.75% -> 99.84%              
client [84] (test)  loss: 0.9013 -> 0.1775   acc: 81.53% -> 95.55%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2411 -> 0.0425   acc: 92.91% -> 99.13%             
client [84] (test)  loss: 0.8348 -> 0.1802   acc: 80.64% -> 95.92%             
client [10] (test)  loss: 0.9153 -> 0.3132   acc: 74.53% -> 88.73%             
client [36] (test)  loss: 1.0899 -> 0.1979   acc: 71.50% -> 95.97%             
client [65] (test)  loss: 0.5539 -> 0.4303   acc: 81.38% -> 90.69%             
client [81] (test)  loss: 0.4441 -> 0.2253   acc: 83.58% -> 93.05%             
client [79] (test)  loss: 0.9908 -> 0.2647   acc: 71.86% -> 93.46%             
client [42] (test)  loss: 0.4831 -> 0.2429   acc: 86.35% -> 94.92%             
client [11] (test)  loss: 0.4433 -> 0.0998   acc: 89.53% -> 98.46%             
client [96] (test)  loss: 0.4688 -> 0.1959   acc: 87.87% -> 95.62%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.1964 -> 0.3740   acc: 71.11% -> 89.53%              
client [53] (test)  loss: 0.2076 -> 0.0405   acc: 95.37% -> 99.19%             
client [52] (test)  loss: 1.0824 -> 0.4709   acc: 72.83% -> 87.58%             
client [42] (test)  loss: 0.4669 -> 0.2557   acc: 88.67% -> 94.84%             
client [69] (test)  loss: 0.9406 -> 0.2184   acc: 77.59% -> 95.30%             
client [59] (test)  loss: 0.4768 -> 0.2689   acc: 87.54% -> 92.70%             
client [7] (test)  loss: 0.7194 -> 0.2894   acc: 80.86% -> 93.74%              
client [26] (test)  loss: 0.6588 -> 0.2624   acc: 74.30% -> 95.14%             
client [49] (test)  loss: 0.0309 -> 0.0005   acc: 99.25% -> 99.98%             
client [98] (test)  loss: 0.3783 -> 0.0452   acc: 89.53% -> 99.36%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2768 -> 0.0544   acc: 92.55% -> 99.29%             
client [47] (test)  loss: 1.3290 -> 0.3134   acc: 63.34% -> 94.69%             
client [21] (test)  loss: 0.2705 -> 0.0469   acc: 92.33% -> 99.10%             
client [77] (test)  loss: 0.4520 -> 0.0933   acc: 89.94% -> 98.09%             
client [95] (test)  loss: 1.4908 -> 0.0982   acc: 53.24% -> 98.43%             
client [91] (test)  loss: 1.0007 -> 0.0721   acc: 74.36% -> 98.51%             
client [14] (test)  loss: 0.5995 -> 0.1842   acc: 79.51% -> 96.63%             
client [99] (test)  loss: 0.1446 -> 0.0211   acc: 95.36% -> 99.61%             
client [20] (test)  loss: 0.7373 -> 0.0909   acc: 73.40% -> 98.41%             
client [39] (test)  loss: 0.7184 -> 0.1145   acc: 76.73% -> 98.21%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.4636 -> 0.4948   acc: 65.52% -> 92.20%             
client [62] (test)  loss: 0.1641 -> 0.0718   acc: 96.35% -> 98.88%             
client [71] (test)  loss: 0.0731 -> 0.0093   acc: 97.90% -> 99.88%             
client [97] (test)  loss: 0.1217 -> 0.0047   acc: 96.35% -> 99.89%             
client [30] (test)  loss: 0.7077 -> 0.1336   acc: 73.01% -> 97.55%             
client [88] (test)  loss: 0.9840 -> 0.3482   acc: 75.28% -> 92.55%             
client [60] (test)  loss: 0.6108 -> 0.0914   acc: 83.91% -> 98.62%             
client [82] (test)  loss: 0.9314 -> 0.6095   acc: 63.41% -> 69.88%             
client [91] (test)  loss: 1.0324 -> 0.0770   acc: 71.07% -> 98.47%             
client [57] (test)  loss: 0.5269 -> 0.1134   acc: 84.41% -> 98.50%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2508 -> 0.1669   acc: 92.02% -> 94.89%             
client [15] (test)  loss: 0.3990 -> 0.0161   acc: 89.22% -> 99.66%             
client [71] (test)  loss: 0.0814 -> 0.0128   acc: 97.72% -> 99.79%             
client [97] (test)  loss: 0.3015 -> 0.0078   acc: 91.92% -> 99.89%             
client [53] (test)  loss: 0.2201 -> 0.0462   acc: 95.08% -> 99.07%             
client [77] (test)  loss: 0.4255 -> 0.0957   acc: 90.87% -> 98.27%             
client [76] (test)  loss: 0.9980 -> 0.2308   acc: 69.95% -> 95.55%             
client [79] (test)  loss: 1.5403 -> 0.2919   acc: 72.48% -> 93.12%             
client [28] (test)  loss: 0.1292 -> 0.0029   acc: 96.45% -> 99.93%             
client [99] (test)  loss: 0.1950 -> 0.0222   acc: 94.14% -> 99.63%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1758 -> 0.0086   acc: 95.12% -> 99.84%             
client [86] (test)  loss: 0.8482 -> 0.4217   acc: 78.77% -> 90.56%             
client [34] (test)  loss: 0.6085 -> 0.0854   acc: 84.38% -> 98.65%             
client [73] (test)  loss: 0.4738 -> 0.2680   acc: 88.62% -> 93.51%             
client [5] (test)  loss: 0.5492 -> 0.1471   acc: 86.17% -> 97.89%              
client [96] (test)  loss: 0.8633 -> 0.1669   acc: 74.68% -> 96.70%             
client [22] (test)  loss: 0.4549 -> 0.2068   acc: 88.36% -> 96.02%             
client [60] (test)  loss: 0.6004 -> 0.1002   acc: 82.56% -> 98.27%             
client [66] (test)  loss: 1.3992 -> 0.2376   acc: 57.99% -> 96.08%             
client [83] (test)  loss: 0.3123 -> 0.1224   acc: 90.87% -> 97.85%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8311 -> 0.2313   acc: 76.50% -> 95.47%             
client [65] (test)  loss: 1.0418 -> 0.4270   acc: 71.41% -> 90.63%             
client [95] (test)  loss: 2.2346 -> 0.1097   acc: 52.35% -> 98.41%             
client [17] (test)  loss: 0.6037 -> 0.1563   acc: 81.43% -> 96.20%             
client [8] (test)  loss: 1.1795 -> 0.4150   acc: 75.70% -> 90.00%              
client [35] (test)  loss: 0.1144 -> 0.0136   acc: 97.13% -> 99.75%             
client [98] (test)  loss: 0.2003 -> 0.0481   acc: 94.56% -> 99.36%             
client [53] (test)  loss: 0.1582 -> 0.0447   acc: 96.46% -> 99.25%             
client [43] (test)  loss: 1.1684 -> 0.4743   acc: 69.20% -> 88.65%             
client [64] (test)  loss: 1.1138 -> 0.3510   acc: 75.59% -> 91.48%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2781 -> 0.0575   acc: 91.96% -> 99.03%             
client [88] (test)  loss: 1.2920 -> 0.3655   acc: 63.87% -> 92.03%             
client [38] (test)  loss: 1.8568 -> 0.2770   acc: 71.09% -> 96.27%             
client [3] (test)  loss: 0.3736 -> 0.0136   acc: 87.44% -> 99.78%              
client [5] (test)  loss: 0.6733 -> 0.1490   acc: 83.77% -> 97.84%              
client [41] (test)  loss: 1.0372 -> 0.5199   acc: 75.55% -> 90.93%             
client [7] (test)  loss: 1.3260 -> 0.2964   acc: 62.44% -> 94.26%              
client [37] (test)  loss: 0.2287 -> 0.0220   acc: 92.63% -> 99.61%             
client [45] (test)  loss: 1.0276 -> 0.4941   acc: 76.24% -> 88.84%             
client [47] (test)  loss: 1.5876 -> 0.3336   acc: 65.18% -> 94.51%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.7195 -> 0.3907   acc: 64.80% -> 91.08%             
client [11] (test)  loss: 0.3316 -> 0.0951   acc: 92.60% -> 98.55%             
client [37] (test)  loss: 0.1689 -> 0.0340   acc: 95.45% -> 99.49%             
client [41] (test)  loss: 1.2084 -> 0.3914   acc: 75.55% -> 91.64%             
client [95] (test)  loss: 1.3879 -> 0.1195   acc: 56.63% -> 98.23%             
client [53] (test)  loss: 0.2241 -> 0.0423   acc: 95.06% -> 99.23%             
client [22] (test)  loss: 0.9604 -> 0.2172   acc: 82.05% -> 95.80%             
client [25] (test)  loss: 0.7395 -> 0.1446   acc: 84.71% -> 96.88%             
client [69] (test)  loss: 1.7271 -> 0.3326   acc: 74.57% -> 94.55%             
client [46] (test)  loss: 0.5520 -> 0.0232   acc: 80.57% -> 99.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9475 -> 0.3468   acc: 73.56% -> 94.60%             
client [69] (test)  loss: 1.3352 -> 0.2821   acc: 75.39% -> 95.69%             
client [82] (test)  loss: 1.0240 -> 0.7302   acc: 63.77% -> 69.84%             
client [45] (test)  loss: 1.0842 -> 0.4721   acc: 72.30% -> 88.82%             
client [7] (test)  loss: 0.9958 -> 0.3261   acc: 74.39% -> 94.00%              
client [50] (test)  loss: 0.9803 -> 0.1534   acc: 70.99% -> 97.83%             
client [35] (test)  loss: 0.0782 -> 0.0171   acc: 98.12% -> 99.77%             
client [24] (test)  loss: 1.0235 -> 0.2740   acc: 72.07% -> 95.93%             
client [15] (test)  loss: 0.2661 -> 0.0123   acc: 91.54% -> 99.69%             
client [58] (test)  loss: 0.1303 -> 0.0109   acc: 97.11% -> 99.81%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.5642 -> 0.8411   acc: 49.44% -> 86.23%             
client [76] (test)  loss: 0.7005 -> 0.2369   acc: 79.31% -> 95.79%             
client [67] (test)  loss: 0.5865 -> 0.3017   acc: 83.34% -> 92.49%             
client [37] (test)  loss: 0.3813 -> 0.0224   acc: 87.66% -> 99.56%             
client [58] (test)  loss: 0.0841 -> 0.0107   acc: 98.13% -> 99.78%             
client [64] (test)  loss: 0.9484 -> 0.4084   acc: 75.30% -> 91.70%             
client [77] (test)  loss: 0.2291 -> 0.1112   acc: 95.08% -> 98.12%             
client [55] (test)  loss: 0.5386 -> 0.1340   acc: 82.81% -> 98.14%             
client [12] (test)  loss: 0.9367 -> 0.2804   acc: 79.17% -> 95.32%             
client [89] (test)  loss: 0.8450 -> 0.3408   acc: 72.88% -> 90.86%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9661 -> 0.2371   acc: 83.25% -> 95.71%             
client [51] (test)  loss: 1.1225 -> 0.4647   acc: 73.69% -> 91.89%             
client [8] (test)  loss: 1.2171 -> 0.4326   acc: 74.96% -> 90.80%              
client [18] (test)  loss: 0.1593 -> 0.0279   acc: 95.92% -> 99.51%             
client [94] (test)  loss: 0.3131 -> 0.0068   acc: 91.92% -> 99.94%             
client [81] (test)  loss: 0.9588 -> 0.2456   acc: 76.13% -> 94.03%             
client [3] (test)  loss: 0.0903 -> 0.0156   acc: 98.04% -> 99.80%              
client [11] (test)  loss: 0.4883 -> 0.1078   acc: 89.66% -> 98.46%             
client [95] (test)  loss: 3.0925 -> 0.1267   acc: 48.56% -> 98.13%             
client [67] (test)  loss: 1.0045 -> 0.2900   acc: 79.04% -> 92.63%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1729 -> 0.0672   acc: 95.70% -> 98.98%             
client [79] (test)  loss: 1.1916 -> 0.3124   acc: 74.35% -> 94.27%             
client [58] (test)  loss: 0.0813 -> 0.0152   acc: 98.54% -> 99.66%             
client [88] (test)  loss: 1.3149 -> 0.3651   acc: 68.19% -> 92.55%             
client [46] (test)  loss: 0.7687 -> 0.0206   acc: 73.11% -> 99.70%             
client [11] (test)  loss: 0.4987 -> 0.1071   acc: 89.68% -> 98.44%             
client [55] (test)  loss: 0.6467 -> 0.1353   acc: 78.82% -> 98.41%             
client [13] (test)  loss: 0.3484 -> 0.0678   acc: 91.44% -> 98.64%             
client [31] (test)  loss: 0.2248 -> 0.1744   acc: 92.98% -> 96.47%             
client [75] (test)  loss: 1.0074 -> 0.2295   acc: 79.02% -> 96.04%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2942 -> 0.0753   acc: 93.20% -> 98.74%             
client [7] (test)  loss: 0.9567 -> 0.3771   acc: 76.26% -> 94.18%              
client [57] (test)  loss: 0.5445 -> 0.1436   acc: 85.56% -> 98.27%             
client [13] (test)  loss: 0.3617 -> 0.0755   acc: 92.10% -> 98.61%             
client [43] (test)  loss: 0.9860 -> 0.5529   acc: 79.18% -> 89.43%             
client [91] (test)  loss: 1.3130 -> 0.0727   acc: 70.74% -> 98.72%             
client [10] (test)  loss: 1.2538 -> 0.4854   acc: 68.16% -> 88.09%             
client [64] (test)  loss: 0.8998 -> 0.4700   acc: 81.41% -> 91.27%             
client [82] (test)  loss: 2.0609 -> 0.7644   acc: 50.71% -> 70.38%             
client [22] (test)  loss: 0.7030 -> 0.2525   acc: 87.13% -> 95.73%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5507 -> 0.1319   acc: 84.09% -> 98.38%             
client [23] (test)  loss: 0.6991 -> 0.1295   acc: 78.76% -> 97.46%             
client [88] (test)  loss: 1.1776 -> 0.3621   acc: 67.75% -> 92.69%             
client [98] (test)  loss: 0.5369 -> 0.0600   acc: 81.54% -> 99.43%             
client [79] (test)  loss: 0.7409 -> 0.3362   acc: 82.69% -> 93.34%             
client [21] (test)  loss: 0.4668 -> 0.0847   acc: 88.20% -> 99.00%             
client [92] (test)  loss: 1.0261 -> 0.0717   acc: 69.73% -> 98.86%             
client [56] (test)  loss: 0.9368 -> 0.0342   acc: 73.29% -> 99.65%             
client [5] (test)  loss: 0.6916 -> 0.1766   acc: 85.56% -> 97.51%              
client [52] (test)  loss: 0.9485 -> 0.5922   acc: 74.02% -> 91.87%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.6727 -> 0.0000', 'accuracy': '83.40% -> 0.00%'},          
    200: {'loss': '0.7374 -> 0.0000', 'accuracy': '80.97% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 20.0%(21.66%) at epoch: 1                                      
FedDyn achieved 60.0%(60.65%) at epoch: 2                                      
FedDyn achieved 70.0%(71.03%) at epoch: 5                                      
FedDyn achieved 80.0%(84.19%) at epoch: 10                                     
FedDyn achieved 90.0%(91.04%) at epoch: 99                                     
Convergence (test_after):                                                      
FedDyn achieved 90.0%(95.90%) at epoch: 0                                      
