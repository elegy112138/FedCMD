==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.2638 -> 0.0022   acc: 90.14% -> 100.00%            
client [81] (test)  loss: 0.3924 -> 0.1246   acc: 86.36% -> 96.36%             
client [21] (test)  loss: 0.7354 -> 0.4180   acc: 74.88% -> 87.92%             
client [68] (test)  loss: 0.2965 -> 0.1196   acc: 89.90% -> 95.82%             
client [93] (test)  loss: 1.2943 -> 0.1716   acc: 53.60% -> 98.40%             
client [31] (test)  loss: 0.4797 -> 0.1595   acc: 86.67% -> 95.00%             
client [20] (test)  loss: 0.3082 -> 0.0508   acc: 89.50% -> 98.83%             
client [59] (test)  loss: 0.4640 -> 0.4305   acc: 84.52% -> 85.48%             
client [48] (test)  loss: 0.8469 -> 0.0699   acc: 76.88% -> 98.12%             
client [34] (test)  loss: 0.3044 -> 0.2185   acc: 92.65% -> 95.59%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4284 -> 0.2407   acc: 86.13% -> 93.60%             
client [99] (test)  loss: 2.1215 -> 0.0789   acc: 31.25% -> 98.58%             
client [67] (test)  loss: 1.9985 -> 0.2378   acc: 20.83% -> 91.07%             
client [0] (test)  loss: 0.5773 -> 1.0077   acc: 85.05% -> 78.50%              
client [76] (test)  loss: 0.3268 -> 0.2565   acc: 81.58% -> 94.74%             
client [41] (test)  loss: 0.3922 -> 0.3483   acc: 87.56% -> 90.28%             
client [62] (test)  loss: 1.1795 -> 0.2522   acc: 71.43% -> 92.86%             
client [2] (test)  loss: 0.7380 -> 0.0007   acc: 73.76% -> 100.00%             
client [14] (test)  loss: 2.2133 -> 0.1199   acc: 30.87% -> 97.85%             
client [46] (test)  loss: 2.0603 -> 0.5710   acc: 16.74% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8147 -> 0.4962   acc: 67.10% -> 82.38%             
client [68] (test)  loss: 0.3743 -> 0.0946   acc: 86.06% -> 96.86%             
client [57] (test)  loss: 0.7286 -> 0.0556   acc: 70.68% -> 99.25%             
client [17] (test)  loss: 0.7758 -> 0.2008   acc: 73.20% -> 93.92%             
client [54] (test)  loss: 0.4371 -> 0.1827   acc: 80.31% -> 92.23%             
client [23] (test)  loss: 0.3215 -> 0.1089   acc: 87.59% -> 96.24%             
client [35] (test)  loss: 0.7232 -> 0.1275   acc: 70.91% -> 95.76%             
client [59] (test)  loss: 0.5589 -> 0.3145   acc: 78.71% -> 91.29%             
client [31] (test)  loss: 0.2643 -> 0.1413   acc: 92.22% -> 96.11%             
client [9] (test)  loss: 0.2846 -> 0.0370   acc: 90.66% -> 98.96%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2889 -> 0.1496   acc: 90.29% -> 97.06%             
client [33] (test)  loss: 0.2682 -> 0.0882   acc: 90.41% -> 97.72%             
client [16] (test)  loss: 0.7331 -> 0.0897   acc: 75.87% -> 97.90%             
client [44] (test)  loss: 0.5385 -> 0.1709   acc: 82.78% -> 97.07%             
client [8] (test)  loss: 0.5499 -> 0.0001   acc: 81.76% -> 100.00%             
client [31] (test)  loss: 0.2429 -> 0.1432   acc: 92.22% -> 95.56%             
client [47] (test)  loss: 0.2762 -> 0.0215   acc: 89.71% -> 99.26%             
client [36] (test)  loss: 0.1052 -> 0.0050   acc: 96.81% -> 99.75%             
client [20] (test)  loss: 0.3575 -> 0.0241   acc: 88.00% -> 99.33%             
client [56] (test)  loss: 0.6001 -> 0.4626   acc: 80.08% -> 89.84%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3278 -> 0.1254   acc: 92.73% -> 97.23%              
client [60] (test)  loss: 0.8273 -> 0.0824   acc: 67.70% -> 98.07%             
client [28] (test)  loss: 0.1891 -> 0.1037   acc: 93.75% -> 97.32%             
client [25] (test)  loss: 0.2277 -> 0.1148   acc: 92.33% -> 97.21%             
client [58] (test)  loss: 0.2879 -> 0.1223   acc: 91.06% -> 96.90%             
client [44] (test)  loss: 0.5984 -> 0.1789   acc: 82.78% -> 95.60%             
client [39] (test)  loss: 0.4313 -> 0.3106   acc: 91.67% -> 91.67%             
client [29] (test)  loss: 0.8070 -> 0.2865   acc: 76.26% -> 92.69%             
client [3] (test)  loss: 0.3074 -> 0.2348   acc: 90.22% -> 92.39%              
client [84] (test)  loss: 1.1364 -> 0.0305   acc: 62.39% -> 99.08%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2947 -> 0.3214   acc: 91.30% -> 91.55%             
client [84] (test)  loss: 0.8832 -> 0.0330   acc: 71.10% -> 99.08%             
client [10] (test)  loss: 0.1664 -> 0.0908   acc: 96.38% -> 97.10%             
client [36] (test)  loss: 0.0806 -> 0.0035   acc: 97.91% -> 99.88%             
client [65] (test)  loss: 1.3155 -> 0.2130   acc: 55.95% -> 94.05%             
client [81] (test)  loss: 0.3578 -> 0.0805   acc: 91.82% -> 95.45%             
client [79] (test)  loss: 0.7037 -> 0.3471   acc: 74.45% -> 88.45%             
client [42] (test)  loss: 0.2920 -> 0.0264   acc: 91.55% -> 99.29%             
client [11] (test)  loss: 0.4435 -> 0.3674   acc: 82.89% -> 86.67%             
client [96] (test)  loss: 0.3832 -> 0.1933   acc: 87.92% -> 94.94%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3784 -> 0.0000   acc: 88.96% -> 100.00%             
client [53] (test)  loss: 0.1387 -> 0.0430   acc: 96.76% -> 99.39%             
client [52] (test)  loss: 0.7039 -> 0.2962   acc: 74.42% -> 89.92%             
client [42] (test)  loss: 0.3699 -> 0.0254   acc: 90.24% -> 99.35%             
client [69] (test)  loss: 0.4338 -> 0.2854   acc: 89.87% -> 93.33%             
client [59] (test)  loss: 0.4188 -> 0.3491   acc: 87.42% -> 90.00%             
client [7] (test)  loss: 0.3268 -> 0.0401   acc: 90.24% -> 98.90%              
client [26] (test)  loss: 0.7462 -> 0.0271   acc: 78.39% -> 99.68%             
client [49] (test)  loss: 1.1228 -> 0.0002   acc: 61.57% -> 100.00%            
client [98] (test)  loss: 0.7864 -> 0.4383   acc: 75.00% -> 82.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4524 -> 0.4501   acc: 85.00% -> 87.00%             
client [47] (test)  loss: 0.4976 -> 0.0231   acc: 84.19% -> 99.08%             
client [21] (test)  loss: 0.2753 -> 0.2545   acc: 91.06% -> 92.51%             
client [77] (test)  loss: 0.1519 -> 0.0164   acc: 95.77% -> 99.44%             
client [95] (test)  loss: 0.4496 -> 0.1883   acc: 88.72% -> 95.49%             
client [91] (test)  loss: 0.4871 -> 0.0536   acc: 78.12% -> 100.00%            
client [14] (test)  loss: 0.2350 -> 0.1262   acc: 92.21% -> 97.72%             
client [99] (test)  loss: 0.1590 -> 0.0730   acc: 96.31% -> 98.30%             
client [20] (test)  loss: 1.0046 -> 0.0255   acc: 61.33% -> 99.33%             
client [39] (test)  loss: 0.3049 -> 0.4648   acc: 94.44% -> 91.67%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8445 -> 0.2897   acc: 74.42% -> 90.70%             
client [62] (test)  loss: 0.3846 -> 0.1993   acc: 92.86% -> 90.48%             
client [71] (test)  loss: 0.1969 -> 0.0389   acc: 93.67% -> 98.55%             
client [97] (test)  loss: 0.2416 -> 0.0670   acc: 93.76% -> 99.01%             
client [30] (test)  loss: 0.3019 -> 0.1992   acc: 91.01% -> 96.25%             
client [88] (test)  loss: 1.1319 -> 0.4672   acc: 64.64% -> 86.74%             
client [60] (test)  loss: 0.7105 -> 0.1017   acc: 74.66% -> 98.26%             
client [82] (test)  loss: 1.7881 -> 0.0401   acc: 46.31% -> 99.52%             
client [91] (test)  loss: 0.3338 -> 0.0610   acc: 93.75% -> 96.88%             
client [57] (test)  loss: 1.6851 -> 0.0401   acc: 49.25% -> 99.44%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.3972 -> 0.0933   acc: 85.56% -> 96.67%             
client [15] (test)  loss: 0.7832 -> 0.3013   acc: 74.31% -> 89.17%             
client [71] (test)  loss: 0.1450 -> 0.0451   acc: 94.58% -> 98.55%             
client [97] (test)  loss: 0.3076 -> 0.0564   acc: 90.80% -> 99.01%             
client [53] (test)  loss: 0.1354 -> 0.0449   acc: 97.07% -> 99.39%             
client [77] (test)  loss: 0.0484 -> 0.0094   acc: 98.31% -> 99.72%             
client [76] (test)  loss: 0.2887 -> 0.2845   acc: 89.47% -> 94.74%             
client [79] (test)  loss: 0.5255 -> 0.4366   acc: 80.84% -> 88.70%             
client [28] (test)  loss: 0.3427 -> 0.0218   acc: 85.71% -> 100.00%            
client [99] (test)  loss: 0.9014 -> 0.0776   acc: 70.45% -> 97.73%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3555 -> 0.0567   acc: 90.64% -> 99.18%             
client [86] (test)  loss: 0.1425 -> 0.1111   acc: 96.49% -> 96.49%             
client [34] (test)  loss: 0.4751 -> 0.2863   acc: 91.18% -> 97.06%             
client [73] (test)  loss: 0.4766 -> 0.0382   acc: 83.57% -> 99.64%             
client [5] (test)  loss: 0.6246 -> 0.0334   acc: 80.79% -> 99.34%              
client [96] (test)  loss: 0.3962 -> 0.2056   acc: 88.48% -> 95.51%             
client [22] (test)  loss: 0.4989 -> 0.0851   acc: 82.08% -> 97.17%             
client [60] (test)  loss: 0.6035 -> 0.1016   acc: 76.79% -> 98.07%             
client [66] (test)  loss: 0.6195 -> 0.0005   acc: 83.16% -> 100.00%            
client [83] (test)  loss: 0.3584 -> 0.0352   acc: 90.06% -> 98.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1023 -> 0.1926   acc: 92.11% -> 94.74%             
client [65] (test)  loss: 1.2332 -> 0.1646   acc: 61.90% -> 94.05%             
client [95] (test)  loss: 0.3343 -> 0.1949   acc: 90.23% -> 95.49%             
client [17] (test)  loss: 0.4055 -> 0.1520   acc: 89.78% -> 96.69%             
client [8] (test)  loss: 0.4794 -> 0.0000   acc: 88.29% -> 100.00%             
client [35] (test)  loss: 0.3194 -> 0.0898   acc: 92.12% -> 98.79%             
client [98] (test)  loss: 0.5357 -> 0.4545   acc: 81.00% -> 88.00%             
client [53] (test)  loss: 0.1524 -> 0.0452   acc: 96.36% -> 99.29%             
client [43] (test)  loss: 1.3088 -> 0.1344   acc: 71.11% -> 97.04%             
client [64] (test)  loss: 0.1520 -> 0.0839   acc: 95.29% -> 97.94%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2172 -> 0.3086   acc: 91.79% -> 93.72%             
client [88] (test)  loss: 0.8155 -> 0.5188   acc: 72.93% -> 89.50%             
client [38] (test)  loss: 1.0600 -> 0.6119   acc: 76.97% -> 84.85%             
client [3] (test)  loss: 0.3566 -> 0.1219   acc: 90.76% -> 95.65%              
client [5] (test)  loss: 0.4407 -> 0.0411   acc: 84.28% -> 99.13%              
client [41] (test)  loss: 0.2162 -> 0.4010   acc: 92.88% -> 91.97%             
client [7] (test)  loss: 0.2302 -> 0.0566   acc: 92.63% -> 98.90%              
client [37] (test)  loss: 0.3216 -> 0.1675   acc: 89.18% -> 95.36%             
client [45] (test)  loss: 0.6096 -> 0.4085   acc: 83.33% -> 88.46%             
client [47] (test)  loss: 0.2778 -> 0.0220   acc: 92.83% -> 99.08%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.4811 -> 0.0783   acc: 63.99% -> 98.25%             
client [11] (test)  loss: 1.8125 -> 0.3019   acc: 51.78% -> 88.00%             
client [37] (test)  loss: 0.7121 -> 0.1520   acc: 72.16% -> 96.39%             
client [41] (test)  loss: 0.4260 -> 0.3559   acc: 88.08% -> 93.26%             
client [95] (test)  loss: 0.6827 -> 0.1357   acc: 84.21% -> 96.24%             
client [53] (test)  loss: 0.1367 -> 0.0463   acc: 97.17% -> 99.29%             
client [22] (test)  loss: 1.4716 -> 0.0884   acc: 65.09% -> 97.17%             
client [25] (test)  loss: 0.1825 -> 0.0533   acc: 96.17% -> 98.61%             
client [69] (test)  loss: 0.4057 -> 0.2167   acc: 89.33% -> 94.93%             
client [46] (test)  loss: 0.4122 -> 0.4718   acc: 85.02% -> 90.75%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4142 -> 0.0207   acc: 87.87% -> 99.26%             
client [69] (test)  loss: 0.4651 -> 0.2243   acc: 88.00% -> 94.93%             
client [82] (test)  loss: 0.7135 -> 0.0441   acc: 72.76% -> 99.52%             
client [45] (test)  loss: 0.6042 -> 0.4292   acc: 84.62% -> 88.46%             
client [7] (test)  loss: 0.3839 -> 0.0520   acc: 89.50% -> 97.79%              
client [50] (test)  loss: 0.5379 -> 0.0002   acc: 82.51% -> 100.00%            
client [35] (test)  loss: 0.4679 -> 0.1014   acc: 83.64% -> 98.18%             
client [24] (test)  loss: 0.5425 -> 0.6778   acc: 82.12% -> 83.94%             
client [15] (test)  loss: 0.8258 -> 0.1880   acc: 77.71% -> 93.42%             
client [58] (test)  loss: 0.2010 -> 0.0837   acc: 93.43% -> 97.81%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1541 -> 0.0329   acc: 96.25% -> 98.12%             
client [76] (test)  loss: 0.1003 -> 0.1421   acc: 97.37% -> 92.11%             
client [67] (test)  loss: 2.6507 -> 0.1407   acc: 39.73% -> 96.58%             
client [37] (test)  loss: 0.1406 -> 0.1231   acc: 95.88% -> 97.42%             
client [58] (test)  loss: 0.1732 -> 0.0628   acc: 95.80% -> 97.99%             
client [64] (test)  loss: 0.1199 -> 0.0947   acc: 97.35% -> 97.65%             
client [77] (test)  loss: 0.0933 -> 0.0192   acc: 97.18% -> 99.72%             
client [55] (test)  loss: 0.1567 -> 0.0049   acc: 96.84% -> 99.90%             
client [12] (test)  loss: 2.6765 -> 0.4608   acc: 38.57% -> 89.93%             
client [89] (test)  loss: 1.6975 -> 0.8518   acc: 61.90% -> 90.48%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6734 -> 0.0389   acc: 77.98% -> 99.08%             
client [51] (test)  loss: 0.4296 -> 0.0047   acc: 85.90% -> 99.74%             
client [8] (test)  loss: 0.7685 -> 0.0001   acc: 77.25% -> 100.00%             
client [18] (test)  loss: 0.1916 -> 0.0018   acc: 95.63% -> 100.00%            
client [94] (test)  loss: 0.4261 -> 0.2070   acc: 87.23% -> 96.45%             
client [81] (test)  loss: 0.4871 -> 0.1751   acc: 83.64% -> 95.45%             
client [3] (test)  loss: 0.4742 -> 0.1890   acc: 86.41% -> 94.38%              
client [11] (test)  loss: 0.5304 -> 0.3917   acc: 84.22% -> 88.22%             
client [95] (test)  loss: 0.5806 -> 0.2086   acc: 86.47% -> 96.24%             
client [67] (test)  loss: 1.3266 -> 0.1408   acc: 59.38% -> 96.58%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1891 -> 0.3723   acc: 94.44% -> 93.00%             
client [79] (test)  loss: 0.6425 -> 0.3025   acc: 80.34% -> 91.40%             
client [58] (test)  loss: 0.0981 -> 0.0667   acc: 96.35% -> 97.81%             
client [88] (test)  loss: 0.9083 -> 0.5356   acc: 71.82% -> 89.50%             
client [46] (test)  loss: 1.5725 -> 0.4649   acc: 54.19% -> 91.63%             
client [11] (test)  loss: 0.4724 -> 0.3205   acc: 84.44% -> 90.00%             
client [55] (test)  loss: 0.1186 -> 0.0039   acc: 97.80% -> 99.90%             
client [13] (test)  loss: 0.4501 -> 0.0184   acc: 87.16% -> 99.73%             
client [31] (test)  loss: 0.2020 -> 0.0872   acc: 93.89% -> 98.33%             
client [75] (test)  loss: 0.5182 -> 0.3225   acc: 85.96% -> 91.53%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3884 -> 0.2715   acc: 86.61% -> 94.49%             
client [7] (test)  loss: 0.3559 -> 0.0552   acc: 90.24% -> 98.16%              
client [57] (test)  loss: 0.5479 -> 0.0492   acc: 79.14% -> 99.44%             
client [13] (test)  loss: 0.7157 -> 0.0145   acc: 78.96% -> 99.73%             
client [43] (test)  loss: 1.1855 -> 0.1554   acc: 75.56% -> 99.26%             
client [91] (test)  loss: 0.3347 -> 0.1129   acc: 87.50% -> 96.88%             
client [10] (test)  loss: 0.2155 -> 0.1490   acc: 96.38% -> 97.10%             
client [64] (test)  loss: 0.2428 -> 0.0770   acc: 92.06% -> 97.94%             
client [82] (test)  loss: 0.6709 -> 0.0574   acc: 76.28% -> 99.52%             
client [22] (test)  loss: 0.8659 -> 0.0866   acc: 81.13% -> 97.64%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7152 -> 0.0374   acc: 80.00% -> 99.50%             
client [23] (test)  loss: 0.1587 -> 0.0947   acc: 93.23% -> 97.74%             
client [88] (test)  loss: 0.7473 -> 0.6573   acc: 78.45% -> 88.40%             
client [98] (test)  loss: 1.2414 -> 0.4978   acc: 67.00% -> 84.00%             
client [79] (test)  loss: 0.6324 -> 0.3411   acc: 80.84% -> 91.89%             
client [21] (test)  loss: 0.2056 -> 0.2986   acc: 94.44% -> 93.24%             
client [92] (test)  loss: 0.1975 -> 0.1293   acc: 94.52% -> 95.89%             
client [56] (test)  loss: 0.7699 -> 0.5417   acc: 77.64% -> 89.43%             
client [5] (test)  loss: 0.5102 -> 0.0491   acc: 84.50% -> 98.91%              
client [52] (test)  loss: 0.4477 -> 0.3153   acc: 86.05% -> 93.80%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.5172 -> 0.0000', 'accuracy': '83.51% -> 0.00%'},          
    200: {'loss': '0.4910 -> 0.0000', 'accuracy': '85.94% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(18.11%) at epoch: 1                                      
FedDyn achieved 40.0%(48.70%) at epoch: 2                                      
FedDyn achieved 60.0%(65.14%) at epoch: 4                                      
FedDyn achieved 80.0%(83.98%) at epoch: 9                                      
FedDyn achieved 90.0%(91.03%) at epoch: 61                                     
Convergence (test_after):                                                      
FedDyn achieved 90.0%(91.37%) at epoch: 0                                      
