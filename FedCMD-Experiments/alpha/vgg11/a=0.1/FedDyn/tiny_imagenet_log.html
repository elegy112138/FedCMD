==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5469 -> 2.6396   acc: 11.51% -> 35.91%             
client [81] (test)  loss: 4.8638 -> 2.6366   acc: 4.27% -> 40.21%              
client [21] (test)  loss: 5.1349 -> 3.0143   acc: 6.60% -> 34.60%              
client [68] (test)  loss: 5.1394 -> 2.7723   acc: 3.09% -> 34.15%              
client [93] (test)  loss: 5.3147 -> 2.7946   acc: 3.86% -> 37.87%              
client [31] (test)  loss: 5.7358 -> 2.0316   acc: 2.79% -> 54.18%              
client [20] (test)  loss: 4.6090 -> 3.1986   acc: 12.80% -> 29.07%             
client [59] (test)  loss: 4.9635 -> 2.5770   acc: 5.11% -> 38.03%              
client [48] (test)  loss: 4.7132 -> 2.2138   acc: 9.41% -> 51.64%              
client [34] (test)  loss: 4.9793 -> 3.3009   acc: 8.82% -> 33.64%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.7976 -> 2.8619   acc: 10.64% -> 34.04%             
client [99] (test)  loss: 4.5079 -> 3.2222   acc: 11.86% -> 34.36%             
client [67] (test)  loss: 4.2546 -> 2.3442   acc: 10.93% -> 43.92%             
client [0] (test)  loss: 4.5896 -> 2.6419   acc: 14.16% -> 35.48%              
client [76] (test)  loss: 4.6633 -> 2.3667   acc: 6.73% -> 44.00%              
client [41] (test)  loss: 4.3764 -> 2.3759   acc: 12.81% -> 41.46%             
client [62] (test)  loss: 5.1299 -> 2.6972   acc: 7.69% -> 37.61%              
client [2] (test)  loss: 5.4064 -> 2.3919   acc: 2.61% -> 43.91%               
client [14] (test)  loss: 4.2165 -> 1.9356   acc: 11.21% -> 52.49%             
client [46] (test)  loss: 3.7981 -> 2.3349   acc: 16.94% -> 44.14%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.6882 -> 2.3363   acc: 16.71% -> 48.77%             
client [68] (test)  loss: 3.9931 -> 2.2823   acc: 15.61% -> 44.72%             
client [57] (test)  loss: 4.0407 -> 2.3168   acc: 16.18% -> 47.45%             
client [17] (test)  loss: 4.3740 -> 1.9197   acc: 12.64% -> 54.98%             
client [54] (test)  loss: 4.1769 -> 2.3382   acc: 10.49% -> 47.84%             
client [23] (test)  loss: 3.9116 -> 1.8957   acc: 18.23% -> 53.98%             
client [35] (test)  loss: 4.7569 -> 2.2778   acc: 14.46% -> 43.57%             
client [59] (test)  loss: 3.7885 -> 2.1378   acc: 19.54% -> 45.07%             
client [31] (test)  loss: 3.5266 -> 1.6206   acc: 20.73% -> 60.63%             
client [9] (test)  loss: 3.6560 -> 2.5465   acc: 24.36% -> 45.82%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.9205 -> 1.9951   acc: 16.67% -> 51.98%             
client [33] (test)  loss: 3.5801 -> 2.1778   acc: 17.27% -> 45.91%             
client [16] (test)  loss: 3.7422 -> 2.0808   acc: 22.04% -> 51.91%             
client [44] (test)  loss: 3.6414 -> 2.0862   acc: 18.04% -> 49.60%             
client [8] (test)  loss: 4.1117 -> 1.9368   acc: 12.72% -> 52.78%              
client [31] (test)  loss: 4.1716 -> 1.5058   acc: 13.76% -> 63.59%             
client [47] (test)  loss: 4.3107 -> 1.5117   acc: 9.22% -> 60.40%              
client [36] (test)  loss: 3.7316 -> 1.8230   acc: 18.84% -> 53.80%             
client [20] (test)  loss: 3.8707 -> 2.4058   acc: 19.55% -> 42.73%             
client [56] (test)  loss: 4.1821 -> 2.4610   acc: 11.92% -> 43.24%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.2561 -> 2.5002   acc: 13.38% -> 42.68%              
client [60] (test)  loss: 3.8442 -> 2.0568   acc: 15.27% -> 51.82%             
client [28] (test)  loss: 3.4415 -> 2.2218   acc: 26.04% -> 49.37%             
client [25] (test)  loss: 3.4815 -> 2.1181   acc: 28.35% -> 50.43%             
client [58] (test)  loss: 3.5929 -> 2.1533   acc: 21.73% -> 48.59%             
client [44] (test)  loss: 3.4728 -> 1.9196   acc: 25.76% -> 52.82%             
client [39] (test)  loss: 3.6627 -> 2.4174   acc: 22.77% -> 40.26%             
client [29] (test)  loss: 3.2361 -> 1.8677   acc: 30.10% -> 53.40%             
client [3] (test)  loss: 3.5028 -> 1.8309   acc: 22.55% -> 53.27%              
client [84] (test)  loss: 3.6957 -> 2.2414   acc: 25.18% -> 49.65%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.1348 -> 2.2298   acc: 15.40% -> 49.20%             
client [84] (test)  loss: 3.6330 -> 2.1453   acc: 25.35% -> 55.32%             
client [10] (test)  loss: 3.5946 -> 1.9201   acc: 23.32% -> 53.54%             
client [36] (test)  loss: 3.5812 -> 1.7110   acc: 22.46% -> 56.70%             
client [65] (test)  loss: 3.5827 -> 2.1492   acc: 22.76% -> 46.77%             
client [81] (test)  loss: 3.8114 -> 1.8540   acc: 20.64% -> 51.78%             
client [79] (test)  loss: 4.1064 -> 2.3951   acc: 16.24% -> 44.23%             
client [42] (test)  loss: 3.6860 -> 2.1390   acc: 19.14% -> 49.37%             
client [11] (test)  loss: 3.5454 -> 2.0282   acc: 24.57% -> 49.65%             
client [96] (test)  loss: 3.6234 -> 1.5324   acc: 21.76% -> 59.71%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0698 -> 1.7569   acc: 18.28% -> 56.44%              
client [53] (test)  loss: 3.6949 -> 2.0392   acc: 19.38% -> 54.46%             
client [52] (test)  loss: 2.8572 -> 1.8470   acc: 36.17% -> 54.61%             
client [42] (test)  loss: 3.1819 -> 2.1769   acc: 29.34% -> 49.02%             
client [69] (test)  loss: 3.2971 -> 2.2091   acc: 30.05% -> 50.53%             
client [59] (test)  loss: 2.9986 -> 1.8025   acc: 32.22% -> 56.69%             
client [7] (test)  loss: 3.7852 -> 2.1113   acc: 22.80% -> 49.01%              
client [26] (test)  loss: 3.1483 -> 1.7267   acc: 30.02% -> 58.68%             
client [49] (test)  loss: 3.0626 -> 2.0223   acc: 30.94% -> 53.15%             
client [98] (test)  loss: 3.3198 -> 1.6148   acc: 26.28% -> 60.87%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.2810 -> 1.5761   acc: 28.17% -> 60.87%             
client [47] (test)  loss: 3.1994 -> 1.3171   acc: 26.04% -> 67.09%             
client [21] (test)  loss: 3.9121 -> 2.1664   acc: 20.20% -> 51.00%             
client [77] (test)  loss: 3.4508 -> 1.9239   acc: 25.26% -> 55.67%             
client [95] (test)  loss: 3.1289 -> 1.8845   acc: 30.11% -> 56.84%             
client [91] (test)  loss: 3.1070 -> 1.5643   acc: 27.75% -> 58.71%             
client [14] (test)  loss: 2.7058 -> 1.5640   acc: 37.37% -> 62.99%             
client [99] (test)  loss: 3.4424 -> 2.5197   acc: 28.63% -> 44.17%             
client [20] (test)  loss: 2.9974 -> 1.6696   acc: 33.39% -> 56.92%             
client [39] (test)  loss: 3.8589 -> 2.2758   acc: 24.09% -> 45.21%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.8568 -> 1.7805   acc: 36.88% -> 56.91%             
client [62] (test)  loss: 3.5643 -> 2.0924   acc: 23.25% -> 51.62%             
client [71] (test)  loss: 3.0128 -> 2.1020   acc: 32.85% -> 50.97%             
client [97] (test)  loss: 3.3062 -> 1.9718   acc: 26.72% -> 52.86%             
client [30] (test)  loss: 2.7854 -> 2.2472   acc: 37.35% -> 52.20%             
client [88] (test)  loss: 3.1892 -> 1.9218   acc: 33.11% -> 55.46%             
client [60] (test)  loss: 3.7965 -> 1.9142   acc: 23.09% -> 56.91%             
client [82] (test)  loss: 3.3268 -> 1.9065   acc: 25.81% -> 56.49%             
client [91] (test)  loss: 2.7367 -> 1.5170   acc: 38.24% -> 60.07%             
client [57] (test)  loss: 3.0322 -> 2.0267   acc: 32.36% -> 54.55%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.9971 -> 1.3518   acc: 31.53% -> 69.69%             
client [15] (test)  loss: 2.8433 -> 1.7976   acc: 36.19% -> 58.92%             
client [71] (test)  loss: 3.5585 -> 2.0904   acc: 23.43% -> 52.17%             
client [97] (test)  loss: 3.2256 -> 1.9619   acc: 28.63% -> 54.01%             
client [53] (test)  loss: 3.5925 -> 2.0497   acc: 22.48% -> 56.40%             
client [77] (test)  loss: 3.2047 -> 1.7677   acc: 30.24% -> 58.25%             
client [76] (test)  loss: 3.0059 -> 1.7426   acc: 32.18% -> 58.36%             
client [79] (test)  loss: 3.8307 -> 2.2960   acc: 19.44% -> 47.01%             
client [28] (test)  loss: 3.5032 -> 2.2043   acc: 27.67% -> 50.45%             
client [99] (test)  loss: 3.3593 -> 2.4446   acc: 29.24% -> 46.01%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.2294 -> 1.9118   acc: 30.15% -> 54.01%             
client [86] (test)  loss: 2.6926 -> 1.7905   acc: 40.39% -> 59.29%             
client [34] (test)  loss: 3.5326 -> 2.4204   acc: 24.59% -> 50.35%             
client [73] (test)  loss: 2.8647 -> 1.7441   acc: 37.20% -> 58.51%             
client [5] (test)  loss: 3.1696 -> 1.7267   acc: 30.27% -> 59.28%              
client [96] (test)  loss: 3.1633 -> 1.4239   acc: 29.68% -> 64.57%             
client [22] (test)  loss: 2.6846 -> 1.7931   acc: 39.25% -> 60.36%             
client [60] (test)  loss: 3.6379 -> 1.8385   acc: 26.18% -> 58.73%             
client [66] (test)  loss: 3.3490 -> 2.0410   acc: 26.92% -> 49.55%             
client [83] (test)  loss: 3.2022 -> 2.0935   acc: 31.69% -> 50.47%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.0041 -> 1.6532   acc: 34.91% -> 60.73%             
client [65] (test)  loss: 3.0206 -> 1.9670   acc: 33.15% -> 53.94%             
client [95] (test)  loss: 2.9479 -> 1.8733   acc: 34.11% -> 58.11%             
client [17] (test)  loss: 2.9442 -> 1.5534   acc: 34.44% -> 62.72%             
client [8] (test)  loss: 3.5531 -> 1.6253   acc: 24.96% -> 62.80%              
client [35] (test)  loss: 3.5825 -> 2.0095   acc: 26.31% -> 54.82%             
client [98] (test)  loss: 3.3852 -> 1.5437   acc: 26.09% -> 61.63%             
client [53] (test)  loss: 3.1123 -> 2.0332   acc: 33.53% -> 57.75%             
client [43] (test)  loss: 3.0998 -> 1.9290   acc: 30.19% -> 53.83%             
client [64] (test)  loss: 3.2498 -> 1.6583   acc: 26.90% -> 62.71%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.6917 -> 2.0906   acc: 25.60% -> 53.60%             
client [88] (test)  loss: 3.3602 -> 1.8591   acc: 30.20% -> 58.87%             
client [38] (test)  loss: 3.3934 -> 2.0783   acc: 28.22% -> 52.96%             
client [3] (test)  loss: 3.4334 -> 1.5881   acc: 29.90% -> 62.75%              
client [5] (test)  loss: 3.3636 -> 1.7420   acc: 26.67% -> 58.92%              
client [41] (test)  loss: 3.5465 -> 1.6509   acc: 26.69% -> 58.01%             
client [7] (test)  loss: 3.6068 -> 2.0031   acc: 28.01% -> 54.40%              
client [37] (test)  loss: 3.5809 -> 1.8263   acc: 23.38% -> 56.98%             
client [45] (test)  loss: 3.2382 -> 1.9964   acc: 31.85% -> 53.14%             
client [47] (test)  loss: 3.2424 -> 1.2178   acc: 28.03% -> 69.26%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.8795 -> 1.7587   acc: 37.34% -> 60.66%             
client [11] (test)  loss: 3.2491 -> 1.8828   acc: 34.08% -> 55.19%             
client [37] (test)  loss: 3.5979 -> 1.8081   acc: 24.19% -> 56.98%             
client [41] (test)  loss: 3.4421 -> 1.6572   acc: 26.87% -> 58.54%             
client [95] (test)  loss: 3.0015 -> 1.9886   acc: 34.95% -> 56.84%             
client [53] (test)  loss: 3.5211 -> 1.9907   acc: 27.52% -> 59.11%             
client [22] (test)  loss: 2.6316 -> 1.8001   acc: 37.87% -> 61.93%             
client [25] (test)  loss: 3.1890 -> 2.0084   acc: 35.83% -> 53.74%             
client [69] (test)  loss: 3.3372 -> 2.1775   acc: 33.51% -> 51.06%             
client [46] (test)  loss: 2.3933 -> 1.6211   acc: 43.42% -> 63.24%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.5748 -> 1.2163   acc: 39.96% -> 70.89%             
client [69] (test)  loss: 3.2792 -> 2.1746   acc: 33.24% -> 51.06%             
client [82] (test)  loss: 3.2306 -> 1.8121   acc: 29.06% -> 59.09%             
client [45] (test)  loss: 3.0893 -> 1.9221   acc: 37.12% -> 54.77%             
client [7] (test)  loss: 3.9031 -> 1.9997   acc: 24.42% -> 55.12%              
client [50] (test)  loss: 2.8766 -> 1.6738   acc: 35.75% -> 58.89%             
client [35] (test)  loss: 3.3244 -> 1.9296   acc: 32.33% -> 56.22%             
client [24] (test)  loss: 3.2212 -> 1.9010   acc: 32.05% -> 58.36%             
client [15] (test)  loss: 2.8668 -> 1.9194   acc: 37.59% -> 59.09%             
client [58] (test)  loss: 3.4614 -> 2.1087   acc: 28.09% -> 52.65%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.9972 -> 1.4080   acc: 36.11% -> 70.02%             
client [76] (test)  loss: 3.0096 -> 1.6875   acc: 35.82% -> 59.82%             
client [67] (test)  loss: 3.0156 -> 1.7081   acc: 35.80% -> 61.20%             
client [37] (test)  loss: 3.5642 -> 1.8208   acc: 25.32% -> 58.93%             
client [58] (test)  loss: 3.1003 -> 2.0751   acc: 33.04% -> 54.59%             
client [64] (test)  loss: 3.1227 -> 1.7411   acc: 32.51% -> 64.19%             
client [77] (test)  loss: 3.0954 -> 1.7461   acc: 35.74% -> 60.31%             
client [55] (test)  loss: 2.8795 -> 1.7226   acc: 37.59% -> 60.77%             
client [12] (test)  loss: 3.1320 -> 1.7551   acc: 32.42% -> 62.08%             
client [89] (test)  loss: 3.2139 -> 1.9416   acc: 28.93% -> 56.42%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.1750 -> 2.0052   acc: 37.06% -> 59.22%             
client [51] (test)  loss: 3.2148 -> 1.6349   acc: 34.73% -> 64.18%             
client [8] (test)  loss: 3.8999 -> 1.6365   acc: 25.60% -> 65.50%              
client [18] (test)  loss: 2.9693 -> 2.1268   acc: 36.85% -> 58.50%             
client [94] (test)  loss: 3.0453 -> 1.8718   acc: 32.60% -> 62.30%             
client [81] (test)  loss: 3.3485 -> 1.8010   acc: 32.92% -> 58.19%             
client [3] (test)  loss: 3.2737 -> 1.7260   acc: 32.84% -> 61.93%              
client [11] (test)  loss: 3.3806 -> 1.9434   acc: 34.26% -> 56.92%             
client [95] (test)  loss: 2.9518 -> 1.9071   acc: 36.00% -> 60.21%             
client [67] (test)  loss: 3.0338 -> 1.7565   acc: 35.45% -> 62.61%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.4805 -> 2.1621   acc: 31.60% -> 55.40%             
client [79] (test)  loss: 4.0548 -> 2.4985   acc: 24.36% -> 47.86%             
client [58] (test)  loss: 3.1729 -> 2.1254   acc: 35.69% -> 56.71%             
client [88] (test)  loss: 3.1790 -> 1.9047   acc: 33.79% -> 61.26%             
client [46] (test)  loss: 2.5937 -> 1.6414   acc: 40.90% -> 63.42%             
client [11] (test)  loss: 3.2526 -> 1.9548   acc: 35.47% -> 57.79%             
client [55] (test)  loss: 2.6510 -> 1.7657   acc: 44.89% -> 61.68%             
client [13] (test)  loss: 3.0202 -> 2.0946   acc: 37.54% -> 58.36%             
client [31] (test)  loss: 3.3182 -> 1.4311   acc: 31.88% -> 68.99%             
client [75] (test)  loss: 3.2962 -> 1.7659   acc: 35.30% -> 61.74%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.1101 -> 2.0124   acc: 35.79% -> 58.99%             
client [7] (test)  loss: 3.8472 -> 2.1637   acc: 25.31% -> 55.12%              
client [57] (test)  loss: 2.9895 -> 2.0973   acc: 39.09% -> 57.45%             
client [13] (test)  loss: 3.2229 -> 2.1613   acc: 34.64% -> 58.19%             
client [43] (test)  loss: 3.1386 -> 2.0660   acc: 34.66% -> 56.07%             
client [91] (test)  loss: 2.7394 -> 1.5100   acc: 40.61% -> 63.62%             
client [10] (test)  loss: 3.0868 -> 1.8295   acc: 38.81% -> 59.51%             
client [64] (test)  loss: 2.7660 -> 2.1666   acc: 40.59% -> 60.56%             
client [82] (test)  loss: 2.8110 -> 1.9292   acc: 37.01% -> 60.23%             
client [22] (test)  loss: 2.5294 -> 1.8606   acc: 45.56% -> 61.74%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.0334 -> 1.6366   acc: 38.06% -> 60.21%             
client [23] (test)  loss: 2.8440 -> 1.8116   acc: 43.36% -> 63.19%             
client [88] (test)  loss: 3.3203 -> 1.9207   acc: 33.28% -> 60.41%             
client [98] (test)  loss: 2.7264 -> 1.7173   acc: 40.64% -> 63.52%             
client [79] (test)  loss: 3.7799 -> 2.6204   acc: 28.42% -> 47.44%             
client [21] (test)  loss: 3.8290 -> 2.0907   acc: 26.20% -> 58.00%             
client [92] (test)  loss: 3.2887 -> 1.8189   acc: 32.35% -> 59.86%             
client [56] (test)  loss: 3.2176 -> 2.3201   acc: 38.43% -> 53.02%             
client [5] (test)  loss: 3.0599 -> 1.9764   acc: 35.50% -> 59.28%              
client [52] (test)  loss: 2.9552 -> 1.9648   acc: 40.78% -> 59.75%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.1901 -> 0.0000', 'accuracy': '29.87% -> 0.00%'},          
    200: {'loss': '3.2996 -> 0.0000', 'accuracy': '34.93% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(10.07%) at epoch: 16                                     
FedDyn achieved 20.0%(20.23%) at epoch: 38                                     
FedDyn achieved 30.0%(30.50%) at epoch: 86                                     
Convergence (test_after):                                                      
FedDyn achieved 10.0%(17.69%) at epoch: 0                                      
FedDyn achieved 30.0%(32.93%) at epoch: 2                                      
FedDyn achieved 40.0%(40.39%) at epoch: 7                                      
FedDyn achieved 50.0%(51.22%) at epoch: 35                                     
FedDyn achieved 60.0%(61.33%) at epoch: 143                                    
