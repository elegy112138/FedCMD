==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.7567 -> 2.1107   acc: 2.19% -> 47.02%              
client [81] (test)  loss: 4.8769 -> 2.5769   acc: 4.11% -> 40.51%              
client [21] (test)  loss: 5.3110 -> 2.7306   acc: 4.61% -> 32.28%              
client [68] (test)  loss: 4.8371 -> 2.1881   acc: 4.15% -> 38.66%              
client [93] (test)  loss: 5.2012 -> 3.3524   acc: 1.02% -> 23.47%              
client [31] (test)  loss: 5.0653 -> 2.3908   acc: 1.93% -> 37.94%              
client [20] (test)  loss: 4.7702 -> 1.3748   acc: 3.95% -> 60.20%              
client [59] (test)  loss: 4.5170 -> 2.4745   acc: 7.42% -> 43.87%              
client [48] (test)  loss: 4.9489 -> 3.1077   acc: 4.25% -> 23.86%              
client [34] (test)  loss: 4.1315 -> 2.5493   acc: 8.28% -> 34.44%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.4958 -> 1.3995   acc: 20.11% -> 67.99%             
client [99] (test)  loss: 4.5083 -> 3.2073   acc: 7.01% -> 28.66%              
client [67] (test)  loss: 5.0163 -> 2.3054   acc: 7.52% -> 40.13%              
client [0] (test)  loss: 4.0255 -> 2.6858   acc: 13.96% -> 38.29%              
client [76] (test)  loss: 4.8131 -> 2.4692   acc: 3.32% -> 35.22%              
client [41] (test)  loss: 4.8118 -> 2.6076   acc: 5.00% -> 37.67%              
client [62] (test)  loss: 4.7611 -> 2.6167   acc: 3.93% -> 33.11%              
client [2] (test)  loss: 4.3995 -> 2.6824   acc: 7.31% -> 29.23%               
client [14] (test)  loss: 4.5663 -> 2.7829   acc: 11.18% -> 43.53%             
client [46] (test)  loss: 4.8721 -> 2.4776   acc: 5.20% -> 44.40%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.7848 -> 2.4077   acc: 14.07% -> 38.02%             
client [68] (test)  loss: 4.0666 -> 1.7777   acc: 11.50% -> 54.31%             
client [57] (test)  loss: 4.0724 -> 2.4134   acc: 8.58% -> 42.24%              
client [17] (test)  loss: 4.5922 -> 2.3571   acc: 6.35% -> 41.59%              
client [54] (test)  loss: 5.0482 -> 2.2238   acc: 9.78% -> 44.84%              
client [23] (test)  loss: 4.0376 -> 2.5653   acc: 16.02% -> 31.64%             
client [35] (test)  loss: 4.7208 -> 2.2541   acc: 3.33% -> 37.33%              
client [59] (test)  loss: 3.4246 -> 2.0680   acc: 19.35% -> 49.03%             
client [31] (test)  loss: 3.5064 -> 2.2490   acc: 16.40% -> 42.12%             
client [9] (test)  loss: 4.0385 -> 2.2561   acc: 11.18% -> 41.99%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.1688 -> 2.4725   acc: 5.88% -> 41.74%              
client [33] (test)  loss: 3.8950 -> 2.6579   acc: 13.81% -> 42.54%             
client [16] (test)  loss: 3.8231 -> 2.1224   acc: 14.93% -> 40.00%             
client [44] (test)  loss: 3.9274 -> 2.4087   acc: 8.82% -> 30.72%              
client [8] (test)  loss: 3.8713 -> 2.2113   acc: 13.78% -> 41.99%              
client [31] (test)  loss: 3.8684 -> 2.0263   acc: 10.93% -> 45.34%             
client [47] (test)  loss: 4.7407 -> 2.7150   acc: 12.41% -> 33.46%             
client [36] (test)  loss: 4.0541 -> 2.6852   acc: 12.15% -> 36.81%             
client [20] (test)  loss: 4.5527 -> 1.1743   acc: 10.86% -> 66.12%             
client [56] (test)  loss: 3.5779 -> 2.1348   acc: 22.28% -> 50.00%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.8556 -> 1.7016   acc: 14.97% -> 56.37%              
client [60] (test)  loss: 4.4800 -> 2.5980   acc: 9.62% -> 43.59%              
client [28] (test)  loss: 3.9134 -> 2.2536   acc: 14.29% -> 47.04%             
client [25] (test)  loss: 4.2862 -> 1.9664   acc: 11.81% -> 51.48%             
client [58] (test)  loss: 4.1716 -> 2.2103   acc: 12.97% -> 41.14%             
client [44] (test)  loss: 3.7883 -> 2.3562   acc: 12.75% -> 30.72%             
client [39] (test)  loss: 3.6648 -> 2.2791   acc: 16.18% -> 41.42%             
client [29] (test)  loss: 4.2127 -> 2.0733   acc: 6.00% -> 45.43%              
client [3] (test)  loss: 3.3623 -> 2.1468   acc: 24.46% -> 46.18%              
client [84] (test)  loss: 3.4300 -> 2.3784   acc: 20.81% -> 40.37%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.8867 -> 2.1250   acc: 13.26% -> 44.67%             
client [84] (test)  loss: 3.4169 -> 2.2568   acc: 19.57% -> 45.34%             
client [10] (test)  loss: 3.4084 -> 2.0364   acc: 17.46% -> 47.22%             
client [36] (test)  loss: 4.1093 -> 2.5925   acc: 14.58% -> 40.62%             
client [65] (test)  loss: 3.7432 -> 2.8986   acc: 14.98% -> 34.41%             
client [81] (test)  loss: 3.6307 -> 2.0706   acc: 19.94% -> 49.68%             
client [79] (test)  loss: 3.3636 -> 1.3857   acc: 20.62% -> 63.84%             
client [42] (test)  loss: 3.4062 -> 2.1585   acc: 24.43% -> 43.65%             
client [11] (test)  loss: 3.6149 -> 2.3244   acc: 16.56% -> 46.32%             
client [96] (test)  loss: 3.9680 -> 1.8212   acc: 14.55% -> 49.54%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.3689 -> 2.0695   acc: 23.08% -> 50.32%              
client [53] (test)  loss: 3.5066 -> 1.8432   acc: 24.85% -> 54.49%             
client [52] (test)  loss: 4.0050 -> 2.1550   acc: 10.30% -> 50.50%             
client [42] (test)  loss: 3.2830 -> 2.0280   acc: 26.06% -> 46.25%             
client [69] (test)  loss: 2.4967 -> 1.1987   acc: 38.53% -> 70.82%             
client [59] (test)  loss: 3.2960 -> 1.8255   acc: 23.23% -> 56.13%             
client [7] (test)  loss: 3.4351 -> 1.7847   acc: 20.39% -> 51.78%              
client [26] (test)  loss: 3.7951 -> 2.4934   acc: 14.62% -> 38.85%             
client [49] (test)  loss: 2.8332 -> 1.6236   acc: 31.03% -> 58.33%             
client [98] (test)  loss: 3.5306 -> 2.6300   acc: 18.75% -> 40.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.3032 -> 2.5587   acc: 20.00% -> 40.94%             
client [47] (test)  loss: 4.4608 -> 2.4506   acc: 10.90% -> 38.35%             
client [21] (test)  loss: 3.4438 -> 2.0324   acc: 18.73% -> 42.94%             
client [77] (test)  loss: 3.9946 -> 1.5979   acc: 13.79% -> 60.19%             
client [95] (test)  loss: 3.4424 -> 2.1085   acc: 20.79% -> 54.13%             
client [91] (test)  loss: 3.5897 -> 1.9676   acc: 18.65% -> 48.55%             
client [14] (test)  loss: 3.0423 -> 2.4194   acc: 27.06% -> 49.41%             
client [99] (test)  loss: 3.6736 -> 2.7271   acc: 16.24% -> 42.99%             
client [20] (test)  loss: 3.3404 -> 1.1158   acc: 23.68% -> 67.43%             
client [39] (test)  loss: 3.2248 -> 2.0712   acc: 22.65% -> 45.63%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.4516 -> 2.0280   acc: 19.93% -> 51.50%             
client [62] (test)  loss: 3.3408 -> 2.5138   acc: 18.36% -> 38.03%             
client [71] (test)  loss: 3.6482 -> 2.5888   acc: 25.97% -> 38.96%             
client [97] (test)  loss: 3.5154 -> 2.4057   acc: 25.43% -> 39.22%             
client [30] (test)  loss: 3.1111 -> 2.3762   acc: 30.06% -> 42.41%             
client [88] (test)  loss: 3.6651 -> 2.0052   acc: 18.54% -> 50.33%             
client [60] (test)  loss: 4.1203 -> 2.6190   acc: 8.97% -> 46.79%              
client [82] (test)  loss: 3.7360 -> 2.4231   acc: 20.42% -> 48.79%             
client [91] (test)  loss: 3.2838 -> 1.9452   acc: 20.26% -> 50.48%             
client [57] (test)  loss: 3.0413 -> 1.9894   acc: 30.69% -> 53.14%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.9668 -> 1.7441   acc: 26.69% -> 54.66%             
client [15] (test)  loss: 3.8013 -> 2.0595   acc: 18.04% -> 49.68%             
client [71] (test)  loss: 3.7027 -> 2.5281   acc: 19.81% -> 40.91%             
client [97] (test)  loss: 3.4309 -> 2.3809   acc: 21.98% -> 38.79%             
client [53] (test)  loss: 3.1309 -> 1.7948   acc: 25.15% -> 58.08%             
client [77] (test)  loss: 3.4515 -> 1.7135   acc: 20.69% -> 59.87%             
client [76] (test)  loss: 3.6753 -> 2.2896   acc: 14.95% -> 42.86%             
client [79] (test)  loss: 3.2186 -> 1.1242   acc: 18.64% -> 69.77%             
client [28] (test)  loss: 3.4052 -> 2.0470   acc: 22.30% -> 49.48%             
client [99] (test)  loss: 3.6083 -> 2.6874   acc: 17.20% -> 42.04%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.0352 -> 2.3035   acc: 30.17% -> 43.53%             
client [86] (test)  loss: 3.2417 -> 1.7019   acc: 25.67% -> 57.01%             
client [34] (test)  loss: 3.0052 -> 1.7993   acc: 29.80% -> 54.30%             
client [73] (test)  loss: 3.1769 -> 2.2443   acc: 29.33% -> 44.33%             
client [5] (test)  loss: 3.1186 -> 1.6915   acc: 24.28% -> 53.67%              
client [96] (test)  loss: 3.9299 -> 1.9156   acc: 15.48% -> 51.70%             
client [22] (test)  loss: 3.5146 -> 2.4727   acc: 19.63% -> 41.74%             
client [60] (test)  loss: 3.7853 -> 2.5412   acc: 16.67% -> 46.15%             
client [66] (test)  loss: 3.5576 -> 1.8723   acc: 16.50% -> 52.75%             
client [83] (test)  loss: 4.1439 -> 1.8552   acc: 12.25% -> 53.64%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.5131 -> 2.5661   acc: 15.95% -> 42.52%             
client [65] (test)  loss: 3.8256 -> 2.3124   acc: 18.22% -> 46.15%             
client [95] (test)  loss: 2.8680 -> 1.9314   acc: 30.36% -> 57.43%             
client [17] (test)  loss: 3.8527 -> 2.0939   acc: 20.00% -> 46.98%             
client [8] (test)  loss: 3.1282 -> 2.0150   acc: 27.88% -> 55.13%              
client [35] (test)  loss: 3.7235 -> 2.0068   acc: 13.33% -> 47.67%             
client [98] (test)  loss: 3.4557 -> 2.5112   acc: 22.50% -> 45.00%             
client [53] (test)  loss: 2.8770 -> 1.7532   acc: 34.73% -> 58.38%             
client [43] (test)  loss: 4.0617 -> 2.1418   acc: 13.33% -> 50.00%             
client [64] (test)  loss: 3.7021 -> 1.7759   acc: 14.29% -> 53.78%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.2882 -> 2.1265   acc: 24.78% -> 47.55%             
client [88] (test)  loss: 3.3938 -> 1.9285   acc: 26.49% -> 55.30%             
client [38] (test)  loss: 3.5122 -> 2.0584   acc: 17.85% -> 51.56%             
client [3] (test)  loss: 3.5202 -> 1.9435   acc: 23.55% -> 54.13%              
client [5] (test)  loss: 3.5138 -> 1.7482   acc: 23.96% -> 53.99%              
client [41] (test)  loss: 3.9638 -> 2.0389   acc: 18.00% -> 46.33%             
client [7] (test)  loss: 3.0633 -> 1.5058   acc: 25.24% -> 60.19%              
client [37] (test)  loss: 4.2310 -> 1.9884   acc: 18.01% -> 51.13%             
client [45] (test)  loss: 3.8651 -> 1.6696   acc: 14.00% -> 54.33%             
client [47] (test)  loss: 4.2230 -> 2.2697   acc: 14.66% -> 44.36%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.2071 -> 2.0888   acc: 25.35% -> 49.86%             
client [11] (test)  loss: 3.4117 -> 2.1825   acc: 25.15% -> 57.06%             
client [37] (test)  loss: 3.8891 -> 1.9934   acc: 18.65% -> 54.34%             
client [41] (test)  loss: 3.5865 -> 1.9658   acc: 20.33% -> 48.67%             
client [95] (test)  loss: 3.4486 -> 1.9022   acc: 24.42% -> 58.42%             
client [53] (test)  loss: 3.0470 -> 1.6531   acc: 32.93% -> 58.98%             
client [22] (test)  loss: 3.1557 -> 2.3709   acc: 25.23% -> 43.30%             
client [25] (test)  loss: 3.4975 -> 1.8091   acc: 26.16% -> 58.65%             
client [69] (test)  loss: 3.3012 -> 0.9610   acc: 24.93% -> 76.49%             
client [46] (test)  loss: 3.0325 -> 1.9840   acc: 26.40% -> 60.80%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.8962 -> 2.2417   acc: 19.55% -> 45.86%             
client [69] (test)  loss: 2.8383 -> 0.9797   acc: 37.39% -> 75.07%             
client [82] (test)  loss: 3.8894 -> 2.4228   acc: 18.34% -> 49.83%             
client [45] (test)  loss: 3.6324 -> 1.7089   acc: 19.33% -> 53.67%             
client [7] (test)  loss: 2.9392 -> 1.4762   acc: 25.57% -> 60.84%              
client [50] (test)  loss: 4.7791 -> 1.7454   acc: 10.39% -> 61.29%             
client [35] (test)  loss: 3.4423 -> 1.9254   acc: 24.33% -> 52.00%             
client [24] (test)  loss: 2.9451 -> 1.8961   acc: 33.46% -> 52.85%             
client [15] (test)  loss: 3.7124 -> 2.0330   acc: 19.94% -> 51.58%             
client [58] (test)  loss: 3.7946 -> 1.9222   acc: 22.15% -> 48.42%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.4999 -> 2.2459   acc: 21.24% -> 40.20%             
client [76] (test)  loss: 3.2346 -> 2.4358   acc: 23.92% -> 43.52%             
client [67] (test)  loss: 4.0403 -> 1.7905   acc: 21.32% -> 56.11%             
client [37] (test)  loss: 4.2514 -> 2.1077   acc: 17.36% -> 49.52%             
client [58] (test)  loss: 3.6429 -> 1.9434   acc: 21.84% -> 49.68%             
client [64] (test)  loss: 3.5976 -> 1.7057   acc: 20.73% -> 56.86%             
client [77] (test)  loss: 3.2131 -> 1.5537   acc: 24.76% -> 66.46%             
client [55] (test)  loss: 2.6138 -> 1.5361   acc: 38.82% -> 67.08%             
client [12] (test)  loss: 2.8652 -> 1.9065   acc: 33.55% -> 60.86%             
client [89] (test)  loss: 3.2721 -> 2.1832   acc: 25.99% -> 48.01%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.8537 -> 2.1825   acc: 35.09% -> 49.69%             
client [51] (test)  loss: 3.4529 -> 2.1888   acc: 24.51% -> 51.31%             
client [8] (test)  loss: 2.8673 -> 2.0221   acc: 34.62% -> 60.90%              
client [18] (test)  loss: 3.2168 -> 1.5381   acc: 27.08% -> 62.50%             
client [94] (test)  loss: 3.5629 -> 2.0205   acc: 19.55% -> 56.73%             
client [81] (test)  loss: 3.2144 -> 1.7979   acc: 36.08% -> 60.76%             
client [3] (test)  loss: 2.9422 -> 1.6148   acc: 32.42% -> 60.24%              
client [11] (test)  loss: 3.3486 -> 2.7551   acc: 27.91% -> 52.45%             
client [95] (test)  loss: 3.2657 -> 1.8531   acc: 22.11% -> 59.41%             
client [67] (test)  loss: 3.5473 -> 1.6946   acc: 25.39% -> 57.68%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.2427 -> 1.9217   acc: 25.36% -> 50.14%             
client [79] (test)  loss: 2.9571 -> 1.4723   acc: 28.81% -> 69.77%             
client [58] (test)  loss: 3.2159 -> 1.9300   acc: 28.48% -> 48.42%             
client [88] (test)  loss: 3.2086 -> 1.8434   acc: 30.46% -> 56.95%             
client [46] (test)  loss: 3.1098 -> 1.7057   acc: 28.40% -> 60.00%             
client [11] (test)  loss: 3.2210 -> 2.1779   acc: 30.67% -> 58.28%             
client [55] (test)  loss: 2.5215 -> 1.5412   acc: 44.72% -> 66.46%             
client [13] (test)  loss: 3.0451 -> 2.1364   acc: 31.61% -> 53.80%             
client [31] (test)  loss: 2.9982 -> 1.5309   acc: 32.15% -> 62.70%             
client [75] (test)  loss: 2.5798 -> 1.6356   acc: 39.87% -> 64.45%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.9549 -> 2.2439   acc: 29.97% -> 41.04%             
client [7] (test)  loss: 2.8746 -> 1.5156   acc: 34.63% -> 63.43%              
client [57] (test)  loss: 2.5162 -> 2.0797   acc: 41.91% -> 57.10%             
client [13] (test)  loss: 3.3294 -> 2.0350   acc: 24.92% -> 55.62%             
client [43] (test)  loss: 3.7737 -> 2.1163   acc: 18.48% -> 48.79%             
client [91] (test)  loss: 3.4777 -> 1.7396   acc: 24.12% -> 60.45%             
client [10] (test)  loss: 3.2535 -> 1.8886   acc: 25.79% -> 55.56%             
client [64] (test)  loss: 3.0539 -> 1.7288   acc: 24.93% -> 55.46%             
client [82] (test)  loss: 3.6267 -> 2.4912   acc: 24.57% -> 49.13%             
client [22] (test)  loss: 3.1952 -> 2.1336   acc: 28.04% -> 47.66%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.4505 -> 0.9611   acc: 29.93% -> 79.28%             
client [23] (test)  loss: 3.4633 -> 2.2156   acc: 25.78% -> 53.52%             
client [88] (test)  loss: 3.2526 -> 1.6983   acc: 26.49% -> 59.60%             
client [98] (test)  loss: 2.9961 -> 2.5834   acc: 34.38% -> 48.44%             
client [79] (test)  loss: 2.2683 -> 1.3459   acc: 44.92% -> 70.34%             
client [21] (test)  loss: 3.7827 -> 1.9740   acc: 20.46% -> 51.59%             
client [92] (test)  loss: 3.3469 -> 2.2560   acc: 29.29% -> 49.79%             
client [56] (test)  loss: 3.0864 -> 1.6604   acc: 32.18% -> 61.88%             
client [5] (test)  loss: 3.5688 -> 1.8130   acc: 25.88% -> 55.59%              
client [52] (test)  loss: 3.0349 -> 2.1341   acc: 34.55% -> 55.48%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.4208 -> 0.0000', 'accuracy': '21.65% -> 0.00%'},          
    200: {'loss': '3.3461 -> 0.0000', 'accuracy': '27.31% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(11.40%) at epoch: 22                                     
FedDyn achieved 20.0%(20.19%) at epoch: 65                                     
FedDyn achieved 30.0%(32.01%) at epoch: 179                                    
Convergence (test_after):                                                      
FedDyn achieved 20.0%(29.75%) at epoch: 0                                      
FedDyn achieved 30.0%(35.63%) at epoch: 1                                      
FedDyn achieved 40.0%(46.68%) at epoch: 14                                     
FedDyn achieved 50.0%(50.22%) at epoch: 54                                     
FedDyn achieved 60.0%(60.72%) at epoch: 190                                    
