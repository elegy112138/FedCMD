==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.8468 -> 2.0428   acc: 22.68% -> 53.26%             
client [81] (test)  loss: 4.2617 -> 2.1235   acc: 15.66% -> 54.09%             
client [21] (test)  loss: 4.9208 -> 2.4703   acc: 11.60% -> 51.00%             
client [68] (test)  loss: 4.8035 -> 2.2859   acc: 12.36% -> 50.73%             
client [93] (test)  loss: 4.2786 -> 2.3062   acc: 13.05% -> 52.57%             
client [31] (test)  loss: 4.9808 -> 1.4757   acc: 8.54% -> 67.77%              
client [20] (test)  loss: 3.8055 -> 1.9650   acc: 26.12% -> 54.84%             
client [59] (test)  loss: 4.2082 -> 2.0850   acc: 15.49% -> 52.46%             
client [48] (test)  loss: 3.9251 -> 1.6748   acc: 19.69% -> 64.99%             
client [34] (test)  loss: 4.4230 -> 2.6137   acc: 13.69% -> 49.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.2727 -> 2.6294   acc: 19.95% -> 47.34%             
client [99] (test)  loss: 3.8124 -> 2.8837   acc: 26.58% -> 48.47%             
client [67] (test)  loss: 3.6482 -> 1.9734   acc: 24.16% -> 60.14%             
client [0] (test)  loss: 3.9926 -> 2.1801   acc: 25.81% -> 54.12%              
client [76] (test)  loss: 3.9428 -> 2.0992   acc: 24.36% -> 53.27%             
client [41] (test)  loss: 3.7563 -> 1.8636   acc: 22.06% -> 57.65%             
client [62] (test)  loss: 4.9744 -> 2.4181   acc: 13.85% -> 50.77%             
client [2] (test)  loss: 5.1035 -> 1.9857   acc: 11.52% -> 58.48%              
client [14] (test)  loss: 3.6385 -> 1.7140   acc: 23.84% -> 62.10%             
client [46] (test)  loss: 2.9697 -> 1.8305   acc: 32.43% -> 60.54%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4921 -> 2.1492   acc: 29.32% -> 57.53%             
client [68] (test)  loss: 3.7993 -> 2.1455   acc: 28.78% -> 56.10%             
client [57] (test)  loss: 3.6948 -> 2.1911   acc: 29.45% -> 53.09%             
client [17] (test)  loss: 3.9084 -> 1.6081   acc: 25.28% -> 64.14%             
client [54] (test)  loss: 3.7288 -> 1.9904   acc: 23.30% -> 57.72%             
client [23] (test)  loss: 3.4498 -> 1.5242   acc: 32.39% -> 63.19%             
client [35] (test)  loss: 4.5003 -> 1.8130   acc: 22.49% -> 60.44%             
client [59] (test)  loss: 3.3591 -> 1.9164   acc: 33.98% -> 61.44%             
client [31] (test)  loss: 2.9776 -> 1.3583   acc: 35.37% -> 71.95%             
client [9] (test)  loss: 3.3271 -> 2.1380   acc: 35.09% -> 56.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5868 -> 1.6500   acc: 28.22% -> 66.17%             
client [33] (test)  loss: 3.3564 -> 2.1602   acc: 30.68% -> 54.32%             
client [16] (test)  loss: 3.3274 -> 1.9046   acc: 34.24% -> 59.56%             
client [44] (test)  loss: 3.0352 -> 1.8397   acc: 37.20% -> 61.35%             
client [8] (test)  loss: 3.8764 -> 1.7961   acc: 27.98% -> 64.71%              
client [31] (test)  loss: 3.9000 -> 1.3244   acc: 26.13% -> 72.82%             
client [47] (test)  loss: 3.7478 -> 1.2926   acc: 26.22% -> 68.35%             
client [36] (test)  loss: 3.3261 -> 1.5813   acc: 31.88% -> 63.41%             
client [20] (test)  loss: 3.2485 -> 1.6883   acc: 36.51% -> 61.94%             
client [56] (test)  loss: 3.7712 -> 2.2146   acc: 28.47% -> 53.56%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.1756 -> 1.9147   acc: 25.50% -> 58.77%              
client [60] (test)  loss: 3.7806 -> 1.9880   acc: 24.91% -> 57.64%             
client [28] (test)  loss: 3.3606 -> 2.1138   acc: 34.90% -> 57.87%             
client [25] (test)  loss: 3.3843 -> 2.0707   acc: 38.26% -> 55.30%             
client [58] (test)  loss: 3.5522 -> 2.2924   acc: 28.98% -> 56.01%             
client [44] (test)  loss: 3.0426 -> 1.7994   acc: 37.68% -> 61.51%             
client [39] (test)  loss: 3.5639 -> 2.0656   acc: 31.02% -> 61.72%             
client [29] (test)  loss: 2.9320 -> 1.5988   acc: 38.61% -> 67.18%             
client [3] (test)  loss: 3.4416 -> 1.6614   acc: 31.86% -> 63.89%              
client [84] (test)  loss: 3.5841 -> 1.9487   acc: 31.56% -> 62.41%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.9783 -> 2.0941   acc: 25.60% -> 58.20%             
client [84] (test)  loss: 3.3911 -> 1.9680   acc: 34.04% -> 61.70%             
client [10] (test)  loss: 3.5147 -> 1.7788   acc: 36.38% -> 61.75%             
client [36] (test)  loss: 3.3930 -> 1.5302   acc: 30.07% -> 65.58%             
client [65] (test)  loss: 3.2657 -> 2.0804   acc: 35.84% -> 58.24%             
client [81] (test)  loss: 3.7239 -> 1.5726   acc: 30.78% -> 65.48%             
client [79] (test)  loss: 4.0399 -> 2.4854   acc: 26.71% -> 51.71%             
client [42] (test)  loss: 3.4419 -> 1.9895   acc: 30.77% -> 57.60%             
client [11] (test)  loss: 3.3362 -> 2.1154   acc: 33.39% -> 57.09%             
client [96] (test)  loss: 3.6376 -> 1.6196   acc: 30.22% -> 66.91%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0452 -> 1.7178   acc: 26.23% -> 67.73%              
client [53] (test)  loss: 3.6355 -> 2.0284   acc: 27.91% -> 64.53%             
client [52] (test)  loss: 2.7984 -> 1.8105   acc: 45.04% -> 63.65%             
client [42] (test)  loss: 3.0673 -> 2.0192   acc: 36.49% -> 58.50%             
client [69] (test)  loss: 3.2670 -> 2.3535   acc: 36.97% -> 51.60%             
client [59] (test)  loss: 2.8211 -> 1.8126   acc: 41.73% -> 63.38%             
client [7] (test)  loss: 3.5505 -> 2.1287   acc: 32.50% -> 55.83%              
client [26] (test)  loss: 2.8732 -> 1.6804   acc: 43.51% -> 65.09%             
client [49] (test)  loss: 2.9625 -> 2.1211   acc: 40.38% -> 60.49%             
client [98] (test)  loss: 3.3468 -> 1.7854   acc: 32.89% -> 68.05%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.3005 -> 1.7518   acc: 34.59% -> 67.86%             
client [47] (test)  loss: 3.0364 -> 1.2034   acc: 35.80% -> 71.79%             
client [21] (test)  loss: 3.9031 -> 2.0241   acc: 27.80% -> 59.60%             
client [77] (test)  loss: 3.4793 -> 1.6560   acc: 32.30% -> 65.64%             
client [95] (test)  loss: 3.0480 -> 1.8714   acc: 38.95% -> 64.42%             
client [91] (test)  loss: 3.0872 -> 1.6278   acc: 39.26% -> 65.82%             
client [14] (test)  loss: 2.7108 -> 1.5645   acc: 43.24% -> 67.97%             
client [99] (test)  loss: 3.2833 -> 2.3741   acc: 40.08% -> 54.60%             
client [20] (test)  loss: 2.7648 -> 1.6113   acc: 42.39% -> 64.88%             
client [39] (test)  loss: 3.7456 -> 2.0473   acc: 31.35% -> 60.73%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.8195 -> 1.7788   acc: 45.04% -> 64.36%             
client [62] (test)  loss: 3.4730 -> 2.3693   acc: 32.31% -> 56.24%             
client [71] (test)  loss: 2.8224 -> 2.1899   acc: 45.17% -> 54.83%             
client [97] (test)  loss: 3.3431 -> 1.9581   acc: 38.74% -> 59.54%             
client [30] (test)  loss: 2.8735 -> 2.1942   acc: 46.40% -> 57.77%             
client [88] (test)  loss: 3.1533 -> 1.8665   acc: 37.71% -> 62.12%             
client [60] (test)  loss: 3.7531 -> 2.0645   acc: 28.73% -> 60.55%             
client [82] (test)  loss: 3.2879 -> 1.8708   acc: 32.95% -> 63.31%             
client [91] (test)  loss: 2.7942 -> 1.6594   acc: 43.65% -> 66.84%             
client [57] (test)  loss: 3.2806 -> 2.0632   acc: 38.00% -> 57.09%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.8739 -> 1.2570   acc: 40.24% -> 74.91%             
client [15] (test)  loss: 2.8247 -> 1.8802   acc: 45.28% -> 62.94%             
client [71] (test)  loss: 3.3249 -> 2.1842   acc: 38.89% -> 54.11%             
client [97] (test)  loss: 3.5336 -> 1.9950   acc: 35.50% -> 59.16%             
client [53] (test)  loss: 3.7291 -> 2.0728   acc: 29.26% -> 63.18%             
client [77] (test)  loss: 3.3560 -> 1.6444   acc: 39.86% -> 66.84%             
client [76] (test)  loss: 3.0260 -> 1.8782   acc: 39.27% -> 60.91%             
client [79] (test)  loss: 3.9076 -> 2.4904   acc: 30.98% -> 52.14%             
client [28] (test)  loss: 3.7790 -> 2.1821   acc: 30.92% -> 59.86%             
client [99] (test)  loss: 3.3242 -> 2.3172   acc: 37.83% -> 56.24%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 2.5504 -> 2.0863   acc: 49.05% -> 58.97%             
client [86] (test)  loss: 2.1095 -> 1.6951   acc: 54.28% -> 65.11%             
client [34] (test)  loss: 2.3165 -> 2.1924   acc: 51.74% -> 57.54%             
client [73] (test)  loss: 2.0922 -> 1.7844   acc: 55.17% -> 64.55%             
client [5] (test)  loss: 2.3239 -> 1.8376   acc: 51.17% -> 64.68%              
client [96] (test)  loss: 3.0479 -> 1.7048   acc: 39.21% -> 67.63%             
client [22] (test)  loss: 1.8261 -> 1.7454   acc: 60.36% -> 67.85%             
client [60] (test)  loss: 2.4870 -> 2.0509   acc: 46.18% -> 60.73%             
client [66] (test)  loss: 2.4945 -> 1.8871   acc: 45.10% -> 63.28%             
client [83] (test)  loss: 3.2039 -> 2.1576   acc: 37.00% -> 58.25%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 1.9002 -> 1.9011   acc: 59.82% -> 61.45%             
client [65] (test)  loss: 2.2397 -> 2.0255   acc: 51.25% -> 58.60%             
client [95] (test)  loss: 2.3893 -> 2.0522   acc: 53.05% -> 64.42%             
client [17] (test)  loss: 3.1236 -> 1.5083   acc: 38.39% -> 66.67%             
client [8] (test)  loss: 3.3801 -> 1.8053   acc: 36.25% -> 66.93%              
client [35] (test)  loss: 2.5318 -> 1.7654   acc: 44.98% -> 63.05%             
client [98] (test)  loss: 2.1987 -> 1.8330   acc: 53.69% -> 68.24%             
client [53] (test)  loss: 2.4721 -> 2.1517   acc: 49.22% -> 62.60%             
client [43] (test)  loss: 3.4109 -> 2.1197   acc: 34.19% -> 61.82%             
client [64] (test)  loss: 2.0012 -> 1.6131   acc: 55.45% -> 68.15%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 2.4997 -> 1.9947   acc: 48.00% -> 60.80%             
client [88] (test)  loss: 1.8847 -> 1.9951   acc: 59.39% -> 61.77%             
client [38] (test)  loss: 2.2818 -> 2.3165   acc: 52.79% -> 56.62%             
client [3] (test)  loss: 2.0451 -> 1.7525   acc: 55.88% -> 66.50%              
client [5] (test)  loss: 2.0309 -> 1.8095   acc: 56.94% -> 65.23%              
client [41] (test)  loss: 1.6683 -> 1.6184   acc: 61.39% -> 62.46%             
client [7] (test)  loss: 2.3943 -> 2.1692   acc: 51.17% -> 58.35%              
client [37] (test)  loss: 2.2347 -> 1.9105   acc: 51.79% -> 64.45%             
client [45] (test)  loss: 3.3699 -> 1.9680   acc: 35.70% -> 60.45%             
client [47] (test)  loss: 3.0582 -> 1.2171   acc: 37.43% -> 72.15%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 2.1663 -> 1.8832   acc: 56.10% -> 63.57%             
client [11] (test)  loss: 2.0363 -> 2.1900   acc: 57.61% -> 59.00%             
client [37] (test)  loss: 1.9437 -> 1.9090   acc: 59.09% -> 64.77%             
client [41] (test)  loss: 1.6028 -> 1.6244   acc: 64.41% -> 62.81%             
client [95] (test)  loss: 1.9736 -> 2.0046   acc: 60.42% -> 63.79%             
client [53] (test)  loss: 2.3807 -> 2.1682   acc: 51.94% -> 62.40%             
client [22] (test)  loss: 1.6560 -> 1.7741   acc: 63.51% -> 67.65%             
client [25] (test)  loss: 2.5215 -> 2.1504   acc: 51.48% -> 57.39%             
client [69] (test)  loss: 2.3907 -> 2.4876   acc: 51.33% -> 54.79%             
client [46] (test)  loss: 1.7659 -> 1.5962   acc: 58.02% -> 66.31%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 1.4076 -> 1.2867   acc: 69.26% -> 73.24%             
client [69] (test)  loss: 2.3710 -> 2.5429   acc: 52.13% -> 54.52%             
client [82] (test)  loss: 1.8684 -> 1.9811   acc: 61.53% -> 62.66%             
client [45] (test)  loss: 2.1452 -> 2.0533   acc: 54.77% -> 60.04%             
client [7] (test)  loss: 2.2864 -> 2.1623   acc: 52.96% -> 58.53%              
client [50] (test)  loss: 1.7492 -> 1.6486   acc: 62.35% -> 65.11%             
client [35] (test)  loss: 1.9087 -> 1.8110   acc: 58.63% -> 63.65%             
client [24] (test)  loss: 2.0779 -> 2.0763   acc: 58.90% -> 64.93%             
client [15] (test)  loss: 1.8643 -> 2.0017   acc: 62.41% -> 64.34%             
client [58] (test)  loss: 2.1541 -> 2.4527   acc: 56.01% -> 56.71%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 1.5130 -> 1.4108   acc: 69.15% -> 72.65%             
client [76] (test)  loss: 1.8551 -> 1.9337   acc: 61.64% -> 61.45%             
client [67] (test)  loss: 1.8510 -> 1.8866   acc: 59.96% -> 62.79%             
client [37] (test)  loss: 1.9131 -> 1.9482   acc: 61.20% -> 64.45%             
client [58] (test)  loss: 2.1587 -> 2.4268   acc: 55.65% -> 56.89%             
client [64] (test)  loss: 1.6459 -> 1.7058   acc: 63.70% -> 67.99%             
client [77] (test)  loss: 1.8588 -> 1.7605   acc: 60.82% -> 65.64%             
client [55] (test)  loss: 1.8756 -> 1.9835   acc: 62.04% -> 63.32%             
client [12] (test)  loss: 1.6448 -> 1.8172   acc: 64.68% -> 67.74%             
client [89] (test)  loss: 1.9234 -> 2.1113   acc: 59.31% -> 59.86%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 1.9525 -> 2.0522   acc: 60.99% -> 64.72%             
client [51] (test)  loss: 1.7299 -> 1.7220   acc: 63.64% -> 64.73%             
client [8] (test)  loss: 1.8643 -> 1.8400   acc: 62.16% -> 67.41%              
client [18] (test)  loss: 2.1479 -> 2.2981   acc: 61.90% -> 61.18%             
client [94] (test)  loss: 1.9679 -> 2.1017   acc: 59.02% -> 62.11%             
client [81] (test)  loss: 1.6805 -> 1.7086   acc: 64.23% -> 65.30%             
client [3] (test)  loss: 1.7395 -> 1.8030   acc: 65.03% -> 66.01%              
client [11] (test)  loss: 2.0665 -> 2.2318   acc: 58.82% -> 59.17%             
client [95] (test)  loss: 1.8997 -> 2.1099   acc: 62.11% -> 64.84%             
client [67] (test)  loss: 1.8183 -> 1.9036   acc: 61.20% -> 62.96%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 2.0730 -> 2.0788   acc: 56.40% -> 60.80%             
client [79] (test)  loss: 2.5647 -> 2.6262   acc: 48.93% -> 51.92%             
client [58] (test)  loss: 2.1798 -> 2.4585   acc: 56.01% -> 56.89%             
client [88] (test)  loss: 1.8680 -> 2.1150   acc: 61.09% -> 60.92%             
client [46] (test)  loss: 1.5682 -> 1.6357   acc: 63.96% -> 65.77%             
client [11] (test)  loss: 2.0900 -> 2.2702   acc: 59.52% -> 58.65%             
client [55] (test)  loss: 1.8150 -> 1.9839   acc: 64.60% -> 64.78%             
client [13] (test)  loss: 2.0266 -> 2.1184   acc: 61.09% -> 62.63%             
client [31] (test)  loss: 1.6803 -> 1.2960   acc: 61.85% -> 74.74%             
client [75] (test)  loss: 1.8906 -> 1.9738   acc: 63.30% -> 63.13%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 2.0935 -> 2.2553   acc: 58.27% -> 59.35%             
client [7] (test)  loss: 2.1674 -> 2.1768   acc: 57.27% -> 57.45%              
client [57] (test)  loss: 2.3028 -> 2.2360   acc: 52.18% -> 56.36%             
client [13] (test)  loss: 2.0316 -> 2.1524   acc: 61.60% -> 62.46%             
client [43] (test)  loss: 2.0544 -> 2.2313   acc: 61.34% -> 61.50%             
client [91] (test)  loss: 1.8100 -> 1.7521   acc: 64.13% -> 66.33%             
client [10] (test)  loss: 1.8366 -> 1.9393   acc: 63.25% -> 63.62%             
client [64] (test)  loss: 1.6695 -> 1.6665   acc: 65.84% -> 68.32%             
client [82] (test)  loss: 1.8764 -> 2.0797   acc: 63.31% -> 64.12%             
client [22] (test)  loss: 1.6523 -> 1.8688   acc: 66.47% -> 68.64%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 1.6114 -> 1.7050   acc: 65.92% -> 65.05%             
client [23] (test)  loss: 1.6299 -> 1.5478   acc: 67.08% -> 68.67%             
client [88] (test)  loss: 1.9083 -> 2.1020   acc: 60.58% -> 61.43%             
client [98] (test)  loss: 1.6993 -> 1.9007   acc: 67.86% -> 68.24%             
client [79] (test)  loss: 2.6347 -> 2.7061   acc: 48.93% -> 52.56%             
client [21] (test)  loss: 2.0207 -> 2.0852   acc: 58.80% -> 60.80%             
client [92] (test)  loss: 1.6702 -> 1.7987   acc: 63.49% -> 64.19%             
client [56] (test)  loss: 2.2096 -> 2.4723   acc: 55.16% -> 55.69%             
client [5] (test)  loss: 1.7721 -> 1.8947   acc: 63.42% -> 63.78%              
client [52] (test)  loss: 1.8311 -> 1.9697   acc: 65.78% -> 66.49%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '3.2704 -> 0.0000', 'accuracy': '37.00% -> 0.00%'},          
    200: {'loss': '2.0005 -> 0.0000', 'accuracy': '62.99% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(11.94%) at epoch: 7                                     
pFedSim achieved 20.0%(20.74%) at epoch: 13                                    
pFedSim achieved 30.0%(30.11%) at epoch: 28                                    
pFedSim achieved 40.0%(41.29%) at epoch: 102                                   
pFedSim achieved 50.0%(50.46%) at epoch: 111                                   
pFedSim achieved 60.0%(61.09%) at epoch: 143                                   
Convergence (test_after):                                                      
pFedSim achieved 10.0%(17.80%) at epoch: 0                                     
pFedSim achieved 20.0%(20.62%) at epoch: 1                                     
pFedSim achieved 30.0%(35.52%) at epoch: 2                                     
pFedSim achieved 40.0%(43.96%) at epoch: 3                                     
pFedSim achieved 50.0%(52.80%) at epoch: 7                                     
pFedSim achieved 60.0%(60.33%) at epoch: 29                                    
