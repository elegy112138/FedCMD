==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.0691 -> 0.0048   acc: 48.17% -> 100.00%            
client [81] (test)  loss: 0.8555 -> 0.5914   acc: 73.64% -> 65.45%             
client [21] (test)  loss: 2.6935 -> 0.5227   acc: 30.68% -> 85.02%             
client [68] (test)  loss: 0.3185 -> 0.1335   acc: 91.64% -> 95.82%             
client [93] (test)  loss: 2.0672 -> 0.2034   acc: 25.60% -> 98.40%             
client [31] (test)  loss: 1.0941 -> 0.8788   acc: 60.00% -> 45.00%             
client [20] (test)  loss: 0.6680 -> 0.0348   acc: 87.67% -> 99.33%             
client [59] (test)  loss: 1.3766 -> 0.3663   acc: 68.06% -> 87.74%             
client [48] (test)  loss: 1.3453 -> 0.0954   acc: 36.88% -> 98.12%             
client [34] (test)  loss: 0.4567 -> 0.2179   acc: 91.18% -> 92.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6111 -> 0.2320   acc: 75.47% -> 92.00%             
client [99] (test)  loss: 1.5219 -> 0.0683   acc: 39.49% -> 98.30%             
client [67] (test)  loss: 2.7047 -> 0.1569   acc: 13.10% -> 96.58%             
client [0] (test)  loss: 0.6287 -> 0.6141   acc: 82.24% -> 85.05%              
client [76] (test)  loss: 0.4618 -> 0.2167   acc: 73.68% -> 94.74%             
client [41] (test)  loss: 0.3645 -> 0.3093   acc: 88.34% -> 90.80%             
client [62] (test)  loss: 0.9930 -> 0.2228   acc: 64.29% -> 92.86%             
client [2] (test)  loss: 0.7431 -> 0.0001   acc: 77.56% -> 100.00%             
client [14] (test)  loss: 1.6573 -> 0.1543   acc: 35.97% -> 97.18%             
client [46] (test)  loss: 2.7676 -> 0.3447   acc: 9.69% -> 91.19%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7164 -> 0.4869   acc: 74.61% -> 86.27%             
client [68] (test)  loss: 0.3356 -> 0.1095   acc: 86.41% -> 96.52%             
client [57] (test)  loss: 1.1036 -> 0.0520   acc: 46.62% -> 99.25%             
client [17] (test)  loss: 0.5739 -> 0.1962   acc: 82.04% -> 94.20%             
client [54] (test)  loss: 0.4664 -> 0.1616   acc: 81.35% -> 93.26%             
client [23] (test)  loss: 0.3264 -> 0.0977   acc: 87.97% -> 96.62%             
client [35] (test)  loss: 0.5704 -> 0.1654   acc: 81.21% -> 94.55%             
client [59] (test)  loss: 0.5595 -> 0.2706   acc: 82.26% -> 90.97%             
client [31] (test)  loss: 0.2795 -> 0.1103   acc: 92.78% -> 97.22%             
client [9] (test)  loss: 0.2353 -> 0.0440   acc: 92.74% -> 98.96%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3418 -> 0.1426   acc: 87.65% -> 96.47%             
client [33] (test)  loss: 0.2488 -> 0.1087   acc: 90.87% -> 97.03%             
client [16] (test)  loss: 0.6979 -> 0.0557   acc: 72.38% -> 98.60%             
client [44] (test)  loss: 0.4872 -> 0.1460   acc: 82.05% -> 96.34%             
client [8] (test)  loss: 0.8261 -> 0.0005   acc: 69.14% -> 100.00%             
client [31] (test)  loss: 0.4698 -> 0.1133   acc: 86.67% -> 98.33%             
client [47] (test)  loss: 0.2727 -> 0.0185   acc: 91.73% -> 99.63%             
client [36] (test)  loss: 0.0805 -> 0.0023   acc: 97.54% -> 100.00%            
client [20] (test)  loss: 0.9536 -> 0.0222   acc: 70.33% -> 99.50%             
client [56] (test)  loss: 0.7319 -> 0.4181   acc: 72.76% -> 90.24%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7064 -> 0.0954   acc: 78.55% -> 97.58%              
client [60] (test)  loss: 0.8988 -> 0.1059   acc: 63.83% -> 98.07%             
client [28] (test)  loss: 0.2504 -> 0.0624   acc: 92.86% -> 97.32%             
client [25] (test)  loss: 0.6606 -> 0.1009   acc: 82.23% -> 97.21%             
client [58] (test)  loss: 0.8937 -> 0.1001   acc: 75.00% -> 97.45%             
client [44] (test)  loss: 1.0623 -> 0.1656   acc: 72.53% -> 95.60%             
client [39] (test)  loss: 0.3080 -> 0.1780   acc: 91.67% -> 94.44%             
client [29] (test)  loss: 1.3561 -> 0.2266   acc: 63.47% -> 93.15%             
client [3] (test)  loss: 0.8718 -> 0.1440   acc: 69.75% -> 94.93%              
client [84] (test)  loss: 1.7971 -> 0.0062   acc: 58.26% -> 100.00%            
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3461 -> 0.2742   acc: 90.10% -> 89.61%             
client [84] (test)  loss: 1.0105 -> 0.0292   acc: 64.68% -> 99.08%             
client [10] (test)  loss: 0.1609 -> 0.0886   acc: 94.93% -> 98.55%             
client [36] (test)  loss: 0.0727 -> 0.0019   acc: 97.54% -> 99.88%             
client [65] (test)  loss: 1.3322 -> 0.2807   acc: 51.19% -> 94.05%             
client [81] (test)  loss: 0.4959 -> 0.1160   acc: 87.27% -> 95.45%             
client [79] (test)  loss: 0.7766 -> 0.3806   acc: 73.22% -> 88.45%             
client [42] (test)  loss: 0.4474 -> 0.0332   acc: 86.85% -> 99.23%             
client [11] (test)  loss: 0.4758 -> 0.3305   acc: 84.89% -> 87.56%             
client [96] (test)  loss: 0.3906 -> 0.3980   acc: 87.36% -> 85.67%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3574 -> 0.0004   acc: 91.67% -> 100.00%             
client [53] (test)  loss: 0.1525 -> 0.0362   acc: 95.85% -> 99.39%             
client [52] (test)  loss: 0.9336 -> 0.3356   acc: 66.67% -> 89.15%             
client [42] (test)  loss: 0.1601 -> 0.0290   acc: 94.65% -> 99.29%             
client [69] (test)  loss: 0.2365 -> 0.1756   acc: 92.27% -> 94.13%             
client [59] (test)  loss: 0.4535 -> 0.3180   acc: 86.13% -> 91.29%             
client [7] (test)  loss: 0.4050 -> 0.0349   acc: 87.11% -> 98.71%              
client [26] (test)  loss: 0.6416 -> 0.0177   acc: 80.97% -> 99.68%             
client [49] (test)  loss: 0.5733 -> 0.0231   acc: 78.98% -> 99.58%             
client [98] (test)  loss: 0.5588 -> 0.5774   acc: 82.00% -> 69.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6427 -> 0.3733   acc: 74.00% -> 87.00%             
client [47] (test)  loss: 0.5273 -> 0.0221   acc: 80.70% -> 99.45%             
client [21] (test)  loss: 0.2745 -> 0.2044   acc: 91.30% -> 93.48%             
client [77] (test)  loss: 0.1220 -> 0.0308   acc: 96.62% -> 99.15%             
client [95] (test)  loss: 0.3847 -> 0.1397   acc: 87.97% -> 96.24%             
client [91] (test)  loss: 0.6811 -> 0.0869   acc: 65.62% -> 96.88%             
client [14] (test)  loss: 0.1706 -> 0.1645   acc: 95.57% -> 97.58%             
client [99] (test)  loss: 0.0936 -> 0.0544   acc: 97.73% -> 98.86%             
client [20] (test)  loss: 1.4631 -> 0.0138   acc: 39.83% -> 99.67%             
client [39] (test)  loss: 0.1506 -> 0.2175   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8180 -> 0.2377   acc: 71.32% -> 93.02%             
client [62] (test)  loss: 0.3764 -> 0.0984   acc: 88.10% -> 97.62%             
client [71] (test)  loss: 0.1273 -> 0.0367   acc: 95.48% -> 98.92%             
client [97] (test)  loss: 0.2861 -> 0.0568   acc: 91.63% -> 99.18%             
client [30] (test)  loss: 0.4201 -> 0.1686   acc: 86.89% -> 96.25%             
client [88] (test)  loss: 1.2515 -> 0.5233   acc: 56.91% -> 79.56%             
client [60] (test)  loss: 0.7627 -> 0.1305   acc: 72.92% -> 98.07%             
client [82] (test)  loss: 1.5439 -> 0.0422   acc: 48.56% -> 99.52%             
client [91] (test)  loss: 0.5696 -> 0.0515   acc: 81.25% -> 96.88%             
client [57] (test)  loss: 1.3838 -> 0.0417   acc: 50.94% -> 99.44%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4746 -> 0.1066   acc: 81.67% -> 97.78%             
client [15] (test)  loss: 0.8047 -> 0.2895   acc: 72.82% -> 89.17%             
client [71] (test)  loss: 0.1733 -> 0.0357   acc: 94.21% -> 98.73%             
client [97] (test)  loss: 0.3978 -> 0.0521   acc: 88.34% -> 99.18%             
client [53] (test)  loss: 0.1531 -> 0.0322   acc: 95.96% -> 99.39%             
client [77] (test)  loss: 0.0345 -> 0.0136   acc: 99.15% -> 99.72%             
client [76] (test)  loss: 0.3046 -> 0.1815   acc: 86.84% -> 92.11%             
client [79] (test)  loss: 0.7577 -> 0.3392   acc: 72.73% -> 88.94%             
client [28] (test)  loss: 0.3323 -> 0.0547   acc: 85.71% -> 98.21%             
client [99] (test)  loss: 1.0077 -> 0.0544   acc: 66.48% -> 98.58%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.0856 -> 0.0575   acc: 98.03% -> 99.01%             
client [86] (test)  loss: 0.1654 -> 0.1243   acc: 92.98% -> 96.49%             
client [34] (test)  loss: 0.1915 -> 0.1586   acc: 95.59% -> 97.06%             
client [73] (test)  loss: 0.3171 -> 0.0198   acc: 87.86% -> 99.64%             
client [5] (test)  loss: 0.2647 -> 0.0499   acc: 89.52% -> 98.91%              
client [96] (test)  loss: 0.3186 -> 0.1242   acc: 90.45% -> 97.19%             
client [22] (test)  loss: 0.4103 -> 0.0578   acc: 83.49% -> 98.58%             
client [60] (test)  loss: 0.2010 -> 0.1410   acc: 93.04% -> 98.07%             
client [66] (test)  loss: 0.1075 -> 0.0015   acc: 97.59% -> 100.00%            
client [83] (test)  loss: 0.0983 -> 0.0344   acc: 96.62% -> 98.94%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.1487 -> 0.2137   acc: 92.11% -> 94.74%             
client [65] (test)  loss: 0.2571 -> 0.3044   acc: 95.24% -> 91.67%             
client [95] (test)  loss: 0.1719 -> 0.1296   acc: 93.23% -> 96.99%             
client [17] (test)  loss: 0.6539 -> 0.1698   acc: 78.45% -> 95.30%             
client [8] (test)  loss: 1.0306 -> 0.0005   acc: 65.99% -> 100.00%             
client [35] (test)  loss: 0.1678 -> 0.1085   acc: 95.15% -> 97.58%             
client [98] (test)  loss: 0.5676 -> 0.2628   acc: 81.00% -> 91.00%             
client [53] (test)  loss: 0.0657 -> 0.0371   acc: 98.48% -> 99.39%             
client [43] (test)  loss: 0.8414 -> 0.1881   acc: 72.59% -> 95.56%             
client [64] (test)  loss: 0.0985 -> 0.0855   acc: 96.18% -> 97.65%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.1584 -> 0.1897   acc: 95.41% -> 93.96%             
client [88] (test)  loss: 0.3990 -> 0.4718   acc: 88.95% -> 83.98%             
client [38] (test)  loss: 0.4638 -> 0.5520   acc: 86.67% -> 88.48%             
client [3] (test)  loss: 0.1910 -> 0.1465   acc: 93.12% -> 95.83%              
client [5] (test)  loss: 0.1637 -> 0.0556   acc: 94.98% -> 98.91%              
client [41] (test)  loss: 0.1807 -> 0.2603   acc: 94.43% -> 93.52%             
client [7] (test)  loss: 0.1163 -> 0.0342   acc: 95.76% -> 98.71%              
client [37] (test)  loss: 0.1805 -> 0.0688   acc: 94.85% -> 98.45%             
client [45] (test)  loss: 0.3360 -> 0.3318   acc: 89.74% -> 91.03%             
client [47] (test)  loss: 0.6201 -> 0.0198   acc: 79.96% -> 99.26%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.2388 -> 0.0830   acc: 92.66% -> 97.90%             
client [11] (test)  loss: 0.2901 -> 0.3257   acc: 87.56% -> 88.22%             
client [37] (test)  loss: 0.1127 -> 0.0793   acc: 96.91% -> 97.42%             
client [41] (test)  loss: 0.1841 -> 0.2028   acc: 94.17% -> 94.82%             
client [95] (test)  loss: 0.1395 -> 0.0903   acc: 96.24% -> 96.99%             
client [53] (test)  loss: 0.0729 -> 0.0369   acc: 98.28% -> 99.29%             
client [22] (test)  loss: 0.2357 -> 0.0616   acc: 91.51% -> 98.58%             
client [25] (test)  loss: 0.0732 -> 0.1003   acc: 97.56% -> 97.56%             
client [69] (test)  loss: 0.2092 -> 0.1897   acc: 92.80% -> 94.40%             
client [46] (test)  loss: 0.3781 -> 0.3504   acc: 85.46% -> 92.51%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.0572 -> 0.0180   acc: 98.16% -> 99.26%             
client [69] (test)  loss: 0.2018 -> 0.1781   acc: 93.60% -> 94.40%             
client [82] (test)  loss: 0.1284 -> 0.0317   acc: 95.35% -> 99.68%             
client [45] (test)  loss: 0.3285 -> 0.3381   acc: 88.46% -> 92.31%             
client [7] (test)  loss: 0.0737 -> 0.0369   acc: 97.97% -> 98.90%              
client [50] (test)  loss: 0.0660 -> 0.0013   acc: 98.21% -> 100.00%            
client [35] (test)  loss: 0.1237 -> 0.1176   acc: 97.58% -> 98.18%             
client [24] (test)  loss: 0.4823 -> 0.4735   acc: 85.49% -> 84.97%             
client [15] (test)  loss: 0.2644 -> 0.2115   acc: 90.45% -> 93.63%             
client [58] (test)  loss: 0.0758 -> 0.0631   acc: 97.26% -> 98.18%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.0895 -> 0.0204   acc: 96.88% -> 99.38%             
client [76] (test)  loss: 0.1539 -> 0.1925   acc: 94.74% -> 94.74%             
client [67] (test)  loss: 0.2668 -> 0.1105   acc: 91.22% -> 97.02%             
client [37] (test)  loss: 0.1052 -> 0.1297   acc: 96.91% -> 96.39%             
client [58] (test)  loss: 0.0725 -> 0.0726   acc: 97.45% -> 97.99%             
client [64] (test)  loss: 0.0732 -> 0.0740   acc: 97.06% -> 97.35%             
client [77] (test)  loss: 0.0259 -> 0.0167   acc: 99.44% -> 99.72%             
client [55] (test)  loss: 0.0646 -> 0.0094   acc: 98.18% -> 99.62%             
client [12] (test)  loss: 0.5142 -> 0.4002   acc: 84.13% -> 89.25%             
client [89] (test)  loss: 0.7222 -> 0.7535   acc: 83.33% -> 88.10%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.0233 -> 0.0062   acc: 98.62% -> 99.54%             
client [51] (test)  loss: 0.0655 -> 0.0024   acc: 97.69% -> 100.00%            
client [8] (test)  loss: 0.0656 -> 0.0005   acc: 97.75% -> 100.00%             
client [18] (test)  loss: 0.0181 -> 0.0039   acc: 99.03% -> 99.76%             
client [94] (test)  loss: 0.1318 -> 0.2056   acc: 95.74% -> 95.04%             
client [81] (test)  loss: 0.0391 -> 0.0175   acc: 97.27% -> 100.00%            
client [3] (test)  loss: 0.1417 -> 0.1522   acc: 95.65% -> 94.93%              
client [11] (test)  loss: 0.2875 -> 0.3102   acc: 89.33% -> 89.11%             
client [95] (test)  loss: 0.0982 -> 0.0850   acc: 96.24% -> 95.49%             
client [67] (test)  loss: 0.2234 -> 0.1469   acc: 92.41% -> 97.02%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.1570 -> 0.1915   acc: 95.41% -> 94.20%             
client [79] (test)  loss: 0.2956 -> 0.3543   acc: 90.91% -> 91.15%             
client [58] (test)  loss: 0.0671 -> 0.0725   acc: 97.99% -> 97.99%             
client [88] (test)  loss: 0.4785 -> 0.5614   acc: 87.29% -> 87.29%             
client [46] (test)  loss: 0.3855 -> 0.3977   acc: 87.22% -> 92.07%             
client [11] (test)  loss: 0.2898 -> 0.2976   acc: 89.56% -> 89.33%             
client [55] (test)  loss: 0.0462 -> 0.0100   acc: 98.47% -> 99.62%             
client [13] (test)  loss: 0.0605 -> 0.0083   acc: 98.36% -> 99.73%             
client [31] (test)  loss: 0.1882 -> 0.0952   acc: 93.33% -> 97.78%             
client [75] (test)  loss: 0.2570 -> 0.3123   acc: 89.59% -> 91.04%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.3239 -> 0.2497   acc: 89.76% -> 93.70%             
client [7] (test)  loss: 0.0390 -> 0.0279   acc: 98.53% -> 98.71%              
client [57] (test)  loss: 0.0461 -> 0.0349   acc: 98.87% -> 99.62%             
client [13] (test)  loss: 0.0497 -> 0.0130   acc: 98.36% -> 99.45%             
client [43] (test)  loss: 0.1088 -> 0.1646   acc: 96.30% -> 94.81%             
client [91] (test)  loss: 0.1855 -> 0.0792   acc: 93.75% -> 96.88%             
client [10] (test)  loss: 0.0832 -> 0.0857   acc: 98.55% -> 98.55%             
client [64] (test)  loss: 0.0676 -> 0.0831   acc: 97.06% -> 97.35%             
client [82] (test)  loss: 0.0452 -> 0.0326   acc: 98.56% -> 99.68%             
client [22] (test)  loss: 0.0922 -> 0.0550   acc: 98.11% -> 98.58%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.0417 -> 0.0173   acc: 98.83% -> 99.67%             
client [23] (test)  loss: 0.0997 -> 0.0764   acc: 96.24% -> 97.37%             
client [88] (test)  loss: 0.4661 -> 0.5934   acc: 88.40% -> 87.29%             
client [98] (test)  loss: 0.3640 -> 0.2754   acc: 88.00% -> 93.00%             
client [79] (test)  loss: 0.3159 -> 0.3445   acc: 90.91% -> 90.66%             
client [21] (test)  loss: 0.1663 -> 0.2131   acc: 95.17% -> 93.00%             
client [92] (test)  loss: 0.1306 -> 0.2419   acc: 95.21% -> 94.86%             
client [56] (test)  loss: 0.3486 -> 0.3747   acc: 90.65% -> 89.02%             
client [5] (test)  loss: 0.0535 -> 0.0454   acc: 98.25% -> 98.91%              
client [52] (test)  loss: 0.2080 -> 0.2366   acc: 92.25% -> 91.47%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.5553 -> 0.0000', 'accuracy': '81.54% -> 0.00%'},          
    200: {'loss': '0.1194 -> 0.0000', 'accuracy': '96.71% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(15.73%) at epoch: 1                                     
pFedSim achieved 20.0%(27.21%) at epoch: 2                                     
pFedSim achieved 30.0%(30.65%) at epoch: 3                                     
pFedSim achieved 40.0%(40.50%) at epoch: 4                                     
pFedSim achieved 50.0%(58.27%) at epoch: 8                                     
pFedSim achieved 60.0%(62.86%) at epoch: 9                                     
pFedSim achieved 70.0%(77.37%) at epoch: 11                                    
pFedSim achieved 80.0%(82.13%) at epoch: 18                                    
pFedSim achieved 90.0%(90.55%) at epoch: 67                                    
Convergence (test_after):                                                      
pFedSim achieved 80.0%(82.05%) at epoch: 0                                     
pFedSim achieved 90.0%(93.87%) at epoch: 2                                     
