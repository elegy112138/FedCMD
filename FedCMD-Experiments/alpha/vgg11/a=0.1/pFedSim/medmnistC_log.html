==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4732 -> 0.7384   acc: 74.78% -> 75.65%             
client [81] (test)  loss: 2.2996 -> 1.3822   acc: 30.43% -> 47.83%             
client [21] (test)  loss: 3.0789 -> 1.2928   acc: 0.00% -> 58.62%              
client [68] (test)  loss: 2.2131 -> 0.3333   acc: 0.00% -> 89.80%              
client [93] (test)  loss: 2.2997 -> 0.5587   acc: 1.10% -> 82.42%              
client [31] (test)  loss: 3.3287 -> 0.4727   acc: 0.00% -> 86.67%              
client [20] (test)  loss: 1.4716 -> 0.4083   acc: 66.96% -> 88.70%             
client [59] (test)  loss: 1.2427 -> 0.0347   acc: 86.07% -> 99.18%             
client [48] (test)  loss: 0.9392 -> 0.4524   acc: 83.76% -> 87.18%             
client [34] (test)  loss: 2.1503 -> 0.8868   acc: 28.46% -> 69.11%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.6098 -> 0.1860   acc: 11.25% -> 93.86%             
client [99] (test)  loss: 3.2866 -> 0.2652   acc: 0.78% -> 95.31%              
client [67] (test)  loss: 0.5919 -> 0.1744   acc: 83.52% -> 97.80%             
client [0] (test)  loss: 1.7096 -> 0.9454   acc: 37.29% -> 49.15%              
client [76] (test)  loss: 1.3798 -> 0.2538   acc: 47.22% -> 91.67%             
client [41] (test)  loss: 2.5649 -> 0.4796   acc: 2.91% -> 87.38%              
client [62] (test)  loss: 2.1393 -> 0.0023   acc: 36.24% -> 100.00%            
client [2] (test)  loss: 2.0183 -> 0.2485   acc: 7.53% -> 94.52%               
client [14] (test)  loss: 1.6928 -> 0.9847   acc: 57.75% -> 61.97%             
client [46] (test)  loss: 2.9573 -> 0.5915   acc: 12.66% -> 81.01%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3352 -> 0.1072   acc: 91.13% -> 97.58%             
client [68] (test)  loss: 0.5065 -> 0.5143   acc: 86.73% -> 89.80%             
client [57] (test)  loss: 0.3906 -> 0.1787   acc: 90.68% -> 95.76%             
client [17] (test)  loss: 1.4963 -> 0.6165   acc: 48.94% -> 77.66%             
client [54] (test)  loss: 1.5698 -> 0.7168   acc: 42.61% -> 76.52%             
client [23] (test)  loss: 1.5686 -> 0.5276   acc: 46.30% -> 85.19%             
client [35] (test)  loss: 1.3726 -> 0.1206   acc: 39.29% -> 100.00%            
client [59] (test)  loss: 0.2043 -> 0.0399   acc: 91.80% -> 99.18%             
client [31] (test)  loss: 1.5557 -> 0.2397   acc: 28.89% -> 94.44%             
client [9] (test)  loss: 0.9452 -> 0.1147   acc: 80.95% -> 97.62%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5972 -> 0.1658   acc: 63.16% -> 96.49%             
client [33] (test)  loss: 1.4430 -> 0.4040   acc: 54.24% -> 91.53%             
client [16] (test)  loss: 1.0525 -> 0.2792   acc: 56.76% -> 86.49%             
client [44] (test)  loss: 0.7675 -> 0.1237   acc: 76.81% -> 96.14%             
client [8] (test)  loss: 1.1130 -> 0.3442   acc: 54.79% -> 90.41%              
client [31] (test)  loss: 1.3073 -> 0.1748   acc: 54.44% -> 94.44%             
client [47] (test)  loss: 3.0218 -> 0.4910   acc: 20.00% -> 76.00%             
client [36] (test)  loss: 1.1291 -> 0.1464   acc: 61.14% -> 94.29%             
client [20] (test)  loss: 3.0049 -> 0.1243   acc: 9.57% -> 97.39%              
client [56] (test)  loss: 0.9598 -> 0.2411   acc: 74.42% -> 93.02%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6610 -> 0.0983   acc: 65.38% -> 96.15%              
client [60] (test)  loss: 0.6084 -> 0.2133   acc: 84.44% -> 91.11%             
client [28] (test)  loss: 0.7512 -> 0.4725   acc: 76.00% -> 88.00%             
client [25] (test)  loss: 1.1715 -> 0.5384   acc: 65.52% -> 85.06%             
client [58] (test)  loss: 3.7229 -> 0.0828   acc: 3.70% -> 96.30%              
client [44] (test)  loss: 3.2083 -> 0.1091   acc: 14.01% -> 96.62%             
client [39] (test)  loss: 1.7811 -> 0.4148   acc: 44.00% -> 79.20%             
client [29] (test)  loss: 2.0523 -> 0.4523   acc: 25.00% -> 92.86%             
client [3] (test)  loss: 0.5716 -> 0.1079   acc: 81.30% -> 97.56%              
client [84] (test)  loss: 1.6477 -> 0.5901   acc: 53.66% -> 82.93%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.5234 -> 0.7247   acc: 34.48% -> 75.86%             
client [84] (test)  loss: 1.0197 -> 0.4809   acc: 65.85% -> 82.93%             
client [10] (test)  loss: 0.4300 -> 0.1557   acc: 85.26% -> 91.58%             
client [36] (test)  loss: 0.5085 -> 0.0940   acc: 82.29% -> 97.71%             
client [65] (test)  loss: 0.6312 -> 0.1722   acc: 79.17% -> 95.83%             
client [81] (test)  loss: 0.8220 -> 1.0336   acc: 73.91% -> 56.52%             
client [79] (test)  loss: 1.0803 -> 0.0389   acc: 53.69% -> 98.99%             
client [42] (test)  loss: 1.0181 -> 0.2032   acc: 54.34% -> 94.34%             
client [11] (test)  loss: 0.6361 -> 0.6998   acc: 85.11% -> 78.72%             
client [96] (test)  loss: 0.2951 -> 0.1156   acc: 86.76% -> 97.06%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9790 -> 0.2261   acc: 58.90% -> 93.15%              
client [53] (test)  loss: 0.4084 -> 0.1195   acc: 89.86% -> 98.55%             
client [52] (test)  loss: 0.7500 -> 0.3868   acc: 71.79% -> 79.49%             
client [42] (test)  loss: 2.2648 -> 0.1783   acc: 22.64% -> 94.72%             
client [69] (test)  loss: 0.4753 -> 0.1163   acc: 89.51% -> 95.40%             
client [59] (test)  loss: 0.3025 -> 0.0168   acc: 89.34% -> 99.18%             
client [7] (test)  loss: 1.5627 -> 0.4973   acc: 54.02% -> 85.06%              
client [26] (test)  loss: 1.1861 -> 0.0294   acc: 58.62% -> 99.31%             
client [49] (test)  loss: 0.1824 -> 0.0405   acc: 94.75% -> 98.80%             
client [98] (test)  loss: 0.2683 -> 0.0709   acc: 91.89% -> 97.30%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4491 -> 0.0746   acc: 62.16% -> 98.65%             
client [47] (test)  loss: 1.8399 -> 0.0326   acc: 28.00% -> 100.00%            
client [21] (test)  loss: 1.8941 -> 0.6896   acc: 48.28% -> 68.97%             
client [77] (test)  loss: 1.7412 -> 0.2766   acc: 23.48% -> 93.04%             
client [95] (test)  loss: 2.0382 -> 0.1375   acc: 19.05% -> 96.43%             
client [91] (test)  loss: 0.8980 -> 0.7539   acc: 66.67% -> 75.69%             
client [14] (test)  loss: 2.5479 -> 0.5241   acc: 14.08% -> 77.46%             
client [99] (test)  loss: 0.5769 -> 0.0800   acc: 84.38% -> 97.66%             
client [20] (test)  loss: 1.8309 -> 0.0365   acc: 25.22% -> 98.26%             
client [39] (test)  loss: 1.1280 -> 0.3026   acc: 70.40% -> 87.20%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7799 -> 0.4890   acc: 61.54% -> 79.49%             
client [62] (test)  loss: 0.1364 -> 0.0072   acc: 95.30% -> 100.00%            
client [71] (test)  loss: 0.2774 -> 0.0416   acc: 92.68% -> 98.37%             
client [97] (test)  loss: 0.9171 -> 0.3347   acc: 67.30% -> 89.94%             
client [30] (test)  loss: 0.9327 -> 0.0930   acc: 65.78% -> 97.86%             
client [88] (test)  loss: 0.5293 -> 0.4024   acc: 86.46% -> 87.50%             
client [60] (test)  loss: 0.5192 -> 0.2479   acc: 91.11% -> 91.11%             
client [82] (test)  loss: 0.0383 -> 0.0064   acc: 99.43% -> 100.00%            
client [91] (test)  loss: 0.8146 -> 0.5787   acc: 68.75% -> 77.78%             
client [57] (test)  loss: 0.2525 -> 0.1278   acc: 94.07% -> 96.61%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2829 -> 0.0621   acc: 91.11% -> 96.67%             
client [15] (test)  loss: 0.1769 -> 0.0660   acc: 91.86% -> 98.84%             
client [71] (test)  loss: 0.6513 -> 0.0347   acc: 78.05% -> 98.37%             
client [97] (test)  loss: 0.8229 -> 0.3269   acc: 64.15% -> 89.31%             
client [53] (test)  loss: 1.3012 -> 0.0987   acc: 57.97% -> 97.10%             
client [77] (test)  loss: 1.1067 -> 0.2697   acc: 62.61% -> 90.43%             
client [76] (test)  loss: 0.1620 -> 0.0464   acc: 91.67% -> 100.00%            
client [79] (test)  loss: 1.3869 -> 0.0327   acc: 46.31% -> 98.99%             
client [28] (test)  loss: 0.6551 -> 0.5030   acc: 60.00% -> 84.00%             
client [99] (test)  loss: 0.7304 -> 0.0747   acc: 76.56% -> 97.66%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.3625 -> 0.2993   acc: 89.31% -> 91.82%             
client [86] (test)  loss: 0.5507 -> 0.3547   acc: 86.21% -> 90.80%             
client [34] (test)  loss: 0.3191 -> 0.2870   acc: 90.24% -> 91.87%             
client [73] (test)  loss: 0.1957 -> 0.1450   acc: 93.65% -> 95.24%             
client [5] (test)  loss: 0.4844 -> 0.7122   acc: 88.57% -> 71.43%              
client [96] (test)  loss: 0.1332 -> 0.1057   acc: 95.59% -> 97.06%             
client [22] (test)  loss: 0.5326 -> 0.3538   acc: 79.66% -> 89.83%             
client [60] (test)  loss: 0.3241 -> 0.2491   acc: 91.11% -> 91.11%             
client [66] (test)  loss: 0.2439 -> 0.2067   acc: 94.29% -> 94.29%             
client [83] (test)  loss: 0.2009 -> 0.0012   acc: 95.38% -> 100.00%            
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.0721 -> 0.0347   acc: 94.44% -> 100.00%            
client [65] (test)  loss: 0.2139 -> 0.1073   acc: 91.67% -> 96.67%             
client [95] (test)  loss: 0.1826 -> 0.1101   acc: 95.24% -> 98.81%             
client [17] (test)  loss: 0.3709 -> 0.2051   acc: 82.98% -> 93.62%             
client [8] (test)  loss: 0.9970 -> 0.1524   acc: 58.90% -> 93.15%              
client [35] (test)  loss: 0.1890 -> 0.0759   acc: 92.86% -> 96.43%             
client [98] (test)  loss: 0.1265 -> 0.0314   acc: 97.30% -> 100.00%            
client [53] (test)  loss: 0.4780 -> 0.1042   acc: 84.06% -> 97.10%             
client [43] (test)  loss: 0.2798 -> 0.0455   acc: 90.00% -> 100.00%            
client [64] (test)  loss: 0.2292 -> 0.1417   acc: 92.98% -> 96.49%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.7616 -> 0.4714   acc: 68.97% -> 82.76%             
client [88] (test)  loss: 0.4565 -> 0.3972   acc: 87.50% -> 84.38%             
client [38] (test)  loss: 0.0437 -> 0.0451   acc: 98.39% -> 98.39%             
client [3] (test)  loss: 0.1126 -> 0.0506   acc: 95.93% -> 98.37%              
client [5] (test)  loss: 0.5595 -> 0.5182   acc: 88.57% -> 80.00%              
client [41] (test)  loss: 0.2059 -> 0.0262   acc: 92.23% -> 100.00%            
client [7] (test)  loss: 0.4726 -> 0.4990   acc: 88.51% -> 89.66%              
client [37] (test)  loss: 0.0686 -> 0.0493   acc: 97.75% -> 98.60%             
client [45] (test)  loss: 0.9436 -> 0.0544   acc: 59.47% -> 98.68%             
client [47] (test)  loss: 0.8007 -> 0.0250   acc: 54.67% -> 98.67%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.0939 -> 0.1046   acc: 97.30% -> 97.30%             
client [11] (test)  loss: 0.2684 -> 0.2308   acc: 95.74% -> 95.74%             
client [37] (test)  loss: 0.0562 -> 0.0499   acc: 98.17% -> 98.60%             
client [41] (test)  loss: 0.0905 -> 0.0282   acc: 98.06% -> 99.03%             
client [95] (test)  loss: 0.1245 -> 0.1014   acc: 96.43% -> 98.81%             
client [53] (test)  loss: 0.3721 -> 0.1076   acc: 86.96% -> 97.10%             
client [22] (test)  loss: 0.5152 -> 0.3815   acc: 86.44% -> 89.83%             
client [25] (test)  loss: 0.5526 -> 0.4600   acc: 85.06% -> 89.66%             
client [69] (test)  loss: 0.0793 -> 0.2531   acc: 97.19% -> 94.88%             
client [46] (test)  loss: 0.1527 -> 0.1552   acc: 91.14% -> 96.20%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.0452 -> 0.0270   acc: 98.67% -> 98.67%             
client [69] (test)  loss: 0.0780 -> 0.1801   acc: 97.70% -> 96.16%             
client [82] (test)  loss: 0.0304 -> 0.0048   acc: 98.85% -> 100.00%            
client [45] (test)  loss: 0.1203 -> 0.0596   acc: 96.48% -> 97.80%             
client [7] (test)  loss: 0.4846 -> 0.5274   acc: 89.66% -> 88.51%              
client [50] (test)  loss: 0.2082 -> 0.1887   acc: 94.17% -> 95.83%             
client [35] (test)  loss: 0.0800 -> 0.0433   acc: 92.86% -> 96.43%             
client [24] (test)  loss: 0.0574 -> 0.0321   acc: 97.58% -> 98.39%             
client [15] (test)  loss: 0.0778 -> 0.0579   acc: 97.67% -> 98.84%             
client [58] (test)  loss: 0.0623 -> 0.0332   acc: 100.00% -> 100.00%           
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.1028 -> 0.1049   acc: 97.44% -> 97.44%             
client [76] (test)  loss: 0.0435 -> 0.0310   acc: 100.00% -> 100.00%           
client [67] (test)  loss: 0.0840 -> 0.0283   acc: 98.90% -> 98.90%             
client [37] (test)  loss: 0.0502 -> 0.0507   acc: 98.31% -> 98.60%             
client [58] (test)  loss: 0.0552 -> 0.0333   acc: 100.00% -> 100.00%           
client [64] (test)  loss: 0.1535 -> 0.1391   acc: 96.49% -> 96.49%             
client [77] (test)  loss: 0.2101 -> 0.2828   acc: 94.78% -> 89.57%             
client [55] (test)  loss: 0.2101 -> 0.2014   acc: 89.80% -> 85.71%             
client [12] (test)  loss: 0.0930 -> 0.0069   acc: 96.91% -> 100.00%            
client [89] (test)  loss: 0.2413 -> 0.2209   acc: 92.11% -> 93.86%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.3716 -> 0.3702   acc: 92.68% -> 87.80%             
client [51] (test)  loss: 0.1855 -> 0.1673   acc: 95.24% -> 95.24%             
client [8] (test)  loss: 0.1385 -> 0.1413   acc: 94.52% -> 94.52%              
client [18] (test)  loss: 0.2033 -> 0.2144   acc: 92.86% -> 92.86%             
client [94] (test)  loss: 0.2760 -> 0.2809   acc: 88.64% -> 90.91%             
client [81] (test)  loss: 0.6564 -> 0.8441   acc: 73.91% -> 78.26%             
client [3] (test)  loss: 0.0639 -> 0.0275   acc: 98.37% -> 98.37%              
client [11] (test)  loss: 0.2414 -> 0.2238   acc: 95.74% -> 95.74%             
client [95] (test)  loss: 0.1031 -> 0.0954   acc: 97.62% -> 98.81%             
client [67] (test)  loss: 0.0746 -> 0.0280   acc: 98.90% -> 98.90%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.4555 -> 0.4847   acc: 79.31% -> 82.76%             
client [79] (test)  loss: 0.0434 -> 0.0400   acc: 98.99% -> 98.99%             
client [58] (test)  loss: 0.0492 -> 0.0336   acc: 100.00% -> 100.00%           
client [88] (test)  loss: 0.4095 -> 0.4077   acc: 86.46% -> 84.38%             
client [46] (test)  loss: 0.1013 -> 0.1259   acc: 96.20% -> 96.20%             
client [11] (test)  loss: 0.2384 -> 0.2236   acc: 95.74% -> 95.74%             
client [55] (test)  loss: 0.1773 -> 0.2152   acc: 89.80% -> 85.71%             
client [13] (test)  loss: 0.1828 -> 0.1775   acc: 93.62% -> 91.49%             
client [31] (test)  loss: 0.1895 -> 0.0576   acc: 93.33% -> 97.78%             
client [75] (test)  loss: 0.1574 -> 0.1470   acc: 94.85% -> 93.81%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.2827 -> 0.2204   acc: 92.74% -> 94.35%             
client [7] (test)  loss: 0.4602 -> 0.5197   acc: 89.66% -> 88.51%              
client [57] (test)  loss: 0.1077 -> 0.1477   acc: 96.61% -> 96.61%             
client [13] (test)  loss: 0.1692 -> 0.1826   acc: 93.62% -> 93.62%             
client [43] (test)  loss: 0.0684 -> 0.0185   acc: 100.00% -> 100.00%           
client [91] (test)  loss: 0.4044 -> 0.4413   acc: 83.33% -> 84.72%             
client [10] (test)  loss: 0.1616 -> 0.1484   acc: 93.68% -> 93.68%             
client [64] (test)  loss: 0.1459 -> 0.1347   acc: 96.49% -> 96.49%             
client [82] (test)  loss: 0.0130 -> 0.0029   acc: 98.85% -> 100.00%            
client [22] (test)  loss: 0.4110 -> 0.3976   acc: 84.75% -> 88.14%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.0398 -> 0.0209   acc: 100.00% -> 99.13%            
client [23] (test)  loss: 0.2668 -> 0.3136   acc: 88.89% -> 88.89%             
client [88] (test)  loss: 0.4106 -> 0.4055   acc: 86.46% -> 84.38%             
client [98] (test)  loss: 0.0374 -> 0.0253   acc: 100.00% -> 98.65%            
client [79] (test)  loss: 0.0401 -> 0.0397   acc: 98.99% -> 98.99%             
client [21] (test)  loss: 0.4229 -> 0.5255   acc: 79.31% -> 86.21%             
client [92] (test)  loss: 0.0270 -> 0.0004   acc: 99.20% -> 100.00%            
client [56] (test)  loss: 0.1688 -> 0.2664   acc: 95.35% -> 88.37%             
client [5] (test)  loss: 0.9161 -> 0.7527   acc: 74.29% -> 71.43%              
client [52] (test)  loss: 0.3417 -> 0.3801   acc: 82.05% -> 79.49%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.7175 -> 0.0000', 'accuracy': '73.86% -> 0.00%'},          
    200: {'loss': '0.1450 -> 0.0000', 'accuracy': '95.66% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(14.56%) at epoch: 1                                     
pFedSim achieved 20.0%(28.39%) at epoch: 2                                     
pFedSim achieved 40.0%(40.06%) at epoch: 9                                     
pFedSim achieved 70.0%(74.46%) at epoch: 16                                    
pFedSim achieved 80.0%(83.05%) at epoch: 62                                    
pFedSim achieved 90.0%(90.34%) at epoch: 106                                   
Convergence (test_after):                                                      
pFedSim achieved 60.0%(61.87%) at epoch: 0                                     
pFedSim achieved 70.0%(72.22%) at epoch: 2                                     
pFedSim achieved 80.0%(84.08%) at epoch: 5                                     
pFedSim achieved 90.0%(90.21%) at epoch: 15                                    
