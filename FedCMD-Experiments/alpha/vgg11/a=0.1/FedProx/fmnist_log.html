==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5615 -> 0.0073   acc: 80.28% -> 100.00%            
client [81] (test)  loss: 1.0583 -> 0.2123   acc: 61.82% -> 93.64%             
client [21] (test)  loss: 1.5188 -> 0.4699   acc: 46.38% -> 82.85%             
client [68] (test)  loss: 0.2930 -> 0.1417   acc: 91.99% -> 95.47%             
client [93] (test)  loss: 1.8649 -> 0.1559   acc: 23.20% -> 97.60%             
client [31] (test)  loss: 0.8051 -> 0.1492   acc: 75.00% -> 95.00%             
client [20] (test)  loss: 0.7465 -> 0.0678   acc: 75.83% -> 98.00%             
client [59] (test)  loss: 0.9533 -> 0.4400   acc: 67.74% -> 85.16%             
client [48] (test)  loss: 2.0777 -> 0.0811   acc: 29.38% -> 98.12%             
client [34] (test)  loss: 0.4087 -> 0.2654   acc: 89.71% -> 92.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.8485 -> 0.2769   acc: 68.27% -> 91.47%             
client [99] (test)  loss: 2.0787 -> 0.0761   acc: 24.43% -> 98.30%             
client [67] (test)  loss: 2.9504 -> 0.1479   acc: 10.42% -> 95.24%             
client [0] (test)  loss: 0.6707 -> 0.6071   acc: 80.37% -> 80.37%              
client [76] (test)  loss: 0.4972 -> 0.1881   acc: 81.58% -> 94.74%             
client [41] (test)  loss: 0.4979 -> 0.3397   acc: 85.88% -> 89.38%             
client [62] (test)  loss: 1.3527 -> 0.2436   acc: 47.62% -> 92.86%             
client [2] (test)  loss: 0.9117 -> 0.0005   acc: 64.21% -> 100.00%             
client [14] (test)  loss: 2.2502 -> 0.1049   acc: 20.54% -> 97.45%             
client [46] (test)  loss: 3.1013 -> 0.3208   acc: 7.05% -> 91.19%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8827 -> 0.4579   acc: 68.39% -> 83.68%             
client [68] (test)  loss: 0.3781 -> 0.1371   acc: 85.71% -> 95.82%             
client [57] (test)  loss: 1.0347 -> 0.0399   acc: 46.62% -> 99.25%             
client [17] (test)  loss: 0.7706 -> 0.1947   acc: 75.14% -> 93.37%             
client [54] (test)  loss: 0.5034 -> 0.2016   acc: 79.27% -> 89.12%             
client [23] (test)  loss: 0.3845 -> 0.1382   acc: 84.21% -> 96.62%             
client [35] (test)  loss: 0.7354 -> 0.1709   acc: 73.94% -> 96.36%             
client [59] (test)  loss: 0.5952 -> 0.3265   acc: 77.42% -> 88.71%             
client [31] (test)  loss: 0.4055 -> 0.1348   acc: 86.11% -> 95.56%             
client [9] (test)  loss: 0.3760 -> 0.0463   acc: 89.21% -> 98.34%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4609 -> 0.1449   acc: 84.41% -> 95.29%             
client [33] (test)  loss: 0.3086 -> 0.0903   acc: 88.36% -> 97.49%             
client [16] (test)  loss: 0.7580 -> 0.0737   acc: 73.78% -> 97.90%             
client [44] (test)  loss: 0.5889 -> 0.1537   acc: 78.75% -> 94.87%             
client [8] (test)  loss: 0.8481 -> 0.0005   acc: 71.62% -> 100.00%             
client [31] (test)  loss: 0.4953 -> 0.1272   acc: 86.11% -> 95.56%             
client [47] (test)  loss: 0.3143 -> 0.0223   acc: 87.68% -> 99.63%             
client [36] (test)  loss: 0.1117 -> 0.0063   acc: 95.95% -> 99.75%             
client [20] (test)  loss: 0.8672 -> 0.0348   acc: 67.00% -> 99.17%             
client [56] (test)  loss: 0.8287 -> 0.3580   acc: 73.58% -> 90.24%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6983 -> 0.1073   acc: 80.62% -> 96.54%              
client [60] (test)  loss: 1.4570 -> 0.1166   acc: 50.87% -> 97.87%             
client [28] (test)  loss: 0.3182 -> 0.0859   acc: 92.86% -> 97.32%             
client [25] (test)  loss: 0.5856 -> 0.0757   acc: 80.84% -> 98.26%             
client [58] (test)  loss: 0.8249 -> 0.1001   acc: 72.99% -> 96.53%             
client [44] (test)  loss: 1.0090 -> 0.1322   acc: 63.74% -> 95.97%             
client [39] (test)  loss: 0.5476 -> 0.1402   acc: 86.11% -> 94.44%             
client [29] (test)  loss: 1.2884 -> 0.3393   acc: 60.73% -> 89.95%             
client [3] (test)  loss: 1.2113 -> 0.2563   acc: 53.44% -> 91.30%              
client [84] (test)  loss: 2.0494 -> 0.0153   acc: 42.20% -> 99.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4477 -> 0.3514   acc: 84.06% -> 87.20%             
client [84] (test)  loss: 0.9999 -> 0.0315   acc: 58.72% -> 99.08%             
client [10] (test)  loss: 0.1654 -> 0.0864   acc: 96.38% -> 97.83%             
client [36] (test)  loss: 0.1114 -> 0.0056   acc: 96.07% -> 99.75%             
client [65] (test)  loss: 1.5358 -> 0.1465   acc: 36.90% -> 95.24%             
client [81] (test)  loss: 0.4906 -> 0.1008   acc: 83.64% -> 96.36%             
client [79] (test)  loss: 0.8065 -> 0.3553   acc: 70.02% -> 86.00%             
client [42] (test)  loss: 0.7442 -> 0.0299   acc: 75.67% -> 98.99%             
client [11] (test)  loss: 0.4790 -> 0.4219   acc: 83.33% -> 85.56%             
client [96] (test)  loss: 0.4331 -> 0.2117   acc: 83.99% -> 94.38%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8840 -> 0.0003   acc: 77.93% -> 100.00%             
client [53] (test)  loss: 0.1912 -> 0.0399   acc: 94.64% -> 99.39%             
client [52] (test)  loss: 1.0049 -> 0.2910   acc: 58.91% -> 89.15%             
client [42] (test)  loss: 0.4247 -> 0.0263   acc: 85.25% -> 99.11%             
client [69] (test)  loss: 0.4178 -> 0.2363   acc: 87.47% -> 93.07%             
client [59] (test)  loss: 0.4909 -> 0.2776   acc: 79.68% -> 89.35%             
client [7] (test)  loss: 0.4399 -> 0.0370   acc: 83.98% -> 98.90%              
client [26] (test)  loss: 1.0381 -> 0.0179   acc: 65.32% -> 99.68%             
client [49] (test)  loss: 0.4845 -> 0.0107   acc: 80.25% -> 99.58%             
client [98] (test)  loss: 0.4486 -> 0.4763   acc: 82.00% -> 69.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6816 -> 0.3864   acc: 68.00% -> 80.00%             
client [47] (test)  loss: 0.5566 -> 0.0235   acc: 76.84% -> 99.45%             
client [21] (test)  loss: 0.3619 -> 0.3215   acc: 86.23% -> 88.89%             
client [77] (test)  loss: 0.2261 -> 0.0108   acc: 94.93% -> 99.72%             
client [95] (test)  loss: 0.5271 -> 0.1881   acc: 78.95% -> 93.98%             
client [91] (test)  loss: 0.8362 -> 0.1029   acc: 62.50% -> 93.75%             
client [14] (test)  loss: 0.1816 -> 0.1164   acc: 95.57% -> 97.72%             
client [99] (test)  loss: 0.0980 -> 0.0518   acc: 97.73% -> 97.73%             
client [20] (test)  loss: 1.7684 -> 0.0274   acc: 16.00% -> 99.50%             
client [39] (test)  loss: 0.2243 -> 0.1811   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8351 -> 0.2727   acc: 71.32% -> 90.70%             
client [62] (test)  loss: 0.6053 -> 0.2025   acc: 80.95% -> 92.86%             
client [71] (test)  loss: 0.1208 -> 0.0497   acc: 96.93% -> 98.19%             
client [97] (test)  loss: 0.1863 -> 0.0437   acc: 93.92% -> 99.34%             
client [30] (test)  loss: 0.2898 -> 0.1444   acc: 91.76% -> 95.88%             
client [88] (test)  loss: 1.3496 -> 0.7818   acc: 51.38% -> 66.85%             
client [60] (test)  loss: 0.9596 -> 0.0984   acc: 65.96% -> 97.87%             
client [82] (test)  loss: 1.4934 -> 0.0298   acc: 44.87% -> 99.36%             
client [91] (test)  loss: 0.8273 -> 0.0365   acc: 71.88% -> 100.00%            
client [57] (test)  loss: 1.3281 -> 0.0471   acc: 49.81% -> 99.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5178 -> 0.1096   acc: 83.33% -> 95.00%             
client [15] (test)  loss: 0.7422 -> 0.2126   acc: 71.34% -> 89.17%             
client [71] (test)  loss: 0.1808 -> 0.0441   acc: 93.85% -> 98.37%             
client [97] (test)  loss: 0.4952 -> 0.0430   acc: 83.42% -> 99.34%             
client [53] (test)  loss: 0.1945 -> 0.0389   acc: 94.54% -> 99.39%             
client [77] (test)  loss: 0.0500 -> 0.0087   acc: 98.87% -> 99.44%             
client [76] (test)  loss: 0.2859 -> 0.1524   acc: 89.47% -> 94.74%             
client [79] (test)  loss: 0.7295 -> 0.3255   acc: 71.74% -> 87.96%             
client [28] (test)  loss: 0.4707 -> 0.0588   acc: 82.14% -> 99.11%             
client [99] (test)  loss: 0.8828 -> 0.0521   acc: 63.07% -> 98.01%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6498 -> 0.0437   acc: 77.01% -> 99.34%             
client [86] (test)  loss: 0.2673 -> 0.0809   acc: 89.47% -> 96.49%             
client [34] (test)  loss: 0.2989 -> 0.2213   acc: 94.12% -> 95.59%             
client [73] (test)  loss: 0.7746 -> 0.0394   acc: 75.00% -> 99.29%             
client [5] (test)  loss: 0.6209 -> 0.0411   acc: 79.04% -> 98.69%              
client [96] (test)  loss: 0.6672 -> 0.2058   acc: 77.53% -> 94.38%             
client [22] (test)  loss: 0.5416 -> 0.0634   acc: 78.77% -> 96.70%             
client [60] (test)  loss: 0.6468 -> 0.0929   acc: 72.92% -> 97.87%             
client [66] (test)  loss: 1.1918 -> 0.0006   acc: 64.97% -> 100.00%            
client [83] (test)  loss: 0.6906 -> 0.0248   acc: 73.78% -> 99.37%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1920 -> 0.1752   acc: 92.11% -> 94.74%             
client [65] (test)  loss: 1.2113 -> 0.1213   acc: 51.19% -> 95.24%             
client [95] (test)  loss: 0.2936 -> 0.1756   acc: 90.23% -> 94.74%             
client [17] (test)  loss: 0.4586 -> 0.2042   acc: 87.57% -> 93.09%             
client [8] (test)  loss: 0.5657 -> 0.0005   acc: 85.59% -> 100.00%             
client [35] (test)  loss: 0.4186 -> 0.1242   acc: 89.09% -> 96.97%             
client [98] (test)  loss: 0.6610 -> 0.4551   acc: 74.00% -> 72.00%             
client [53] (test)  loss: 0.1204 -> 0.0375   acc: 96.97% -> 99.39%             
client [43] (test)  loss: 1.3714 -> 0.2215   acc: 54.07% -> 91.85%             
client [64] (test)  loss: 0.2458 -> 0.1514   acc: 94.41% -> 96.18%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2840 -> 0.2807   acc: 89.61% -> 91.06%             
client [88] (test)  loss: 1.0260 -> 1.5194   acc: 59.67% -> 52.49%             
client [38] (test)  loss: 1.0491 -> 0.4296   acc: 68.48% -> 86.67%             
client [3] (test)  loss: 0.4494 -> 0.1687   acc: 84.42% -> 94.75%              
client [5] (test)  loss: 0.5468 -> 0.0465   acc: 76.86% -> 98.91%              
client [41] (test)  loss: 0.2590 -> 0.1710   acc: 92.10% -> 94.82%             
client [7] (test)  loss: 0.3828 -> 0.0344   acc: 86.74% -> 98.53%              
client [37] (test)  loss: 0.4844 -> 0.1390   acc: 85.05% -> 95.36%             
client [45] (test)  loss: 0.4271 -> 0.2603   acc: 83.33% -> 91.03%             
client [47] (test)  loss: 0.4881 -> 0.0208   acc: 83.64% -> 99.45%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.1359 -> 0.0643   acc: 39.51% -> 97.90%             
client [11] (test)  loss: 2.9867 -> 0.4094   acc: 14.44% -> 84.89%             
client [37] (test)  loss: 1.9328 -> 0.1515   acc: 25.77% -> 95.36%             
client [41] (test)  loss: 0.9749 -> 0.1723   acc: 71.24% -> 94.95%             
client [95] (test)  loss: 0.6574 -> 0.1719   acc: 76.69% -> 94.74%             
client [53] (test)  loss: 0.2583 -> 0.0388   acc: 92.52% -> 99.39%             
client [22] (test)  loss: 2.3901 -> 0.0549   acc: 28.77% -> 97.64%             
client [25] (test)  loss: 0.4125 -> 0.0533   acc: 85.71% -> 98.26%             
client [69] (test)  loss: 0.6326 -> 0.2253   acc: 80.80% -> 93.07%             
client [46] (test)  loss: 0.3253 -> 0.3206   acc: 90.31% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2266 -> 0.0227   acc: 93.20% -> 99.45%             
client [69] (test)  loss: 0.6924 -> 0.2233   acc: 79.73% -> 92.80%             
client [82] (test)  loss: 0.5067 -> 0.0262   acc: 81.09% -> 99.52%             
client [45] (test)  loss: 0.3923 -> 0.2623   acc: 85.90% -> 89.74%             
client [7] (test)  loss: 0.2319 -> 0.0391   acc: 91.53% -> 98.71%              
client [50] (test)  loss: 0.8954 -> 0.0006   acc: 61.66% -> 100.00%            
client [35] (test)  loss: 0.6859 -> 0.1350   acc: 73.94% -> 96.97%             
client [24] (test)  loss: 0.6973 -> 0.4334   acc: 75.65% -> 85.49%             
client [15] (test)  loss: 0.6838 -> 0.2066   acc: 76.01% -> 89.60%             
client [58] (test)  loss: 0.2711 -> 0.0872   acc: 90.51% -> 97.08%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4661 -> 0.0746   acc: 89.38% -> 98.12%             
client [76] (test)  loss: 0.2744 -> 0.1318   acc: 89.47% -> 94.74%             
client [67] (test)  loss: 1.7414 -> 0.1021   acc: 39.58% -> 96.88%             
client [37] (test)  loss: 0.3153 -> 0.1129   acc: 92.27% -> 95.88%             
client [58] (test)  loss: 0.1837 -> 0.0903   acc: 94.53% -> 97.08%             
client [64] (test)  loss: 0.2529 -> 0.1546   acc: 94.12% -> 96.18%             
client [77] (test)  loss: 0.1070 -> 0.0138   acc: 97.18% -> 99.44%             
client [55] (test)  loss: 0.1443 -> 0.0070   acc: 96.65% -> 99.62%             
client [12] (test)  loss: 1.8586 -> 0.3318   acc: 35.32% -> 88.57%             
client [89] (test)  loss: 1.3503 -> 0.5235   acc: 54.76% -> 90.48%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6287 -> 0.0269   acc: 75.23% -> 99.08%             
client [51] (test)  loss: 0.6828 -> 0.0186   acc: 78.72% -> 99.74%             
client [8] (test)  loss: 0.9234 -> 0.0003   acc: 73.65% -> 100.00%             
client [18] (test)  loss: 0.1630 -> 0.0041   acc: 94.90% -> 99.76%             
client [94] (test)  loss: 0.4336 -> 0.2544   acc: 86.52% -> 94.33%             
client [81] (test)  loss: 0.5855 -> 0.0860   acc: 80.91% -> 97.27%             
client [3] (test)  loss: 0.5502 -> 0.1850   acc: 80.25% -> 94.20%              
client [11] (test)  loss: 0.7961 -> 0.3587   acc: 75.78% -> 87.78%             
client [95] (test)  loss: 0.6384 -> 0.1641   acc: 84.21% -> 96.24%             
client [67] (test)  loss: 1.2391 -> 0.0938   acc: 54.02% -> 97.17%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2825 -> 0.2645   acc: 89.61% -> 92.03%             
client [79] (test)  loss: 0.8492 -> 0.3090   acc: 72.73% -> 89.19%             
client [58] (test)  loss: 0.1415 -> 0.0850   acc: 95.99% -> 97.45%             
client [88] (test)  loss: 1.1605 -> 0.4988   acc: 59.12% -> 77.35%             
client [46] (test)  loss: 1.5548 -> 0.3365   acc: 44.49% -> 91.19%             
client [11] (test)  loss: 0.6116 -> 0.3530   acc: 79.78% -> 87.56%             
client [55] (test)  loss: 0.1069 -> 0.0062   acc: 97.80% -> 99.71%             
client [13] (test)  loss: 0.6223 -> 0.0011   acc: 83.88% -> 100.00%            
client [31] (test)  loss: 0.3527 -> 0.1084   acc: 86.67% -> 95.00%             
client [75] (test)  loss: 0.6753 -> 0.2894   acc: 77.72% -> 89.59%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4529 -> 0.3031   acc: 81.89% -> 90.55%             
client [7] (test)  loss: 0.3177 -> 0.0421   acc: 90.42% -> 98.71%              
client [57] (test)  loss: 0.5952 -> 0.0491   acc: 74.44% -> 99.25%             
client [13] (test)  loss: 0.6736 -> 0.0014   acc: 77.60% -> 100.00%            
client [43] (test)  loss: 1.3568 -> 0.1377   acc: 63.70% -> 97.04%             
client [91] (test)  loss: 0.2376 -> 0.0954   acc: 93.75% -> 96.88%             
client [10] (test)  loss: 0.1811 -> 0.1138   acc: 96.38% -> 97.10%             
client [64] (test)  loss: 0.3277 -> 0.1622   acc: 90.59% -> 95.59%             
client [82] (test)  loss: 0.6317 -> 0.0310   acc: 74.84% -> 99.52%             
client [22] (test)  loss: 0.7230 -> 0.0790   acc: 71.70% -> 97.64%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.2532 -> 0.0196   acc: 58.50% -> 99.83%             
client [23] (test)  loss: 0.4436 -> 0.1057   acc: 82.33% -> 96.24%             
client [88] (test)  loss: 0.8599 -> 0.4184   acc: 70.72% -> 88.40%             
client [98] (test)  loss: 1.9612 -> 0.3284   acc: 41.00% -> 88.00%             
client [79] (test)  loss: 0.9132 -> 0.2970   acc: 69.53% -> 88.94%             
client [21] (test)  loss: 0.2377 -> 0.2450   acc: 91.30% -> 92.03%             
client [92] (test)  loss: 0.2386 -> 0.1204   acc: 93.15% -> 96.23%             
client [56] (test)  loss: 1.6306 -> 0.3243   acc: 40.65% -> 90.65%             
client [5] (test)  loss: 0.3967 -> 0.0478   acc: 87.12% -> 98.69%              
client [52] (test)  loss: 0.4742 -> 0.2827   acc: 88.37% -> 89.92%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.6250 -> 0.0000', 'accuracy': '77.35% -> 0.00%'},          
    200: {'loss': '0.7092 -> 0.0000', 'accuracy': '76.06% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(27.37%) at epoch: 2                                     
FedProx achieved 30.0%(36.44%) at epoch: 3                                     
FedProx achieved 40.0%(41.67%) at epoch: 4                                     
FedProx achieved 50.0%(53.06%) at epoch: 5                                     
FedProx achieved 60.0%(66.92%) at epoch: 9                                     
FedProx achieved 80.0%(80.50%) at epoch: 11                                    
FedProx achieved 90.0%(91.29%) at epoch: 157                                   
Convergence (test_after):                                                      
FedProx achieved 90.0%(90.79%) at epoch: 0                                     
