==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.5361 -> 0.7936   acc: 73.04% -> 75.65%             
client [81] (test)  loss: 2.3289 -> 1.4951   acc: 30.43% -> 26.09%             
client [21] (test)  loss: 2.8949 -> 1.3075   acc: 0.00% -> 62.07%              
client [68] (test)  loss: 2.2611 -> 0.3768   acc: 0.00% -> 89.80%              
client [93] (test)  loss: 2.2633 -> 0.5660   acc: 1.10% -> 82.42%              
client [31] (test)  loss: 3.0724 -> 0.4885   acc: 0.00% -> 86.67%              
client [20] (test)  loss: 1.5199 -> 0.4444   acc: 66.09% -> 85.22%             
client [59] (test)  loss: 1.4495 -> 0.0445   acc: 81.97% -> 100.00%            
client [48] (test)  loss: 1.0812 -> 0.4771   acc: 82.05% -> 84.62%             
client [34] (test)  loss: 2.0947 -> 0.9319   acc: 28.46% -> 66.67%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.4547 -> 0.1931   acc: 10.74% -> 93.35%             
client [99] (test)  loss: 4.0663 -> 0.2571   acc: 0.78% -> 95.31%              
client [67] (test)  loss: 0.6938 -> 0.1682   acc: 80.22% -> 97.80%             
client [0] (test)  loss: 1.7770 -> 0.9229   acc: 35.59% -> 49.15%              
client [76] (test)  loss: 1.2479 -> 0.2728   acc: 55.56% -> 91.67%             
client [41] (test)  loss: 2.4950 -> 0.5364   acc: 2.91% -> 87.38%              
client [62] (test)  loss: 1.5935 -> 0.0058   acc: 53.02% -> 100.00%            
client [2] (test)  loss: 2.0230 -> 0.2602   acc: 6.85% -> 93.84%               
client [14] (test)  loss: 1.6711 -> 1.0041   acc: 57.75% -> 61.97%             
client [46] (test)  loss: 2.9378 -> 0.5899   acc: 7.59% -> 84.81%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3966 -> 0.1277   acc: 89.52% -> 95.97%             
client [68] (test)  loss: 0.5851 -> 0.2683   acc: 86.22% -> 89.80%             
client [57] (test)  loss: 0.4634 -> 0.1976   acc: 88.14% -> 94.92%             
client [17] (test)  loss: 1.5738 -> 0.6485   acc: 43.62% -> 77.66%             
client [54] (test)  loss: 1.5972 -> 0.7407   acc: 41.74% -> 76.52%             
client [23] (test)  loss: 1.5868 -> 0.6145   acc: 46.30% -> 77.78%             
client [35] (test)  loss: 1.4333 -> 0.1296   acc: 39.29% -> 96.43%             
client [59] (test)  loss: 0.2122 -> 0.0385   acc: 91.80% -> 99.18%             
client [31] (test)  loss: 1.5685 -> 0.2417   acc: 26.67% -> 94.44%             
client [9] (test)  loss: 0.9653 -> 0.1199   acc: 80.95% -> 95.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6247 -> 0.1666   acc: 64.91% -> 96.49%             
client [33] (test)  loss: 1.4154 -> 0.4071   acc: 54.24% -> 89.83%             
client [16] (test)  loss: 0.9820 -> 0.3270   acc: 62.16% -> 83.78%             
client [44] (test)  loss: 0.7990 -> 0.2289   acc: 76.81% -> 94.69%             
client [8] (test)  loss: 1.0755 -> 0.3599   acc: 53.42% -> 90.41%              
client [31] (test)  loss: 1.1324 -> 0.1758   acc: 61.11% -> 95.56%             
client [47] (test)  loss: 2.9660 -> 0.1608   acc: 20.00% -> 93.33%             
client [36] (test)  loss: 0.9781 -> 0.1643   acc: 68.00% -> 93.71%             
client [20] (test)  loss: 2.9531 -> 0.1319   acc: 8.70% -> 97.39%              
client [56] (test)  loss: 1.0695 -> 0.6606   acc: 74.42% -> 88.37%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7066 -> 0.1038   acc: 65.38% -> 96.15%              
client [60] (test)  loss: 0.5480 -> 0.1964   acc: 82.22% -> 91.11%             
client [28] (test)  loss: 0.6960 -> 0.4857   acc: 76.00% -> 88.00%             
client [25] (test)  loss: 1.0065 -> 0.5798   acc: 65.52% -> 83.91%             
client [58] (test)  loss: 3.2557 -> 0.0646   acc: 3.70% -> 96.30%              
client [44] (test)  loss: 2.6878 -> 0.1353   acc: 14.49% -> 96.14%             
client [39] (test)  loss: 1.6506 -> 0.4380   acc: 44.80% -> 79.20%             
client [29] (test)  loss: 1.9406 -> 0.4796   acc: 26.79% -> 91.07%             
client [3] (test)  loss: 0.4529 -> 0.0973   acc: 86.99% -> 97.56%              
client [84] (test)  loss: 1.4853 -> 0.6704   acc: 58.54% -> 78.05%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.5979 -> 0.7835   acc: 24.14% -> 68.97%             
client [84] (test)  loss: 0.8995 -> 0.5437   acc: 70.73% -> 82.93%             
client [10] (test)  loss: 0.2999 -> 0.1518   acc: 89.47% -> 92.63%             
client [36] (test)  loss: 0.3095 -> 0.1680   acc: 92.00% -> 94.86%             
client [65] (test)  loss: 0.6174 -> 0.1616   acc: 79.17% -> 95.83%             
client [81] (test)  loss: 0.8509 -> 0.8271   acc: 69.57% -> 65.22%             
client [79] (test)  loss: 1.4169 -> 0.0517   acc: 32.89% -> 99.33%             
client [42] (test)  loss: 1.2836 -> 0.1889   acc: 40.38% -> 94.34%             
client [11] (test)  loss: 0.8509 -> 0.4729   acc: 72.34% -> 80.85%             
client [96] (test)  loss: 0.3460 -> 0.1157   acc: 86.76% -> 97.06%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8642 -> 0.1986   acc: 61.64% -> 95.89%              
client [53] (test)  loss: 0.4728 -> 0.1283   acc: 86.96% -> 97.10%             
client [52] (test)  loss: 0.7308 -> 0.4468   acc: 71.79% -> 79.49%             
client [42] (test)  loss: 1.9991 -> 0.1763   acc: 24.91% -> 94.72%             
client [69] (test)  loss: 0.5700 -> 0.1997   acc: 86.96% -> 95.40%             
client [59] (test)  loss: 0.2661 -> 0.0252   acc: 91.80% -> 99.18%             
client [7] (test)  loss: 1.4279 -> 0.5166   acc: 52.87% -> 83.91%              
client [26] (test)  loss: 1.1254 -> 0.0281   acc: 58.62% -> 99.31%             
client [49] (test)  loss: 0.2592 -> 0.0719   acc: 93.55% -> 97.60%             
client [98] (test)  loss: 0.2986 -> 0.0783   acc: 90.54% -> 98.65%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2764 -> 0.0770   acc: 60.81% -> 98.65%             
client [47] (test)  loss: 1.7714 -> 0.0421   acc: 26.67% -> 100.00%            
client [21] (test)  loss: 1.7627 -> 0.6419   acc: 48.28% -> 68.97%             
client [77] (test)  loss: 1.6899 -> 0.3007   acc: 25.22% -> 88.70%             
client [95] (test)  loss: 1.9539 -> 0.1233   acc: 15.48% -> 96.43%             
client [91] (test)  loss: 0.8822 -> 0.5163   acc: 66.67% -> 79.86%             
client [14] (test)  loss: 2.3340 -> 0.5755   acc: 14.08% -> 76.06%             
client [99] (test)  loss: 0.5444 -> 0.0774   acc: 82.81% -> 97.66%             
client [20] (test)  loss: 1.8282 -> 0.0358   acc: 26.96% -> 98.26%             
client [39] (test)  loss: 1.0049 -> 0.3108   acc: 69.60% -> 88.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7439 -> 0.4804   acc: 66.67% -> 79.49%             
client [62] (test)  loss: 0.1965 -> 0.0113   acc: 93.96% -> 99.33%             
client [71] (test)  loss: 0.1630 -> 0.0433   acc: 95.93% -> 98.37%             
client [97] (test)  loss: 0.9335 -> 0.3183   acc: 66.04% -> 89.94%             
client [30] (test)  loss: 0.8637 -> 0.0984   acc: 67.38% -> 97.86%             
client [88] (test)  loss: 0.4706 -> 0.4165   acc: 85.42% -> 85.42%             
client [60] (test)  loss: 0.4332 -> 0.2336   acc: 88.89% -> 91.11%             
client [82] (test)  loss: 0.0473 -> 0.0076   acc: 98.28% -> 100.00%            
client [91] (test)  loss: 0.7688 -> 0.4578   acc: 68.75% -> 84.03%             
client [57] (test)  loss: 0.1705 -> 0.1273   acc: 95.76% -> 96.61%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2745 -> 0.0690   acc: 91.11% -> 97.78%             
client [15] (test)  loss: 0.1979 -> 0.0789   acc: 90.70% -> 97.67%             
client [71] (test)  loss: 0.6069 -> 0.0289   acc: 79.67% -> 99.19%             
client [97] (test)  loss: 0.8142 -> 0.3060   acc: 62.89% -> 90.57%             
client [53] (test)  loss: 1.3226 -> 0.1072   acc: 49.28% -> 97.10%             
client [77] (test)  loss: 1.0023 -> 0.2524   acc: 62.61% -> 90.43%             
client [76] (test)  loss: 0.1866 -> 0.0476   acc: 91.67% -> 100.00%            
client [79] (test)  loss: 1.4303 -> 0.0390   acc: 43.96% -> 98.99%             
client [28] (test)  loss: 0.6796 -> 0.5331   acc: 60.00% -> 84.00%             
client [99] (test)  loss: 0.6680 -> 0.0733   acc: 78.12% -> 97.66%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.8577 -> 0.2800   acc: 64.78% -> 89.94%             
client [86] (test)  loss: 0.5882 -> 0.3341   acc: 85.63% -> 89.66%             
client [34] (test)  loss: 0.6048 -> 0.4681   acc: 79.67% -> 86.18%             
client [73] (test)  loss: 0.3044 -> 0.1268   acc: 95.24% -> 95.24%             
client [5] (test)  loss: 0.8003 -> 1.1834   acc: 65.71% -> 42.86%              
client [96] (test)  loss: 0.2762 -> 0.0873   acc: 88.24% -> 97.06%             
client [22] (test)  loss: 1.2939 -> 0.3810   acc: 54.24% -> 86.44%             
client [60] (test)  loss: 0.3854 -> 0.2256   acc: 91.11% -> 91.11%             
client [66] (test)  loss: 0.2976 -> 0.2565   acc: 94.29% -> 94.29%             
client [83] (test)  loss: 0.2421 -> 0.0023   acc: 95.38% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1856 -> 0.0353   acc: 88.89% -> 100.00%            
client [65] (test)  loss: 0.7432 -> 0.1005   acc: 77.50% -> 96.67%             
client [95] (test)  loss: 1.2886 -> 0.1216   acc: 53.57% -> 98.81%             
client [17] (test)  loss: 0.4515 -> 0.2179   acc: 80.85% -> 93.62%             
client [8] (test)  loss: 0.4245 -> 0.1972   acc: 83.56% -> 93.15%              
client [35] (test)  loss: 0.5914 -> 0.0347   acc: 78.57% -> 100.00%            
client [98] (test)  loss: 0.4580 -> 0.0265   acc: 81.08% -> 100.00%            
client [53] (test)  loss: 0.9238 -> 0.0874   acc: 66.67% -> 98.55%             
client [43] (test)  loss: 0.0472 -> 0.0114   acc: 100.00% -> 100.00%           
client [64] (test)  loss: 0.3036 -> 0.4563   acc: 87.72% -> 82.46%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8701 -> 0.4112   acc: 68.97% -> 89.66%             
client [88] (test)  loss: 0.5563 -> 0.3761   acc: 85.42% -> 87.50%             
client [38] (test)  loss: 0.0773 -> 0.0410   acc: 97.58% -> 98.39%             
client [3] (test)  loss: 0.1663 -> 0.0354   acc: 94.31% -> 99.19%              
client [5] (test)  loss: 0.3133 -> 1.5565   acc: 94.29% -> 48.57%              
client [41] (test)  loss: 0.6333 -> 0.0325   acc: 72.82% -> 98.06%             
client [7] (test)  loss: 0.6941 -> 0.4943   acc: 79.31% -> 89.66%              
client [37] (test)  loss: 0.4138 -> 0.0437   acc: 85.81% -> 98.60%             
client [45] (test)  loss: 0.6042 -> 0.0717   acc: 78.41% -> 98.24%             
client [47] (test)  loss: 0.3676 -> 0.0312   acc: 90.67% -> 98.67%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5036 -> 0.1803   acc: 83.78% -> 97.30%             
client [11] (test)  loss: 0.7288 -> 0.1984   acc: 78.72% -> 93.62%             
client [37] (test)  loss: 0.4078 -> 0.0434   acc: 87.64% -> 98.46%             
client [41] (test)  loss: 0.6151 -> 0.0281   acc: 78.64% -> 99.03%             
client [95] (test)  loss: 1.2958 -> 0.1072   acc: 53.57% -> 97.62%             
client [53] (test)  loss: 0.7209 -> 0.0880   acc: 73.91% -> 98.55%             
client [22] (test)  loss: 1.4664 -> 0.3412   acc: 62.71% -> 84.75%             
client [25] (test)  loss: 0.9807 -> 0.4316   acc: 78.16% -> 90.80%             
client [69] (test)  loss: 0.7674 -> 0.0557   acc: 74.94% -> 98.47%             
client [46] (test)  loss: 0.4257 -> 0.1202   acc: 83.54% -> 96.20%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6423 -> 0.0214   acc: 76.00% -> 100.00%            
client [69] (test)  loss: 0.9733 -> 0.2390   acc: 59.59% -> 95.65%             
client [82] (test)  loss: 0.1173 -> 0.0114   acc: 96.55% -> 99.43%             
client [45] (test)  loss: 0.9095 -> 0.0692   acc: 63.88% -> 98.68%             
client [7] (test)  loss: 0.9805 -> 0.4853   acc: 65.52% -> 88.51%              
client [50] (test)  loss: 0.5032 -> 0.1968   acc: 86.67% -> 95.00%             
client [35] (test)  loss: 0.2965 -> 0.0493   acc: 89.29% -> 96.43%             
client [24] (test)  loss: 0.3203 -> 0.0241   acc: 91.94% -> 99.19%             
client [15] (test)  loss: 0.1689 -> 0.0619   acc: 95.35% -> 97.67%             
client [58] (test)  loss: 0.3377 -> 0.0546   acc: 88.89% -> 100.00%            
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6426 -> 0.0720   acc: 76.07% -> 99.15%             
client [76] (test)  loss: 0.2062 -> 0.0309   acc: 88.89% -> 100.00%            
client [67] (test)  loss: 0.8676 -> 0.0517   acc: 67.03% -> 97.80%             
client [37] (test)  loss: 0.2228 -> 0.0412   acc: 92.13% -> 98.88%             
client [58] (test)  loss: 0.4649 -> 0.0209   acc: 77.78% -> 100.00%            
client [64] (test)  loss: 0.2398 -> 0.1243   acc: 89.47% -> 96.49%             
client [77] (test)  loss: 0.5875 -> 0.5771   acc: 80.00% -> 75.65%             
client [55] (test)  loss: 0.2703 -> 0.2157   acc: 89.80% -> 89.80%             
client [12] (test)  loss: 0.3065 -> 0.0105   acc: 93.83% -> 100.00%            
client [89] (test)  loss: 0.3908 -> 0.1689   acc: 87.72% -> 95.61%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5348 -> 0.2512   acc: 82.93% -> 95.12%             
client [51] (test)  loss: 0.1005 -> 0.1226   acc: 95.24% -> 95.24%             
client [8] (test)  loss: 0.3724 -> 0.1222   acc: 87.67% -> 95.89%              
client [18] (test)  loss: 0.2975 -> 0.2504   acc: 91.27% -> 92.06%             
client [94] (test)  loss: 0.4531 -> 0.2368   acc: 82.95% -> 92.80%             
client [81] (test)  loss: 0.6021 -> 0.9354   acc: 78.26% -> 73.91%             
client [3] (test)  loss: 0.1479 -> 0.0332   acc: 95.93% -> 99.19%              
client [11] (test)  loss: 0.5105 -> 0.2212   acc: 87.23% -> 93.62%             
client [95] (test)  loss: 0.4287 -> 0.0849   acc: 88.10% -> 97.62%             
client [67] (test)  loss: 1.0166 -> 0.0750   acc: 58.24% -> 98.90%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7584 -> 0.3808   acc: 68.97% -> 86.21%             
client [79] (test)  loss: 0.4817 -> 0.0368   acc: 80.54% -> 98.99%             
client [58] (test)  loss: 0.5322 -> 0.0053   acc: 77.78% -> 100.00%            
client [88] (test)  loss: 0.4808 -> 0.3204   acc: 84.38% -> 91.67%             
client [46] (test)  loss: 0.3723 -> 0.0939   acc: 87.34% -> 96.20%             
client [11] (test)  loss: 0.4440 -> 0.2097   acc: 85.11% -> 93.62%             
client [55] (test)  loss: 0.2700 -> 0.2112   acc: 87.76% -> 93.88%             
client [13] (test)  loss: 0.4220 -> 0.3635   acc: 87.23% -> 87.23%             
client [31] (test)  loss: 0.2976 -> 0.0406   acc: 91.11% -> 98.89%             
client [75] (test)  loss: 0.4191 -> 0.1323   acc: 87.63% -> 96.91%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3660 -> 0.1584   acc: 86.29% -> 95.97%             
client [7] (test)  loss: 0.5495 -> 0.4833   acc: 88.51% -> 88.51%              
client [57] (test)  loss: 0.0934 -> 0.1077   acc: 97.46% -> 96.61%             
client [13] (test)  loss: 0.6427 -> 0.2482   acc: 76.60% -> 93.62%             
client [43] (test)  loss: 0.0595 -> 0.0156   acc: 100.00% -> 100.00%           
client [91] (test)  loss: 0.3591 -> 0.3122   acc: 88.89% -> 88.19%             
client [10] (test)  loss: 0.1463 -> 0.0674   acc: 94.74% -> 97.89%             
client [64] (test)  loss: 0.2792 -> 0.1299   acc: 89.47% -> 96.49%             
client [82] (test)  loss: 0.0904 -> 0.0135   acc: 97.13% -> 99.43%             
client [22] (test)  loss: 0.5269 -> 0.2733   acc: 83.05% -> 91.53%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5710 -> 0.0123   acc: 80.87% -> 100.00%            
client [23] (test)  loss: 0.3873 -> 0.2076   acc: 88.89% -> 96.30%             
client [88] (test)  loss: 0.8607 -> 0.3414   acc: 79.17% -> 89.58%             
client [98] (test)  loss: 0.0654 -> 0.0119   acc: 97.30% -> 100.00%            
client [79] (test)  loss: 0.1843 -> 0.0429   acc: 93.96% -> 98.99%             
client [21] (test)  loss: 0.2395 -> 0.3629   acc: 93.10% -> 93.10%             
client [92] (test)  loss: 0.8338 -> 0.0007   acc: 77.60% -> 100.00%            
client [56] (test)  loss: 0.4075 -> 0.3228   acc: 81.40% -> 90.70%             
client [5] (test)  loss: 0.4772 -> 1.3437   acc: 82.86% -> 40.00%              
client [52] (test)  loss: 0.3029 -> 0.2154   acc: 89.74% -> 92.31%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.7065 -> 0.0000', 'accuracy': '73.59% -> 0.00%'},          
    200: {'loss': '0.5507 -> 0.0000', 'accuracy': '82.98% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(14.56%) at epoch: 1                                     
FedProx achieved 20.0%(28.01%) at epoch: 2                                     
FedProx achieved 30.0%(39.08%) at epoch: 9                                     
FedProx achieved 40.0%(40.31%) at epoch: 14                                    
FedProx achieved 60.0%(66.38%) at epoch: 16                                    
FedProx achieved 70.0%(77.48%) at epoch: 57                                    
FedProx achieved 80.0%(83.25%) at epoch: 62                                    
FedProx achieved 90.0%(93.22%) at epoch: 187                                   
Convergence (test_after):                                                      
FedProx achieved 60.0%(60.92%) at epoch: 0                                     
FedProx achieved 70.0%(71.36%) at epoch: 1                                     
FedProx achieved 80.0%(82.65%) at epoch: 5                                     
FedProx achieved 90.0%(92.96%) at epoch: 16                                    
