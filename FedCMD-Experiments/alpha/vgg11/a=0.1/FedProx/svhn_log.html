==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.0001,                                                        
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.5957 -> 0.3371   acc: 5.25% -> 87.54%              
client [81] (test)  loss: 3.2783 -> 0.6655   acc: 13.86% -> 88.12%             
client [21] (test)  loss: 3.0501 -> 1.1009   acc: 4.35% -> 65.22%              
client [68] (test)  loss: 1.0744 -> 0.3235   acc: 58.82% -> 93.14%             
client [93] (test)  loss: 4.5400 -> 1.3642   acc: 2.48% -> 54.04%              
client [31] (test)  loss: 2.3661 -> 1.5805   acc: 34.15% -> 45.12%             
client [20] (test)  loss: 3.5990 -> 1.0665   acc: 1.71% -> 68.44%              
client [59] (test)  loss: 3.3331 -> 1.2560   acc: 6.68% -> 52.35%              
client [48] (test)  loss: 4.0706 -> 1.8372   acc: 10.31% -> 40.21%             
client [34] (test)  loss: 3.6299 -> 1.5287   acc: 14.29% -> 51.02%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.1579 -> 1.0979   acc: 20.62% -> 65.82%             
client [99] (test)  loss: 3.4271 -> 0.2235   acc: 6.18% -> 95.55%              
client [67] (test)  loss: 3.0589 -> 0.6681   acc: 25.08% -> 77.02%             
client [0] (test)  loss: 2.7308 -> 0.7915   acc: 20.36% -> 73.32%              
client [76] (test)  loss: 5.1407 -> 0.0701   acc: 0.90% -> 98.92%              
client [41] (test)  loss: 2.0340 -> 0.3570   acc: 34.06% -> 90.69%             
client [62] (test)  loss: 3.7193 -> 1.0600   acc: 13.80% -> 65.00%             
client [2] (test)  loss: 2.0589 -> 0.0100   acc: 35.26% -> 99.84%              
client [14] (test)  loss: 2.0494 -> 0.6093   acc: 30.43% -> 86.96%             
client [46] (test)  loss: 4.5932 -> 1.2274   acc: 4.17% -> 66.67%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.8855 -> 0.3904   acc: 35.84% -> 87.52%             
client [68] (test)  loss: 1.6825 -> 0.1881   acc: 38.24% -> 95.10%             
client [57] (test)  loss: 3.4616 -> 0.5690   acc: 18.91% -> 79.66%             
client [17] (test)  loss: 2.7394 -> 0.2551   acc: 23.74% -> 94.16%             
client [54] (test)  loss: 3.4555 -> 0.3982   acc: 8.36% -> 92.24%              
client [23] (test)  loss: 4.1737 -> 0.5659   acc: 6.11% -> 84.35%              
client [35] (test)  loss: 0.3465 -> 0.0374   acc: 92.13% -> 99.47%             
client [59] (test)  loss: 3.8549 -> 0.9461   acc: 8.48% -> 70.40%              
client [31] (test)  loss: 1.2819 -> 1.1706   acc: 57.32% -> 64.63%             
client [9] (test)  loss: 2.1835 -> 0.9396   acc: 35.99% -> 66.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.9875 -> 0.7129   acc: 19.03% -> 77.95%             
client [33] (test)  loss: 0.5038 -> 0.0840   acc: 83.73% -> 97.80%             
client [16] (test)  loss: 2.0494 -> 0.2889   acc: 51.89% -> 90.27%             
client [44] (test)  loss: 2.2045 -> 0.8967   acc: 43.39% -> 72.31%             
client [8] (test)  loss: 4.5964 -> 0.3663   acc: 11.54% -> 88.46%              
client [31] (test)  loss: 1.6046 -> 0.8297   acc: 53.66% -> 74.39%             
client [47] (test)  loss: 0.5201 -> 0.0051   acc: 84.58% -> 99.84%             
client [36] (test)  loss: 1.9441 -> 0.9772   acc: 45.83% -> 83.33%             
client [20] (test)  loss: 3.7850 -> 0.7567   acc: 7.98% -> 73.95%              
client [56] (test)  loss: 0.5463 -> 0.0247   acc: 83.38% -> 99.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.3425 -> 0.0538   acc: 2.44% -> 98.78%               
client [60] (test)  loss: 3.5629 -> 0.0067   acc: 11.32% -> 100.00%            
client [28] (test)  loss: 1.0459 -> 0.2953   acc: 73.04% -> 89.74%             
client [25] (test)  loss: 2.5643 -> 0.1159   acc: 34.45% -> 96.64%             
client [58] (test)  loss: 2.6177 -> 0.4866   acc: 32.59% -> 80.45%             
client [44] (test)  loss: 2.7894 -> 0.8693   acc: 32.23% -> 69.42%             
client [39] (test)  loss: 3.2241 -> 0.6113   acc: 19.12% -> 77.94%             
client [29] (test)  loss: 2.6492 -> 0.1928   acc: 29.07% -> 94.94%             
client [3] (test)  loss: 2.7901 -> 0.5644   acc: 26.27% -> 80.04%              
client [84] (test)  loss: 2.4712 -> 1.0494   acc: 37.07% -> 62.55%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.3198 -> 0.8689   acc: 35.87% -> 78.26%             
client [84] (test)  loss: 1.5865 -> 1.0307   acc: 52.47% -> 64.45%             
client [10] (test)  loss: 0.2995 -> 0.0865   acc: 91.68% -> 97.13%             
client [36] (test)  loss: 1.9895 -> 1.0222   acc: 54.17% -> 83.33%             
client [65] (test)  loss: 0.2780 -> 0.0221   acc: 92.11% -> 99.59%             
client [81] (test)  loss: 3.0100 -> 0.4366   acc: 27.72% -> 91.09%             
client [79] (test)  loss: 2.6849 -> 0.2046   acc: 34.77% -> 94.78%             
client [42] (test)  loss: 2.1202 -> 0.6620   acc: 45.76% -> 81.02%             
client [11] (test)  loss: 2.0242 -> 0.6936   acc: 45.20% -> 80.79%             
client [96] (test)  loss: 2.2058 -> 0.1975   acc: 37.23% -> 94.16%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.9607 -> 0.3678   acc: 25.00% -> 90.38%              
client [53] (test)  loss: 0.7506 -> 0.2881   acc: 75.35% -> 90.10%             
client [52] (test)  loss: 1.3898 -> 0.1467   acc: 58.78% -> 95.44%             
client [42] (test)  loss: 1.2873 -> 0.6105   acc: 61.36% -> 83.05%             
client [69] (test)  loss: 1.3207 -> 0.6523   acc: 60.45% -> 79.10%             
client [59] (test)  loss: 2.1029 -> 0.6673   acc: 35.38% -> 79.24%             
client [7] (test)  loss: 2.4150 -> 0.0299   acc: 18.88% -> 98.72%              
client [26] (test)  loss: 1.1774 -> 0.2684   acc: 67.69% -> 91.38%             
client [49] (test)  loss: 2.6282 -> 0.2992   acc: 25.40% -> 91.53%             
client [98] (test)  loss: 1.0780 -> 0.2756   acc: 64.34% -> 91.28%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.1444 -> 0.2569   acc: 65.89% -> 92.25%             
client [47] (test)  loss: 0.6034 -> 0.0062   acc: 82.49% -> 99.84%             
client [21] (test)  loss: 1.3506 -> 0.8235   acc: 68.48% -> 80.43%             
client [77] (test)  loss: 2.2419 -> 0.1964   acc: 36.72% -> 93.93%             
client [95] (test)  loss: 1.7547 -> 0.3355   acc: 51.58% -> 90.95%             
client [91] (test)  loss: 1.6868 -> 0.5307   acc: 46.48% -> 87.21%             
client [14] (test)  loss: 1.3020 -> 0.3366   acc: 67.83% -> 91.88%             
client [99] (test)  loss: 1.4815 -> 0.1148   acc: 53.59% -> 97.56%             
client [20] (test)  loss: 1.7522 -> 0.5791   acc: 42.97% -> 79.85%             
client [39] (test)  loss: 1.9469 -> 0.4759   acc: 36.03% -> 83.82%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.5998 -> 0.1408   acc: 56.54% -> 96.30%             
client [62] (test)  loss: 1.5452 -> 0.6609   acc: 59.20% -> 79.80%             
client [71] (test)  loss: 0.9345 -> 0.7226   acc: 62.41% -> 72.44%             
client [97] (test)  loss: 0.4734 -> 0.0033   acc: 84.65% -> 99.89%             
client [30] (test)  loss: 0.9250 -> 0.1545   acc: 72.87% -> 95.35%             
client [88] (test)  loss: 1.3168 -> 0.0583   acc: 47.74% -> 97.94%             
client [60] (test)  loss: 2.2354 -> 0.0030   acc: 32.08% -> 100.00%            
client [82] (test)  loss: 1.2924 -> 0.8591   acc: 70.73% -> 70.73%             
client [91] (test)  loss: 0.7237 -> 0.5158   acc: 77.81% -> 86.68%             
client [57] (test)  loss: 1.0502 -> 0.4441   acc: 58.64% -> 82.23%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.1152 -> 0.8277   acc: 62.20% -> 78.05%             
client [15] (test)  loss: 3.1253 -> 0.2112   acc: 28.78% -> 94.63%             
client [71] (test)  loss: 1.6795 -> 0.6571   acc: 49.20% -> 74.72%             
client [97] (test)  loss: 0.6019 -> 0.0027   acc: 82.17% -> 100.00%            
client [53] (test)  loss: 0.8266 -> 0.2875   acc: 75.35% -> 90.10%             
client [77] (test)  loss: 1.8182 -> 0.1880   acc: 50.98% -> 94.75%             
client [76] (test)  loss: 3.1246 -> 0.0473   acc: 23.60% -> 98.92%             
client [79] (test)  loss: 2.9348 -> 0.1979   acc: 35.49% -> 95.20%             
client [28] (test)  loss: 2.7309 -> 0.1992   acc: 35.21% -> 93.16%             
client [99] (test)  loss: 3.1351 -> 0.1061   acc: 26.58% -> 97.70%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.6664 -> 0.0033   acc: 56.21% -> 100.00%            
client [86] (test)  loss: 1.3320 -> 0.4655   acc: 74.06% -> 85.64%             
client [34] (test)  loss: 1.7155 -> 0.4360   acc: 51.02% -> 85.71%             
client [73] (test)  loss: 1.5056 -> 0.0409   acc: 58.68% -> 99.56%             
client [5] (test)  loss: 3.5022 -> 0.4686   acc: 29.11% -> 87.97%              
client [96] (test)  loss: 1.9627 -> 0.1987   acc: 44.53% -> 94.16%             
client [22] (test)  loss: 2.0916 -> 0.7489   acc: 48.65% -> 78.38%             
client [60] (test)  loss: 2.1808 -> 0.0043   acc: 28.30% -> 100.00%            
client [66] (test)  loss: 1.8919 -> 0.4745   acc: 51.54% -> 85.67%             
client [83] (test)  loss: 2.3270 -> 0.4849   acc: 42.50% -> 85.00%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.9314 -> 0.0473   acc: 41.62% -> 98.56%             
client [65] (test)  loss: 0.7039 -> 0.0247   acc: 76.80% -> 99.52%             
client [95] (test)  loss: 1.4161 -> 0.2838   acc: 55.20% -> 92.31%             
client [17] (test)  loss: 0.9016 -> 0.1237   acc: 72.76% -> 97.67%             
client [8] (test)  loss: 1.8419 -> 0.3693   acc: 50.00% -> 86.54%              
client [35] (test)  loss: 0.7748 -> 0.0183   acc: 74.28% -> 99.47%             
client [98] (test)  loss: 1.1175 -> 0.2631   acc: 68.80% -> 92.25%             
client [53] (test)  loss: 1.0416 -> 0.2680   acc: 65.86% -> 90.71%             
client [43] (test)  loss: 0.6905 -> 0.1833   acc: 76.19% -> 94.14%             
client [64] (test)  loss: 1.5001 -> 0.5378   acc: 52.27% -> 86.40%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.5112 -> 0.8237   acc: 60.87% -> 82.61%             
client [88] (test)  loss: 1.7376 -> 0.0498   acc: 44.72% -> 98.22%             
client [38] (test)  loss: 0.3437 -> 0.0036   acc: 89.63% -> 99.86%             
client [3] (test)  loss: 1.3415 -> 0.4580   acc: 60.25% -> 85.64%              
client [5] (test)  loss: 1.7993 -> 0.4295   acc: 47.47% -> 90.51%              
client [41] (test)  loss: 0.4075 -> 0.1491   acc: 89.70% -> 95.05%             
client [7] (test)  loss: 1.3182 -> 0.0324   acc: 63.04% -> 99.20%              
client [37] (test)  loss: 1.8927 -> 0.0239   acc: 46.88% -> 99.64%             
client [45] (test)  loss: 1.6651 -> 0.1021   acc: 41.53% -> 97.46%             
client [47] (test)  loss: 0.2819 -> 0.0071   acc: 92.90% -> 99.84%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.1983 -> 0.2479   acc: 71.35% -> 94.05%             
client [11] (test)  loss: 2.0533 -> 0.6566   acc: 46.33% -> 83.05%             
client [37] (test)  loss: 1.6178 -> 0.0274   acc: 60.22% -> 99.40%             
client [41] (test)  loss: 0.2919 -> 0.1469   acc: 91.29% -> 95.25%             
client [95] (test)  loss: 1.9988 -> 0.2810   acc: 47.96% -> 92.76%             
client [53] (test)  loss: 0.8885 -> 0.2527   acc: 74.14% -> 92.12%             
client [22] (test)  loss: 1.7147 -> 0.8072   acc: 52.70% -> 74.32%             
client [25] (test)  loss: 2.4132 -> 0.0690   acc: 43.70% -> 97.48%             
client [69] (test)  loss: 0.7494 -> 0.5495   acc: 77.40% -> 84.18%             
client [46] (test)  loss: 0.9227 -> 0.6359   acc: 67.50% -> 84.17%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5055 -> 0.0073   acc: 85.88% -> 99.84%             
client [69] (test)  loss: 1.4425 -> 0.4746   acc: 64.41% -> 84.75%             
client [82] (test)  loss: 0.9564 -> 0.9146   acc: 68.29% -> 70.73%             
client [45] (test)  loss: 1.4152 -> 0.0861   acc: 45.34% -> 96.61%             
client [7] (test)  loss: 0.6888 -> 0.0264   acc: 78.08% -> 99.04%              
client [50] (test)  loss: 1.6478 -> 0.4901   acc: 55.88% -> 83.33%             
client [35] (test)  loss: 0.7258 -> 0.0180   acc: 78.06% -> 99.55%             
client [24] (test)  loss: 1.5528 -> 0.2432   acc: 59.33% -> 93.83%             
client [15] (test)  loss: 1.4429 -> 0.2264   acc: 62.02% -> 94.63%             
client [58] (test)  loss: 0.6387 -> 0.2698   acc: 79.17% -> 90.78%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.8675 -> 1.1148   acc: 47.42% -> 69.07%             
client [76] (test)  loss: 1.9495 -> 0.0468   acc: 41.26% -> 98.56%             
client [67] (test)  loss: 0.9635 -> 0.4201   acc: 71.04% -> 89.16%             
client [37] (test)  loss: 1.4452 -> 0.0267   acc: 61.54% -> 99.52%             
client [58] (test)  loss: 0.6323 -> 0.2670   acc: 79.17% -> 91.10%             
client [64] (test)  loss: 2.0255 -> 0.5211   acc: 42.60% -> 86.40%             
client [77] (test)  loss: 0.8420 -> 0.1603   acc: 76.39% -> 94.92%             
client [55] (test)  loss: 0.6665 -> 0.0787   acc: 81.30% -> 98.55%             
client [12] (test)  loss: 0.3634 -> 0.0962   acc: 84.38% -> 93.75%             
client [89] (test)  loss: 1.1364 -> 0.1466   acc: 65.37% -> 95.58%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9496 -> 0.8573   acc: 71.67% -> 71.86%             
client [51] (test)  loss: 1.1431 -> 0.3721   acc: 68.08% -> 91.71%             
client [8] (test)  loss: 1.8391 -> 0.4758   acc: 46.15% -> 86.54%              
client [18] (test)  loss: 1.5542 -> 0.3963   acc: 55.46% -> 89.23%             
client [94] (test)  loss: 1.2011 -> 0.1492   acc: 66.42% -> 96.64%             
client [81] (test)  loss: 1.6633 -> 0.4922   acc: 65.35% -> 91.09%             
client [3] (test)  loss: 1.0847 -> 0.3933   acc: 67.08% -> 87.74%              
client [11] (test)  loss: 1.1112 -> 0.5953   acc: 74.58% -> 85.88%             
client [95] (test)  loss: 1.2315 -> 0.2758   acc: 65.16% -> 92.76%             
client [67] (test)  loss: 1.4243 -> 0.4155   acc: 62.78% -> 88.03%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.3202 -> 0.9274   acc: 44.57% -> 80.43%             
client [79] (test)  loss: 2.6910 -> 0.1978   acc: 40.11% -> 95.74%             
client [58] (test)  loss: 1.6507 -> 0.2660   acc: 53.42% -> 91.26%             
client [88] (test)  loss: 1.3824 -> 0.0379   acc: 61.04% -> 98.63%             
client [46] (test)  loss: 2.0484 -> 0.5235   acc: 39.17% -> 85.00%             
client [11] (test)  loss: 1.6603 -> 0.6057   acc: 58.76% -> 85.31%             
client [55] (test)  loss: 1.8752 -> 0.0850   acc: 45.22% -> 98.26%             
client [13] (test)  loss: 1.1330 -> 0.1868   acc: 68.61% -> 93.30%             
client [31] (test)  loss: 1.1890 -> 0.5676   acc: 63.41% -> 86.59%             
client [75] (test)  loss: 1.6649 -> 0.4346   acc: 60.94% -> 90.58%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.0627 -> 0.2404   acc: 69.15% -> 92.20%             
client [7] (test)  loss: 0.7934 -> 0.0283   acc: 72.16% -> 99.20%              
client [57] (test)  loss: 0.7508 -> 0.4085   acc: 72.49% -> 83.95%             
client [13] (test)  loss: 1.2338 -> 0.1755   acc: 62.96% -> 94.00%             
client [43] (test)  loss: 0.5383 -> 0.1664   acc: 82.42% -> 94.87%             
client [91] (test)  loss: 0.7683 -> 0.4055   acc: 75.20% -> 88.77%             
client [10] (test)  loss: 0.5212 -> 0.0679   acc: 83.93% -> 98.28%             
client [64] (test)  loss: 1.0472 -> 0.5041   acc: 65.56% -> 86.71%             
client [82] (test)  loss: 1.0636 -> 0.8579   acc: 75.61% -> 75.61%             
client [22] (test)  loss: 0.8472 -> 0.7072   acc: 75.68% -> 74.32%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.6087 -> 0.4317   acc: 53.42% -> 85.93%             
client [23] (test)  loss: 2.4678 -> 0.3749   acc: 34.73% -> 92.37%             
client [88] (test)  loss: 2.9897 -> 0.0364   acc: 20.03% -> 99.04%             
client [98] (test)  loss: 1.0200 -> 0.2267   acc: 70.35% -> 94.19%             
client [79] (test)  loss: 0.7411 -> 0.2013   acc: 78.36% -> 95.74%             
client [21] (test)  loss: 1.2806 -> 0.9617   acc: 69.57% -> 82.61%             
client [92] (test)  loss: 1.3977 -> 0.4620   acc: 63.40% -> 87.89%             
client [56] (test)  loss: 0.3841 -> 0.0138   acc: 88.39% -> 99.72%             
client [5] (test)  loss: 1.4711 -> 0.4026   acc: 56.96% -> 92.41%              
client [52] (test)  loss: 1.2166 -> 0.1488   acc: 68.50% -> 96.82%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '1.7720 -> 0.0000', 'accuracy': '55.00% -> 0.00%'},          
    200: {'loss': '1.1914 -> 0.0000', 'accuracy': '67.47% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(16.03%) at epoch: 2                                     
FedProx achieved 20.0%(25.99%) at epoch: 4                                     
FedProx achieved 30.0%(33.99%) at epoch: 11                                    
FedProx achieved 40.0%(45.86%) at epoch: 13                                    
FedProx achieved 60.0%(61.75%) at epoch: 37                                    
FedProx achieved 70.0%(72.74%) at epoch: 98                                    
Convergence (test_after):                                                      
FedProx achieved 80.0%(83.64%) at epoch: 0                                     
FedProx achieved 90.0%(90.10%) at epoch: 10                                    
