==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6749 -> 0.1679   acc: 50.42% -> 95.26%             
client [81] (test)  loss: 1.4929 -> 0.3379   acc: 47.71% -> 90.91%             
client [21] (test)  loss: 0.4669 -> 0.1058   acc: 90.90% -> 97.14%             
client [68] (test)  loss: 1.8468 -> 0.5316   acc: 53.26% -> 87.26%             
client [93] (test)  loss: 0.2738 -> 0.0500   acc: 94.68% -> 98.49%             
client [31] (test)  loss: 1.0341 -> 2.7665   acc: 72.97% -> 79.94%             
client [20] (test)  loss: 1.9102 -> 0.2728   acc: 32.81% -> 92.51%             
client [59] (test)  loss: 1.2065 -> 0.3913   acc: 65.01% -> 88.05%             
client [48] (test)  loss: 2.9908 -> 1.2192   acc: 28.90% -> 68.96%             
client [34] (test)  loss: 2.3080 -> 0.1238   acc: 18.86% -> 96.39%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4352 -> 0.4490   acc: 63.09% -> 89.03%             
client [99] (test)  loss: 0.2007 -> 0.0453   acc: 91.96% -> 98.78%             
client [67] (test)  loss: 0.6921 -> 0.3883   acc: 82.05% -> 86.69%             
client [0] (test)  loss: 0.5785 -> 0.1818   acc: 89.32% -> 95.05%              
client [76] (test)  loss: 0.8641 -> 0.2810   acc: 76.67% -> 93.21%             
client [41] (test)  loss: 1.1165 -> 0.5687   acc: 63.59% -> 75.15%             
client [62] (test)  loss: 0.4373 -> 0.1087   acc: 87.87% -> 97.21%             
client [2] (test)  loss: 0.7928 -> 0.3323   acc: 78.69% -> 93.23%              
client [14] (test)  loss: 1.0313 -> 0.3068   acc: 62.89% -> 92.69%             
client [46] (test)  loss: 1.0046 -> 0.0303   acc: 34.66% -> 99.28%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5748 -> 0.2280   acc: 82.25% -> 92.87%             
client [68] (test)  loss: 1.0509 -> 0.2903   acc: 59.49% -> 91.90%             
client [57] (test)  loss: 0.6869 -> 0.0946   acc: 76.61% -> 97.73%             
client [17] (test)  loss: 1.1478 -> 0.2101   acc: 59.46% -> 94.04%             
client [54] (test)  loss: 0.8358 -> 0.2363   acc: 70.99% -> 93.85%             
client [23] (test)  loss: 0.2722 -> 0.1356   acc: 93.69% -> 96.69%             
client [35] (test)  loss: 0.1970 -> 0.0123   acc: 94.06% -> 99.62%             
client [59] (test)  loss: 0.4294 -> 0.2756   acc: 86.87% -> 90.01%             
client [31] (test)  loss: 0.3864 -> 0.1354   acc: 86.43% -> 95.45%             
client [9] (test)  loss: 1.1777 -> 0.3463   acc: 65.79% -> 91.86%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7281 -> 0.2904   acc: 77.50% -> 91.84%             
client [33] (test)  loss: 0.4544 -> 0.0617   acc: 79.13% -> 98.47%             
client [16] (test)  loss: 1.0219 -> 0.3238   acc: 63.10% -> 90.36%             
client [44] (test)  loss: 1.1302 -> 1.0472   acc: 65.30% -> 77.73%             
client [8] (test)  loss: 0.9925 -> 1.2235   acc: 69.91% -> 68.64%              
client [31] (test)  loss: 0.2850 -> 0.1255   acc: 89.11% -> 95.55%             
client [47] (test)  loss: 1.0257 -> 0.3228   acc: 61.56% -> 90.46%             
client [36] (test)  loss: 0.8266 -> 0.1640   acc: 71.12% -> 95.54%             
client [20] (test)  loss: 0.6802 -> 0.1400   acc: 67.12% -> 96.48%             
client [56] (test)  loss: 0.8692 -> 0.0447   acc: 62.95% -> 98.78%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.0037 -> 0.4067   acc: 72.73% -> 84.01%              
client [60] (test)  loss: 0.4774 -> 0.1091   acc: 85.14% -> 97.61%             
client [28] (test)  loss: 0.1682 -> 0.0038   acc: 94.64% -> 99.93%             
client [25] (test)  loss: 0.6382 -> 0.1340   acc: 80.22% -> 96.38%             
client [58] (test)  loss: 0.0710 -> 0.0141   acc: 97.85% -> 99.57%             
client [44] (test)  loss: 1.0819 -> 0.6778   acc: 66.69% -> 78.18%             
client [39] (test)  loss: 0.6521 -> 0.1264   acc: 74.57% -> 96.71%             
client [29] (test)  loss: 0.6496 -> 0.2825   acc: 79.99% -> 91.03%             
client [3] (test)  loss: 0.0879 -> 0.0183   acc: 98.20% -> 99.56%              
client [84] (test)  loss: 0.9132 -> 0.1835   acc: 78.39% -> 94.66%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2220 -> 0.0762   acc: 93.37% -> 98.20%             
client [84] (test)  loss: 0.7951 -> 0.1925   acc: 78.34% -> 94.98%             
client [10] (test)  loss: 0.7266 -> 0.3170   acc: 77.14% -> 87.93%             
client [36] (test)  loss: 0.9423 -> 0.1537   acc: 70.80% -> 95.82%             
client [65] (test)  loss: 0.6108 -> 0.3575   acc: 75.16% -> 89.17%             
client [81] (test)  loss: 0.4831 -> 0.2115   acc: 80.21% -> 93.74%             
client [79] (test)  loss: 0.9642 -> 0.2317   acc: 70.27% -> 93.12%             
client [42] (test)  loss: 0.4399 -> 0.2322   acc: 87.19% -> 93.73%             
client [11] (test)  loss: 0.4111 -> 0.0897   acc: 87.65% -> 97.88%             
client [96] (test)  loss: 0.4667 -> 0.1152   acc: 88.23% -> 96.56%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9569 -> 0.4282   acc: 72.04% -> 86.07%              
client [53] (test)  loss: 0.2366 -> 0.1002   acc: 93.96% -> 97.77%             
client [52] (test)  loss: 0.9701 -> 0.4080   acc: 68.18% -> 84.35%             
client [42] (test)  loss: 0.4513 -> 0.2378   acc: 88.02% -> 93.88%             
client [69] (test)  loss: 1.1195 -> 0.3277   acc: 70.89% -> 91.30%             
client [59] (test)  loss: 0.4091 -> 0.2142   acc: 87.19% -> 91.75%             
client [7] (test)  loss: 0.6487 -> 0.2364   acc: 80.18% -> 93.32%              
client [26] (test)  loss: 0.4565 -> 0.2238   acc: 82.04% -> 94.83%             
client [49] (test)  loss: 0.0300 -> 0.0031   acc: 99.12% -> 99.94%             
client [98] (test)  loss: 0.3172 -> 0.0542   acc: 90.19% -> 98.94%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3250 -> 0.0535   acc: 91.02% -> 98.96%             
client [47] (test)  loss: 1.1120 -> 0.2518   acc: 61.20% -> 92.70%             
client [21] (test)  loss: 0.2258 -> 0.1387   acc: 93.49% -> 97.94%             
client [77] (test)  loss: 0.4025 -> 1.0772   acc: 89.78% -> 74.25%             
client [95] (test)  loss: 1.3068 -> 0.1047   acc: 52.17% -> 97.69%             
client [91] (test)  loss: 0.8528 -> 0.0804   acc: 74.59% -> 97.99%             
client [14] (test)  loss: 0.4994 -> 0.1607   acc: 80.46% -> 95.53%             
client [99] (test)  loss: 0.1375 -> 0.0408   acc: 94.95% -> 98.95%             
client [20] (test)  loss: 0.5764 -> 0.0884   acc: 75.06% -> 97.69%             
client [39] (test)  loss: 0.6544 -> 0.1090   acc: 73.76% -> 97.37%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.2153 -> 0.3626   acc: 63.24% -> 86.52%             
client [62] (test)  loss: 0.1529 -> 0.0641   acc: 96.17% -> 98.55%             
client [71] (test)  loss: 0.0628 -> 0.0076   acc: 98.37% -> 99.79%             
client [97] (test)  loss: 0.1236 -> 0.0068   acc: 95.35% -> 99.89%             
client [30] (test)  loss: 0.8215 -> 0.1024   acc: 63.49% -> 97.39%             
client [88] (test)  loss: 0.8034 -> 0.2612   acc: 75.61% -> 90.23%             
client [60] (test)  loss: 0.4887 -> 0.0830   acc: 84.13% -> 98.21%             
client [82] (test)  loss: 0.9822 -> 0.6465   acc: 58.50% -> 65.34%             
client [91] (test)  loss: 0.9056 -> 0.0784   acc: 66.14% -> 98.11%             
client [57] (test)  loss: 0.4491 -> 0.0938   acc: 82.53% -> 97.89%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2237 -> 0.1074   acc: 91.65% -> 95.91%             
client [15] (test)  loss: 0.2783 -> 0.0203   acc: 90.38% -> 99.47%             
client [71] (test)  loss: 0.0695 -> 0.0132   acc: 98.10% -> 99.68%             
client [97] (test)  loss: 0.2105 -> 0.0096   acc: 92.24% -> 99.82%             
client [53] (test)  loss: 0.1890 -> 0.0424   acc: 94.93% -> 98.90%             
client [77] (test)  loss: 0.3959 -> 0.1105   acc: 90.09% -> 97.10%             
client [76] (test)  loss: 0.9250 -> 0.2217   acc: 65.53% -> 94.64%             
client [79] (test)  loss: 1.1223 -> 0.2132   acc: 71.11% -> 93.59%             
client [28] (test)  loss: 0.1458 -> 0.0039   acc: 95.44% -> 99.90%             
client [99] (test)  loss: 0.1763 -> 0.0701   acc: 93.94% -> 98.24%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1166 -> 0.0087   acc: 96.10% -> 99.86%             
client [86] (test)  loss: 0.7481 -> 0.3813   acc: 74.83% -> 88.57%             
client [34] (test)  loss: 0.6000 -> 0.0736   acc: 81.27% -> 98.11%             
client [73] (test)  loss: 0.3906 -> 0.3410   acc: 88.51% -> 90.02%             
client [5] (test)  loss: 0.3894 -> 0.1072   acc: 88.93% -> 97.42%              
client [96] (test)  loss: 0.6409 -> 0.1296   acc: 81.03% -> 95.92%             
client [22] (test)  loss: 0.4169 -> 0.2438   acc: 86.71% -> 92.42%             
client [60] (test)  loss: 0.4842 -> 0.0871   acc: 82.85% -> 98.18%             
client [66] (test)  loss: 1.1425 -> 0.2089   acc: 55.39% -> 94.90%             
client [83] (test)  loss: 0.3059 -> 0.0959   acc: 91.38% -> 97.48%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7298 -> 0.2095   acc: 71.93% -> 95.08%             
client [65] (test)  loss: 0.8345 -> 0.3372   acc: 71.27% -> 89.97%             
client [95] (test)  loss: 1.4452 -> 0.1079   acc: 50.60% -> 97.82%             
client [17] (test)  loss: 0.5737 -> 0.1787   acc: 76.91% -> 94.70%             
client [8] (test)  loss: 0.9031 -> 0.3763   acc: 73.96% -> 88.07%              
client [35] (test)  loss: 0.1091 -> 0.0113   acc: 96.68% -> 99.70%             
client [98] (test)  loss: 0.2213 -> 0.0572   acc: 94.54% -> 98.98%             
client [53] (test)  loss: 0.1600 -> 0.0408   acc: 96.09% -> 99.15%             
client [43] (test)  loss: 1.0987 -> 0.2944   acc: 62.92% -> 89.63%             
client [64] (test)  loss: 0.8230 -> 0.3004   acc: 76.08% -> 91.98%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2768 -> 0.1826   acc: 91.09% -> 97.84%             
client [88] (test)  loss: 0.9233 -> 0.2488   acc: 66.55% -> 91.54%             
client [38] (test)  loss: 1.1350 -> 0.1894   acc: 71.98% -> 96.00%             
client [3] (test)  loss: 0.2318 -> 0.0127   acc: 90.47% -> 99.71%              
client [5] (test)  loss: 0.5409 -> 0.1134   acc: 83.97% -> 97.18%              
client [41] (test)  loss: 0.7716 -> 0.3564   acc: 77.49% -> 88.60%             
client [7] (test)  loss: 0.9261 -> 0.2287   acc: 65.87% -> 93.64%              
client [37] (test)  loss: 0.2020 -> 0.0329   acc: 93.20% -> 99.29%             
client [45] (test)  loss: 0.8356 -> 0.3473   acc: 74.68% -> 88.31%             
client [47] (test)  loss: 1.3123 -> 0.3697   acc: 60.89% -> 90.55%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.3346 -> 0.3020   acc: 65.02% -> 91.52%             
client [11] (test)  loss: 0.2852 -> 0.0872   acc: 91.91% -> 98.22%             
client [37] (test)  loss: 0.1722 -> 0.2069   acc: 95.22% -> 95.64%             
client [41] (test)  loss: 0.7968 -> 0.3158   acc: 77.87% -> 89.55%             
client [95] (test)  loss: 0.8495 -> 0.1044   acc: 61.19% -> 97.74%             
client [53] (test)  loss: 0.1937 -> 0.0415   acc: 94.93% -> 98.95%             
client [22] (test)  loss: 0.5899 -> 0.1755   acc: 84.06% -> 93.85%             
client [25] (test)  loss: 0.5359 -> 0.1258   acc: 84.84% -> 96.31%             
client [69] (test)  loss: 1.1999 -> 0.1928   acc: 72.30% -> 94.87%             
client [46] (test)  loss: 0.5100 -> 0.0218   acc: 79.85% -> 99.56%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9007 -> 0.2558   acc: 66.99% -> 93.93%             
client [69] (test)  loss: 1.0216 -> 0.2318   acc: 72.45% -> 94.63%             
client [82] (test)  loss: 0.8262 -> 0.6361   acc: 65.03% -> 65.68%             
client [45] (test)  loss: 0.7782 -> 0.3346   acc: 73.19% -> 88.82%             
client [7] (test)  loss: 0.7850 -> 0.2289   acc: 74.94% -> 94.13%              
client [50] (test)  loss: 0.7397 -> 0.1109   acc: 74.83% -> 97.83%             
client [35] (test)  loss: 0.0812 -> 0.0132   acc: 97.59% -> 99.77%             
client [24] (test)  loss: 0.6422 -> 0.1790   acc: 79.97% -> 94.01%             
client [15] (test)  loss: 0.2325 -> 0.0161   acc: 92.91% -> 99.64%             
client [58] (test)  loss: 0.2037 -> 0.0133   acc: 94.74% -> 99.57%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.8322 -> 0.6011   acc: 47.77% -> 81.96%             
client [76] (test)  loss: 0.5506 -> 0.2147   acc: 79.49% -> 94.96%             
client [67] (test)  loss: 0.4485 -> 0.2815   acc: 83.75% -> 90.51%             
client [37] (test)  loss: 0.2496 -> 0.0310   acc: 91.13% -> 99.20%             
client [58] (test)  loss: 0.0659 -> 0.0143   acc: 98.21% -> 99.57%             
client [64] (test)  loss: 0.7274 -> 0.2820   acc: 72.89% -> 91.91%             
client [77] (test)  loss: 0.1999 -> 0.1118   acc: 94.70% -> 97.52%             
client [55] (test)  loss: 0.4530 -> 0.1336   acc: 84.34% -> 95.13%             
client [12] (test)  loss: 0.7083 -> 0.3054   acc: 78.33% -> 93.37%             
client [89] (test)  loss: 0.5539 -> 0.4419   acc: 78.23% -> 78.85%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7809 -> 0.1981   acc: 80.64% -> 94.51%             
client [51] (test)  loss: 0.7215 -> 0.2994   acc: 80.42% -> 92.90%             
client [8] (test)  loss: 0.7839 -> 0.3752   acc: 75.65% -> 86.92%              
client [18] (test)  loss: 0.1382 -> 0.0329   acc: 96.58% -> 99.32%             
client [94] (test)  loss: 0.2320 -> 0.0073   acc: 92.79% -> 99.87%             
client [81] (test)  loss: 0.7046 -> 0.1614   acc: 76.73% -> 94.24%             
client [3] (test)  loss: 0.0738 -> 0.0127   acc: 98.18% -> 99.64%              
client [11] (test)  loss: 0.2996 -> 0.0851   acc: 91.51% -> 98.28%             
client [95] (test)  loss: 2.0574 -> 0.1155   acc: 47.14% -> 97.82%             
client [67] (test)  loss: 0.7749 -> 0.2710   acc: 75.63% -> 89.97%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1691 -> 0.1650   acc: 95.34% -> 97.89%             
client [79] (test)  loss: 0.8094 -> 0.2205   acc: 72.82% -> 94.24%             
client [58] (test)  loss: 0.0768 -> 0.0159   acc: 98.15% -> 99.63%             
client [88] (test)  loss: 0.8459 -> 0.2658   acc: 72.35% -> 92.03%             
client [46] (test)  loss: 0.4804 -> 0.0239   acc: 84.22% -> 99.47%             
client [11] (test)  loss: 0.3420 -> 0.0828   acc: 89.61% -> 98.35%             
client [55] (test)  loss: 0.4968 -> 0.1131   acc: 81.10% -> 96.09%             
client [13] (test)  loss: 0.2405 -> 0.0730   acc: 93.34% -> 98.42%             
client [31] (test)  loss: 0.2158 -> 0.1042   acc: 92.16% -> 96.03%             
client [75] (test)  loss: 0.6904 -> 0.1877   acc: 79.02% -> 95.23%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2160 -> 0.0679   acc: 94.27% -> 98.50%             
client [7] (test)  loss: 0.6622 -> 0.2254   acc: 80.26% -> 94.10%              
client [57] (test)  loss: 0.5924 -> 0.0879   acc: 80.80% -> 98.12%             
client [13] (test)  loss: 0.2254 -> 0.0581   acc: 93.60% -> 98.57%             
client [43] (test)  loss: 0.8006 -> 0.3179   acc: 74.07% -> 90.14%             
client [91] (test)  loss: 0.8989 -> 0.0689   acc: 69.47% -> 97.99%             
client [10] (test)  loss: 0.7415 -> 0.2935   acc: 72.09% -> 88.94%             
client [64] (test)  loss: 0.5809 -> 0.2995   acc: 81.12% -> 92.41%             
client [82] (test)  loss: 1.2253 -> 0.6003   acc: 55.44% -> 68.53%             
client [22] (test)  loss: 0.4829 -> 0.1598   acc: 86.14% -> 95.34%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3361 -> 0.0913   acc: 90.61% -> 97.93%             
client [23] (test)  loss: 0.5308 -> 0.0854   acc: 79.80% -> 97.90%             
client [88] (test)  loss: 0.9206 -> 0.2508   acc: 61.40% -> 91.81%             
client [98] (test)  loss: 0.2563 -> 0.0574   acc: 93.93% -> 98.94%             
client [79] (test)  loss: 0.6259 -> 0.2032   acc: 76.40% -> 94.46%             
client [21] (test)  loss: 0.3574 -> 0.0556   acc: 88.23% -> 98.83%             
client [92] (test)  loss: 0.7673 -> 0.0643   acc: 69.07% -> 98.46%             
client [56] (test)  loss: 0.5916 -> 0.0402   acc: 78.99% -> 99.02%             
client [5] (test)  loss: 0.5041 -> 0.1137   acc: 85.94% -> 97.39%              
client [52] (test)  loss: 0.7773 -> 0.3548   acc: 67.85% -> 91.01%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.5561 -> 0.0000', 'accuracy': '82.55% -> 0.00%'},          
    200: {'loss': '0.5346 -> 0.0000', 'accuracy': '81.75% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(27.00%) at epoch: 2                                     
FedProx achieved 50.0%(55.90%) at epoch: 5                                     
FedProx achieved 70.0%(77.46%) at epoch: 10                                    
FedProx achieved 80.0%(82.34%) at epoch: 24                                    
FedProx achieved 90.0%(90.52%) at epoch: 99                                    
Convergence (test_after):                                                      
FedProx achieved 70.0%(76.63%) at epoch: 0                                     
FedProx achieved 80.0%(86.98%) at epoch: 1                                     
FedProx achieved 90.0%(91.53%) at epoch: 2                                     
