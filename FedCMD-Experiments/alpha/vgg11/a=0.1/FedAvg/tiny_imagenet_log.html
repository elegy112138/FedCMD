==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.8468 -> 2.0428   acc: 22.68% -> 53.26%             
client [81] (test)  loss: 4.2617 -> 2.1235   acc: 15.66% -> 54.09%             
client [21] (test)  loss: 4.9208 -> 2.4703   acc: 11.60% -> 51.00%             
client [68] (test)  loss: 4.8035 -> 2.2859   acc: 12.36% -> 50.73%             
client [93] (test)  loss: 4.2786 -> 2.3062   acc: 13.05% -> 52.57%             
client [31] (test)  loss: 4.9808 -> 1.4757   acc: 8.54% -> 67.77%              
client [20] (test)  loss: 3.8055 -> 1.9650   acc: 26.12% -> 54.84%             
client [59] (test)  loss: 4.2082 -> 2.0850   acc: 15.49% -> 52.46%             
client [48] (test)  loss: 3.9251 -> 1.6748   acc: 19.69% -> 64.99%             
client [34] (test)  loss: 4.4230 -> 2.6137   acc: 13.69% -> 49.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.2727 -> 2.6294   acc: 19.95% -> 47.34%             
client [99] (test)  loss: 3.8124 -> 2.8837   acc: 26.58% -> 48.47%             
client [67] (test)  loss: 3.6482 -> 1.9734   acc: 24.16% -> 60.14%             
client [0] (test)  loss: 3.9926 -> 2.1801   acc: 25.81% -> 54.12%              
client [76] (test)  loss: 3.9428 -> 2.0992   acc: 24.36% -> 53.27%             
client [41] (test)  loss: 3.7563 -> 1.8636   acc: 22.06% -> 57.65%             
client [62] (test)  loss: 4.9744 -> 2.4181   acc: 13.85% -> 50.77%             
client [2] (test)  loss: 5.1035 -> 1.9857   acc: 11.52% -> 58.48%              
client [14] (test)  loss: 3.6385 -> 1.7140   acc: 23.84% -> 62.10%             
client [46] (test)  loss: 2.9697 -> 1.8305   acc: 32.43% -> 60.54%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4921 -> 2.1492   acc: 29.32% -> 57.53%             
client [68] (test)  loss: 3.7993 -> 2.1455   acc: 28.78% -> 56.10%             
client [57] (test)  loss: 3.6948 -> 2.1911   acc: 29.45% -> 53.09%             
client [17] (test)  loss: 3.9084 -> 1.6081   acc: 25.28% -> 64.14%             
client [54] (test)  loss: 3.7288 -> 1.9904   acc: 23.30% -> 57.72%             
client [23] (test)  loss: 3.4498 -> 1.5242   acc: 32.39% -> 63.19%             
client [35] (test)  loss: 4.5003 -> 1.8130   acc: 22.49% -> 60.44%             
client [59] (test)  loss: 3.3591 -> 1.9164   acc: 33.98% -> 61.44%             
client [31] (test)  loss: 2.9776 -> 1.3583   acc: 35.37% -> 71.95%             
client [9] (test)  loss: 3.3271 -> 2.1380   acc: 35.09% -> 56.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5868 -> 1.6500   acc: 28.22% -> 66.17%             
client [33] (test)  loss: 3.3564 -> 2.1602   acc: 30.68% -> 54.32%             
client [16] (test)  loss: 3.3274 -> 1.9046   acc: 34.24% -> 59.56%             
client [44] (test)  loss: 3.0352 -> 1.8397   acc: 37.20% -> 61.35%             
client [8] (test)  loss: 3.8764 -> 1.7961   acc: 27.98% -> 64.71%              
client [31] (test)  loss: 3.9000 -> 1.3244   acc: 26.13% -> 72.82%             
client [47] (test)  loss: 3.7478 -> 1.2926   acc: 26.22% -> 68.35%             
client [36] (test)  loss: 3.3261 -> 1.5813   acc: 31.88% -> 63.41%             
client [20] (test)  loss: 3.2485 -> 1.6883   acc: 36.51% -> 61.94%             
client [56] (test)  loss: 3.7712 -> 2.2146   acc: 28.47% -> 53.56%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.1756 -> 1.9147   acc: 25.50% -> 58.77%              
client [60] (test)  loss: 3.7806 -> 1.9880   acc: 24.91% -> 57.64%             
client [28] (test)  loss: 3.3606 -> 2.1138   acc: 34.90% -> 57.87%             
client [25] (test)  loss: 3.3843 -> 2.0707   acc: 38.26% -> 55.30%             
client [58] (test)  loss: 3.5522 -> 2.2924   acc: 28.98% -> 56.01%             
client [44] (test)  loss: 3.0426 -> 1.7994   acc: 37.68% -> 61.51%             
client [39] (test)  loss: 3.5639 -> 2.0656   acc: 31.02% -> 61.72%             
client [29] (test)  loss: 2.9320 -> 1.5988   acc: 38.61% -> 67.18%             
client [3] (test)  loss: 3.4416 -> 1.6614   acc: 31.86% -> 63.89%              
client [84] (test)  loss: 3.5841 -> 1.9487   acc: 31.56% -> 62.41%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.9783 -> 2.0941   acc: 25.60% -> 58.20%             
client [84] (test)  loss: 3.3911 -> 1.9680   acc: 34.04% -> 61.70%             
client [10] (test)  loss: 3.5147 -> 1.7788   acc: 36.38% -> 61.75%             
client [36] (test)  loss: 3.3930 -> 1.5302   acc: 30.07% -> 65.58%             
client [65] (test)  loss: 3.2657 -> 2.0804   acc: 35.84% -> 58.24%             
client [81] (test)  loss: 3.7239 -> 1.5726   acc: 30.78% -> 65.48%             
client [79] (test)  loss: 4.0399 -> 2.4854   acc: 26.71% -> 51.71%             
client [42] (test)  loss: 3.4419 -> 1.9895   acc: 30.77% -> 57.60%             
client [11] (test)  loss: 3.3362 -> 2.1154   acc: 33.39% -> 57.09%             
client [96] (test)  loss: 3.6376 -> 1.6196   acc: 30.22% -> 66.91%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0452 -> 1.7178   acc: 26.23% -> 67.73%              
client [53] (test)  loss: 3.6355 -> 2.0284   acc: 27.91% -> 64.53%             
client [52] (test)  loss: 2.7984 -> 1.8105   acc: 45.04% -> 63.65%             
client [42] (test)  loss: 3.0673 -> 2.0192   acc: 36.49% -> 58.50%             
client [69] (test)  loss: 3.2670 -> 2.3535   acc: 36.97% -> 51.60%             
client [59] (test)  loss: 2.8211 -> 1.8126   acc: 41.73% -> 63.38%             
client [7] (test)  loss: 3.5505 -> 2.1287   acc: 32.50% -> 55.83%              
client [26] (test)  loss: 2.8732 -> 1.6804   acc: 43.51% -> 65.09%             
client [49] (test)  loss: 2.9625 -> 2.1211   acc: 40.38% -> 60.49%             
client [98] (test)  loss: 3.3468 -> 1.7854   acc: 32.89% -> 68.05%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.3005 -> 1.7518   acc: 34.59% -> 67.86%             
client [47] (test)  loss: 3.0364 -> 1.2034   acc: 35.80% -> 71.79%             
client [21] (test)  loss: 3.9031 -> 2.0241   acc: 27.80% -> 59.60%             
client [77] (test)  loss: 3.4793 -> 1.6560   acc: 32.30% -> 65.64%             
client [95] (test)  loss: 3.0480 -> 1.8714   acc: 38.95% -> 64.42%             
client [91] (test)  loss: 3.0872 -> 1.6278   acc: 39.26% -> 65.82%             
client [14] (test)  loss: 2.7108 -> 1.5645   acc: 43.24% -> 67.97%             
client [99] (test)  loss: 3.2833 -> 2.3741   acc: 40.08% -> 54.60%             
client [20] (test)  loss: 2.7648 -> 1.6113   acc: 42.39% -> 64.88%             
client [39] (test)  loss: 3.7456 -> 2.0473   acc: 31.35% -> 60.73%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.8195 -> 1.7788   acc: 45.04% -> 64.36%             
client [62] (test)  loss: 3.4730 -> 2.3693   acc: 32.31% -> 56.24%             
client [71] (test)  loss: 2.8224 -> 2.1899   acc: 45.17% -> 54.83%             
client [97] (test)  loss: 3.3431 -> 1.9581   acc: 38.74% -> 59.54%             
client [30] (test)  loss: 2.8735 -> 2.1942   acc: 46.40% -> 57.77%             
client [88] (test)  loss: 3.1533 -> 1.8665   acc: 37.71% -> 62.12%             
client [60] (test)  loss: 3.7531 -> 2.0645   acc: 28.73% -> 60.55%             
client [82] (test)  loss: 3.2879 -> 1.8708   acc: 32.95% -> 63.31%             
client [91] (test)  loss: 2.7942 -> 1.6594   acc: 43.65% -> 66.84%             
client [57] (test)  loss: 3.2806 -> 2.0632   acc: 38.00% -> 57.09%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.8739 -> 1.2570   acc: 40.24% -> 74.91%             
client [15] (test)  loss: 2.8247 -> 1.8802   acc: 45.28% -> 62.94%             
client [71] (test)  loss: 3.3249 -> 2.1842   acc: 38.89% -> 54.11%             
client [97] (test)  loss: 3.5336 -> 1.9950   acc: 35.50% -> 59.16%             
client [53] (test)  loss: 3.7291 -> 2.0728   acc: 29.26% -> 63.18%             
client [77] (test)  loss: 3.3560 -> 1.6444   acc: 39.86% -> 66.84%             
client [76] (test)  loss: 3.0260 -> 1.8782   acc: 39.27% -> 60.91%             
client [79] (test)  loss: 3.9076 -> 2.4904   acc: 30.98% -> 52.14%             
client [28] (test)  loss: 3.7790 -> 2.1821   acc: 30.92% -> 59.86%             
client [99] (test)  loss: 3.3242 -> 2.3172   acc: 37.83% -> 56.24%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.4097 -> 2.0321   acc: 39.69% -> 59.54%             
client [86] (test)  loss: 2.7274 -> 1.7072   acc: 46.04% -> 65.59%             
client [34] (test)  loss: 3.5489 -> 2.2618   acc: 33.18% -> 58.00%             
client [73] (test)  loss: 2.8445 -> 1.8125   acc: 42.93% -> 63.28%             
client [5] (test)  loss: 3.2365 -> 1.8249   acc: 37.12% -> 64.86%              
client [96] (test)  loss: 3.2496 -> 1.7343   acc: 37.77% -> 67.09%             
client [22] (test)  loss: 2.4694 -> 1.7100   acc: 46.55% -> 69.03%             
client [60] (test)  loss: 3.7872 -> 2.0645   acc: 29.27% -> 61.09%             
client [66] (test)  loss: 3.3500 -> 1.8410   acc: 32.62% -> 63.64%             
client [83] (test)  loss: 3.1711 -> 2.1549   acc: 35.67% -> 57.12%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.0921 -> 1.9128   acc: 40.00% -> 60.36%             
client [65] (test)  loss: 3.1052 -> 2.0160   acc: 38.17% -> 58.78%             
client [95] (test)  loss: 3.1099 -> 1.9502   acc: 39.16% -> 63.37%             
client [17] (test)  loss: 3.1203 -> 1.5219   acc: 40.44% -> 66.98%             
client [8] (test)  loss: 3.6251 -> 1.8127   acc: 32.91% -> 66.93%              
client [35] (test)  loss: 3.7643 -> 1.6970   acc: 31.33% -> 64.86%             
client [98] (test)  loss: 3.4706 -> 1.7886   acc: 33.65% -> 67.86%             
client [53] (test)  loss: 3.1067 -> 2.1246   acc: 37.79% -> 62.02%             
client [43] (test)  loss: 3.2292 -> 2.1091   acc: 36.90% -> 61.98%             
client [64] (test)  loss: 3.1995 -> 1.6390   acc: 37.95% -> 68.32%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.8354 -> 2.0395   acc: 30.60% -> 62.40%             
client [88] (test)  loss: 3.3783 -> 1.9612   acc: 38.40% -> 61.43%             
client [38] (test)  loss: 3.6815 -> 2.2512   acc: 32.40% -> 56.97%             
client [3] (test)  loss: 3.6474 -> 1.7310   acc: 32.19% -> 67.32%              
client [5] (test)  loss: 3.5087 -> 1.8771   acc: 34.41% -> 63.06%              
client [41] (test)  loss: 3.6733 -> 1.5640   acc: 31.14% -> 65.48%             
client [7] (test)  loss: 3.7590 -> 2.1135   acc: 33.93% -> 57.27%              
client [37] (test)  loss: 3.8397 -> 1.8747   acc: 31.01% -> 64.77%             
client [45] (test)  loss: 3.4752 -> 1.9693   acc: 37.53% -> 61.46%             
client [47] (test)  loss: 3.3049 -> 1.2427   acc: 36.53% -> 72.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.3242 -> 1.9128   acc: 38.98% -> 63.57%             
client [11] (test)  loss: 3.4191 -> 2.1476   acc: 37.20% -> 58.48%             
client [37] (test)  loss: 3.6212 -> 1.9231   acc: 32.14% -> 66.23%             
client [41] (test)  loss: 3.5638 -> 1.5520   acc: 32.38% -> 64.59%             
client [95] (test)  loss: 3.2264 -> 2.0267   acc: 35.79% -> 64.00%             
client [53] (test)  loss: 3.7666 -> 2.1375   acc: 29.46% -> 63.18%             
client [22] (test)  loss: 2.5749 -> 1.7135   acc: 45.17% -> 67.65%             
client [25] (test)  loss: 3.4048 -> 2.1123   acc: 40.17% -> 57.04%             
client [69] (test)  loss: 3.5019 -> 2.5313   acc: 38.56% -> 52.66%             
client [46] (test)  loss: 2.4094 -> 1.6172   acc: 48.29% -> 65.23%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.6031 -> 1.3250   acc: 46.47% -> 73.06%             
client [69] (test)  loss: 3.5229 -> 2.5871   acc: 39.63% -> 53.72%             
client [82] (test)  loss: 3.3299 -> 2.0105   acc: 34.58% -> 63.64%             
client [45] (test)  loss: 3.5232 -> 2.0418   acc: 38.95% -> 60.04%             
client [7] (test)  loss: 3.9372 -> 2.1448   acc: 32.14% -> 58.53%              
client [50] (test)  loss: 3.0749 -> 1.6524   acc: 42.83% -> 65.28%             
client [35] (test)  loss: 3.4561 -> 1.7515   acc: 34.34% -> 65.66%             
client [24] (test)  loss: 3.6095 -> 2.1317   acc: 35.07% -> 60.55%             
client [15] (test)  loss: 2.9819 -> 2.0085   acc: 44.23% -> 62.24%             
client [58] (test)  loss: 3.8071 -> 2.5714   acc: 30.04% -> 57.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.1414 -> 1.4858   acc: 41.79% -> 71.77%             
client [76] (test)  loss: 3.2908 -> 2.0102   acc: 40.55% -> 60.91%             
client [67] (test)  loss: 3.2992 -> 1.8885   acc: 40.56% -> 63.84%             
client [37] (test)  loss: 3.8568 -> 1.9786   acc: 32.47% -> 64.61%             
client [58] (test)  loss: 3.4976 -> 2.5460   acc: 37.10% -> 57.77%             
client [64] (test)  loss: 3.2312 -> 1.6279   acc: 39.93% -> 67.49%             
client [77] (test)  loss: 3.3980 -> 1.8688   acc: 41.24% -> 65.64%             
client [55] (test)  loss: 3.1688 -> 1.9916   acc: 41.97% -> 62.41%             
client [12] (test)  loss: 3.4467 -> 1.8896   acc: 38.07% -> 66.97%             
client [89] (test)  loss: 3.6004 -> 2.1156   acc: 33.82% -> 60.76%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.4507 -> 2.1597   acc: 36.52% -> 62.94%             
client [51] (test)  loss: 3.4808 -> 1.8760   acc: 37.64% -> 65.27%             
client [8] (test)  loss: 3.9523 -> 1.9668   acc: 30.37% -> 66.30%              
client [18] (test)  loss: 3.2783 -> 2.4009   acc: 40.25% -> 60.82%             
client [94] (test)  loss: 3.3863 -> 2.1137   acc: 35.70% -> 62.30%             
client [81] (test)  loss: 3.3595 -> 1.7293   acc: 36.83% -> 66.19%             
client [3] (test)  loss: 3.4006 -> 1.8005   acc: 35.95% -> 67.16%              
client [11] (test)  loss: 3.5683 -> 2.2872   acc: 37.72% -> 58.65%             
client [95] (test)  loss: 3.1700 -> 2.1364   acc: 40.63% -> 63.37%             
client [67] (test)  loss: 3.2072 -> 1.9088   acc: 37.21% -> 64.37%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.9258 -> 2.1282   acc: 33.60% -> 60.20%             
client [79] (test)  loss: 4.3312 -> 2.6795   acc: 32.05% -> 52.99%             
client [58] (test)  loss: 3.7351 -> 2.6410   acc: 33.92% -> 57.24%             
client [88] (test)  loss: 3.3911 -> 2.1088   acc: 39.93% -> 61.60%             
client [46] (test)  loss: 2.8188 -> 1.6793   acc: 43.24% -> 67.03%             
client [11] (test)  loss: 3.6442 -> 2.2973   acc: 37.72% -> 58.82%             
client [55] (test)  loss: 3.0047 -> 2.1457   acc: 46.35% -> 62.04%             
client [13] (test)  loss: 3.4044 -> 2.1902   acc: 41.47% -> 62.12%             
client [31] (test)  loss: 3.2860 -> 1.3136   acc: 39.55% -> 73.87%             
client [75] (test)  loss: 3.7686 -> 2.0708   acc: 38.96% -> 63.83%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.5818 -> 2.2667   acc: 37.23% -> 60.97%             
client [7] (test)  loss: 4.0916 -> 2.4194   acc: 32.50% -> 57.09%              
client [57] (test)  loss: 3.4541 -> 2.4251   acc: 40.91% -> 54.55%             
client [13] (test)  loss: 3.6854 -> 2.2427   acc: 38.05% -> 62.46%             
client [43] (test)  loss: 3.6521 -> 2.3114   acc: 36.90% -> 61.66%             
client [91] (test)  loss: 3.1555 -> 1.7453   acc: 44.50% -> 67.17%             
client [10] (test)  loss: 3.5873 -> 2.0851   acc: 40.11% -> 61.94%             
client [64] (test)  loss: 2.8385 -> 1.8349   acc: 48.18% -> 66.17%             
client [82] (test)  loss: 3.0610 -> 2.0860   acc: 42.37% -> 64.29%             
client [22] (test)  loss: 2.5512 -> 1.8816   acc: 49.51% -> 66.27%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.3634 -> 1.8838   acc: 44.46% -> 64.19%             
client [23] (test)  loss: 3.4662 -> 1.6997   acc: 43.54% -> 67.79%             
client [88] (test)  loss: 3.9313 -> 2.2117   acc: 35.84% -> 60.58%             
client [98] (test)  loss: 3.1684 -> 2.0205   acc: 41.02% -> 67.86%             
client [79] (test)  loss: 4.2386 -> 2.7696   acc: 36.11% -> 51.50%             
client [21] (test)  loss: 4.2052 -> 2.1416   acc: 32.40% -> 59.40%             
client [92] (test)  loss: 3.5804 -> 1.6990   acc: 36.33% -> 64.88%             
client [56] (test)  loss: 3.6883 -> 2.5105   acc: 38.08% -> 55.69%             
client [5] (test)  loss: 3.4732 -> 2.1074   acc: 39.10% -> 62.70%              
client [52] (test)  loss: 3.2828 -> 2.0734   acc: 43.79% -> 65.43%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.2704 -> 0.0000', 'accuracy': '37.00% -> 0.00%'},          
    200: {'loss': '3.6926 -> 0.0000', 'accuracy': '38.53% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(11.94%) at epoch: 7                                      
FedAvg achieved 20.0%(20.74%) at epoch: 13                                     
FedAvg achieved 30.0%(30.11%) at epoch: 28                                     
FedAvg achieved 40.0%(40.66%) at epoch: 136                                    
Convergence (test_after):                                                      
FedAvg achieved 10.0%(17.80%) at epoch: 0                                      
FedAvg achieved 20.0%(20.62%) at epoch: 1                                      
FedAvg achieved 30.0%(35.52%) at epoch: 2                                      
FedAvg achieved 40.0%(43.96%) at epoch: 3                                      
FedAvg achieved 50.0%(52.80%) at epoch: 7                                      
FedAvg achieved 60.0%(60.33%) at epoch: 29                                     
