==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG',                                                    
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.0691 -> 0.0048   acc: 48.17% -> 100.00%            
client [81] (test)  loss: 0.8555 -> 0.5914   acc: 73.64% -> 65.45%             
client [21] (test)  loss: 2.6935 -> 0.5227   acc: 30.68% -> 85.02%             
client [68] (test)  loss: 0.3185 -> 0.1335   acc: 91.64% -> 95.82%             
client [93] (test)  loss: 2.0672 -> 0.2034   acc: 25.60% -> 98.40%             
client [31] (test)  loss: 1.0941 -> 0.8788   acc: 60.00% -> 45.00%             
client [20] (test)  loss: 0.6680 -> 0.0348   acc: 87.67% -> 99.33%             
client [59] (test)  loss: 1.3766 -> 0.3663   acc: 68.06% -> 87.74%             
client [48] (test)  loss: 1.3453 -> 0.0954   acc: 36.88% -> 98.12%             
client [34] (test)  loss: 0.4567 -> 0.2179   acc: 91.18% -> 92.65%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6111 -> 0.2320   acc: 75.47% -> 92.00%             
client [99] (test)  loss: 1.5219 -> 0.0683   acc: 39.49% -> 98.30%             
client [67] (test)  loss: 2.7047 -> 0.1569   acc: 13.10% -> 96.58%             
client [0] (test)  loss: 0.6287 -> 0.6141   acc: 82.24% -> 85.05%              
client [76] (test)  loss: 0.4618 -> 0.2167   acc: 73.68% -> 94.74%             
client [41] (test)  loss: 0.3645 -> 0.3093   acc: 88.34% -> 90.80%             
client [62] (test)  loss: 0.9930 -> 0.2228   acc: 64.29% -> 92.86%             
client [2] (test)  loss: 0.7431 -> 0.0001   acc: 77.56% -> 100.00%             
client [14] (test)  loss: 1.6573 -> 0.1543   acc: 35.97% -> 97.18%             
client [46] (test)  loss: 2.7676 -> 0.3447   acc: 9.69% -> 91.19%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7164 -> 0.4869   acc: 74.61% -> 86.27%             
client [68] (test)  loss: 0.3356 -> 0.1095   acc: 86.41% -> 96.52%             
client [57] (test)  loss: 1.1036 -> 0.0520   acc: 46.62% -> 99.25%             
client [17] (test)  loss: 0.5739 -> 0.1962   acc: 82.04% -> 94.20%             
client [54] (test)  loss: 0.4664 -> 0.1616   acc: 81.35% -> 93.26%             
client [23] (test)  loss: 0.3264 -> 0.0977   acc: 87.97% -> 96.62%             
client [35] (test)  loss: 0.5704 -> 0.1654   acc: 81.21% -> 94.55%             
client [59] (test)  loss: 0.5595 -> 0.2706   acc: 82.26% -> 90.97%             
client [31] (test)  loss: 0.2795 -> 0.1103   acc: 92.78% -> 97.22%             
client [9] (test)  loss: 0.2353 -> 0.0440   acc: 92.74% -> 98.96%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3418 -> 0.1426   acc: 87.65% -> 96.47%             
client [33] (test)  loss: 0.2488 -> 0.1087   acc: 90.87% -> 97.03%             
client [16] (test)  loss: 0.6979 -> 0.0557   acc: 72.38% -> 98.60%             
client [44] (test)  loss: 0.4872 -> 0.1460   acc: 82.05% -> 96.34%             
client [8] (test)  loss: 0.8261 -> 0.0005   acc: 69.14% -> 100.00%             
client [31] (test)  loss: 0.4698 -> 0.1133   acc: 86.67% -> 98.33%             
client [47] (test)  loss: 0.2727 -> 0.0185   acc: 91.73% -> 99.63%             
client [36] (test)  loss: 0.0805 -> 0.0023   acc: 97.54% -> 100.00%            
client [20] (test)  loss: 0.9536 -> 0.0222   acc: 70.33% -> 99.50%             
client [56] (test)  loss: 0.7319 -> 0.4181   acc: 72.76% -> 90.24%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7064 -> 0.0954   acc: 78.55% -> 97.58%              
client [60] (test)  loss: 0.8988 -> 0.1059   acc: 63.83% -> 98.07%             
client [28] (test)  loss: 0.2504 -> 0.0624   acc: 92.86% -> 97.32%             
client [25] (test)  loss: 0.6606 -> 0.1009   acc: 82.23% -> 97.21%             
client [58] (test)  loss: 0.8937 -> 0.1001   acc: 75.00% -> 97.45%             
client [44] (test)  loss: 1.0623 -> 0.1656   acc: 72.53% -> 95.60%             
client [39] (test)  loss: 0.3080 -> 0.1780   acc: 91.67% -> 94.44%             
client [29] (test)  loss: 1.3561 -> 0.2266   acc: 63.47% -> 93.15%             
client [3] (test)  loss: 0.8718 -> 0.1440   acc: 69.75% -> 94.93%              
client [84] (test)  loss: 1.7971 -> 0.0062   acc: 58.26% -> 100.00%            
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3461 -> 0.2742   acc: 90.10% -> 89.61%             
client [84] (test)  loss: 1.0105 -> 0.0292   acc: 64.68% -> 99.08%             
client [10] (test)  loss: 0.1609 -> 0.0886   acc: 94.93% -> 98.55%             
client [36] (test)  loss: 0.0727 -> 0.0019   acc: 97.54% -> 99.88%             
client [65] (test)  loss: 1.3322 -> 0.2807   acc: 51.19% -> 94.05%             
client [81] (test)  loss: 0.4959 -> 0.1160   acc: 87.27% -> 95.45%             
client [79] (test)  loss: 0.7766 -> 0.3806   acc: 73.22% -> 88.45%             
client [42] (test)  loss: 0.4474 -> 0.0332   acc: 86.85% -> 99.23%             
client [11] (test)  loss: 0.4758 -> 0.3305   acc: 84.89% -> 87.56%             
client [96] (test)  loss: 0.3906 -> 0.3980   acc: 87.36% -> 85.67%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3574 -> 0.0004   acc: 91.67% -> 100.00%             
client [53] (test)  loss: 0.1525 -> 0.0362   acc: 95.85% -> 99.39%             
client [52] (test)  loss: 0.9336 -> 0.3356   acc: 66.67% -> 89.15%             
client [42] (test)  loss: 0.1601 -> 0.0290   acc: 94.65% -> 99.29%             
client [69] (test)  loss: 0.2365 -> 0.1756   acc: 92.27% -> 94.13%             
client [59] (test)  loss: 0.4535 -> 0.3180   acc: 86.13% -> 91.29%             
client [7] (test)  loss: 0.4050 -> 0.0349   acc: 87.11% -> 98.71%              
client [26] (test)  loss: 0.6416 -> 0.0177   acc: 80.97% -> 99.68%             
client [49] (test)  loss: 0.5733 -> 0.0231   acc: 78.98% -> 99.58%             
client [98] (test)  loss: 0.5588 -> 0.5774   acc: 82.00% -> 69.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6427 -> 0.3733   acc: 74.00% -> 87.00%             
client [47] (test)  loss: 0.5273 -> 0.0221   acc: 80.70% -> 99.45%             
client [21] (test)  loss: 0.2745 -> 0.2044   acc: 91.30% -> 93.48%             
client [77] (test)  loss: 0.1220 -> 0.0308   acc: 96.62% -> 99.15%             
client [95] (test)  loss: 0.3847 -> 0.1397   acc: 87.97% -> 96.24%             
client [91] (test)  loss: 0.6811 -> 0.0869   acc: 65.62% -> 96.88%             
client [14] (test)  loss: 0.1706 -> 0.1645   acc: 95.57% -> 97.58%             
client [99] (test)  loss: 0.0936 -> 0.0544   acc: 97.73% -> 98.86%             
client [20] (test)  loss: 1.4631 -> 0.0138   acc: 39.83% -> 99.67%             
client [39] (test)  loss: 0.1506 -> 0.2175   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8180 -> 0.2377   acc: 71.32% -> 93.02%             
client [62] (test)  loss: 0.3764 -> 0.0984   acc: 88.10% -> 97.62%             
client [71] (test)  loss: 0.1273 -> 0.0367   acc: 95.48% -> 98.92%             
client [97] (test)  loss: 0.2861 -> 0.0568   acc: 91.63% -> 99.18%             
client [30] (test)  loss: 0.4201 -> 0.1686   acc: 86.89% -> 96.25%             
client [88] (test)  loss: 1.2515 -> 0.5233   acc: 56.91% -> 79.56%             
client [60] (test)  loss: 0.7627 -> 0.1305   acc: 72.92% -> 98.07%             
client [82] (test)  loss: 1.5439 -> 0.0422   acc: 48.56% -> 99.52%             
client [91] (test)  loss: 0.5696 -> 0.0515   acc: 81.25% -> 96.88%             
client [57] (test)  loss: 1.3838 -> 0.0417   acc: 50.94% -> 99.44%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4746 -> 0.1066   acc: 81.67% -> 97.78%             
client [15] (test)  loss: 0.8047 -> 0.2895   acc: 72.82% -> 89.17%             
client [71] (test)  loss: 0.1733 -> 0.0357   acc: 94.21% -> 98.73%             
client [97] (test)  loss: 0.3978 -> 0.0521   acc: 88.34% -> 99.18%             
client [53] (test)  loss: 0.1531 -> 0.0322   acc: 95.96% -> 99.39%             
client [77] (test)  loss: 0.0345 -> 0.0136   acc: 99.15% -> 99.72%             
client [76] (test)  loss: 0.3046 -> 0.1815   acc: 86.84% -> 92.11%             
client [79] (test)  loss: 0.7577 -> 0.3392   acc: 72.73% -> 88.94%             
client [28] (test)  loss: 0.3323 -> 0.0547   acc: 85.71% -> 98.21%             
client [99] (test)  loss: 1.0077 -> 0.0544   acc: 66.48% -> 98.58%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3333 -> 0.0536   acc: 91.13% -> 99.34%             
client [86] (test)  loss: 0.2641 -> 0.1626   acc: 92.98% -> 96.49%             
client [34] (test)  loss: 0.2143 -> 0.1619   acc: 91.18% -> 97.06%             
client [73] (test)  loss: 0.6046 -> 0.0197   acc: 81.79% -> 99.29%             
client [5] (test)  loss: 0.6072 -> 0.0298   acc: 79.26% -> 98.91%              
client [96] (test)  loss: 0.3480 -> 0.1349   acc: 89.33% -> 95.79%             
client [22] (test)  loss: 0.3927 -> 0.0637   acc: 83.49% -> 97.64%             
client [60] (test)  loss: 0.5011 -> 0.1253   acc: 80.27% -> 98.26%             
client [66] (test)  loss: 0.8161 -> 0.0027   acc: 81.28% -> 99.73%             
client [83] (test)  loss: 0.3528 -> 0.0328   acc: 88.58% -> 98.73%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1499 -> 0.1733   acc: 92.11% -> 94.74%             
client [65] (test)  loss: 1.3147 -> 0.2600   acc: 60.71% -> 91.67%             
client [95] (test)  loss: 0.1986 -> 0.1110   acc: 90.23% -> 96.24%             
client [17] (test)  loss: 0.3803 -> 0.1692   acc: 90.33% -> 96.13%             
client [8] (test)  loss: 0.5373 -> 0.0006   acc: 85.59% -> 100.00%             
client [35] (test)  loss: 0.3524 -> 0.1055   acc: 90.91% -> 96.36%             
client [98] (test)  loss: 0.5991 -> 0.2434   acc: 81.00% -> 90.00%             
client [53] (test)  loss: 0.1024 -> 0.0309   acc: 96.97% -> 99.49%             
client [43] (test)  loss: 0.7841 -> 0.1344   acc: 75.56% -> 96.30%             
client [64] (test)  loss: 0.1666 -> 0.0888   acc: 95.29% -> 97.35%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2300 -> 0.1636   acc: 93.00% -> 94.69%             
client [88] (test)  loss: 0.7885 -> 0.4334   acc: 72.38% -> 87.29%             
client [38] (test)  loss: 0.8178 -> 0.5031   acc: 79.39% -> 89.09%             
client [3] (test)  loss: 0.4262 -> 0.1361   acc: 87.32% -> 96.20%              
client [5] (test)  loss: 0.5966 -> 0.0354   acc: 79.69% -> 98.91%              
client [41] (test)  loss: 0.2308 -> 0.2041   acc: 92.88% -> 95.47%             
client [7] (test)  loss: 0.4106 -> 0.0462   acc: 87.66% -> 98.71%              
client [37] (test)  loss: 0.4218 -> 0.1085   acc: 88.66% -> 96.91%             
client [45] (test)  loss: 0.4614 -> 0.3533   acc: 84.62% -> 88.46%             
client [47] (test)  loss: 0.5052 -> 0.0174   acc: 85.29% -> 99.26%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.6100 -> 0.0743   acc: 47.90% -> 98.25%             
client [11] (test)  loss: 3.2529 -> 0.2756   acc: 26.44% -> 90.44%             
client [37] (test)  loss: 3.2637 -> 0.2384   acc: 16.49% -> 94.33%             
client [41] (test)  loss: 0.9641 -> 0.1950   acc: 76.42% -> 95.85%             
client [95] (test)  loss: 0.6104 -> 0.1219   acc: 82.71% -> 96.24%             
client [53] (test)  loss: 0.1949 -> 0.0306   acc: 94.54% -> 99.39%             
client [22] (test)  loss: 2.6691 -> 0.0995   acc: 39.62% -> 97.17%             
client [25] (test)  loss: 0.2994 -> 0.0278   acc: 90.59% -> 99.30%             
client [69] (test)  loss: 0.6383 -> 0.1375   acc: 82.93% -> 95.20%             
client [46] (test)  loss: 0.4422 -> 0.3962   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2551 -> 0.0176   acc: 92.46% -> 99.63%             
client [69] (test)  loss: 0.4936 -> 0.1519   acc: 84.53% -> 94.13%             
client [82] (test)  loss: 0.5029 -> 0.0410   acc: 79.49% -> 99.52%             
client [45] (test)  loss: 0.3867 -> 0.3612   acc: 88.46% -> 91.03%             
client [7] (test)  loss: 0.2480 -> 0.0506   acc: 92.08% -> 98.34%              
client [50] (test)  loss: 0.8805 -> 0.0003   acc: 67.71% -> 100.00%            
client [35] (test)  loss: 0.6587 -> 0.0893   acc: 75.76% -> 98.18%             
client [24] (test)  loss: 0.6724 -> 0.6948   acc: 78.24% -> 84.72%             
client [15] (test)  loss: 0.6395 -> 0.1624   acc: 80.25% -> 94.90%             
client [58] (test)  loss: 0.1854 -> 0.0392   acc: 94.16% -> 98.54%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2802 -> 0.0120   acc: 91.25% -> 99.38%             
client [76] (test)  loss: 0.1744 -> 0.1324   acc: 92.11% -> 97.37%             
client [67] (test)  loss: 1.8073 -> 0.1040   acc: 44.79% -> 97.17%             
client [37] (test)  loss: 0.2162 -> 0.0919   acc: 93.30% -> 97.42%             
client [58] (test)  loss: 0.0839 -> 0.0379   acc: 96.90% -> 98.72%             
client [64] (test)  loss: 0.1109 -> 0.0670   acc: 95.29% -> 98.24%             
client [77] (test)  loss: 0.0418 -> 0.0228   acc: 98.87% -> 99.72%             
client [55] (test)  loss: 0.1056 -> 0.0117   acc: 98.09% -> 99.90%             
client [12] (test)  loss: 1.9641 -> 0.3955   acc: 44.88% -> 91.98%             
client [89] (test)  loss: 1.2265 -> 1.0342   acc: 69.05% -> 85.71%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6768 -> 0.0026   acc: 76.61% -> 100.00%            
client [51] (test)  loss: 0.6787 -> 0.0148   acc: 77.18% -> 99.49%             
client [8] (test)  loss: 0.8350 -> 0.0011   acc: 77.70% -> 100.00%             
client [18] (test)  loss: 0.1407 -> 0.0094   acc: 96.84% -> 99.76%             
client [94] (test)  loss: 0.3254 -> 0.1363   acc: 89.36% -> 95.39%             
client [81] (test)  loss: 0.6424 -> 0.0438   acc: 79.09% -> 99.09%             
client [3] (test)  loss: 0.5179 -> 0.1261   acc: 84.78% -> 95.83%              
client [11] (test)  loss: 0.7829 -> 0.3488   acc: 76.00% -> 87.78%             
client [95] (test)  loss: 0.4523 -> 0.0996   acc: 85.71% -> 95.49%             
client [67] (test)  loss: 1.2040 -> 0.1107   acc: 58.93% -> 97.02%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1717 -> 0.1656   acc: 94.93% -> 95.17%             
client [79] (test)  loss: 0.7267 -> 0.3380   acc: 78.38% -> 92.14%             
client [58] (test)  loss: 0.0906 -> 0.0396   acc: 96.90% -> 98.36%             
client [88] (test)  loss: 1.1448 -> 0.6089   acc: 66.85% -> 84.53%             
client [46] (test)  loss: 1.5390 -> 0.4116   acc: 54.19% -> 92.07%             
client [11] (test)  loss: 0.6394 -> 0.7355   acc: 81.78% -> 85.11%             
client [55] (test)  loss: 0.0812 -> 0.0131   acc: 98.09% -> 99.62%             
client [13] (test)  loss: 0.6117 -> 0.0092   acc: 82.79% -> 99.73%             
client [31] (test)  loss: 0.3476 -> 0.0756   acc: 89.44% -> 97.22%             
client [75] (test)  loss: 0.7306 -> 0.2704   acc: 80.15% -> 91.77%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4882 -> 0.2240   acc: 82.68% -> 92.91%             
client [7] (test)  loss: 0.3325 -> 0.0624   acc: 90.61% -> 98.16%              
client [57] (test)  loss: 0.8414 -> 0.0507   acc: 69.36% -> 99.62%             
client [13] (test)  loss: 0.6804 -> 0.0144   acc: 81.69% -> 99.45%             
client [43] (test)  loss: 1.0374 -> 0.1483   acc: 71.11% -> 97.04%             
client [91] (test)  loss: 0.2808 -> 0.0516   acc: 93.75% -> 96.88%             
client [10] (test)  loss: 0.1412 -> 0.0690   acc: 97.10% -> 98.55%             
client [64] (test)  loss: 0.2727 -> 0.0710   acc: 92.35% -> 97.94%             
client [82] (test)  loss: 0.8341 -> 0.0445   acc: 69.39% -> 99.52%             
client [22] (test)  loss: 0.5484 -> 0.1113   acc: 81.13% -> 97.17%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1004 -> 0.0256   acc: 67.67% -> 99.33%             
client [23] (test)  loss: 0.3138 -> 0.0815   acc: 89.10% -> 96.62%             
client [88] (test)  loss: 0.8068 -> 0.6471   acc: 74.03% -> 86.19%             
client [98] (test)  loss: 1.8764 -> 0.3422   acc: 57.00% -> 89.00%             
client [79] (test)  loss: 0.7310 -> 0.3903   acc: 76.41% -> 91.40%             
client [21] (test)  loss: 0.2102 -> 0.1590   acc: 93.72% -> 95.17%             
client [92] (test)  loss: 0.2397 -> 0.1270   acc: 94.18% -> 95.55%             
client [56] (test)  loss: 1.3899 -> 0.4164   acc: 59.76% -> 89.02%             
client [5] (test)  loss: 0.4070 -> 0.0387   acc: 87.55% -> 98.91%              
client [52] (test)  loss: 0.5091 -> 0.1940   acc: 86.82% -> 93.02%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.5553 -> 0.0000', 'accuracy': '81.54% -> 0.00%'},          
    200: {'loss': '0.6239 -> 0.0000', 'accuracy': '82.29% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(15.73%) at epoch: 1                                      
FedAvg achieved 20.0%(27.21%) at epoch: 2                                      
FedAvg achieved 30.0%(30.65%) at epoch: 3                                      
FedAvg achieved 40.0%(40.50%) at epoch: 4                                      
FedAvg achieved 50.0%(58.27%) at epoch: 8                                      
FedAvg achieved 60.0%(62.86%) at epoch: 9                                      
FedAvg achieved 70.0%(77.37%) at epoch: 11                                     
FedAvg achieved 80.0%(82.13%) at epoch: 18                                     
FedAvg achieved 90.0%(90.55%) at epoch: 67                                     
Convergence (test_after):                                                      
FedAvg achieved 80.0%(82.05%) at epoch: 0                                      
FedAvg achieved 90.0%(93.87%) at epoch: 2                                      
