==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.2693 -> 1.9323   acc: 13.48% -> 58.93%             
client [81] (test)  loss: 4.3480 -> 2.3326   acc: 18.35% -> 56.96%             
client [21] (test)  loss: 5.2029 -> 2.7713   acc: 7.20% -> 43.52%              
client [68] (test)  loss: 4.4234 -> 1.9918   acc: 6.39% -> 53.99%              
client [93] (test)  loss: 4.6741 -> 3.0409   acc: 3.74% -> 37.07%              
client [31] (test)  loss: 4.1580 -> 2.1192   acc: 17.36% -> 52.73%             
client [20] (test)  loss: 3.6613 -> 1.0621   acc: 19.41% -> 74.01%             
client [59] (test)  loss: 3.8869 -> 1.9704   acc: 12.26% -> 55.81%             
client [48] (test)  loss: 4.2670 -> 3.3023   acc: 14.05% -> 30.07%             
client [34] (test)  loss: 4.0042 -> 2.2266   acc: 13.91% -> 44.37%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.8147 -> 1.0365   acc: 39.66% -> 78.75%             
client [99] (test)  loss: 4.4215 -> 3.1638   acc: 11.78% -> 33.12%             
client [67] (test)  loss: 4.1707 -> 2.0927   acc: 15.67% -> 56.43%             
client [0] (test)  loss: 3.7155 -> 2.5788   acc: 18.02% -> 46.40%              
client [76] (test)  loss: 4.5841 -> 2.5178   acc: 8.97% -> 47.84%              
client [41] (test)  loss: 4.3170 -> 2.5665   acc: 14.00% -> 50.33%             
client [62] (test)  loss: 4.4124 -> 2.3274   acc: 11.80% -> 41.31%             
client [2] (test)  loss: 4.3567 -> 2.3607   acc: 13.85% -> 50.77%              
client [14] (test)  loss: 4.8745 -> 2.6365   acc: 12.94% -> 47.65%             
client [46] (test)  loss: 4.7478 -> 1.8759   acc: 12.40% -> 64.80%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.1165 -> 1.8667   acc: 31.18% -> 59.70%             
client [68] (test)  loss: 3.9491 -> 1.5690   acc: 17.57% -> 65.81%             
client [57] (test)  loss: 3.5506 -> 2.1369   acc: 28.38% -> 55.12%             
client [17] (test)  loss: 4.1548 -> 2.3080   acc: 20.95% -> 48.25%             
client [54] (test)  loss: 4.1527 -> 1.9492   acc: 20.65% -> 59.24%             
client [23] (test)  loss: 3.7472 -> 2.1939   acc: 23.05% -> 55.08%             
client [35] (test)  loss: 4.9535 -> 2.0463   acc: 8.67% -> 57.33%              
client [59] (test)  loss: 3.0850 -> 1.6374   acc: 31.29% -> 65.48%             
client [31] (test)  loss: 3.3331 -> 2.0747   acc: 28.30% -> 55.63%             
client [9] (test)  loss: 3.8252 -> 1.9867   acc: 19.64% -> 54.68%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.6991 -> 1.6962   acc: 17.37% -> 63.31%             
client [33] (test)  loss: 3.7448 -> 2.6231   acc: 25.37% -> 53.73%             
client [16] (test)  loss: 3.5550 -> 1.9284   acc: 30.70% -> 59.44%             
client [44] (test)  loss: 3.7089 -> 2.2581   acc: 20.92% -> 47.39%             
client [8] (test)  loss: 3.3673 -> 2.0535   acc: 26.60% -> 58.97%              
client [31] (test)  loss: 3.5184 -> 2.0082   acc: 26.69% -> 55.31%             
client [47] (test)  loss: 4.4956 -> 2.1496   acc: 16.54% -> 53.76%             
client [36] (test)  loss: 3.4295 -> 2.4051   acc: 24.31% -> 51.74%             
client [20] (test)  loss: 4.2595 -> 1.0152   acc: 25.33% -> 77.96%             
client [56] (test)  loss: 3.3353 -> 2.0335   acc: 30.69% -> 52.48%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.4958 -> 1.3128   acc: 22.61% -> 73.57%              
client [60] (test)  loss: 4.5232 -> 2.5287   acc: 12.18% -> 50.64%             
client [28] (test)  loss: 3.8052 -> 1.9910   acc: 21.60% -> 58.89%             
client [25] (test)  loss: 3.9374 -> 1.8129   acc: 21.52% -> 63.29%             
client [58] (test)  loss: 3.9543 -> 2.1264   acc: 21.52% -> 50.63%             
client [44] (test)  loss: 3.5749 -> 2.2040   acc: 27.12% -> 50.33%             
client [39] (test)  loss: 3.1651 -> 1.9725   acc: 30.74% -> 55.34%             
client [29] (test)  loss: 4.1399 -> 2.0839   acc: 14.29% -> 56.29%             
client [3] (test)  loss: 2.8725 -> 1.7314   acc: 33.94% -> 63.00%              
client [84] (test)  loss: 3.1154 -> 2.2045   acc: 33.54% -> 53.73%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.1171 -> 1.8942   acc: 23.05% -> 57.93%             
client [84] (test)  loss: 3.2805 -> 2.2674   acc: 33.23% -> 55.90%             
client [10] (test)  loss: 3.6865 -> 2.0705   acc: 21.03% -> 60.71%             
client [36] (test)  loss: 3.8174 -> 2.2295   acc: 26.39% -> 53.82%             
client [65] (test)  loss: 3.7140 -> 2.4594   acc: 29.55% -> 53.85%             
client [81] (test)  loss: 3.2610 -> 1.8835   acc: 34.49% -> 65.19%             
client [79] (test)  loss: 2.8121 -> 1.1076   acc: 38.42% -> 78.53%             
client [42] (test)  loss: 3.2368 -> 1.8657   acc: 35.18% -> 63.19%             
client [11] (test)  loss: 3.5450 -> 1.9051   acc: 29.14% -> 61.66%             
client [96] (test)  loss: 3.8093 -> 1.5873   acc: 21.05% -> 64.71%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.1734 -> 1.9964   acc: 33.01% -> 61.22%              
client [53] (test)  loss: 3.3496 -> 1.6088   acc: 32.34% -> 63.77%             
client [52] (test)  loss: 3.4478 -> 1.8910   acc: 26.91% -> 60.47%             
client [42] (test)  loss: 3.0992 -> 1.8241   acc: 37.13% -> 65.15%             
client [69] (test)  loss: 2.3382 -> 0.9240   acc: 47.59% -> 78.75%             
client [59] (test)  loss: 3.0842 -> 1.5653   acc: 31.61% -> 67.42%             
client [7] (test)  loss: 3.2524 -> 1.6253   acc: 29.77% -> 65.05%              
client [26] (test)  loss: 3.3517 -> 2.3829   acc: 27.69% -> 56.92%             
client [49] (test)  loss: 2.5929 -> 1.8538   acc: 45.11% -> 66.67%             
client [98] (test)  loss: 3.4246 -> 2.7106   acc: 28.75% -> 51.56%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.0390 -> 2.5922   acc: 34.06% -> 52.50%             
client [47] (test)  loss: 4.3015 -> 1.9625   acc: 20.68% -> 57.52%             
client [21] (test)  loss: 3.7111 -> 1.8556   acc: 24.50% -> 59.65%             
client [77] (test)  loss: 3.9024 -> 1.7722   acc: 26.65% -> 67.40%             
client [95] (test)  loss: 3.2525 -> 1.9108   acc: 33.33% -> 63.04%             
client [91] (test)  loss: 3.8656 -> 1.7952   acc: 26.69% -> 66.56%             
client [14] (test)  loss: 3.3390 -> 2.2789   acc: 32.35% -> 54.12%             
client [99] (test)  loss: 3.6444 -> 2.6813   acc: 23.89% -> 45.54%             
client [20] (test)  loss: 3.0663 -> 0.9426   acc: 37.83% -> 79.93%             
client [39] (test)  loss: 2.9896 -> 1.7524   acc: 33.98% -> 56.96%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.0525 -> 1.8340   acc: 35.55% -> 62.46%             
client [62] (test)  loss: 3.1700 -> 2.1623   acc: 27.54% -> 52.13%             
client [71] (test)  loss: 3.1932 -> 2.4408   acc: 36.36% -> 54.55%             
client [97] (test)  loss: 3.2102 -> 1.9965   acc: 35.34% -> 56.47%             
client [30] (test)  loss: 2.8263 -> 2.0874   acc: 39.24% -> 56.96%             
client [88] (test)  loss: 3.3532 -> 1.6870   acc: 28.48% -> 65.89%             
client [60] (test)  loss: 4.1893 -> 2.4907   acc: 16.67% -> 51.92%             
client [82] (test)  loss: 3.7283 -> 1.9395   acc: 26.99% -> 60.21%             
client [91] (test)  loss: 3.4894 -> 1.8138   acc: 30.87% -> 66.24%             
client [57] (test)  loss: 2.8051 -> 1.9113   acc: 44.22% -> 58.75%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.8545 -> 1.7957   acc: 39.55% -> 61.09%             
client [15] (test)  loss: 3.5479 -> 2.1245   acc: 27.53% -> 58.23%             
client [71] (test)  loss: 3.5448 -> 2.3865   acc: 29.55% -> 52.92%             
client [97] (test)  loss: 3.1965 -> 1.9428   acc: 34.05% -> 60.34%             
client [53] (test)  loss: 3.1853 -> 1.6090   acc: 37.43% -> 64.07%             
client [77] (test)  loss: 3.4065 -> 1.7287   acc: 28.21% -> 68.65%             
client [76] (test)  loss: 3.9309 -> 2.4021   acc: 20.27% -> 53.49%             
client [79] (test)  loss: 2.6396 -> 1.0077   acc: 40.68% -> 80.51%             
client [28] (test)  loss: 3.3183 -> 2.0195   acc: 29.97% -> 63.41%             
client [99] (test)  loss: 3.7214 -> 2.6242   acc: 24.52% -> 49.68%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.9608 -> 1.9084   acc: 41.81% -> 59.91%             
client [86] (test)  loss: 3.1702 -> 1.6787   acc: 32.54% -> 65.07%             
client [34] (test)  loss: 2.9698 -> 1.8853   acc: 39.40% -> 61.26%             
client [73] (test)  loss: 2.8043 -> 2.0076   acc: 41.33% -> 56.33%             
client [5] (test)  loss: 3.4341 -> 1.8912   acc: 29.39% -> 64.86%              
client [96] (test)  loss: 3.7638 -> 1.6683   acc: 25.39% -> 67.80%             
client [22] (test)  loss: 3.7298 -> 2.3431   acc: 28.97% -> 51.09%             
client [60] (test)  loss: 3.8914 -> 2.3927   acc: 21.79% -> 53.85%             
client [66] (test)  loss: 3.3185 -> 1.5527   acc: 32.69% -> 69.58%             
client [83] (test)  loss: 4.0830 -> 1.9548   acc: 19.21% -> 61.92%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.0681 -> 2.4519   acc: 23.26% -> 53.16%             
client [65] (test)  loss: 3.8160 -> 2.3118   acc: 32.39% -> 59.11%             
client [95] (test)  loss: 3.1291 -> 1.8079   acc: 33.00% -> 65.35%             
client [17] (test)  loss: 3.6790 -> 2.1140   acc: 29.84% -> 53.97%             
client [8] (test)  loss: 2.9995 -> 2.0540   acc: 39.74% -> 61.86%              
client [35] (test)  loss: 3.9267 -> 1.8630   acc: 23.67% -> 62.00%             
client [98] (test)  loss: 3.1687 -> 2.6147   acc: 33.44% -> 54.06%             
client [53] (test)  loss: 2.7325 -> 1.7006   acc: 46.71% -> 65.57%             
client [43] (test)  loss: 3.7691 -> 2.4206   acc: 25.15% -> 55.45%             
client [64] (test)  loss: 3.4789 -> 1.6610   acc: 27.73% -> 66.67%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.5739 -> 1.8805   acc: 29.11% -> 59.65%             
client [88] (test)  loss: 3.2318 -> 1.7371   acc: 33.44% -> 68.54%             
client [38] (test)  loss: 3.6767 -> 1.9356   acc: 26.63% -> 61.76%             
client [3] (test)  loss: 3.3336 -> 1.5272   acc: 36.39% -> 68.81%              
client [5] (test)  loss: 3.6451 -> 1.8670   acc: 31.63% -> 64.22%              
client [41] (test)  loss: 3.7074 -> 2.0297   acc: 28.67% -> 58.00%             
client [7] (test)  loss: 3.3258 -> 1.5750   acc: 37.22% -> 68.61%              
client [37] (test)  loss: 4.1124 -> 2.1550   acc: 28.62% -> 55.95%             
client [45] (test)  loss: 4.1598 -> 2.1325   acc: 25.67% -> 57.33%             
client [47] (test)  loss: 3.8957 -> 1.9415   acc: 24.06% -> 57.52%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.2929 -> 1.9299   acc: 33.80% -> 61.69%             
client [11] (test)  loss: 3.2133 -> 1.8143   acc: 34.66% -> 67.79%             
client [37] (test)  loss: 3.7946 -> 2.0982   acc: 32.48% -> 57.23%             
client [41] (test)  loss: 3.5734 -> 2.0348   acc: 31.00% -> 58.00%             
client [95] (test)  loss: 3.5870 -> 1.8736   acc: 30.69% -> 66.34%             
client [53] (test)  loss: 3.1921 -> 1.6908   acc: 42.22% -> 63.77%             
client [22] (test)  loss: 3.5046 -> 2.3686   acc: 34.27% -> 52.34%             
client [25] (test)  loss: 3.3770 -> 1.5010   acc: 29.54% -> 68.78%             
client [69] (test)  loss: 3.0149 -> 0.9936   acc: 36.83% -> 79.04%             
client [46] (test)  loss: 2.5618 -> 1.4489   acc: 43.60% -> 72.00%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.7326 -> 2.0291   acc: 24.81% -> 60.53%             
client [69] (test)  loss: 2.7607 -> 0.9973   acc: 43.34% -> 79.60%             
client [82] (test)  loss: 3.7395 -> 1.9296   acc: 29.07% -> 64.36%             
client [45] (test)  loss: 4.1795 -> 2.2615   acc: 26.00% -> 55.67%             
client [7] (test)  loss: 3.2173 -> 1.6080   acc: 38.51% -> 66.99%              
client [50] (test)  loss: 4.2658 -> 1.8536   acc: 22.22% -> 62.01%             
client [35] (test)  loss: 3.4619 -> 1.9447   acc: 32.00% -> 62.67%             
client [24] (test)  loss: 2.7597 -> 1.6250   acc: 40.68% -> 68.44%             
client [15] (test)  loss: 3.5778 -> 2.1461   acc: 31.96% -> 60.76%             
client [58] (test)  loss: 4.0703 -> 2.0423   acc: 28.16% -> 57.59%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.5829 -> 2.3700   acc: 31.70% -> 55.56%             
client [76] (test)  loss: 4.1771 -> 2.6736   acc: 23.92% -> 52.16%             
client [67] (test)  loss: 3.7415 -> 1.6814   acc: 32.60% -> 64.89%             
client [37] (test)  loss: 4.0300 -> 2.2063   acc: 30.87% -> 57.23%             
client [58] (test)  loss: 4.0147 -> 2.1004   acc: 29.43% -> 56.01%             
client [64] (test)  loss: 3.6518 -> 1.7635   acc: 28.01% -> 64.43%             
client [77] (test)  loss: 3.6814 -> 1.9329   acc: 30.72% -> 69.28%             
client [55] (test)  loss: 2.6915 -> 1.5648   acc: 49.38% -> 69.57%             
client [12] (test)  loss: 2.7741 -> 1.5196   acc: 43.42% -> 70.07%             
client [89] (test)  loss: 3.8242 -> 2.5632   acc: 30.89% -> 51.68%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.2148 -> 2.4224   acc: 41.61% -> 56.52%             
client [51] (test)  loss: 3.8300 -> 2.6849   acc: 28.10% -> 54.25%             
client [8] (test)  loss: 3.3010 -> 2.1147   acc: 35.58% -> 64.10%              
client [18] (test)  loss: 2.9311 -> 1.3880   acc: 40.10% -> 72.40%             
client [94] (test)  loss: 3.7461 -> 1.8713   acc: 31.41% -> 60.58%             
client [81] (test)  loss: 3.4565 -> 2.0157   acc: 36.71% -> 63.92%             
client [3] (test)  loss: 2.8950 -> 1.5585   acc: 44.34% -> 69.11%              
client [11] (test)  loss: 3.4434 -> 1.8637   acc: 35.58% -> 66.87%             
client [95] (test)  loss: 3.4938 -> 1.8495   acc: 32.67% -> 67.33%             
client [67] (test)  loss: 3.3887 -> 1.6782   acc: 35.74% -> 64.26%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.8518 -> 1.8770   acc: 28.24% -> 58.79%             
client [79] (test)  loss: 2.7283 -> 1.1755   acc: 46.05% -> 79.66%             
client [58] (test)  loss: 3.6626 -> 2.1564   acc: 31.96% -> 53.80%             
client [88] (test)  loss: 3.1687 -> 1.8343   acc: 34.44% -> 67.55%             
client [46] (test)  loss: 3.0743 -> 1.4349   acc: 39.20% -> 72.40%             
client [11] (test)  loss: 3.2559 -> 1.9383   acc: 38.34% -> 68.10%             
client [55] (test)  loss: 2.6778 -> 1.6240   acc: 49.69% -> 69.57%             
client [13] (test)  loss: 3.1227 -> 1.9459   acc: 41.03% -> 64.44%             
client [31] (test)  loss: 3.3394 -> 1.7423   acc: 40.84% -> 63.34%             
client [75] (test)  loss: 2.9497 -> 1.5648   acc: 42.86% -> 72.76%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.4756 -> 2.3817   acc: 35.50% -> 56.68%             
client [7] (test)  loss: 3.3925 -> 1.5858   acc: 37.22% -> 69.26%              
client [57] (test)  loss: 2.8396 -> 2.0162   acc: 43.56% -> 64.36%             
client [13] (test)  loss: 3.5486 -> 1.9413   acc: 35.56% -> 64.13%             
client [43] (test)  loss: 4.0206 -> 2.4876   acc: 26.36% -> 56.97%             
client [91] (test)  loss: 4.2942 -> 1.9323   acc: 31.83% -> 65.59%             
client [10] (test)  loss: 3.8258 -> 2.3956   acc: 29.37% -> 60.71%             
client [64] (test)  loss: 3.0602 -> 1.8282   acc: 36.69% -> 65.27%             
client [82] (test)  loss: 3.6270 -> 2.1586   acc: 30.80% -> 61.59%             
client [22] (test)  loss: 4.0293 -> 2.5542   acc: 29.91% -> 50.78%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.4881 -> 1.1292   acc: 40.13% -> 81.25%             
client [23] (test)  loss: 4.0501 -> 2.4620   acc: 33.20% -> 58.59%             
client [88] (test)  loss: 3.3069 -> 1.8366   acc: 34.11% -> 66.23%             
client [98] (test)  loss: 3.0617 -> 2.7152   acc: 42.19% -> 56.25%             
client [79] (test)  loss: 2.2348 -> 1.1369   acc: 53.67% -> 77.97%             
client [21] (test)  loss: 4.4580 -> 1.9734   acc: 24.21% -> 61.67%             
client [92] (test)  loss: 3.7240 -> 2.4119   acc: 35.98% -> 52.72%             
client [56] (test)  loss: 3.2708 -> 2.2144   acc: 44.55% -> 60.40%             
client [5] (test)  loss: 3.9955 -> 2.1053   acc: 32.27% -> 63.26%              
client [52] (test)  loss: 3.1748 -> 2.1121   acc: 40.53% -> 64.12%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.2798 -> 0.0000', 'accuracy': '31.38% -> 0.00%'},          
    200: {'loss': '3.6645 -> 0.0000', 'accuracy': '34.72% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(12.59%) at epoch: 9                                      
FedAvg achieved 20.0%(21.32%) at epoch: 22                                     
FedAvg achieved 30.0%(31.45%) at epoch: 54                                     
Convergence (test_after):                                                      
FedAvg achieved 30.0%(35.64%) at epoch: 0                                      
FedAvg achieved 40.0%(42.05%) at epoch: 1                                      
FedAvg achieved 50.0%(50.77%) at epoch: 9                                      
FedAvg achieved 60.0%(60.15%) at epoch: 30                                     
