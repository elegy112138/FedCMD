==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7445 -> 0.5477   acc: 74.64% -> 76.43%             
client [81] (test)  loss: 1.1068 -> 0.7293   acc: 54.90% -> 68.07%             
client [21] (test)  loss: 0.5716 -> 0.5847   acc: 79.72% -> 79.44%             
client [68] (test)  loss: 0.7768 -> 0.6575   acc: 68.99% -> 73.42%             
client [93] (test)  loss: 0.9587 -> 0.5110   acc: 61.59% -> 78.41%             
client [31] (test)  loss: 1.2132 -> 0.6887   acc: 52.09% -> 72.96%             
client [20] (test)  loss: 0.8238 -> 0.8658   acc: 73.89% -> 75.80%             
client [59] (test)  loss: 0.5152 -> 0.4491   acc: 82.57% -> 85.43%             
client [48] (test)  loss: 0.4830 -> 0.3098   acc: 82.94% -> 87.40%             
client [34] (test)  loss: 0.6875 -> 0.5691   acc: 70.65% -> 80.98%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4158 -> 0.3226   acc: 84.68% -> 88.05%             
client [99] (test)  loss: 0.4110 -> 0.3533   acc: 85.88% -> 89.27%             
client [67] (test)  loss: 0.4223 -> 0.4133   acc: 86.65% -> 88.16%             
client [0] (test)  loss: 0.5583 -> 0.4814   acc: 80.32% -> 81.91%              
client [76] (test)  loss: 0.3926 -> 0.3757   acc: 87.58% -> 87.37%             
client [41] (test)  loss: 0.7757 -> 0.6287   acc: 71.22% -> 77.86%             
client [62] (test)  loss: 0.5380 -> 0.5230   acc: 84.40% -> 81.04%             
client [2] (test)  loss: 0.5724 -> 0.6181   acc: 75.06% -> 77.39%              
client [14] (test)  loss: 0.6594 -> 0.4848   acc: 76.57% -> 82.12%             
client [46] (test)  loss: 0.4888 -> 0.3635   acc: 82.80% -> 84.55%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4459 -> 0.5901   acc: 83.12% -> 84.89%             
client [68] (test)  loss: 0.4942 -> 0.5595   acc: 81.65% -> 77.22%             
client [57] (test)  loss: 0.4137 -> 0.4141   acc: 87.00% -> 88.09%             
client [17] (test)  loss: 0.4616 -> 0.2996   acc: 82.20% -> 90.84%             
client [54] (test)  loss: 0.3520 -> 0.2684   acc: 88.54% -> 91.65%             
client [23] (test)  loss: 0.8439 -> 0.3069   acc: 69.85% -> 90.02%             
client [35] (test)  loss: 0.4450 -> 0.3605   acc: 84.70% -> 87.87%             
client [59] (test)  loss: 0.5067 -> 0.3562   acc: 82.86% -> 87.71%             
client [31] (test)  loss: 0.7054 -> 0.6249   acc: 72.76% -> 77.73%             
client [9] (test)  loss: 0.4900 -> 0.5506   acc: 81.11% -> 81.36%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7696 -> 0.4741   acc: 72.24% -> 81.02%             
client [33] (test)  loss: 0.4359 -> 0.5288   acc: 85.41% -> 81.89%             
client [16] (test)  loss: 0.3333 -> 0.2203   acc: 88.74% -> 93.98%             
client [44] (test)  loss: 0.4153 -> 0.3680   acc: 84.14% -> 86.56%             
client [8] (test)  loss: 0.4490 -> 0.4673   acc: 82.90% -> 83.55%              
client [31] (test)  loss: 0.7531 -> 0.6012   acc: 69.38% -> 79.72%             
client [47] (test)  loss: 0.6708 -> 0.6124   acc: 75.28% -> 75.66%             
client [36] (test)  loss: 0.4626 -> 0.4440   acc: 81.90% -> 81.90%             
client [20] (test)  loss: 0.5920 -> 0.6408   acc: 78.03% -> 79.62%             
client [56] (test)  loss: 0.4856 -> 0.4419   acc: 84.69% -> 85.00%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5438 -> 0.5689   acc: 78.09% -> 77.32%              
client [60] (test)  loss: 0.3801 -> 0.3028   acc: 86.39% -> 90.84%             
client [28] (test)  loss: 0.5763 -> 0.5663   acc: 82.49% -> 80.18%             
client [25] (test)  loss: 0.4882 -> 0.5239   acc: 82.06% -> 82.06%             
client [58] (test)  loss: 0.3767 -> 0.2524   acc: 87.70% -> 91.10%             
client [44] (test)  loss: 0.4731 -> 0.3543   acc: 82.38% -> 88.11%             
client [39] (test)  loss: 0.8803 -> 0.4264   acc: 65.67% -> 83.65%             
client [29] (test)  loss: 0.6190 -> 0.4684   acc: 77.54% -> 85.03%             
client [3] (test)  loss: 0.4661 -> 0.4716   acc: 81.82% -> 85.67%              
client [84] (test)  loss: 0.5318 -> 0.4087   acc: 82.03% -> 85.80%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4334 -> 0.5247   acc: 84.72% -> 84.44%             
client [84] (test)  loss: 0.5685 -> 0.3891   acc: 82.03% -> 86.38%             
client [10] (test)  loss: 0.2888 -> 0.3258   acc: 89.44% -> 87.50%             
client [36] (test)  loss: 0.4445 -> 0.4140   acc: 83.13% -> 85.28%             
client [65] (test)  loss: 0.2945 -> 0.3306   acc: 89.51% -> 87.28%             
client [81] (test)  loss: 0.6602 -> 0.5769   acc: 74.51% -> 78.99%             
client [79] (test)  loss: 0.6333 -> 0.4462   acc: 79.28% -> 83.43%             
client [42] (test)  loss: 0.9769 -> 0.4344   acc: 66.05% -> 85.58%             
client [11] (test)  loss: 0.5182 -> 0.5015   acc: 81.88% -> 84.06%             
client [96] (test)  loss: 0.3280 -> 0.3189   acc: 90.58% -> 90.30%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4344 -> 0.4491   acc: 85.48% -> 85.16%              
client [53] (test)  loss: 0.3854 -> 0.2221   acc: 87.06% -> 91.45%             
client [52] (test)  loss: 0.5677 -> 0.5213   acc: 79.22% -> 81.72%             
client [42] (test)  loss: 0.6544 -> 0.4567   acc: 76.28% -> 85.12%             
client [69] (test)  loss: 0.3392 -> 0.2534   acc: 88.05% -> 91.43%             
client [59] (test)  loss: 0.4258 -> 0.2666   acc: 84.29% -> 90.57%             
client [7] (test)  loss: 0.4742 -> 0.5129   acc: 83.06% -> 81.94%              
client [26] (test)  loss: 0.3472 -> 0.3642   acc: 88.77% -> 89.12%             
client [49] (test)  loss: 0.4107 -> 0.4256   acc: 84.73% -> 84.49%             
client [98] (test)  loss: 0.5816 -> 0.6040   acc: 76.67% -> 78.06%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8214 -> 0.6012   acc: 71.11% -> 78.89%             
client [47] (test)  loss: 0.7753 -> 0.5563   acc: 72.28% -> 80.90%             
client [21] (test)  loss: 0.3980 -> 0.4993   acc: 85.83% -> 87.22%             
client [77] (test)  loss: 0.5739 -> 0.4813   acc: 80.36% -> 83.57%             
client [95] (test)  loss: 0.3982 -> 0.3710   acc: 85.63% -> 86.48%             
client [91] (test)  loss: 0.5766 -> 0.4654   acc: 80.00% -> 85.53%             
client [14] (test)  loss: 0.5481 -> 0.4732   acc: 83.88% -> 84.89%             
client [99] (test)  loss: 0.2991 -> 0.2530   acc: 87.85% -> 90.11%             
client [20] (test)  loss: 0.5670 -> 0.5774   acc: 80.89% -> 83.44%             
client [39] (test)  loss: 1.1510 -> 0.3897   acc: 61.31% -> 87.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5435 -> 0.4602   acc: 80.33% -> 85.32%             
client [62] (test)  loss: 0.4109 -> 0.4250   acc: 87.77% -> 86.24%             
client [71] (test)  loss: 0.3297 -> 0.3419   acc: 88.42% -> 88.70%             
client [97] (test)  loss: 0.5297 -> 0.6311   acc: 82.46% -> 77.61%             
client [30] (test)  loss: 0.4409 -> 0.4047   acc: 83.45% -> 88.18%             
client [88] (test)  loss: 0.6610 -> 0.4105   acc: 77.13% -> 84.57%             
client [60] (test)  loss: 0.3484 -> 0.2820   acc: 88.37% -> 92.57%             
client [82] (test)  loss: 0.4292 -> 0.3360   acc: 84.33% -> 89.30%             
client [91] (test)  loss: 0.4109 -> 0.4524   acc: 84.47% -> 85.00%             
client [57] (test)  loss: 0.3755 -> 0.3486   acc: 88.81% -> 88.45%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7592 -> 0.5912   acc: 71.17% -> 80.32%             
client [15] (test)  loss: 0.3516 -> 0.3980   acc: 89.20% -> 88.09%             
client [71] (test)  loss: 0.3721 -> 0.3195   acc: 85.59% -> 89.27%             
client [97] (test)  loss: 0.4827 -> 0.6360   acc: 83.96% -> 77.61%             
client [53] (test)  loss: 0.3865 -> 0.2048   acc: 87.28% -> 92.54%             
client [77] (test)  loss: 0.4771 -> 0.4669   acc: 83.93% -> 85.00%             
client [76] (test)  loss: 0.3152 -> 0.2691   acc: 90.36% -> 91.86%             
client [79] (test)  loss: 0.5102 -> 0.4337   acc: 84.81% -> 84.53%             
client [28] (test)  loss: 0.4830 -> 0.5149   acc: 82.95% -> 82.03%             
client [99] (test)  loss: 0.3038 -> 0.2487   acc: 88.14% -> 91.53%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4779 -> 0.6461   acc: 85.07% -> 77.24%             
client [86] (test)  loss: 0.2027 -> 0.1896   acc: 92.79% -> 92.09%             
client [34] (test)  loss: 0.3459 -> 0.3638   acc: 87.50% -> 88.32%             
client [73] (test)  loss: 0.4147 -> 0.4170   acc: 85.67% -> 88.06%             
client [5] (test)  loss: 0.6192 -> 0.4507   acc: 78.16% -> 84.29%              
client [96] (test)  loss: 0.3229 -> 0.3084   acc: 91.14% -> 91.41%             
client [22] (test)  loss: 0.4340 -> 0.4919   acc: 83.87% -> 82.90%             
client [60] (test)  loss: 0.3470 -> 0.2737   acc: 88.61% -> 93.07%             
client [66] (test)  loss: 0.5389 -> 0.5107   acc: 85.19% -> 86.30%             
client [83] (test)  loss: 0.3491 -> 0.2108   acc: 88.14% -> 93.56%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4632 -> 0.2422   acc: 85.87% -> 92.51%             
client [65] (test)  loss: 0.3350 -> 0.3177   acc: 89.06% -> 86.83%             
client [95] (test)  loss: 0.4083 -> 0.4084   acc: 85.07% -> 85.92%             
client [17] (test)  loss: 0.3973 -> 0.2877   acc: 87.96% -> 92.67%             
client [8] (test)  loss: 0.3855 -> 0.4484   acc: 87.42% -> 86.77%              
client [35] (test)  loss: 0.4166 -> 0.3149   acc: 85.82% -> 89.55%             
client [98] (test)  loss: 0.6540 -> 0.8240   acc: 75.00% -> 73.89%             
client [53] (test)  loss: 0.3778 -> 0.2058   acc: 87.28% -> 92.76%             
client [43] (test)  loss: 0.2290 -> 0.1969   acc: 91.94% -> 95.16%             
client [64] (test)  loss: 0.5129 -> 0.4542   acc: 84.42% -> 84.14%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3503 -> 0.4313   acc: 88.06% -> 88.33%             
client [88] (test)  loss: 0.6600 -> 0.4128   acc: 79.61% -> 84.85%             
client [38] (test)  loss: 0.3135 -> 0.4080   acc: 88.36% -> 87.11%             
client [3] (test)  loss: 0.6032 -> 0.4044   acc: 80.44% -> 86.23%              
client [5] (test)  loss: 0.5573 -> 0.4698   acc: 81.23% -> 83.52%              
client [41] (test)  loss: 0.5203 -> 0.5126   acc: 83.76% -> 82.66%             
client [7] (test)  loss: 0.5012 -> 0.4898   acc: 82.78% -> 83.06%              
client [37] (test)  loss: 0.3256 -> 0.3030   acc: 90.78% -> 91.62%             
client [45] (test)  loss: 0.6125 -> 0.3305   acc: 79.32% -> 88.74%             
client [47] (test)  loss: 0.5222 -> 0.6042   acc: 82.40% -> 79.40%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3569 -> 0.2206   acc: 89.01% -> 94.24%             
client [11] (test)  loss: 0.5998 -> 0.5266   acc: 80.80% -> 86.23%             
client [37] (test)  loss: 0.4047 -> 0.3015   acc: 86.31% -> 92.74%             
client [41] (test)  loss: 0.7555 -> 0.4680   acc: 76.01% -> 82.66%             
client [95] (test)  loss: 0.4701 -> 0.3663   acc: 82.82% -> 87.04%             
client [53] (test)  loss: 0.4193 -> 0.1882   acc: 86.18% -> 94.08%             
client [22] (test)  loss: 0.5311 -> 0.4433   acc: 81.94% -> 85.48%             
client [25] (test)  loss: 0.7769 -> 0.4686   acc: 73.88% -> 82.59%             
client [69] (test)  loss: 0.3424 -> 0.2422   acc: 88.05% -> 92.47%             
client [46] (test)  loss: 0.3741 -> 0.2841   acc: 85.42% -> 88.05%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4160 -> 0.6333   acc: 86.89% -> 79.03%             
client [69] (test)  loss: 0.3595 -> 0.2521   acc: 89.09% -> 92.99%             
client [82] (test)  loss: 0.4402 -> 0.2947   acc: 85.07% -> 90.30%             
client [45] (test)  loss: 0.7204 -> 0.3072   acc: 74.61% -> 89.27%             
client [7] (test)  loss: 0.4436 -> 0.4889   acc: 85.83% -> 85.28%              
client [50] (test)  loss: 0.4821 -> 0.5348   acc: 83.19% -> 81.23%             
client [35] (test)  loss: 0.3471 -> 0.3141   acc: 86.94% -> 89.37%             
client [24] (test)  loss: 0.4679 -> 0.3997   acc: 86.90% -> 89.67%             
client [15] (test)  loss: 0.4225 -> 0.3621   acc: 86.70% -> 88.92%             
client [58] (test)  loss: 0.4643 -> 0.2368   acc: 83.77% -> 92.15%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4026 -> 0.2270   acc: 86.61% -> 92.13%             
client [76] (test)  loss: 0.3920 -> 0.2454   acc: 88.01% -> 93.15%             
client [67] (test)  loss: 0.2802 -> 0.3912   acc: 90.68% -> 90.93%             
client [37] (test)  loss: 0.3176 -> 0.2895   acc: 91.34% -> 92.18%             
client [58] (test)  loss: 0.4416 -> 0.2365   acc: 82.98% -> 91.10%             
client [64] (test)  loss: 0.6393 -> 0.4129   acc: 78.75% -> 87.25%             
client [77] (test)  loss: 0.4483 -> 0.4880   acc: 86.07% -> 84.29%             
client [55] (test)  loss: 0.4078 -> 0.4162   acc: 85.91% -> 87.67%             
client [12] (test)  loss: 0.4826 -> 0.5531   acc: 82.73% -> 81.36%             
client [89] (test)  loss: 0.4594 -> 0.3618   acc: 84.57% -> 89.39%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4794 -> 0.3386   acc: 83.77% -> 88.41%             
client [51] (test)  loss: 0.3657 -> 0.3973   acc: 87.39% -> 85.89%             
client [8] (test)  loss: 0.3634 -> 0.4558   acc: 87.42% -> 87.10%              
client [18] (test)  loss: 0.3546 -> 0.3089   acc: 88.75% -> 91.79%             
client [94] (test)  loss: 0.7523 -> 0.4378   acc: 73.97% -> 85.33%             
client [81] (test)  loss: 0.6241 -> 0.5034   acc: 80.39% -> 82.63%             
client [3] (test)  loss: 0.4908 -> 0.4076   acc: 82.92% -> 85.67%              
client [11] (test)  loss: 0.5186 -> 0.5537   acc: 85.51% -> 85.87%             
client [95] (test)  loss: 0.3376 -> 0.3739   acc: 87.32% -> 86.20%             
client [67] (test)  loss: 0.2545 -> 0.3877   acc: 92.44% -> 91.69%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3936 -> 0.4345   acc: 88.61% -> 88.61%             
client [79] (test)  loss: 0.4100 -> 0.4308   acc: 87.29% -> 85.36%             
client [58] (test)  loss: 0.4008 -> 0.2376   acc: 86.39% -> 91.10%             
client [88] (test)  loss: 0.6103 -> 0.4116   acc: 79.89% -> 85.12%             
client [46] (test)  loss: 0.3552 -> 0.2816   acc: 87.46% -> 88.63%             
client [11] (test)  loss: 0.5430 -> 0.5062   acc: 84.06% -> 87.68%             
client [55] (test)  loss: 0.5137 -> 0.3878   acc: 83.17% -> 87.48%             
client [13] (test)  loss: 0.3318 -> 0.2982   acc: 87.14% -> 90.29%             
client [31] (test)  loss: 0.7915 -> 0.5201   acc: 71.97% -> 80.72%             
client [75] (test)  loss: 0.4444 -> 0.2029   acc: 83.44% -> 91.41%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1995 -> 0.2318   acc: 91.38% -> 90.34%             
client [7] (test)  loss: 0.5275 -> 0.5508   acc: 83.61% -> 84.44%              
client [57] (test)  loss: 0.2648 -> 0.3212   acc: 92.78% -> 90.97%             
client [13] (test)  loss: 0.3518 -> 0.2989   acc: 86.61% -> 90.29%             
client [43] (test)  loss: 0.2555 -> 0.1789   acc: 93.01% -> 94.62%             
client [91] (test)  loss: 0.4788 -> 0.4081   acc: 84.74% -> 87.89%             
client [10] (test)  loss: 0.2627 -> 0.2371   acc: 91.67% -> 91.67%             
client [64] (test)  loss: 0.4636 -> 0.4171   acc: 86.97% -> 88.10%             
client [82] (test)  loss: 0.4082 -> 0.3536   acc: 87.31% -> 89.30%             
client [22] (test)  loss: 0.4579 -> 0.4412   acc: 83.87% -> 85.48%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5171 -> 0.5510   acc: 84.39% -> 84.39%             
client [23] (test)  loss: 0.5998 -> 0.3062   acc: 81.32% -> 92.57%             
client [88] (test)  loss: 0.6453 -> 0.4268   acc: 80.17% -> 84.85%             
client [98] (test)  loss: 0.5816 -> 0.5356   acc: 79.72% -> 83.33%             
client [79] (test)  loss: 0.5298 -> 0.4548   acc: 82.04% -> 85.08%             
client [21] (test)  loss: 0.3501 -> 0.3961   acc: 89.17% -> 89.44%             
client [92] (test)  loss: 0.6160 -> 0.4894   acc: 81.94% -> 83.56%             
client [56] (test)  loss: 0.4771 -> 0.4690   acc: 87.19% -> 85.94%             
client [5] (test)  loss: 0.5101 -> 0.4191   acc: 82.38% -> 85.82%              
client [52] (test)  loss: 0.5722 -> 0.4935   acc: 80.61% -> 82.55%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4506 -> 0.0000', 'accuracy': '84.64% -> 0.00%'},          
    200: {'loss': '0.4343 -> 0.0000', 'accuracy': '85.96% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(14.47%) at epoch: 0                                      
FedDyn achieved 30.0%(32.95%) at epoch: 1                                      
FedDyn achieved 50.0%(56.02%) at epoch: 2                                      
FedDyn achieved 60.0%(64.55%) at epoch: 3                                      
FedDyn achieved 70.0%(72.72%) at epoch: 5                                      
FedDyn achieved 80.0%(80.25%) at epoch: 13                                     
Convergence (test_after):                                                      
FedDyn achieved 70.0%(72.20%) at epoch: 0                                      
FedDyn achieved 80.0%(80.39%) at epoch: 11                                     
FedDyn achieved 90.0%(90.00%) at epoch: 194                                    
