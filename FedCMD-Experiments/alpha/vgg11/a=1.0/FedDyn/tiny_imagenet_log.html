==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.9385 -> 4.5281   acc: 5.76% -> 12.41%              
client [81] (test)  loss: 4.8727 -> 4.5774   acc: 5.72% -> 9.41%               
client [21] (test)  loss: 5.0116 -> 4.5670   acc: 4.90% -> 11.80%              
client [68] (test)  loss: 4.9385 -> 4.3503   acc: 4.52% -> 17.00%              
client [93] (test)  loss: 4.9257 -> 4.4803   acc: 4.90% -> 11.98%              
client [31] (test)  loss: 5.0170 -> 4.5242   acc: 5.23% -> 14.77%              
client [20] (test)  loss: 4.7276 -> 4.2768   acc: 10.59% -> 18.15%             
client [59] (test)  loss: 4.9294 -> 4.4486   acc: 4.73% -> 13.27%              
client [48] (test)  loss: 4.7776 -> 4.4118   acc: 5.73% -> 14.16%              
client [34] (test)  loss: 4.8986 -> 4.4952   acc: 5.45% -> 10.18%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.9452 -> 3.7770   acc: 19.63% -> 21.67%             
client [99] (test)  loss: 3.9682 -> 3.7468   acc: 15.88% -> 21.30%             
client [67] (test)  loss: 3.8354 -> 3.5317   acc: 19.78% -> 27.99%             
client [0] (test)  loss: 3.9957 -> 3.7518   acc: 17.03% -> 23.55%              
client [76] (test)  loss: 3.9442 -> 3.5916   acc: 20.51% -> 27.77%             
client [41] (test)  loss: 4.0931 -> 3.8470   acc: 12.86% -> 18.30%             
client [62] (test)  loss: 4.0633 -> 3.7940   acc: 16.52% -> 21.90%             
client [2] (test)  loss: 3.8636 -> 3.6692   acc: 18.04% -> 21.31%              
client [14] (test)  loss: 3.8917 -> 3.8413   acc: 19.13% -> 22.74%             
client [46] (test)  loss: 3.9306 -> 3.6191   acc: 16.88% -> 24.86%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.8753 -> 3.1997   acc: 21.75% -> 31.73%             
client [68] (test)  loss: 3.3953 -> 3.1597   acc: 24.41% -> 29.29%             
client [57] (test)  loss: 3.3624 -> 3.3169   acc: 26.50% -> 28.31%             
client [17] (test)  loss: 3.4890 -> 3.4396   acc: 23.24% -> 25.95%             
client [54] (test)  loss: 3.4674 -> 3.2740   acc: 26.13% -> 31.94%             
client [23] (test)  loss: 3.6470 -> 3.6063   acc: 21.16% -> 22.42%             
client [35] (test)  loss: 3.4093 -> 3.2372   acc: 24.86% -> 27.95%             
client [59] (test)  loss: 3.4185 -> 3.3910   acc: 27.27% -> 29.09%             
client [31] (test)  loss: 3.4449 -> 3.3746   acc: 27.93% -> 29.37%             
client [9] (test)  loss: 3.5938 -> 3.5425   acc: 22.42% -> 24.77%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.2992 -> 3.2382   acc: 25.84% -> 28.62%             
client [33] (test)  loss: 3.1398 -> 3.1455   acc: 27.90% -> 30.80%             
client [16] (test)  loss: 3.2025 -> 3.1231   acc: 28.90% -> 32.32%             
client [44] (test)  loss: 3.1467 -> 3.1509   acc: 32.33% -> 31.08%             
client [8] (test)  loss: 3.3347 -> 3.2038   acc: 28.16% -> 31.23%              
client [31] (test)  loss: 3.2588 -> 3.1694   acc: 30.27% -> 31.53%             
client [47] (test)  loss: 3.3327 -> 3.2623   acc: 28.88% -> 31.95%             
client [36] (test)  loss: 3.2119 -> 3.0794   acc: 28.73% -> 30.55%             
client [20] (test)  loss: 3.1897 -> 2.9423   acc: 32.89% -> 38.19%             
client [56] (test)  loss: 3.3295 -> 3.2388   acc: 25.09% -> 32.31%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.2350 -> 3.1468   acc: 30.31% -> 29.95%              
client [60] (test)  loss: 3.3016 -> 3.0175   acc: 27.88% -> 31.83%             
client [28] (test)  loss: 3.0301 -> 2.9378   acc: 31.58% -> 33.03%             
client [25] (test)  loss: 3.0550 -> 2.9705   acc: 34.23% -> 34.95%             
client [58] (test)  loss: 3.1774 -> 3.2733   acc: 29.01% -> 30.27%             
client [44] (test)  loss: 2.9781 -> 3.0279   acc: 34.46% -> 34.10%             
client [39] (test)  loss: 3.0386 -> 3.1147   acc: 32.00% -> 33.09%             
client [29] (test)  loss: 3.1481 -> 2.9591   acc: 28.37% -> 30.82%             
client [3] (test)  loss: 3.1514 -> 3.0752   acc: 31.13% -> 33.63%              
client [84] (test)  loss: 3.0498 -> 3.0584   acc: 32.79% -> 34.06%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.0487 -> 3.0489   acc: 31.94% -> 34.48%             
client [84] (test)  loss: 2.8922 -> 2.9937   acc: 34.78% -> 34.42%             
client [10] (test)  loss: 3.0030 -> 2.9969   acc: 34.35% -> 37.77%             
client [36] (test)  loss: 2.9805 -> 2.8896   acc: 31.82% -> 34.00%             
client [65] (test)  loss: 3.0520 -> 3.1509   acc: 31.76% -> 33.21%             
client [81] (test)  loss: 3.0452 -> 2.8735   acc: 31.18% -> 36.53%             
client [79] (test)  loss: 3.0534 -> 2.9576   acc: 34.99% -> 35.52%             
client [42] (test)  loss: 3.1469 -> 3.0474   acc: 30.38% -> 32.83%             
client [11] (test)  loss: 3.0269 -> 2.7149   acc: 32.19% -> 39.57%             
client [96] (test)  loss: 2.8550 -> 2.6456   acc: 34.23% -> 42.52%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.0971 -> 2.9807   acc: 33.21% -> 36.82%              
client [53] (test)  loss: 2.9746 -> 2.7518   acc: 31.39% -> 34.39%             
client [52] (test)  loss: 2.9215 -> 3.0482   acc: 35.33% -> 34.60%             
client [42] (test)  loss: 2.9632 -> 3.0184   acc: 32.26% -> 35.09%             
client [69] (test)  loss: 2.8347 -> 2.9730   acc: 41.67% -> 39.44%             
client [59] (test)  loss: 2.8781 -> 2.8662   acc: 36.36% -> 38.36%             
client [7] (test)  loss: 2.9188 -> 2.9131   acc: 35.51% -> 37.32%              
client [26] (test)  loss: 2.9597 -> 2.9318   acc: 34.89% -> 36.33%             
client [49] (test)  loss: 2.9717 -> 3.1069   acc: 33.57% -> 32.31%             
client [98] (test)  loss: 3.1793 -> 3.1352   acc: 32.00% -> 34.36%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.0881 -> 3.1151   acc: 32.00% -> 35.09%             
client [47] (test)  loss: 2.9783 -> 3.0320   acc: 34.66% -> 38.09%             
client [21] (test)  loss: 2.9094 -> 2.9553   acc: 34.85% -> 37.21%             
client [77] (test)  loss: 2.7909 -> 2.8377   acc: 36.69% -> 38.31%             
client [95] (test)  loss: 2.7857 -> 2.7703   acc: 38.46% -> 37.34%             
client [91] (test)  loss: 2.9501 -> 2.9812   acc: 34.36% -> 37.09%             
client [14] (test)  loss: 2.7767 -> 3.0323   acc: 39.53% -> 36.82%             
client [99] (test)  loss: 2.8978 -> 2.9552   acc: 35.02% -> 35.56%             
client [20] (test)  loss: 2.7886 -> 2.7392   acc: 39.51% -> 41.21%             
client [39] (test)  loss: 2.8897 -> 2.9299   acc: 36.36% -> 38.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.8503 -> 2.9815   acc: 34.60% -> 36.23%             
client [62] (test)  loss: 2.9449 -> 2.9128   acc: 35.19% -> 35.01%             
client [71] (test)  loss: 3.0371 -> 3.1497   acc: 31.72% -> 34.05%             
client [97] (test)  loss: 2.7300 -> 2.6479   acc: 36.55% -> 40.36%             
client [30] (test)  loss: 2.8111 -> 2.8549   acc: 36.59% -> 37.32%             
client [88] (test)  loss: 2.9849 -> 2.9936   acc: 36.35% -> 37.79%             
client [60] (test)  loss: 3.0782 -> 2.9013   acc: 34.17% -> 36.51%             
client [82] (test)  loss: 2.7906 -> 2.8124   acc: 40.18% -> 40.00%             
client [91] (test)  loss: 2.9335 -> 2.9360   acc: 36.55% -> 38.18%             
client [57] (test)  loss: 2.7993 -> 2.8224   acc: 36.84% -> 39.56%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.9898 -> 2.9352   acc: 36.22% -> 39.10%             
client [15] (test)  loss: 2.8677 -> 2.9664   acc: 36.98% -> 33.57%             
client [71] (test)  loss: 2.9783 -> 3.1109   acc: 34.95% -> 35.66%             
client [97] (test)  loss: 2.7682 -> 2.6785   acc: 38.36% -> 40.36%             
client [53] (test)  loss: 2.9187 -> 2.7282   acc: 31.75% -> 36.51%             
client [77] (test)  loss: 2.7402 -> 2.8232   acc: 37.23% -> 39.75%             
client [76] (test)  loss: 2.8899 -> 2.8418   acc: 38.66% -> 41.38%             
client [79] (test)  loss: 2.8345 -> 2.8687   acc: 36.94% -> 38.72%             
client [28] (test)  loss: 2.8907 -> 2.7235   acc: 37.39% -> 38.48%             
client [99] (test)  loss: 2.8719 -> 2.9185   acc: 37.18% -> 37.55%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.6533 -> 2.6368   acc: 39.64% -> 42.00%             
client [86] (test)  loss: 2.8142 -> 2.9253   acc: 38.84% -> 38.29%             
client [34] (test)  loss: 2.8668 -> 2.9195   acc: 37.64% -> 36.00%             
client [73] (test)  loss: 2.7282 -> 2.9111   acc: 38.21% -> 39.23%             
client [5] (test)  loss: 2.8877 -> 2.8015   acc: 37.37% -> 40.57%              
client [96] (test)  loss: 2.6377 -> 2.5667   acc: 44.68% -> 47.75%             
client [22] (test)  loss: 2.8998 -> 2.8803   acc: 38.70% -> 39.60%             
client [60] (test)  loss: 3.0354 -> 2.9853   acc: 34.89% -> 37.23%             
client [66] (test)  loss: 2.7458 -> 2.9105   acc: 38.45% -> 38.81%             
client [83] (test)  loss: 2.8463 -> 2.7908   acc: 39.96% -> 38.88%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.8448 -> 2.8341   acc: 39.93% -> 43.74%             
client [65] (test)  loss: 2.9142 -> 2.9827   acc: 36.48% -> 39.20%             
client [95] (test)  loss: 2.6881 -> 2.7821   acc: 40.90% -> 40.53%             
client [17] (test)  loss: 3.0239 -> 3.1315   acc: 36.40% -> 35.86%             
client [8] (test)  loss: 2.9807 -> 2.9773   acc: 36.28% -> 38.09%              
client [35] (test)  loss: 2.6877 -> 2.7443   acc: 39.20% -> 40.11%             
client [98] (test)  loss: 3.1662 -> 3.1506   acc: 33.27% -> 36.91%             
client [53] (test)  loss: 2.8107 -> 2.7935   acc: 36.33% -> 37.92%             
client [43] (test)  loss: 2.7522 -> 2.8084   acc: 40.94% -> 40.76%             
client [64] (test)  loss: 2.8799 -> 3.0022   acc: 38.66% -> 38.48%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.8816 -> 2.9709   acc: 38.29% -> 40.47%             
client [88] (test)  loss: 3.0341 -> 3.1055   acc: 38.52% -> 39.60%             
client [38] (test)  loss: 2.8953 -> 2.9733   acc: 35.37% -> 37.59%             
client [3] (test)  loss: 2.8397 -> 2.9348   acc: 40.07% -> 41.14%              
client [5] (test)  loss: 2.9007 -> 2.8400   acc: 38.43% -> 40.57%              
client [41] (test)  loss: 2.9365 -> 2.9493   acc: 36.96% -> 38.41%             
client [7] (test)  loss: 2.8463 -> 2.7890   acc: 39.13% -> 41.85%              
client [37] (test)  loss: 2.8214 -> 2.8810   acc: 38.38% -> 37.66%             
client [45] (test)  loss: 2.7510 -> 2.6768   acc: 40.91% -> 43.09%             
client [47] (test)  loss: 3.0094 -> 3.0817   acc: 38.09% -> 39.53%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.9115 -> 2.9501   acc: 41.47% -> 40.75%             
client [11] (test)  loss: 2.8210 -> 2.6120   acc: 41.19% -> 44.06%             
client [37] (test)  loss: 2.7965 -> 2.9236   acc: 37.66% -> 37.30%             
client [41] (test)  loss: 2.9365 -> 2.9456   acc: 38.22% -> 38.22%             
client [95] (test)  loss: 2.8119 -> 2.9116   acc: 40.90% -> 40.15%             
client [53] (test)  loss: 2.9819 -> 2.7743   acc: 33.86% -> 39.68%             
client [22] (test)  loss: 2.9586 -> 2.9540   acc: 39.06% -> 40.69%             
client [25] (test)  loss: 2.8283 -> 2.8236   acc: 40.36% -> 38.92%             
client [69] (test)  loss: 2.8335 -> 2.9786   acc: 41.48% -> 43.33%             
client [46] (test)  loss: 2.7431 -> 2.7342   acc: 41.38% -> 43.01%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.9732 -> 3.2844   acc: 39.35% -> 38.27%             
client [69] (test)  loss: 2.8973 -> 3.0238   acc: 41.85% -> 42.59%             
client [82] (test)  loss: 2.9596 -> 2.9415   acc: 39.11% -> 40.36%             
client [45] (test)  loss: 2.8154 -> 2.7206   acc: 41.64% -> 42.55%             
client [7] (test)  loss: 2.9295 -> 2.8546   acc: 39.49% -> 41.67%              
client [50] (test)  loss: 3.0009 -> 3.1398   acc: 38.77% -> 35.51%             
client [35] (test)  loss: 2.7327 -> 2.7883   acc: 43.38% -> 42.29%             
client [24] (test)  loss: 3.6050 -> 3.0601   acc: 32.98% -> 37.79%             
client [15] (test)  loss: 3.0186 -> 3.0590   acc: 36.98% -> 35.37%             
client [58] (test)  loss: 3.0849 -> 3.1882   acc: 38.02% -> 38.02%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.6454 -> 2.5881   acc: 42.83% -> 43.19%             
client [76] (test)  loss: 2.9276 -> 2.8916   acc: 40.83% -> 43.01%             
client [67] (test)  loss: 2.8311 -> 2.8523   acc: 44.59% -> 46.08%             
client [37] (test)  loss: 2.9006 -> 2.9458   acc: 38.02% -> 39.10%             
client [58] (test)  loss: 3.1133 -> 3.2407   acc: 37.48% -> 37.48%             
client [64] (test)  loss: 3.0299 -> 3.2012   acc: 38.48% -> 38.29%             
client [77] (test)  loss: 2.7457 -> 2.9887   acc: 39.93% -> 41.55%             
client [55] (test)  loss: 2.8424 -> 2.8816   acc: 42.40% -> 40.07%             
client [12] (test)  loss: 3.1622 -> 3.2886   acc: 36.92% -> 36.02%             
client [89] (test)  loss: 2.8844 -> 2.8518   acc: 40.50% -> 42.47%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.9349 -> 3.2417   acc: 39.67% -> 41.30%             
client [51] (test)  loss: 2.9987 -> 3.1206   acc: 38.38% -> 41.62%             
client [8] (test)  loss: 3.0841 -> 3.1755   acc: 38.63% -> 40.07%              
client [18] (test)  loss: 2.8466 -> 3.0972   acc: 41.14% -> 43.11%             
client [94] (test)  loss: 3.2743 -> 3.2139   acc: 35.44% -> 36.35%             
client [81] (test)  loss: 2.9174 -> 2.9961   acc: 39.85% -> 38.19%             
client [3] (test)  loss: 3.0049 -> 3.0735   acc: 39.89% -> 41.50%              
client [11] (test)  loss: 2.8824 -> 2.7156   acc: 41.01% -> 45.32%             
client [95] (test)  loss: 2.8599 -> 3.1190   acc: 39.59% -> 40.53%             
client [67] (test)  loss: 2.8558 -> 2.8157   acc: 43.84% -> 46.27%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.0540 -> 3.1313   acc: 38.11% -> 41.74%             
client [79] (test)  loss: 3.0074 -> 3.2369   acc: 38.72% -> 38.90%             
client [58] (test)  loss: 3.1354 -> 3.3267   acc: 39.82% -> 38.20%             
client [88] (test)  loss: 3.0899 -> 3.2897   acc: 39.06% -> 39.42%             
client [46] (test)  loss: 2.9192 -> 2.8785   acc: 41.38% -> 44.46%             
client [11] (test)  loss: 2.9517 -> 2.7549   acc: 39.57% -> 44.60%             
client [55] (test)  loss: 2.9254 -> 3.0627   acc: 40.43% -> 42.40%             
client [13] (test)  loss: 2.8161 -> 2.7497   acc: 40.94% -> 44.20%             
client [31] (test)  loss: 3.0519 -> 3.1259   acc: 41.98% -> 41.26%             
client [75] (test)  loss: 2.9697 -> 2.9021   acc: 38.45% -> 44.58%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.2963 -> 3.6395   acc: 37.50% -> 38.32%             
client [7] (test)  loss: 2.9860 -> 3.1251   acc: 40.94% -> 43.12%              
client [57] (test)  loss: 2.8236 -> 3.0025   acc: 41.02% -> 42.47%             
client [13] (test)  loss: 2.9033 -> 2.8327   acc: 43.66% -> 43.48%             
client [43] (test)  loss: 3.0546 -> 3.0913   acc: 40.76% -> 39.86%             
client [91] (test)  loss: 3.1636 -> 3.1430   acc: 39.09% -> 41.27%             
client [10] (test)  loss: 3.0012 -> 3.1254   acc: 40.65% -> 41.37%             
client [64] (test)  loss: 3.0704 -> 3.4640   acc: 40.89% -> 37.55%             
client [82] (test)  loss: 3.1309 -> 3.2370   acc: 40.71% -> 39.82%             
client [22] (test)  loss: 3.1971 -> 3.2623   acc: 41.41% -> 41.41%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.0665 -> 3.0840   acc: 41.59% -> 41.97%             
client [23] (test)  loss: 3.3969 -> 3.4050   acc: 37.79% -> 35.99%             
client [88] (test)  loss: 3.2744 -> 3.4551   acc: 39.60% -> 37.97%             
client [98] (test)  loss: 3.4585 -> 3.6190   acc: 35.27% -> 39.09%             
client [79] (test)  loss: 3.0859 -> 3.4172   acc: 40.32% -> 39.25%             
client [21] (test)  loss: 3.1798 -> 3.2988   acc: 40.11% -> 41.20%             
client [92] (test)  loss: 3.0936 -> 3.0028   acc: 41.96% -> 44.11%             
client [56] (test)  loss: 3.0753 -> 3.1902   acc: 40.43% -> 43.32%             
client [5] (test)  loss: 3.1176 -> 3.1929   acc: 38.79% -> 40.75%              
client [52] (test)  loss: 3.0841 -> 3.3942   acc: 42.39% -> 40.40%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '2.8629 -> 0.0000', 'accuracy': '37.21% -> 0.00%'},          
    200: {'loss': '3.1645 -> 0.0000', 'accuracy': '39.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(11.24%) at epoch: 13                                     
FedDyn achieved 20.0%(21.01%) at epoch: 22                                     
FedDyn achieved 30.0%(30.76%) at epoch: 45                                     
FedDyn achieved 40.0%(40.02%) at epoch: 128                                    
Convergence (test_after):                                                      
FedDyn achieved 10.0%(10.20%) at epoch: 8                                      
FedDyn achieved 20.0%(20.55%) at epoch: 14                                     
FedDyn achieved 30.0%(30.52%) at epoch: 38                                     
FedDyn achieved 40.0%(40.31%) at epoch: 86                                     
