==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6077 -> 0.8655   acc: 41.51% -> 67.62%             
client [81] (test)  loss: 1.6715 -> 1.0315   acc: 38.50% -> 64.60%             
client [21] (test)  loss: 0.9924 -> 0.6739   acc: 64.80% -> 77.26%             
client [68] (test)  loss: 0.9511 -> 0.8887   acc: 69.06% -> 73.02%             
client [93] (test)  loss: 0.4016 -> 0.3233   acc: 87.79% -> 89.83%             
client [31] (test)  loss: 1.5125 -> 1.0523   acc: 41.41% -> 63.88%             
client [20] (test)  loss: 0.4944 -> 0.4251   acc: 86.93% -> 86.27%             
client [59] (test)  loss: 1.1671 -> 0.6459   acc: 53.31% -> 78.48%             
client [48] (test)  loss: 0.9332 -> 0.7439   acc: 67.23% -> 67.23%             
client [34] (test)  loss: 0.7121 -> 0.5675   acc: 79.84% -> 80.38%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5330 -> 0.3666   acc: 80.60% -> 86.29%             
client [99] (test)  loss: 0.6971 -> 0.5635   acc: 77.24% -> 84.14%             
client [67] (test)  loss: 0.6978 -> 0.4381   acc: 73.75% -> 85.33%             
client [0] (test)  loss: 0.3877 -> 0.2845   acc: 86.56% -> 90.82%              
client [76] (test)  loss: 0.7075 -> 0.4697   acc: 70.84% -> 83.11%             
client [41] (test)  loss: 0.6849 -> 0.4652   acc: 75.60% -> 84.80%             
client [62] (test)  loss: 0.4694 -> 0.3004   acc: 80.86% -> 90.29%             
client [2] (test)  loss: 0.5912 -> 0.4655   acc: 77.54% -> 81.14%              
client [14] (test)  loss: 0.3413 -> 0.2466   acc: 87.88% -> 91.52%             
client [46] (test)  loss: 0.3072 -> 0.3628   acc: 87.61% -> 88.03%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5266 -> 0.6613   acc: 81.22% -> 77.66%             
client [68] (test)  loss: 0.3646 -> 0.3501   acc: 89.57% -> 89.21%             
client [57] (test)  loss: 0.3727 -> 0.3569   acc: 85.71% -> 86.73%             
client [17] (test)  loss: 0.4659 -> 0.5312   acc: 82.88% -> 82.88%             
client [54] (test)  loss: 0.2807 -> 0.2309   acc: 92.02% -> 92.78%             
client [23] (test)  loss: 0.2871 -> 0.2215   acc: 90.28% -> 92.22%             
client [35] (test)  loss: 0.4149 -> 0.1866   acc: 84.95% -> 94.44%             
client [59] (test)  loss: 0.2854 -> 0.1959   acc: 89.74% -> 94.70%             
client [31] (test)  loss: 0.4656 -> 0.5427   acc: 85.46% -> 84.58%             
client [9] (test)  loss: 0.3759 -> 0.3604   acc: 86.14% -> 87.32%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2949 -> 0.3650   acc: 89.24% -> 90.51%             
client [33] (test)  loss: 0.3132 -> 0.1629   acc: 88.96% -> 94.81%             
client [16] (test)  loss: 0.2198 -> 0.1480   acc: 91.45% -> 94.42%             
client [44] (test)  loss: 0.2324 -> 0.2595   acc: 92.07% -> 92.35%             
client [8] (test)  loss: 0.2098 -> 0.1544   acc: 94.10% -> 95.08%              
client [31] (test)  loss: 0.3247 -> 0.3439   acc: 91.19% -> 89.43%             
client [47] (test)  loss: 0.2910 -> 0.1534   acc: 91.57% -> 93.98%             
client [36] (test)  loss: 0.4379 -> 0.2510   acc: 82.57% -> 91.45%             
client [20] (test)  loss: 0.1138 -> 0.0855   acc: 95.10% -> 98.04%             
client [56] (test)  loss: 0.2119 -> 0.1529   acc: 92.33% -> 94.79%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1789 -> 0.0959   acc: 94.14% -> 96.74%              
client [60] (test)  loss: 0.0902 -> 0.0800   acc: 98.15% -> 98.15%             
client [28] (test)  loss: 0.3610 -> 0.3331   acc: 86.51% -> 88.89%             
client [25] (test)  loss: 0.5182 -> 0.2390   acc: 82.75% -> 92.33%             
client [58] (test)  loss: 0.1890 -> 0.1376   acc: 93.95% -> 93.45%             
client [44] (test)  loss: 0.4263 -> 0.2316   acc: 84.99% -> 93.48%             
client [39] (test)  loss: 0.2962 -> 0.1274   acc: 90.70% -> 96.80%             
client [29] (test)  loss: 0.3780 -> 0.1866   acc: 87.12% -> 93.99%             
client [3] (test)  loss: 0.2334 -> 0.0993   acc: 91.18% -> 96.41%              
client [84] (test)  loss: 0.6644 -> 0.2533   acc: 74.38% -> 93.24%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2187 -> 0.1858   acc: 94.08% -> 94.70%             
client [84] (test)  loss: 0.2608 -> 0.2252   acc: 91.46% -> 93.59%             
client [10] (test)  loss: 0.1368 -> 0.1722   acc: 95.31% -> 94.92%             
client [36] (test)  loss: 0.3045 -> 0.2082   acc: 87.83% -> 91.78%             
client [65] (test)  loss: 0.1520 -> 0.1728   acc: 94.87% -> 95.19%             
client [81] (test)  loss: 0.1802 -> 0.2040   acc: 92.48% -> 92.92%             
client [79] (test)  loss: 0.2272 -> 0.2228   acc: 93.18% -> 93.64%             
client [42] (test)  loss: 0.2381 -> 0.2523   acc: 90.99% -> 91.59%             
client [11] (test)  loss: 0.3682 -> 0.2675   acc: 86.55% -> 91.60%             
client [96] (test)  loss: 0.3005 -> 0.2160   acc: 89.72% -> 92.55%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1310 -> 0.1167   acc: 96.72% -> 96.07%              
client [53] (test)  loss: 0.3129 -> 0.2933   acc: 87.45% -> 87.84%             
client [52] (test)  loss: 0.1736 -> 0.1559   acc: 94.25% -> 96.49%             
client [42] (test)  loss: 0.2234 -> 0.2133   acc: 91.89% -> 92.79%             
client [69] (test)  loss: 0.1489 -> 0.0951   acc: 94.98% -> 97.66%             
client [59] (test)  loss: 0.1019 -> 0.0984   acc: 97.02% -> 97.02%             
client [7] (test)  loss: 0.0597 -> 0.0583   acc: 97.69% -> 97.69%              
client [26] (test)  loss: 0.0963 -> 0.0842   acc: 97.45% -> 97.70%             
client [49] (test)  loss: 0.1171 -> 0.0833   acc: 97.40% -> 97.73%             
client [98] (test)  loss: 0.3736 -> 0.2753   acc: 88.48% -> 93.19%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3166 -> 0.2393   acc: 91.62% -> 93.72%             
client [47] (test)  loss: 0.1907 -> 0.0790   acc: 94.58% -> 97.29%             
client [21] (test)  loss: 0.1945 -> 0.1508   acc: 95.33% -> 95.33%             
client [77] (test)  loss: 0.2610 -> 0.2449   acc: 91.64% -> 92.95%             
client [95] (test)  loss: 0.1939 -> 0.1936   acc: 93.17% -> 93.57%             
client [91] (test)  loss: 0.1677 -> 0.1296   acc: 94.12% -> 96.26%             
client [14] (test)  loss: 0.1205 -> 0.0571   acc: 95.76% -> 98.48%             
client [99] (test)  loss: 0.2138 -> 0.2241   acc: 92.76% -> 93.45%             
client [20] (test)  loss: 0.0411 -> 0.0412   acc: 98.37% -> 98.37%             
client [39] (test)  loss: 0.2042 -> 0.0892   acc: 93.31% -> 97.67%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1542 -> 0.1527   acc: 94.25% -> 97.12%             
client [62] (test)  loss: 0.0722 -> 0.0636   acc: 97.14% -> 96.57%             
client [71] (test)  loss: 0.2070 -> 0.0954   acc: 92.00% -> 96.80%             
client [97] (test)  loss: 0.1364 -> 0.0703   acc: 96.23% -> 98.11%             
client [30] (test)  loss: 0.0269 -> 0.0344   acc: 99.37% -> 99.37%             
client [88] (test)  loss: 0.1138 -> 0.0443   acc: 94.55% -> 98.40%             
client [60] (test)  loss: 0.0945 -> 0.0825   acc: 97.53% -> 98.77%             
client [82] (test)  loss: 0.2112 -> 0.2038   acc: 92.23% -> 94.50%             
client [91] (test)  loss: 0.1184 -> 0.1210   acc: 96.79% -> 96.79%             
client [57] (test)  loss: 0.0577 -> 0.1178   acc: 97.96% -> 96.43%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1060 -> 0.0898   acc: 96.04% -> 97.80%             
client [15] (test)  loss: 0.0316 -> 0.0284   acc: 98.75% -> 99.06%             
client [71] (test)  loss: 0.1663 -> 0.0835   acc: 93.60% -> 96.00%             
client [97] (test)  loss: 0.1009 -> 0.0578   acc: 96.77% -> 98.65%             
client [53] (test)  loss: 0.2259 -> 0.2305   acc: 90.20% -> 91.37%             
client [77] (test)  loss: 0.3155 -> 0.2284   acc: 90.34% -> 93.99%             
client [76] (test)  loss: 0.1676 -> 0.0895   acc: 94.01% -> 96.19%             
client [79] (test)  loss: 0.2071 -> 0.1859   acc: 94.09% -> 93.18%             
client [28] (test)  loss: 0.1475 -> 0.1278   acc: 95.63% -> 95.24%             
client [99] (test)  loss: 0.1926 -> 0.1833   acc: 93.79% -> 94.14%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1131 -> 0.0574   acc: 96.50% -> 98.11%             
client [86] (test)  loss: 0.0791 -> 0.0405   acc: 96.92% -> 97.44%             
client [34] (test)  loss: 0.0889 -> 0.0474   acc: 97.31% -> 98.66%             
client [73] (test)  loss: 0.0569 -> 0.0280   acc: 98.38% -> 99.60%             
client [5] (test)  loss: 0.1704 -> 0.1047   acc: 95.60% -> 97.53%              
client [96] (test)  loss: 0.2312 -> 0.1352   acc: 92.55% -> 96.45%             
client [22] (test)  loss: 0.1165 -> 0.1074   acc: 95.56% -> 97.22%             
client [60] (test)  loss: 0.0760 -> 0.0696   acc: 98.77% -> 98.77%             
client [66] (test)  loss: 0.1164 -> 0.1189   acc: 97.10% -> 97.10%             
client [83] (test)  loss: 0.1822 -> 0.1710   acc: 93.84% -> 95.32%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0724 -> 0.0869   acc: 97.55% -> 96.19%             
client [65] (test)  loss: 0.0961 -> 0.1003   acc: 97.12% -> 97.44%             
client [95] (test)  loss: 0.1543 -> 0.1384   acc: 93.57% -> 95.58%             
client [17] (test)  loss: 0.1707 -> 0.1737   acc: 94.52% -> 95.21%             
client [8] (test)  loss: 0.1000 -> 0.0909   acc: 96.72% -> 97.05%              
client [35] (test)  loss: 0.0564 -> 0.0403   acc: 98.15% -> 98.38%             
client [98] (test)  loss: 0.2691 -> 0.2210   acc: 92.67% -> 93.19%             
client [53] (test)  loss: 0.1459 -> 0.2032   acc: 92.94% -> 92.16%             
client [43] (test)  loss: 0.1402 -> 0.0817   acc: 96.31% -> 98.03%             
client [64] (test)  loss: 0.1657 -> 0.1666   acc: 94.94% -> 94.30%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1618 -> 0.0907   acc: 95.02% -> 96.26%             
client [88] (test)  loss: 0.0649 -> 0.0262   acc: 97.44% -> 98.72%             
client [38] (test)  loss: 0.1040 -> 0.0896   acc: 96.44% -> 97.92%             
client [3] (test)  loss: 0.1067 -> 0.0520   acc: 96.73% -> 98.37%              
client [5] (test)  loss: 0.1963 -> 0.1068   acc: 94.78% -> 96.70%              
client [41] (test)  loss: 0.1418 -> 0.1574   acc: 94.40% -> 93.60%             
client [7] (test)  loss: 0.0277 -> 0.0185   acc: 99.14% -> 99.42%              
client [37] (test)  loss: 0.1168 -> 0.1012   acc: 95.67% -> 96.67%             
client [45] (test)  loss: 0.1706 -> 0.2187   acc: 95.27% -> 92.74%             
client [47] (test)  loss: 0.1351 -> 0.0561   acc: 95.48% -> 98.19%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0619 -> 0.0597   acc: 98.14% -> 97.77%             
client [11] (test)  loss: 0.1458 -> 0.1379   acc: 96.22% -> 95.80%             
client [37] (test)  loss: 0.1040 -> 0.0900   acc: 96.67% -> 96.67%             
client [41] (test)  loss: 0.1300 -> 0.1442   acc: 95.20% -> 95.20%             
client [95] (test)  loss: 0.1499 -> 0.1407   acc: 95.18% -> 95.18%             
client [53] (test)  loss: 0.1341 -> 0.1548   acc: 93.73% -> 91.76%             
client [22] (test)  loss: 0.1022 -> 0.1379   acc: 96.67% -> 96.11%             
client [25] (test)  loss: 0.1515 -> 0.1275   acc: 95.53% -> 97.76%             
client [69] (test)  loss: 0.0729 -> 0.0354   acc: 96.99% -> 98.33%             
client [46] (test)  loss: 0.0363 -> 0.0504   acc: 98.72% -> 97.86%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0886 -> 0.0647   acc: 97.29% -> 98.80%             
client [69] (test)  loss: 0.1059 -> 0.0347   acc: 95.99% -> 97.66%             
client [82] (test)  loss: 0.1494 -> 0.1262   acc: 95.15% -> 96.44%             
client [45] (test)  loss: 0.1227 -> 0.1992   acc: 97.16% -> 93.69%             
client [7] (test)  loss: 0.0378 -> 0.0115   acc: 98.27% -> 99.42%              
client [50] (test)  loss: 0.1028 -> 0.0688   acc: 97.45% -> 98.18%             
client [35] (test)  loss: 0.0514 -> 0.0422   acc: 98.15% -> 98.84%             
client [24] (test)  loss: 0.1853 -> 0.1135   acc: 93.40% -> 95.94%             
client [15] (test)  loss: 0.0417 -> 0.0162   acc: 98.75% -> 99.38%             
client [58] (test)  loss: 0.0961 -> 0.0450   acc: 96.22% -> 98.74%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0635 -> 0.0895   acc: 96.96% -> 96.96%             
client [76] (test)  loss: 0.0495 -> 0.0509   acc: 97.82% -> 97.82%             
client [67] (test)  loss: 0.0979 -> 0.0794   acc: 98.46% -> 97.68%             
client [37] (test)  loss: 0.0642 -> 0.0867   acc: 97.67% -> 97.00%             
client [58] (test)  loss: 0.1227 -> 0.0410   acc: 94.71% -> 98.74%             
client [64] (test)  loss: 0.1508 -> 0.1337   acc: 95.57% -> 95.57%             
client [77] (test)  loss: 0.1386 -> 0.2036   acc: 96.87% -> 94.78%             
client [55] (test)  loss: 0.0301 -> 0.0647   acc: 98.80% -> 97.59%             
client [12] (test)  loss: 0.0254 -> 0.0407   acc: 98.82% -> 98.43%             
client [89] (test)  loss: 0.0905 -> 0.0388   acc: 97.12% -> 98.85%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1212 -> 0.1260   acc: 96.09% -> 96.80%             
client [51] (test)  loss: 0.1385 -> 0.1220   acc: 94.87% -> 95.73%             
client [8] (test)  loss: 0.0736 -> 0.0750   acc: 98.36% -> 98.03%              
client [18] (test)  loss: 0.0234 -> 0.0277   acc: 99.34% -> 99.34%             
client [94] (test)  loss: 0.0186 -> 0.0232   acc: 99.22% -> 98.83%             
client [81] (test)  loss: 0.0719 -> 0.0604   acc: 97.35% -> 98.67%             
client [3] (test)  loss: 0.0696 -> 0.0440   acc: 98.04% -> 98.69%              
client [11] (test)  loss: 0.1379 -> 0.1214   acc: 97.48% -> 95.80%             
client [95] (test)  loss: 0.1355 -> 0.1190   acc: 95.18% -> 96.79%             
client [67] (test)  loss: 0.1442 -> 0.0796   acc: 97.68% -> 98.46%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1085 -> 0.0632   acc: 96.26% -> 97.82%             
client [79] (test)  loss: 0.1583 -> 0.1354   acc: 95.91% -> 95.00%             
client [58] (test)  loss: 0.0655 -> 0.0462   acc: 96.98% -> 98.24%             
client [88] (test)  loss: 0.0922 -> 0.0233   acc: 98.08% -> 99.04%             
client [46] (test)  loss: 0.0277 -> 0.0407   acc: 99.15% -> 99.57%             
client [11] (test)  loss: 0.1619 -> 0.1203   acc: 95.80% -> 96.64%             
client [55] (test)  loss: 0.0548 -> 0.0411   acc: 96.99% -> 98.19%             
client [13] (test)  loss: 0.0721 -> 0.0778   acc: 98.60% -> 98.31%             
client [31] (test)  loss: 0.0227 -> 0.0311   acc: 99.12% -> 98.24%             
client [75] (test)  loss: 0.0643 -> 0.0609   acc: 97.88% -> 98.94%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0590 -> 0.0379   acc: 98.47% -> 99.08%             
client [7] (test)  loss: 0.0227 -> 0.0189   acc: 99.14% -> 98.85%              
client [57] (test)  loss: 0.0135 -> 0.0208   acc: 99.49% -> 98.98%             
client [13] (test)  loss: 0.0778 -> 0.0719   acc: 98.31% -> 98.31%             
client [43] (test)  loss: 0.1087 -> 0.0895   acc: 96.81% -> 97.30%             
client [91] (test)  loss: 0.0477 -> 0.0548   acc: 97.33% -> 98.40%             
client [10] (test)  loss: 0.0575 -> 0.0652   acc: 98.05% -> 98.44%             
client [64] (test)  loss: 0.1097 -> 0.1202   acc: 96.84% -> 96.20%             
client [82] (test)  loss: 0.1132 -> 0.0977   acc: 96.44% -> 97.41%             
client [22] (test)  loss: 0.0925 -> 0.0905   acc: 97.78% -> 97.22%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0191 -> 0.0202   acc: 99.35% -> 99.02%             
client [23] (test)  loss: 0.1359 -> 0.1133   acc: 96.94% -> 96.67%             
client [88] (test)  loss: 0.0535 -> 0.0182   acc: 98.72% -> 99.36%             
client [98] (test)  loss: 0.2329 -> 0.1797   acc: 93.19% -> 95.29%             
client [79] (test)  loss: 0.1351 -> 0.1338   acc: 96.36% -> 96.36%             
client [21] (test)  loss: 0.1005 -> 0.0555   acc: 96.26% -> 98.13%             
client [92] (test)  loss: 0.1231 -> 0.1802   acc: 95.45% -> 94.70%             
client [56] (test)  loss: 0.0313 -> 0.0376   acc: 99.08% -> 98.16%             
client [5] (test)  loss: 0.1802 -> 0.0939   acc: 95.88% -> 97.53%              
client [52] (test)  loss: 0.0880 -> 0.0904   acc: 97.44% -> 97.44%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1407 -> 0.0000', 'accuracy': '95.35% -> 0.00%'},          
    200: {'loss': '0.0855 -> 0.0000', 'accuracy': '97.37% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(10.49%) at epoch: 0                                      
FedDyn achieved 30.0%(34.72%) at epoch: 4                                      
FedDyn achieved 40.0%(47.52%) at epoch: 5                                      
FedDyn achieved 50.0%(57.08%) at epoch: 7                                      
FedDyn achieved 60.0%(64.32%) at epoch: 9                                      
FedDyn achieved 70.0%(70.80%) at epoch: 12                                     
FedDyn achieved 80.0%(82.64%) at epoch: 17                                     
FedDyn achieved 90.0%(90.17%) at epoch: 34                                     
Convergence (test_after):                                                      
FedDyn achieved 30.0%(32.54%) at epoch: 0                                      
FedDyn achieved 40.0%(40.65%) at epoch: 2                                      
FedDyn achieved 50.0%(53.60%) at epoch: 3                                      
FedDyn achieved 60.0%(65.25%) at epoch: 5                                      
FedDyn achieved 70.0%(75.01%) at epoch: 8                                      
FedDyn achieved 80.0%(80.30%) at epoch: 14                                     
FedDyn achieved 90.0%(90.40%) at epoch: 20                                     
