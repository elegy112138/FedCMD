==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5349 -> 0.4852   acc: 79.92% -> 86.03%             
client [81] (test)  loss: 0.9708 -> 0.6929   acc: 76.52% -> 79.31%             
client [21] (test)  loss: 0.7756 -> 0.6578   acc: 75.99% -> 78.18%             
client [68] (test)  loss: 0.7884 -> 0.5823   acc: 75.86% -> 80.16%             
client [93] (test)  loss: 1.0240 -> 0.6995   acc: 71.30% -> 77.80%             
client [31] (test)  loss: 0.8023 -> 0.6385   acc: 74.85% -> 79.66%             
client [20] (test)  loss: 0.5919 -> 0.5435   acc: 81.04% -> 82.88%             
client [59] (test)  loss: 0.5265 -> 0.3680   acc: 83.64% -> 87.95%             
client [48] (test)  loss: 0.9285 -> 0.7061   acc: 74.78% -> 76.45%             
client [34] (test)  loss: 1.1494 -> 0.6457   acc: 66.35% -> 78.63%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3927 -> 0.2378   acc: 85.55% -> 92.42%             
client [99] (test)  loss: 0.8599 -> 0.6384   acc: 76.09% -> 79.34%             
client [67] (test)  loss: 0.4673 -> 0.3046   acc: 83.79% -> 91.15%             
client [0] (test)  loss: 0.8819 -> 0.6164   acc: 76.18% -> 80.08%              
client [76] (test)  loss: 0.8447 -> 0.5894   acc: 76.67% -> 81.08%             
client [41] (test)  loss: 1.0675 -> 0.6344   acc: 71.29% -> 75.78%             
client [62] (test)  loss: 0.8539 -> 0.4668   acc: 78.46% -> 84.86%             
client [2] (test)  loss: 0.8761 -> 0.5571   acc: 77.34% -> 82.94%              
client [14] (test)  loss: 0.7869 -> 0.6365   acc: 78.22% -> 79.51%             
client [46] (test)  loss: 1.4721 -> 0.5998   acc: 62.71% -> 83.39%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4993 -> 0.4901   acc: 81.42% -> 82.14%             
client [68] (test)  loss: 0.5301 -> 0.4213   acc: 82.12% -> 85.66%             
client [57] (test)  loss: 0.3182 -> 0.2755   acc: 88.62% -> 90.19%             
client [17] (test)  loss: 0.5053 -> 0.4492   acc: 82.78% -> 85.61%             
client [54] (test)  loss: 0.3946 -> 0.3309   acc: 86.41% -> 89.48%             
client [23] (test)  loss: 0.8182 -> 0.6085   acc: 76.31% -> 81.17%             
client [35] (test)  loss: 0.8237 -> 0.6039   acc: 75.42% -> 80.68%             
client [59] (test)  loss: 0.3743 -> 0.2883   acc: 87.93% -> 91.17%             
client [31] (test)  loss: 0.5426 -> 0.5362   acc: 81.25% -> 82.71%             
client [9] (test)  loss: 0.8501 -> 0.5985   acc: 74.63% -> 78.70%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7411 -> 0.4585   acc: 78.06% -> 85.18%             
client [33] (test)  loss: 0.8378 -> 0.5441   acc: 76.22% -> 82.12%             
client [16] (test)  loss: 1.0220 -> 0.5533   acc: 70.40% -> 81.95%             
client [44] (test)  loss: 0.9099 -> 0.6288   acc: 74.45% -> 76.45%             
client [8] (test)  loss: 0.4495 -> 0.4523   acc: 86.91% -> 85.99%              
client [31] (test)  loss: 0.5961 -> 0.5122   acc: 81.37% -> 83.37%             
client [47] (test)  loss: 0.3931 -> 0.2355   acc: 85.91% -> 91.75%             
client [36] (test)  loss: 0.3654 -> 0.1966   acc: 86.95% -> 93.73%             
client [20] (test)  loss: 0.4890 -> 0.4408   acc: 85.08% -> 87.38%             
client [56] (test)  loss: 0.4909 -> 0.3863   acc: 84.38% -> 86.42%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6129 -> 0.3955   acc: 80.95% -> 86.47%              
client [60] (test)  loss: 0.3943 -> 0.2960   acc: 87.37% -> 88.89%             
client [28] (test)  loss: 0.4062 -> 0.3052   acc: 86.28% -> 91.28%             
client [25] (test)  loss: 0.2716 -> 0.1949   acc: 91.59% -> 94.47%             
client [58] (test)  loss: 0.3748 -> 0.3118   acc: 88.31% -> 91.04%             
client [44] (test)  loss: 0.8155 -> 0.6089   acc: 73.62% -> 76.42%             
client [39] (test)  loss: 0.6821 -> 0.4762   acc: 76.93% -> 84.25%             
client [29] (test)  loss: 0.6016 -> 0.5101   acc: 80.80% -> 86.02%             
client [3] (test)  loss: 0.3527 -> 0.3446   acc: 87.19% -> 87.87%              
client [84] (test)  loss: 0.7030 -> 0.5722   acc: 79.37% -> 82.88%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7520 -> 0.4906   acc: 80.31% -> 83.64%             
client [84] (test)  loss: 1.1067 -> 0.5587   acc: 73.68% -> 83.49%             
client [10] (test)  loss: 1.0353 -> 0.4209   acc: 71.48% -> 87.22%             
client [36] (test)  loss: 0.2765 -> 0.1737   acc: 89.95% -> 94.78%             
client [65] (test)  loss: 0.2815 -> 0.2622   acc: 91.81% -> 92.50%             
client [81] (test)  loss: 1.0327 -> 0.5240   acc: 79.21% -> 84.11%             
client [79] (test)  loss: 0.2125 -> 0.2285   acc: 93.52% -> 92.81%             
client [42] (test)  loss: 0.8563 -> 0.3979   acc: 75.45% -> 87.78%             
client [11] (test)  loss: 0.4995 -> 0.3637   acc: 87.01% -> 89.37%             
client [96] (test)  loss: 0.3339 -> 0.3225   acc: 89.02% -> 89.47%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4051 -> 0.4160   acc: 87.56% -> 86.74%              
client [53] (test)  loss: 0.2749 -> 0.2056   acc: 92.26% -> 94.37%             
client [52] (test)  loss: 0.9488 -> 0.4563   acc: 71.71% -> 84.59%             
client [42] (test)  loss: 0.5526 -> 0.3892   acc: 79.95% -> 87.71%             
client [69] (test)  loss: 0.2627 -> 0.2093   acc: 91.67% -> 93.96%             
client [59] (test)  loss: 0.3028 -> 0.2507   acc: 90.87% -> 92.52%             
client [7] (test)  loss: 0.6020 -> 0.4937   acc: 77.64% -> 82.20%              
client [26] (test)  loss: 0.2833 -> 0.2793   acc: 91.70% -> 91.55%             
client [49] (test)  loss: 0.4233 -> 0.4136   acc: 86.10% -> 87.00%             
client [98] (test)  loss: 0.4800 -> 0.4732   acc: 84.29% -> 84.97%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5884 -> 0.4719   acc: 82.04% -> 85.14%             
client [47] (test)  loss: 0.2976 -> 0.2113   acc: 89.06% -> 92.31%             
client [21] (test)  loss: 0.6033 -> 0.4753   acc: 81.68% -> 85.19%             
client [77] (test)  loss: 0.2605 -> 0.2483   acc: 90.69% -> 91.16%             
client [95] (test)  loss: 0.4028 -> 0.3775   acc: 88.90% -> 89.19%             
client [91] (test)  loss: 1.3426 -> 0.5822   acc: 67.37% -> 81.08%             
client [14] (test)  loss: 0.6121 -> 0.4912   acc: 82.13% -> 84.40%             
client [99] (test)  loss: 0.7311 -> 0.5020   acc: 78.90% -> 83.77%             
client [20] (test)  loss: 0.4379 -> 0.4119   acc: 86.09% -> 88.19%             
client [39] (test)  loss: 0.8500 -> 0.4605   acc: 77.12% -> 84.95%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8651 -> 0.4510   acc: 73.76% -> 84.97%             
client [62] (test)  loss: 0.6816 -> 0.4291   acc: 82.46% -> 87.42%             
client [71] (test)  loss: 0.7359 -> 0.5140   acc: 80.59% -> 83.78%             
client [97] (test)  loss: 0.2792 -> 0.2233   acc: 91.54% -> 93.41%             
client [30] (test)  loss: 0.3314 -> 0.2708   acc: 88.54% -> 91.70%             
client [88] (test)  loss: 0.3524 -> 0.3505   acc: 89.40% -> 88.78%             
client [60] (test)  loss: 0.3191 -> 0.2946   acc: 90.15% -> 90.01%             
client [82] (test)  loss: 0.4286 -> 0.3523   acc: 85.57% -> 88.39%             
client [91] (test)  loss: 1.1462 -> 0.5784   acc: 68.74% -> 82.21%             
client [57] (test)  loss: 0.2721 -> 0.2197   acc: 90.34% -> 91.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4995 -> 0.4644   acc: 81.93% -> 85.69%             
client [15] (test)  loss: 0.4630 -> 0.4340   acc: 83.04% -> 83.38%             
client [71] (test)  loss: 0.6836 -> 0.5066   acc: 77.60% -> 84.00%             
client [97] (test)  loss: 0.3185 -> 0.2310   acc: 89.15% -> 93.21%             
client [53] (test)  loss: 0.4019 -> 0.1971   acc: 84.46% -> 94.66%             
client [77] (test)  loss: 0.3194 -> 0.2434   acc: 88.14% -> 91.75%             
client [76] (test)  loss: 0.5625 -> 0.4698   acc: 79.64% -> 84.50%             
client [79] (test)  loss: 0.3386 -> 0.2051   acc: 87.09% -> 93.69%             
client [28] (test)  loss: 0.4588 -> 0.2931   acc: 84.71% -> 91.69%             
client [99] (test)  loss: 0.6050 -> 0.4991   acc: 79.17% -> 84.21%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2715 -> 0.2268   acc: 91.28% -> 93.48%             
client [86] (test)  loss: 0.2752 -> 0.2774   acc: 92.75% -> 93.37%             
client [34] (test)  loss: 0.8383 -> 0.4588   acc: 74.98% -> 85.52%             
client [73] (test)  loss: 0.9016 -> 0.5220   acc: 77.34% -> 84.99%             
client [5] (test)  loss: 0.7959 -> 0.4647   acc: 83.15% -> 86.84%              
client [96] (test)  loss: 0.3272 -> 0.3172   acc: 89.37% -> 90.28%             
client [22] (test)  loss: 1.0007 -> 0.4349   acc: 75.41% -> 86.38%             
client [60] (test)  loss: 0.3555 -> 0.2958   acc: 89.32% -> 90.32%             
client [66] (test)  loss: 0.3976 -> 0.3415   acc: 87.97% -> 89.59%             
client [83] (test)  loss: 0.4761 -> 0.4038   acc: 83.78% -> 86.24%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6268 -> 0.4796   acc: 83.68% -> 85.33%             
client [65] (test)  loss: 0.2726 -> 0.2608   acc: 92.57% -> 92.89%             
client [95] (test)  loss: 0.3713 -> 0.3909   acc: 89.98% -> 89.22%             
client [17] (test)  loss: 0.3656 -> 0.3297   acc: 90.49% -> 90.02%             
client [8] (test)  loss: 0.3994 -> 0.3792   acc: 88.86% -> 89.03%              
client [35] (test)  loss: 0.9858 -> 0.5965   acc: 75.99% -> 82.96%             
client [98] (test)  loss: 0.5688 -> 0.4514   acc: 84.10% -> 86.09%             
client [53] (test)  loss: 0.2326 -> 0.2054   acc: 92.98% -> 94.42%             
client [43] (test)  loss: 0.4859 -> 0.3979   acc: 87.76% -> 87.73%             
client [64] (test)  loss: 0.8885 -> 0.4226   acc: 78.38% -> 86.19%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6063 -> 0.4779   acc: 83.62% -> 84.67%             
client [88] (test)  loss: 0.4187 -> 0.3569   acc: 88.80% -> 89.26%             
client [38] (test)  loss: 0.7137 -> 0.4599   acc: 83.11% -> 85.59%             
client [3] (test)  loss: 0.4072 -> 0.3665   acc: 87.70% -> 89.44%              
client [5] (test)  loss: 0.8241 -> 0.4625   acc: 82.78% -> 87.43%              
client [41] (test)  loss: 0.8881 -> 0.5716   acc: 76.62% -> 80.47%             
client [7] (test)  loss: 0.7606 -> 0.5145   acc: 78.89% -> 82.62%              
client [37] (test)  loss: 1.2168 -> 0.6752   acc: 74.38% -> 78.25%             
client [45] (test)  loss: 0.4571 -> 0.4222   acc: 86.72% -> 87.19%             
client [47] (test)  loss: 0.2783 -> 0.2235   acc: 90.36% -> 92.41%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0818 -> 0.5736   acc: 70.11% -> 83.14%             
client [11] (test)  loss: 0.3951 -> 0.3522   acc: 87.83% -> 90.56%             
client [37] (test)  loss: 0.8501 -> 0.7095   acc: 75.82% -> 78.45%             
client [41] (test)  loss: 0.6389 -> 0.5616   acc: 78.51% -> 80.50%             
client [95] (test)  loss: 0.4653 -> 0.3893   acc: 85.09% -> 89.96%             
client [53] (test)  loss: 0.4077 -> 0.2090   acc: 85.87% -> 94.73%             
client [22] (test)  loss: 0.8479 -> 0.4516   acc: 75.80% -> 85.99%             
client [25] (test)  loss: 0.3217 -> 0.2280   acc: 89.25% -> 94.49%             
client [69] (test)  loss: 0.3561 -> 0.2064   acc: 89.01% -> 94.37%             
client [46] (test)  loss: 0.7219 -> 0.5184   acc: 76.69% -> 88.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3348 -> 0.2415   acc: 88.40% -> 92.70%             
client [69] (test)  loss: 0.3507 -> 0.2320   acc: 89.72% -> 94.28%             
client [82] (test)  loss: 0.4457 -> 0.3713   acc: 85.91% -> 88.92%             
client [45] (test)  loss: 0.4481 -> 0.4561   acc: 86.38% -> 87.21%             
client [7] (test)  loss: 0.6043 -> 0.5115   acc: 79.92% -> 82.25%              
client [50] (test)  loss: 0.3896 -> 0.4229   acc: 89.12% -> 88.45%             
client [35] (test)  loss: 0.9644 -> 0.6331   acc: 77.18% -> 82.99%             
client [24] (test)  loss: 0.4979 -> 0.4619   acc: 83.52% -> 84.57%             
client [15] (test)  loss: 0.5635 -> 0.4528   acc: 81.43% -> 84.07%             
client [58] (test)  loss: 0.4064 -> 0.3193   acc: 87.53% -> 91.50%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6457 -> 0.5767   acc: 82.81% -> 83.01%             
client [76] (test)  loss: 0.6172 -> 0.4681   acc: 82.68% -> 85.55%             
client [67] (test)  loss: 0.3999 -> 0.2614   acc: 88.70% -> 94.25%             
client [37] (test)  loss: 0.9357 -> 0.7134   acc: 75.10% -> 78.51%             
client [58] (test)  loss: 0.3610 -> 0.3224   acc: 89.72% -> 91.62%             
client [64] (test)  loss: 0.6178 -> 0.4493   acc: 81.73% -> 86.32%             
client [77] (test)  loss: 0.3461 -> 0.2441   acc: 88.53% -> 92.24%             
client [55] (test)  loss: 0.4223 -> 0.3858   acc: 87.82% -> 88.71%             
client [12] (test)  loss: 0.5946 -> 0.5177   acc: 83.03% -> 85.68%             
client [89] (test)  loss: 0.5237 -> 0.4039   acc: 86.99% -> 88.28%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7455 -> 0.6646   acc: 77.06% -> 83.39%             
client [51] (test)  loss: 0.8487 -> 0.6360   acc: 74.03% -> 81.17%             
client [8] (test)  loss: 0.4452 -> 0.4131   acc: 85.63% -> 88.74%              
client [18] (test)  loss: 0.6197 -> 0.4989   acc: 81.30% -> 86.34%             
client [94] (test)  loss: 0.3414 -> 0.2035   acc: 88.03% -> 94.52%             
client [81] (test)  loss: 0.6796 -> 0.5372   acc: 80.67% -> 86.98%             
client [3] (test)  loss: 0.3764 -> 0.3877   acc: 87.67% -> 89.70%              
client [11] (test)  loss: 0.4168 -> 0.3700   acc: 87.03% -> 90.00%             
client [95] (test)  loss: 0.4745 -> 0.3963   acc: 85.29% -> 90.55%             
client [67] (test)  loss: 0.4243 -> 0.2542   acc: 87.65% -> 94.23%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5937 -> 0.5212   acc: 83.52% -> 84.40%             
client [79] (test)  loss: 0.2322 -> 0.2094   acc: 93.76% -> 94.43%             
client [58] (test)  loss: 0.4175 -> 0.3327   acc: 88.00% -> 91.58%             
client [88] (test)  loss: 0.4168 -> 0.3843   acc: 88.34% -> 88.46%             
client [46] (test)  loss: 0.8651 -> 0.5457   acc: 71.31% -> 88.29%             
client [11] (test)  loss: 0.3972 -> 0.3818   acc: 88.79% -> 89.86%             
client [55] (test)  loss: 0.4192 -> 0.3894   acc: 87.71% -> 89.09%             
client [13] (test)  loss: 0.7344 -> 0.4512   acc: 77.21% -> 88.54%             
client [31] (test)  loss: 0.5397 -> 0.4861   acc: 84.84% -> 86.47%             
client [75] (test)  loss: 0.4905 -> 0.4647   acc: 86.22% -> 88.47%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6611 -> 0.5392   acc: 85.49% -> 86.59%             
client [7] (test)  loss: 0.7319 -> 0.5581   acc: 78.84% -> 82.16%              
client [57] (test)  loss: 0.2925 -> 0.2439   acc: 90.89% -> 92.08%             
client [13] (test)  loss: 0.8936 -> 0.4566   acc: 76.15% -> 88.42%             
client [43] (test)  loss: 0.5206 -> 0.4266   acc: 87.62% -> 88.04%             
client [91] (test)  loss: 1.2268 -> 0.6399   acc: 70.34% -> 81.87%             
client [10] (test)  loss: 0.7978 -> 0.4971   acc: 79.95% -> 87.33%             
client [64] (test)  loss: 0.8740 -> 0.5004   acc: 79.85% -> 85.55%             
client [82] (test)  loss: 0.4920 -> 0.3901   acc: 86.30% -> 88.71%             
client [22] (test)  loss: 1.1451 -> 0.4885   acc: 74.26% -> 86.53%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5780 -> 0.4529   acc: 85.67% -> 88.58%             
client [23] (test)  loss: 0.9327 -> 0.6415   acc: 80.59% -> 83.57%             
client [88] (test)  loss: 0.4378 -> 0.3851   acc: 88.75% -> 88.75%             
client [98] (test)  loss: 0.5483 -> 0.5111   acc: 85.16% -> 86.54%             
client [79] (test)  loss: 0.2483 -> 0.2215   acc: 93.35% -> 94.57%             
client [21] (test)  loss: 0.6427 -> 0.5532   acc: 83.08% -> 84.04%             
client [92] (test)  loss: 0.6600 -> 0.4996   acc: 84.39% -> 86.13%             
client [56] (test)  loss: 0.4953 -> 0.3693   acc: 85.81% -> 88.64%             
client [5] (test)  loss: 0.8416 -> 0.5344   acc: 82.72% -> 87.56%              
client [52] (test)  loss: 1.0402 -> 0.5267   acc: 74.48% -> 85.20%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4988 -> 0.0000', 'accuracy': '83.12% -> 0.00%'},          
    200: {'loss': '0.6319 -> 0.0000', 'accuracy': '84.12% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 30.0%(35.16%) at epoch: 1                                      
FedDyn achieved 60.0%(63.52%) at epoch: 2                                      
FedDyn achieved 70.0%(70.14%) at epoch: 4                                      
FedDyn achieved 80.0%(80.91%) at epoch: 13                                     
Convergence (test_after):                                                      
FedDyn achieved 60.0%(67.01%) at epoch: 0                                      
FedDyn achieved 70.0%(73.04%) at epoch: 1                                      
FedDyn achieved 80.0%(81.92%) at epoch: 8                                      
FedDyn achieved 90.0%(90.54%) at epoch: 71                                     
