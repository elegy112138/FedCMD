==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3314 -> 4.2963   acc: 7.57% -> 8.22%               
client [81] (test)  loss: 4.4283 -> 4.3050   acc: 7.97% -> 6.98%               
client [21] (test)  loss: 4.3192 -> 4.1793   acc: 7.31% -> 9.63%               
client [68] (test)  loss: 4.2589 -> 4.1958   acc: 8.28% -> 13.91%              
client [93] (test)  loss: 4.2912 -> 4.0544   acc: 9.42% -> 13.64%              
client [31] (test)  loss: 4.2970 -> 4.0060   acc: 5.92% -> 12.89%              
client [20] (test)  loss: 4.3911 -> 4.0720   acc: 6.25% -> 15.28%              
client [59] (test)  loss: 4.5058 -> 4.0569   acc: 7.60% -> 11.25%              
client [48] (test)  loss: 4.2033 -> 4.1970   acc: 6.27% -> 7.26%               
client [34] (test)  loss: 4.3476 -> 4.1836   acc: 6.61% -> 12.91%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.0472 -> 3.7355   acc: 11.55% -> 13.86%             
client [99] (test)  loss: 3.8193 -> 3.6213   acc: 11.67% -> 17.03%             
client [67] (test)  loss: 3.9663 -> 3.7804   acc: 11.30% -> 18.94%             
client [0] (test)  loss: 4.0526 -> 4.0090   acc: 13.29% -> 17.61%              
client [76] (test)  loss: 4.2237 -> 3.8900   acc: 10.75% -> 14.34%             
client [41] (test)  loss: 4.2556 -> 4.1770   acc: 10.42% -> 12.70%             
client [62] (test)  loss: 3.8556 -> 3.8750   acc: 15.94% -> 20.65%             
client [2] (test)  loss: 3.9598 -> 3.7940   acc: 12.94% -> 16.83%              
client [14] (test)  loss: 3.9973 -> 3.8740   acc: 13.07% -> 16.25%             
client [46] (test)  loss: 3.6966 -> 3.5420   acc: 15.26% -> 24.03%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.5012 -> 3.7929   acc: 19.93% -> 21.28%             
client [68] (test)  loss: 3.7371 -> 3.8045   acc: 14.57% -> 20.20%             
client [57] (test)  loss: 3.5875 -> 3.5674   acc: 18.95% -> 18.95%             
client [17] (test)  loss: 3.6068 -> 3.6025   acc: 18.39% -> 22.58%             
client [54] (test)  loss: 3.8588 -> 3.5202   acc: 16.07% -> 22.50%             
client [23] (test)  loss: 3.7937 -> 3.7549   acc: 11.67% -> 16.33%             
client [35] (test)  loss: 3.8020 -> 3.7975   acc: 13.44% -> 15.08%             
client [59] (test)  loss: 3.5816 -> 3.4828   acc: 18.54% -> 25.23%             
client [31] (test)  loss: 3.4453 -> 3.3811   acc: 19.16% -> 21.25%             
client [9] (test)  loss: 3.6240 -> 3.6059   acc: 15.89% -> 19.54%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5851 -> 3.5594   acc: 16.83% -> 16.17%             
client [33] (test)  loss: 3.6699 -> 3.6490   acc: 15.31% -> 17.26%             
client [16] (test)  loss: 3.6269 -> 3.6484   acc: 17.77% -> 19.86%             
client [44] (test)  loss: 3.3829 -> 3.2538   acc: 21.31% -> 26.56%             
client [8] (test)  loss: 3.5138 -> 3.7722   acc: 17.23% -> 17.91%              
client [31] (test)  loss: 3.4197 -> 3.2465   acc: 19.16% -> 22.65%             
client [47] (test)  loss: 3.4456 -> 3.6569   acc: 20.98% -> 16.39%             
client [36] (test)  loss: 3.5490 -> 3.3360   acc: 19.93% -> 22.26%             
client [20] (test)  loss: 3.5793 -> 3.4608   acc: 21.53% -> 23.26%             
client [56] (test)  loss: 3.7324 -> 4.0634   acc: 20.62% -> 16.15%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.1960 -> 3.0863   acc: 25.33% -> 29.28%              
client [60] (test)  loss: 3.4628 -> 3.6370   acc: 19.81% -> 18.51%             
client [28] (test)  loss: 3.6374 -> 3.5311   acc: 18.87% -> 19.21%             
client [25] (test)  loss: 3.5505 -> 3.4949   acc: 16.90% -> 21.03%             
client [58] (test)  loss: 3.5356 -> 3.6126   acc: 22.66% -> 24.22%             
client [44] (test)  loss: 3.3439 -> 3.2217   acc: 18.36% -> 26.56%             
client [39] (test)  loss: 3.2116 -> 3.6275   acc: 23.67% -> 22.00%             
client [29] (test)  loss: 3.2870 -> 3.5260   acc: 26.16% -> 23.51%             
client [3] (test)  loss: 3.3060 -> 3.0959   acc: 22.22% -> 28.76%              
client [84] (test)  loss: 3.2825 -> 3.4096   acc: 21.90% -> 19.93%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.3962 -> 3.4279   acc: 20.93% -> 22.59%             
client [84] (test)  loss: 3.1576 -> 3.2793   acc: 19.28% -> 20.26%             
client [10] (test)  loss: 3.3771 -> 3.4204   acc: 18.81% -> 20.13%             
client [36] (test)  loss: 3.3796 -> 3.2527   acc: 21.59% -> 28.57%             
client [65] (test)  loss: 3.5220 -> 3.6350   acc: 18.81% -> 17.16%             
client [81] (test)  loss: 3.3781 -> 3.3383   acc: 22.59% -> 24.92%             
client [79] (test)  loss: 3.3961 -> 3.1431   acc: 19.67% -> 28.20%             
client [42] (test)  loss: 3.6085 -> 3.4945   acc: 17.88% -> 25.50%             
client [11] (test)  loss: 3.4293 -> 3.5461   acc: 22.15% -> 22.15%             
client [96] (test)  loss: 3.3110 -> 3.2980   acc: 22.18% -> 21.45%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.3235 -> 3.4727   acc: 19.59% -> 21.28%              
client [53] (test)  loss: 3.3835 -> 3.2746   acc: 21.17% -> 26.71%             
client [52] (test)  loss: 3.2713 -> 3.4356   acc: 24.03% -> 30.52%             
client [42] (test)  loss: 3.5173 -> 3.4300   acc: 20.53% -> 27.81%             
client [69] (test)  loss: 3.1557 -> 3.1380   acc: 21.78% -> 25.08%             
client [59] (test)  loss: 3.4315 -> 3.1502   acc: 22.19% -> 28.88%             
client [7] (test)  loss: 3.0319 -> 3.1587   acc: 30.07% -> 28.43%              
client [26] (test)  loss: 3.1527 -> 3.0974   acc: 24.83% -> 26.82%             
client [49] (test)  loss: 3.2972 -> 3.3544   acc: 21.31% -> 23.93%             
client [98] (test)  loss: 3.2813 -> 3.1209   acc: 23.95% -> 25.24%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.1688 -> 3.0931   acc: 26.21% -> 26.21%             
client [47] (test)  loss: 3.1242 -> 3.3149   acc: 27.54% -> 22.95%             
client [21] (test)  loss: 3.2781 -> 3.3957   acc: 22.59% -> 26.91%             
client [77] (test)  loss: 3.3080 -> 3.3826   acc: 22.37% -> 26.64%             
client [95] (test)  loss: 3.5783 -> 3.6237   acc: 21.28% -> 23.31%             
client [91] (test)  loss: 2.9761 -> 3.0327   acc: 26.64% -> 33.88%             
client [14] (test)  loss: 3.2701 -> 3.2983   acc: 27.21% -> 28.27%             
client [99] (test)  loss: 3.2018 -> 3.2630   acc: 27.13% -> 23.97%             
client [20] (test)  loss: 3.2108 -> 3.2352   acc: 28.47% -> 33.68%             
client [39] (test)  loss: 2.9299 -> 3.3222   acc: 26.33% -> 27.33%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.1803 -> 3.3109   acc: 30.52% -> 30.52%             
client [62] (test)  loss: 3.1614 -> 3.3148   acc: 26.45% -> 29.35%             
client [71] (test)  loss: 2.7541 -> 2.8418   acc: 32.34% -> 33.66%             
client [97] (test)  loss: 3.2255 -> 3.4164   acc: 23.84% -> 30.46%             
client [30] (test)  loss: 3.0472 -> 3.2641   acc: 31.02% -> 31.35%             
client [88] (test)  loss: 3.2779 -> 3.2954   acc: 25.58% -> 26.25%             
client [60] (test)  loss: 3.2197 -> 3.3890   acc: 23.05% -> 24.03%             
client [82] (test)  loss: 2.9298 -> 3.2284   acc: 32.12% -> 29.47%             
client [91] (test)  loss: 2.9169 -> 2.9547   acc: 30.26% -> 35.20%             
client [57] (test)  loss: 3.2359 -> 3.1789   acc: 25.82% -> 31.05%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.9707 -> 2.8455   acc: 27.53% -> 31.36%             
client [15] (test)  loss: 3.0671 -> 3.2052   acc: 28.29% -> 29.61%             
client [71] (test)  loss: 2.9074 -> 2.8230   acc: 29.37% -> 34.98%             
client [97] (test)  loss: 3.3024 -> 3.4570   acc: 22.85% -> 29.47%             
client [53] (test)  loss: 3.2897 -> 3.1812   acc: 25.73% -> 30.29%             
client [77] (test)  loss: 3.1732 -> 3.3259   acc: 21.71% -> 26.64%             
client [76] (test)  loss: 3.4597 -> 3.2400   acc: 22.58% -> 26.88%             
client [79] (test)  loss: 3.1024 -> 2.9561   acc: 28.20% -> 30.82%             
client [28] (test)  loss: 3.1245 -> 3.1619   acc: 26.49% -> 29.14%             
client [99] (test)  loss: 3.0701 -> 3.1970   acc: 26.81% -> 25.87%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.3392 -> 3.4334   acc: 23.18% -> 31.46%             
client [86] (test)  loss: 3.1369 -> 3.3727   acc: 27.42% -> 26.76%             
client [34] (test)  loss: 3.2039 -> 3.2647   acc: 23.42% -> 26.43%             
client [73] (test)  loss: 3.0435 -> 3.1603   acc: 28.85% -> 27.54%             
client [5] (test)  loss: 3.2953 -> 3.2736   acc: 22.70% -> 29.93%              
client [96] (test)  loss: 3.2001 -> 3.3238   acc: 25.45% -> 21.09%             
client [22] (test)  loss: 3.1490 -> 3.0905   acc: 24.10% -> 25.41%             
client [60] (test)  loss: 3.1528 -> 3.2429   acc: 26.62% -> 26.62%             
client [66] (test)  loss: 3.2304 -> 3.1918   acc: 26.77% -> 33.55%             
client [83] (test)  loss: 3.2763 -> 3.1508   acc: 24.75% -> 29.70%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.2991 -> 3.1884   acc: 23.30% -> 29.39%             
client [65] (test)  loss: 3.4150 -> 3.5854   acc: 22.77% -> 20.79%             
client [95] (test)  loss: 3.3288 -> 3.4768   acc: 31.08% -> 27.70%             
client [17] (test)  loss: 2.8376 -> 2.9482   acc: 33.87% -> 30.32%             
client [8] (test)  loss: 3.1481 -> 3.5162   acc: 27.36% -> 25.00%              
client [35] (test)  loss: 3.2825 -> 3.4587   acc: 26.23% -> 24.26%             
client [98] (test)  loss: 3.0381 -> 2.9117   acc: 26.54% -> 31.39%             
client [53] (test)  loss: 3.1033 -> 3.1437   acc: 29.32% -> 29.64%             
client [43] (test)  loss: 2.8298 -> 3.0505   acc: 33.00% -> 30.03%             
client [64] (test)  loss: 3.0285 -> 3.0007   acc: 25.08% -> 27.06%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.1400 -> 3.1918   acc: 28.57% -> 27.24%             
client [88] (test)  loss: 3.0171 -> 3.3471   acc: 31.56% -> 28.24%             
client [38] (test)  loss: 3.1830 -> 3.1776   acc: 23.03% -> 32.24%             
client [3] (test)  loss: 2.8256 -> 2.6536   acc: 33.33% -> 39.22%              
client [5] (test)  loss: 3.2130 -> 3.2493   acc: 25.99% -> 30.92%              
client [41] (test)  loss: 3.5666 -> 3.5829   acc: 24.76% -> 27.69%             
client [7] (test)  loss: 2.7460 -> 2.9001   acc: 38.24% -> 36.60%              
client [37] (test)  loss: 2.9720 -> 3.0523   acc: 28.48% -> 30.13%             
client [45] (test)  loss: 3.1400 -> 3.0553   acc: 22.85% -> 33.11%             
client [47] (test)  loss: 3.0386 -> 3.1513   acc: 31.48% -> 32.13%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.0851 -> 3.1372   acc: 31.01% -> 30.31%             
client [11] (test)  loss: 3.2533 -> 3.4760   acc: 30.20% -> 27.85%             
client [37] (test)  loss: 3.0245 -> 3.1016   acc: 25.17% -> 27.81%             
client [41] (test)  loss: 3.5922 -> 3.5816   acc: 24.76% -> 26.71%             
client [95] (test)  loss: 3.3563 -> 3.5424   acc: 29.05% -> 27.03%             
client [53] (test)  loss: 3.1584 -> 3.1032   acc: 28.34% -> 32.25%             
client [22] (test)  loss: 3.0788 -> 2.9653   acc: 26.38% -> 30.29%             
client [25] (test)  loss: 3.2528 -> 3.1951   acc: 27.59% -> 29.66%             
client [69] (test)  loss: 2.9490 -> 2.8982   acc: 28.38% -> 32.01%             
client [46] (test)  loss: 2.6442 -> 2.8174   acc: 35.71% -> 36.69%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.9279 -> 3.2371   acc: 30.82% -> 32.46%             
client [69] (test)  loss: 2.9646 -> 2.8817   acc: 30.69% -> 34.32%             
client [82] (test)  loss: 2.8142 -> 3.0476   acc: 35.76% -> 33.77%             
client [45] (test)  loss: 3.1634 -> 3.0522   acc: 27.48% -> 34.77%             
client [7] (test)  loss: 2.8178 -> 2.9009   acc: 38.24% -> 36.27%              
client [50] (test)  loss: 2.9180 -> 3.1075   acc: 35.96% -> 33.33%             
client [35] (test)  loss: 3.2250 -> 3.4630   acc: 30.82% -> 25.57%             
client [24] (test)  loss: 2.8494 -> 2.9690   acc: 34.46% -> 31.76%             
client [15] (test)  loss: 3.1053 -> 3.1939   acc: 31.58% -> 34.21%             
client [58] (test)  loss: 3.0595 -> 3.4070   acc: 27.73% -> 30.47%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.9929 -> 3.2453   acc: 33.00% -> 31.68%             
client [76] (test)  loss: 3.3298 -> 3.1539   acc: 27.24% -> 30.47%             
client [67] (test)  loss: 2.8279 -> 2.9377   acc: 33.22% -> 32.23%             
client [37] (test)  loss: 2.9984 -> 3.0496   acc: 31.46% -> 30.79%             
client [58] (test)  loss: 3.0434 -> 3.4034   acc: 29.69% -> 32.42%             
client [64] (test)  loss: 2.9532 -> 2.9798   acc: 28.71% -> 32.01%             
client [77] (test)  loss: 3.0259 -> 3.2038   acc: 29.28% -> 30.59%             
client [55] (test)  loss: 2.9086 -> 3.0408   acc: 36.07% -> 35.41%             
client [12] (test)  loss: 2.9394 -> 2.9503   acc: 31.68% -> 33.33%             
client [89] (test)  loss: 2.9520 -> 3.1055   acc: 33.55% -> 32.90%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.8520 -> 2.9246   acc: 32.03% -> 31.37%             
client [51] (test)  loss: 3.1160 -> 3.3109   acc: 26.82% -> 26.16%             
client [8] (test)  loss: 3.0769 -> 3.4655   acc: 28.38% -> 28.04%              
client [18] (test)  loss: 2.8467 -> 2.9072   acc: 36.27% -> 37.91%             
client [94] (test)  loss: 3.0867 -> 3.2464   acc: 30.27% -> 34.69%             
client [81] (test)  loss: 2.9287 -> 3.1843   acc: 31.56% -> 30.56%             
client [3] (test)  loss: 2.7771 -> 2.7424   acc: 33.66% -> 37.91%              
client [11] (test)  loss: 3.1221 -> 3.4169   acc: 32.89% -> 32.21%             
client [95] (test)  loss: 3.4683 -> 3.5742   acc: 27.70% -> 27.36%             
client [67] (test)  loss: 2.8787 -> 3.0631   acc: 33.55% -> 35.22%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.0765 -> 3.1431   acc: 31.89% -> 29.24%             
client [79] (test)  loss: 2.9477 -> 3.0614   acc: 34.10% -> 34.75%             
client [58] (test)  loss: 2.9442 -> 3.4456   acc: 32.42% -> 32.81%             
client [88] (test)  loss: 3.0349 -> 3.2918   acc: 31.23% -> 29.57%             
client [46] (test)  loss: 2.7958 -> 2.8584   acc: 35.06% -> 37.66%             
client [11] (test)  loss: 3.0203 -> 3.3957   acc: 35.91% -> 33.22%             
client [55] (test)  loss: 2.8924 -> 3.1984   acc: 35.08% -> 37.38%             
client [13] (test)  loss: 2.9486 -> 3.2804   acc: 37.66% -> 30.19%             
client [31] (test)  loss: 2.8052 -> 2.8457   acc: 33.45% -> 36.59%             
client [75] (test)  loss: 2.8687 -> 3.0177   acc: 29.61% -> 32.89%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.8422 -> 3.2148   acc: 31.67% -> 35.33%             
client [7] (test)  loss: 2.7292 -> 2.9359   acc: 40.85% -> 37.91%              
client [57] (test)  loss: 2.9812 -> 3.1754   acc: 26.47% -> 34.64%             
client [13] (test)  loss: 2.9279 -> 3.3260   acc: 35.71% -> 31.49%             
client [43] (test)  loss: 2.9251 -> 3.0159   acc: 34.32% -> 34.32%             
client [91] (test)  loss: 2.8858 -> 2.8280   acc: 32.57% -> 41.78%             
client [10] (test)  loss: 3.2078 -> 3.3006   acc: 26.73% -> 28.05%             
client [64] (test)  loss: 2.8340 -> 3.0434   acc: 31.35% -> 32.34%             
client [82] (test)  loss: 2.8265 -> 3.1716   acc: 34.11% -> 34.11%             
client [22] (test)  loss: 3.0277 -> 2.9540   acc: 31.27% -> 32.57%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.2262 -> 3.2294   acc: 33.33% -> 36.11%             
client [23] (test)  loss: 2.8601 -> 3.0258   acc: 30.33% -> 34.67%             
client [88] (test)  loss: 3.0734 -> 3.2788   acc: 30.23% -> 31.56%             
client [98] (test)  loss: 2.8350 -> 3.0725   acc: 32.69% -> 35.92%             
client [79] (test)  loss: 2.9189 -> 3.1842   acc: 35.41% -> 35.41%             
client [21] (test)  loss: 3.1437 -> 3.2090   acc: 30.90% -> 30.56%             
client [92] (test)  loss: 3.1112 -> 2.9065   acc: 33.75% -> 36.88%             
client [56] (test)  loss: 2.9421 -> 3.2366   acc: 36.43% -> 34.02%             
client [5] (test)  loss: 3.1234 -> 3.3665   acc: 31.25% -> 33.55%              
client [52] (test)  loss: 3.2863 -> 3.2828   acc: 31.82% -> 36.69%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.1250 -> 0.0000', 'accuracy': '26.82% -> 0.00%'},          
    200: {'loss': '3.0424 -> 0.0000', 'accuracy': '32.62% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(10.49%) at epoch: 12                                     
FedDyn achieved 20.0%(20.15%) at epoch: 45                                     
FedDyn achieved 30.0%(30.70%) at epoch: 124                                    
Convergence (test_after):                                                      
FedDyn achieved 10.0%(11.49%) at epoch: 6                                      
FedDyn achieved 20.0%(20.32%) at epoch: 29                                     
FedDyn achieved 30.0%(30.14%) at epoch: 89                                     
