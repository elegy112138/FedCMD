==================== ALGORITHM: Local-only ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3060 -> 2.2681   acc: 30.65% -> 28.23%             
client [81] (test)  loss: 2.2757 -> 2.1586   acc: 24.59% -> 24.59%             
client [21] (test)  loss: 2.3916 -> 2.3458   acc: 18.49% -> 18.49%             
client [68] (test)  loss: 2.3376 -> 2.2707   acc: 30.30% -> 30.30%             
client [93] (test)  loss: 2.1347 -> 1.2584   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.3656 -> 2.3288   acc: 10.26% -> 35.90%             
client [20] (test)  loss: 2.3136 -> 2.2458   acc: 33.09% -> 33.09%             
client [59] (test)  loss: 2.3769 -> 2.3147   acc: 36.22% -> 36.22%             
client [48] (test)  loss: 2.3629 -> 2.3515   acc: 16.36% -> 29.09%             
client [34] (test)  loss: 2.3147 -> 2.2115   acc: 33.10% -> 34.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.3418 -> 2.3106   acc: 23.21% -> 23.21%             
client [99] (test)  loss: 2.3747 -> 2.3585   acc: 15.91% -> 15.91%             
client [67] (test)  loss: 2.3596 -> 2.3245   acc: 19.05% -> 19.05%             
client [0] (test)  loss: 2.0854 -> 1.7137   acc: 36.42% -> 36.42%              
client [76] (test)  loss: 2.3115 -> 2.2769   acc: 53.16% -> 53.16%             
client [41] (test)  loss: 2.3368 -> 2.2845   acc: 27.05% -> 31.15%             
client [62] (test)  loss: 2.3884 -> 2.3484   acc: 5.63% -> 39.44%              
client [2] (test)  loss: 2.3535 -> 2.1586   acc: 63.45% -> 63.45%              
client [14] (test)  loss: 2.2445 -> 2.1302   acc: 23.62% -> 23.62%             
client [46] (test)  loss: 1.8517 -> 1.7171   acc: 52.99% -> 52.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.3491 -> 2.3336   acc: 37.50% -> 37.50%             
client [68] (test)  loss: 1.9271 -> 1.8584   acc: 30.30% -> 30.30%             
client [57] (test)  loss: 2.1085 -> 1.9241   acc: 39.18% -> 39.18%             
client [17] (test)  loss: 2.0113 -> 1.9105   acc: 33.65% -> 33.65%             
client [54] (test)  loss: 2.1014 -> 1.9906   acc: 35.14% -> 35.14%             
client [23] (test)  loss: 2.3909 -> 2.3737   acc: 22.97% -> 22.97%             
client [35] (test)  loss: 2.2373 -> 2.1493   acc: 40.48% -> 40.48%             
client [59] (test)  loss: 1.9936 -> 1.7973   acc: 36.22% -> 36.22%             
client [31] (test)  loss: 1.8922 -> 1.8855   acc: 34.62% -> 34.62%             
client [9] (test)  loss: 2.3394 -> 2.3142   acc: 12.37% -> 12.37%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.1477 -> 1.9611   acc: 24.80% -> 28.00%             
client [33] (test)  loss: 1.3495 -> 1.2818   acc: 59.81% -> 60.75%             
client [16] (test)  loss: 2.3187 -> 2.2881   acc: 55.56% -> 55.56%             
client [44] (test)  loss: 2.3619 -> 2.3148   acc: 24.44% -> 24.44%             
client [8] (test)  loss: 0.7813 -> 0.7057   acc: 74.31% -> 75.69%              
client [31] (test)  loss: 1.8816 -> 1.8693   acc: 34.62% -> 34.62%             
client [47] (test)  loss: 1.9747 -> 1.5175   acc: 42.02% -> 42.02%             
client [36] (test)  loss: 2.3571 -> 2.3186   acc: 5.98% -> 35.90%              
client [20] (test)  loss: 1.7921 -> 1.6504   acc: 33.09% -> 41.73%             
client [56] (test)  loss: 2.3182 -> 2.2825   acc: 23.93% -> 23.93%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.2711 -> 2.2168   acc: 25.86% -> 25.86%              
client [60] (test)  loss: 2.3672 -> 2.3529   acc: 22.37% -> 22.37%             
client [28] (test)  loss: 1.8186 -> 1.6729   acc: 45.16% -> 49.19%             
client [25] (test)  loss: 2.3161 -> 2.2815   acc: 31.40% -> 23.14%             
client [58] (test)  loss: 1.3220 -> 1.2484   acc: 53.12% -> 56.88%             
client [44] (test)  loss: 2.3148 -> 2.2501   acc: 24.44% -> 24.44%             
client [39] (test)  loss: 0.8888 -> 0.8414   acc: 76.43% -> 76.43%             
client [29] (test)  loss: 1.4885 -> 1.4058   acc: 45.38% -> 47.90%             
client [3] (test)  loss: 2.3394 -> 2.3152   acc: 16.10% -> 16.10%              
client [84] (test)  loss: 0.4905 -> 0.3818   acc: 83.44% -> 89.57%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.2303 -> 2.0890   acc: 43.70% -> 34.45%             
client [84] (test)  loss: 0.3515 -> 0.3472   acc: 90.18% -> 90.18%             
client [10] (test)  loss: 2.3636 -> 2.3548   acc: 20.51% -> 20.51%             
client [36] (test)  loss: 2.2135 -> 2.1147   acc: 35.90% -> 35.90%             
client [65] (test)  loss: 1.9030 -> 1.8316   acc: 30.51% -> 33.90%             
client [81] (test)  loss: 1.6709 -> 1.6173   acc: 36.89% -> 44.26%             
client [79] (test)  loss: 2.2180 -> 2.1167   acc: 27.35% -> 27.35%             
client [42] (test)  loss: 2.2541 -> 2.1992   acc: 21.09% -> 20.31%             
client [11] (test)  loss: 1.9472 -> 1.8760   acc: 31.82% -> 31.82%             
client [96] (test)  loss: 2.1464 -> 2.0401   acc: 31.93% -> 31.93%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6467 -> 0.6268   acc: 76.39% -> 78.47%              
client [53] (test)  loss: 1.8609 -> 1.7515   acc: 41.18% -> 41.18%             
client [52] (test)  loss: 1.2968 -> 1.2076   acc: 50.39% -> 65.12%             
client [42] (test)  loss: 2.1240 -> 2.0748   acc: 20.31% -> 32.81%             
client [69] (test)  loss: 1.4970 -> 1.4187   acc: 50.00% -> 50.00%             
client [59] (test)  loss: 1.5108 -> 1.4368   acc: 36.22% -> 40.16%             
client [7] (test)  loss: 1.8325 -> 1.7848   acc: 30.37% -> 30.37%              
client [26] (test)  loss: 2.2200 -> 2.1065   acc: 19.23% -> 17.69%             
client [49] (test)  loss: 2.1365 -> 2.0792   acc: 16.18% -> 16.18%             
client [98] (test)  loss: 1.7984 -> 1.7628   acc: 33.33% -> 38.60%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.7628 -> 1.7345   acc: 38.60% -> 38.60%             
client [47] (test)  loss: 1.3070 -> 1.1356   acc: 55.46% -> 70.59%             
client [21] (test)  loss: 1.7299 -> 1.5113   acc: 32.77% -> 47.90%             
client [77] (test)  loss: 1.6917 -> 1.5178   acc: 45.16% -> 55.65%             
client [95] (test)  loss: 1.1307 -> 1.0727   acc: 70.95% -> 68.72%             
client [91] (test)  loss: 2.2352 -> 2.1913   acc: 25.40% -> 25.40%             
client [14] (test)  loss: 1.3557 -> 1.2144   acc: 48.03% -> 57.48%             
client [99] (test)  loss: 2.2654 -> 2.2160   acc: 31.82% -> 28.41%             
client [20] (test)  loss: 1.3795 -> 1.3625   acc: 56.83% -> 58.99%             
client [39] (test)  loss: 0.7843 -> 0.7637   acc: 76.43% -> 76.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.2076 -> 1.1385   acc: 65.12% -> 65.89%             
client [62] (test)  loss: 1.5916 -> 1.4566   acc: 47.89% -> 47.89%             
client [71] (test)  loss: 1.8844 -> 1.8110   acc: 25.95% -> 29.77%             
client [97] (test)  loss: 0.9986 -> 0.9329   acc: 59.73% -> 66.44%             
client [30] (test)  loss: 1.8405 -> 1.7037   acc: 40.16% -> 46.46%             
client [88] (test)  loss: 1.8666 -> 1.7671   acc: 36.76% -> 43.38%             
client [60] (test)  loss: 2.1139 -> 2.0490   acc: 22.37% -> 22.37%             
client [82] (test)  loss: 1.5452 -> 1.4862   acc: 38.52% -> 38.52%             
client [91] (test)  loss: 2.1297 -> 2.0670   acc: 25.40% -> 25.40%             
client [57] (test)  loss: 1.7316 -> 1.6804   acc: 39.18% -> 42.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5606 -> 1.6571   acc: 53.85% -> 41.03%             
client [15] (test)  loss: 0.6764 -> 0.6148   acc: 77.10% -> 78.63%             
client [71] (test)  loss: 1.8110 -> 1.6114   acc: 29.77% -> 45.80%             
client [97] (test)  loss: 0.7769 -> 0.6753   acc: 70.47% -> 76.51%             
client [53] (test)  loss: 1.5426 -> 1.4903   acc: 41.18% -> 41.18%             
client [77] (test)  loss: 1.5178 -> 1.4570   acc: 55.65% -> 51.61%             
client [76] (test)  loss: 1.5797 -> 1.5074   acc: 51.90% -> 53.16%             
client [79] (test)  loss: 1.7440 -> 1.4944   acc: 41.03% -> 45.30%             
client [28] (test)  loss: 1.2001 -> 1.1723   acc: 62.10% -> 64.52%             
client [99] (test)  loss: 2.1481 -> 2.1170   acc: 18.18% -> 21.59%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.1533 -> 0.6436   acc: 65.77% -> 77.85%             
client [86] (test)  loss: 0.7431 -> 0.6806   acc: 81.30% -> 84.55%             
client [34] (test)  loss: 1.4920 -> 1.3984   acc: 42.96% -> 49.30%             
client [73] (test)  loss: 2.2587 -> 2.2255   acc: 24.00% -> 32.00%             
client [5] (test)  loss: 1.7651 -> 1.7275   acc: 37.14% -> 36.19%              
client [96] (test)  loss: 1.4266 -> 1.3567   acc: 52.94% -> 53.78%             
client [22] (test)  loss: 1.9471 -> 1.9061   acc: 33.64% -> 34.58%             
client [60] (test)  loss: 1.8876 -> 1.8475   acc: 26.32% -> 27.63%             
client [66] (test)  loss: 1.8490 -> 1.7581   acc: 21.77% -> 25.00%             
client [83] (test)  loss: 1.8188 -> 1.7526   acc: 45.13% -> 44.25%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.3434 -> 1.2858   acc: 58.23% -> 59.49%             
client [65] (test)  loss: 1.7274 -> 1.6874   acc: 38.14% -> 38.98%             
client [95] (test)  loss: 1.0196 -> 1.0358   acc: 77.09% -> 77.65%             
client [17] (test)  loss: 1.7966 -> 1.7489   acc: 33.65% -> 38.46%             
client [8] (test)  loss: 0.5303 -> 0.6048   acc: 82.64% -> 79.86%              
client [35] (test)  loss: 1.8170 -> 1.4826   acc: 38.10% -> 48.81%             
client [98] (test)  loss: 1.6237 -> 2.2311   acc: 42.98% -> 24.56%             
client [53] (test)  loss: 1.4490 -> 1.4377   acc: 41.18% -> 42.86%             
client [43] (test)  loss: 0.5094 -> 0.4890   acc: 84.21% -> 86.60%             
client [64] (test)  loss: 1.6359 -> 1.5145   acc: 38.40% -> 39.20%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.3399 -> 1.2467   acc: 49.58% -> 50.42%             
client [88] (test)  loss: 1.5485 -> 1.3889   acc: 52.21% -> 62.50%             
client [38] (test)  loss: 2.0826 -> 2.0325   acc: 25.00% -> 32.14%             
client [3] (test)  loss: 1.6692 -> 1.6148   acc: 44.07% -> 47.46%              
client [5] (test)  loss: 1.6917 -> 1.6554   acc: 40.95% -> 40.00%              
client [41] (test)  loss: 1.5245 -> 1.4563   acc: 44.26% -> 50.82%             
client [7] (test)  loss: 1.6772 -> 1.6064   acc: 32.59% -> 41.48%              
client [37] (test)  loss: 1.0780 -> 1.0182   acc: 67.92% -> 70.75%             
client [45] (test)  loss: 2.1357 -> 2.0950   acc: 28.28% -> 28.28%             
client [47] (test)  loss: 0.9777 -> 0.9635   acc: 73.11% -> 70.59%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.5992 -> 1.5470   acc: 55.56% -> 55.56%             
client [11] (test)  loss: 1.6377 -> 1.5344   acc: 53.79% -> 58.33%             
client [37] (test)  loss: 0.9060 -> 0.8265   acc: 75.94% -> 76.42%             
client [41] (test)  loss: 1.4563 -> 1.3877   acc: 50.82% -> 54.10%             
client [95] (test)  loss: 1.1475 -> 1.2687   acc: 78.77% -> 70.95%             
client [53] (test)  loss: 1.4377 -> 1.1959   acc: 42.86% -> 49.58%             
client [22] (test)  loss: 1.8800 -> 1.8790   acc: 37.38% -> 36.45%             
client [25] (test)  loss: 1.8791 -> 1.7659   acc: 38.02% -> 41.32%             
client [69] (test)  loss: 1.0926 -> 1.0605   acc: 65.18% -> 66.96%             
client [46] (test)  loss: 1.6096 -> 1.6046   acc: 52.99% -> 52.99%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9980 -> 0.8831   acc: 68.91% -> 73.95%             
client [69] (test)  loss: 1.0296 -> 1.0282   acc: 68.75% -> 67.86%             
client [82] (test)  loss: 1.0430 -> 0.9424   acc: 63.93% -> 70.49%             
client [45] (test)  loss: 1.9238 -> 1.7925   acc: 37.37% -> 37.37%             
client [7] (test)  loss: 1.6064 -> 1.5150   acc: 41.48% -> 45.19%              
client [50] (test)  loss: 0.6736 -> 0.6501   acc: 77.78% -> 79.26%             
client [35] (test)  loss: 1.5408 -> 1.6557   acc: 48.81% -> 48.81%             
client [24] (test)  loss: 1.5864 -> 1.5449   acc: 60.71% -> 60.71%             
client [15] (test)  loss: 0.5963 -> 0.6263   acc: 80.92% -> 79.39%             
client [58] (test)  loss: 0.8632 -> 0.9122   acc: 84.38% -> 84.38%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.6997 -> 1.6692   acc: 43.64% -> 41.82%             
client [76] (test)  loss: 1.2199 -> 1.1944   acc: 63.29% -> 63.29%             
client [67] (test)  loss: 1.7905 -> 1.7554   acc: 33.33% -> 36.51%             
client [37] (test)  loss: 0.7903 -> 0.7572   acc: 80.19% -> 80.66%             
client [58] (test)  loss: 0.9582 -> 1.0083   acc: 84.38% -> 85.00%             
client [64] (test)  loss: 1.3639 -> 1.8812   acc: 53.60% -> 23.20%             
client [77] (test)  loss: 1.2678 -> 1.1910   acc: 50.81% -> 64.52%             
client [55] (test)  loss: 1.2744 -> 1.2293   acc: 61.11% -> 62.70%             
client [12] (test)  loss: 2.8070 -> 1.9704   acc: 35.00% -> 60.71%             
client [89] (test)  loss: 1.1199 -> 1.1374   acc: 70.29% -> 73.19%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3692 -> 0.3830   acc: 92.02% -> 92.02%             
client [51] (test)  loss: 0.6810 -> 0.7516   acc: 76.77% -> 74.19%             
client [8] (test)  loss: 0.6620 -> 0.6950   acc: 83.33% -> 83.33%              
client [18] (test)  loss: 2.1516 -> 2.0932   acc: 24.74% -> 24.74%             
client [94] (test)  loss: 0.8334 -> 0.6860   acc: 67.50% -> 80.83%             
client [81] (test)  loss: 1.2851 -> 1.3251   acc: 64.75% -> 66.39%             
client [3] (test)  loss: 1.5279 -> 1.3756   acc: 54.24% -> 55.93%              
client [11] (test)  loss: 1.3827 -> 1.2980   acc: 64.39% -> 67.42%             
client [95] (test)  loss: 1.7373 -> 1.8032   acc: 77.65% -> 77.65%             
client [67] (test)  loss: 1.7554 -> 1.7149   acc: 36.51% -> 34.13%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1334 -> 1.0872   acc: 53.78% -> 54.62%             
client [79] (test)  loss: 1.1232 -> 1.1180   acc: 64.10% -> 66.67%             
client [58] (test)  loss: 1.1223 -> 1.1557   acc: 83.12% -> 83.12%             
client [88] (test)  loss: 1.1813 -> 1.4671   acc: 70.59% -> 55.15%             
client [46] (test)  loss: 1.5879 -> 1.5688   acc: 62.39% -> 62.39%             
client [11] (test)  loss: 1.2980 -> 1.1862   acc: 67.42% -> 70.45%             
client [55] (test)  loss: 1.1168 -> 1.2222   acc: 68.25% -> 69.05%             
client [13] (test)  loss: 2.2302 -> 1.6349   acc: 42.68% -> 52.44%             
client [31] (test)  loss: 1.5084 -> 1.5568   acc: 52.56% -> 61.54%             
client [75] (test)  loss: 1.5754 -> 2.3225   acc: 63.03% -> 52.94%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.2111 -> 0.9981   acc: 65.55% -> 68.07%             
client [7] (test)  loss: 1.1821 -> 1.9158   acc: 54.07% -> 28.89%              
client [57] (test)  loss: 1.7397 -> 2.1758   acc: 54.39% -> 43.86%             
client [13] (test)  loss: 1.8688 -> 1.5384   acc: 35.37% -> 51.22%             
client [43] (test)  loss: 0.5306 -> 0.5537   acc: 87.08% -> 87.08%             
client [91] (test)  loss: 1.9293 -> 1.9035   acc: 25.40% -> 25.40%             
client [10] (test)  loss: 2.2403 -> 2.4182   acc: 28.21% -> 15.38%             
client [64] (test)  loss: 0.9562 -> 0.9226   acc: 72.00% -> 72.80%             
client [82] (test)  loss: 2.2256 -> 1.2031   acc: 37.70% -> 48.36%             
client [22] (test)  loss: 1.9199 -> 1.5614   acc: 32.71% -> 51.40%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.2456 -> 1.4526   acc: 67.63% -> 59.71%             
client [23] (test)  loss: 1.9789 -> 1.9314   acc: 22.97% -> 22.97%             
client [88] (test)  loss: 1.4671 -> 1.0898   acc: 55.15% -> 71.32%             
client [98] (test)  loss: 1.2535 -> 1.2841   acc: 64.91% -> 63.16%             
client [79] (test)  loss: 1.0873 -> 1.0816   acc: 65.81% -> 69.23%             
client [21] (test)  loss: 1.0440 -> 1.0001   acc: 58.82% -> 63.03%             
client [92] (test)  loss: 1.6463 -> 1.3175   acc: 40.00% -> 53.85%             
client [56] (test)  loss: 0.8646 -> 0.8991   acc: 66.67% -> 67.52%             
client [5] (test)  loss: 3.2843 -> 1.5621   acc: 43.81% -> 55.24%              
client [52] (test)  loss: 2.0445 -> 0.8488   acc: 57.36% -> 75.19%             
==================== Local-only TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '1.4516 -> 0.0000', 'accuracy': '50.98% -> 0.00%'},          
    200: {'loss': '1.3168 -> 0.0000', 'accuracy': '63.62% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only achieved 20.0%(21.90%) at epoch: 0                                  
Local-only achieved 30.0%(36.75%) at epoch: 7                                  
Local-only achieved 40.0%(46.67%) at epoch: 20                                 
Local-only achieved 50.0%(50.89%) at epoch: 54                                 
Local-only achieved 60.0%(63.96%) at epoch: 90                                 
Local-only achieved 70.0%(73.95%) at epoch: 142                                
Convergence (test_after):                                                      
Local-only achieved 20.0%(26.89%) at epoch: 0                                  
Local-only achieved 30.0%(39.27%) at epoch: 3                                  
Local-only achieved 40.0%(40.02%) at epoch: 5                                  
Local-only achieved 50.0%(50.13%) at epoch: 35                                 
Local-only achieved 60.0%(60.60%) at epoch: 82                                 
Local-only achieved 70.0%(74.76%) at epoch: 142                                
