==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7600 -> 0.9744   acc: 36.55% -> 65.54%             
client [81] (test)  loss: 1.9039 -> 1.1685   acc: 28.32% -> 60.18%             
client [21] (test)  loss: 1.1977 -> 0.7885   acc: 55.76% -> 72.27%             
client [68] (test)  loss: 1.0736 -> 0.8094   acc: 59.71% -> 72.66%             
client [93] (test)  loss: 0.5329 -> 0.4351   acc: 84.59% -> 82.85%             
client [31] (test)  loss: 1.7549 -> 1.2016   acc: 29.07% -> 55.51%             
client [20] (test)  loss: 0.6219 -> 0.4765   acc: 78.76% -> 85.29%             
client [59] (test)  loss: 1.4867 -> 0.8544   acc: 34.44% -> 69.21%             
client [48] (test)  loss: 1.1735 -> 1.5743   acc: 51.69% -> 43.92%             
client [34] (test)  loss: 0.8959 -> 0.6871   acc: 72.31% -> 76.88%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5579 -> 0.3897   acc: 79.26% -> 84.62%             
client [99] (test)  loss: 0.8103 -> 0.6229   acc: 72.07% -> 82.07%             
client [67] (test)  loss: 0.7862 -> 0.4718   acc: 67.95% -> 84.56%             
client [0] (test)  loss: 0.4263 -> 0.4108   acc: 84.59% -> 86.56%              
client [76] (test)  loss: 0.8307 -> 0.5516   acc: 67.03% -> 80.11%             
client [41] (test)  loss: 0.7515 -> 0.7169   acc: 74.80% -> 75.60%             
client [62] (test)  loss: 0.4986 -> 0.3374   acc: 81.14% -> 88.00%             
client [2] (test)  loss: 0.6070 -> 0.5931   acc: 77.84% -> 74.85%              
client [14] (test)  loss: 0.4421 -> 0.2541   acc: 82.73% -> 90.91%             
client [46] (test)  loss: 0.3733 -> 0.4161   acc: 85.04% -> 84.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5598 -> 0.4929   acc: 79.70% -> 83.25%             
client [68] (test)  loss: 0.3957 -> 0.4113   acc: 85.97% -> 85.61%             
client [57] (test)  loss: 0.4619 -> 0.4754   acc: 82.14% -> 80.61%             
client [17] (test)  loss: 0.5727 -> 0.5072   acc: 78.08% -> 85.62%             
client [54] (test)  loss: 0.2918 -> 0.2696   acc: 92.78% -> 91.25%             
client [23] (test)  loss: 0.3568 -> 0.2565   acc: 87.78% -> 90.28%             
client [35] (test)  loss: 0.5062 -> 0.5926   acc: 80.79% -> 77.08%             
client [59] (test)  loss: 0.3541 -> 0.2660   acc: 88.08% -> 92.05%             
client [31] (test)  loss: 0.5225 -> 0.5614   acc: 82.82% -> 81.06%             
client [9] (test)  loss: 0.4202 -> 0.3717   acc: 83.78% -> 87.91%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3333 -> 0.3110   acc: 88.61% -> 89.87%             
client [33] (test)  loss: 0.3315 -> 0.1865   acc: 88.31% -> 93.51%             
client [16] (test)  loss: 0.2727 -> 0.1750   acc: 91.08% -> 94.05%             
client [44] (test)  loss: 0.2827 -> 0.2778   acc: 90.93% -> 90.93%             
client [8] (test)  loss: 0.2392 -> 0.1832   acc: 92.13% -> 94.75%              
client [31] (test)  loss: 0.3891 -> 0.4490   acc: 90.31% -> 85.90%             
client [47] (test)  loss: 0.3641 -> 0.1836   acc: 87.05% -> 92.77%             
client [36] (test)  loss: 0.4589 -> 0.5651   acc: 82.57% -> 83.88%             
client [20] (test)  loss: 0.1493 -> 0.1018   acc: 94.12% -> 96.73%             
client [56] (test)  loss: 0.2193 -> 0.1453   acc: 92.64% -> 95.71%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2225 -> 0.1196   acc: 93.16% -> 96.42%              
client [60] (test)  loss: 0.0968 -> 0.0845   acc: 97.53% -> 97.84%             
client [28] (test)  loss: 0.4824 -> 0.3292   acc: 82.54% -> 90.08%             
client [25] (test)  loss: 0.5895 -> 0.2599   acc: 79.55% -> 91.69%             
client [58] (test)  loss: 0.2469 -> 0.1545   acc: 92.19% -> 93.95%             
client [44] (test)  loss: 0.4903 -> 0.2537   acc: 83.29% -> 90.93%             
client [39] (test)  loss: 0.3580 -> 0.1515   acc: 89.24% -> 95.06%             
client [29] (test)  loss: 0.4601 -> 0.2668   acc: 83.69% -> 91.42%             
client [3] (test)  loss: 0.2696 -> 0.1472   acc: 89.54% -> 95.75%              
client [84] (test)  loss: 0.8093 -> 0.3009   acc: 69.40% -> 90.39%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2288 -> 0.1950   acc: 93.77% -> 94.08%             
client [84] (test)  loss: 0.3556 -> 0.2496   acc: 88.26% -> 91.81%             
client [10] (test)  loss: 0.1755 -> 0.1987   acc: 94.14% -> 93.75%             
client [36] (test)  loss: 0.3395 -> 0.2385   acc: 85.53% -> 91.78%             
client [65] (test)  loss: 0.1765 -> 0.1876   acc: 94.23% -> 94.23%             
client [81] (test)  loss: 0.2327 -> 0.2286   acc: 92.48% -> 92.04%             
client [79] (test)  loss: 0.2685 -> 0.2496   acc: 91.36% -> 91.36%             
client [42] (test)  loss: 0.2986 -> 0.2702   acc: 89.49% -> 90.39%             
client [11] (test)  loss: 0.4037 -> 0.3213   acc: 85.29% -> 89.08%             
client [96] (test)  loss: 0.3593 -> 0.2612   acc: 89.01% -> 92.55%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1383 -> 0.1182   acc: 96.07% -> 96.07%              
client [53] (test)  loss: 0.3621 -> 0.3503   acc: 85.10% -> 84.31%             
client [52] (test)  loss: 0.1959 -> 0.1585   acc: 93.93% -> 96.81%             
client [42] (test)  loss: 0.2723 -> 0.2496   acc: 90.09% -> 91.29%             
client [69] (test)  loss: 0.1837 -> 0.1190   acc: 94.65% -> 96.66%             
client [59] (test)  loss: 0.1162 -> 0.1056   acc: 95.70% -> 96.03%             
client [7] (test)  loss: 0.0765 -> 0.0783   acc: 96.54% -> 97.41%              
client [26] (test)  loss: 0.1155 -> 0.0858   acc: 97.19% -> 97.45%             
client [49] (test)  loss: 0.1172 -> 0.0773   acc: 96.75% -> 98.05%             
client [98] (test)  loss: 0.3644 -> 0.2798   acc: 86.91% -> 93.19%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3199 -> 0.2553   acc: 91.10% -> 93.72%             
client [47] (test)  loss: 0.2246 -> 0.1034   acc: 93.07% -> 96.99%             
client [21] (test)  loss: 0.2149 -> 0.1584   acc: 94.39% -> 95.64%             
client [77] (test)  loss: 0.3016 -> 0.2881   acc: 90.34% -> 91.12%             
client [95] (test)  loss: 0.2054 -> 0.2416   acc: 93.98% -> 91.16%             
client [91] (test)  loss: 0.2044 -> 0.1543   acc: 93.58% -> 96.26%             
client [14] (test)  loss: 0.1404 -> 0.0675   acc: 94.24% -> 98.79%             
client [99] (test)  loss: 0.2412 -> 0.2440   acc: 92.76% -> 92.41%             
client [20] (test)  loss: 0.0474 -> 0.0443   acc: 98.69% -> 98.69%             
client [39] (test)  loss: 0.2353 -> 0.0982   acc: 92.15% -> 97.09%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1946 -> 0.1529   acc: 92.65% -> 97.12%             
client [62] (test)  loss: 0.1043 -> 0.0756   acc: 96.00% -> 96.86%             
client [71] (test)  loss: 0.2698 -> 0.0965   acc: 91.20% -> 96.80%             
client [97] (test)  loss: 0.1866 -> 0.0770   acc: 93.26% -> 97.04%             
client [30] (test)  loss: 0.0379 -> 0.0434   acc: 99.37% -> 98.42%             
client [88] (test)  loss: 0.1789 -> 0.0539   acc: 93.59% -> 98.40%             
client [60] (test)  loss: 0.1113 -> 0.0956   acc: 97.22% -> 98.15%             
client [82] (test)  loss: 0.1917 -> 0.1779   acc: 93.53% -> 94.17%             
client [91] (test)  loss: 0.1410 -> 0.1326   acc: 96.79% -> 96.79%             
client [57] (test)  loss: 0.0833 -> 0.1248   acc: 97.96% -> 95.92%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1484 -> 0.1296   acc: 93.83% -> 96.48%             
client [15] (test)  loss: 0.0334 -> 0.0274   acc: 98.75% -> 99.06%             
client [71] (test)  loss: 0.2047 -> 0.0730   acc: 92.80% -> 96.00%             
client [97] (test)  loss: 0.1086 -> 0.0642   acc: 96.77% -> 97.84%             
client [53] (test)  loss: 0.2698 -> 0.2676   acc: 87.06% -> 89.80%             
client [77] (test)  loss: 0.3594 -> 0.2473   acc: 88.51% -> 92.95%             
client [76] (test)  loss: 0.1913 -> 0.0970   acc: 92.92% -> 96.19%             
client [79] (test)  loss: 0.2140 -> 0.1864   acc: 95.00% -> 93.64%             
client [28] (test)  loss: 0.1771 -> 0.1998   acc: 94.05% -> 94.05%             
client [99] (test)  loss: 0.2182 -> 0.2026   acc: 93.79% -> 93.45%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1104 -> 0.0619   acc: 96.50% -> 98.11%             
client [86] (test)  loss: 0.0837 -> 0.0448   acc: 95.90% -> 96.92%             
client [34] (test)  loss: 0.1035 -> 0.0617   acc: 97.31% -> 98.39%             
client [73] (test)  loss: 0.0805 -> 0.0477   acc: 96.76% -> 98.38%             
client [5] (test)  loss: 0.1805 -> 0.1139   acc: 95.05% -> 96.98%              
client [96] (test)  loss: 0.2781 -> 0.1685   acc: 91.84% -> 95.04%             
client [22] (test)  loss: 0.1282 -> 0.1315   acc: 96.67% -> 96.67%             
client [60] (test)  loss: 0.0922 -> 0.0837   acc: 98.15% -> 98.77%             
client [66] (test)  loss: 0.1319 -> 0.1209   acc: 94.93% -> 96.38%             
client [83] (test)  loss: 0.2045 -> 0.1682   acc: 92.12% -> 93.84%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0912 -> 0.0809   acc: 96.19% -> 97.00%             
client [65] (test)  loss: 0.0949 -> 0.1006   acc: 96.47% -> 96.47%             
client [95] (test)  loss: 0.1556 -> 0.1477   acc: 93.98% -> 93.98%             
client [17] (test)  loss: 0.1697 -> 0.1825   acc: 94.52% -> 95.89%             
client [8] (test)  loss: 0.1055 -> 0.0929   acc: 96.72% -> 97.05%              
client [35] (test)  loss: 0.0962 -> 0.0488   acc: 96.30% -> 98.38%             
client [98] (test)  loss: 0.2566 -> 0.2231   acc: 92.15% -> 94.24%             
client [53] (test)  loss: 0.1827 -> 0.2352   acc: 92.55% -> 91.76%             
client [43] (test)  loss: 0.1511 -> 0.0965   acc: 95.58% -> 96.31%             
client [64] (test)  loss: 0.1922 -> 0.1988   acc: 94.30% -> 94.30%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1981 -> 0.1403   acc: 94.70% -> 95.95%             
client [88] (test)  loss: 0.0739 -> 0.0332   acc: 96.47% -> 98.40%             
client [38] (test)  loss: 0.1153 -> 0.0975   acc: 96.74% -> 97.03%             
client [3] (test)  loss: 0.1292 -> 0.0618   acc: 95.10% -> 98.37%              
client [5] (test)  loss: 0.2066 -> 0.1273   acc: 94.23% -> 96.43%              
client [41] (test)  loss: 0.1855 -> 0.1769   acc: 92.80% -> 94.40%             
client [7] (test)  loss: 0.0397 -> 0.0295   acc: 98.56% -> 99.42%              
client [37] (test)  loss: 0.1588 -> 0.1003   acc: 96.00% -> 96.67%             
client [45] (test)  loss: 0.2155 -> 0.2471   acc: 92.43% -> 91.80%             
client [47] (test)  loss: 0.2005 -> 0.0791   acc: 93.07% -> 97.29%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0874 -> 0.0634   acc: 96.28% -> 98.14%             
client [11] (test)  loss: 0.1876 -> 0.1810   acc: 95.38% -> 94.96%             
client [37] (test)  loss: 0.1120 -> 0.0892   acc: 96.67% -> 96.67%             
client [41] (test)  loss: 0.1567 -> 0.1583   acc: 94.00% -> 93.20%             
client [95] (test)  loss: 0.1549 -> 0.1422   acc: 94.38% -> 95.18%             
client [53] (test)  loss: 0.1710 -> 0.2092   acc: 92.55% -> 93.33%             
client [22] (test)  loss: 0.1338 -> 0.1413   acc: 95.56% -> 96.11%             
client [25] (test)  loss: 0.1629 -> 0.1229   acc: 94.89% -> 98.08%             
client [69] (test)  loss: 0.0938 -> 0.0552   acc: 95.99% -> 97.32%             
client [46] (test)  loss: 0.0421 -> 0.0561   acc: 98.29% -> 97.86%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1051 -> 0.0774   acc: 96.39% -> 97.29%             
client [69] (test)  loss: 0.1215 -> 0.0648   acc: 95.32% -> 97.32%             
client [82] (test)  loss: 0.1662 -> 0.1170   acc: 94.17% -> 95.79%             
client [45] (test)  loss: 0.1250 -> 0.1955   acc: 96.21% -> 93.69%             
client [7] (test)  loss: 0.0412 -> 0.0261   acc: 98.56% -> 98.85%              
client [50] (test)  loss: 0.1123 -> 0.0730   acc: 97.08% -> 97.81%             
client [35] (test)  loss: 0.0711 -> 0.0382   acc: 96.76% -> 98.61%             
client [24] (test)  loss: 0.2261 -> 0.1732   acc: 91.88% -> 93.15%             
client [15] (test)  loss: 0.0440 -> 0.0151   acc: 98.12% -> 99.38%             
client [58] (test)  loss: 0.1207 -> 0.0446   acc: 96.22% -> 98.49%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0681 -> 0.0888   acc: 97.64% -> 96.96%             
client [76] (test)  loss: 0.0515 -> 0.0488   acc: 98.09% -> 98.09%             
client [67] (test)  loss: 0.0947 -> 0.0727   acc: 98.07% -> 96.91%             
client [37] (test)  loss: 0.0800 -> 0.0791   acc: 97.33% -> 97.00%             
client [58] (test)  loss: 0.1445 -> 0.0445   acc: 94.46% -> 97.98%             
client [64] (test)  loss: 0.1850 -> 0.1672   acc: 94.30% -> 94.94%             
client [77] (test)  loss: 0.1776 -> 0.2015   acc: 95.30% -> 94.26%             
client [55] (test)  loss: 0.0355 -> 0.0644   acc: 98.80% -> 97.59%             
client [12] (test)  loss: 0.0359 -> 0.0462   acc: 98.43% -> 98.82%             
client [89] (test)  loss: 0.1170 -> 0.0595   acc: 96.25% -> 97.98%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1651 -> 0.1451   acc: 95.37% -> 96.80%             
client [51] (test)  loss: 0.1597 -> 0.1476   acc: 94.87% -> 95.30%             
client [8] (test)  loss: 0.0788 -> 0.0779   acc: 98.03% -> 97.70%              
client [18] (test)  loss: 0.0372 -> 0.0404   acc: 99.34% -> 99.01%             
client [94] (test)  loss: 0.0211 -> 0.0315   acc: 98.83% -> 98.44%             
client [81] (test)  loss: 0.0665 -> 0.0578   acc: 97.79% -> 98.67%             
client [3] (test)  loss: 0.0704 -> 0.0512   acc: 97.06% -> 98.37%              
client [11] (test)  loss: 0.1865 -> 0.1601   acc: 94.12% -> 95.80%             
client [95] (test)  loss: 0.1486 -> 0.1332   acc: 95.18% -> 96.39%             
client [67] (test)  loss: 0.1337 -> 0.0737   acc: 97.68% -> 97.68%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1378 -> 0.0842   acc: 95.33% -> 96.88%             
client [79] (test)  loss: 0.1677 -> 0.1379   acc: 95.45% -> 95.45%             
client [58] (test)  loss: 0.0816 -> 0.0441   acc: 97.48% -> 97.98%             
client [88] (test)  loss: 0.1113 -> 0.0319   acc: 96.79% -> 98.40%             
client [46] (test)  loss: 0.0307 -> 0.0507   acc: 99.15% -> 98.29%             
client [11] (test)  loss: 0.1967 -> 0.1558   acc: 95.38% -> 95.80%             
client [55] (test)  loss: 0.0626 -> 0.0624   acc: 96.99% -> 97.59%             
client [13] (test)  loss: 0.0714 -> 0.0710   acc: 98.60% -> 98.31%             
client [31] (test)  loss: 0.0439 -> 0.0431   acc: 98.68% -> 98.68%             
client [75] (test)  loss: 0.0690 -> 0.0984   acc: 97.88% -> 97.35%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0683 -> 0.0415   acc: 98.47% -> 99.08%             
client [7] (test)  loss: 0.0258 -> 0.0192   acc: 99.42% -> 99.14%              
client [57] (test)  loss: 0.0255 -> 0.0418   acc: 98.98% -> 98.98%             
client [13] (test)  loss: 0.0840 -> 0.0675   acc: 97.47% -> 98.31%             
client [43] (test)  loss: 0.1163 -> 0.0761   acc: 96.31% -> 97.79%             
client [91] (test)  loss: 0.0682 -> 0.0560   acc: 97.86% -> 98.93%             
client [10] (test)  loss: 0.0753 -> 0.0723   acc: 97.66% -> 98.05%             
client [64] (test)  loss: 0.1323 -> 0.1545   acc: 94.94% -> 94.94%             
client [82] (test)  loss: 0.1261 -> 0.1022   acc: 95.47% -> 97.09%             
client [22] (test)  loss: 0.1181 -> 0.1083   acc: 97.22% -> 96.67%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0211 -> 0.0193   acc: 99.35% -> 99.02%             
client [23] (test)  loss: 0.1518 -> 0.1287   acc: 96.67% -> 96.67%             
client [88] (test)  loss: 0.0761 -> 0.0266   acc: 97.76% -> 99.04%             
client [98] (test)  loss: 0.2440 -> 0.2044   acc: 93.19% -> 94.24%             
client [79] (test)  loss: 0.1383 -> 0.1433   acc: 95.45% -> 95.45%             
client [21] (test)  loss: 0.1379 -> 0.0802   acc: 95.02% -> 97.20%             
client [92] (test)  loss: 0.1768 -> 0.1872   acc: 93.94% -> 93.94%             
client [56] (test)  loss: 0.0449 -> 0.0499   acc: 98.47% -> 98.47%             
client [5] (test)  loss: 0.1833 -> 0.1212   acc: 95.33% -> 96.98%              
client [52] (test)  loss: 0.0955 -> 0.0981   acc: 97.12% -> 97.44%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1640 -> 0.0000', 'accuracy': '94.51% -> 0.00%'},          
    200: {'loss': '0.0970 -> 0.0000', 'accuracy': '96.98% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(10.49%) at epoch: 0                                     
FedProx achieved 30.0%(33.40%) at epoch: 4                                     
FedProx achieved 40.0%(43.58%) at epoch: 5                                     
FedProx achieved 50.0%(54.13%) at epoch: 7                                     
FedProx achieved 60.0%(67.01%) at epoch: 12                                    
FedProx achieved 70.0%(72.84%) at epoch: 13                                    
FedProx achieved 80.0%(80.11%) at epoch: 17                                    
FedProx achieved 90.0%(90.29%) at epoch: 42                                    
Convergence (test_after):                                                      
FedProx achieved 30.0%(30.45%) at epoch: 0                                     
FedProx achieved 40.0%(47.99%) at epoch: 3                                     
FedProx achieved 60.0%(61.69%) at epoch: 5                                     
FedProx achieved 70.0%(73.77%) at epoch: 11                                    
FedProx achieved 80.0%(80.51%) at epoch: 15                                    
FedProx achieved 90.0%(90.13%) at epoch: 31                                    
