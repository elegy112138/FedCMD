==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3097 -> 5.0994   acc: 15.46% -> 17.76%             
client [81] (test)  loss: 4.0001 -> 4.3610   acc: 14.62% -> 19.60%             
client [21] (test)  loss: 4.1184 -> 4.6788   acc: 14.62% -> 18.27%             
client [68] (test)  loss: 3.8601 -> 4.9496   acc: 16.23% -> 15.56%             
client [93] (test)  loss: 4.5427 -> 4.6288   acc: 15.26% -> 19.48%             
client [31] (test)  loss: 4.1764 -> 4.1383   acc: 16.38% -> 18.47%             
client [20] (test)  loss: 4.3944 -> 4.6322   acc: 14.58% -> 19.10%             
client [59] (test)  loss: 4.4491 -> 3.9269   acc: 13.98% -> 22.49%             
client [48] (test)  loss: 3.9806 -> 4.7607   acc: 14.85% -> 19.47%             
client [34] (test)  loss: 4.2361 -> 4.8794   acc: 12.91% -> 18.62%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.0228 -> 4.0258   acc: 22.44% -> 25.41%             
client [99] (test)  loss: 3.8147 -> 4.3127   acc: 23.34% -> 25.87%             
client [67] (test)  loss: 3.9672 -> 4.4585   acc: 22.26% -> 22.92%             
client [0] (test)  loss: 4.4120 -> 4.8328   acc: 16.94% -> 22.26%              
client [76] (test)  loss: 4.2787 -> 4.4700   acc: 16.85% -> 22.58%             
client [41] (test)  loss: 4.5464 -> 4.6011   acc: 16.29% -> 23.78%             
client [62] (test)  loss: 3.7934 -> 4.6712   acc: 28.62% -> 23.19%             
client [2] (test)  loss: 3.8609 -> 4.1226   acc: 26.21% -> 25.24%              
client [14] (test)  loss: 3.9180 -> 4.3546   acc: 22.97% -> 24.03%             
client [46] (test)  loss: 3.6245 -> 3.7370   acc: 25.65% -> 34.09%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4440 -> 3.6585   acc: 30.74% -> 31.42%             
client [68] (test)  loss: 3.7243 -> 3.6013   acc: 22.85% -> 31.79%             
client [57] (test)  loss: 3.8467 -> 3.9078   acc: 22.22% -> 26.14%             
client [17] (test)  loss: 3.3880 -> 3.8777   acc: 26.45% -> 26.45%             
client [54] (test)  loss: 4.0751 -> 4.0417   acc: 22.86% -> 30.36%             
client [23] (test)  loss: 3.9599 -> 3.7339   acc: 23.00% -> 28.33%             
client [35] (test)  loss: 3.7198 -> 4.1523   acc: 24.92% -> 22.62%             
client [59] (test)  loss: 3.6368 -> 3.6637   acc: 29.79% -> 29.79%             
client [31] (test)  loss: 3.1886 -> 3.5343   acc: 32.06% -> 32.06%             
client [9] (test)  loss: 3.8468 -> 4.0380   acc: 22.52% -> 28.15%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5645 -> 3.7088   acc: 27.06% -> 31.02%             
client [33] (test)  loss: 3.5383 -> 3.9045   acc: 25.73% -> 28.01%             
client [16] (test)  loss: 3.5067 -> 3.8168   acc: 27.53% -> 29.97%             
client [44] (test)  loss: 3.5350 -> 3.5147   acc: 27.21% -> 33.44%             
client [8] (test)  loss: 3.9133 -> 4.3123   acc: 25.34% -> 24.32%              
client [31] (test)  loss: 3.2340 -> 3.5354   acc: 31.36% -> 32.75%             
client [47] (test)  loss: 3.2498 -> 3.4714   acc: 32.79% -> 32.79%             
client [36] (test)  loss: 3.2990 -> 3.4014   acc: 32.56% -> 32.56%             
client [20] (test)  loss: 3.7088 -> 3.6973   acc: 28.47% -> 35.07%             
client [56] (test)  loss: 3.3155 -> 3.8637   acc: 35.05% -> 27.49%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.0715 -> 3.0845   acc: 37.83% -> 42.11%              
client [60] (test)  loss: 3.5313 -> 3.8069   acc: 28.57% -> 29.87%             
client [28] (test)  loss: 3.6621 -> 3.7628   acc: 26.16% -> 30.13%             
client [25] (test)  loss: 3.6085 -> 3.7007   acc: 26.55% -> 30.00%             
client [58] (test)  loss: 3.4195 -> 3.6322   acc: 31.64% -> 32.81%             
client [44] (test)  loss: 3.3892 -> 3.5985   acc: 29.84% -> 34.43%             
client [39] (test)  loss: 3.0673 -> 3.5412   acc: 36.00% -> 38.00%             
client [29] (test)  loss: 3.3317 -> 3.5705   acc: 33.44% -> 32.78%             
client [3] (test)  loss: 2.9917 -> 2.9590   acc: 33.66% -> 38.56%              
client [84] (test)  loss: 3.2392 -> 3.4654   acc: 32.35% -> 30.07%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.2477 -> 3.4836   acc: 32.56% -> 31.89%             
client [84] (test)  loss: 3.1296 -> 3.5534   acc: 31.70% -> 30.72%             
client [10] (test)  loss: 3.5993 -> 3.8325   acc: 28.05% -> 27.39%             
client [36] (test)  loss: 3.2342 -> 3.2321   acc: 33.55% -> 36.54%             
client [65] (test)  loss: 3.5565 -> 4.0183   acc: 29.04% -> 29.04%             
client [81] (test)  loss: 3.4737 -> 3.4542   acc: 31.23% -> 32.56%             
client [79] (test)  loss: 3.2122 -> 3.3469   acc: 30.49% -> 36.39%             
client [42] (test)  loss: 3.7318 -> 3.9078   acc: 29.80% -> 31.79%             
client [11] (test)  loss: 3.4874 -> 3.5101   acc: 33.56% -> 36.58%             
client [96] (test)  loss: 3.5157 -> 3.3491   acc: 30.91% -> 37.45%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.6200 -> 4.1504   acc: 31.42% -> 29.39%              
client [53] (test)  loss: 3.5334 -> 3.5678   acc: 33.22% -> 38.11%             
client [52] (test)  loss: 3.3128 -> 3.4233   acc: 35.71% -> 34.42%             
client [42] (test)  loss: 3.5629 -> 3.8457   acc: 29.47% -> 33.11%             
client [69] (test)  loss: 3.2087 -> 3.3006   acc: 33.99% -> 38.61%             
client [59] (test)  loss: 3.4421 -> 3.1038   acc: 35.56% -> 41.34%             
client [7] (test)  loss: 3.0033 -> 3.0622   acc: 38.24% -> 41.18%              
client [26] (test)  loss: 3.1027 -> 3.2087   acc: 36.42% -> 39.07%             
client [49] (test)  loss: 3.7101 -> 4.0544   acc: 30.16% -> 30.82%             
client [98] (test)  loss: 3.4824 -> 3.6909   acc: 29.45% -> 31.72%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.5728 -> 3.7512   acc: 29.45% -> 33.66%             
client [47] (test)  loss: 3.1027 -> 3.0094   acc: 35.74% -> 39.67%             
client [21] (test)  loss: 3.1635 -> 3.2120   acc: 33.89% -> 38.21%             
client [77] (test)  loss: 3.6341 -> 3.7886   acc: 33.55% -> 36.18%             
client [95] (test)  loss: 3.7943 -> 4.1663   acc: 30.07% -> 30.07%             
client [91] (test)  loss: 3.3603 -> 3.0919   acc: 35.86% -> 41.12%             
client [14] (test)  loss: 3.3161 -> 3.5344   acc: 34.98% -> 36.75%             
client [99] (test)  loss: 3.1886 -> 3.2577   acc: 35.65% -> 35.02%             
client [20] (test)  loss: 3.4019 -> 3.4400   acc: 33.33% -> 38.54%             
client [39] (test)  loss: 2.9057 -> 3.3434   acc: 40.67% -> 43.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.3552 -> 3.3500   acc: 35.39% -> 34.74%             
client [62] (test)  loss: 2.9912 -> 3.1823   acc: 33.70% -> 39.86%             
client [71] (test)  loss: 2.9384 -> 3.0608   acc: 39.93% -> 42.57%             
client [97] (test)  loss: 3.5743 -> 3.7114   acc: 33.77% -> 33.44%             
client [30] (test)  loss: 3.1675 -> 3.5231   acc: 36.30% -> 38.61%             
client [88] (test)  loss: 3.3454 -> 3.5430   acc: 35.55% -> 34.88%             
client [60] (test)  loss: 3.2742 -> 3.4689   acc: 31.82% -> 34.09%             
client [82] (test)  loss: 3.0435 -> 3.2565   acc: 38.41% -> 37.42%             
client [91] (test)  loss: 3.2504 -> 3.0544   acc: 36.84% -> 40.79%             
client [57] (test)  loss: 3.4261 -> 3.5278   acc: 29.74% -> 36.93%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.0654 -> 3.1925   acc: 36.93% -> 39.37%             
client [15] (test)  loss: 3.4682 -> 3.5137   acc: 32.57% -> 36.18%             
client [71] (test)  loss: 3.1067 -> 3.0172   acc: 38.61% -> 44.88%             
client [97] (test)  loss: 3.6048 -> 3.7021   acc: 33.11% -> 34.77%             
client [53] (test)  loss: 3.5190 -> 3.5374   acc: 35.18% -> 39.74%             
client [77] (test)  loss: 3.5594 -> 3.8313   acc: 34.21% -> 34.21%             
client [76] (test)  loss: 3.7267 -> 3.7050   acc: 28.32% -> 35.13%             
client [79] (test)  loss: 3.1140 -> 3.2860   acc: 36.07% -> 40.66%             
client [28] (test)  loss: 3.1459 -> 3.4825   acc: 32.78% -> 33.77%             
client [99] (test)  loss: 3.2273 -> 3.3806   acc: 37.54% -> 37.85%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.5575 -> 3.6675   acc: 33.77% -> 35.76%             
client [86] (test)  loss: 3.2488 -> 3.7998   acc: 33.11% -> 31.77%             
client [34] (test)  loss: 3.4627 -> 3.3176   acc: 33.03% -> 40.24%             
client [73] (test)  loss: 3.1006 -> 3.3254   acc: 36.07% -> 37.05%             
client [5] (test)  loss: 3.4578 -> 3.6409   acc: 35.86% -> 37.17%              
client [96] (test)  loss: 3.3564 -> 3.3229   acc: 38.55% -> 40.00%             
client [22] (test)  loss: 3.3090 -> 3.3365   acc: 32.25% -> 34.20%             
client [60] (test)  loss: 3.2565 -> 3.2700   acc: 34.42% -> 37.01%             
client [66] (test)  loss: 3.3238 -> 3.3849   acc: 36.13% -> 38.06%             
client [83] (test)  loss: 3.5440 -> 3.3725   acc: 29.70% -> 34.98%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.6513 -> 3.7785   acc: 31.54% -> 35.13%             
client [65] (test)  loss: 3.5269 -> 3.8261   acc: 33.00% -> 31.02%             
client [95] (test)  loss: 3.6646 -> 3.9513   acc: 33.11% -> 32.77%             
client [17] (test)  loss: 3.1246 -> 3.3698   acc: 34.52% -> 36.45%             
client [8] (test)  loss: 3.8387 -> 4.0715   acc: 32.77% -> 33.11%              
client [35] (test)  loss: 3.3780 -> 3.7218   acc: 37.05% -> 34.43%             
client [98] (test)  loss: 3.5956 -> 3.6361   acc: 30.42% -> 34.30%             
client [53] (test)  loss: 3.3961 -> 3.5534   acc: 39.09% -> 40.72%             
client [43] (test)  loss: 3.1295 -> 3.0306   acc: 40.59% -> 43.89%             
client [64] (test)  loss: 3.4481 -> 3.3473   acc: 34.32% -> 38.61%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.1988 -> 3.1247   acc: 36.21% -> 40.53%             
client [88] (test)  loss: 3.2156 -> 3.5951   acc: 36.21% -> 38.54%             
client [38] (test)  loss: 3.4574 -> 3.3536   acc: 32.57% -> 38.49%             
client [3] (test)  loss: 3.0102 -> 2.8178   acc: 41.50% -> 46.73%              
client [5] (test)  loss: 3.5157 -> 3.5756   acc: 33.22% -> 39.80%              
client [41] (test)  loss: 3.7604 -> 3.6179   acc: 30.62% -> 35.83%             
client [7] (test)  loss: 3.1022 -> 3.1380   acc: 44.44% -> 40.85%              
client [37] (test)  loss: 3.3656 -> 3.4738   acc: 37.42% -> 39.40%             
client [45] (test)  loss: 3.3857 -> 3.3452   acc: 32.45% -> 35.10%             
client [47] (test)  loss: 3.1836 -> 3.1631   acc: 37.05% -> 38.36%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.4622 -> 3.5368   acc: 32.75% -> 41.46%             
client [11] (test)  loss: 3.5296 -> 3.5470   acc: 37.58% -> 38.93%             
client [37] (test)  loss: 3.3997 -> 3.4877   acc: 36.09% -> 39.40%             
client [41] (test)  loss: 3.8134 -> 3.5753   acc: 31.27% -> 36.81%             
client [95] (test)  loss: 3.6036 -> 3.9743   acc: 34.80% -> 31.76%             
client [53] (test)  loss: 3.4737 -> 3.4850   acc: 39.74% -> 40.72%             
client [22] (test)  loss: 3.2909 -> 3.3229   acc: 34.53% -> 36.48%             
client [25] (test)  loss: 3.5477 -> 3.5178   acc: 33.45% -> 37.24%             
client [69] (test)  loss: 3.1687 -> 3.0973   acc: 39.93% -> 42.24%             
client [46] (test)  loss: 2.8562 -> 2.8066   acc: 43.18% -> 45.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.2341 -> 3.2411   acc: 37.05% -> 40.66%             
client [69] (test)  loss: 3.2352 -> 3.1350   acc: 36.96% -> 42.90%             
client [82] (test)  loss: 3.1098 -> 3.3609   acc: 42.72% -> 40.40%             
client [45] (test)  loss: 3.4631 -> 3.4613   acc: 34.77% -> 40.73%             
client [7] (test)  loss: 3.1486 -> 3.2323   acc: 42.81% -> 42.81%              
client [50] (test)  loss: 2.9786 -> 3.2124   acc: 39.70% -> 44.57%             
client [35] (test)  loss: 3.5363 -> 3.9337   acc: 34.75% -> 37.70%             
client [24] (test)  loss: 3.3525 -> 3.0131   acc: 35.81% -> 38.51%             
client [15] (test)  loss: 3.6658 -> 3.4112   acc: 36.51% -> 40.13%             
client [58] (test)  loss: 3.4919 -> 3.5926   acc: 34.77% -> 39.06%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.1560 -> 3.2639   acc: 39.60% -> 39.60%             
client [76] (test)  loss: 3.8478 -> 4.0139   acc: 32.26% -> 34.77%             
client [67] (test)  loss: 3.3932 -> 3.5467   acc: 34.55% -> 39.53%             
client [37] (test)  loss: 3.4274 -> 3.5876   acc: 36.09% -> 36.75%             
client [58] (test)  loss: 3.4601 -> 3.6437   acc: 35.94% -> 37.11%             
client [64] (test)  loss: 3.4274 -> 3.3227   acc: 38.94% -> 41.58%             
client [77] (test)  loss: 3.5485 -> 3.6909   acc: 36.51% -> 36.51%             
client [55] (test)  loss: 3.3786 -> 3.3145   acc: 37.38% -> 40.33%             
client [12] (test)  loss: 3.4081 -> 3.4221   acc: 40.26% -> 36.96%             
client [89] (test)  loss: 3.6165 -> 3.7896   acc: 41.29% -> 37.74%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.1101 -> 3.2682   acc: 37.25% -> 39.87%             
client [51] (test)  loss: 3.2692 -> 3.3811   acc: 40.40% -> 40.07%             
client [8] (test)  loss: 3.8982 -> 4.4195   acc: 31.08% -> 32.77%              
client [18] (test)  loss: 3.0821 -> 2.9029   acc: 40.52% -> 46.73%             
client [94] (test)  loss: 3.4478 -> 3.7502   acc: 38.10% -> 41.16%             
client [81] (test)  loss: 3.5059 -> 3.3552   acc: 35.22% -> 38.54%             
client [3] (test)  loss: 3.2152 -> 3.0364   acc: 38.56% -> 43.79%              
client [11] (test)  loss: 3.5248 -> 3.7843   acc: 40.27% -> 38.93%             
client [95] (test)  loss: 3.7989 -> 3.9409   acc: 32.43% -> 36.49%             
client [67] (test)  loss: 3.3789 -> 3.5244   acc: 35.55% -> 34.22%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.2635 -> 3.1380   acc: 38.21% -> 42.52%             
client [79] (test)  loss: 3.3262 -> 3.4174   acc: 40.00% -> 40.66%             
client [58] (test)  loss: 3.4556 -> 3.6245   acc: 34.38% -> 38.28%             
client [88] (test)  loss: 3.3238 -> 3.6526   acc: 39.20% -> 38.21%             
client [46] (test)  loss: 3.0537 -> 2.9740   acc: 42.21% -> 47.08%             
client [11] (test)  loss: 3.5750 -> 3.6803   acc: 40.27% -> 38.93%             
client [55] (test)  loss: 3.4643 -> 3.3889   acc: 35.41% -> 42.62%             
client [13] (test)  loss: 3.5295 -> 3.7063   acc: 34.09% -> 37.66%             
client [31] (test)  loss: 3.2830 -> 3.5244   acc: 39.37% -> 34.15%             
client [75] (test)  loss: 3.1544 -> 3.2626   acc: 41.78% -> 45.39%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.3195 -> 3.5880   acc: 41.00% -> 40.33%             
client [7] (test)  loss: 3.1626 -> 3.3541   acc: 45.10% -> 43.14%              
client [57] (test)  loss: 3.3296 -> 3.6028   acc: 37.25% -> 39.22%             
client [13] (test)  loss: 3.5640 -> 3.7990   acc: 36.04% -> 36.36%             
client [43] (test)  loss: 3.5688 -> 3.2904   acc: 40.59% -> 45.87%             
client [91] (test)  loss: 3.6993 -> 3.2142   acc: 39.47% -> 44.08%             
client [10] (test)  loss: 3.7738 -> 3.9234   acc: 33.99% -> 35.97%             
client [64] (test)  loss: 3.4867 -> 3.6536   acc: 41.91% -> 42.90%             
client [82] (test)  loss: 3.4049 -> 3.5205   acc: 42.72% -> 41.72%             
client [22] (test)  loss: 3.5605 -> 3.5514   acc: 32.90% -> 38.76%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.9692 -> 3.9428   acc: 35.07% -> 38.54%             
client [23] (test)  loss: 3.7774 -> 3.4380   acc: 37.00% -> 42.00%             
client [88] (test)  loss: 3.5431 -> 3.8493   acc: 38.87% -> 39.87%             
client [98] (test)  loss: 3.7993 -> 3.9517   acc: 35.28% -> 38.51%             
client [79] (test)  loss: 3.4226 -> 3.5309   acc: 40.33% -> 42.95%             
client [21] (test)  loss: 3.4401 -> 3.2080   acc: 37.21% -> 41.20%             
client [92] (test)  loss: 3.7228 -> 3.5403   acc: 41.25% -> 39.06%             
client [56] (test)  loss: 3.4389 -> 3.5926   acc: 39.86% -> 41.92%             
client [5] (test)  loss: 3.9384 -> 3.7222   acc: 38.82% -> 37.83%              
client [52] (test)  loss: 3.7434 -> 3.6023   acc: 40.26% -> 43.51%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '3.2910 -> 0.0000', 'accuracy': '35.12% -> 0.00%'},          
    200: {'loss': '3.6731 -> 0.0000', 'accuracy': '38.13% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(10.26%) at epoch: 5                                     
FedProx achieved 20.0%(20.72%) at epoch: 16                                    
FedProx achieved 30.0%(30.16%) at epoch: 42                                    
Convergence (test_after):                                                      
FedProx achieved 10.0%(12.37%) at epoch: 3                                     
FedProx achieved 20.0%(21.18%) at epoch: 11                                    
FedProx achieved 30.0%(31.48%) at epoch: 28                                    
FedProx achieved 40.0%(40.47%) at epoch: 115                                   
