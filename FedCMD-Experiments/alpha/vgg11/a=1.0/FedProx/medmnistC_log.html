==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.2731 -> 1.8241   acc: 20.16% -> 38.71%             
client [81] (test)  loss: 2.3695 -> 1.6928   acc: 8.20% -> 36.07%              
client [21] (test)  loss: 2.3624 -> 1.4554   acc: 18.49% -> 53.78%             
client [68] (test)  loss: 1.9651 -> 1.9589   acc: 28.28% -> 30.30%             
client [93] (test)  loss: 1.4096 -> 0.8529   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.5102 -> 2.0331   acc: 10.26% -> 30.77%             
client [20] (test)  loss: 2.1181 -> 1.7360   acc: 4.32% -> 33.09%              
client [59] (test)  loss: 2.0142 -> 1.5511   acc: 36.22% -> 36.22%             
client [48] (test)  loss: 2.2580 -> 1.9616   acc: 16.36% -> 14.55%             
client [34] (test)  loss: 1.8071 -> 1.7037   acc: 28.17% -> 34.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.9785 -> 0.9518   acc: 65.18% -> 65.18%             
client [99] (test)  loss: 1.1775 -> 1.0651   acc: 57.95% -> 56.82%             
client [67] (test)  loss: 1.3715 -> 1.1317   acc: 44.44% -> 49.21%             
client [0] (test)  loss: 1.3288 -> 0.8011   acc: 50.87% -> 73.99%              
client [76] (test)  loss: 0.6972 -> 0.8553   acc: 78.48% -> 70.89%             
client [41] (test)  loss: 1.2615 -> 1.0829   acc: 44.26% -> 58.20%             
client [62] (test)  loss: 1.4701 -> 0.8687   acc: 43.66% -> 73.24%             
client [2] (test)  loss: 0.7376 -> 0.3799   acc: 80.69% -> 86.21%              
client [14] (test)  loss: 0.8407 -> 0.7072   acc: 78.74% -> 76.38%             
client [46] (test)  loss: 1.7968 -> 1.1959   acc: 29.06% -> 67.52%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6958 -> 0.6079   acc: 78.57% -> 78.57%             
client [68] (test)  loss: 0.6023 -> 0.4147   acc: 78.79% -> 88.89%             
client [57] (test)  loss: 1.2342 -> 0.6574   acc: 51.46% -> 79.53%             
client [17] (test)  loss: 0.7764 -> 0.7371   acc: 72.12% -> 75.96%             
client [54] (test)  loss: 1.2582 -> 1.1503   acc: 55.41% -> 56.76%             
client [23] (test)  loss: 0.5932 -> 0.5533   acc: 83.78% -> 82.43%             
client [35] (test)  loss: 1.0371 -> 0.5591   acc: 54.76% -> 83.33%             
client [59] (test)  loss: 0.6236 -> 0.6135   acc: 75.59% -> 69.29%             
client [31] (test)  loss: 1.1144 -> 1.0116   acc: 46.15% -> 73.08%             
client [9] (test)  loss: 0.6138 -> 0.5967   acc: 79.38% -> 79.38%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5695 -> 0.4267   acc: 77.60% -> 78.40%             
client [33] (test)  loss: 0.6494 -> 0.3673   acc: 71.96% -> 85.98%             
client [16] (test)  loss: 0.8267 -> 0.5518   acc: 62.50% -> 84.72%             
client [44] (test)  loss: 0.6001 -> 0.5589   acc: 74.07% -> 80.74%             
client [8] (test)  loss: 0.3791 -> 0.2899   acc: 86.81% -> 87.50%              
client [31] (test)  loss: 0.9296 -> 1.0845   acc: 53.85% -> 66.67%             
client [47] (test)  loss: 0.5131 -> 0.4831   acc: 83.19% -> 84.03%             
client [36] (test)  loss: 1.1419 -> 0.8629   acc: 56.41% -> 64.10%             
client [20] (test)  loss: 0.8923 -> 0.8144   acc: 57.55% -> 71.22%             
client [56] (test)  loss: 0.6233 -> 0.5571   acc: 76.92% -> 79.49%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4057 -> 0.3893   acc: 81.90% -> 83.62%              
client [60] (test)  loss: 0.3992 -> 0.4242   acc: 85.53% -> 85.53%             
client [28] (test)  loss: 0.5285 -> 0.4570   acc: 79.84% -> 80.65%             
client [25] (test)  loss: 0.4667 -> 0.5397   acc: 87.60% -> 83.47%             
client [58] (test)  loss: 0.4587 -> 0.2890   acc: 84.38% -> 93.12%             
client [44] (test)  loss: 0.4101 -> 0.3587   acc: 85.93% -> 88.15%             
client [39] (test)  loss: 0.1714 -> 0.1045   acc: 92.86% -> 96.43%             
client [29] (test)  loss: 0.6155 -> 0.4930   acc: 78.15% -> 86.55%             
client [3] (test)  loss: 0.7305 -> 0.5250   acc: 66.10% -> 77.12%              
client [84] (test)  loss: 0.5237 -> 0.1677   acc: 82.82% -> 94.48%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4383 -> 0.4052   acc: 86.55% -> 89.08%             
client [84] (test)  loss: 0.3984 -> 0.1394   acc: 87.12% -> 94.48%             
client [10] (test)  loss: 0.2436 -> 0.3454   acc: 87.18% -> 79.49%             
client [36] (test)  loss: 0.7764 -> 0.5406   acc: 72.65% -> 77.78%             
client [65] (test)  loss: 0.6000 -> 0.6425   acc: 82.20% -> 75.42%             
client [81] (test)  loss: 0.5317 -> 0.4468   acc: 80.33% -> 77.87%             
client [79] (test)  loss: 0.3656 -> 0.3293   acc: 86.32% -> 89.74%             
client [42] (test)  loss: 0.4670 -> 0.4156   acc: 84.38% -> 87.50%             
client [11] (test)  loss: 0.6593 -> 0.4673   acc: 82.58% -> 87.12%             
client [96] (test)  loss: 0.4425 -> 0.5224   acc: 86.55% -> 78.99%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2870 -> 0.2416   acc: 88.19% -> 91.67%              
client [53] (test)  loss: 0.2517 -> 0.1891   acc: 92.44% -> 94.96%             
client [52] (test)  loss: 0.4554 -> 0.2888   acc: 89.15% -> 92.25%             
client [42] (test)  loss: 0.4227 -> 0.4014   acc: 80.47% -> 88.28%             
client [69] (test)  loss: 0.3800 -> 0.3048   acc: 85.71% -> 88.39%             
client [59] (test)  loss: 0.3824 -> 0.3923   acc: 83.46% -> 82.68%             
client [7] (test)  loss: 0.4008 -> 0.4549   acc: 84.44% -> 85.19%              
client [26] (test)  loss: 0.4279 -> 0.4741   acc: 82.31% -> 82.31%             
client [49] (test)  loss: 0.2031 -> 0.1664   acc: 92.65% -> 92.65%             
client [98] (test)  loss: 0.4022 -> 0.4862   acc: 89.47% -> 84.21%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3945 -> 0.4457   acc: 86.84% -> 85.09%             
client [47] (test)  loss: 0.4936 -> 0.3375   acc: 87.39% -> 91.60%             
client [21] (test)  loss: 0.3761 -> 0.3277   acc: 87.39% -> 91.60%             
client [77] (test)  loss: 0.6354 -> 0.7205   acc: 78.23% -> 77.42%             
client [95] (test)  loss: 0.3531 -> 0.1922   acc: 85.47% -> 93.85%             
client [91] (test)  loss: 0.5186 -> 0.9376   acc: 82.54% -> 71.43%             
client [14] (test)  loss: 0.1913 -> 0.1624   acc: 92.91% -> 93.70%             
client [99] (test)  loss: 0.4457 -> 0.4249   acc: 84.09% -> 89.77%             
client [20] (test)  loss: 0.4445 -> 0.4345   acc: 84.89% -> 84.89%             
client [39] (test)  loss: 0.0956 -> 0.1027   acc: 95.71% -> 95.71%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4917 -> 0.2800   acc: 89.15% -> 92.25%             
client [62] (test)  loss: 0.4483 -> 0.3047   acc: 87.32% -> 90.14%             
client [71] (test)  loss: 0.2454 -> 0.3253   acc: 88.55% -> 87.02%             
client [97] (test)  loss: 0.1630 -> 0.0933   acc: 94.63% -> 96.64%             
client [30] (test)  loss: 0.5264 -> 0.4410   acc: 85.04% -> 92.13%             
client [88] (test)  loss: 0.3219 -> 0.4552   acc: 87.50% -> 86.03%             
client [60] (test)  loss: 0.1403 -> 0.3002   acc: 93.42% -> 89.47%             
client [82] (test)  loss: 0.2406 -> 0.1558   acc: 93.44% -> 95.90%             
client [91] (test)  loss: 0.4698 -> 0.8262   acc: 84.13% -> 76.19%             
client [57] (test)  loss: 0.4163 -> 0.3472   acc: 84.21% -> 91.23%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5128 -> 0.7238   acc: 82.05% -> 76.92%             
client [15] (test)  loss: 0.3375 -> 0.3926   acc: 89.31% -> 85.50%             
client [71] (test)  loss: 0.2584 -> 0.2829   acc: 90.08% -> 88.55%             
client [97] (test)  loss: 0.1223 -> 0.0826   acc: 95.30% -> 96.64%             
client [53] (test)  loss: 0.1873 -> 0.1361   acc: 94.96% -> 95.80%             
client [77] (test)  loss: 0.5923 -> 0.7754   acc: 81.45% -> 75.81%             
client [76] (test)  loss: 0.2062 -> 0.1953   acc: 94.94% -> 94.94%             
client [79] (test)  loss: 0.2842 -> 0.2469   acc: 90.60% -> 89.74%             
client [28] (test)  loss: 0.2513 -> 0.2451   acc: 91.13% -> 92.74%             
client [99] (test)  loss: 0.4259 -> 0.3828   acc: 87.50% -> 88.64%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1346 -> 0.0800   acc: 94.63% -> 96.64%             
client [86] (test)  loss: 0.1407 -> 0.0470   acc: 94.31% -> 98.37%             
client [34] (test)  loss: 0.4401 -> 0.3663   acc: 85.21% -> 86.62%             
client [73] (test)  loss: 0.3640 -> 0.4378   acc: 89.60% -> 90.40%             
client [5] (test)  loss: 0.5194 -> 0.5520   acc: 81.90% -> 80.95%              
client [96] (test)  loss: 0.2973 -> 0.3568   acc: 89.92% -> 86.55%             
client [22] (test)  loss: 0.4445 -> 0.3225   acc: 88.79% -> 92.52%             
client [60] (test)  loss: 0.1100 -> 0.2632   acc: 94.74% -> 90.79%             
client [66] (test)  loss: 0.3977 -> 0.3107   acc: 84.68% -> 88.71%             
client [83] (test)  loss: 0.3688 -> 0.3406   acc: 89.38% -> 89.38%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1588 -> 0.1614   acc: 94.94% -> 94.94%             
client [65] (test)  loss: 0.4337 -> 0.4036   acc: 83.90% -> 86.44%             
client [95] (test)  loss: 0.2730 -> 0.1448   acc: 89.39% -> 94.41%             
client [17] (test)  loss: 0.3832 -> 0.2069   acc: 87.50% -> 96.15%             
client [8] (test)  loss: 0.2667 -> 0.1900   acc: 90.97% -> 93.75%              
client [35] (test)  loss: 0.1618 -> 0.0880   acc: 92.86% -> 97.62%             
client [98] (test)  loss: 0.3233 -> 0.3380   acc: 88.60% -> 89.47%             
client [53] (test)  loss: 0.1385 -> 0.1249   acc: 95.80% -> 95.80%             
client [43] (test)  loss: 0.2360 -> 0.1922   acc: 91.87% -> 95.22%             
client [64] (test)  loss: 0.2170 -> 0.1751   acc: 90.40% -> 92.80%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3559 -> 0.2578   acc: 91.60% -> 94.12%             
client [88] (test)  loss: 0.3291 -> 0.2692   acc: 86.03% -> 88.97%             
client [38] (test)  loss: 0.2524 -> 0.3310   acc: 92.86% -> 85.71%             
client [3] (test)  loss: 0.3387 -> 0.3438   acc: 85.59% -> 88.98%              
client [5] (test)  loss: 0.4390 -> 0.4687   acc: 83.81% -> 81.90%              
client [41] (test)  loss: 0.2876 -> 0.2914   acc: 87.70% -> 93.44%             
client [7] (test)  loss: 0.2218 -> 0.2694   acc: 91.11% -> 90.37%              
client [37] (test)  loss: 0.3053 -> 0.2797   acc: 90.09% -> 89.62%             
client [45] (test)  loss: 0.1973 -> 0.2034   acc: 91.92% -> 93.94%             
client [47] (test)  loss: 0.4442 -> 0.3417   acc: 89.08% -> 93.28%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2843 -> 0.2245   acc: 90.28% -> 90.28%             
client [11] (test)  loss: 0.3217 -> 0.2559   acc: 90.91% -> 92.42%             
client [37] (test)  loss: 0.2963 -> 0.2553   acc: 88.21% -> 90.57%             
client [41] (test)  loss: 0.2626 -> 0.2768   acc: 90.16% -> 92.62%             
client [95] (test)  loss: 0.2584 -> 0.1309   acc: 90.50% -> 95.53%             
client [53] (test)  loss: 0.1495 -> 0.1165   acc: 94.96% -> 96.64%             
client [22] (test)  loss: 0.3832 -> 0.3647   acc: 93.46% -> 90.65%             
client [25] (test)  loss: 0.3090 -> 0.2905   acc: 92.56% -> 90.91%             
client [69] (test)  loss: 0.3515 -> 0.2299   acc: 89.29% -> 92.86%             
client [46] (test)  loss: 0.4511 -> 0.2742   acc: 87.18% -> 90.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4437 -> 0.3373   acc: 88.24% -> 93.28%             
client [69] (test)  loss: 0.3714 -> 0.2337   acc: 89.29% -> 92.86%             
client [82] (test)  loss: 0.2760 -> 0.1272   acc: 90.98% -> 96.72%             
client [45] (test)  loss: 0.2475 -> 0.1916   acc: 90.91% -> 92.93%             
client [7] (test)  loss: 0.2083 -> 0.2487   acc: 91.85% -> 92.59%              
client [50] (test)  loss: 0.0742 -> 0.0573   acc: 95.56% -> 97.04%             
client [35] (test)  loss: 0.1076 -> 0.0537   acc: 95.24% -> 98.81%             
client [24] (test)  loss: 0.2673 -> 0.3054   acc: 92.86% -> 91.07%             
client [15] (test)  loss: 0.2846 -> 0.3346   acc: 92.37% -> 87.79%             
client [58] (test)  loss: 0.2762 -> 0.1972   acc: 91.25% -> 95.62%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4328 -> 0.4791   acc: 87.27% -> 87.27%             
client [76] (test)  loss: 0.1472 -> 0.1476   acc: 96.20% -> 94.94%             
client [67] (test)  loss: 0.2195 -> 0.2295   acc: 92.86% -> 90.48%             
client [37] (test)  loss: 0.2826 -> 0.2518   acc: 90.09% -> 92.92%             
client [58] (test)  loss: 0.2463 -> 0.1774   acc: 91.88% -> 95.62%             
client [64] (test)  loss: 0.2250 -> 0.1861   acc: 91.20% -> 92.80%             
client [77] (test)  loss: 0.5467 -> 0.4826   acc: 84.68% -> 84.68%             
client [55] (test)  loss: 0.1257 -> 0.1816   acc: 95.24% -> 95.24%             
client [12] (test)  loss: 0.3987 -> 0.4345   acc: 87.14% -> 90.71%             
client [89] (test)  loss: 0.2170 -> 0.2314   acc: 92.75% -> 90.58%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3980 -> 0.1121   acc: 88.96% -> 96.32%             
client [51] (test)  loss: 0.1231 -> 0.1743   acc: 96.77% -> 94.84%             
client [8] (test)  loss: 0.1809 -> 0.1545   acc: 93.06% -> 93.06%              
client [18] (test)  loss: 0.3522 -> 0.3883   acc: 88.66% -> 87.63%             
client [94] (test)  loss: 0.1279 -> 0.1117   acc: 97.50% -> 97.50%             
client [81] (test)  loss: 0.2443 -> 0.1684   acc: 90.16% -> 90.98%             
client [3] (test)  loss: 0.2672 -> 0.3059   acc: 88.98% -> 90.68%              
client [11] (test)  loss: 0.2519 -> 0.2275   acc: 90.91% -> 93.18%             
client [95] (test)  loss: 0.1575 -> 0.1033   acc: 95.53% -> 97.21%             
client [67] (test)  loss: 0.2196 -> 0.2098   acc: 93.65% -> 92.06%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3188 -> 0.2267   acc: 91.60% -> 94.12%             
client [79] (test)  loss: 0.3071 -> 0.2039   acc: 90.60% -> 93.16%             
client [58] (test)  loss: 0.2600 -> 0.1809   acc: 91.25% -> 95.00%             
client [88] (test)  loss: 0.2949 -> 0.2795   acc: 88.97% -> 91.18%             
client [46] (test)  loss: 0.4343 -> 0.2303   acc: 88.03% -> 91.45%             
client [11] (test)  loss: 0.2253 -> 0.2220   acc: 91.67% -> 93.18%             
client [55] (test)  loss: 0.1451 -> 0.1882   acc: 95.24% -> 93.65%             
client [13] (test)  loss: 0.1386 -> 0.1649   acc: 93.90% -> 92.68%             
client [31] (test)  loss: 0.4954 -> 0.6378   acc: 84.62% -> 82.05%             
client [75] (test)  loss: 0.2504 -> 0.3209   acc: 91.60% -> 89.92%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1744 -> 0.2217   acc: 92.44% -> 92.44%             
client [7] (test)  loss: 0.1584 -> 0.2245   acc: 94.07% -> 91.11%              
client [57] (test)  loss: 0.2424 -> 0.3051   acc: 94.74% -> 91.81%             
client [13] (test)  loss: 0.1405 -> 0.1373   acc: 92.68% -> 95.12%             
client [43] (test)  loss: 0.1702 -> 0.1607   acc: 94.26% -> 96.65%             
client [91] (test)  loss: 0.4007 -> 0.3673   acc: 87.30% -> 87.30%             
client [10] (test)  loss: 0.0831 -> 0.0728   acc: 97.44% -> 97.44%             
client [64] (test)  loss: 0.2137 -> 0.1794   acc: 91.20% -> 92.80%             
client [82] (test)  loss: 0.1888 -> 0.1118   acc: 92.62% -> 96.72%             
client [22] (test)  loss: 0.4203 -> 0.2887   acc: 90.65% -> 92.52%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2327 -> 0.2074   acc: 91.37% -> 92.09%             
client [23] (test)  loss: 0.2269 -> 0.2749   acc: 91.89% -> 90.54%             
client [88] (test)  loss: 0.2762 -> 0.2780   acc: 90.44% -> 91.18%             
client [98] (test)  loss: 0.2955 -> 0.3331   acc: 90.35% -> 90.35%             
client [79] (test)  loss: 0.2756 -> 0.1845   acc: 92.31% -> 94.02%             
client [21] (test)  loss: 0.2731 -> 0.2072   acc: 92.44% -> 95.80%             
client [92] (test)  loss: 0.1847 -> 0.1263   acc: 95.38% -> 95.38%             
client [56] (test)  loss: 0.2227 -> 0.2792   acc: 94.87% -> 92.31%             
client [5] (test)  loss: 0.4745 -> 0.4267   acc: 84.76% -> 85.71%              
client [52] (test)  loss: 0.4339 -> 0.3047   acc: 90.70% -> 94.57%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.3175 -> 0.0000', 'accuracy': '89.43% -> 0.00%'},          
    200: {'loss': '0.2426 -> 0.0000', 'accuracy': '92.36% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(21.90%) at epoch: 0                                     
FedProx achieved 30.0%(36.91%) at epoch: 11                                    
FedProx achieved 40.0%(47.95%) at epoch: 13                                    
FedProx achieved 50.0%(51.85%) at epoch: 15                                    
FedProx achieved 60.0%(66.32%) at epoch: 20                                    
FedProx achieved 70.0%(74.72%) at epoch: 27                                    
FedProx achieved 80.0%(80.13%) at epoch: 38                                    
FedProx achieved 90.0%(91.03%) at epoch: 80                                    
Convergence (test_after):                                                      
FedProx achieved 20.0%(26.34%) at epoch: 0                                     
FedProx achieved 30.0%(35.46%) at epoch: 5                                     
FedProx achieved 40.0%(40.13%) at epoch: 6                                     
FedProx achieved 50.0%(53.78%) at epoch: 11                                    
FedProx achieved 60.0%(62.54%) at epoch: 13                                    
FedProx achieved 70.0%(72.37%) at epoch: 20                                    
FedProx achieved 80.0%(83.36%) at epoch: 31                                    
FedProx achieved 90.0%(90.56%) at epoch: 70                                    
