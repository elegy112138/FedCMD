==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3814 -> 4.9773   acc: 16.78% -> 18.42%             
client [81] (test)  loss: 4.0793 -> 4.2235   acc: 12.96% -> 20.93%             
client [21] (test)  loss: 4.1864 -> 4.2723   acc: 14.29% -> 19.93%             
client [68] (test)  loss: 3.9226 -> 4.6469   acc: 15.56% -> 21.19%             
client [93] (test)  loss: 4.5828 -> 4.6801   acc: 17.53% -> 18.51%             
client [31] (test)  loss: 4.1229 -> 4.1821   acc: 16.38% -> 18.12%             
client [20] (test)  loss: 4.3788 -> 4.4955   acc: 16.67% -> 18.75%             
client [59] (test)  loss: 4.5146 -> 4.0037   acc: 13.68% -> 20.36%             
client [48] (test)  loss: 3.9925 -> 4.7708   acc: 14.19% -> 17.49%             
client [34] (test)  loss: 4.2168 -> 4.4136   acc: 14.41% -> 22.52%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.0655 -> 4.1343   acc: 22.44% -> 25.08%             
client [99] (test)  loss: 3.7578 -> 4.2128   acc: 24.61% -> 27.13%             
client [67] (test)  loss: 4.0536 -> 4.3822   acc: 25.58% -> 23.92%             
client [0] (test)  loss: 4.4117 -> 4.5965   acc: 18.27% -> 21.93%              
client [76] (test)  loss: 4.1522 -> 4.2888   acc: 19.71% -> 22.58%             
client [41] (test)  loss: 4.4429 -> 4.3751   acc: 17.59% -> 24.76%             
client [62] (test)  loss: 3.7731 -> 4.3108   acc: 26.81% -> 27.17%             
client [2] (test)  loss: 3.8607 -> 4.1016   acc: 23.95% -> 25.57%              
client [14] (test)  loss: 3.9589 -> 4.4041   acc: 20.85% -> 25.09%             
client [46] (test)  loss: 3.6311 -> 3.6148   acc: 24.35% -> 33.44%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4702 -> 3.5938   acc: 27.70% -> 35.47%             
client [68] (test)  loss: 3.6854 -> 3.8797   acc: 26.16% -> 28.15%             
client [57] (test)  loss: 3.8791 -> 3.8310   acc: 21.90% -> 27.78%             
client [17] (test)  loss: 3.4223 -> 3.7229   acc: 28.06% -> 31.29%             
client [54] (test)  loss: 3.9758 -> 3.9924   acc: 24.29% -> 32.14%             
client [23] (test)  loss: 3.9929 -> 3.9537   acc: 23.00% -> 28.00%             
client [35] (test)  loss: 3.6707 -> 3.9465   acc: 23.93% -> 26.56%             
client [59] (test)  loss: 3.5827 -> 3.7933   acc: 30.40% -> 31.61%             
client [31] (test)  loss: 3.2203 -> 3.7123   acc: 31.36% -> 31.36%             
client [9] (test)  loss: 3.6930 -> 4.0536   acc: 22.85% -> 26.49%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.6068 -> 3.7325   acc: 26.40% -> 33.00%             
client [33] (test)  loss: 3.5492 -> 3.9755   acc: 27.69% -> 29.32%             
client [16] (test)  loss: 3.5522 -> 3.7913   acc: 31.71% -> 32.40%             
client [44] (test)  loss: 3.5305 -> 3.7011   acc: 29.18% -> 31.80%             
client [8] (test)  loss: 3.8500 -> 4.2535   acc: 25.68% -> 26.01%              
client [31] (test)  loss: 3.2666 -> 3.5498   acc: 32.06% -> 32.40%             
client [47] (test)  loss: 3.2678 -> 3.3622   acc: 30.49% -> 37.05%             
client [36] (test)  loss: 3.2654 -> 3.5073   acc: 32.23% -> 35.22%             
client [20] (test)  loss: 3.6269 -> 3.6946   acc: 28.82% -> 33.33%             
client [56] (test)  loss: 3.4332 -> 3.6787   acc: 31.96% -> 33.33%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.9926 -> 3.1239   acc: 37.50% -> 38.49%              
client [60] (test)  loss: 3.5788 -> 3.7925   acc: 27.92% -> 30.19%             
client [28] (test)  loss: 3.5657 -> 3.5495   acc: 26.49% -> 28.48%             
client [25] (test)  loss: 3.5267 -> 3.6048   acc: 24.48% -> 32.76%             
client [58] (test)  loss: 3.3550 -> 3.6641   acc: 30.86% -> 32.42%             
client [44] (test)  loss: 3.4401 -> 3.5159   acc: 29.84% -> 33.44%             
client [39] (test)  loss: 3.1511 -> 3.5349   acc: 38.00% -> 41.33%             
client [29] (test)  loss: 3.3740 -> 3.4834   acc: 33.44% -> 35.76%             
client [3] (test)  loss: 2.9827 -> 3.0557   acc: 33.66% -> 38.89%              
client [84] (test)  loss: 3.2319 -> 3.6523   acc: 30.39% -> 29.74%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.1408 -> 3.2510   acc: 33.89% -> 34.55%             
client [84] (test)  loss: 3.1595 -> 3.4880   acc: 31.05% -> 33.66%             
client [10] (test)  loss: 3.4829 -> 3.7634   acc: 28.38% -> 26.07%             
client [36] (test)  loss: 3.2458 -> 3.2812   acc: 33.89% -> 37.54%             
client [65] (test)  loss: 3.5653 -> 4.0492   acc: 26.07% -> 28.38%             
client [81] (test)  loss: 3.5215 -> 3.4580   acc: 29.57% -> 35.55%             
client [79] (test)  loss: 3.1183 -> 3.0794   acc: 33.44% -> 38.36%             
client [42] (test)  loss: 3.6534 -> 3.7793   acc: 26.82% -> 32.78%             
client [11] (test)  loss: 3.4096 -> 3.5823   acc: 35.57% -> 34.56%             
client [96] (test)  loss: 3.5265 -> 3.5054   acc: 30.91% -> 38.91%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.6756 -> 4.0702   acc: 29.73% -> 29.39%              
client [53] (test)  loss: 3.4744 -> 3.6457   acc: 33.22% -> 35.50%             
client [52] (test)  loss: 3.2226 -> 3.3160   acc: 37.66% -> 39.94%             
client [42] (test)  loss: 3.4906 -> 3.8384   acc: 30.79% -> 31.13%             
client [69] (test)  loss: 3.2713 -> 3.3021   acc: 33.33% -> 35.97%             
client [59] (test)  loss: 3.4243 -> 3.1005   acc: 34.04% -> 38.91%             
client [7] (test)  loss: 2.9325 -> 3.0750   acc: 40.85% -> 39.87%              
client [26] (test)  loss: 3.0697 -> 3.3663   acc: 38.74% -> 37.09%             
client [49] (test)  loss: 3.6129 -> 4.0366   acc: 30.16% -> 30.82%             
client [98] (test)  loss: 3.4667 -> 3.8597   acc: 31.39% -> 31.07%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.4542 -> 3.8826   acc: 33.01% -> 32.36%             
client [47] (test)  loss: 3.0810 -> 2.8603   acc: 35.08% -> 41.64%             
client [21] (test)  loss: 3.0697 -> 3.2011   acc: 35.22% -> 36.21%             
client [77] (test)  loss: 3.5920 -> 3.6106   acc: 30.59% -> 35.86%             
client [95] (test)  loss: 3.8843 -> 4.1383   acc: 27.70% -> 29.05%             
client [91] (test)  loss: 3.3462 -> 3.1188   acc: 36.51% -> 44.08%             
client [14] (test)  loss: 3.3681 -> 3.5477   acc: 33.22% -> 36.40%             
client [99] (test)  loss: 3.2045 -> 3.3983   acc: 36.28% -> 36.59%             
client [20] (test)  loss: 3.4214 -> 3.4180   acc: 31.60% -> 37.15%             
client [39] (test)  loss: 3.0284 -> 3.4692   acc: 39.33% -> 40.33%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.2320 -> 3.2423   acc: 37.01% -> 40.26%             
client [62] (test)  loss: 3.0473 -> 3.1106   acc: 34.78% -> 38.04%             
client [71] (test)  loss: 2.9042 -> 3.0522   acc: 39.27% -> 42.90%             
client [97] (test)  loss: 3.5713 -> 3.6944   acc: 33.77% -> 34.11%             
client [30] (test)  loss: 3.0899 -> 3.5214   acc: 38.28% -> 36.63%             
client [88] (test)  loss: 3.2861 -> 3.5895   acc: 32.89% -> 34.22%             
client [60] (test)  loss: 3.2916 -> 3.5049   acc: 31.82% -> 33.12%             
client [82] (test)  loss: 2.9367 -> 3.2570   acc: 40.07% -> 36.75%             
client [91] (test)  loss: 3.2944 -> 3.1300   acc: 35.20% -> 45.07%             
client [57] (test)  loss: 3.4981 -> 3.5971   acc: 27.78% -> 34.64%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.1046 -> 3.1549   acc: 37.28% -> 40.77%             
client [15] (test)  loss: 3.2935 -> 3.1156   acc: 31.91% -> 41.12%             
client [71] (test)  loss: 3.0452 -> 3.0489   acc: 39.60% -> 41.58%             
client [97] (test)  loss: 3.5013 -> 3.7853   acc: 34.11% -> 34.77%             
client [53] (test)  loss: 3.3419 -> 3.5352   acc: 35.18% -> 38.76%             
client [77] (test)  loss: 3.4773 -> 3.7640   acc: 32.24% -> 35.20%             
client [76] (test)  loss: 3.7318 -> 3.7299   acc: 29.03% -> 33.33%             
client [79] (test)  loss: 2.8300 -> 2.9711   acc: 41.31% -> 40.33%             
client [28] (test)  loss: 3.1159 -> 3.3037   acc: 33.11% -> 38.08%             
client [99] (test)  loss: 3.1494 -> 3.3696   acc: 39.43% -> 39.43%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.5694 -> 3.6399   acc: 34.11% -> 36.75%             
client [86] (test)  loss: 3.1590 -> 3.6005   acc: 35.45% -> 32.44%             
client [34] (test)  loss: 3.4610 -> 3.5306   acc: 31.53% -> 40.54%             
client [73] (test)  loss: 3.1082 -> 3.3798   acc: 40.00% -> 38.03%             
client [5] (test)  loss: 3.5569 -> 3.6831   acc: 36.84% -> 38.49%              
client [96] (test)  loss: 3.3557 -> 3.3824   acc: 34.55% -> 38.18%             
client [22] (test)  loss: 3.2988 -> 3.4106   acc: 32.90% -> 37.79%             
client [60] (test)  loss: 3.4048 -> 3.4989   acc: 31.17% -> 35.06%             
client [66] (test)  loss: 3.2094 -> 3.2743   acc: 37.74% -> 37.74%             
client [83] (test)  loss: 3.4901 -> 3.3161   acc: 32.67% -> 37.62%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.6500 -> 3.8312   acc: 33.69% -> 35.84%             
client [65] (test)  loss: 3.5595 -> 3.9000   acc: 34.32% -> 33.33%             
client [95] (test)  loss: 3.9241 -> 4.0268   acc: 30.74% -> 31.42%             
client [17] (test)  loss: 3.2612 -> 3.2152   acc: 35.81% -> 37.10%             
client [8] (test)  loss: 3.8568 -> 4.1501   acc: 32.09% -> 32.43%              
client [35] (test)  loss: 3.2502 -> 3.4540   acc: 35.41% -> 37.38%             
client [98] (test)  loss: 3.4589 -> 3.7204   acc: 32.36% -> 33.66%             
client [53] (test)  loss: 3.2198 -> 3.5251   acc: 38.76% -> 39.41%             
client [43] (test)  loss: 3.1008 -> 3.2987   acc: 38.61% -> 44.88%             
client [64] (test)  loss: 3.2192 -> 3.2405   acc: 36.96% -> 40.26%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.1193 -> 3.0922   acc: 39.87% -> 42.86%             
client [88] (test)  loss: 3.3396 -> 3.6685   acc: 36.54% -> 38.21%             
client [38] (test)  loss: 3.4541 -> 3.5711   acc: 33.88% -> 37.83%             
client [3] (test)  loss: 2.9241 -> 2.8159   acc: 40.20% -> 47.06%              
client [5] (test)  loss: 3.6986 -> 3.7923   acc: 34.21% -> 38.49%              
client [41] (test)  loss: 3.7569 -> 3.6585   acc: 31.92% -> 33.55%             
client [7] (test)  loss: 2.9384 -> 2.9956   acc: 43.14% -> 39.87%              
client [37] (test)  loss: 3.2111 -> 3.5208   acc: 39.07% -> 36.75%             
client [45] (test)  loss: 3.3768 -> 3.3164   acc: 33.11% -> 39.07%             
client [47] (test)  loss: 3.0536 -> 2.9081   acc: 38.36% -> 41.64%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.3741 -> 3.4702   acc: 38.33% -> 39.02%             
client [11] (test)  loss: 3.4327 -> 3.4328   acc: 40.27% -> 40.60%             
client [37] (test)  loss: 3.2880 -> 3.5469   acc: 39.07% -> 38.41%             
client [41] (test)  loss: 3.7544 -> 3.5314   acc: 31.92% -> 34.85%             
client [95] (test)  loss: 3.8940 -> 4.0663   acc: 31.76% -> 33.78%             
client [53] (test)  loss: 3.2778 -> 3.4308   acc: 38.76% -> 42.35%             
client [22] (test)  loss: 3.2970 -> 3.5447   acc: 35.50% -> 35.18%             
client [25] (test)  loss: 3.4676 -> 3.3338   acc: 35.17% -> 37.93%             
client [69] (test)  loss: 3.1764 -> 3.3010   acc: 39.60% -> 43.56%             
client [46] (test)  loss: 2.7859 -> 2.9970   acc: 44.81% -> 44.16%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.1194 -> 3.0754   acc: 40.33% -> 44.92%             
client [69] (test)  loss: 3.2823 -> 3.3924   acc: 39.27% -> 39.60%             
client [82] (test)  loss: 3.2480 -> 3.3938   acc: 43.05% -> 36.75%             
client [45] (test)  loss: 3.2807 -> 3.4272   acc: 35.76% -> 34.77%             
client [7] (test)  loss: 2.8745 -> 2.9809   acc: 47.06% -> 41.18%              
client [50] (test)  loss: 3.2367 -> 3.4744   acc: 42.70% -> 41.20%             
client [35] (test)  loss: 3.2976 -> 3.5330   acc: 35.41% -> 36.07%             
client [24] (test)  loss: 3.3916 -> 3.2068   acc: 39.19% -> 42.23%             
client [15] (test)  loss: 3.5187 -> 3.1730   acc: 34.54% -> 41.45%             
client [58] (test)  loss: 3.4284 -> 3.6176   acc: 34.77% -> 38.28%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.2427 -> 3.5218   acc: 38.61% -> 41.25%             
client [76] (test)  loss: 3.9505 -> 3.9456   acc: 32.62% -> 34.41%             
client [67] (test)  loss: 3.4939 -> 3.8271   acc: 35.55% -> 40.20%             
client [37] (test)  loss: 3.3832 -> 3.5882   acc: 36.09% -> 39.40%             
client [58] (test)  loss: 3.3706 -> 3.5684   acc: 35.16% -> 37.50%             
client [64] (test)  loss: 3.2877 -> 3.2644   acc: 40.59% -> 41.91%             
client [77] (test)  loss: 3.6584 -> 3.9351   acc: 35.53% -> 35.86%             
client [55] (test)  loss: 3.2852 -> 3.2662   acc: 38.03% -> 42.30%             
client [12] (test)  loss: 3.6142 -> 3.7568   acc: 35.97% -> 37.62%             
client [89] (test)  loss: 3.5448 -> 3.5827   acc: 40.97% -> 42.90%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.1427 -> 3.3117   acc: 37.25% -> 39.54%             
client [51] (test)  loss: 3.3337 -> 3.5088   acc: 39.40% -> 38.74%             
client [8] (test)  loss: 3.8874 -> 4.2168   acc: 32.77% -> 36.82%              
client [18] (test)  loss: 3.1410 -> 3.0236   acc: 39.87% -> 46.08%             
client [94] (test)  loss: 3.3144 -> 3.4267   acc: 37.76% -> 40.82%             
client [81] (test)  loss: 3.4640 -> 3.5604   acc: 34.55% -> 36.54%             
client [3] (test)  loss: 3.1049 -> 3.0138   acc: 41.83% -> 45.10%              
client [11] (test)  loss: 3.5181 -> 3.5717   acc: 41.61% -> 40.94%             
client [95] (test)  loss: 4.1115 -> 4.2122   acc: 32.43% -> 33.78%             
client [67] (test)  loss: 3.4091 -> 3.5400   acc: 35.22% -> 39.87%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.1189 -> 3.1067   acc: 42.86% -> 42.52%             
client [79] (test)  loss: 3.0775 -> 3.2604   acc: 43.28% -> 46.23%             
client [58] (test)  loss: 3.3422 -> 3.5753   acc: 35.55% -> 41.02%             
client [88] (test)  loss: 3.4119 -> 3.7289   acc: 36.54% -> 40.53%             
client [46] (test)  loss: 3.0596 -> 3.0528   acc: 43.18% -> 48.05%             
client [11] (test)  loss: 3.5602 -> 3.7153   acc: 41.28% -> 39.93%             
client [55] (test)  loss: 3.3824 -> 3.3435   acc: 37.70% -> 42.95%             
client [13] (test)  loss: 3.5328 -> 4.0383   acc: 36.69% -> 38.64%             
client [31] (test)  loss: 3.3524 -> 3.4680   acc: 40.42% -> 40.07%             
client [75] (test)  loss: 3.0954 -> 3.1495   acc: 44.74% -> 46.71%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.3501 -> 3.6978   acc: 37.67% -> 41.00%             
client [7] (test)  loss: 3.0226 -> 3.2486   acc: 43.14% -> 42.81%              
client [57] (test)  loss: 3.4217 -> 3.5798   acc: 35.29% -> 40.20%             
client [13] (test)  loss: 3.5852 -> 3.8996   acc: 34.74% -> 37.66%             
client [43] (test)  loss: 3.4302 -> 3.4793   acc: 40.59% -> 46.53%             
client [91] (test)  loss: 3.6023 -> 3.2814   acc: 38.16% -> 46.38%             
client [10] (test)  loss: 3.8036 -> 4.0107   acc: 36.96% -> 36.96%             
client [64] (test)  loss: 3.2735 -> 3.4076   acc: 43.23% -> 44.22%             
client [82] (test)  loss: 3.4116 -> 3.4139   acc: 44.04% -> 42.38%             
client [22] (test)  loss: 3.5433 -> 3.6606   acc: 33.55% -> 36.16%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.8219 -> 3.6623   acc: 36.46% -> 41.67%             
client [23] (test)  loss: 3.5913 -> 3.3049   acc: 36.33% -> 42.00%             
client [88] (test)  loss: 3.6220 -> 3.8206   acc: 37.21% -> 41.86%             
client [98] (test)  loss: 3.7587 -> 3.8786   acc: 38.19% -> 38.19%             
client [79] (test)  loss: 3.1505 -> 3.2575   acc: 42.95% -> 46.89%             
client [21] (test)  loss: 3.3086 -> 3.1889   acc: 40.20% -> 42.86%             
client [92] (test)  loss: 3.6719 -> 3.6006   acc: 38.12% -> 40.31%             
client [56] (test)  loss: 3.5102 -> 3.5251   acc: 39.86% -> 44.33%             
client [5] (test)  loss: 4.0409 -> 4.1317   acc: 38.49% -> 40.13%              
client [52] (test)  loss: 3.5412 -> 3.3935   acc: 40.91% -> 42.86%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.2523 -> 0.0000', 'accuracy': '35.67% -> 0.00%'},          
    200: {'loss': '3.6647 -> 0.0000', 'accuracy': '38.45% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(10.83%) at epoch: 5                                      
FedAvg achieved 20.0%(20.36%) at epoch: 16                                     
FedAvg achieved 30.0%(30.60%) at epoch: 42                                     
FedAvg achieved 40.0%(40.30%) at epoch: 179                                    
Convergence (test_after):                                                      
FedAvg achieved 10.0%(10.46%) at epoch: 2                                      
FedAvg achieved 20.0%(22.45%) at epoch: 11                                     
FedAvg achieved 30.0%(30.04%) at epoch: 30                                     
FedAvg achieved 40.0%(40.80%) at epoch: 114                                    
