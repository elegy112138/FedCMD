==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6435 -> 0.5048   acc: 76.43% -> 78.93%             
client [81] (test)  loss: 0.9499 -> 0.7869   acc: 62.75% -> 68.35%             
client [21] (test)  loss: 0.5018 -> 0.5333   acc: 81.11% -> 83.33%             
client [68] (test)  loss: 0.6723 -> 0.6376   acc: 71.52% -> 74.05%             
client [93] (test)  loss: 0.8169 -> 0.4657   acc: 66.03% -> 82.54%             
client [31] (test)  loss: 1.0928 -> 0.6752   acc: 55.67% -> 74.55%             
client [20] (test)  loss: 0.7259 -> 0.7628   acc: 76.43% -> 77.39%             
client [59] (test)  loss: 0.4683 -> 0.3993   acc: 84.29% -> 86.29%             
client [48] (test)  loss: 0.4584 -> 0.2758   acc: 82.68% -> 87.66%             
client [34] (test)  loss: 0.5871 -> 0.5112   acc: 76.09% -> 82.88%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3905 -> 0.2934   acc: 85.71% -> 89.87%             
client [99] (test)  loss: 0.3887 -> 0.3113   acc: 87.57% -> 90.11%             
client [67] (test)  loss: 0.3794 -> 0.3720   acc: 86.65% -> 89.42%             
client [0] (test)  loss: 0.4854 -> 0.4808   acc: 83.51% -> 82.45%              
client [76] (test)  loss: 0.3922 -> 0.3274   acc: 88.01% -> 89.29%             
client [41] (test)  loss: 0.7118 -> 0.6423   acc: 76.38% -> 75.65%             
client [62] (test)  loss: 0.4963 -> 0.5271   acc: 85.02% -> 81.35%             
client [2] (test)  loss: 0.5349 -> 0.5681   acc: 78.32% -> 81.59%              
client [14] (test)  loss: 0.6009 -> 0.4815   acc: 78.84% -> 84.89%             
client [46] (test)  loss: 0.4942 -> 0.3302   acc: 82.80% -> 87.46%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3970 -> 0.4939   acc: 86.15% -> 85.64%             
client [68] (test)  loss: 0.4314 -> 0.5000   acc: 82.91% -> 82.28%             
client [57] (test)  loss: 0.3565 -> 0.3757   acc: 89.89% -> 88.81%             
client [17] (test)  loss: 0.4194 -> 0.2801   acc: 85.34% -> 91.10%             
client [54] (test)  loss: 0.3374 -> 0.2596   acc: 89.02% -> 92.36%             
client [23] (test)  loss: 0.7853 -> 0.3680   acc: 73.67% -> 89.60%             
client [35] (test)  loss: 0.4193 -> 0.3153   acc: 85.26% -> 88.81%             
client [59] (test)  loss: 0.4442 -> 0.3097   acc: 86.00% -> 88.00%             
client [31] (test)  loss: 0.6304 -> 0.5527   acc: 75.35% -> 79.92%             
client [9] (test)  loss: 0.4501 -> 0.4590   acc: 83.88% -> 83.63%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6909 -> 0.4965   acc: 74.79% -> 80.17%             
client [33] (test)  loss: 0.3813 -> 0.4024   acc: 85.41% -> 86.22%             
client [16] (test)  loss: 0.3135 -> 0.2191   acc: 90.05% -> 93.72%             
client [44] (test)  loss: 0.3621 -> 0.3043   acc: 85.46% -> 89.21%             
client [8] (test)  loss: 0.4128 -> 0.5100   acc: 85.16% -> 83.23%              
client [31] (test)  loss: 0.7156 -> 0.5507   acc: 70.38% -> 78.73%             
client [47] (test)  loss: 0.6132 -> 1.0063   acc: 76.40% -> 71.91%             
client [36] (test)  loss: 0.4667 -> 0.4396   acc: 82.21% -> 83.13%             
client [20] (test)  loss: 0.5585 -> 0.6062   acc: 81.21% -> 83.44%             
client [56] (test)  loss: 0.4576 -> 0.4652   acc: 86.25% -> 86.88%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5470 -> 0.6431   acc: 80.41% -> 75.00%              
client [60] (test)  loss: 0.3750 -> 0.2811   acc: 88.37% -> 91.34%             
client [28] (test)  loss: 0.5488 -> 0.5292   acc: 82.95% -> 82.95%             
client [25] (test)  loss: 0.5172 -> 0.4628   acc: 83.11% -> 82.85%             
client [58] (test)  loss: 0.3722 -> 0.2279   acc: 87.70% -> 91.36%             
client [44] (test)  loss: 0.4410 -> 0.2967   acc: 83.26% -> 89.65%             
client [39] (test)  loss: 0.7973 -> 0.3672   acc: 68.12% -> 88.01%             
client [29] (test)  loss: 0.6044 -> 0.4691   acc: 79.04% -> 85.33%             
client [3] (test)  loss: 0.4652 -> 0.3305   acc: 82.09% -> 87.05%              
client [84] (test)  loss: 0.5410 -> 0.3432   acc: 80.58% -> 88.41%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3981 -> 0.4239   acc: 86.94% -> 88.33%             
client [84] (test)  loss: 0.4993 -> 0.3383   acc: 82.32% -> 89.28%             
client [10] (test)  loss: 0.2489 -> 0.2686   acc: 91.39% -> 91.67%             
client [36] (test)  loss: 0.4638 -> 0.4285   acc: 83.74% -> 84.66%             
client [65] (test)  loss: 0.2832 -> 0.3528   acc: 89.73% -> 87.28%             
client [81] (test)  loss: 0.6036 -> 0.6061   acc: 79.27% -> 77.31%             
client [79] (test)  loss: 0.5439 -> 0.3731   acc: 82.60% -> 85.64%             
client [42] (test)  loss: 0.8428 -> 0.4118   acc: 71.63% -> 86.98%             
client [11] (test)  loss: 0.4978 -> 0.4875   acc: 84.78% -> 86.23%             
client [96] (test)  loss: 0.3017 -> 0.3105   acc: 91.41% -> 89.75%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3775 -> 0.4477   acc: 88.06% -> 85.81%              
client [53] (test)  loss: 0.3448 -> 0.1919   acc: 88.38% -> 94.52%             
client [52] (test)  loss: 0.5105 -> 0.4453   acc: 82.27% -> 85.04%             
client [42] (test)  loss: 0.6035 -> 0.4500   acc: 78.14% -> 85.12%             
client [69] (test)  loss: 0.3386 -> 0.2261   acc: 88.31% -> 92.21%             
client [59] (test)  loss: 0.3834 -> 0.3073   acc: 87.14% -> 90.00%             
client [7] (test)  loss: 0.4454 -> 0.5001   acc: 85.56% -> 83.06%              
client [26] (test)  loss: 0.3377 -> 0.2927   acc: 89.47% -> 89.47%             
client [49] (test)  loss: 0.4025 -> 0.4058   acc: 86.40% -> 86.87%             
client [98] (test)  loss: 0.5411 -> 0.5224   acc: 80.00% -> 82.78%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7430 -> 0.5201   acc: 75.00% -> 83.61%             
client [47] (test)  loss: 0.6762 -> 0.5085   acc: 76.03% -> 81.27%             
client [21] (test)  loss: 0.3932 -> 0.4322   acc: 86.39% -> 89.44%             
client [77] (test)  loss: 0.5125 -> 0.4525   acc: 83.93% -> 84.64%             
client [95] (test)  loss: 0.3641 -> 0.4034   acc: 87.61% -> 87.89%             
client [91] (test)  loss: 0.4943 -> 0.3901   acc: 82.63% -> 88.68%             
client [14] (test)  loss: 0.4823 -> 0.3935   acc: 85.64% -> 88.16%             
client [99] (test)  loss: 0.2962 -> 0.2797   acc: 90.68% -> 89.83%             
client [20] (test)  loss: 0.5322 -> 0.5555   acc: 82.17% -> 84.39%             
client [39] (test)  loss: 1.0621 -> 0.3586   acc: 66.21% -> 88.28%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5488 -> 0.4109   acc: 81.16% -> 84.76%             
client [62] (test)  loss: 0.3527 -> 0.3837   acc: 89.60% -> 85.63%             
client [71] (test)  loss: 0.3398 -> 0.3392   acc: 89.27% -> 90.40%             
client [97] (test)  loss: 0.5628 -> 0.5590   acc: 83.96% -> 82.46%             
client [30] (test)  loss: 0.3819 -> 0.2954   acc: 86.82% -> 91.89%             
client [88] (test)  loss: 0.6180 -> 0.4125   acc: 79.89% -> 85.12%             
client [60] (test)  loss: 0.3045 -> 0.2416   acc: 88.61% -> 94.31%             
client [82] (test)  loss: 0.3844 -> 0.2623   acc: 87.56% -> 92.29%             
client [91] (test)  loss: 0.4039 -> 0.3532   acc: 85.26% -> 89.74%             
client [57] (test)  loss: 0.3100 -> 0.3028   acc: 90.61% -> 90.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7394 -> 0.6071   acc: 72.37% -> 79.13%             
client [15] (test)  loss: 0.3292 -> 0.3798   acc: 88.64% -> 88.64%             
client [71] (test)  loss: 0.3930 -> 0.3351   acc: 86.16% -> 90.40%             
client [97] (test)  loss: 0.4838 -> 0.4583   acc: 84.70% -> 86.57%             
client [53] (test)  loss: 0.3866 -> 0.2176   acc: 88.60% -> 94.52%             
client [77] (test)  loss: 0.4616 -> 0.4550   acc: 84.64% -> 84.64%             
client [76] (test)  loss: 0.3207 -> 0.2433   acc: 88.44% -> 93.15%             
client [79] (test)  loss: 0.5146 -> 0.3887   acc: 82.87% -> 86.19%             
client [28] (test)  loss: 0.5098 -> 0.5302   acc: 85.25% -> 84.79%             
client [99] (test)  loss: 0.3255 -> 0.3000   acc: 88.98% -> 90.11%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4618 -> 0.4695   acc: 85.07% -> 83.96%             
client [86] (test)  loss: 0.1721 -> 0.1853   acc: 94.19% -> 92.33%             
client [34] (test)  loss: 0.3584 -> 0.3863   acc: 87.77% -> 88.32%             
client [73] (test)  loss: 0.4097 -> 0.4384   acc: 84.48% -> 87.46%             
client [5] (test)  loss: 0.5141 -> 0.3776   acc: 81.99% -> 85.06%              
client [96] (test)  loss: 0.3280 -> 0.2784   acc: 89.75% -> 93.35%             
client [22] (test)  loss: 0.3811 -> 0.4209   acc: 85.16% -> 87.10%             
client [60] (test)  loss: 0.3403 -> 0.2230   acc: 89.36% -> 94.31%             
client [66] (test)  loss: 0.4571 -> 0.4731   acc: 83.70% -> 87.78%             
client [83] (test)  loss: 0.3734 -> 0.2225   acc: 87.89% -> 93.30%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3671 -> 0.2371   acc: 86.72% -> 92.72%             
client [65] (test)  loss: 0.3125 -> 0.3524   acc: 90.62% -> 88.62%             
client [95] (test)  loss: 0.3957 -> 0.4389   acc: 87.32% -> 87.89%             
client [17] (test)  loss: 0.4297 -> 0.2927   acc: 88.22% -> 92.41%             
client [8] (test)  loss: 0.3854 -> 0.4218   acc: 86.45% -> 86.45%              
client [35] (test)  loss: 0.4175 -> 0.3566   acc: 86.75% -> 89.55%             
client [98] (test)  loss: 0.6606 -> 0.4886   acc: 75.00% -> 85.83%             
client [53] (test)  loss: 0.3389 -> 0.2101   acc: 89.69% -> 93.86%             
client [43] (test)  loss: 0.3705 -> 0.1132   acc: 89.25% -> 95.16%             
client [64] (test)  loss: 0.5270 -> 0.4348   acc: 83.00% -> 84.70%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3524 -> 0.4140   acc: 89.17% -> 90.28%             
client [88] (test)  loss: 0.6485 -> 0.4131   acc: 77.96% -> 84.30%             
client [38] (test)  loss: 0.3276 -> 0.3378   acc: 88.99% -> 91.51%             
client [3] (test)  loss: 0.6173 -> 0.3601   acc: 80.44% -> 87.60%              
client [5] (test)  loss: 0.4860 -> 0.3771   acc: 83.91% -> 87.74%              
client [41] (test)  loss: 0.4850 -> 0.4666   acc: 83.76% -> 81.92%             
client [7] (test)  loss: 0.4770 -> 0.4956   acc: 86.11% -> 83.89%              
client [37] (test)  loss: 0.3450 -> 0.3120   acc: 88.27% -> 91.90%             
client [45] (test)  loss: 0.6346 -> 0.2893   acc: 76.96% -> 89.01%             
client [47] (test)  loss: 0.4758 -> 0.6462   acc: 86.14% -> 82.02%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3375 -> 0.2450   acc: 90.31% -> 95.03%             
client [11] (test)  loss: 0.5583 -> 0.4277   acc: 82.61% -> 88.41%             
client [37] (test)  loss: 0.4525 -> 0.3067   acc: 85.75% -> 92.18%             
client [41] (test)  loss: 0.6551 -> 0.4221   acc: 80.44% -> 85.98%             
client [95] (test)  loss: 0.4692 -> 0.4333   acc: 84.23% -> 88.45%             
client [53] (test)  loss: 0.4310 -> 0.2192   acc: 87.72% -> 93.86%             
client [22] (test)  loss: 0.5094 -> 0.4672   acc: 85.48% -> 85.81%             
client [25] (test)  loss: 0.7736 -> 0.6176   acc: 76.78% -> 82.06%             
client [69] (test)  loss: 0.3415 -> 0.2550   acc: 89.09% -> 92.47%             
client [46] (test)  loss: 0.3219 -> 0.2629   acc: 88.34% -> 90.96%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4221 -> 0.5242   acc: 88.39% -> 85.02%             
client [69] (test)  loss: 0.3877 -> 0.2598   acc: 87.27% -> 92.73%             
client [82] (test)  loss: 0.4202 -> 0.2412   acc: 87.06% -> 92.79%             
client [45] (test)  loss: 0.7200 -> 0.2959   acc: 74.87% -> 87.17%             
client [7] (test)  loss: 0.4358 -> 0.4881   acc: 86.94% -> 86.11%              
client [50] (test)  loss: 0.4369 -> 0.4326   acc: 83.19% -> 85.99%             
client [35] (test)  loss: 0.3306 -> 0.3504   acc: 88.25% -> 90.49%             
client [24] (test)  loss: 0.4787 -> 0.3763   acc: 87.15% -> 89.92%             
client [15] (test)  loss: 0.3819 -> 0.4077   acc: 88.92% -> 88.64%             
client [58] (test)  loss: 0.4027 -> 0.2386   acc: 86.39% -> 92.67%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4527 -> 0.2242   acc: 87.40% -> 92.13%             
client [76] (test)  loss: 0.3941 -> 0.2485   acc: 87.79% -> 93.36%             
client [67] (test)  loss: 0.2719 -> 0.3303   acc: 92.70% -> 91.44%             
client [37] (test)  loss: 0.3554 -> 0.3180   acc: 88.55% -> 91.90%             
client [58] (test)  loss: 0.3905 -> 0.2558   acc: 85.60% -> 93.19%             
client [64] (test)  loss: 0.6319 -> 0.4097   acc: 79.89% -> 85.27%             
client [77] (test)  loss: 0.4820 -> 0.4613   acc: 86.79% -> 86.07%             
client [55] (test)  loss: 0.3973 -> 0.4313   acc: 87.67% -> 87.87%             
client [12] (test)  loss: 0.4771 -> 0.4999   acc: 85.00% -> 86.82%             
client [89] (test)  loss: 0.4902 -> 0.2962   acc: 86.17% -> 91.32%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4524 -> 0.3479   acc: 84.06% -> 90.43%             
client [51] (test)  loss: 0.3432 -> 0.3859   acc: 88.59% -> 87.09%             
client [8] (test)  loss: 0.3564 -> 0.3847   acc: 87.42% -> 88.39%              
client [18] (test)  loss: 0.3128 -> 0.2844   acc: 91.79% -> 91.79%             
client [94] (test)  loss: 0.7237 -> 0.6029   acc: 76.24% -> 79.34%             
client [81] (test)  loss: 0.6111 -> 0.5612   acc: 82.35% -> 82.07%             
client [3] (test)  loss: 0.5483 -> 0.3619   acc: 81.27% -> 88.43%              
client [11] (test)  loss: 0.4852 -> 0.4421   acc: 86.23% -> 88.41%             
client [95] (test)  loss: 0.3537 -> 0.4349   acc: 87.61% -> 88.45%             
client [67] (test)  loss: 0.2533 -> 0.3052   acc: 92.44% -> 91.44%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3664 -> 0.4126   acc: 89.44% -> 90.83%             
client [79] (test)  loss: 0.4115 -> 0.3842   acc: 87.85% -> 88.95%             
client [58] (test)  loss: 0.3415 -> 0.2483   acc: 87.70% -> 92.41%             
client [88] (test)  loss: 0.5864 -> 0.4107   acc: 80.72% -> 84.57%             
client [46] (test)  loss: 0.3529 -> 0.2756   acc: 88.92% -> 90.38%             
client [11] (test)  loss: 0.5122 -> 0.4337   acc: 87.32% -> 89.13%             
client [55] (test)  loss: 0.4350 -> 0.4042   acc: 87.48% -> 88.85%             
client [13] (test)  loss: 0.2938 -> 0.2698   acc: 89.24% -> 91.86%             
client [31] (test)  loss: 0.7452 -> 0.5507   acc: 76.94% -> 80.12%             
client [75] (test)  loss: 0.3606 -> 0.2198   acc: 86.50% -> 90.80%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1884 -> 0.1865   acc: 94.14% -> 93.45%             
client [7] (test)  loss: 0.4191 -> 0.4851   acc: 87.50% -> 87.50%              
client [57] (test)  loss: 0.2449 -> 0.2596   acc: 93.14% -> 92.06%             
client [13] (test)  loss: 0.2822 -> 0.2560   acc: 89.50% -> 91.86%             
client [43] (test)  loss: 0.2446 -> 0.1500   acc: 93.55% -> 95.16%             
client [91] (test)  loss: 0.3923 -> 0.3268   acc: 86.58% -> 90.79%             
client [10] (test)  loss: 0.2115 -> 0.2546   acc: 91.94% -> 91.67%             
client [64] (test)  loss: 0.5212 -> 0.4317   acc: 83.57% -> 86.12%             
client [82] (test)  loss: 0.3683 -> 0.2273   acc: 89.05% -> 93.03%             
client [22] (test)  loss: 0.4617 -> 0.4938   acc: 86.13% -> 85.81%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4858 -> 0.5350   acc: 86.31% -> 86.31%             
client [23] (test)  loss: 0.5692 -> 0.3451   acc: 82.38% -> 93.63%             
client [88] (test)  loss: 0.6168 -> 0.4234   acc: 79.89% -> 84.85%             
client [98] (test)  loss: 0.5393 -> 0.4985   acc: 79.72% -> 86.39%             
client [79] (test)  loss: 0.4776 -> 0.3995   acc: 85.64% -> 88.95%             
client [21] (test)  loss: 0.3184 -> 0.3881   acc: 90.28% -> 91.39%             
client [92] (test)  loss: 0.5312 -> 0.4722   acc: 84.91% -> 87.60%             
client [56] (test)  loss: 0.4255 -> 0.4934   acc: 87.50% -> 87.50%             
client [5] (test)  loss: 0.4589 -> 0.3478   acc: 85.06% -> 88.51%              
client [52] (test)  loss: 0.5230 -> 0.4402   acc: 84.21% -> 87.26%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4349 -> 0.0000', 'accuracy': '85.50% -> 0.00%'},          
    200: {'loss': '0.4119 -> 0.0000', 'accuracy': '87.16% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(14.47%) at epoch: 0                                      
FedAvg achieved 30.0%(35.41%) at epoch: 1                                      
FedAvg achieved 60.0%(60.63%) at epoch: 2                                      
FedAvg achieved 70.0%(72.73%) at epoch: 4                                      
FedAvg achieved 80.0%(81.84%) at epoch: 13                                     
Convergence (test_after):                                                      
FedAvg achieved 70.0%(73.60%) at epoch: 0                                      
FedAvg achieved 80.0%(80.29%) at epoch: 3                                      
FedAvg achieved 90.0%(90.20%) at epoch: 74                                     
