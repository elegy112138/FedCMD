==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3303 -> 5.1422   acc: 16.12% -> 17.11%             
client [81] (test)  loss: 3.8582 -> 4.8019   acc: 16.61% -> 18.27%             
client [21] (test)  loss: 4.2672 -> 4.5282   acc: 12.29% -> 15.61%             
client [68] (test)  loss: 3.9598 -> 4.8480   acc: 17.22% -> 17.55%             
client [93] (test)  loss: 4.3646 -> 4.8131   acc: 17.86% -> 17.86%             
client [31] (test)  loss: 4.3977 -> 4.3273   acc: 15.33% -> 18.12%             
client [20] (test)  loss: 4.2107 -> 4.4772   acc: 18.75% -> 20.14%             
client [59] (test)  loss: 4.6804 -> 4.3941   acc: 13.98% -> 18.54%             
client [48] (test)  loss: 3.9083 -> 4.7901   acc: 16.83% -> 17.82%             
client [34] (test)  loss: 4.0112 -> 4.4966   acc: 15.92% -> 22.52%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.0278 -> 4.1199   acc: 22.77% -> 29.04%             
client [99] (test)  loss: 3.7168 -> 4.4334   acc: 27.13% -> 23.66%             
client [67] (test)  loss: 4.0161 -> 4.5907   acc: 24.25% -> 20.60%             
client [0] (test)  loss: 4.2760 -> 4.8624   acc: 19.60% -> 21.59%              
client [76] (test)  loss: 4.0721 -> 4.6990   acc: 22.58% -> 24.01%             
client [41] (test)  loss: 4.2817 -> 4.7404   acc: 18.89% -> 23.13%             
client [62] (test)  loss: 4.0922 -> 4.2800   acc: 26.81% -> 26.09%             
client [2] (test)  loss: 4.1745 -> 4.2507   acc: 22.98% -> 22.98%              
client [14] (test)  loss: 3.9786 -> 4.6243   acc: 25.09% -> 22.26%             
client [46] (test)  loss: 3.4030 -> 3.8344   acc: 32.79% -> 32.14%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4354 -> 3.9593   acc: 32.77% -> 31.42%             
client [68] (test)  loss: 3.6827 -> 4.0502   acc: 26.82% -> 30.79%             
client [57] (test)  loss: 3.8465 -> 4.2431   acc: 27.45% -> 26.47%             
client [17] (test)  loss: 3.7171 -> 4.1229   acc: 27.74% -> 26.45%             
client [54] (test)  loss: 3.8930 -> 4.6192   acc: 27.50% -> 27.86%             
client [23] (test)  loss: 4.2843 -> 4.0478   acc: 21.67% -> 26.33%             
client [35] (test)  loss: 3.8686 -> 4.3878   acc: 26.56% -> 23.61%             
client [59] (test)  loss: 3.5233 -> 4.2256   acc: 30.40% -> 28.57%             
client [31] (test)  loss: 3.3723 -> 4.0728   acc: 33.10% -> 27.18%             
client [9] (test)  loss: 3.6112 -> 4.2625   acc: 26.82% -> 24.50%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.6601 -> 4.1924   acc: 29.70% -> 30.36%             
client [33] (test)  loss: 3.8213 -> 4.5557   acc: 28.66% -> 28.34%             
client [16] (test)  loss: 3.6814 -> 4.2647   acc: 32.75% -> 31.36%             
client [44] (test)  loss: 3.6463 -> 3.9523   acc: 28.52% -> 31.48%             
client [8] (test)  loss: 3.9968 -> 4.9538   acc: 23.99% -> 23.65%              
client [31] (test)  loss: 3.4540 -> 4.0659   acc: 33.10% -> 29.62%             
client [47] (test)  loss: 3.2039 -> 3.7945   acc: 35.08% -> 31.15%             
client [36] (test)  loss: 3.2967 -> 3.6747   acc: 36.21% -> 30.90%             
client [20] (test)  loss: 3.5518 -> 4.0691   acc: 35.76% -> 30.21%             
client [56] (test)  loss: 3.5785 -> 3.9927   acc: 31.62% -> 30.58%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.8842 -> 3.5011   acc: 43.42% -> 39.47%              
client [60] (test)  loss: 3.6185 -> 4.2739   acc: 31.17% -> 25.00%             
client [28] (test)  loss: 3.7015 -> 4.0296   acc: 30.13% -> 27.15%             
client [25] (test)  loss: 3.7651 -> 4.0793   acc: 31.38% -> 30.34%             
client [58] (test)  loss: 3.6857 -> 4.2350   acc: 30.47% -> 30.47%             
client [44] (test)  loss: 3.6287 -> 3.9661   acc: 34.10% -> 30.82%             
client [39] (test)  loss: 3.2431 -> 3.8393   acc: 39.67% -> 36.33%             
client [29] (test)  loss: 3.4967 -> 4.1849   acc: 35.76% -> 34.11%             
client [3] (test)  loss: 3.0374 -> 3.2349   acc: 40.20% -> 35.95%              
client [84] (test)  loss: 3.4256 -> 3.9820   acc: 32.35% -> 28.76%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.3888 -> 3.7964   acc: 35.88% -> 31.89%             
client [84] (test)  loss: 3.3641 -> 3.9820   acc: 33.33% -> 32.35%             
client [10] (test)  loss: 3.9730 -> 4.3333   acc: 29.70% -> 27.39%             
client [36] (test)  loss: 3.1855 -> 3.6854   acc: 36.88% -> 34.88%             
client [65] (test)  loss: 3.8928 -> 4.5366   acc: 27.72% -> 25.41%             
client [81] (test)  loss: 3.6350 -> 4.1376   acc: 35.88% -> 31.23%             
client [79] (test)  loss: 3.2716 -> 3.7484   acc: 37.05% -> 36.07%             
client [42] (test)  loss: 3.6891 -> 4.3077   acc: 32.12% -> 27.48%             
client [11] (test)  loss: 3.6280 -> 3.9562   acc: 37.25% -> 33.56%             
client [96] (test)  loss: 3.5210 -> 3.8504   acc: 34.18% -> 32.36%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0469 -> 4.8754   acc: 29.39% -> 26.01%              
client [53] (test)  loss: 3.7892 -> 4.1975   acc: 34.85% -> 33.55%             
client [52] (test)  loss: 3.5330 -> 4.1172   acc: 38.31% -> 36.36%             
client [42] (test)  loss: 3.6930 -> 4.2250   acc: 32.12% -> 25.83%             
client [69] (test)  loss: 3.2173 -> 3.6975   acc: 37.95% -> 37.29%             
client [59] (test)  loss: 3.3984 -> 3.8545   acc: 37.39% -> 35.56%             
client [7] (test)  loss: 3.2023 -> 3.6598   acc: 38.89% -> 36.60%              
client [26] (test)  loss: 3.1992 -> 3.9741   acc: 39.74% -> 35.76%             
client [49] (test)  loss: 4.0900 -> 4.7059   acc: 29.51% -> 28.85%             
client [98] (test)  loss: 4.0472 -> 4.5627   acc: 28.16% -> 25.89%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.2915 -> 4.8556   acc: 28.48% -> 26.54%             
client [47] (test)  loss: 3.3975 -> 3.7151   acc: 36.72% -> 35.74%             
client [21] (test)  loss: 3.5997 -> 3.9591   acc: 35.88% -> 35.22%             
client [77] (test)  loss: 4.0121 -> 4.4866   acc: 33.22% -> 32.89%             
client [95] (test)  loss: 4.6644 -> 5.1951   acc: 27.36% -> 27.36%             
client [91] (test)  loss: 3.6508 -> 3.7978   acc: 44.08% -> 42.43%             
client [14] (test)  loss: 4.1831 -> 4.4479   acc: 32.86% -> 33.22%             
client [99] (test)  loss: 3.5531 -> 4.0109   acc: 38.49% -> 34.07%             
client [20] (test)  loss: 3.6518 -> 4.2133   acc: 38.54% -> 31.25%             
client [39] (test)  loss: 3.4275 -> 3.8824   acc: 42.33% -> 39.67%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.7438 -> 4.0697   acc: 38.96% -> 37.99%             
client [62] (test)  loss: 3.3971 -> 3.9703   acc: 37.68% -> 36.59%             
client [71] (test)  loss: 3.4973 -> 3.9240   acc: 43.89% -> 40.26%             
client [97] (test)  loss: 4.3895 -> 4.3794   acc: 32.45% -> 30.79%             
client [30] (test)  loss: 3.8821 -> 4.4602   acc: 35.97% -> 34.32%             
client [88] (test)  loss: 3.7258 -> 4.3327   acc: 36.88% -> 32.56%             
client [60] (test)  loss: 3.8666 -> 4.4974   acc: 31.49% -> 30.52%             
client [82] (test)  loss: 3.7048 -> 4.2156   acc: 38.08% -> 33.44%             
client [91] (test)  loss: 3.7175 -> 3.9232   acc: 43.75% -> 42.43%             
client [57] (test)  loss: 3.8955 -> 4.4041   acc: 33.01% -> 32.03%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.9742 -> 4.2982   acc: 38.68% -> 37.63%             
client [15] (test)  loss: 3.7500 -> 4.2222   acc: 36.18% -> 34.87%             
client [71] (test)  loss: 3.6459 -> 4.2556   acc: 41.91% -> 40.26%             
client [97] (test)  loss: 4.6353 -> 4.8215   acc: 33.11% -> 31.13%             
client [53] (test)  loss: 4.2360 -> 4.6556   acc: 35.50% -> 34.85%             
client [77] (test)  loss: 4.2537 -> 4.6349   acc: 34.54% -> 31.25%             
client [76] (test)  loss: 4.3628 -> 4.6204   acc: 34.41% -> 32.97%             
client [79] (test)  loss: 3.6076 -> 3.8784   acc: 40.33% -> 35.08%             
client [28] (test)  loss: 4.0168 -> 4.6504   acc: 34.11% -> 30.79%             
client [99] (test)  loss: 3.7616 -> 4.0932   acc: 35.65% -> 35.33%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.6523 -> 5.0307   acc: 34.11% -> 30.13%             
client [86] (test)  loss: 3.8572 -> 4.5118   acc: 33.78% -> 30.10%             
client [34] (test)  loss: 4.0921 -> 4.4672   acc: 39.94% -> 37.54%             
client [73] (test)  loss: 3.6330 -> 4.0942   acc: 38.69% -> 34.10%             
client [5] (test)  loss: 4.4649 -> 4.8395   acc: 35.86% -> 33.88%              
client [96] (test)  loss: 3.9254 -> 4.4560   acc: 40.73% -> 34.18%             
client [22] (test)  loss: 3.7422 -> 4.1762   acc: 32.90% -> 31.60%             
client [60] (test)  loss: 4.1359 -> 4.6621   acc: 32.79% -> 30.84%             
client [66] (test)  loss: 3.7738 -> 4.1284   acc: 39.68% -> 35.81%             
client [83] (test)  loss: 4.0060 -> 4.4293   acc: 34.32% -> 32.34%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.6452 -> 4.9874   acc: 32.26% -> 34.41%             
client [65] (test)  loss: 4.7765 -> 5.2561   acc: 34.32% -> 29.04%             
client [95] (test)  loss: 5.2166 -> 5.7283   acc: 29.05% -> 27.03%             
client [17] (test)  loss: 3.9520 -> 4.5156   acc: 35.16% -> 30.65%             
client [8] (test)  loss: 4.7946 -> 5.4263   acc: 31.08% -> 27.03%              
client [35] (test)  loss: 4.5316 -> 4.9646   acc: 34.43% -> 33.77%             
client [98] (test)  loss: 4.6265 -> 5.1490   acc: 31.39% -> 31.72%             
client [53] (test)  loss: 4.5177 -> 5.1420   acc: 36.16% -> 33.55%             
client [43] (test)  loss: 3.9522 -> 4.3081   acc: 39.93% -> 38.61%             
client [64] (test)  loss: 4.4529 -> 4.5824   acc: 34.32% -> 32.01%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.0588 -> 4.4420   acc: 38.87% -> 37.54%             
client [88] (test)  loss: 4.4723 -> 4.9691   acc: 38.87% -> 37.87%             
client [38] (test)  loss: 4.5665 -> 5.0404   acc: 35.53% -> 33.88%             
client [3] (test)  loss: 3.7922 -> 3.9105   acc: 43.14% -> 43.46%              
client [5] (test)  loss: 4.8482 -> 5.1174   acc: 34.54% -> 35.86%              
client [41] (test)  loss: 4.6506 -> 5.2687   acc: 33.22% -> 29.97%             
client [7] (test)  loss: 3.8856 -> 4.1625   acc: 41.50% -> 38.89%              
client [37] (test)  loss: 4.5067 -> 5.0894   acc: 36.75% -> 34.77%             
client [45] (test)  loss: 4.1736 -> 4.4636   acc: 39.40% -> 38.74%             
client [47] (test)  loss: 3.8584 -> 4.4041   acc: 39.67% -> 35.74%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.4319 -> 4.7698   acc: 34.49% -> 32.75%             
client [11] (test)  loss: 4.6876 -> 4.9264   acc: 37.25% -> 37.92%             
client [37] (test)  loss: 4.5475 -> 4.9333   acc: 38.41% -> 38.08%             
client [41] (test)  loss: 4.7023 -> 4.9138   acc: 33.22% -> 34.85%             
client [95] (test)  loss: 5.3893 -> 5.8857   acc: 29.73% -> 26.69%             
client [53] (test)  loss: 4.7035 -> 5.2803   acc: 36.16% -> 31.92%             
client [22] (test)  loss: 4.1028 -> 4.5610   acc: 36.16% -> 33.55%             
client [25] (test)  loss: 4.7411 -> 5.0024   acc: 35.86% -> 33.10%             
client [69] (test)  loss: 3.9321 -> 4.2098   acc: 41.25% -> 42.57%             
client [46] (test)  loss: 3.6575 -> 3.9773   acc: 45.78% -> 40.91%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.1905 -> 4.5728   acc: 39.02% -> 38.69%             
client [69] (test)  loss: 4.1956 -> 4.3866   acc: 40.26% -> 41.25%             
client [82] (test)  loss: 4.6902 -> 4.9621   acc: 40.07% -> 36.09%             
client [45] (test)  loss: 4.6308 -> 4.9887   acc: 36.75% -> 35.10%             
client [7] (test)  loss: 4.0940 -> 4.2646   acc: 41.18% -> 37.25%              
client [50] (test)  loss: 4.3173 -> 4.7042   acc: 40.45% -> 36.33%             
client [35] (test)  loss: 5.0319 -> 5.2534   acc: 36.72% -> 36.07%             
client [24] (test)  loss: 4.3773 -> 4.7940   acc: 38.18% -> 37.84%             
client [15] (test)  loss: 4.4632 -> 4.8612   acc: 38.16% -> 36.18%             
client [58] (test)  loss: 5.0030 -> 5.3709   acc: 35.16% -> 33.59%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.9913 -> 5.3505   acc: 37.29% -> 36.63%             
client [76] (test)  loss: 5.3867 -> 5.6589   acc: 32.62% -> 35.48%             
client [67] (test)  loss: 4.5843 -> 5.0362   acc: 39.20% -> 35.88%             
client [37] (test)  loss: 4.9435 -> 5.1927   acc: 39.74% -> 39.40%             
client [58] (test)  loss: 5.1870 -> 5.4759   acc: 34.77% -> 34.77%             
client [64] (test)  loss: 4.9738 -> 5.1716   acc: 35.97% -> 35.31%             
client [77] (test)  loss: 5.2006 -> 5.4807   acc: 36.18% -> 36.51%             
client [55] (test)  loss: 4.8925 -> 4.9642   acc: 36.72% -> 35.08%             
client [12] (test)  loss: 4.4659 -> 4.8694   acc: 37.95% -> 33.99%             
client [89] (test)  loss: 5.1428 -> 5.5743   acc: 37.10% -> 35.81%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.5519 -> 4.8084   acc: 36.27% -> 36.93%             
client [51] (test)  loss: 5.1602 -> 5.5507   acc: 34.11% -> 31.46%             
client [8] (test)  loss: 5.5480 -> 6.0902   acc: 29.05% -> 28.38%              
client [18] (test)  loss: 4.3874 -> 4.4384   acc: 36.27% -> 38.56%             
client [94] (test)  loss: 4.9479 -> 5.3332   acc: 42.52% -> 37.76%             
client [81] (test)  loss: 5.1577 -> 5.3544   acc: 36.21% -> 36.21%             
client [3] (test)  loss: 4.2810 -> 4.3782   acc: 44.44% -> 43.79%              
client [11] (test)  loss: 5.2560 -> 5.4336   acc: 37.92% -> 38.59%             
client [95] (test)  loss: 6.3153 -> 6.5902   acc: 29.39% -> 29.05%             
client [67] (test)  loss: 4.6568 -> 5.3751   acc: 40.53% -> 35.55%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.7764 -> 5.0456   acc: 38.87% -> 32.89%             
client [79] (test)  loss: 4.8969 -> 5.0152   acc: 39.67% -> 40.00%             
client [58] (test)  loss: 5.5321 -> 5.7481   acc: 36.72% -> 34.38%             
client [88] (test)  loss: 5.2247 -> 5.7413   acc: 39.87% -> 34.88%             
client [46] (test)  loss: 4.1821 -> 4.5960   acc: 46.75% -> 43.18%             
client [11] (test)  loss: 5.6042 -> 5.8082   acc: 39.26% -> 37.58%             
client [55] (test)  loss: 5.2004 -> 5.1699   acc: 35.41% -> 35.74%             
client [13] (test)  loss: 5.6026 -> 5.8339   acc: 37.01% -> 37.01%             
client [31] (test)  loss: 5.1636 -> 5.5741   acc: 37.98% -> 39.02%             
client [75] (test)  loss: 5.1164 -> 5.2044   acc: 40.46% -> 37.83%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.5366 -> 5.6717   acc: 36.00% -> 38.33%             
client [7] (test)  loss: 4.6474 -> 4.6804   acc: 42.81% -> 45.10%              
client [57] (test)  loss: 5.3083 -> 5.4500   acc: 36.27% -> 36.27%             
client [13] (test)  loss: 5.7626 -> 5.8890   acc: 37.66% -> 36.69%             
client [43] (test)  loss: 4.9435 -> 4.9416   acc: 41.91% -> 44.22%             
client [91] (test)  loss: 5.1137 -> 5.0955   acc: 46.05% -> 42.76%             
client [10] (test)  loss: 5.6723 -> 6.0242   acc: 33.66% -> 33.00%             
client [64] (test)  loss: 5.4070 -> 5.5108   acc: 35.64% -> 34.98%             
client [82] (test)  loss: 5.1954 -> 5.3113   acc: 38.74% -> 39.07%             
client [22] (test)  loss: 4.9981 -> 5.1984   acc: 34.85% -> 37.13%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.1405 -> 5.3849   acc: 40.62% -> 38.89%             
client [23] (test)  loss: 5.4502 -> 5.1608   acc: 39.00% -> 37.00%             
client [88] (test)  loss: 5.6057 -> 5.7272   acc: 40.53% -> 34.55%             
client [98] (test)  loss: 6.1863 -> 6.3253   acc: 29.77% -> 29.13%             
client [79] (test)  loss: 5.2066 -> 5.2921   acc: 40.33% -> 40.33%             
client [21] (test)  loss: 5.2117 -> 5.1523   acc: 38.54% -> 35.88%             
client [92] (test)  loss: 5.4541 -> 5.5899   acc: 39.06% -> 39.69%             
client [56] (test)  loss: 5.1025 -> 5.1411   acc: 40.55% -> 41.58%             
client [5] (test)  loss: 6.1820 -> 6.1464   acc: 35.86% -> 37.17%              
client [52] (test)  loss: 5.4131 -> 5.7048   acc: 42.21% -> 41.56%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.9606 -> 0.0000', 'accuracy': '36.48% -> 0.00%'},          
    200: {'loss': '5.5217 -> 0.0000', 'accuracy': '37.61% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(11.53%) at epoch: 6                                      
FedPer achieved 20.0%(22.88%) at epoch: 16                                     
FedPer achieved 30.0%(30.32%) at epoch: 28                                     
FedPer achieved 40.0%(40.07%) at epoch: 148                                    
Convergence (test_after):                                                      
FedPer achieved 10.0%(10.03%) at epoch: 2                                      
FedPer achieved 20.0%(21.08%) at epoch: 11                                     
FedPer achieved 30.0%(30.04%) at epoch: 30                                     
