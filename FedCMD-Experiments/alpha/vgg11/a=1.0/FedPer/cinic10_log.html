==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.5641 -> 1.4022   acc: 48.83% -> 63.62%             
client [81] (test)  loss: 1.6506 -> 1.3493   acc: 50.96% -> 60.18%             
client [21] (test)  loss: 1.2662 -> 1.1386   acc: 58.45% -> 64.31%             
client [68] (test)  loss: 1.4857 -> 1.3501   acc: 55.97% -> 64.14%             
client [93] (test)  loss: 1.6734 -> 1.1684   acc: 43.03% -> 63.64%             
client [31] (test)  loss: 1.5198 -> 1.0896   acc: 53.23% -> 61.83%             
client [20] (test)  loss: 1.4862 -> 1.5329   acc: 56.47% -> 55.52%             
client [59] (test)  loss: 1.3257 -> 1.1391   acc: 57.22% -> 63.20%             
client [48] (test)  loss: 0.9872 -> 1.1664   acc: 65.55% -> 64.53%             
client [34] (test)  loss: 1.3762 -> 1.1924   acc: 55.53% -> 64.85%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4575 -> 1.4147   acc: 59.40% -> 62.75%             
client [99] (test)  loss: 1.5339 -> 1.1232   acc: 50.79% -> 70.79%             
client [67] (test)  loss: 1.5070 -> 1.5272   acc: 55.11% -> 58.78%             
client [0] (test)  loss: 1.0948 -> 1.1616   acc: 67.50% -> 71.04%              
client [76] (test)  loss: 1.2377 -> 1.0857   acc: 63.99% -> 73.12%             
client [41] (test)  loss: 1.5987 -> 1.4803   acc: 53.37% -> 58.00%             
client [62] (test)  loss: 1.4085 -> 1.1500   acc: 57.66% -> 65.00%             
client [2] (test)  loss: 1.6118 -> 1.2017   acc: 51.69% -> 65.29%              
client [14] (test)  loss: 6.0292 -> 0.7428   acc: 48.47% -> 76.27%             
client [46] (test)  loss: 1.1699 -> 1.3779   acc: 64.89% -> 63.21%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0690 -> 1.2958   acc: 70.37% -> 70.66%             
client [68] (test)  loss: 1.2997 -> 1.4613   acc: 65.00% -> 68.47%             
client [57] (test)  loss: 0.9795 -> 0.9409   acc: 70.94% -> 72.70%             
client [17] (test)  loss: 0.9768 -> 1.0507   acc: 72.62% -> 73.13%             
client [54] (test)  loss: 0.9288 -> 1.1345   acc: 70.89% -> 70.53%             
client [23] (test)  loss: 1.4223 -> 1.1735   acc: 60.19% -> 66.63%             
client [35] (test)  loss: 1.6918 -> 1.3408   acc: 58.89% -> 66.67%             
client [59] (test)  loss: 1.1850 -> 1.1992   acc: 64.37% -> 69.83%             
client [31] (test)  loss: 1.1442 -> 1.2668   acc: 65.58% -> 66.27%             
client [9] (test)  loss: 1.3739 -> 1.5313   acc: 57.54% -> 61.49%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2898 -> 1.3717   acc: 66.40% -> 68.12%             
client [33] (test)  loss: 1.4002 -> 1.6285   acc: 66.00% -> 65.82%             
client [16] (test)  loss: 1.0860 -> 1.2103   acc: 71.45% -> 71.45%             
client [44] (test)  loss: 1.3207 -> 0.9828   acc: 62.46% -> 68.89%             
client [8] (test)  loss: 0.8430 -> 1.0115   acc: 79.70% -> 81.45%              
client [31] (test)  loss: 1.1602 -> 1.2430   acc: 67.18% -> 67.59%             
client [47] (test)  loss: 0.9671 -> 0.9685   acc: 74.18% -> 74.33%             
client [36] (test)  loss: 1.3762 -> 1.3073   acc: 62.31% -> 66.83%             
client [20] (test)  loss: 1.4789 -> 1.6564   acc: 61.76% -> 62.13%             
client [56] (test)  loss: 1.3723 -> 1.5385   acc: 62.87% -> 60.98%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.2074 -> 1.1429   acc: 68.22% -> 71.98%              
client [60] (test)  loss: 1.4514 -> 1.4442   acc: 62.30% -> 62.80%             
client [28] (test)  loss: 1.5064 -> 1.2856   acc: 65.89% -> 69.24%             
client [25] (test)  loss: 1.4570 -> 1.6273   acc: 61.10% -> 59.45%             
client [58] (test)  loss: 1.4849 -> 1.4697   acc: 63.02% -> 65.68%             
client [44] (test)  loss: 1.2201 -> 1.0931   acc: 65.44% -> 69.23%             
client [39] (test)  loss: 1.1720 -> 1.3779   acc: 67.64% -> 67.04%             
client [29] (test)  loss: 1.4593 -> 1.6374   acc: 62.89% -> 64.00%             
client [3] (test)  loss: 1.5659 -> 1.5021   acc: 60.92% -> 63.84%              
client [84] (test)  loss: 1.2333 -> 1.3168   acc: 66.73% -> 70.91%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.0241 -> 1.0816   acc: 68.72% -> 72.83%             
client [84] (test)  loss: 1.1995 -> 1.3800   acc: 68.73% -> 71.85%             
client [10] (test)  loss: 0.9925 -> 1.0272   acc: 72.24% -> 74.31%             
client [36] (test)  loss: 1.2350 -> 1.4035   acc: 67.33% -> 67.82%             
client [65] (test)  loss: 1.1916 -> 1.3481   acc: 69.31% -> 68.74%             
client [81] (test)  loss: 1.3222 -> 1.3945   acc: 67.92% -> 69.03%             
client [79] (test)  loss: 1.2756 -> 1.4660   acc: 67.11% -> 66.81%             
client [42] (test)  loss: 1.3229 -> 1.5349   acc: 64.97% -> 64.97%             
client [11] (test)  loss: 1.1613 -> 1.2743   acc: 71.22% -> 71.04%             
client [96] (test)  loss: 1.3686 -> 1.4366   acc: 63.74% -> 65.55%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8136 -> 0.9740   acc: 80.73% -> 81.53%              
client [53] (test)  loss: 1.1718 -> 1.2440   acc: 68.38% -> 69.00%             
client [52] (test)  loss: 0.9527 -> 1.1146   acc: 75.60% -> 73.33%             
client [42] (test)  loss: 1.2970 -> 1.5684   acc: 67.14% -> 65.80%             
client [69] (test)  loss: 1.2848 -> 1.5310   acc: 69.30% -> 68.09%             
client [59] (test)  loss: 1.1891 -> 1.2511   acc: 68.66% -> 70.87%             
client [7] (test)  loss: 0.9659 -> 0.9627   acc: 75.17% -> 77.34%              
client [26] (test)  loss: 0.9234 -> 0.9901   acc: 75.96% -> 78.24%             
client [49] (test)  loss: 1.5356 -> 1.7888   acc: 62.71% -> 62.36%             
client [98] (test)  loss: 1.5957 -> 1.8147   acc: 61.59% -> 59.44%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.5618 -> 1.8409   acc: 61.40% -> 59.50%             
client [47] (test)  loss: 0.9336 -> 0.9557   acc: 75.97% -> 78.27%             
client [21] (test)  loss: 1.0382 -> 1.1187   acc: 68.72% -> 73.19%             
client [77] (test)  loss: 1.1942 -> 1.3032   acc: 70.04% -> 71.79%             
client [95] (test)  loss: 1.3634 -> 1.6555   acc: 66.08% -> 65.25%             
client [91] (test)  loss: 1.4763 -> 1.6048   acc: 61.79% -> 59.68%             
client [14] (test)  loss: 2.6139 -> 0.6559   acc: 68.18% -> 84.60%             
client [99] (test)  loss: 0.9464 -> 1.1136   acc: 74.98% -> 76.08%             
client [20] (test)  loss: 1.4558 -> 1.6210   acc: 66.86% -> 66.10%             
client [39] (test)  loss: 1.2263 -> 1.4042   acc: 68.17% -> 68.31%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9595 -> 1.1029   acc: 75.60% -> 74.21%             
client [62] (test)  loss: 1.3202 -> 1.4630   acc: 70.36% -> 69.89%             
client [71] (test)  loss: 1.2068 -> 1.4386   acc: 72.79% -> 71.81%             
client [97] (test)  loss: 1.3885 -> 1.5144   acc: 68.09% -> 65.32%             
client [30] (test)  loss: 0.8566 -> 0.9897   acc: 79.12% -> 80.49%             
client [88] (test)  loss: 1.0956 -> 1.0883   acc: 70.00% -> 72.00%             
client [60] (test)  loss: 1.4330 -> 1.4920   acc: 65.28% -> 65.48%             
client [82] (test)  loss: 1.3510 -> 1.6024   acc: 66.48% -> 64.80%             
client [91] (test)  loss: 1.5991 -> 1.7137   acc: 61.72% -> 59.75%             
client [57] (test)  loss: 0.9541 -> 0.9958   acc: 76.14% -> 76.43%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.3672 -> 1.4361   acc: 69.05% -> 67.52%             
client [15] (test)  loss: 0.8314 -> 0.9727   acc: 78.01% -> 77.60%             
client [71] (test)  loss: 1.2152 -> 1.4609   acc: 72.43% -> 72.24%             
client [97] (test)  loss: 1.3963 -> 1.5829   acc: 69.01% -> 66.71%             
client [53] (test)  loss: 1.2227 -> 1.3264   acc: 69.08% -> 69.31%             
client [77] (test)  loss: 1.1962 -> 1.3621   acc: 70.62% -> 71.40%             
client [76] (test)  loss: 0.9738 -> 1.1770   acc: 76.96% -> 76.46%             
client [79] (test)  loss: 1.3881 -> 1.5006   acc: 67.25% -> 67.69%             
client [28] (test)  loss: 1.3881 -> 1.4209   acc: 70.57% -> 69.56%             
client [99] (test)  loss: 0.9571 -> 1.1552   acc: 76.01% -> 75.67%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.3946 -> 1.6101   acc: 67.28% -> 67.05%             
client [86] (test)  loss: 1.3540 -> 1.5319   acc: 67.79% -> 68.16%             
client [34] (test)  loss: 1.2164 -> 1.3835   acc: 72.62% -> 73.46%             
client [73] (test)  loss: 1.3568 -> 1.4833   acc: 65.08% -> 64.92%             
client [5] (test)  loss: 1.3276 -> 1.4878   acc: 67.40% -> 68.83%              
client [96] (test)  loss: 1.4442 -> 1.6622   acc: 65.86% -> 67.17%             
client [22] (test)  loss: 1.0142 -> 1.1967   acc: 76.44% -> 74.71%             
client [60] (test)  loss: 1.4646 -> 1.5930   acc: 64.68% -> 65.77%             
client [66] (test)  loss: 0.9343 -> 1.0785   acc: 75.94% -> 75.36%             
client [83] (test)  loss: 1.1050 -> 1.2670   acc: 74.45% -> 75.63%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0427 -> 1.2561   acc: 76.76% -> 77.01%             
client [65] (test)  loss: 1.2773 -> 1.4003   acc: 71.03% -> 69.98%             
client [95] (test)  loss: 1.4669 -> 1.6674   acc: 67.53% -> 66.96%             
client [17] (test)  loss: 0.9458 -> 1.0570   acc: 75.99% -> 76.13%             
client [8] (test)  loss: 0.8498 -> 1.0033   acc: 80.33% -> 81.53%              
client [35] (test)  loss: 1.3592 -> 1.3862   acc: 71.29% -> 71.13%             
client [98] (test)  loss: 1.6642 -> 1.8751   acc: 63.29% -> 61.40%             
client [53] (test)  loss: 1.2475 -> 1.3976   acc: 69.69% -> 69.77%             
client [43] (test)  loss: 0.6879 -> 0.8197   acc: 84.24% -> 84.89%             
client [64] (test)  loss: 1.2461 -> 1.3940   acc: 70.80% -> 70.69%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.0581 -> 1.2058   acc: 73.31% -> 73.67%             
client [88] (test)  loss: 1.1357 -> 1.1523   acc: 72.00% -> 74.00%             
client [38] (test)  loss: 1.2258 -> 1.2555   acc: 72.99% -> 74.08%             
client [3] (test)  loss: 1.5619 -> 1.6910   acc: 68.27% -> 66.20%              
client [5] (test)  loss: 1.4192 -> 1.5227   acc: 68.53% -> 69.37%              
client [41] (test)  loss: 1.7089 -> 1.9324   acc: 63.43% -> 64.16%             
client [7] (test)  loss: 0.9169 -> 0.9553   acc: 77.88% -> 76.53%              
client [37] (test)  loss: 1.2499 -> 1.2393   acc: 73.40% -> 73.18%             
client [45] (test)  loss: 1.3437 -> 1.4233   acc: 68.18% -> 66.51%             
client [47] (test)  loss: 0.9676 -> 0.9829   acc: 78.65% -> 79.09%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.1922 -> 1.3489   acc: 73.38% -> 72.25%             
client [11] (test)  loss: 1.3217 -> 1.4664   acc: 72.61% -> 72.52%             
client [37] (test)  loss: 1.2113 -> 1.2914   acc: 73.55% -> 73.40%             
client [41] (test)  loss: 1.6869 -> 1.9218   acc: 62.78% -> 64.59%             
client [95] (test)  loss: 1.5262 -> 1.7569   acc: 66.33% -> 66.84%             
client [53] (test)  loss: 1.2920 -> 1.3889   acc: 70.92% -> 69.85%             
client [22] (test)  loss: 1.0637 -> 1.2384   acc: 77.23% -> 75.22%             
client [25] (test)  loss: 1.6405 -> 1.7932   acc: 62.83% -> 60.97%             
client [69] (test)  loss: 1.4732 -> 1.7260   acc: 69.16% -> 69.09%             
client [46] (test)  loss: 1.2822 -> 1.3975   acc: 71.97% -> 70.07%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.0122 -> 1.1243   acc: 78.57% -> 78.87%             
client [69] (test)  loss: 1.5817 -> 1.7540   acc: 69.87% -> 69.44%             
client [82] (test)  loss: 1.5674 -> 1.6790   acc: 66.39% -> 66.57%             
client [45] (test)  loss: 1.3884 -> 1.5437   acc: 68.18% -> 66.19%             
client [7] (test)  loss: 0.9698 -> 0.9610   acc: 78.43% -> 77.48%              
client [50] (test)  loss: 1.3438 -> 1.4450   acc: 67.81% -> 65.04%             
client [35] (test)  loss: 1.4931 -> 1.5581   acc: 72.06% -> 70.13%             
client [24] (test)  loss: 1.2845 -> 1.4894   acc: 74.32% -> 75.47%             
client [15] (test)  loss: 0.9138 -> 1.0096   acc: 79.03% -> 78.52%             
client [58] (test)  loss: 1.6034 -> 1.8589   acc: 67.85% -> 66.67%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.4067 -> 1.5589   acc: 70.74% -> 71.90%             
client [76] (test)  loss: 1.2069 -> 1.3771   acc: 76.51% -> 76.61%             
client [67] (test)  loss: 1.6001 -> 1.7225   acc: 66.22% -> 64.04%             
client [37] (test)  loss: 1.3395 -> 1.3091   acc: 73.48% -> 73.55%             
client [58] (test)  loss: 1.6434 -> 1.8902   acc: 67.55% -> 66.86%             
client [64] (test)  loss: 1.4160 -> 1.5748   acc: 70.05% -> 70.05%             
client [77] (test)  loss: 1.3964 -> 1.4872   acc: 72.37% -> 71.50%             
client [55] (test)  loss: 1.6924 -> 1.8100   acc: 65.55% -> 65.41%             
client [12] (test)  loss: 1.2827 -> 1.4202   acc: 74.53% -> 72.28%             
client [89] (test)  loss: 1.3872 -> 1.5962   acc: 71.78% -> 72.79%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.4286 -> 1.6781   acc: 71.85% -> 72.79%             
client [51] (test)  loss: 1.4866 -> 1.5379   acc: 71.81% -> 72.66%             
client [8] (test)  loss: 0.9467 -> 1.1004   acc: 81.29% -> 81.45%              
client [18] (test)  loss: 1.1518 -> 1.2089   acc: 75.35% -> 76.97%             
client [94] (test)  loss: 1.0891 -> 1.1761   acc: 78.76% -> 77.76%             
client [81] (test)  loss: 1.5015 -> 1.6658   acc: 71.98% -> 70.58%             
client [3] (test)  loss: 1.7063 -> 1.8946   acc: 67.23% -> 66.48%              
client [11] (test)  loss: 1.4320 -> 1.5749   acc: 73.04% -> 71.91%             
client [95] (test)  loss: 1.7223 -> 1.8631   acc: 67.34% -> 65.63%             
client [67] (test)  loss: 1.5903 -> 1.8080   acc: 65.69% -> 64.34%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1690 -> 1.2483   acc: 71.98% -> 74.40%             
client [79] (test)  loss: 1.6576 -> 1.8000   acc: 68.21% -> 67.84%             
client [58] (test)  loss: 1.7182 -> 1.9010   acc: 67.06% -> 66.86%             
client [88] (test)  loss: 1.2234 -> 1.3430   acc: 71.33% -> 70.89%             
client [46] (test)  loss: 1.4057 -> 1.4890   acc: 70.44% -> 71.02%             
client [11] (test)  loss: 1.4512 -> 1.5956   acc: 73.22% -> 71.83%             
client [55] (test)  loss: 1.8124 -> 2.0384   acc: 64.94% -> 65.61%             
client [13] (test)  loss: 1.5262 -> 1.7083   acc: 71.15% -> 69.82%             
client [31] (test)  loss: 1.5996 -> 1.5592   acc: 69.26% -> 67.52%             
client [75] (test)  loss: 0.5930 -> 0.6534   acc: 88.34% -> 89.74%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.6590 -> 1.8729   acc: 67.15% -> 64.95%             
client [7] (test)  loss: 1.0664 -> 1.1817   acc: 77.48% -> 77.20%              
client [57] (test)  loss: 1.1053 -> 1.1978   acc: 77.69% -> 77.41%             
client [13] (test)  loss: 1.6381 -> 1.8210   acc: 71.07% -> 69.27%             
client [43] (test)  loss: 0.7921 -> 0.9177   acc: 84.60% -> 84.97%             
client [91] (test)  loss: 1.9861 -> 1.8843   acc: 60.59% -> 63.91%             
client [10] (test)  loss: 1.2668 -> 1.3209   acc: 75.43% -> 74.83%             
client [64] (test)  loss: 1.5822 -> 1.7346   acc: 70.59% -> 70.48%             
client [82] (test)  loss: 1.7005 -> 1.9470   acc: 66.85% -> 66.39%             
client [22] (test)  loss: 1.2407 -> 1.3777   acc: 76.66% -> 76.01%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.8941 -> 2.0021   acc: 68.27% -> 65.91%             
client [23] (test)  loss: 1.4545 -> 1.4625   acc: 73.36% -> 72.40%             
client [88] (test)  loss: 1.3047 -> 1.3937   acc: 73.11% -> 72.67%             
client [98] (test)  loss: 2.1502 -> 2.2446   acc: 63.68% -> 62.57%             
client [79] (test)  loss: 1.8532 -> 1.8650   acc: 67.55% -> 68.80%             
client [21] (test)  loss: 1.2393 -> 1.3672   acc: 73.31% -> 72.89%             
client [92] (test)  loss: 2.1790 -> 2.3646   acc: 57.83% -> 54.46%             
client [56] (test)  loss: 1.9495 -> 1.9484   acc: 64.41% -> 62.24%             
client [5] (test)  loss: 1.7291 -> 1.7894   acc: 69.19% -> 69.55%              
client [52] (test)  loss: 1.2839 -> 1.4428   acc: 74.80% -> 74.58%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '1.2496 -> 0.0000', 'accuracy': '70.71% -> 0.00%'},          
    200: {'loss': '1.6063 -> 0.0000', 'accuracy': '71.18% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(14.82%) at epoch: 1                                      
FedPer achieved 30.0%(33.35%) at epoch: 2                                      
FedPer achieved 40.0%(46.03%) at epoch: 3                                      
FedPer achieved 50.0%(53.37%) at epoch: 7                                      
FedPer achieved 60.0%(60.92%) at epoch: 18                                     
FedPer achieved 70.0%(70.86%) at epoch: 48                                     
Convergence (test_after):                                                      
FedPer achieved 50.0%(53.67%) at epoch: 0                                      
FedPer achieved 60.0%(63.14%) at epoch: 3                                      
FedPer achieved 70.0%(71.98%) at epoch: 23                                     
