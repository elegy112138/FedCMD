==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0829 -> 1.7481   acc: 20.16% -> 39.52%             
client [81] (test)  loss: 1.8606 -> 1.6389   acc: 35.25% -> 36.89%             
client [21] (test)  loss: 2.3269 -> 1.3453   acc: 18.49% -> 57.98%             
client [68] (test)  loss: 1.7018 -> 1.9625   acc: 30.30% -> 30.30%             
client [93] (test)  loss: 0.9575 -> 0.8421   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.4324 -> 2.0645   acc: 10.26% -> 20.51%             
client [20] (test)  loss: 1.8273 -> 1.6923   acc: 33.09% -> 33.81%             
client [59] (test)  loss: 1.9255 -> 1.5060   acc: 36.22% -> 36.22%             
client [48] (test)  loss: 2.0593 -> 1.8805   acc: 14.55% -> 34.55%             
client [34] (test)  loss: 1.6933 -> 1.6837   acc: 33.10% -> 34.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.0493 -> 0.9439   acc: 67.86% -> 63.39%             
client [99] (test)  loss: 1.1689 -> 1.1119   acc: 54.55% -> 60.23%             
client [67] (test)  loss: 1.2024 -> 1.3374   acc: 50.00% -> 42.06%             
client [0] (test)  loss: 0.8243 -> 1.2449   acc: 74.57% -> 53.18%              
client [76] (test)  loss: 0.6355 -> 1.0475   acc: 78.48% -> 67.09%             
client [41] (test)  loss: 0.9165 -> 1.2358   acc: 72.13% -> 57.38%             
client [62] (test)  loss: 1.6159 -> 0.8605   acc: 42.25% -> 74.65%             
client [2] (test)  loss: 0.6332 -> 0.3793   acc: 81.38% -> 85.52%              
client [14] (test)  loss: 0.6787 -> 0.6070   acc: 75.59% -> 81.10%             
client [46] (test)  loss: 1.1667 -> 1.3207   acc: 64.96% -> 64.10%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6309 -> 0.6241   acc: 78.57% -> 75.00%             
client [68] (test)  loss: 0.5179 -> 0.4381   acc: 87.88% -> 85.86%             
client [57] (test)  loss: 0.7547 -> 0.8839   acc: 73.68% -> 68.42%             
client [17] (test)  loss: 0.6617 -> 0.7667   acc: 76.92% -> 76.92%             
client [54] (test)  loss: 1.0684 -> 1.1903   acc: 62.16% -> 51.35%             
client [23] (test)  loss: 0.7190 -> 0.5756   acc: 71.62% -> 81.08%             
client [35] (test)  loss: 0.6633 -> 0.6551   acc: 78.57% -> 78.57%             
client [59] (test)  loss: 0.5647 -> 0.6130   acc: 75.59% -> 74.02%             
client [31] (test)  loss: 1.0867 -> 1.4163   acc: 70.51% -> 65.38%             
client [9] (test)  loss: 0.5650 -> 0.9204   acc: 82.47% -> 73.20%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4502 -> 0.4345   acc: 83.20% -> 78.40%             
client [33] (test)  loss: 0.4437 -> 0.3966   acc: 85.05% -> 85.98%             
client [16] (test)  loss: 0.6019 -> 0.5249   acc: 83.33% -> 84.72%             
client [44] (test)  loss: 0.6697 -> 0.6752   acc: 74.07% -> 77.04%             
client [8] (test)  loss: 0.3567 -> 0.3044   acc: 84.72% -> 86.11%              
client [31] (test)  loss: 1.0908 -> 1.1568   acc: 73.08% -> 74.36%             
client [47] (test)  loss: 0.4487 -> 0.4602   acc: 86.55% -> 84.87%             
client [36] (test)  loss: 0.7905 -> 0.6923   acc: 67.52% -> 74.36%             
client [20] (test)  loss: 0.7173 -> 0.8525   acc: 73.38% -> 70.50%             
client [56] (test)  loss: 0.5339 -> 0.5686   acc: 77.78% -> 75.21%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4280 -> 0.5234   acc: 80.17% -> 77.59%              
client [60] (test)  loss: 0.4097 -> 0.5140   acc: 82.89% -> 81.58%             
client [28] (test)  loss: 0.3800 -> 0.4527   acc: 82.26% -> 80.65%             
client [25] (test)  loss: 0.4942 -> 0.5846   acc: 82.64% -> 80.99%             
client [58] (test)  loss: 0.2966 -> 0.3237   acc: 94.38% -> 93.75%             
client [44] (test)  loss: 0.3562 -> 0.3836   acc: 87.41% -> 87.41%             
client [39] (test)  loss: 0.1070 -> 0.1086   acc: 97.14% -> 97.14%             
client [29] (test)  loss: 0.4487 -> 0.4953   acc: 87.39% -> 85.71%             
client [3] (test)  loss: 0.5408 -> 0.5581   acc: 80.51% -> 79.66%              
client [84] (test)  loss: 0.1630 -> 0.1383   acc: 93.25% -> 95.09%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2896 -> 0.4046   acc: 90.76% -> 89.08%             
client [84] (test)  loss: 0.1581 -> 0.1269   acc: 94.48% -> 94.48%             
client [10] (test)  loss: 0.3262 -> 0.3384   acc: 76.92% -> 76.92%             
client [36] (test)  loss: 0.5798 -> 2.5853   acc: 79.49% -> 32.48%             
client [65] (test)  loss: 0.7648 -> 0.7932   acc: 74.58% -> 70.34%             
client [81] (test)  loss: 0.5153 -> 0.5013   acc: 81.97% -> 78.69%             
client [79] (test)  loss: 0.3292 -> 0.3553   acc: 88.89% -> 89.74%             
client [42] (test)  loss: 0.4135 -> 0.4548   acc: 86.72% -> 85.94%             
client [11] (test)  loss: 0.5219 -> 0.5091   acc: 84.09% -> 85.61%             
client [96] (test)  loss: 0.4817 -> 0.5215   acc: 79.83% -> 78.15%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2903 -> 0.2575   acc: 90.28% -> 92.36%              
client [53] (test)  loss: 0.2441 -> 0.2279   acc: 91.60% -> 93.28%             
client [52] (test)  loss: 0.3245 -> 0.3245   acc: 89.15% -> 90.70%             
client [42] (test)  loss: 0.3416 -> 0.4146   acc: 88.28% -> 86.72%             
client [69] (test)  loss: 0.4044 -> 0.3764   acc: 82.14% -> 86.61%             
client [59] (test)  loss: 0.3676 -> 0.4509   acc: 81.10% -> 81.89%             
client [7] (test)  loss: 0.5597 -> 0.5363   acc: 81.48% -> 80.00%              
client [26] (test)  loss: 0.3510 -> 0.5512   acc: 89.23% -> 79.23%             
client [49] (test)  loss: 0.2016 -> 0.2085   acc: 92.65% -> 94.12%             
client [98] (test)  loss: 0.4950 -> 0.5904   acc: 85.96% -> 80.70%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4476 -> 0.5432   acc: 86.84% -> 83.33%             
client [47] (test)  loss: 0.3603 -> 0.3372   acc: 89.08% -> 92.44%             
client [21] (test)  loss: 0.2803 -> 0.3584   acc: 89.92% -> 89.08%             
client [77] (test)  loss: 0.5156 -> 0.7114   acc: 83.06% -> 79.03%             
client [95] (test)  loss: 0.2482 -> 0.3044   acc: 91.06% -> 92.18%             
client [91] (test)  loss: 0.5130 -> 0.6128   acc: 80.95% -> 79.37%             
client [14] (test)  loss: 0.2149 -> 0.1809   acc: 90.55% -> 91.34%             
client [99] (test)  loss: 0.4084 -> 0.5096   acc: 88.64% -> 86.36%             
client [20] (test)  loss: 0.5021 -> 0.5393   acc: 85.61% -> 83.45%             
client [39] (test)  loss: 0.0827 -> 0.1152   acc: 97.86% -> 96.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3005 -> 0.3239   acc: 92.25% -> 91.47%             
client [62] (test)  loss: 0.2490 -> 0.3285   acc: 91.55% -> 91.55%             
client [71] (test)  loss: 0.3525 -> 0.4318   acc: 84.73% -> 82.44%             
client [97] (test)  loss: 0.1194 -> 0.1332   acc: 95.97% -> 95.30%             
client [30] (test)  loss: 0.4133 -> 0.5023   acc: 92.13% -> 91.34%             
client [88] (test)  loss: 0.2998 -> 0.4166   acc: 90.44% -> 87.50%             
client [60] (test)  loss: 0.3265 -> 0.3541   acc: 89.47% -> 88.16%             
client [82] (test)  loss: 0.1720 -> 0.1867   acc: 95.90% -> 95.08%             
client [91] (test)  loss: 0.5145 -> 0.6339   acc: 85.71% -> 74.60%             
client [57] (test)  loss: 0.3278 -> 0.4017   acc: 91.81% -> 86.55%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2666 -> 1.1911   acc: 76.92% -> 76.92%             
client [15] (test)  loss: 0.3533 -> 0.4560   acc: 87.79% -> 83.97%             
client [71] (test)  loss: 0.3266 -> 0.3854   acc: 84.73% -> 85.50%             
client [97] (test)  loss: 0.1135 -> 0.1243   acc: 95.97% -> 95.97%             
client [53] (test)  loss: 0.2256 -> 0.1935   acc: 94.12% -> 93.28%             
client [77] (test)  loss: 0.5221 -> 0.7262   acc: 83.87% -> 79.03%             
client [76] (test)  loss: 0.2655 -> 0.2984   acc: 91.14% -> 93.67%             
client [79] (test)  loss: 0.2549 -> 0.2689   acc: 89.74% -> 90.60%             
client [28] (test)  loss: 0.3168 -> 0.3075   acc: 88.71% -> 88.71%             
client [99] (test)  loss: 0.4122 -> 0.4809   acc: 87.50% -> 87.50%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1379 -> 0.1396   acc: 95.30% -> 95.30%             
client [86] (test)  loss: 0.0738 -> 0.0700   acc: 97.56% -> 97.56%             
client [34] (test)  loss: 0.4479 -> 0.4739   acc: 85.21% -> 86.62%             
client [73] (test)  loss: 0.4691 -> 0.6170   acc: 85.60% -> 84.00%             
client [5] (test)  loss: 0.5072 -> 0.5857   acc: 83.81% -> 81.90%              
client [96] (test)  loss: 0.4056 -> 0.3599   acc: 85.71% -> 86.55%             
client [22] (test)  loss: 0.3787 -> 0.5000   acc: 89.72% -> 85.98%             
client [60] (test)  loss: 0.3315 -> 0.3981   acc: 92.11% -> 89.47%             
client [66] (test)  loss: 0.4050 -> 0.3932   acc: 86.29% -> 88.71%             
client [83] (test)  loss: 0.4559 -> 0.5290   acc: 85.84% -> 85.84%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2835 -> 0.2865   acc: 92.41% -> 93.67%             
client [65] (test)  loss: 0.5238 -> 0.5748   acc: 83.05% -> 81.36%             
client [95] (test)  loss: 0.2474 -> 0.2687   acc: 92.18% -> 93.85%             
client [17] (test)  loss: 0.2536 -> 0.3496   acc: 92.31% -> 89.42%             
client [8] (test)  loss: 0.2733 -> 0.2368   acc: 91.67% -> 91.67%              
client [35] (test)  loss: 0.1210 -> 0.1296   acc: 95.24% -> 95.24%             
client [98] (test)  loss: 0.4626 -> 0.5233   acc: 88.60% -> 85.96%             
client [53] (test)  loss: 0.1959 -> 0.1898   acc: 93.28% -> 94.12%             
client [43] (test)  loss: 0.1903 -> 0.2400   acc: 95.69% -> 94.74%             
client [64] (test)  loss: 0.1903 -> 0.2193   acc: 92.80% -> 92.00%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2698 -> 0.2982   acc: 92.44% -> 93.28%             
client [88] (test)  loss: 0.2702 -> 0.3252   acc: 91.18% -> 88.97%             
client [38] (test)  loss: 0.4792 -> 0.5741   acc: 86.90% -> 83.33%             
client [3] (test)  loss: 0.4002 -> 0.4576   acc: 80.51% -> 80.51%              
client [5] (test)  loss: 0.4753 -> 0.5677   acc: 85.71% -> 83.81%              
client [41] (test)  loss: 0.2611 -> 0.3639   acc: 91.80% -> 90.16%             
client [7] (test)  loss: 0.4517 -> 0.4031   acc: 85.93% -> 88.15%              
client [37] (test)  loss: 0.3423 -> 0.4382   acc: 89.62% -> 88.68%             
client [45] (test)  loss: 0.2234 -> 0.2338   acc: 91.92% -> 93.94%             
client [47] (test)  loss: 0.3755 -> 0.3454   acc: 91.60% -> 93.28%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3237 -> 0.3622   acc: 91.67% -> 94.44%             
client [11] (test)  loss: 0.3572 -> 0.3250   acc: 91.67% -> 91.67%             
client [37] (test)  loss: 0.3610 -> 0.4305   acc: 89.15% -> 89.15%             
client [41] (test)  loss: 0.2625 -> 0.3678   acc: 93.44% -> 90.16%             
client [95] (test)  loss: 0.2193 -> 0.2481   acc: 94.41% -> 93.85%             
client [53] (test)  loss: 0.2151 -> 0.1969   acc: 94.12% -> 94.12%             
client [22] (test)  loss: 0.3978 -> 0.4362   acc: 89.72% -> 90.65%             
client [25] (test)  loss: 0.3550 -> 0.3813   acc: 90.91% -> 90.08%             
client [69] (test)  loss: 0.3214 -> 0.3463   acc: 91.07% -> 91.07%             
client [46] (test)  loss: 0.3086 -> 0.3527   acc: 89.74% -> 87.18%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3721 -> 0.3467   acc: 92.44% -> 93.28%             
client [69] (test)  loss: 0.3385 -> 0.3655   acc: 89.29% -> 91.96%             
client [82] (test)  loss: 0.1627 -> 0.1657   acc: 95.08% -> 95.08%             
client [45] (test)  loss: 0.1991 -> 0.2233   acc: 91.92% -> 92.93%             
client [7] (test)  loss: 0.4784 -> 0.4065   acc: 87.41% -> 87.41%              
client [50] (test)  loss: 0.0337 -> 0.0336   acc: 99.26% -> 98.52%             
client [35] (test)  loss: 0.0771 -> 0.1036   acc: 96.43% -> 95.24%             
client [24] (test)  loss: 0.3428 -> 0.3758   acc: 85.71% -> 87.50%             
client [15] (test)  loss: 0.3980 -> 0.4866   acc: 89.31% -> 84.73%             
client [58] (test)  loss: 0.3606 -> 0.3835   acc: 95.62% -> 95.62%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7212 -> 0.7224   acc: 83.64% -> 83.64%             
client [76] (test)  loss: 0.2181 -> 0.2479   acc: 94.94% -> 94.94%             
client [67] (test)  loss: 0.2885 -> 0.3179   acc: 90.48% -> 90.48%             
client [37] (test)  loss: 0.3939 -> 0.4246   acc: 88.21% -> 88.68%             
client [58] (test)  loss: 0.3553 -> 0.3873   acc: 95.00% -> 95.00%             
client [64] (test)  loss: 0.1823 -> 0.2261   acc: 95.20% -> 90.40%             
client [77] (test)  loss: 0.5109 -> 0.6191   acc: 87.10% -> 84.68%             
client [55] (test)  loss: 0.2390 -> 0.3172   acc: 94.44% -> 95.24%             
client [12] (test)  loss: 0.5654 -> 0.6501   acc: 83.57% -> 83.57%             
client [89] (test)  loss: 0.3573 -> 0.3967   acc: 90.58% -> 89.86%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1136 -> 0.1172   acc: 95.71% -> 95.71%             
client [51] (test)  loss: 0.2702 -> 0.2986   acc: 94.84% -> 93.55%             
client [8] (test)  loss: 0.2131 -> 0.2058   acc: 91.67% -> 93.75%              
client [18] (test)  loss: 0.5804 -> 0.6863   acc: 82.47% -> 81.44%             
client [94] (test)  loss: 0.0483 -> 0.0681   acc: 97.50% -> 96.67%             
client [81] (test)  loss: 0.3192 -> 0.3479   acc: 86.89% -> 84.43%             
client [3] (test)  loss: 0.3525 -> 0.4346   acc: 87.29% -> 83.90%              
client [11] (test)  loss: 0.3779 -> 0.2975   acc: 93.18% -> 92.42%             
client [95] (test)  loss: 0.2192 -> 0.2508   acc: 93.85% -> 94.41%             
client [67] (test)  loss: 0.2746 -> 0.3112   acc: 91.27% -> 89.68%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2636 -> 0.3099   acc: 93.28% -> 93.28%             
client [79] (test)  loss: 0.1817 -> 0.1861   acc: 94.02% -> 93.16%             
client [58] (test)  loss: 0.3955 -> 0.4213   acc: 95.62% -> 95.62%             
client [88] (test)  loss: 0.2893 -> 0.3544   acc: 90.44% -> 90.44%             
client [46] (test)  loss: 0.3203 -> 0.3632   acc: 89.74% -> 88.89%             
client [11] (test)  loss: 0.3516 -> 0.2531   acc: 93.18% -> 91.67%             
client [55] (test)  loss: 0.3068 -> 0.3618   acc: 95.24% -> 92.86%             
client [13] (test)  loss: 0.6192 -> 0.6019   acc: 84.15% -> 82.93%             
client [31] (test)  loss: 1.3257 -> 1.3166   acc: 79.49% -> 78.21%             
client [75] (test)  loss: 0.3974 -> 0.4708   acc: 89.92% -> 86.55%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2301 -> 0.2461   acc: 91.60% -> 90.76%             
client [7] (test)  loss: 0.4451 -> 0.4739   acc: 89.63% -> 88.89%              
client [57] (test)  loss: 0.3983 -> 0.3944   acc: 91.81% -> 89.47%             
client [13] (test)  loss: 0.5424 -> 0.5662   acc: 81.71% -> 81.71%             
client [43] (test)  loss: 0.2388 -> 0.3229   acc: 95.69% -> 94.74%             
client [91] (test)  loss: 0.6136 -> 0.6861   acc: 85.71% -> 84.13%             
client [10] (test)  loss: 0.1188 -> 0.1083   acc: 94.87% -> 94.87%             
client [64] (test)  loss: 0.1712 -> 0.2013   acc: 94.40% -> 92.00%             
client [82] (test)  loss: 0.1537 -> 0.1663   acc: 95.08% -> 95.90%             
client [22] (test)  loss: 0.4638 -> 0.4840   acc: 89.72% -> 89.72%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4753 -> 0.4028   acc: 87.05% -> 89.21%             
client [23] (test)  loss: 0.3724 -> 0.4482   acc: 89.19% -> 83.78%             
client [88] (test)  loss: 0.2777 -> 0.3361   acc: 93.38% -> 91.91%             
client [98] (test)  loss: 0.5450 -> 0.6119   acc: 86.84% -> 84.21%             
client [79] (test)  loss: 0.1811 -> 0.1869   acc: 94.02% -> 93.16%             
client [21] (test)  loss: 0.2860 -> 0.2977   acc: 93.28% -> 93.28%             
client [92] (test)  loss: 0.2472 -> 0.2071   acc: 93.85% -> 94.62%             
client [56] (test)  loss: 0.3863 -> 0.4438   acc: 88.89% -> 90.60%             
client [5] (test)  loss: 0.5701 -> 0.6224   acc: 87.62% -> 80.95%              
client [52] (test)  loss: 0.3132 -> 0.3658   acc: 93.80% -> 93.80%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3317 -> 0.0000', 'accuracy': '89.95% -> 0.00%'},          
    200: {'loss': '0.3334 -> 0.0000', 'accuracy': '91.52% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 20.0%(21.90%) at epoch: 0                                      
FedPer achieved 30.0%(30.46%) at epoch: 7                                      
FedPer achieved 40.0%(41.50%) at epoch: 12                                     
FedPer achieved 50.0%(58.20%) at epoch: 13                                     
FedPer achieved 60.0%(62.27%) at epoch: 16                                     
FedPer achieved 70.0%(73.86%) at epoch: 20                                     
FedPer achieved 80.0%(80.23%) at epoch: 27                                     
FedPer achieved 90.0%(91.61%) at epoch: 75                                     
Convergence (test_after):                                                      
FedPer achieved 20.0%(26.89%) at epoch: 0                                      
FedPer achieved 30.0%(32.73%) at epoch: 3                                      
FedPer achieved 40.0%(40.29%) at epoch: 5                                      
FedPer achieved 50.0%(52.74%) at epoch: 11                                     
FedPer achieved 60.0%(63.93%) at epoch: 13                                     
FedPer achieved 70.0%(74.12%) at epoch: 20                                     
FedPer achieved 80.0%(82.17%) at epoch: 31                                     
FedPer achieved 90.0%(91.61%) at epoch: 75                                     
