==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5628 -> 0.5265   acc: 79.64% -> 76.43%             
client [81] (test)  loss: 0.7395 -> 0.7228   acc: 68.91% -> 67.79%             
client [21] (test)  loss: 0.5102 -> 0.4993   acc: 81.11% -> 84.44%             
client [68] (test)  loss: 0.6227 -> 0.8826   acc: 72.78% -> 65.19%             
client [93] (test)  loss: 0.7164 -> 0.4699   acc: 70.79% -> 83.17%             
client [31] (test)  loss: 1.0716 -> 0.7246   acc: 56.46% -> 72.76%             
client [20] (test)  loss: 0.7055 -> 0.7686   acc: 77.39% -> 77.71%             
client [59] (test)  loss: 0.4782 -> 0.4022   acc: 84.29% -> 86.00%             
client [48] (test)  loss: 0.2975 -> 0.2770   acc: 86.35% -> 88.19%             
client [34] (test)  loss: 0.5218 -> 0.5877   acc: 79.08% -> 77.72%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3346 -> 0.3069   acc: 85.97% -> 90.39%             
client [99] (test)  loss: 0.3454 -> 0.3151   acc: 88.70% -> 89.55%             
client [67] (test)  loss: 0.3572 -> 0.3690   acc: 87.41% -> 88.66%             
client [0] (test)  loss: 0.4360 -> 0.4505   acc: 84.57% -> 84.57%              
client [76] (test)  loss: 0.3301 -> 0.3215   acc: 89.29% -> 89.51%             
client [41] (test)  loss: 0.6159 -> 0.6131   acc: 77.49% -> 78.23%             
client [62] (test)  loss: 0.5050 -> 0.4932   acc: 84.40% -> 83.79%             
client [2] (test)  loss: 0.5354 -> 0.5376   acc: 78.09% -> 81.82%              
client [14] (test)  loss: 0.4462 -> 0.4753   acc: 82.62% -> 84.38%             
client [46] (test)  loss: 0.3531 -> 0.3271   acc: 86.59% -> 87.76%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3525 -> 0.4875   acc: 88.66% -> 85.89%             
client [68] (test)  loss: 0.4205 -> 0.5543   acc: 83.54% -> 81.01%             
client [57] (test)  loss: 0.3394 -> 0.3691   acc: 90.61% -> 88.81%             
client [17] (test)  loss: 0.3095 -> 0.2847   acc: 90.31% -> 91.10%             
client [54] (test)  loss: 0.2461 -> 0.2721   acc: 91.89% -> 91.65%             
client [23] (test)  loss: 0.6867 -> 0.3772   acc: 78.13% -> 89.60%             
client [35] (test)  loss: 0.3342 -> 0.3306   acc: 88.62% -> 88.25%             
client [59] (test)  loss: 0.3344 -> 0.3130   acc: 89.43% -> 90.00%             
client [31] (test)  loss: 0.5692 -> 0.5948   acc: 75.94% -> 78.13%             
client [9] (test)  loss: 0.3685 -> 0.4899   acc: 86.15% -> 83.63%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4674 -> 0.4568   acc: 83.00% -> 83.00%             
client [33] (test)  loss: 0.2962 -> 0.4092   acc: 87.84% -> 85.41%             
client [16] (test)  loss: 0.2486 -> 0.2304   acc: 92.93% -> 93.98%             
client [44] (test)  loss: 0.3551 -> 0.3309   acc: 86.34% -> 88.33%             
client [8] (test)  loss: 0.3593 -> 0.5034   acc: 88.39% -> 82.90%              
client [31] (test)  loss: 0.5717 -> 0.5776   acc: 76.74% -> 78.13%             
client [47] (test)  loss: 0.4898 -> 0.6367   acc: 80.90% -> 77.15%             
client [36] (test)  loss: 0.4500 -> 0.4575   acc: 82.82% -> 84.66%             
client [20] (test)  loss: 0.5513 -> 0.6306   acc: 83.76% -> 82.80%             
client [56] (test)  loss: 0.4470 -> 0.5051   acc: 85.62% -> 84.69%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4867 -> 0.6419   acc: 81.70% -> 76.03%              
client [60] (test)  loss: 0.2811 -> 0.3017   acc: 91.58% -> 90.10%             
client [28] (test)  loss: 0.5433 -> 0.5627   acc: 82.95% -> 80.65%             
client [25] (test)  loss: 0.4310 -> 0.5147   acc: 84.43% -> 80.74%             
client [58] (test)  loss: 0.2457 -> 0.2534   acc: 91.36% -> 90.31%             
client [44] (test)  loss: 0.3174 -> 0.3200   acc: 89.43% -> 88.99%             
client [39] (test)  loss: 0.3747 -> 0.3980   acc: 87.19% -> 87.47%             
client [29] (test)  loss: 0.4279 -> 0.4784   acc: 87.72% -> 84.13%             
client [3] (test)  loss: 0.3306 -> 0.3466   acc: 85.95% -> 87.05%              
client [84] (test)  loss: 0.3390 -> 0.3355   acc: 88.41% -> 89.86%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3664 -> 0.4437   acc: 89.72% -> 87.22%             
client [84] (test)  loss: 0.3438 -> 0.3254   acc: 88.12% -> 89.57%             
client [10] (test)  loss: 0.2351 -> 0.2938   acc: 91.39% -> 91.67%             
client [36] (test)  loss: 0.4334 -> 0.4428   acc: 84.36% -> 84.05%             
client [65] (test)  loss: 0.2889 -> 0.3344   acc: 90.18% -> 88.39%             
client [81] (test)  loss: 0.4691 -> 0.5954   acc: 80.39% -> 79.27%             
client [79] (test)  loss: 0.3872 -> 0.4050   acc: 86.74% -> 85.64%             
client [42] (test)  loss: 0.4304 -> 0.4088   acc: 84.19% -> 84.65%             
client [11] (test)  loss: 0.4655 -> 0.5212   acc: 84.06% -> 85.14%             
client [96] (test)  loss: 0.2595 -> 0.3303   acc: 91.41% -> 90.03%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3284 -> 0.4684   acc: 88.39% -> 85.81%              
client [53] (test)  loss: 0.2094 -> 0.2063   acc: 92.98% -> 93.86%             
client [52] (test)  loss: 0.4275 -> 0.4217   acc: 86.98% -> 85.87%             
client [42] (test)  loss: 0.3896 -> 0.4480   acc: 86.05% -> 85.58%             
client [69] (test)  loss: 0.2081 -> 0.2402   acc: 92.99% -> 91.69%             
client [59] (test)  loss: 0.2669 -> 0.2661   acc: 93.14% -> 91.14%             
client [7] (test)  loss: 0.4446 -> 0.4895   acc: 86.94% -> 84.72%              
client [26] (test)  loss: 0.2800 -> 0.3034   acc: 90.53% -> 89.12%             
client [49] (test)  loss: 0.3793 -> 0.4064   acc: 88.31% -> 87.11%             
client [98] (test)  loss: 0.4354 -> 0.5730   acc: 84.44% -> 81.39%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4457 -> 0.6142   acc: 83.89% -> 78.33%             
client [47] (test)  loss: 0.4562 -> 0.6867   acc: 83.90% -> 76.78%             
client [21] (test)  loss: 0.3594 -> 0.4524   acc: 90.00% -> 88.06%             
client [77] (test)  loss: 0.3956 -> 0.4897   acc: 86.79% -> 85.00%             
client [95] (test)  loss: 0.3383 -> 0.4108   acc: 88.45% -> 87.04%             
client [91] (test)  loss: 0.4059 -> 0.3912   acc: 87.37% -> 88.42%             
client [14] (test)  loss: 0.3512 -> 0.4336   acc: 88.92% -> 88.16%             
client [99] (test)  loss: 0.2278 -> 0.3277   acc: 91.81% -> 89.55%             
client [20] (test)  loss: 0.5709 -> 0.6136   acc: 84.08% -> 84.08%             
client [39] (test)  loss: 0.3519 -> 0.4356   acc: 87.19% -> 87.47%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4496 -> 0.4871   acc: 84.21% -> 82.83%             
client [62] (test)  loss: 0.3636 -> 0.4295   acc: 88.99% -> 86.24%             
client [71] (test)  loss: 0.3352 -> 0.3679   acc: 90.40% -> 89.55%             
client [97] (test)  loss: 0.5499 -> 0.5330   acc: 82.84% -> 83.21%             
client [30] (test)  loss: 0.3123 -> 0.3691   acc: 91.55% -> 91.22%             
client [88] (test)  loss: 0.4728 -> 0.4657   acc: 84.57% -> 84.85%             
client [60] (test)  loss: 0.2504 -> 0.2779   acc: 93.07% -> 94.06%             
client [82] (test)  loss: 0.2673 -> 0.3075   acc: 91.79% -> 91.29%             
client [91] (test)  loss: 0.3861 -> 0.4198   acc: 87.37% -> 86.58%             
client [57] (test)  loss: 0.2996 -> 0.3440   acc: 90.97% -> 89.53%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6435 -> 0.6663   acc: 78.13% -> 77.73%             
client [15] (test)  loss: 0.3194 -> 0.4028   acc: 90.58% -> 88.92%             
client [71] (test)  loss: 0.3509 -> 0.3630   acc: 88.70% -> 90.11%             
client [97] (test)  loss: 0.5418 -> 0.5208   acc: 83.58% -> 84.70%             
client [53] (test)  loss: 0.1954 -> 0.1900   acc: 92.76% -> 94.74%             
client [77] (test)  loss: 0.3855 -> 0.4916   acc: 86.07% -> 85.71%             
client [76] (test)  loss: 0.2447 -> 0.2622   acc: 92.72% -> 92.72%             
client [79] (test)  loss: 0.3642 -> 0.4112   acc: 85.91% -> 87.02%             
client [28] (test)  loss: 0.5178 -> 0.5949   acc: 84.79% -> 82.03%             
client [99] (test)  loss: 0.2258 -> 0.3339   acc: 91.53% -> 89.83%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5472 -> 0.5119   acc: 84.70% -> 85.07%             
client [86] (test)  loss: 0.1628 -> 0.2034   acc: 94.42% -> 93.02%             
client [34] (test)  loss: 0.3286 -> 0.3724   acc: 89.67% -> 89.67%             
client [73] (test)  loss: 0.4124 -> 0.4763   acc: 88.66% -> 88.06%             
client [5] (test)  loss: 0.4076 -> 0.3927   acc: 86.97% -> 87.74%              
client [96] (test)  loss: 0.2714 -> 0.3115   acc: 91.97% -> 92.52%             
client [22] (test)  loss: 0.4050 -> 0.4847   acc: 86.45% -> 85.81%             
client [60] (test)  loss: 0.2320 -> 0.2728   acc: 93.32% -> 94.06%             
client [66] (test)  loss: 0.4427 -> 0.5795   acc: 86.30% -> 86.30%             
client [83] (test)  loss: 0.2250 -> 0.2506   acc: 92.27% -> 92.01%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2564 -> 0.2782   acc: 92.72% -> 92.29%             
client [65] (test)  loss: 0.3076 -> 0.3399   acc: 90.85% -> 89.73%             
client [95] (test)  loss: 0.3583 -> 0.4668   acc: 88.45% -> 86.76%             
client [17] (test)  loss: 0.3036 -> 0.3224   acc: 91.88% -> 91.62%             
client [8] (test)  loss: 0.3323 -> 0.4965   acc: 89.68% -> 86.13%              
client [35] (test)  loss: 0.3399 -> 0.3938   acc: 90.11% -> 88.81%             
client [98] (test)  loss: 0.4304 -> 0.5701   acc: 85.00% -> 81.67%             
client [53] (test)  loss: 0.1825 -> 0.2006   acc: 94.30% -> 94.74%             
client [43] (test)  loss: 0.1121 -> 0.1383   acc: 95.16% -> 94.62%             
client [64] (test)  loss: 0.4458 -> 0.5019   acc: 88.10% -> 83.00%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3555 -> 0.4780   acc: 90.28% -> 89.44%             
client [88] (test)  loss: 0.4825 -> 0.4729   acc: 84.30% -> 84.30%             
client [38] (test)  loss: 0.3432 -> 0.3747   acc: 90.88% -> 90.25%             
client [3] (test)  loss: 0.3654 -> 0.3928   acc: 87.88% -> 86.78%              
client [5] (test)  loss: 0.3937 -> 0.4090   acc: 86.59% -> 86.21%              
client [41] (test)  loss: 0.4712 -> 0.5285   acc: 84.87% -> 83.39%             
client [7] (test)  loss: 0.4947 -> 0.5210   acc: 86.67% -> 85.28%              
client [37] (test)  loss: 0.2929 -> 0.3446   acc: 91.06% -> 92.18%             
client [45] (test)  loss: 0.2754 -> 0.2874   acc: 88.74% -> 88.22%             
client [47] (test)  loss: 0.4929 -> 0.6280   acc: 85.02% -> 80.15%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2701 -> 0.2894   acc: 92.93% -> 93.72%             
client [11] (test)  loss: 0.4661 -> 0.4937   acc: 86.96% -> 86.96%             
client [37] (test)  loss: 0.3180 -> 0.3594   acc: 90.78% -> 92.46%             
client [41] (test)  loss: 0.4871 -> 0.5006   acc: 85.24% -> 84.13%             
client [95] (test)  loss: 0.3877 -> 0.4983   acc: 88.73% -> 86.48%             
client [53] (test)  loss: 0.2022 -> 0.2136   acc: 94.30% -> 94.74%             
client [22] (test)  loss: 0.4653 -> 0.5528   acc: 84.84% -> 84.52%             
client [25] (test)  loss: 0.4242 -> 0.4289   acc: 85.75% -> 86.81%             
client [69] (test)  loss: 0.2492 -> 0.2966   acc: 93.25% -> 91.95%             
client [46] (test)  loss: 0.3109 -> 0.3372   acc: 89.50% -> 90.67%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4886 -> 0.5492   acc: 86.52% -> 84.64%             
client [69] (test)  loss: 0.2612 -> 0.3142   acc: 92.47% -> 92.21%             
client [82] (test)  loss: 0.2935 -> 0.3035   acc: 91.29% -> 91.79%             
client [45] (test)  loss: 0.3186 -> 0.3205   acc: 88.22% -> 85.60%             
client [7] (test)  loss: 0.4893 -> 0.5090   acc: 86.67% -> 86.67%              
client [50] (test)  loss: 0.4530 -> 0.5039   acc: 85.71% -> 83.19%             
client [35] (test)  loss: 0.3583 -> 0.4172   acc: 89.55% -> 88.99%             
client [24] (test)  loss: 0.3565 -> 0.4300   acc: 90.93% -> 88.92%             
client [15] (test)  loss: 0.3640 -> 0.4313   acc: 90.30% -> 89.20%             
client [58] (test)  loss: 0.2177 -> 0.2706   acc: 92.67% -> 91.88%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2037 -> 0.2034   acc: 93.44% -> 93.70%             
client [76] (test)  loss: 0.2884 -> 0.3001   acc: 93.15% -> 92.72%             
client [67] (test)  loss: 0.3285 -> 0.3719   acc: 92.19% -> 92.19%             
client [37] (test)  loss: 0.3197 -> 0.3758   acc: 90.78% -> 92.46%             
client [58] (test)  loss: 0.2297 -> 0.2795   acc: 93.46% -> 92.15%             
client [64] (test)  loss: 0.4886 -> 0.4984   acc: 87.82% -> 83.57%             
client [77] (test)  loss: 0.4171 -> 0.4949   acc: 87.14% -> 85.71%             
client [55] (test)  loss: 0.3738 -> 0.4708   acc: 88.26% -> 87.48%             
client [12] (test)  loss: 0.5113 -> 0.5860   acc: 82.27% -> 83.18%             
client [89] (test)  loss: 0.3247 -> 0.3573   acc: 90.68% -> 91.00%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3576 -> 0.3874   acc: 89.57% -> 91.01%             
client [51] (test)  loss: 0.3808 -> 0.4657   acc: 88.89% -> 85.29%             
client [8] (test)  loss: 0.3479 -> 0.4563   acc: 90.65% -> 87.42%              
client [18] (test)  loss: 0.3245 -> 0.3759   acc: 92.40% -> 90.88%             
client [94] (test)  loss: 0.5161 -> 0.5139   acc: 83.88% -> 82.44%             
client [81] (test)  loss: 0.5336 -> 0.6711   acc: 84.03% -> 80.95%             
client [3] (test)  loss: 0.4437 -> 0.4143   acc: 86.23% -> 86.78%              
client [11] (test)  loss: 0.4628 -> 0.4689   acc: 87.68% -> 88.77%             
client [95] (test)  loss: 0.4101 -> 0.4937   acc: 88.73% -> 87.32%             
client [67] (test)  loss: 0.3399 -> 0.3900   acc: 91.94% -> 91.44%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3856 -> 0.5020   acc: 90.83% -> 90.83%             
client [79] (test)  loss: 0.3392 -> 0.4580   acc: 88.12% -> 85.91%             
client [58] (test)  loss: 0.2058 -> 0.2854   acc: 94.76% -> 91.88%             
client [88] (test)  loss: 0.5233 -> 0.5211   acc: 83.47% -> 83.75%             
client [46] (test)  loss: 0.3305 -> 0.3692   acc: 90.09% -> 91.84%             
client [11] (test)  loss: 0.4411 -> 0.4955   acc: 87.68% -> 87.68%             
client [55] (test)  loss: 0.3958 -> 0.5266   acc: 87.48% -> 87.48%             
client [13] (test)  loss: 0.2540 -> 0.3063   acc: 92.39% -> 90.29%             
client [31] (test)  loss: 0.6876 -> 0.6722   acc: 78.93% -> 78.93%             
client [75] (test)  loss: 0.2421 -> 0.3280   acc: 92.02% -> 88.34%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2282 -> 0.2513   acc: 91.72% -> 92.41%             
client [7] (test)  loss: 0.5243 -> 0.5475   acc: 86.94% -> 87.22%              
client [57] (test)  loss: 0.3045 -> 0.3238   acc: 92.78% -> 92.06%             
client [13] (test)  loss: 0.2695 -> 0.2910   acc: 91.86% -> 91.08%             
client [43] (test)  loss: 0.1144 -> 0.1392   acc: 95.16% -> 94.09%             
client [91] (test)  loss: 0.3663 -> 0.3545   acc: 88.68% -> 89.74%             
client [10] (test)  loss: 0.2563 -> 0.3002   acc: 91.94% -> 91.11%             
client [64] (test)  loss: 0.4896 -> 0.5301   acc: 87.25% -> 83.85%             
client [82] (test)  loss: 0.2972 -> 0.3305   acc: 92.04% -> 92.04%             
client [22] (test)  loss: 0.5069 -> 0.5963   acc: 83.87% -> 85.81%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6187 -> 0.6580   acc: 86.31% -> 85.67%             
client [23] (test)  loss: 0.3010 -> 0.4299   acc: 93.42% -> 91.72%             
client [88] (test)  loss: 0.5612 -> 0.5420   acc: 83.20% -> 82.92%             
client [98] (test)  loss: 0.4892 -> 0.6451   acc: 86.94% -> 83.61%             
client [79] (test)  loss: 0.3570 -> 0.4579   acc: 86.46% -> 85.08%             
client [21] (test)  loss: 0.3871 -> 0.4810   acc: 91.39% -> 91.11%             
client [92] (test)  loss: 0.5727 -> 0.5498   acc: 85.18% -> 86.25%             
client [56] (test)  loss: 0.5155 -> 0.5561   acc: 87.50% -> 87.81%             
client [5] (test)  loss: 0.4104 -> 0.4904   acc: 86.59% -> 85.82%              
client [52] (test)  loss: 0.3905 -> 0.4628   acc: 89.75% -> 85.04%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3590 -> 0.0000', 'accuracy': '88.38% -> 0.00%'},          
    200: {'loss': '0.4117 -> 0.0000', 'accuracy': '89.06% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(14.47%) at epoch: 0                                      
FedPer achieved 30.0%(37.26%) at epoch: 1                                      
FedPer achieved 60.0%(61.71%) at epoch: 2                                      
FedPer achieved 70.0%(72.98%) at epoch: 4                                      
FedPer achieved 80.0%(83.41%) at epoch: 13                                     
FedPer achieved 90.0%(90.38%) at epoch: 74                                     
Convergence (test_after):                                                      
FedPer achieved 70.0%(73.60%) at epoch: 0                                      
FedPer achieved 80.0%(80.89%) at epoch: 3                                      
FedPer achieved 90.0%(90.01%) at epoch: 74                                     
