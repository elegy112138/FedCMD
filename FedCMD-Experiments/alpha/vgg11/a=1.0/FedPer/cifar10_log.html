==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.1825 -> 1.3724   acc: 59.07% -> 55.44%             
client [81] (test)  loss: 2.1148 -> 1.6148   acc: 40.92% -> 51.38%             
client [21] (test)  loss: 1.4813 -> 1.3497   acc: 46.50% -> 57.14%             
client [68] (test)  loss: 1.4068 -> 1.4243   acc: 48.08% -> 54.81%             
client [93] (test)  loss: 1.3746 -> 1.3187   acc: 54.17% -> 59.23%             
client [31] (test)  loss: 3.0170 -> 1.3110   acc: 48.76% -> 57.95%             
client [20] (test)  loss: 1.3969 -> 1.0963   acc: 55.88% -> 66.18%             
client [59] (test)  loss: 1.4325 -> 1.5106   acc: 53.06% -> 53.35%             
client [48] (test)  loss: 1.1987 -> 1.1095   acc: 60.61% -> 67.22%             
client [34] (test)  loss: 1.5829 -> 1.5599   acc: 46.59% -> 52.32%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2100 -> 1.2734   acc: 60.36% -> 61.26%             
client [99] (test)  loss: 1.3110 -> 1.2850   acc: 55.66% -> 63.21%             
client [67] (test)  loss: 1.1413 -> 1.1042   acc: 67.46% -> 70.71%             
client [0] (test)  loss: 0.8869 -> 1.1122   acc: 71.19% -> 66.67%              
client [76] (test)  loss: 1.3758 -> 1.2249   acc: 59.80% -> 62.75%             
client [41] (test)  loss: 1.3238 -> 1.2399   acc: 57.62% -> 62.83%             
client [62] (test)  loss: 1.2249 -> 0.8644   acc: 62.59% -> 74.83%             
client [2] (test)  loss: 1.3603 -> 1.2302   acc: 56.06% -> 68.17%              
client [14] (test)  loss: 1.7458 -> 1.1311   acc: 53.94% -> 68.05%             
client [46] (test)  loss: 1.4152 -> 1.3076   acc: 60.33% -> 66.39%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0878 -> 1.0595   acc: 67.75% -> 70.41%             
client [68] (test)  loss: 1.2525 -> 1.4087   acc: 62.50% -> 62.18%             
client [57] (test)  loss: 1.1485 -> 1.4456   acc: 64.29% -> 61.01%             
client [17] (test)  loss: 1.6578 -> 1.1534   acc: 56.64% -> 69.19%             
client [54] (test)  loss: 1.1734 -> 1.3369   acc: 64.57% -> 65.92%             
client [23] (test)  loss: 1.4928 -> 1.2109   acc: 56.78% -> 62.78%             
client [35] (test)  loss: 2.4093 -> 1.2990   acc: 59.64% -> 65.09%             
client [59] (test)  loss: 1.2222 -> 1.4842   acc: 66.47% -> 63.27%             
client [31] (test)  loss: 1.3899 -> 1.0737   acc: 65.37% -> 69.96%             
client [9] (test)  loss: 1.0834 -> 1.1134   acc: 67.71% -> 71.16%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0325 -> 1.0633   acc: 71.43% -> 72.95%             
client [33] (test)  loss: 1.2479 -> 1.3911   acc: 60.73% -> 60.73%             
client [16] (test)  loss: 1.1328 -> 1.1377   acc: 64.22% -> 64.22%             
client [44] (test)  loss: 1.0621 -> 1.0483   acc: 71.57% -> 71.24%             
client [8] (test)  loss: 1.1060 -> 1.1465   acc: 70.53% -> 71.54%              
client [31] (test)  loss: 1.4424 -> 1.0717   acc: 66.78% -> 72.08%             
client [47] (test)  loss: 1.1212 -> 1.2403   acc: 70.10% -> 65.92%             
client [36] (test)  loss: 0.9563 -> 0.8551   acc: 69.54% -> 74.46%             
client [20] (test)  loss: 0.9252 -> 0.8635   acc: 73.90% -> 76.47%             
client [56] (test)  loss: 1.0326 -> 1.1285   acc: 77.10% -> 74.05%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8793 -> 1.0328   acc: 75.00% -> 71.98%              
client [60] (test)  loss: 0.7658 -> 0.7509   acc: 75.85% -> 79.24%             
client [28] (test)  loss: 0.8958 -> 0.9137   acc: 76.40% -> 77.02%             
client [25] (test)  loss: 1.2448 -> 1.1742   acc: 62.31% -> 66.77%             
client [58] (test)  loss: 1.0847 -> 1.2002   acc: 68.92% -> 70.46%             
client [44] (test)  loss: 0.8898 -> 0.9674   acc: 75.25% -> 72.58%             
client [39] (test)  loss: 0.9645 -> 0.8931   acc: 69.78% -> 73.78%             
client [29] (test)  loss: 1.0897 -> 1.2455   acc: 69.10% -> 68.59%             
client [3] (test)  loss: 1.3538 -> 1.0910   acc: 65.73% -> 69.76%              
client [84] (test)  loss: 0.9866 -> 1.0128   acc: 68.51% -> 72.73%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9318 -> 1.0538   acc: 69.91% -> 68.69%             
client [84] (test)  loss: 0.9320 -> 0.9972   acc: 71.10% -> 73.05%             
client [10] (test)  loss: 1.2192 -> 1.2904   acc: 65.15% -> 67.05%             
client [36] (test)  loss: 0.8113 -> 0.8412   acc: 74.77% -> 76.62%             
client [65] (test)  loss: 0.8454 -> 0.8722   acc: 75.79% -> 74.60%             
client [81] (test)  loss: 1.1286 -> 1.2577   acc: 67.08% -> 70.77%             
client [79] (test)  loss: 0.9711 -> 0.9600   acc: 72.38% -> 74.59%             
client [42] (test)  loss: 1.0364 -> 1.1385   acc: 71.99% -> 72.27%             
client [11] (test)  loss: 0.9241 -> 0.9239   acc: 71.54% -> 70.33%             
client [96] (test)  loss: 0.8122 -> 0.9039   acc: 73.98% -> 74.39%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.0920 -> 1.1009   acc: 72.54% -> 73.80%              
client [53] (test)  loss: 1.0675 -> 1.0479   acc: 70.00% -> 72.58%             
client [52] (test)  loss: 1.0953 -> 1.1842   acc: 73.65% -> 73.65%             
client [42] (test)  loss: 1.0350 -> 1.1457   acc: 71.71% -> 72.27%             
client [69] (test)  loss: 0.9644 -> 1.0930   acc: 76.58% -> 74.77%             
client [59] (test)  loss: 1.2513 -> 1.4744   acc: 70.26% -> 68.51%             
client [7] (test)  loss: 0.5251 -> 0.5488   acc: 86.04% -> 85.03%              
client [26] (test)  loss: 0.8916 -> 1.0187   acc: 78.37% -> 77.10%             
client [49] (test)  loss: 0.6685 -> 0.7442   acc: 82.65% -> 79.50%             
client [98] (test)  loss: 0.9521 -> 1.0175   acc: 72.27% -> 73.53%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9220 -> 1.0224   acc: 73.11% -> 71.85%             
client [47] (test)  loss: 1.1308 -> 1.2558   acc: 72.03% -> 68.81%             
client [21] (test)  loss: 0.9550 -> 1.0023   acc: 72.04% -> 71.43%             
client [77] (test)  loss: 1.2087 -> 1.1270   acc: 70.98% -> 71.50%             
client [95] (test)  loss: 1.0648 -> 1.1609   acc: 67.17% -> 68.39%             
client [91] (test)  loss: 0.6238 -> 0.6939   acc: 82.17% -> 80.50%             
client [14] (test)  loss: 1.0439 -> 1.1451   acc: 73.44% -> 74.27%             
client [99] (test)  loss: 1.2188 -> 1.2137   acc: 70.28% -> 66.98%             
client [20] (test)  loss: 0.7970 -> 0.8033   acc: 79.41% -> 78.68%             
client [39] (test)  loss: 0.8330 -> 0.8930   acc: 75.56% -> 78.22%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.0825 -> 1.1512   acc: 73.65% -> 74.60%             
client [62] (test)  loss: 0.8782 -> 0.9134   acc: 79.25% -> 79.59%             
client [71] (test)  loss: 1.2857 -> 1.2569   acc: 66.67% -> 70.27%             
client [97] (test)  loss: 1.0572 -> 1.1121   acc: 74.16% -> 73.41%             
client [30] (test)  loss: 0.9430 -> 1.2212   acc: 73.89% -> 72.11%             
client [88] (test)  loss: 1.2477 -> 1.2962   acc: 72.09% -> 70.43%             
client [60] (test)  loss: 0.6848 -> 0.7226   acc: 82.63% -> 80.08%             
client [82] (test)  loss: 0.9851 -> 1.0549   acc: 77.97% -> 76.22%             
client [91] (test)  loss: 0.6449 -> 0.7126   acc: 84.12% -> 81.62%             
client [57] (test)  loss: 1.0816 -> 1.4048   acc: 72.32% -> 68.75%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.1123 -> 1.0428   acc: 75.27% -> 74.91%             
client [15] (test)  loss: 0.7665 -> 0.8642   acc: 81.73% -> 76.92%             
client [71] (test)  loss: 1.4541 -> 1.3223   acc: 63.96% -> 69.82%             
client [97] (test)  loss: 1.0483 -> 1.1732   acc: 74.53% -> 74.16%             
client [53] (test)  loss: 1.1015 -> 1.0805   acc: 72.26% -> 72.58%             
client [77] (test)  loss: 1.2533 -> 1.1175   acc: 70.98% -> 70.47%             
client [76] (test)  loss: 1.0710 -> 1.2316   acc: 74.18% -> 72.22%             
client [79] (test)  loss: 0.9767 -> 0.9822   acc: 74.03% -> 72.93%             
client [28] (test)  loss: 0.9507 -> 0.9964   acc: 79.81% -> 80.12%             
client [99] (test)  loss: 1.2745 -> 1.3217   acc: 71.70% -> 67.92%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.0250 -> 1.1309   acc: 72.28% -> 71.91%             
client [86] (test)  loss: 0.7645 -> 0.5924   acc: 81.25% -> 85.42%             
client [34] (test)  loss: 1.2246 -> 1.3247   acc: 73.84% -> 73.57%             
client [73] (test)  loss: 0.6667 -> 0.6933   acc: 79.26% -> 81.85%             
client [5] (test)  loss: 1.1664 -> 1.3662   acc: 74.87% -> 71.12%              
client [96] (test)  loss: 0.9178 -> 0.9375   acc: 76.02% -> 75.20%             
client [22] (test)  loss: 0.9604 -> 1.0603   acc: 75.22% -> 76.09%             
client [60] (test)  loss: 0.6929 -> 0.7030   acc: 80.08% -> 79.66%             
client [66] (test)  loss: 1.2378 -> 1.2667   acc: 71.19% -> 72.85%             
client [83] (test)  loss: 1.0975 -> 1.2526   acc: 73.13% -> 69.78%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.1342 -> 1.2601   acc: 73.20% -> 72.22%             
client [65] (test)  loss: 0.8976 -> 0.9282   acc: 78.17% -> 77.78%             
client [95] (test)  loss: 1.0512 -> 1.1299   acc: 71.12% -> 69.60%             
client [17] (test)  loss: 1.4080 -> 1.1687   acc: 70.62% -> 74.64%             
client [8] (test)  loss: 1.1375 -> 1.1067   acc: 74.06% -> 74.06%              
client [35] (test)  loss: 2.0536 -> 1.5347   acc: 66.91% -> 68.73%             
client [98] (test)  loss: 0.9826 -> 1.0853   acc: 75.63% -> 73.11%             
client [53] (test)  loss: 1.0775 -> 1.0816   acc: 73.55% -> 71.61%             
client [43] (test)  loss: 1.0059 -> 1.0114   acc: 80.56% -> 82.41%             
client [64] (test)  loss: 1.1177 -> 1.1112   acc: 74.16% -> 74.77%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.9482 -> 1.0398   acc: 75.68% -> 72.04%             
client [88] (test)  loss: 1.3381 -> 1.3689   acc: 72.09% -> 72.09%             
client [38] (test)  loss: 1.2041 -> 1.2783   acc: 71.60% -> 70.40%             
client [3] (test)  loss: 1.3557 -> 1.1187   acc: 71.37% -> 77.02%              
client [5] (test)  loss: 1.2659 -> 1.4957   acc: 74.87% -> 71.12%              
client [41] (test)  loss: 0.9375 -> 1.0850   acc: 76.58% -> 73.98%             
client [7] (test)  loss: 0.5396 -> 0.5611   acc: 87.31% -> 86.04%              
client [37] (test)  loss: 0.7294 -> 0.8193   acc: 80.59% -> 82.94%             
client [45] (test)  loss: 1.1400 -> 1.5084   acc: 75.99% -> 68.75%             
client [47] (test)  loss: 1.2761 -> 1.3470   acc: 74.28% -> 71.06%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.2217 -> 1.2271   acc: 70.95% -> 69.11%             
client [11] (test)  loss: 0.9081 -> 0.8951   acc: 76.02% -> 75.61%             
client [37] (test)  loss: 0.7198 -> 0.7682   acc: 82.35% -> 81.18%             
client [41] (test)  loss: 0.9315 -> 1.0891   acc: 76.95% -> 72.86%             
client [95] (test)  loss: 1.0350 -> 1.1140   acc: 71.43% -> 70.52%             
client [53] (test)  loss: 1.1748 -> 1.1292   acc: 72.58% -> 73.23%             
client [22] (test)  loss: 0.9979 -> 1.0694   acc: 75.80% -> 74.93%             
client [25] (test)  loss: 1.4911 -> 1.4490   acc: 67.36% -> 67.36%             
client [69] (test)  loss: 1.1106 -> 1.1438   acc: 77.03% -> 76.58%             
client [46] (test)  loss: 1.2733 -> 1.2970   acc: 73.55% -> 72.18%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.3574 -> 1.4844   acc: 74.60% -> 71.06%             
client [69] (test)  loss: 1.1604 -> 1.1348   acc: 76.58% -> 77.03%             
client [82] (test)  loss: 1.0258 -> 1.1291   acc: 77.97% -> 78.32%             
client [45] (test)  loss: 1.2144 -> 1.4804   acc: 76.64% -> 73.68%             
client [7] (test)  loss: 0.5610 -> 0.6070   acc: 86.55% -> 86.55%              
client [50] (test)  loss: 0.9607 -> 0.9892   acc: 80.00% -> 79.60%             
client [35] (test)  loss: 2.0227 -> 1.5862   acc: 67.64% -> 68.00%             
client [24] (test)  loss: 0.9478 -> 0.9613   acc: 80.18% -> 79.59%             
client [15] (test)  loss: 0.7983 -> 0.9514   acc: 84.62% -> 78.85%             
client [58] (test)  loss: 1.3590 -> 1.5134   acc: 71.69% -> 71.08%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.9459 -> 0.8944   acc: 81.54% -> 82.92%             
client [76] (test)  loss: 1.2200 -> 1.3125   acc: 72.55% -> 72.55%             
client [67] (test)  loss: 0.9825 -> 1.0702   acc: 78.11% -> 77.22%             
client [37] (test)  loss: 0.6835 -> 0.7305   acc: 82.94% -> 81.76%             
client [58] (test)  loss: 1.3800 -> 1.4960   acc: 72.00% -> 71.69%             
client [64] (test)  loss: 1.1327 -> 1.1740   acc: 75.99% -> 75.38%             
client [77] (test)  loss: 1.2749 -> 1.2389   acc: 73.58% -> 70.47%             
client [55] (test)  loss: 1.3136 -> 1.2598   acc: 73.88% -> 75.92%             
client [12] (test)  loss: 0.7981 -> 0.7816   acc: 81.55% -> 85.56%             
client [89] (test)  loss: 1.5809 -> 1.6214   acc: 71.60% -> 73.46%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.0634 -> 1.0539   acc: 75.32% -> 78.57%             
client [51] (test)  loss: 1.0942 -> 1.1221   acc: 77.48% -> 77.15%             
client [8] (test)  loss: 1.2046 -> 1.2667   acc: 74.56% -> 73.80%              
client [18] (test)  loss: 0.9612 -> 0.9863   acc: 79.48% -> 78.83%             
client [94] (test)  loss: 1.8300 -> 1.7034   acc: 69.95% -> 71.83%             
client [81] (test)  loss: 1.3109 -> 1.4479   acc: 73.54% -> 72.92%             
client [3] (test)  loss: 1.3326 -> 1.2145   acc: 74.60% -> 77.42%              
client [11] (test)  loss: 0.9408 -> 0.9034   acc: 76.02% -> 75.61%             
client [95] (test)  loss: 1.1027 -> 1.1690   acc: 71.73% -> 72.34%             
client [67] (test)  loss: 1.0581 -> 1.1054   acc: 76.04% -> 75.74%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.0455 -> 1.1862   acc: 74.47% -> 74.77%             
client [79] (test)  loss: 1.0527 -> 1.1817   acc: 76.80% -> 73.48%             
client [58] (test)  loss: 1.5034 -> 1.5920   acc: 72.31% -> 72.00%             
client [88] (test)  loss: 1.5471 -> 1.5382   acc: 71.43% -> 71.43%             
client [46] (test)  loss: 1.4681 -> 1.4029   acc: 71.63% -> 72.18%             
client [11] (test)  loss: 0.9754 -> 0.9504   acc: 76.02% -> 77.64%             
client [55] (test)  loss: 1.4647 -> 1.3565   acc: 73.47% -> 74.29%             
client [13] (test)  loss: 1.9097 -> 1.3806   acc: 66.94% -> 70.56%             
client [31] (test)  loss: 1.1649 -> 1.4866   acc: 74.91% -> 54.42%             
client [75] (test)  loss: 1.1955 -> 1.2447   acc: 77.90% -> 78.34%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.2191 -> 1.2321   acc: 73.88% -> 75.51%             
client [7] (test)  loss: 0.5463 -> 0.6007   acc: 87.56% -> 87.56%              
client [57] (test)  loss: 1.2533 -> 1.4430   acc: 72.32% -> 71.73%             
client [13] (test)  loss: 1.8738 -> 1.3839   acc: 64.52% -> 70.16%             
client [43] (test)  loss: 1.0914 -> 1.0416   acc: 81.48% -> 82.41%             
client [91] (test)  loss: 0.7953 -> 0.7575   acc: 83.01% -> 82.73%             
client [10] (test)  loss: 1.4107 -> 1.5261   acc: 69.70% -> 68.94%             
client [64] (test)  loss: 1.2180 -> 1.2471   acc: 75.68% -> 75.99%             
client [82] (test)  loss: 1.0617 -> 1.1427   acc: 77.62% -> 78.32%             
client [22] (test)  loss: 1.1132 -> 1.1457   acc: 76.09% -> 75.80%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9057 -> 0.8688   acc: 80.88% -> 80.88%             
client [23] (test)  loss: 1.2544 -> 1.4200   acc: 77.92% -> 74.13%             
client [88] (test)  loss: 1.5675 -> 1.5673   acc: 72.76% -> 71.43%             
client [98] (test)  loss: 1.1963 -> 1.2423   acc: 75.63% -> 74.79%             
client [79] (test)  loss: 1.0679 -> 1.2363   acc: 74.59% -> 71.82%             
client [21] (test)  loss: 1.0788 -> 1.0793   acc: 75.08% -> 75.08%             
client [92] (test)  loss: 1.3276 -> 1.3407   acc: 74.10% -> 77.05%             
client [56] (test)  loss: 1.4010 -> 1.4692   acc: 83.21% -> 80.53%             
client [5] (test)  loss: 1.5263 -> 1.6383   acc: 74.33% -> 71.12%              
client [52] (test)  loss: 1.3346 -> 1.4133   acc: 76.51% -> 75.87%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '1.0500 -> 0.0000', 'accuracy': '74.65% -> 0.00%'},          
    200: {'loss': '1.2396 -> 0.0000', 'accuracy': '76.12% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(12.27%) at epoch: 1                                      
FedPer achieved 20.0%(28.16%) at epoch: 2                                      
FedPer achieved 40.0%(40.85%) at epoch: 4                                      
FedPer achieved 50.0%(51.07%) at epoch: 9                                      
FedPer achieved 60.0%(61.10%) at epoch: 18                                     
FedPer achieved 70.0%(71.73%) at epoch: 31                                     
Convergence (test_after):                                                      
FedPer achieved 40.0%(41.92%) at epoch: 0                                      
FedPer achieved 50.0%(51.99%) at epoch: 3                                      
FedPer achieved 60.0%(61.85%) at epoch: 10                                     
FedPer achieved 70.0%(70.07%) at epoch: 24                                     
