==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9906 -> 0.9301   acc: 65.54% -> 66.32%             
client [81] (test)  loss: 1.2238 -> 1.0947   acc: 57.08% -> 62.39%             
client [21] (test)  loss: 1.1786 -> 0.8908   acc: 60.44% -> 69.78%             
client [68] (test)  loss: 0.8071 -> 0.7460   acc: 74.10% -> 76.26%             
client [93] (test)  loss: 0.3644 -> 0.3337   acc: 86.63% -> 89.83%             
client [31] (test)  loss: 1.5255 -> 1.0861   acc: 41.85% -> 62.56%             
client [20] (test)  loss: 0.4102 -> 0.4292   acc: 87.58% -> 85.62%             
client [59] (test)  loss: 1.4128 -> 0.7393   acc: 47.35% -> 70.53%             
client [48] (test)  loss: 0.8427 -> 0.7371   acc: 69.59% -> 70.27%             
client [34] (test)  loss: 0.5969 -> 0.5705   acc: 82.53% -> 80.38%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3617 -> 0.3743   acc: 86.29% -> 85.95%             
client [99] (test)  loss: 0.6306 -> 0.6172   acc: 80.69% -> 81.03%             
client [67] (test)  loss: 0.4373 -> 0.4644   acc: 84.17% -> 83.40%             
client [0] (test)  loss: 0.3077 -> 0.5907   acc: 88.52% -> 79.34%              
client [76] (test)  loss: 0.5629 -> 0.5345   acc: 80.65% -> 82.02%             
client [41] (test)  loss: 0.4964 -> 0.5422   acc: 84.00% -> 85.20%             
client [62] (test)  loss: 0.3915 -> 0.3297   acc: 85.71% -> 88.57%             
client [2] (test)  loss: 0.5667 -> 0.5131   acc: 80.54% -> 78.44%              
client [14] (test)  loss: 0.2322 -> 0.2106   acc: 91.82% -> 93.33%             
client [46] (test)  loss: 0.3542 -> 0.3923   acc: 85.90% -> 86.32%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4785 -> 0.7110   acc: 84.77% -> 76.40%             
client [68] (test)  loss: 0.4140 -> 0.4471   acc: 87.77% -> 87.05%             
client [57] (test)  loss: 0.3756 -> 0.3988   acc: 87.76% -> 87.76%             
client [17] (test)  loss: 0.5704 -> 0.5388   acc: 83.56% -> 84.25%             
client [54] (test)  loss: 0.2031 -> 0.2265   acc: 92.78% -> 92.02%             
client [23] (test)  loss: 0.3106 -> 0.2331   acc: 88.33% -> 91.94%             
client [35] (test)  loss: 0.2753 -> 0.3276   acc: 90.97% -> 88.89%             
client [59] (test)  loss: 0.1950 -> 0.2293   acc: 94.37% -> 93.71%             
client [31] (test)  loss: 0.6183 -> 0.7966   acc: 77.97% -> 74.01%             
client [9] (test)  loss: 0.3710 -> 0.4099   acc: 86.73% -> 85.25%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3697 -> 0.3250   acc: 88.61% -> 89.24%             
client [33] (test)  loss: 0.1856 -> 0.2107   acc: 94.16% -> 93.51%             
client [16] (test)  loss: 0.1385 -> 0.1716   acc: 94.80% -> 94.05%             
client [44] (test)  loss: 0.2431 -> 0.2736   acc: 91.50% -> 91.78%             
client [8] (test)  loss: 0.1514 -> 0.1679   acc: 94.10% -> 94.75%              
client [31] (test)  loss: 0.3927 -> 0.5281   acc: 87.22% -> 84.14%             
client [47] (test)  loss: 0.1946 -> 0.2037   acc: 93.07% -> 92.47%             
client [36] (test)  loss: 0.2900 -> 0.5734   acc: 88.16% -> 78.95%             
client [20] (test)  loss: 0.1346 -> 0.1318   acc: 94.12% -> 95.42%             
client [56] (test)  loss: 0.1253 -> 0.1967   acc: 96.63% -> 93.25%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0947 -> 0.1057   acc: 96.09% -> 96.42%              
client [60] (test)  loss: 0.0898 -> 0.0880   acc: 97.53% -> 98.15%             
client [28] (test)  loss: 0.3564 -> 0.3857   acc: 89.68% -> 89.29%             
client [25] (test)  loss: 0.2387 -> 0.2833   acc: 92.65% -> 91.37%             
client [58] (test)  loss: 0.1392 -> 0.1624   acc: 94.96% -> 95.21%             
client [44] (test)  loss: 0.1981 -> 0.2506   acc: 94.05% -> 93.48%             
client [39] (test)  loss: 0.1347 -> 0.1418   acc: 95.35% -> 95.93%             
client [29] (test)  loss: 0.2879 -> 0.3007   acc: 90.56% -> 90.99%             
client [3] (test)  loss: 0.2288 -> 0.1303   acc: 93.79% -> 96.41%              
client [84] (test)  loss: 0.2792 -> 0.2867   acc: 90.39% -> 90.75%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.1754 -> 0.1842   acc: 94.39% -> 94.08%             
client [84] (test)  loss: 0.2356 -> 0.2681   acc: 92.17% -> 91.46%             
client [10] (test)  loss: 0.1665 -> 0.1899   acc: 94.14% -> 94.14%             
client [36] (test)  loss: 0.2090 -> 0.2505   acc: 92.76% -> 90.13%             
client [65] (test)  loss: 0.1880 -> 0.2136   acc: 94.55% -> 94.55%             
client [81] (test)  loss: 0.2818 -> 0.3027   acc: 90.71% -> 89.82%             
client [79] (test)  loss: 0.2520 -> 0.2834   acc: 90.45% -> 88.64%             
client [42] (test)  loss: 0.2631 -> 0.3103   acc: 89.49% -> 90.39%             
client [11] (test)  loss: 0.2980 -> 0.3092   acc: 89.50% -> 90.76%             
client [96] (test)  loss: 0.3164 -> 0.2998   acc: 91.13% -> 91.13%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0870 -> 0.1122   acc: 97.70% -> 96.07%              
client [53] (test)  loss: 0.3492 -> 0.3706   acc: 88.63% -> 85.49%             
client [52] (test)  loss: 0.1711 -> 0.2026   acc: 96.17% -> 96.49%             
client [42] (test)  loss: 0.2395 -> 0.2920   acc: 90.99% -> 90.99%             
client [69] (test)  loss: 0.1097 -> 0.1288   acc: 95.99% -> 95.32%             
client [59] (test)  loss: 0.0956 -> 0.1162   acc: 97.02% -> 96.69%             
client [7] (test)  loss: 0.1119 -> 0.1248   acc: 97.41% -> 97.12%              
client [26] (test)  loss: 0.0881 -> 0.1082   acc: 96.68% -> 96.68%             
client [49] (test)  loss: 0.0818 -> 0.0855   acc: 97.73% -> 97.73%             
client [98] (test)  loss: 0.2645 -> 0.2797   acc: 90.05% -> 91.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2438 -> 0.2665   acc: 90.58% -> 92.15%             
client [47] (test)  loss: 0.1306 -> 0.1237   acc: 95.78% -> 96.69%             
client [21] (test)  loss: 0.1537 -> 0.1616   acc: 96.26% -> 95.33%             
client [77] (test)  loss: 0.3023 -> 0.3503   acc: 91.38% -> 91.64%             
client [95] (test)  loss: 0.2511 -> 0.2538   acc: 91.57% -> 91.57%             
client [91] (test)  loss: 0.1811 -> 0.1670   acc: 95.19% -> 95.19%             
client [14] (test)  loss: 0.0834 -> 0.0843   acc: 97.58% -> 98.18%             
client [99] (test)  loss: 0.2524 -> 0.2690   acc: 92.76% -> 90.34%             
client [20] (test)  loss: 0.0781 -> 0.0734   acc: 97.39% -> 98.04%             
client [39] (test)  loss: 0.0854 -> 0.0888   acc: 97.97% -> 98.26%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1705 -> 0.1929   acc: 96.81% -> 96.81%             
client [62] (test)  loss: 0.0995 -> 0.1019   acc: 95.71% -> 96.00%             
client [71] (test)  loss: 0.1467 -> 0.1338   acc: 93.60% -> 93.60%             
client [97] (test)  loss: 0.0740 -> 0.0763   acc: 97.84% -> 97.30%             
client [30] (test)  loss: 0.1746 -> 0.1392   acc: 95.57% -> 96.52%             
client [88] (test)  loss: 0.0552 -> 0.0497   acc: 98.72% -> 98.40%             
client [60] (test)  loss: 0.0892 -> 0.0853   acc: 98.15% -> 98.77%             
client [82] (test)  loss: 0.2223 -> 0.2309   acc: 92.56% -> 92.23%             
client [91] (test)  loss: 0.1609 -> 0.1503   acc: 95.19% -> 95.19%             
client [57] (test)  loss: 0.1354 -> 0.1669   acc: 95.92% -> 94.90%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1717 -> 0.1916   acc: 96.04% -> 93.83%             
client [15] (test)  loss: 0.0247 -> 0.0452   acc: 99.06% -> 98.12%             
client [71] (test)  loss: 0.1183 -> 0.1116   acc: 94.40% -> 95.20%             
client [97] (test)  loss: 0.0766 -> 0.0745   acc: 97.84% -> 97.57%             
client [53] (test)  loss: 0.4189 -> 0.3663   acc: 87.84% -> 87.45%             
client [77] (test)  loss: 0.2936 -> 0.3289   acc: 92.95% -> 92.95%             
client [76] (test)  loss: 0.1036 -> 0.1256   acc: 96.19% -> 95.64%             
client [79] (test)  loss: 0.1785 -> 0.2090   acc: 95.45% -> 92.27%             
client [28] (test)  loss: 0.2042 -> 0.2411   acc: 93.25% -> 92.46%             
client [99] (test)  loss: 0.2276 -> 0.2503   acc: 93.45% -> 92.41%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0691 -> 0.0694   acc: 98.11% -> 97.84%             
client [86] (test)  loss: 0.0811 -> 0.0597   acc: 97.44% -> 97.44%             
client [34] (test)  loss: 0.0514 -> 0.0533   acc: 98.66% -> 98.66%             
client [73] (test)  loss: 0.0663 -> 0.0490   acc: 97.57% -> 98.79%             
client [5] (test)  loss: 0.0737 -> 0.0764   acc: 96.98% -> 96.98%              
client [96] (test)  loss: 0.2823 -> 0.2462   acc: 92.20% -> 92.20%             
client [22] (test)  loss: 0.1188 -> 0.1350   acc: 95.56% -> 96.11%             
client [60] (test)  loss: 0.0739 -> 0.0755   acc: 98.77% -> 98.77%             
client [66] (test)  loss: 0.1516 -> 0.1752   acc: 95.65% -> 95.29%             
client [83] (test)  loss: 0.2121 -> 0.2023   acc: 94.09% -> 93.60%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0971 -> 0.1217   acc: 96.46% -> 96.19%             
client [65] (test)  loss: 0.1308 -> 0.1380   acc: 96.79% -> 96.79%             
client [95] (test)  loss: 0.2058 -> 0.1945   acc: 93.57% -> 93.17%             
client [17] (test)  loss: 0.2476 -> 0.2520   acc: 94.52% -> 93.15%             
client [8] (test)  loss: 0.0683 -> 0.0894   acc: 97.70% -> 97.38%              
client [35] (test)  loss: 0.0686 -> 0.0765   acc: 97.92% -> 97.22%             
client [98] (test)  loss: 0.2155 -> 0.2306   acc: 92.67% -> 91.62%             
client [53] (test)  loss: 0.4143 -> 0.3635   acc: 87.45% -> 87.84%             
client [43] (test)  loss: 0.0989 -> 0.1082   acc: 96.81% -> 97.30%             
client [64] (test)  loss: 0.2046 -> 0.1860   acc: 93.67% -> 93.67%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1452 -> 0.1542   acc: 96.26% -> 95.95%             
client [88] (test)  loss: 0.0317 -> 0.0347   acc: 98.72% -> 98.72%             
client [38] (test)  loss: 0.1107 -> 0.1332   acc: 97.03% -> 96.44%             
client [3] (test)  loss: 0.0631 -> 0.0667   acc: 97.71% -> 98.37%              
client [5] (test)  loss: 0.0814 -> 0.0846   acc: 96.70% -> 96.98%              
client [41] (test)  loss: 0.1989 -> 0.2396   acc: 95.20% -> 94.00%             
client [7] (test)  loss: 0.0771 -> 0.0732   acc: 97.98% -> 98.27%              
client [37] (test)  loss: 0.1084 -> 0.1345   acc: 97.67% -> 96.33%             
client [45] (test)  loss: 0.2122 -> 0.3082   acc: 94.01% -> 91.48%             
client [47] (test)  loss: 0.1015 -> 0.0961   acc: 96.08% -> 96.99%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0765 -> 0.0980   acc: 97.40% -> 96.28%             
client [11] (test)  loss: 0.2587 -> 0.2668   acc: 92.86% -> 93.28%             
client [37] (test)  loss: 0.1171 -> 0.1264   acc: 96.67% -> 97.00%             
client [41] (test)  loss: 0.1977 -> 0.2186   acc: 94.80% -> 94.40%             
client [95] (test)  loss: 0.2113 -> 0.1923   acc: 93.17% -> 94.78%             
client [53] (test)  loss: 0.4244 -> 0.3519   acc: 87.84% -> 88.24%             
client [22] (test)  loss: 0.1172 -> 0.1241   acc: 96.11% -> 96.67%             
client [25] (test)  loss: 0.1643 -> 0.1970   acc: 97.44% -> 96.49%             
client [69] (test)  loss: 0.0629 -> 0.0743   acc: 97.66% -> 97.32%             
client [46] (test)  loss: 0.0702 -> 0.0777   acc: 97.86% -> 97.86%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0894 -> 0.0953   acc: 96.69% -> 97.59%             
client [69] (test)  loss: 0.0546 -> 0.0625   acc: 98.33% -> 98.66%             
client [82] (test)  loss: 0.1877 -> 0.1812   acc: 94.50% -> 93.53%             
client [45] (test)  loss: 0.2108 -> 0.2976   acc: 94.01% -> 91.48%             
client [7] (test)  loss: 0.0729 -> 0.1037   acc: 98.27% -> 97.98%              
client [50] (test)  loss: 0.0989 -> 0.0959   acc: 97.08% -> 97.45%             
client [35] (test)  loss: 0.0592 -> 0.0691   acc: 97.92% -> 97.69%             
client [24] (test)  loss: 0.2866 -> 0.2649   acc: 92.89% -> 92.39%             
client [15] (test)  loss: 0.0198 -> 0.0322   acc: 99.38% -> 99.06%             
client [58] (test)  loss: 0.0684 -> 0.0834   acc: 97.98% -> 97.98%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1021 -> 0.1200   acc: 96.28% -> 95.95%             
client [76] (test)  loss: 0.0836 -> 0.1092   acc: 97.55% -> 96.46%             
client [67] (test)  loss: 0.1089 -> 0.1143   acc: 96.53% -> 96.91%             
client [37] (test)  loss: 0.1051 -> 0.1234   acc: 97.67% -> 97.33%             
client [58] (test)  loss: 0.0671 -> 0.0846   acc: 97.73% -> 98.24%             
client [64] (test)  loss: 0.1986 -> 0.2107   acc: 94.30% -> 93.04%             
client [77] (test)  loss: 0.2877 -> 0.3046   acc: 94.26% -> 94.26%             
client [55] (test)  loss: 0.0890 -> 0.1441   acc: 96.39% -> 96.39%             
client [12] (test)  loss: 0.0912 -> 0.0963   acc: 96.46% -> 96.06%             
client [89] (test)  loss: 0.0921 -> 0.0945   acc: 97.41% -> 97.69%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1879 -> 0.2159   acc: 94.31% -> 95.37%             
client [51] (test)  loss: 0.2604 -> 0.2588   acc: 91.88% -> 91.88%             
client [8] (test)  loss: 0.0674 -> 0.0770   acc: 98.03% -> 97.70%              
client [18] (test)  loss: 0.0452 -> 0.0439   acc: 99.01% -> 99.34%             
client [94] (test)  loss: 0.0455 -> 0.0531   acc: 98.83% -> 98.83%             
client [81] (test)  loss: 0.1914 -> 0.1842   acc: 95.58% -> 96.02%             
client [3] (test)  loss: 0.0540 -> 0.0740   acc: 97.71% -> 98.37%              
client [11] (test)  loss: 0.2401 -> 0.2520   acc: 94.12% -> 93.28%             
client [95] (test)  loss: 0.2153 -> 0.2031   acc: 93.98% -> 93.57%             
client [67] (test)  loss: 0.1153 -> 0.1169   acc: 97.68% -> 96.91%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1343 -> 0.1349   acc: 96.57% -> 96.57%             
client [79] (test)  loss: 0.1769 -> 0.1656   acc: 95.00% -> 95.45%             
client [58] (test)  loss: 0.0705 -> 0.0820   acc: 97.98% -> 98.24%             
client [88] (test)  loss: 0.0299 -> 0.0330   acc: 99.04% -> 99.36%             
client [46] (test)  loss: 0.0706 -> 0.0763   acc: 97.86% -> 97.86%             
client [11] (test)  loss: 0.2696 -> 0.2660   acc: 92.86% -> 93.28%             
client [55] (test)  loss: 0.1071 -> 0.1312   acc: 96.39% -> 96.39%             
client [13] (test)  loss: 0.0944 -> 0.0969   acc: 97.75% -> 98.03%             
client [31] (test)  loss: 0.1363 -> 0.1209   acc: 96.04% -> 96.48%             
client [75] (test)  loss: 0.0824 -> 0.1356   acc: 97.88% -> 94.71%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0707 -> 0.0668   acc: 97.85% -> 98.16%             
client [7] (test)  loss: 0.0624 -> 0.0736   acc: 98.27% -> 98.56%              
client [57] (test)  loss: 0.0881 -> 0.0992   acc: 95.92% -> 96.43%             
client [13] (test)  loss: 0.0871 -> 0.0906   acc: 98.03% -> 98.31%             
client [43] (test)  loss: 0.0853 -> 0.0894   acc: 97.54% -> 98.53%             
client [91] (test)  loss: 0.1163 -> 0.1084   acc: 95.19% -> 95.19%             
client [10] (test)  loss: 0.0914 -> 0.0897   acc: 96.48% -> 96.48%             
client [64] (test)  loss: 0.1687 -> 0.1884   acc: 95.57% -> 94.94%             
client [82] (test)  loss: 0.1862 -> 0.1730   acc: 94.82% -> 94.50%             
client [22] (test)  loss: 0.0964 -> 0.1018   acc: 97.78% -> 97.22%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0475 -> 0.0509   acc: 99.02% -> 99.02%             
client [23] (test)  loss: 0.1546 -> 0.1405   acc: 96.94% -> 96.94%             
client [88] (test)  loss: 0.0274 -> 0.0295   acc: 99.36% -> 99.36%             
client [98] (test)  loss: 0.1867 -> 0.2020   acc: 93.72% -> 93.19%             
client [79] (test)  loss: 0.1741 -> 0.1974   acc: 95.00% -> 93.64%             
client [21] (test)  loss: 0.1300 -> 0.1315   acc: 96.26% -> 96.88%             
client [92] (test)  loss: 0.2593 -> 0.2425   acc: 91.67% -> 92.42%             
client [56] (test)  loss: 0.0531 -> 0.0557   acc: 98.16% -> 98.16%             
client [5] (test)  loss: 0.0732 -> 0.0823   acc: 97.80% -> 97.25%              
client [52] (test)  loss: 0.1703 -> 0.1705   acc: 97.44% -> 97.44%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1431 -> 0.0000', 'accuracy': '95.75% -> 0.00%'},          
    200: {'loss': '0.1257 -> 0.0000', 'accuracy': '96.73% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(10.49%) at epoch: 0                                      
FedPer achieved 20.0%(20.44%) at epoch: 1                                      
FedPer achieved 40.0%(40.00%) at epoch: 4                                      
FedPer achieved 60.0%(62.33%) at epoch: 7                                      
FedPer achieved 70.0%(71.63%) at epoch: 11                                     
FedPer achieved 80.0%(80.27%) at epoch: 16                                     
FedPer achieved 90.0%(90.42%) at epoch: 30                                     
Convergence (test_after):                                                      
FedPer achieved 30.0%(32.54%) at epoch: 0                                      
FedPer achieved 40.0%(41.94%) at epoch: 2                                      
FedPer achieved 50.0%(53.85%) at epoch: 3                                      
FedPer achieved 60.0%(63.63%) at epoch: 5                                      
FedPer achieved 70.0%(73.73%) at epoch: 8                                      
FedPer achieved 80.0%(82.46%) at epoch: 15                                     
FedPer achieved 90.0%(90.91%) at epoch: 31                                     
