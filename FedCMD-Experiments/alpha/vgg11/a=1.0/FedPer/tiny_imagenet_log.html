==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.8720 -> 4.2654   acc: 6.47% -> 18.88%              
client [81] (test)  loss: 4.6489 -> 4.5204   acc: 8.86% -> 15.13%              
client [21] (test)  loss: 5.0248 -> 4.4366   acc: 7.62% -> 14.52%              
client [68] (test)  loss: 4.8539 -> 4.1408   acc: 7.05% -> 22.06%              
client [93] (test)  loss: 4.8506 -> 4.1666   acc: 7.08% -> 21.05%              
client [31] (test)  loss: 5.0280 -> 4.3377   acc: 6.67% -> 17.48%              
client [20] (test)  loss: 4.3157 -> 4.1480   acc: 14.18% -> 24.95%             
client [59] (test)  loss: 4.8923 -> 4.2228   acc: 6.55% -> 18.55%              
client [48] (test)  loss: 4.4354 -> 4.0526   acc: 10.75% -> 19.71%             
client [34] (test)  loss: 4.5137 -> 4.4383   acc: 10.18% -> 16.91%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.3013 -> 4.0917   acc: 24.07% -> 27.59%             
client [99] (test)  loss: 3.7032 -> 4.0882   acc: 28.52% -> 29.78%             
client [67] (test)  loss: 3.5138 -> 3.8593   acc: 35.26% -> 33.21%             
client [0] (test)  loss: 3.8268 -> 4.2268   acc: 27.36% -> 28.26%              
client [76] (test)  loss: 3.5528 -> 4.1695   acc: 33.03% -> 31.40%             
client [41] (test)  loss: 3.9102 -> 4.2548   acc: 23.91% -> 26.63%             
client [62] (test)  loss: 4.5556 -> 4.0607   acc: 24.96% -> 28.19%             
client [2] (test)  loss: 4.2979 -> 3.7610   acc: 25.34% -> 31.48%              
client [14] (test)  loss: 3.7683 -> 4.3155   acc: 31.41% -> 32.85%             
client [46] (test)  loss: 3.7003 -> 4.0560   acc: 30.85% -> 31.03%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.5279 -> 3.9055   acc: 34.05% -> 34.58%             
client [68] (test)  loss: 3.3584 -> 3.6911   acc: 36.71% -> 36.17%             
client [57] (test)  loss: 3.4470 -> 3.7181   acc: 35.21% -> 37.39%             
client [17] (test)  loss: 3.6917 -> 4.1621   acc: 33.87% -> 31.71%             
client [54] (test)  loss: 3.4647 -> 3.8998   acc: 36.66% -> 37.02%             
client [23] (test)  loss: 4.5859 -> 4.1536   acc: 23.87% -> 25.68%             
client [35] (test)  loss: 3.4473 -> 3.7308   acc: 34.12% -> 32.49%             
client [59] (test)  loss: 3.6465 -> 4.0459   acc: 35.82% -> 34.73%             
client [31] (test)  loss: 3.8964 -> 4.2890   acc: 35.86% -> 33.33%             
client [9] (test)  loss: 3.6818 -> 4.2695   acc: 34.54% -> 30.38%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5649 -> 3.8929   acc: 38.10% -> 34.94%             
client [33] (test)  loss: 3.5214 -> 3.9876   acc: 35.51% -> 34.24%             
client [16] (test)  loss: 3.5262 -> 3.9309   acc: 37.52% -> 37.88%             
client [44] (test)  loss: 3.9442 -> 3.5544   acc: 33.93% -> 35.88%             
client [8] (test)  loss: 3.6446 -> 4.2540   acc: 35.02% -> 36.46%              
client [31] (test)  loss: 3.8630 -> 4.2413   acc: 35.32% -> 34.23%             
client [47] (test)  loss: 3.5736 -> 3.8354   acc: 35.56% -> 35.02%             
client [36] (test)  loss: 3.6242 -> 3.4245   acc: 33.27% -> 34.55%             
client [20] (test)  loss: 3.3273 -> 3.5825   acc: 39.70% -> 40.83%             
client [56] (test)  loss: 3.4144 -> 3.5574   acc: 36.82% -> 37.55%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.4715 -> 3.9159   acc: 37.93% -> 35.39%              
client [60] (test)  loss: 3.6662 -> 3.7628   acc: 39.93% -> 38.67%             
client [28] (test)  loss: 3.2120 -> 3.6029   acc: 38.84% -> 36.48%             
client [25] (test)  loss: 3.4592 -> 3.6621   acc: 37.84% -> 35.50%             
client [58] (test)  loss: 3.6070 -> 4.0343   acc: 35.68% -> 33.15%             
client [44] (test)  loss: 3.5328 -> 3.5168   acc: 36.94% -> 37.66%             
client [39] (test)  loss: 3.3758 -> 3.7319   acc: 41.45% -> 38.91%             
client [29] (test)  loss: 3.3612 -> 3.5572   acc: 38.18% -> 38.88%             
client [3] (test)  loss: 3.5682 -> 3.6255   acc: 41.14% -> 38.82%              
client [84] (test)  loss: 3.4013 -> 3.8084   acc: 39.67% -> 36.78%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.4935 -> 3.7266   acc: 36.66% -> 35.21%             
client [84] (test)  loss: 3.4476 -> 3.8819   acc: 40.22% -> 36.78%             
client [10] (test)  loss: 3.2712 -> 3.5720   acc: 40.65% -> 40.29%             
client [36] (test)  loss: 3.2155 -> 3.3893   acc: 40.36% -> 38.36%             
client [65] (test)  loss: 3.6503 -> 4.0822   acc: 36.66% -> 37.57%             
client [81] (test)  loss: 3.2935 -> 3.6823   acc: 38.38% -> 35.79%             
client [79] (test)  loss: 3.3895 -> 3.7594   acc: 37.12% -> 36.77%             
client [42] (test)  loss: 3.4505 -> 3.8829   acc: 40.00% -> 38.30%             
client [11] (test)  loss: 3.0326 -> 3.3275   acc: 47.30% -> 42.99%             
client [96] (test)  loss: 3.0895 -> 3.2422   acc: 44.50% -> 42.70%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.5726 -> 4.1263   acc: 38.27% -> 38.81%              
client [53] (test)  loss: 3.2171 -> 3.3724   acc: 37.57% -> 37.04%             
client [52] (test)  loss: 3.4111 -> 3.8652   acc: 40.22% -> 36.96%             
client [42] (test)  loss: 3.5779 -> 3.9731   acc: 39.43% -> 39.25%             
client [69] (test)  loss: 3.2410 -> 3.7279   acc: 42.78% -> 39.81%             
client [59] (test)  loss: 3.6099 -> 4.0169   acc: 40.18% -> 36.73%             
client [7] (test)  loss: 3.4478 -> 3.6549   acc: 41.30% -> 39.49%              
client [26] (test)  loss: 3.2628 -> 3.4803   acc: 41.91% -> 40.11%             
client [49] (test)  loss: 3.5792 -> 3.9456   acc: 38.27% -> 37.55%             
client [98] (test)  loss: 3.6738 -> 4.0108   acc: 37.09% -> 37.27%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.7909 -> 4.0036   acc: 37.09% -> 36.73%             
client [47] (test)  loss: 3.6167 -> 3.6846   acc: 38.63% -> 38.27%             
client [21] (test)  loss: 3.6499 -> 3.8294   acc: 37.21% -> 34.85%             
client [77] (test)  loss: 3.5754 -> 3.7256   acc: 39.03% -> 39.03%             
client [95] (test)  loss: 3.6691 -> 4.0770   acc: 40.90% -> 38.46%             
client [91] (test)  loss: 3.7988 -> 4.1528   acc: 39.09% -> 36.73%             
client [14] (test)  loss: 3.9272 -> 4.2863   acc: 39.17% -> 36.82%             
client [99] (test)  loss: 3.6625 -> 3.8150   acc: 37.55% -> 39.53%             
client [20] (test)  loss: 3.4213 -> 3.7628   acc: 44.42% -> 44.61%             
client [39] (test)  loss: 3.6230 -> 3.8877   acc: 42.73% -> 41.82%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.5532 -> 3.9714   acc: 41.85% -> 37.14%             
client [62] (test)  loss: 3.7122 -> 4.0841   acc: 39.50% -> 38.06%             
client [71] (test)  loss: 3.9903 -> 4.2714   acc: 36.02% -> 34.77%             
client [97] (test)  loss: 3.3201 -> 3.5291   acc: 43.82% -> 39.27%             
client [30] (test)  loss: 3.2763 -> 3.8556   acc: 42.93% -> 39.13%             
client [88] (test)  loss: 3.6631 -> 3.9280   acc: 40.69% -> 37.43%             
client [60] (test)  loss: 3.7219 -> 3.9818   acc: 41.01% -> 39.39%             
client [82] (test)  loss: 3.4445 -> 3.7358   acc: 42.32% -> 41.43%             
client [91] (test)  loss: 3.7752 -> 4.3375   acc: 39.27% -> 35.45%             
client [57] (test)  loss: 3.3740 -> 3.5871   acc: 40.47% -> 41.56%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.1270 -> 4.7424   acc: 38.20% -> 38.56%             
client [15] (test)  loss: 3.6752 -> 3.8939   acc: 38.06% -> 35.37%             
client [71] (test)  loss: 4.1123 -> 4.3063   acc: 35.84% -> 36.02%             
client [97] (test)  loss: 3.5903 -> 3.8319   acc: 41.82% -> 39.45%             
client [53] (test)  loss: 3.5009 -> 3.5954   acc: 38.10% -> 36.86%             
client [77] (test)  loss: 3.6992 -> 3.7816   acc: 39.93% -> 39.75%             
client [76] (test)  loss: 3.4866 -> 3.8294   acc: 43.38% -> 43.38%             
client [79] (test)  loss: 3.7408 -> 3.8798   acc: 37.48% -> 37.48%             
client [28] (test)  loss: 3.5588 -> 4.0154   acc: 41.92% -> 38.11%             
client [99] (test)  loss: 3.8034 -> 3.9058   acc: 37.00% -> 36.82%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.5688 -> 3.9891   acc: 42.91% -> 40.18%             
client [86] (test)  loss: 3.5790 -> 4.0265   acc: 40.65% -> 39.38%             
client [34] (test)  loss: 3.9189 -> 4.4890   acc: 39.09% -> 38.18%             
client [73] (test)  loss: 3.6539 -> 3.9691   acc: 40.65% -> 39.02%             
client [5] (test)  loss: 3.7870 -> 3.9437   acc: 38.08% -> 37.72%              
client [96] (test)  loss: 3.3258 -> 3.7309   acc: 47.03% -> 43.96%             
client [22] (test)  loss: 3.5643 -> 3.9779   acc: 45.39% -> 40.33%             
client [60] (test)  loss: 3.8340 -> 4.2642   acc: 41.19% -> 40.47%             
client [66] (test)  loss: 3.7361 -> 4.1211   acc: 39.89% -> 38.27%             
client [83] (test)  loss: 3.8953 -> 4.2819   acc: 39.42% -> 39.24%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.7229 -> 4.1542   acc: 41.92% -> 42.65%             
client [65] (test)  loss: 4.3747 -> 4.5081   acc: 38.84% -> 39.20%             
client [95] (test)  loss: 4.0235 -> 4.4531   acc: 42.78% -> 40.90%             
client [17] (test)  loss: 4.2227 -> 4.0669   acc: 38.20% -> 37.30%             
client [8] (test)  loss: 4.0854 -> 4.5055   acc: 40.07% -> 39.71%              
client [35] (test)  loss: 3.7185 -> 4.0476   acc: 43.92% -> 41.74%             
client [98] (test)  loss: 4.1934 -> 4.3700   acc: 38.91% -> 38.18%             
client [53] (test)  loss: 3.7636 -> 3.8413   acc: 38.62% -> 36.68%             
client [43] (test)  loss: 3.9308 -> 4.2081   acc: 44.20% -> 39.13%             
client [64] (test)  loss: 4.1179 -> 4.2990   acc: 40.33% -> 36.25%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.2774 -> 4.0904   acc: 36.30% -> 34.85%             
client [88] (test)  loss: 4.2855 -> 4.6435   acc: 39.78% -> 39.24%             
client [38] (test)  loss: 4.3986 -> 4.4984   acc: 37.22% -> 38.52%             
client [3] (test)  loss: 4.3379 -> 4.3791   acc: 42.40% -> 42.22%              
client [5] (test)  loss: 4.2919 -> 4.2032   acc: 39.68% -> 36.65%              
client [41] (test)  loss: 4.3371 -> 4.3403   acc: 38.41% -> 38.95%             
client [7] (test)  loss: 4.1306 -> 4.1652   acc: 42.03% -> 39.49%              
client [37] (test)  loss: 4.0821 -> 4.0949   acc: 39.46% -> 37.48%             
client [45] (test)  loss: 3.8437 -> 3.7715   acc: 44.00% -> 38.73%             
client [47] (test)  loss: 4.2537 -> 4.0067   acc: 38.63% -> 40.43%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.2432 -> 4.7008   acc: 41.83% -> 40.04%             
client [11] (test)  loss: 3.7422 -> 4.1077   acc: 46.22% -> 44.24%             
client [37] (test)  loss: 4.0106 -> 4.4369   acc: 39.28% -> 38.02%             
client [41] (test)  loss: 4.2723 -> 4.3424   acc: 40.40% -> 38.41%             
client [95] (test)  loss: 4.1498 -> 4.5724   acc: 42.59% -> 42.21%             
client [53] (test)  loss: 3.8628 -> 3.9672   acc: 37.74% -> 38.98%             
client [22] (test)  loss: 3.9351 -> 4.2769   acc: 43.58% -> 40.33%             
client [25] (test)  loss: 4.0705 -> 4.2035   acc: 39.10% -> 37.84%             
client [69] (test)  loss: 3.9381 -> 4.5174   acc: 40.19% -> 39.63%             
client [46] (test)  loss: 3.9824 -> 4.0577   acc: 43.38% -> 42.11%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.4970 -> 4.8188   acc: 39.89% -> 39.89%             
client [69] (test)  loss: 4.2669 -> 4.6896   acc: 40.37% -> 40.19%             
client [82] (test)  loss: 4.2239 -> 4.3563   acc: 42.86% -> 41.61%             
client [45] (test)  loss: 4.1100 -> 4.1157   acc: 42.73% -> 39.64%             
client [7] (test)  loss: 4.3301 -> 4.3999   acc: 41.49% -> 40.58%              
client [50] (test)  loss: 4.5895 -> 4.3013   acc: 40.94% -> 38.04%             
client [35] (test)  loss: 4.1639 -> 4.3958   acc: 42.83% -> 42.11%             
client [24] (test)  loss: 4.4233 -> 4.7116   acc: 39.04% -> 37.25%             
client [15] (test)  loss: 4.4418 -> 4.6755   acc: 37.70% -> 35.19%             
client [58] (test)  loss: 4.7430 -> 5.2424   acc: 38.02% -> 37.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.0315 -> 4.0923   acc: 42.47% -> 42.11%             
client [76] (test)  loss: 4.2900 -> 4.6263   acc: 43.92% -> 43.01%             
client [67] (test)  loss: 4.4041 -> 4.3102   acc: 46.83% -> 44.59%             
client [37] (test)  loss: 4.5052 -> 4.7114   acc: 40.36% -> 36.94%             
client [58] (test)  loss: 5.0389 -> 5.4332   acc: 38.20% -> 38.20%             
client [64] (test)  loss: 4.9811 -> 4.8679   acc: 38.66% -> 39.22%             
client [77] (test)  loss: 4.7370 -> 4.7171   acc: 39.03% -> 40.29%             
client [55] (test)  loss: 4.5673 -> 4.6491   acc: 41.14% -> 39.53%             
client [12] (test)  loss: 5.0729 -> 5.1675   acc: 36.38% -> 36.02%             
client [89] (test)  loss: 4.2476 -> 4.3472   acc: 42.83% -> 43.55%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.6487 -> 4.9813   acc: 40.04% -> 40.40%             
client [51] (test)  loss: 4.8828 -> 5.3194   acc: 41.80% -> 40.54%             
client [8] (test)  loss: 4.7027 -> 5.1836   acc: 40.97% -> 40.79%              
client [18] (test)  loss: 4.3549 -> 4.5204   acc: 44.19% -> 44.54%             
client [94] (test)  loss: 5.0416 -> 4.8966   acc: 34.72% -> 32.19%             
client [81] (test)  loss: 4.5411 -> 4.9742   acc: 39.85% -> 38.56%             
client [3] (test)  loss: 4.6900 -> 4.9076   acc: 43.65% -> 43.83%              
client [11] (test)  loss: 4.1790 -> 4.4682   acc: 45.68% -> 46.40%             
client [95] (test)  loss: 4.5690 -> 4.9497   acc: 43.34% -> 43.71%             
client [67] (test)  loss: 4.2627 -> 4.5635   acc: 46.08% -> 44.96%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.0689 -> 4.7637   acc: 35.93% -> 34.12%             
client [79] (test)  loss: 4.8930 -> 4.9989   acc: 38.37% -> 36.94%             
client [58] (test)  loss: 5.2359 -> 5.5969   acc: 37.66% -> 38.74%             
client [88] (test)  loss: 4.9472 -> 5.3158   acc: 41.41% -> 40.51%             
client [46] (test)  loss: 4.7745 -> 4.6224   acc: 42.65% -> 41.92%             
client [11] (test)  loss: 4.4742 -> 4.7163   acc: 46.22% -> 44.96%             
client [55] (test)  loss: 4.7433 -> 4.9177   acc: 40.61% -> 41.68%             
client [13] (test)  loss: 4.4030 -> 4.4810   acc: 43.84% -> 42.03%             
client [31] (test)  loss: 5.3977 -> 5.9058   acc: 37.66% -> 38.74%             
client [75] (test)  loss: 4.6017 -> 4.7995   acc: 44.04% -> 43.32%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.6639 -> 5.8743   acc: 38.73% -> 38.11%             
client [7] (test)  loss: 4.8982 -> 5.1240   acc: 41.12% -> 42.03%              
client [57] (test)  loss: 4.5382 -> 4.7925   acc: 43.19% -> 43.01%             
client [13] (test)  loss: 4.5395 -> 4.6648   acc: 42.57% -> 42.57%             
client [43] (test)  loss: 4.8970 -> 5.2612   acc: 44.02% -> 42.39%             
client [91] (test)  loss: 5.4171 -> 5.4147   acc: 38.36% -> 35.09%             
client [10] (test)  loss: 4.8389 -> 5.1719   acc: 41.37% -> 42.27%             
client [64] (test)  loss: 5.1999 -> 5.4439   acc: 39.41% -> 38.10%             
client [82] (test)  loss: 4.7968 -> 5.0888   acc: 42.86% -> 43.21%             
client [22] (test)  loss: 4.8123 -> 5.1415   acc: 43.04% -> 41.41%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.0742 -> 4.9712   acc: 44.42% -> 41.02%             
client [23] (test)  loss: 5.8636 -> 5.1971   acc: 34.90% -> 34.72%             
client [88] (test)  loss: 5.3743 -> 5.5808   acc: 41.05% -> 41.23%             
client [98] (test)  loss: 5.4048 -> 5.6015   acc: 38.73% -> 39.64%             
client [79] (test)  loss: 5.2775 -> 5.3092   acc: 37.83% -> 37.66%             
client [21] (test)  loss: 5.4880 -> 5.2413   acc: 35.21% -> 34.85%             
client [92] (test)  loss: 4.7233 -> 4.5583   acc: 45.54% -> 43.21%             
client [56] (test)  loss: 4.8898 -> 5.0663   acc: 42.24% -> 42.42%             
client [5] (test)  loss: 5.1973 -> 5.0871   acc: 39.86% -> 40.75%              
client [52] (test)  loss: 5.2404 -> 5.4389   acc: 40.94% -> 38.41%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.7258 -> 0.0000', 'accuracy': '40.86% -> 0.00%'},          
    200: {'loss': '5.2102 -> 0.0000', 'accuracy': '40.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(12.41%) at epoch: 11                                     
FedPer achieved 20.0%(21.35%) at epoch: 13                                     
FedPer achieved 30.0%(30.23%) at epoch: 21                                     
FedPer achieved 40.0%(40.10%) at epoch: 57                                     
Convergence (test_after):                                                      
FedPer achieved 10.0%(15.21%) at epoch: 8                                      
FedPer achieved 20.0%(20.32%) at epoch: 11                                     
FedPer achieved 30.0%(30.03%) at epoch: 19                                     
FedPer achieved 40.0%(40.80%) at epoch: 65                                     
