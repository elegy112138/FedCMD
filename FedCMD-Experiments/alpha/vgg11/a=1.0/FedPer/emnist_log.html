==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.3177 -> 0.3668   acc: 88.41% -> 88.63%             
client [81] (test)  loss: 0.7700 -> 0.6642   acc: 79.79% -> 81.02%             
client [21] (test)  loss: 0.6925 -> 0.5824   acc: 79.60% -> 81.29%             
client [68] (test)  loss: 0.5161 -> 0.4842   acc: 83.40% -> 83.65%             
client [93] (test)  loss: 0.7416 -> 0.6732   acc: 76.68% -> 79.07%             
client [31] (test)  loss: 0.7607 -> 0.5759   acc: 78.29% -> 82.10%             
client [20] (test)  loss: 0.4327 -> 0.4920   acc: 86.35% -> 85.72%             
client [59] (test)  loss: 0.4664 -> 0.3458   acc: 82.95% -> 89.45%             
client [48] (test)  loss: 0.5839 -> 0.7103   acc: 81.43% -> 75.12%             
client [34] (test)  loss: 0.8410 -> 0.6125   acc: 73.60% -> 80.13%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.2396 -> 0.1978   acc: 91.64% -> 93.67%             
client [99] (test)  loss: 0.6565 -> 0.6244   acc: 80.34% -> 80.64%             
client [67] (test)  loss: 0.3317 -> 0.2456   acc: 89.83% -> 93.15%             
client [0] (test)  loss: 0.5268 -> 0.5817   acc: 83.97% -> 81.55%              
client [76] (test)  loss: 0.4545 -> 0.5754   acc: 85.50% -> 81.93%             
client [41] (test)  loss: 0.6362 -> 0.6042   acc: 76.67% -> 78.54%             
client [62] (test)  loss: 0.9193 -> 0.4467   acc: 79.08% -> 86.54%             
client [2] (test)  loss: 0.7956 -> 0.5283   acc: 80.31% -> 84.14%              
client [14] (test)  loss: 0.5192 -> 0.5813   acc: 84.17% -> 82.62%             
client [46] (test)  loss: 0.5137 -> 0.5682   acc: 86.66% -> 85.86%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4409 -> 0.4688   acc: 84.64% -> 83.62%             
client [68] (test)  loss: 0.3906 -> 0.4491   acc: 87.37% -> 85.77%             
client [57] (test)  loss: 0.2491 -> 0.2454   acc: 91.59% -> 91.23%             
client [17] (test)  loss: 0.3491 -> 0.3960   acc: 89.80% -> 87.54%             
client [54] (test)  loss: 0.2964 -> 0.3116   acc: 91.07% -> 91.00%             
client [23] (test)  loss: 0.9045 -> 0.6301   acc: 76.96% -> 81.42%             
client [35] (test)  loss: 0.6501 -> 0.6398   acc: 81.06% -> 81.06%             
client [59] (test)  loss: 0.2383 -> 0.2906   acc: 92.47% -> 91.95%             
client [31] (test)  loss: 0.4773 -> 0.5298   acc: 84.69% -> 84.10%             
client [9] (test)  loss: 0.5360 -> 0.6047   acc: 81.67% -> 79.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4519 -> 0.5019   acc: 86.96% -> 85.55%             
client [33] (test)  loss: 0.5028 -> 0.6460   acc: 85.04% -> 83.16%             
client [16] (test)  loss: 0.5906 -> 0.6036   acc: 82.35% -> 82.55%             
client [44] (test)  loss: 0.6820 -> 0.6357   acc: 77.70% -> 75.78%             
client [8] (test)  loss: 0.3851 -> 0.4310   acc: 89.15% -> 88.16%              
client [31] (test)  loss: 0.4904 -> 0.5422   acc: 84.91% -> 84.52%             
client [47] (test)  loss: 0.2233 -> 0.2338   acc: 92.53% -> 92.14%             
client [36] (test)  loss: 0.1872 -> 0.1666   acc: 93.39% -> 94.93%             
client [20] (test)  loss: 0.3606 -> 0.4521   acc: 88.90% -> 87.73%             
client [56] (test)  loss: 0.3625 -> 0.3851   acc: 87.82% -> 87.00%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3659 -> 0.4199   acc: 88.37% -> 86.93%              
client [60] (test)  loss: 0.2803 -> 0.3033   acc: 91.25% -> 89.51%             
client [28] (test)  loss: 0.2787 -> 0.2907   acc: 92.73% -> 91.84%             
client [25] (test)  loss: 0.1871 -> 0.2004   acc: 95.04% -> 94.92%             
client [58] (test)  loss: 0.2908 -> 0.3272   acc: 91.77% -> 91.28%             
client [44] (test)  loss: 0.6242 -> 0.6738   acc: 78.23% -> 75.92%             
client [39] (test)  loss: 0.4581 -> 0.5002   acc: 85.63% -> 84.97%             
client [29] (test)  loss: 0.4817 -> 0.5435   acc: 86.00% -> 86.47%             
client [3] (test)  loss: 0.3361 -> 0.3615   acc: 89.44% -> 88.53%              
client [84] (test)  loss: 0.5351 -> 0.6681   acc: 83.36% -> 83.44%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4967 -> 0.5308   acc: 84.53% -> 83.91%             
client [84] (test)  loss: 0.5629 -> 0.6722   acc: 83.78% -> 83.20%             
client [10] (test)  loss: 0.4426 -> 0.5140   acc: 87.78% -> 86.70%             
client [36] (test)  loss: 0.1685 -> 0.1701   acc: 94.44% -> 95.15%             
client [65] (test)  loss: 0.2292 -> 0.2687   acc: 93.64% -> 93.01%             
client [81] (test)  loss: 0.5665 -> 0.5550   acc: 86.60% -> 86.12%             
client [79] (test)  loss: 0.1802 -> 0.2063   acc: 94.77% -> 94.38%             
client [42] (test)  loss: 0.3932 -> 0.4419   acc: 88.47% -> 88.42%             
client [11] (test)  loss: 0.3520 -> 0.3892   acc: 90.36% -> 88.84%             
client [96] (test)  loss: 0.2771 -> 0.3253   acc: 90.80% -> 89.86%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3806 -> 0.4393   acc: 90.09% -> 88.84%              
client [53] (test)  loss: 0.2172 -> 0.2286   acc: 94.17% -> 93.93%             
client [52] (test)  loss: 0.5485 -> 0.5926   acc: 84.36% -> 84.56%             
client [42] (test)  loss: 0.3952 -> 0.4563   acc: 89.06% -> 88.47%             
client [69] (test)  loss: 0.1790 -> 0.2156   acc: 94.25% -> 94.32%             
client [59] (test)  loss: 0.2503 -> 0.2811   acc: 93.30% -> 92.89%             
client [7] (test)  loss: 0.4791 -> 0.5773   acc: 82.84% -> 81.89%              
client [26] (test)  loss: 0.2127 -> 0.2536   acc: 93.91% -> 93.37%             
client [49] (test)  loss: 0.3925 -> 0.4473   acc: 88.63% -> 87.73%             
client [98] (test)  loss: 0.4598 -> 0.5085   acc: 86.49% -> 85.38%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4719 -> 0.5295   acc: 86.54% -> 84.69%             
client [47] (test)  loss: 0.2227 -> 0.2326   acc: 93.16% -> 92.65%             
client [21] (test)  loss: 0.5215 -> 0.5419   acc: 84.21% -> 84.43%             
client [77] (test)  loss: 0.2453 -> 0.2657   acc: 92.00% -> 91.63%             
client [95] (test)  loss: 0.3685 -> 0.4248   acc: 90.37% -> 88.53%             
client [91] (test)  loss: 0.6223 -> 0.7285   acc: 83.18% -> 81.87%             
client [14] (test)  loss: 0.5408 -> 0.6261   acc: 85.18% -> 82.97%             
client [99] (test)  loss: 0.5728 -> 0.6386   acc: 84.45% -> 82.69%             
client [20] (test)  loss: 0.3910 -> 0.4687   acc: 89.47% -> 88.66%             
client [39] (test)  loss: 0.5108 -> 0.5534   acc: 85.95% -> 84.71%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5663 -> 0.6090   acc: 84.92% -> 85.10%             
client [62] (test)  loss: 0.4869 -> 0.5536   acc: 87.73% -> 87.01%             
client [71] (test)  loss: 0.6027 -> 0.6937   acc: 84.75% -> 82.54%             
client [97] (test)  loss: 0.2338 -> 0.2498   acc: 94.19% -> 93.79%             
client [30] (test)  loss: 0.2854 -> 0.3222   acc: 92.73% -> 92.29%             
client [88] (test)  loss: 0.3444 -> 0.4123   acc: 90.05% -> 88.58%             
client [60] (test)  loss: 0.2950 -> 0.3215   acc: 90.99% -> 90.04%             
client [82] (test)  loss: 0.3964 -> 0.4106   acc: 88.32% -> 88.07%             
client [91] (test)  loss: 0.6586 -> 0.7540   acc: 83.81% -> 82.36%             
client [57] (test)  loss: 0.2137 -> 0.2372   acc: 93.31% -> 92.46%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6009 -> 0.6512   acc: 85.96% -> 84.98%             
client [15] (test)  loss: 0.4921 -> 0.5083   acc: 84.14% -> 83.09%             
client [71] (test)  loss: 0.6148 -> 0.7335   acc: 84.68% -> 82.30%             
client [97] (test)  loss: 0.2380 -> 0.2708   acc: 94.31% -> 93.72%             
client [53] (test)  loss: 0.2333 -> 0.2329   acc: 94.49% -> 94.00%             
client [77] (test)  loss: 0.2432 -> 0.2818   acc: 92.34% -> 91.78%             
client [76] (test)  loss: 0.4983 -> 0.5568   acc: 86.94% -> 85.84%             
client [79] (test)  loss: 0.1978 -> 0.2223   acc: 94.87% -> 94.43%             
client [28] (test)  loss: 0.3229 -> 0.3701   acc: 92.85% -> 92.34%             
client [99] (test)  loss: 0.5896 -> 0.6583   acc: 84.28% -> 82.08%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2357 -> 0.2812   acc: 94.50% -> 93.52%             
client [86] (test)  loss: 0.2559 -> 0.2732   acc: 93.83% -> 94.24%             
client [34] (test)  loss: 0.5539 -> 0.6009   acc: 84.59% -> 85.33%             
client [73] (test)  loss: 0.6123 -> 0.7064   acc: 85.96% -> 84.19%             
client [5] (test)  loss: 0.5255 -> 0.5928   acc: 87.59% -> 87.35%              
client [96] (test)  loss: 0.3388 -> 0.3834   acc: 90.26% -> 90.28%             
client [22] (test)  loss: 0.5030 -> 0.5723   acc: 87.29% -> 86.28%             
client [60] (test)  loss: 0.3112 -> 0.3375   acc: 91.20% -> 91.13%             
client [66] (test)  loss: 0.3666 -> 0.3872   acc: 90.25% -> 89.61%             
client [83] (test)  loss: 0.4244 -> 0.5094   acc: 87.41% -> 86.36%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5247 -> 0.6157   acc: 87.08% -> 86.28%             
client [65] (test)  loss: 0.2553 -> 0.2864   acc: 94.15% -> 93.59%             
client [95] (test)  loss: 0.3922 -> 0.4437   acc: 90.35% -> 88.80%             
client [17] (test)  loss: 0.3632 -> 0.3632   acc: 90.90% -> 91.54%             
client [8] (test)  loss: 0.4118 -> 0.4733   acc: 89.63% -> 89.12%              
client [35] (test)  loss: 0.7203 -> 0.8032   acc: 82.31% -> 81.96%             
client [98] (test)  loss: 0.5032 -> 0.5494   acc: 86.70% -> 85.68%             
client [53] (test)  loss: 0.2185 -> 0.2670   acc: 94.68% -> 94.08%             
client [43] (test)  loss: 0.4429 -> 0.4906   acc: 89.16% -> 88.78%             
client [64] (test)  loss: 0.5328 -> 0.5923   acc: 86.99% -> 85.72%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5606 -> 0.5763   acc: 85.24% -> 84.16%             
client [88] (test)  loss: 0.3962 -> 0.4891   acc: 90.19% -> 88.58%             
client [38] (test)  loss: 0.6052 -> 0.6118   acc: 84.66% -> 84.32%             
client [3] (test)  loss: 0.4166 -> 0.4856   acc: 89.68% -> 89.21%              
client [5] (test)  loss: 0.5681 -> 0.6171   acc: 87.37% -> 87.56%              
client [41] (test)  loss: 0.6767 -> 0.7023   acc: 80.50% -> 79.38%             
client [7] (test)  loss: 0.5516 -> 0.6107   acc: 84.22% -> 82.87%              
client [37] (test)  loss: 0.7925 -> 0.9146   acc: 80.20% -> 77.74%             
client [45] (test)  loss: 0.4679 -> 0.5205   acc: 88.00% -> 87.26%             
client [47] (test)  loss: 0.2583 -> 0.2610   acc: 92.85% -> 92.11%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7743 -> 0.8338   acc: 83.43% -> 83.23%             
client [11] (test)  loss: 0.4320 -> 0.5290   acc: 90.05% -> 88.26%             
client [37] (test)  loss: 0.8338 -> 0.9571   acc: 79.34% -> 78.74%             
client [41] (test)  loss: 0.6924 -> 0.7073   acc: 79.65% -> 80.16%             
client [95] (test)  loss: 0.4221 -> 0.5054   acc: 90.67% -> 88.88%             
client [53] (test)  loss: 0.2477 -> 0.2645   acc: 94.54% -> 94.27%             
client [22] (test)  loss: 0.5387 -> 0.6241   acc: 87.02% -> 85.84%             
client [25] (test)  loss: 0.2169 -> 0.2250   acc: 95.40% -> 95.16%             
client [69] (test)  loss: 0.2143 -> 0.2727   acc: 94.45% -> 94.08%             
client [46] (test)  loss: 0.5962 -> 0.6995   acc: 87.58% -> 86.89%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2812 -> 0.3158   acc: 92.80% -> 92.07%             
client [69] (test)  loss: 0.2281 -> 0.2780   acc: 94.35% -> 94.15%             
client [82] (test)  loss: 0.4496 -> 0.4733   acc: 88.32% -> 88.20%             
client [45] (test)  loss: 0.5147 -> 0.5615   acc: 87.60% -> 86.89%             
client [7] (test)  loss: 0.5989 -> 0.6291   acc: 83.41% -> 82.60%              
client [50] (test)  loss: 0.4259 -> 0.4687   acc: 90.89% -> 90.26%             
client [35] (test)  loss: 0.8044 -> 0.9038   acc: 82.47% -> 81.55%             
client [24] (test)  loss: 0.5481 -> 0.5818   acc: 84.62% -> 84.47%             
client [15] (test)  loss: 0.5734 -> 0.6093   acc: 83.99% -> 82.45%             
client [58] (test)  loss: 0.3724 -> 0.4498   acc: 92.04% -> 91.99%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7264 -> 0.8631   acc: 83.40% -> 82.54%             
client [76] (test)  loss: 0.5782 -> 0.6369   acc: 86.72% -> 86.77%             
client [67] (test)  loss: 0.2880 -> 0.3227   acc: 94.45% -> 94.18%             
client [37] (test)  loss: 0.8923 -> 1.0244   acc: 79.14% -> 78.60%             
client [58] (test)  loss: 0.3813 -> 0.4501   acc: 92.04% -> 91.92%             
client [64] (test)  loss: 0.5982 -> 0.6516   acc: 86.64% -> 85.67%             
client [77] (test)  loss: 0.2810 -> 0.3170   acc: 92.49% -> 91.31%             
client [55] (test)  loss: 0.4315 -> 0.4888   acc: 89.38% -> 88.67%             
client [12] (test)  loss: 0.6176 -> 0.6744   acc: 85.82% -> 85.17%             
client [89] (test)  loss: 0.4958 -> 0.5572   acc: 89.13% -> 88.47%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7596 -> 0.9037   acc: 82.46% -> 82.99%             
client [51] (test)  loss: 0.9108 -> 0.9298   acc: 79.12% -> 78.07%             
client [8] (test)  loss: 0.4658 -> 0.5212   acc: 89.80% -> 89.22%              
client [18] (test)  loss: 0.5786 -> 0.6452   acc: 86.86% -> 86.00%             
client [94] (test)  loss: 0.2539 -> 0.2855   acc: 93.56% -> 92.87%             
client [81] (test)  loss: 0.6511 -> 0.7010   acc: 86.63% -> 87.08%             
client [3] (test)  loss: 0.4579 -> 0.5489   acc: 88.99% -> 88.82%              
client [11] (test)  loss: 0.4780 -> 0.5509   acc: 89.50% -> 88.84%             
client [95] (test)  loss: 0.4535 -> 0.5181   acc: 90.08% -> 88.43%             
client [67] (test)  loss: 0.3004 -> 0.3221   acc: 94.43% -> 94.33%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6161 -> 0.6553   acc: 84.97% -> 84.23%             
client [79] (test)  loss: 0.2535 -> 0.2778   acc: 94.52% -> 94.92%             
client [58] (test)  loss: 0.4141 -> 0.4693   acc: 91.75% -> 92.23%             
client [88] (test)  loss: 0.4400 -> 0.5345   acc: 90.24% -> 88.85%             
client [46] (test)  loss: 0.6485 -> 0.7562   acc: 87.84% -> 86.87%             
client [11] (test)  loss: 0.4945 -> 0.5894   acc: 89.52% -> 88.58%             
client [55] (test)  loss: 0.4811 -> 0.5694   acc: 88.53% -> 88.46%             
client [13] (test)  loss: 0.5439 -> 0.6349   acc: 88.40% -> 88.25%             
client [31] (test)  loss: 0.7361 -> 0.7568   acc: 85.62% -> 84.25%             
client [75] (test)  loss: 0.5578 -> 0.6157   acc: 88.62% -> 88.28%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6313 -> 0.7457   acc: 88.00% -> 88.20%             
client [7] (test)  loss: 0.6418 -> 0.7331   acc: 83.36% -> 83.36%              
client [57] (test)  loss: 0.2939 -> 0.3304   acc: 92.83% -> 92.54%             
client [13] (test)  loss: 0.5482 -> 0.6483   acc: 88.47% -> 88.49%             
client [43] (test)  loss: 0.5327 -> 0.6057   acc: 89.14% -> 88.33%             
client [91] (test)  loss: 0.8147 -> 0.8965   acc: 83.52% -> 82.05%             
client [10] (test)  loss: 0.6234 -> 0.7215   acc: 87.69% -> 86.43%             
client [64] (test)  loss: 0.6439 -> 0.7447   acc: 86.27% -> 85.57%             
client [82] (test)  loss: 0.4910 -> 0.5609   acc: 88.10% -> 87.86%             
client [22] (test)  loss: 0.6313 -> 0.7163   acc: 87.07% -> 86.11%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5531 -> 0.5937   acc: 88.78% -> 88.36%             
client [23] (test)  loss: 0.8966 -> 0.9474   acc: 82.94% -> 80.82%             
client [88] (test)  loss: 0.4892 -> 0.5444   acc: 89.93% -> 89.04%             
client [98] (test)  loss: 0.6496 -> 0.6784   acc: 85.04% -> 85.83%             
client [79] (test)  loss: 0.2630 -> 0.2986   acc: 94.79% -> 94.67%             
client [21] (test)  loss: 0.6921 -> 0.6991   acc: 84.43% -> 84.06%             
client [92] (test)  loss: 0.6870 -> 0.7333   acc: 85.92% -> 84.18%             
client [56] (test)  loss: 0.5354 -> 0.5589   acc: 88.32% -> 87.77%             
client [5] (test)  loss: 0.7060 -> 0.7502   acc: 87.24% -> 87.61%              
client [52] (test)  loss: 0.7536 -> 0.8205   acc: 84.61% -> 84.59%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4452 -> 0.0000', 'accuracy': '88.02% -> 0.00%'},          
    200: {'loss': '0.6016 -> 0.0000', 'accuracy': '87.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 40.0%(44.26%) at epoch: 1                                      
FedPer achieved 60.0%(69.40%) at epoch: 2                                      
FedPer achieved 70.0%(72.61%) at epoch: 3                                      
FedPer achieved 80.0%(80.43%) at epoch: 8                                      
FedPer achieved 90.0%(90.14%) at epoch: 58                                     
Convergence (test_after):                                                      
FedPer achieved 70.0%(70.39%) at epoch: 0                                      
FedPer achieved 80.0%(81.24%) at epoch: 2                                      
FedPer achieved 90.0%(90.56%) at epoch: 71                                     
