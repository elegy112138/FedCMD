==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6636 -> 0.6242   acc: 75.36% -> 72.86%             
client [81] (test)  loss: 0.8255 -> 1.0341   acc: 64.15% -> 56.30%             
client [21] (test)  loss: 1.5365 -> 0.9709   acc: 42.50% -> 63.89%             
client [68] (test)  loss: 0.8412 -> 0.9493   acc: 67.09% -> 63.92%             
client [93] (test)  loss: 0.7071 -> 0.6514   acc: 75.24% -> 76.19%             
client [31] (test)  loss: 1.0839 -> 0.7885   acc: 52.68% -> 72.17%             
client [20] (test)  loss: 0.8799 -> 0.9749   acc: 72.93% -> 70.06%             
client [59] (test)  loss: 1.2581 -> 0.5298   acc: 48.86% -> 82.29%             
client [48] (test)  loss: 0.3489 -> 0.3516   acc: 85.30% -> 85.56%             
client [34] (test)  loss: 0.5673 -> 0.6572   acc: 81.79% -> 78.80%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4498 -> 0.3655   acc: 87.27% -> 88.57%             
client [99] (test)  loss: 0.4844 -> 0.7448   acc: 81.07% -> 71.75%             
client [67] (test)  loss: 0.4291 -> 0.4451   acc: 87.91% -> 85.89%             
client [0] (test)  loss: 0.5328 -> 0.5983   acc: 80.59% -> 79.52%              
client [76] (test)  loss: 0.3836 -> 0.3987   acc: 87.79% -> 85.01%             
client [41] (test)  loss: 0.7655 -> 0.8194   acc: 73.06% -> 67.16%             
client [62] (test)  loss: 1.5437 -> 0.6333   acc: 41.59% -> 75.54%             
client [2] (test)  loss: 0.9358 -> 0.6516   acc: 60.37% -> 74.36%              
client [14] (test)  loss: 0.5137 -> 0.5977   acc: 81.86% -> 77.58%             
client [46] (test)  loss: 0.3888 -> 0.4364   acc: 86.30% -> 82.80%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4784 -> 0.6592   acc: 84.89% -> 79.35%             
client [68] (test)  loss: 0.7416 -> 0.7656   acc: 69.62% -> 68.35%             
client [57] (test)  loss: 0.5421 -> 0.4786   acc: 82.67% -> 84.84%             
client [17] (test)  loss: 0.3317 -> 0.3052   acc: 89.27% -> 89.27%             
client [54] (test)  loss: 0.3546 -> 0.3355   acc: 88.31% -> 88.31%             
client [23] (test)  loss: 0.6071 -> 0.4110   acc: 84.93% -> 86.20%             
client [35] (test)  loss: 0.4411 -> 0.4343   acc: 85.07% -> 84.70%             
client [59] (test)  loss: 0.3834 -> 0.4278   acc: 88.00% -> 85.43%             
client [31] (test)  loss: 0.6782 -> 0.6776   acc: 73.76% -> 74.16%             
client [9] (test)  loss: 0.5238 -> 0.6124   acc: 80.86% -> 77.33%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5502 -> 0.5683   acc: 78.19% -> 77.05%             
client [33] (test)  loss: 0.4901 -> 0.5875   acc: 78.92% -> 78.11%             
client [16] (test)  loss: 0.2457 -> 0.2441   acc: 93.46% -> 92.67%             
client [44] (test)  loss: 0.6641 -> 2.0942   acc: 75.11% -> 43.39%             
client [8] (test)  loss: 0.4539 -> 0.5350   acc: 83.23% -> 80.00%              
client [31] (test)  loss: 0.6499 -> 0.6521   acc: 75.55% -> 74.95%             
client [47] (test)  loss: 0.7773 -> 0.6981   acc: 68.91% -> 74.91%             
client [36] (test)  loss: 0.6194 -> 0.6204   acc: 77.30% -> 76.99%             
client [20] (test)  loss: 0.7156 -> 0.7485   acc: 77.71% -> 76.75%             
client [56] (test)  loss: 0.4929 -> 0.5352   acc: 81.88% -> 79.38%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5726 -> 0.5580   acc: 76.55% -> 75.00%              
client [60] (test)  loss: 0.3401 -> 0.5530   acc: 88.37% -> 81.68%             
client [28] (test)  loss: 0.6908 -> 0.7563   acc: 77.42% -> 74.19%             
client [25] (test)  loss: 0.5699 -> 0.5620   acc: 77.31% -> 78.10%             
client [58] (test)  loss: 0.2972 -> 0.3348   acc: 88.48% -> 87.17%             
client [44] (test)  loss: 0.4022 -> 1.7207   acc: 85.90% -> 47.58%             
client [39] (test)  loss: 0.4896 -> 0.6197   acc: 80.93% -> 77.93%             
client [29] (test)  loss: 0.6597 -> 0.5465   acc: 76.95% -> 82.93%             
client [3] (test)  loss: 0.3715 -> 0.3766   acc: 85.67% -> 84.85%              
client [84] (test)  loss: 0.3974 -> 0.4504   acc: 84.93% -> 82.61%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4382 -> 0.7275   acc: 87.78% -> 71.11%             
client [84] (test)  loss: 0.4064 -> 0.4448   acc: 86.09% -> 82.90%             
client [10] (test)  loss: 0.3412 -> 0.7040   acc: 86.94% -> 77.78%             
client [36] (test)  loss: 0.5027 -> 0.5771   acc: 80.98% -> 76.99%             
client [65] (test)  loss: 0.4028 -> 0.4325   acc: 85.27% -> 85.27%             
client [81] (test)  loss: 0.6021 -> 0.6989   acc: 74.51% -> 67.79%             
client [79] (test)  loss: 0.4820 -> 0.5563   acc: 82.32% -> 77.62%             
client [42] (test)  loss: 0.4248 -> 0.4846   acc: 83.26% -> 83.72%             
client [11] (test)  loss: 0.5010 -> 0.5310   acc: 83.33% -> 80.80%             
client [96] (test)  loss: 0.3317 -> 0.3392   acc: 88.64% -> 88.92%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4948 -> 0.4706   acc: 82.90% -> 83.23%              
client [53] (test)  loss: 0.2072 -> 0.2626   acc: 91.89% -> 89.25%             
client [52] (test)  loss: 0.6307 -> 0.6479   acc: 74.79% -> 74.52%             
client [42] (test)  loss: 0.4052 -> 0.5071   acc: 83.26% -> 79.07%             
client [69] (test)  loss: 0.2677 -> 0.2776   acc: 90.13% -> 89.87%             
client [59] (test)  loss: 0.3184 -> 0.3977   acc: 88.29% -> 86.57%             
client [7] (test)  loss: 0.6583 -> 0.5679   acc: 77.22% -> 80.00%              
client [26] (test)  loss: 0.3280 -> 0.5186   acc: 87.37% -> 81.40%             
client [49] (test)  loss: 0.4626 -> 0.5379   acc: 82.10% -> 78.04%             
client [98] (test)  loss: 0.5219 -> 0.8351   acc: 78.61% -> 67.50%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5442 -> 0.8153   acc: 77.50% -> 67.78%             
client [47] (test)  loss: 0.6334 -> 0.6102   acc: 76.40% -> 74.53%             
client [21] (test)  loss: 0.4509 -> 0.6621   acc: 83.61% -> 77.22%             
client [77] (test)  loss: 0.4714 -> 0.4495   acc: 82.86% -> 82.50%             
client [95] (test)  loss: 0.3923 -> 0.3962   acc: 86.48% -> 85.35%             
client [91] (test)  loss: 0.5253 -> 0.5465   acc: 80.53% -> 80.26%             
client [14] (test)  loss: 0.4178 -> 0.4978   acc: 84.89% -> 82.37%             
client [99] (test)  loss: 0.2977 -> 0.2999   acc: 89.83% -> 89.55%             
client [20] (test)  loss: 0.6983 -> 0.6776   acc: 79.30% -> 79.30%             
client [39] (test)  loss: 0.4826 -> 0.5666   acc: 82.02% -> 78.75%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6440 -> 0.6205   acc: 72.85% -> 76.18%             
client [62] (test)  loss: 0.4085 -> 0.4927   acc: 85.93% -> 81.35%             
client [71] (test)  loss: 0.3372 -> 0.3641   acc: 87.01% -> 86.72%             
client [97] (test)  loss: 0.6717 -> 0.7273   acc: 78.73% -> 76.87%             
client [30] (test)  loss: 0.4053 -> 0.4426   acc: 85.81% -> 86.82%             
client [88] (test)  loss: 0.4999 -> 0.5034   acc: 82.09% -> 77.96%             
client [60] (test)  loss: 0.2988 -> 0.5082   acc: 89.36% -> 83.91%             
client [82] (test)  loss: 0.3239 -> 0.4124   acc: 87.06% -> 83.33%             
client [91] (test)  loss: 0.4674 -> 0.5337   acc: 82.37% -> 80.53%             
client [57] (test)  loss: 0.3625 -> 0.3955   acc: 87.73% -> 87.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6063 -> 0.6007   acc: 77.53% -> 77.34%             
client [15] (test)  loss: 0.3994 -> 0.4375   acc: 84.49% -> 84.21%             
client [71] (test)  loss: 0.3521 -> 0.3597   acc: 86.72% -> 87.01%             
client [97] (test)  loss: 0.6316 -> 0.6947   acc: 78.36% -> 76.87%             
client [53] (test)  loss: 0.1996 -> 0.2127   acc: 92.98% -> 90.57%             
client [77] (test)  loss: 0.4277 -> 0.4206   acc: 82.14% -> 82.86%             
client [76] (test)  loss: 0.2838 -> 0.2929   acc: 91.22% -> 91.22%             
client [79] (test)  loss: 0.4493 -> 0.4997   acc: 82.04% -> 80.39%             
client [28] (test)  loss: 0.5992 -> 0.6365   acc: 78.80% -> 78.34%             
client [99] (test)  loss: 0.3009 -> 0.2894   acc: 88.98% -> 89.55%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6045 -> 0.6910   acc: 79.48% -> 77.24%             
client [86] (test)  loss: 0.2563 -> 0.2673   acc: 90.70% -> 88.37%             
client [34] (test)  loss: 0.3697 -> 0.5047   acc: 87.23% -> 80.43%             
client [73] (test)  loss: 0.3917 -> 0.4239   acc: 88.06% -> 87.46%             
client [5] (test)  loss: 0.4615 -> 0.5291   acc: 85.44% -> 83.14%              
client [96] (test)  loss: 0.2822 -> 0.2909   acc: 90.30% -> 90.58%             
client [22] (test)  loss: 0.4843 -> 0.4922   acc: 82.90% -> 80.97%             
client [60] (test)  loss: 0.2627 -> 0.5277   acc: 91.09% -> 83.66%             
client [66] (test)  loss: 0.4714 -> 0.4703   acc: 83.70% -> 83.33%             
client [83] (test)  loss: 0.2538 -> 0.9625   acc: 89.69% -> 68.56%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2655 -> 0.2799   acc: 91.65% -> 90.79%             
client [65] (test)  loss: 0.3480 -> 0.3774   acc: 87.28% -> 85.94%             
client [95] (test)  loss: 0.3745 -> 0.3702   acc: 87.04% -> 86.20%             
client [17] (test)  loss: 0.3347 -> 0.2662   acc: 90.05% -> 91.10%             
client [8] (test)  loss: 0.4653 -> 0.4237   acc: 83.55% -> 85.81%              
client [35] (test)  loss: 0.3139 -> 0.3230   acc: 88.62% -> 88.81%             
client [98] (test)  loss: 0.5251 -> 1.0384   acc: 79.44% -> 69.17%             
client [53] (test)  loss: 0.1861 -> 0.1885   acc: 92.98% -> 92.32%             
client [43] (test)  loss: 0.2667 -> 0.2216   acc: 90.32% -> 92.47%             
client [64] (test)  loss: 0.4735 -> 0.4771   acc: 81.30% -> 81.87%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4539 -> 0.6981   acc: 84.44% -> 79.17%             
client [88] (test)  loss: 0.4613 -> 0.4994   acc: 82.37% -> 79.34%             
client [38] (test)  loss: 0.3306 -> 0.3839   acc: 88.68% -> 86.48%             
client [3] (test)  loss: 0.3495 -> 0.3442   acc: 86.23% -> 86.78%              
client [5] (test)  loss: 0.5079 -> 0.5167   acc: 84.29% -> 83.14%              
client [41] (test)  loss: 0.4765 -> 0.5485   acc: 81.18% -> 77.86%             
client [7] (test)  loss: 0.5505 -> 0.5189   acc: 83.33% -> 82.50%              
client [37] (test)  loss: 0.3305 -> 0.3635   acc: 89.94% -> 86.59%             
client [45] (test)  loss: 0.4486 -> 0.3486   acc: 81.41% -> 86.39%             
client [47] (test)  loss: 0.5651 -> 0.5684   acc: 79.78% -> 75.66%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2134 -> 0.2089   acc: 93.98% -> 93.72%             
client [11] (test)  loss: 0.4998 -> 0.5233   acc: 82.97% -> 83.70%             
client [37] (test)  loss: 0.3200 -> 0.3378   acc: 91.06% -> 88.27%             
client [41] (test)  loss: 0.4559 -> 0.5481   acc: 82.66% -> 77.12%             
client [95] (test)  loss: 0.3742 -> 0.3830   acc: 87.04% -> 85.35%             
client [53] (test)  loss: 0.1832 -> 0.1773   acc: 92.98% -> 92.54%             
client [22] (test)  loss: 0.4369 -> 0.4810   acc: 83.23% -> 81.29%             
client [25] (test)  loss: 0.4186 -> 0.4911   acc: 83.64% -> 80.21%             
client [69] (test)  loss: 0.2343 -> 0.2551   acc: 92.73% -> 92.21%             
client [46] (test)  loss: 0.2896 -> 0.3157   acc: 88.05% -> 88.05%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5075 -> 0.6185   acc: 80.52% -> 75.66%             
client [69] (test)  loss: 0.2260 -> 0.2527   acc: 92.73% -> 91.69%             
client [82] (test)  loss: 0.2890 -> 0.3765   acc: 89.80% -> 86.82%             
client [45] (test)  loss: 0.3302 -> 0.3262   acc: 90.05% -> 87.70%             
client [7] (test)  loss: 0.5040 -> 0.5041   acc: 82.22% -> 83.06%              
client [50] (test)  loss: 0.4933 -> 0.5310   acc: 83.47% -> 82.35%             
client [35] (test)  loss: 0.3125 -> 0.3111   acc: 88.25% -> 89.55%             
client [24] (test)  loss: 0.3919 -> 0.4718   acc: 86.65% -> 85.14%             
client [15] (test)  loss: 0.3569 -> 0.4095   acc: 86.70% -> 85.60%             
client [58] (test)  loss: 0.2228 -> 0.2552   acc: 92.41% -> 90.05%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2899 -> 0.2252   acc: 86.35% -> 89.50%             
client [76] (test)  loss: 0.2696 -> 0.2707   acc: 91.65% -> 91.43%             
client [67] (test)  loss: 0.3243 -> 0.3366   acc: 90.43% -> 88.92%             
client [37] (test)  loss: 0.3462 -> 0.3389   acc: 89.66% -> 89.11%             
client [58] (test)  loss: 0.2597 -> 0.2598   acc: 91.10% -> 89.53%             
client [64] (test)  loss: 0.4529 -> 0.4851   acc: 82.15% -> 81.02%             
client [77] (test)  loss: 0.3891 -> 0.4179   acc: 85.36% -> 83.93%             
client [55] (test)  loss: 0.4960 -> 0.4303   acc: 81.41% -> 84.93%             
client [12] (test)  loss: 0.4731 -> 0.6491   acc: 82.73% -> 77.27%             
client [89] (test)  loss: 0.4106 -> 0.4397   acc: 85.21% -> 84.89%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3787 -> 0.3617   acc: 87.54% -> 86.67%             
client [51] (test)  loss: 0.4522 -> 0.4828   acc: 83.48% -> 83.48%             
client [8] (test)  loss: 0.3832 -> 0.4075   acc: 87.74% -> 86.77%              
client [18] (test)  loss: 0.2970 -> 0.3787   acc: 90.58% -> 88.15%             
client [94] (test)  loss: 0.4804 -> 0.5251   acc: 79.34% -> 80.17%             
client [81] (test)  loss: 0.5505 -> 0.6274   acc: 79.27% -> 76.75%             
client [3] (test)  loss: 0.3752 -> 0.3439   acc: 86.50% -> 85.95%              
client [11] (test)  loss: 0.4713 -> 0.5215   acc: 85.14% -> 82.97%             
client [95] (test)  loss: 0.4054 -> 0.3893   acc: 85.35% -> 86.48%             
client [67] (test)  loss: 0.3115 -> 0.3392   acc: 90.93% -> 89.67%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4582 -> 0.6034   acc: 85.00% -> 81.94%             
client [79] (test)  loss: 0.4025 -> 0.4168   acc: 85.64% -> 85.91%             
client [58] (test)  loss: 0.2146 -> 0.2900   acc: 91.88% -> 89.27%             
client [88] (test)  loss: 0.4582 -> 0.5074   acc: 82.64% -> 79.34%             
client [46] (test)  loss: 0.2662 -> 0.3180   acc: 90.67% -> 88.92%             
client [11] (test)  loss: 0.4800 -> 0.5317   acc: 84.42% -> 83.33%             
client [55] (test)  loss: 0.4084 -> 0.4140   acc: 84.74% -> 84.54%             
client [13] (test)  loss: 0.2971 -> 0.3236   acc: 88.45% -> 88.45%             
client [31] (test)  loss: 0.5776 -> 0.5679   acc: 78.73% -> 78.13%             
client [75] (test)  loss: 0.3573 -> 0.3552   acc: 87.12% -> 87.12%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3024 -> 0.2495   acc: 88.97% -> 91.38%             
client [7] (test)  loss: 0.4880 -> 0.4945   acc: 82.22% -> 82.78%              
client [57] (test)  loss: 0.3416 -> 0.3555   acc: 89.53% -> 89.17%             
client [13] (test)  loss: 0.3466 -> 0.3224   acc: 86.88% -> 87.93%             
client [43] (test)  loss: 0.2046 -> 0.2009   acc: 91.94% -> 92.47%             
client [91] (test)  loss: 0.4346 -> 0.4711   acc: 85.00% -> 83.68%             
client [10] (test)  loss: 0.3163 -> 0.3416   acc: 89.72% -> 87.22%             
client [64] (test)  loss: 0.4381 -> 0.4646   acc: 84.14% -> 81.30%             
client [82] (test)  loss: 0.3054 -> 0.3547   acc: 90.05% -> 88.56%             
client [22] (test)  loss: 0.4964 -> 0.4497   acc: 82.90% -> 83.23%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6080 -> 0.6164   acc: 79.30% -> 82.80%             
client [23] (test)  loss: 0.2472 -> 0.2640   acc: 93.21% -> 92.14%             
client [88] (test)  loss: 0.4785 -> 0.4901   acc: 82.09% -> 81.54%             
client [98] (test)  loss: 0.4718 -> 0.9671   acc: 82.50% -> 69.44%             
client [79] (test)  loss: 0.4078 -> 0.4116   acc: 83.98% -> 84.81%             
client [21] (test)  loss: 0.4004 -> 0.6447   acc: 86.39% -> 81.67%             
client [92] (test)  loss: 0.4740 -> 0.5567   acc: 83.02% -> 80.59%             
client [56] (test)  loss: 0.4336 -> 0.5964   acc: 86.56% -> 79.69%             
client [5] (test)  loss: 0.4253 -> 0.4802   acc: 86.21% -> 83.14%              
client [52] (test)  loss: 0.4844 -> 0.4966   acc: 82.83% -> 83.93%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4194 -> 0.0000', 'accuracy': '84.82% -> 0.00%'},          
    200: {'loss': '0.3778 -> 0.0000', 'accuracy': '86.69% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(14.47%) at epoch: 0                                      
FedRep achieved 20.0%(20.66%) at epoch: 1                                      
FedRep achieved 40.0%(42.61%) at epoch: 3                                      
FedRep achieved 70.0%(72.13%) at epoch: 7                                      
FedRep achieved 80.0%(80.80%) at epoch: 28                                     
Convergence (test_after):                                                      
FedRep achieved 60.0%(64.15%) at epoch: 0                                      
FedRep achieved 70.0%(73.51%) at epoch: 8                                      
FedRep achieved 80.0%(80.13%) at epoch: 13                                     
