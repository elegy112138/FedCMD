==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3342 -> 2.3152   acc: 20.16% -> 20.16%             
client [81] (test)  loss: 2.3472 -> 2.3101   acc: 9.84% -> 24.59%              
client [21] (test)  loss: 2.3825 -> 2.3537   acc: 18.49% -> 18.49%             
client [68] (test)  loss: 2.3464 -> 2.3109   acc: 28.28% -> 28.28%             
client [93] (test)  loss: 2.2112 -> 2.0889   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.3823 -> 2.3635   acc: 10.26% -> 10.26%             
client [20] (test)  loss: 2.3541 -> 2.3279   acc: 33.09% -> 33.09%             
client [59] (test)  loss: 2.3583 -> 2.3202   acc: 36.22% -> 36.22%             
client [48] (test)  loss: 2.3710 -> 2.3652   acc: 16.36% -> 16.36%             
client [34] (test)  loss: 2.3255 -> 2.2832   acc: 28.17% -> 35.92%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.3699 -> 2.3474   acc: 8.04% -> 25.89%              
client [99] (test)  loss: 2.3345 -> 2.3168   acc: 15.91% -> 15.91%             
client [67] (test)  loss: 2.3030 -> 2.2642   acc: 19.05% -> 19.05%             
client [0] (test)  loss: 2.2038 -> 2.0756   acc: 19.65% -> 36.42%              
client [76] (test)  loss: 2.2705 -> 2.2398   acc: 31.65% -> 31.65%             
client [41] (test)  loss: 2.2795 -> 2.2231   acc: 24.59% -> 24.59%             
client [62] (test)  loss: 2.3570 -> 2.3047   acc: 5.63% -> 5.63%               
client [2] (test)  loss: 2.2097 -> 1.9200   acc: 63.45% -> 63.45%              
client [14] (test)  loss: 2.2787 -> 2.2408   acc: 23.62% -> 23.62%             
client [46] (test)  loss: 2.1837 -> 2.0649   acc: 52.99% -> 52.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.3509 -> 2.2981   acc: 5.36% -> 10.71%              
client [68] (test)  loss: 1.8563 -> 1.9079   acc: 30.30% -> 30.30%             
client [57] (test)  loss: 1.9980 -> 1.8940   acc: 39.18% -> 39.18%             
client [17] (test)  loss: 2.1050 -> 1.9036   acc: 21.15% -> 33.65%             
client [54] (test)  loss: 2.0021 -> 1.9415   acc: 35.14% -> 35.14%             
client [23] (test)  loss: 2.2890 -> 2.1614   acc: 22.97% -> 22.97%             
client [35] (test)  loss: 1.9733 -> 1.8883   acc: 16.67% -> 40.48%             
client [59] (test)  loss: 1.8814 -> 1.7793   acc: 36.22% -> 36.22%             
client [31] (test)  loss: 1.9941 -> 1.9758   acc: 34.62% -> 34.62%             
client [9] (test)  loss: 2.2128 -> 2.1142   acc: 11.34% -> 11.34%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.8611 -> 1.8109   acc: 28.80% -> 29.60%             
client [33] (test)  loss: 1.7981 -> 1.6989   acc: 57.94% -> 58.88%             
client [16] (test)  loss: 1.8775 -> 1.8394   acc: 41.67% -> 41.67%             
client [44] (test)  loss: 2.4578 -> 1.8631   acc: 10.37% -> 24.44%             
client [8] (test)  loss: 1.1035 -> 1.0582   acc: 65.28% -> 65.28%              
client [31] (test)  loss: 2.0211 -> 2.0469   acc: 34.62% -> 34.62%             
client [47] (test)  loss: 1.5242 -> 1.3774   acc: 34.45% -> 73.11%             
client [36] (test)  loss: 1.9029 -> 1.8573   acc: 35.90% -> 35.90%             
client [20] (test)  loss: 1.8702 -> 1.8263   acc: 33.09% -> 33.09%             
client [56] (test)  loss: 1.8946 -> 1.8233   acc: 23.93% -> 35.04%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.8878 -> 1.8528   acc: 31.90% -> 40.52%              
client [60] (test)  loss: 2.2842 -> 1.9487   acc: 26.32% -> 26.32%             
client [28] (test)  loss: 2.0504 -> 1.5121   acc: 30.65% -> 55.65%             
client [25] (test)  loss: 2.3672 -> 1.8086   acc: 7.44% -> 38.84%              
client [58] (test)  loss: 1.5721 -> 1.3545   acc: 41.88% -> 49.38%             
client [44] (test)  loss: 1.8095 -> 1.6014   acc: 24.44% -> 42.22%             
client [39] (test)  loss: 0.8855 -> 0.8355   acc: 76.43% -> 76.43%             
client [29] (test)  loss: 2.5603 -> 1.3705   acc: 45.38% -> 48.74%             
client [3] (test)  loss: 1.9743 -> 1.8688   acc: 35.59% -> 37.29%              
client [84] (test)  loss: 0.8452 -> 0.8472   acc: 63.80% -> 61.96%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.8068 -> 1.0899   acc: 47.06% -> 57.98%             
client [84] (test)  loss: 0.7693 -> 2.6564   acc: 68.71% -> 34.36%             
client [10] (test)  loss: 2.4372 -> 1.9000   acc: 28.21% -> 38.46%             
client [36] (test)  loss: 1.6841 -> 1.6770   acc: 28.21% -> 28.21%             
client [65] (test)  loss: 1.5676 -> 1.5064   acc: 42.37% -> 42.37%             
client [81] (test)  loss: 1.6943 -> 1.5097   acc: 37.70% -> 39.34%             
client [79] (test)  loss: 1.3033 -> 1.2674   acc: 62.39% -> 62.39%             
client [42] (test)  loss: 1.4905 -> 1.4524   acc: 39.06% -> 44.53%             
client [11] (test)  loss: 1.7008 -> 1.5351   acc: 46.97% -> 46.97%             
client [96] (test)  loss: 1.6611 -> 1.4631   acc: 42.02% -> 48.74%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6484 -> 0.9979   acc: 79.17% -> 68.06%              
client [53] (test)  loss: 1.3785 -> 1.9766   acc: 49.58% -> 52.94%             
client [52] (test)  loss: 1.2132 -> 1.2837   acc: 51.16% -> 62.02%             
client [42] (test)  loss: 1.3290 -> 1.2998   acc: 53.12% -> 51.56%             
client [69] (test)  loss: 1.2731 -> 1.2219   acc: 57.14% -> 58.93%             
client [59] (test)  loss: 1.2431 -> 1.3045   acc: 50.39% -> 53.54%             
client [7] (test)  loss: 2.1541 -> 1.7193   acc: 30.37% -> 25.93%              
client [26] (test)  loss: 2.2034 -> 1.7203   acc: 21.54% -> 25.38%             
client [49] (test)  loss: 1.2068 -> 1.9707   acc: 60.29% -> 33.82%             
client [98] (test)  loss: 1.4434 -> 1.7204   acc: 57.89% -> 37.72%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2424 -> 2.0328   acc: 62.28% -> 50.88%             
client [47] (test)  loss: 0.8167 -> 0.7441   acc: 70.59% -> 77.31%             
client [21] (test)  loss: 0.8367 -> 0.8883   acc: 78.99% -> 68.91%             
client [77] (test)  loss: 1.1822 -> 1.1628   acc: 62.10% -> 58.87%             
client [95] (test)  loss: 0.9257 -> 0.9122   acc: 72.07% -> 70.95%             
client [91] (test)  loss: 1.2244 -> 1.1747   acc: 49.21% -> 57.14%             
client [14] (test)  loss: 0.8302 -> 0.8171   acc: 71.65% -> 70.08%             
client [99] (test)  loss: 1.3298 -> 1.3421   acc: 46.59% -> 46.59%             
client [20] (test)  loss: 1.2206 -> 1.2373   acc: 61.87% -> 60.43%             
client [39] (test)  loss: 0.5733 -> 0.5573   acc: 82.86% -> 82.14%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.0664 -> 1.6800   acc: 57.36% -> 37.98%             
client [62] (test)  loss: 1.0174 -> 1.2235   acc: 70.42% -> 56.34%             
client [71] (test)  loss: 1.4408 -> 1.6320   acc: 41.22% -> 35.88%             
client [97] (test)  loss: 0.5083 -> 0.5763   acc: 87.92% -> 79.19%             
client [30] (test)  loss: 0.9481 -> 0.9439   acc: 66.93% -> 67.72%             
client [88] (test)  loss: 1.2433 -> 1.1754   acc: 58.82% -> 56.62%             
client [60] (test)  loss: 1.2691 -> 1.3331   acc: 53.95% -> 53.95%             
client [82] (test)  loss: 0.8712 -> 0.6846   acc: 64.75% -> 81.97%             
client [91] (test)  loss: 1.0963 -> 1.0593   acc: 57.14% -> 55.56%             
client [57] (test)  loss: 1.1416 -> 1.2484   acc: 56.73% -> 57.31%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5653 -> 2.9099   acc: 58.97% -> 15.38%             
client [15] (test)  loss: 0.6288 -> 0.5150   acc: 80.92% -> 82.44%             
client [71] (test)  loss: 1.5322 -> 1.9466   acc: 40.46% -> 29.01%             
client [97] (test)  loss: 0.5624 -> 0.4719   acc: 79.87% -> 86.58%             
client [53] (test)  loss: 0.7839 -> 1.0169   acc: 72.27% -> 66.39%             
client [77] (test)  loss: 0.9713 -> 1.0473   acc: 66.94% -> 62.10%             
client [76] (test)  loss: 0.7756 -> 0.6415   acc: 74.68% -> 79.75%             
client [79] (test)  loss: 0.8546 -> 0.7747   acc: 69.23% -> 72.65%             
client [28] (test)  loss: 0.7779 -> 0.7405   acc: 76.61% -> 70.16%             
client [99] (test)  loss: 1.2594 -> 1.2200   acc: 52.27% -> 51.14%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3630 -> 0.4528   acc: 89.26% -> 88.59%             
client [86] (test)  loss: 0.3447 -> 0.3291   acc: 91.06% -> 91.06%             
client [34] (test)  loss: 0.9686 -> 1.0500   acc: 62.68% -> 63.38%             
client [73] (test)  loss: 1.0175 -> 1.0861   acc: 59.20% -> 57.60%             
client [5] (test)  loss: 1.4637 -> 1.4627   acc: 44.76% -> 43.81%              
client [96] (test)  loss: 0.9397 -> 1.4133   acc: 64.71% -> 54.62%             
client [22] (test)  loss: 1.3193 -> 1.4396   acc: 56.07% -> 54.21%             
client [60] (test)  loss: 1.0340 -> 1.3042   acc: 67.11% -> 53.95%             
client [66] (test)  loss: 0.7813 -> 0.6922   acc: 70.97% -> 77.42%             
client [83] (test)  loss: 0.9730 -> 0.9838   acc: 71.68% -> 74.34%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5390 -> 0.5508   acc: 81.01% -> 82.28%             
client [65] (test)  loss: 1.1268 -> 1.4744   acc: 61.02% -> 50.85%             
client [95] (test)  loss: 0.7868 -> 0.8193   acc: 72.63% -> 74.86%             
client [17] (test)  loss: 1.0870 -> 1.0575   acc: 60.58% -> 64.42%             
client [8] (test)  loss: 0.4161 -> 0.4321   acc: 86.11% -> 83.33%              
client [35] (test)  loss: 0.8720 -> 1.7044   acc: 73.81% -> 44.05%             
client [98] (test)  loss: 0.8392 -> 1.0894   acc: 71.93% -> 66.67%             
client [53] (test)  loss: 0.6627 -> 0.9032   acc: 74.79% -> 66.39%             
client [43] (test)  loss: 0.3996 -> 0.4134   acc: 87.56% -> 88.52%             
client [64] (test)  loss: 0.7439 -> 0.6873   acc: 67.20% -> 71.20%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4967 -> 0.4784   acc: 85.71% -> 84.87%             
client [88] (test)  loss: 0.8452 -> 1.0413   acc: 72.06% -> 64.71%             
client [38] (test)  loss: 0.9201 -> 0.8365   acc: 69.05% -> 71.43%             
client [3] (test)  loss: 0.9394 -> 0.9644   acc: 68.64% -> 66.10%              
client [5] (test)  loss: 1.2807 -> 1.6243   acc: 49.52% -> 46.67%              
client [41] (test)  loss: 0.8264 -> 1.2378   acc: 70.49% -> 56.56%             
client [7] (test)  loss: 1.0590 -> 1.2500   acc: 54.81% -> 50.37%              
client [37] (test)  loss: 0.8126 -> 0.9766   acc: 70.75% -> 65.09%             
client [45] (test)  loss: 0.7644 -> 0.6686   acc: 77.78% -> 80.81%             
client [47] (test)  loss: 0.5740 -> 0.6274   acc: 78.99% -> 78.15%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8484 -> 0.7214   acc: 73.61% -> 77.78%             
client [11] (test)  loss: 0.8752 -> 1.2374   acc: 68.94% -> 63.64%             
client [37] (test)  loss: 0.7372 -> 0.7663   acc: 72.64% -> 69.34%             
client [41] (test)  loss: 0.6699 -> 0.9442   acc: 77.05% -> 64.75%             
client [95] (test)  loss: 0.6525 -> 0.6353   acc: 78.21% -> 81.56%             
client [53] (test)  loss: 0.5025 -> 0.6757   acc: 81.51% -> 75.63%             
client [22] (test)  loss: 1.0817 -> 1.6191   acc: 64.49% -> 54.21%             
client [25] (test)  loss: 0.8349 -> 0.9812   acc: 66.94% -> 61.98%             
client [69] (test)  loss: 0.6649 -> 0.6304   acc: 76.79% -> 79.46%             
client [46] (test)  loss: 0.8710 -> 1.2004   acc: 71.79% -> 66.67%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5538 -> 0.6727   acc: 82.35% -> 76.47%             
client [69] (test)  loss: 0.7000 -> 0.6029   acc: 76.79% -> 79.46%             
client [82] (test)  loss: 0.3121 -> 0.3220   acc: 89.34% -> 92.62%             
client [45] (test)  loss: 0.6503 -> 0.6259   acc: 81.82% -> 80.81%             
client [7] (test)  loss: 1.0231 -> 1.2153   acc: 57.04% -> 50.37%              
client [50] (test)  loss: 0.1716 -> 0.1970   acc: 95.56% -> 93.33%             
client [35] (test)  loss: 0.6923 -> 1.0807   acc: 77.38% -> 63.10%             
client [24] (test)  loss: 0.7348 -> 0.6807   acc: 71.43% -> 69.64%             
client [15] (test)  loss: 0.4323 -> 0.4429   acc: 83.97% -> 83.21%             
client [58] (test)  loss: 0.4398 -> 0.5734   acc: 85.62% -> 83.12%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8831 -> 0.8758   acc: 74.55% -> 78.18%             
client [76] (test)  loss: 0.4238 -> 0.4734   acc: 84.81% -> 86.08%             
client [67] (test)  loss: 0.8269 -> 0.9010   acc: 71.43% -> 61.11%             
client [37] (test)  loss: 0.6640 -> 1.8549   acc: 78.30% -> 40.57%             
client [58] (test)  loss: 0.3856 -> 0.5126   acc: 90.00% -> 86.25%             
client [64] (test)  loss: 0.5513 -> 0.5145   acc: 78.40% -> 80.00%             
client [77] (test)  loss: 0.7380 -> 0.6682   acc: 71.77% -> 74.19%             
client [55] (test)  loss: 0.4525 -> 0.4580   acc: 84.92% -> 85.71%             
client [12] (test)  loss: 1.2359 -> 1.2334   acc: 65.00% -> 62.86%             
client [89] (test)  loss: 0.6509 -> 5.9498   acc: 79.71% -> 34.78%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1870 -> 0.1814   acc: 93.87% -> 93.87%             
client [51] (test)  loss: 0.4802 -> 0.5166   acc: 83.87% -> 83.87%             
client [8] (test)  loss: 0.3535 -> 0.3295   acc: 85.42% -> 85.42%              
client [18] (test)  loss: 0.8872 -> 1.0459   acc: 64.95% -> 61.86%             
client [94] (test)  loss: 0.1937 -> 0.1812   acc: 95.00% -> 95.83%             
client [81] (test)  loss: 0.6705 -> 0.8460   acc: 69.67% -> 65.57%             
client [3] (test)  loss: 0.8079 -> 0.7875   acc: 73.73% -> 76.27%              
client [11] (test)  loss: 0.9420 -> 1.1520   acc: 71.21% -> 64.39%             
client [95] (test)  loss: 0.7002 -> 0.5676   acc: 77.65% -> 82.68%             
client [67] (test)  loss: 0.7289 -> 0.8990   acc: 73.02% -> 67.46%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4136 -> 0.3865   acc: 87.39% -> 89.92%             
client [79] (test)  loss: 0.5078 -> 0.4265   acc: 81.20% -> 84.62%             
client [58] (test)  loss: 0.4008 -> 0.3749   acc: 88.12% -> 89.38%             
client [88] (test)  loss: 0.7987 -> 0.9746   acc: 72.79% -> 66.91%             
client [46] (test)  loss: 0.8957 -> 1.0141   acc: 71.79% -> 71.79%             
client [11] (test)  loss: 0.7734 -> 1.3278   acc: 74.24% -> 65.15%             
client [55] (test)  loss: 0.4914 -> 0.4194   acc: 85.71% -> 86.51%             
client [13] (test)  loss: 1.0640 -> 0.9446   acc: 73.17% -> 70.73%             
client [31] (test)  loss: 1.1936 -> 1.2468   acc: 67.95% -> 73.08%             
client [75] (test)  loss: 0.6908 -> 0.8679   acc: 79.83% -> 73.95%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4498 -> 0.4583   acc: 87.39% -> 78.99%             
client [7] (test)  loss: 0.8250 -> 1.6941   acc: 70.37% -> 28.89%              
client [57] (test)  loss: 0.5737 -> 0.9505   acc: 82.46% -> 69.01%             
client [13] (test)  loss: 0.7622 -> 1.0010   acc: 76.83% -> 71.95%             
client [43] (test)  loss: 0.3055 -> 0.4015   acc: 91.87% -> 89.95%             
client [91] (test)  loss: 0.6636 -> 0.6014   acc: 80.95% -> 79.37%             
client [10] (test)  loss: 0.7580 -> 0.7731   acc: 71.79% -> 76.92%             
client [64] (test)  loss: 0.4467 -> 0.4424   acc: 80.80% -> 81.60%             
client [82] (test)  loss: 0.2606 -> 0.2662   acc: 90.98% -> 92.62%             
client [22] (test)  loss: 0.9069 -> 1.2960   acc: 72.90% -> 57.94%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9539 -> 0.9543   acc: 66.19% -> 69.06%             
client [23] (test)  loss: 0.5671 -> 0.5729   acc: 78.38% -> 81.08%             
client [88] (test)  loss: 0.6218 -> 0.8423   acc: 80.15% -> 76.47%             
client [98] (test)  loss: 0.6184 -> 0.7575   acc: 80.70% -> 78.07%             
client [79] (test)  loss: 0.3839 -> 0.3903   acc: 87.18% -> 85.47%             
client [21] (test)  loss: 0.3610 -> 0.3775   acc: 88.24% -> 89.08%             
client [92] (test)  loss: 0.3850 -> 0.4151   acc: 86.15% -> 86.15%             
client [56] (test)  loss: 0.5328 -> 0.5878   acc: 76.92% -> 76.07%             
client [5] (test)  loss: 0.9282 -> 1.2528   acc: 69.52% -> 54.29%              
client [52] (test)  loss: 0.4206 -> 0.4305   acc: 88.37% -> 89.15%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.9950 -> 0.0000', 'accuracy': '65.17% -> 0.00%'},          
    200: {'loss': '0.5383 -> 0.0000', 'accuracy': '82.10% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 20.0%(21.90%) at epoch: 0                                      
FedRep achieved 30.0%(32.14%) at epoch: 11                                     
FedRep achieved 40.0%(40.33%) at epoch: 28                                     
FedRep achieved 50.0%(53.49%) at epoch: 54                                     
FedRep achieved 60.0%(64.05%) at epoch: 71                                     
FedRep achieved 70.0%(72.58%) at epoch: 90                                     
FedRep achieved 80.0%(80.74%) at epoch: 123                                    
Convergence (test_after):                                                      
FedRep achieved 20.0%(23.29%) at epoch: 0                                      
FedRep achieved 30.0%(37.10%) at epoch: 5                                      
FedRep achieved 40.0%(43.77%) at epoch: 20                                     
FedRep achieved 50.0%(51.40%) at epoch: 50                                     
FedRep achieved 60.0%(60.40%) at epoch: 70                                     
FedRep achieved 70.0%(72.96%) at epoch: 97                                     
FedRep achieved 80.0%(80.75%) at epoch: 131                                    
