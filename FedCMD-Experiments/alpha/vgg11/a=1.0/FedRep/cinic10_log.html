==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.3008 -> 1.4319   acc: 58.07% -> 50.49%             
client [81] (test)  loss: 1.3264 -> 1.3480   acc: 54.20% -> 53.54%             
client [21] (test)  loss: 2.3406 -> 1.1391   acc: 27.66% -> 59.72%             
client [68] (test)  loss: 1.2025 -> 1.2572   acc: 61.82% -> 56.98%             
client [93] (test)  loss: 1.1844 -> 1.1564   acc: 59.60% -> 62.73%             
client [31] (test)  loss: 2.4824 -> 1.2583   acc: 22.00% -> 51.84%             
client [20] (test)  loss: 1.3663 -> 2.0422   acc: 52.12% -> 36.36%             
client [59] (test)  loss: 1.5094 -> 1.1615   acc: 49.54% -> 60.99%             
client [48] (test)  loss: 1.0017 -> 1.0267   acc: 61.32% -> 60.44%             
client [34] (test)  loss: 1.1772 -> 1.2170   acc: 58.42% -> 56.49%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4523 -> 1.2329   acc: 48.43% -> 58.55%             
client [99] (test)  loss: 0.8986 -> 0.9076   acc: 69.07% -> 68.93%             
client [67] (test)  loss: 1.2820 -> 1.3250   acc: 53.68% -> 53.00%             
client [0] (test)  loss: 0.8531 -> 0.8355   acc: 72.81% -> 73.39%              
client [76] (test)  loss: 0.8564 -> 0.9343   acc: 70.12% -> 69.43%             
client [41] (test)  loss: 1.2753 -> 1.5239   acc: 57.86% -> 53.15%             
client [62] (test)  loss: 1.9760 -> 1.0591   acc: 39.95% -> 62.91%             
client [2] (test)  loss: 1.4638 -> 1.0359   acc: 49.59% -> 59.54%              
client [14] (test)  loss: 0.6102 -> 0.6901   acc: 77.35% -> 73.40%             
client [46] (test)  loss: 1.0613 -> 1.0868   acc: 61.53% -> 58.91%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9263 -> 0.9737   acc: 69.23% -> 67.72%             
client [68] (test)  loss: 1.0162 -> 1.0765   acc: 67.25% -> 65.58%             
client [57] (test)  loss: 0.7964 -> 0.8542   acc: 68.47% -> 65.24%             
client [17] (test)  loss: 0.8234 -> 0.8412   acc: 71.52% -> 70.79%             
client [54] (test)  loss: 0.8189 -> 0.8797   acc: 68.21% -> 66.18%             
client [23] (test)  loss: 2.2312 -> 1.0472   acc: 35.12% -> 63.32%             
client [35] (test)  loss: 1.0526 -> 1.0953   acc: 63.90% -> 62.59%             
client [59] (test)  loss: 0.9691 -> 0.9954   acc: 66.32% -> 65.15%             
client [31] (test)  loss: 1.0019 -> 1.0706   acc: 62.80% -> 59.33%             
client [9] (test)  loss: 1.0645 -> 1.1253   acc: 58.94% -> 58.14%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0082 -> 1.1732   acc: 65.75% -> 58.35%             
client [33] (test)  loss: 1.0954 -> 1.1914   acc: 64.10% -> 61.11%             
client [16] (test)  loss: 0.8444 -> 0.8797   acc: 69.65% -> 68.71%             
client [44] (test)  loss: 1.5006 -> 0.9427   acc: 47.01% -> 62.86%             
client [8] (test)  loss: 0.7069 -> 0.7851   acc: 77.47% -> 76.67%              
client [31] (test)  loss: 0.9654 -> 1.0463   acc: 64.54% -> 61.28%             
client [47] (test)  loss: 0.7862 -> 0.8067   acc: 72.25% -> 72.32%             
client [36] (test)  loss: 0.9771 -> 0.9634   acc: 65.42% -> 65.42%             
client [20] (test)  loss: 1.0973 -> 1.1849   acc: 61.00% -> 59.58%             
client [56] (test)  loss: 1.1976 -> 1.3104   acc: 54.56% -> 51.13%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8065 -> 0.8540   acc: 73.08% -> 70.58%              
client [60] (test)  loss: 1.0790 -> 1.1115   acc: 62.40% -> 61.31%             
client [28] (test)  loss: 1.0423 -> 1.0840   acc: 66.28% -> 65.34%             
client [25] (test)  loss: 1.1182 -> 1.1157   acc: 58.83% -> 57.93%             
client [58] (test)  loss: 1.0513 -> 1.1774   acc: 63.02% -> 59.57%             
client [44] (test)  loss: 0.9200 -> 0.9099   acc: 63.66% -> 63.72%             
client [39] (test)  loss: 0.9337 -> 0.9794   acc: 67.38% -> 65.18%             
client [29] (test)  loss: 1.1042 -> 1.1417   acc: 59.37% -> 59.00%             
client [3] (test)  loss: 1.1095 -> 1.1982   acc: 61.21% -> 58.66%              
client [84] (test)  loss: 0.8877 -> 0.9644   acc: 69.79% -> 66.84%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9166 -> 0.8404   acc: 66.61% -> 70.47%             
client [84] (test)  loss: 0.8672 -> 0.9497   acc: 70.26% -> 67.49%             
client [10] (test)  loss: 0.7992 -> 0.8130   acc: 72.24% -> 72.41%             
client [36] (test)  loss: 0.9313 -> 0.9352   acc: 67.54% -> 66.20%             
client [65] (test)  loss: 1.0061 -> 1.0973   acc: 65.77% -> 63.19%             
client [81] (test)  loss: 1.0075 -> 1.0248   acc: 66.81% -> 65.12%             
client [79] (test)  loss: 1.0270 -> 1.1300   acc: 64.54% -> 61.45%             
client [42] (test)  loss: 1.0720 -> 1.0795   acc: 61.46% -> 61.61%             
client [11] (test)  loss: 0.9762 -> 1.0794   acc: 66.35% -> 62.96%             
client [96] (test)  loss: 1.0506 -> 1.1216   acc: 60.56% -> 58.32%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6541 -> 0.6942   acc: 78.66% -> 79.22%              
client [53] (test)  loss: 0.9170 -> 1.0101   acc: 65.77% -> 61.62%             
client [52] (test)  loss: 0.7919 -> 0.8242   acc: 74.51% -> 72.31%             
client [42] (test)  loss: 1.0408 -> 1.1049   acc: 62.66% -> 60.87%             
client [69] (test)  loss: 1.0169 -> 1.1205   acc: 65.88% -> 62.89%             
client [59] (test)  loss: 0.8827 -> 0.9058   acc: 69.70% -> 69.05%             
client [7] (test)  loss: 0.8264 -> 0.7965   acc: 73.68% -> 73.95%              
client [26] (test)  loss: 0.7074 -> 0.7238   acc: 76.84% -> 76.62%             
client [49] (test)  loss: 1.1189 -> 1.2676   acc: 60.74% -> 56.39%             
client [98] (test)  loss: 1.1729 -> 1.2402   acc: 54.67% -> 53.95%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.1813 -> 1.2561   acc: 55.85% -> 53.49%             
client [47] (test)  loss: 0.7891 -> 0.7501   acc: 73.59% -> 73.81%             
client [21] (test)  loss: 0.7898 -> 0.8364   acc: 71.26% -> 70.05%             
client [77] (test)  loss: 0.9916 -> 1.0474   acc: 69.84% -> 68.48%             
client [95] (test)  loss: 0.9868 -> 1.0304   acc: 63.92% -> 61.96%             
client [91] (test)  loss: 1.0282 -> 1.0798   acc: 61.44% -> 60.45%             
client [14] (test)  loss: 0.5232 -> 0.5692   acc: 81.13% -> 79.69%             
client [99] (test)  loss: 0.7232 -> 0.7451   acc: 75.46% -> 74.64%             
client [20] (test)  loss: 1.0751 -> 1.1452   acc: 62.98% -> 61.66%             
client [39] (test)  loss: 0.9223 -> 0.9423   acc: 68.11% -> 67.11%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7923 -> 0.8288   acc: 74.29% -> 72.09%             
client [62] (test)  loss: 0.8859 -> 0.9534   acc: 69.23% -> 67.86%             
client [71] (test)  loss: 0.8979 -> 0.9368   acc: 69.73% -> 69.06%             
client [97] (test)  loss: 1.0392 -> 1.0974   acc: 66.94% -> 64.17%             
client [30] (test)  loss: 0.6892 -> 0.8204   acc: 79.04% -> 74.55%             
client [88] (test)  loss: 0.8642 -> 0.8659   acc: 72.22% -> 72.00%             
client [60] (test)  loss: 1.0646 -> 1.1124   acc: 66.17% -> 64.98%             
client [82] (test)  loss: 1.1375 -> 1.2082   acc: 64.05% -> 61.62%             
client [91] (test)  loss: 1.0297 -> 1.0819   acc: 62.01% -> 59.89%             
client [57] (test)  loss: 0.6741 -> 0.7439   acc: 73.96% -> 70.30%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9790 -> 1.0528   acc: 66.27% -> 64.33%             
client [15] (test)  loss: 0.6812 -> 0.7426   acc: 78.11% -> 76.05%             
client [71] (test)  loss: 0.9220 -> 0.9381   acc: 70.04% -> 69.24%             
client [97] (test)  loss: 1.0538 -> 1.1127   acc: 65.44% -> 63.36%             
client [53] (test)  loss: 0.9293 -> 1.0166   acc: 66.38% -> 63.62%             
client [77] (test)  loss: 0.9803 -> 1.0485   acc: 71.50% -> 69.07%             
client [76] (test)  loss: 0.7173 -> 0.8282   acc: 76.31% -> 74.71%             
client [79] (test)  loss: 1.0208 -> 1.1013   acc: 64.83% -> 62.78%             
client [28] (test)  loss: 1.0077 -> 1.0985   acc: 67.53% -> 67.14%             
client [99] (test)  loss: 0.7403 -> 0.7449   acc: 74.71% -> 74.71%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.0915 -> 1.1170   acc: 66.94% -> 65.32%             
client [86] (test)  loss: 0.9196 -> 1.0072   acc: 67.05% -> 62.80%             
client [34] (test)  loss: 0.8976 -> 0.9421   acc: 71.27% -> 69.60%             
client [73] (test)  loss: 1.0247 -> 1.0992   acc: 63.96% -> 61.34%             
client [5] (test)  loss: 0.9176 -> 1.0094   acc: 70.38% -> 68.83%              
client [96] (test)  loss: 1.0244 -> 1.1327   acc: 64.11% -> 61.81%             
client [22] (test)  loss: 0.7441 -> 0.8058   acc: 74.57% -> 72.62%             
client [60] (test)  loss: 1.1016 -> 1.1428   acc: 65.38% -> 65.87%             
client [66] (test)  loss: 0.7383 -> 0.8186   acc: 74.94% -> 73.09%             
client [83] (test)  loss: 0.8104 -> 0.8176   acc: 74.83% -> 74.34%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7337 -> 0.8501   acc: 77.16% -> 76.16%             
client [65] (test)  loss: 0.9818 -> 1.0685   acc: 68.16% -> 66.83%             
client [95] (test)  loss: 1.0109 -> 1.0555   acc: 64.37% -> 63.86%             
client [17] (test)  loss: 0.7135 -> 0.7127   acc: 76.43% -> 76.35%             
client [8] (test)  loss: 0.6783 -> 0.7029   acc: 80.41% -> 79.54%              
client [35] (test)  loss: 1.0088 -> 1.0369   acc: 67.59% -> 66.90%             
client [98] (test)  loss: 1.2060 -> 1.2525   acc: 56.30% -> 54.21%             
client [53] (test)  loss: 0.9478 -> 1.0434   acc: 66.23% -> 62.08%             
client [43] (test)  loss: 0.5331 -> 0.5705   acc: 84.39% -> 83.95%             
client [64] (test)  loss: 0.9717 -> 1.2093   acc: 69.73% -> 61.46%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7704 -> 0.8212   acc: 72.95% -> 71.01%             
client [88] (test)  loss: 0.8739 -> 0.8886   acc: 69.33% -> 69.78%             
client [38] (test)  loss: 0.7901 -> 0.8717   acc: 75.27% -> 73.29%             
client [3] (test)  loss: 1.0840 -> 1.1370   acc: 63.94% -> 64.22%              
client [5] (test)  loss: 0.9574 -> 1.0353   acc: 69.61% -> 68.83%              
client [41] (test)  loss: 1.1113 -> 1.2365   acc: 64.08% -> 62.13%             
client [7] (test)  loss: 0.8112 -> 0.8166   acc: 73.27% -> 74.49%              
client [37] (test)  loss: 0.8651 -> 0.8963   acc: 71.86% -> 71.05%             
client [45] (test)  loss: 0.9744 -> 1.0383   acc: 68.10% -> 65.87%             
client [47] (test)  loss: 0.7081 -> 0.7366   acc: 75.97% -> 75.15%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8539 -> 0.8780   acc: 72.05% -> 71.65%             
client [11] (test)  loss: 0.9925 -> 1.1125   acc: 68.87% -> 65.83%             
client [37] (test)  loss: 0.8682 -> 0.9211   acc: 71.57% -> 69.95%             
client [41] (test)  loss: 1.1169 -> 1.2212   acc: 64.16% -> 63.14%             
client [95] (test)  loss: 1.0569 -> 1.1485   acc: 65.32% -> 62.97%             
client [53] (test)  loss: 0.9323 -> 1.0040   acc: 68.31% -> 65.38%             
client [22] (test)  loss: 0.7466 -> 0.8214   acc: 75.43% -> 73.27%             
client [25] (test)  loss: 1.0894 -> 1.1468   acc: 60.83% -> 59.10%             
client [69] (test)  loss: 1.0959 -> 1.1967   acc: 66.88% -> 65.24%             
client [46] (test)  loss: 0.8850 -> 0.9185   acc: 69.27% -> 67.59%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7486 -> 0.7991   acc: 75.82% -> 73.74%             
client [69] (test)  loss: 1.1229 -> 1.2232   acc: 67.52% -> 65.74%             
client [82] (test)  loss: 1.1905 -> 1.2239   acc: 65.17% -> 62.09%             
client [45] (test)  loss: 0.9675 -> 1.0359   acc: 68.74% -> 67.14%             
client [7] (test)  loss: 0.8490 -> 0.8564   acc: 74.63% -> 75.58%              
client [50] (test)  loss: 1.1150 -> 1.1647   acc: 61.35% -> 61.87%             
client [35] (test)  loss: 1.0391 -> 1.0790   acc: 69.36% -> 68.28%             
client [24] (test)  loss: 0.9144 -> 0.9673   acc: 73.10% -> 71.95%             
client [15] (test)  loss: 0.6997 -> 0.7573   acc: 78.42% -> 76.36%             
client [58] (test)  loss: 1.1580 -> 1.2786   acc: 64.30% -> 63.81%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8553 -> 0.8580   acc: 70.74% -> 69.58%             
client [76] (test)  loss: 0.7511 -> 0.8703   acc: 78.25% -> 76.86%             
client [67] (test)  loss: 1.0821 -> 1.1590   acc: 62.91% -> 62.69%             
client [37] (test)  loss: 0.9112 -> 0.9749   acc: 72.15% -> 70.68%             
client [58] (test)  loss: 1.1738 -> 1.3641   acc: 64.69% -> 64.00%             
client [64] (test)  loss: 1.0196 -> 1.0815   acc: 68.87% -> 66.88%             
client [77] (test)  loss: 1.0366 -> 1.1174   acc: 71.50% -> 70.72%             
client [55] (test)  loss: 1.1295 -> 1.2323   acc: 65.21% -> 61.32%             
client [12] (test)  loss: 0.8599 -> 0.9476   acc: 72.53% -> 70.66%             
client [89] (test)  loss: 0.9601 -> 1.0679   acc: 72.39% -> 70.17%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9814 -> 1.0902   acc: 71.32% -> 69.73%             
client [51] (test)  loss: 1.0013 -> 1.0920   acc: 71.57% -> 69.70%             
client [8] (test)  loss: 0.6977 -> 0.7703   acc: 80.33% -> 80.65%              
client [18] (test)  loss: 0.7898 -> 0.8299   acc: 74.09% -> 73.74%             
client [94] (test)  loss: 0.7461 -> 0.8116   acc: 77.14% -> 74.45%             
client [81] (test)  loss: 1.0804 -> 1.1892   acc: 67.18% -> 65.86%             
client [3] (test)  loss: 1.1357 -> 1.2128   acc: 64.12% -> 63.94%              
client [11] (test)  loss: 1.0758 -> 1.1845   acc: 67.65% -> 66.00%             
client [95] (test)  loss: 1.1587 -> 1.2812   acc: 65.44% -> 65.06%             
client [67] (test)  loss: 1.0858 -> 1.1846   acc: 63.21% -> 62.46%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.8054 -> 0.8568   acc: 72.16% -> 71.68%             
client [79] (test)  loss: 1.1621 -> 1.3248   acc: 63.80% -> 61.82%             
client [58] (test)  loss: 1.2351 -> 1.3660   acc: 65.29% -> 63.91%             
client [88] (test)  loss: 0.9834 -> 0.9581   acc: 68.67% -> 71.11%             
client [46] (test)  loss: 0.9603 -> 0.9665   acc: 68.47% -> 67.01%             
client [11] (test)  loss: 1.1044 -> 1.2266   acc: 67.39% -> 64.43%             
client [55] (test)  loss: 1.2006 -> 1.3942   acc: 64.47% -> 60.64%             
client [13] (test)  loss: 1.1082 -> 1.2083   acc: 67.16% -> 64.27%             
client [31] (test)  loss: 1.1538 -> 1.1136   acc: 66.55% -> 64.33%             
client [75] (test)  loss: 0.4186 -> 0.4682   acc: 89.74% -> 89.45%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.3303 -> 1.4529   acc: 62.25% -> 59.38%             
client [7] (test)  loss: 0.8912 -> 0.9511   acc: 74.22% -> 74.36%              
client [57] (test)  loss: 0.7100 -> 0.7818   acc: 74.17% -> 72.27%             
client [13] (test)  loss: 1.1563 -> 1.3394   acc: 66.38% -> 60.91%             
client [43] (test)  loss: 0.6015 -> 0.6793   acc: 85.19% -> 83.30%             
client [91] (test)  loss: 1.1080 -> 1.1271   acc: 62.57% -> 61.30%             
client [10] (test)  loss: 0.8655 -> 0.9761   acc: 73.88% -> 72.50%             
client [64] (test)  loss: 1.1061 -> 1.1971   acc: 68.55% -> 67.36%             
client [82] (test)  loss: 1.2968 -> 1.3677   acc: 64.24% -> 63.12%             
client [22] (test)  loss: 0.8241 -> 0.9066   acc: 74.86% -> 73.34%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1847 -> 1.3143   acc: 64.87% -> 64.02%             
client [23] (test)  loss: 0.9707 -> 0.9974   acc: 70.41% -> 70.29%             
client [88] (test)  loss: 1.0299 -> 1.0157   acc: 69.56% -> 70.89%             
client [98] (test)  loss: 1.3569 -> 1.4799   acc: 58.92% -> 56.37%             
client [79] (test)  loss: 1.2002 -> 1.4134   acc: 65.27% -> 63.00%             
client [21] (test)  loss: 0.8479 -> 0.9144   acc: 72.22% -> 70.95%             
client [92] (test)  loss: 1.3632 -> 1.5652   acc: 55.11% -> 52.13%             
client [56] (test)  loss: 1.4417 -> 1.5485   acc: 56.82% -> 57.09%             
client [5] (test)  loss: 1.1092 -> 1.2534   acc: 70.44% -> 69.07%              
client [52] (test)  loss: 0.9326 -> 1.0268   acc: 73.77% -> 72.60%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.9116 -> 0.0000', 'accuracy': '69.23% -> 0.00%'},          
    200: {'loss': '1.0625 -> 0.0000', 'accuracy': '69.65% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(11.52%) at epoch: 1                                      
FedRep achieved 20.0%(21.56%) at epoch: 2                                      
FedRep achieved 30.0%(33.81%) at epoch: 3                                      
FedRep achieved 50.0%(50.56%) at epoch: 7                                      
FedRep achieved 60.0%(60.96%) at epoch: 16                                     
FedRep achieved 70.0%(71.93%) at epoch: 78                                     
Convergence (test_after):                                                      
FedRep achieved 40.0%(43.87%) at epoch: 0                                      
FedRep achieved 50.0%(52.44%) at epoch: 3                                      
FedRep achieved 60.0%(63.94%) at epoch: 19                                     
FedRep achieved 70.0%(71.38%) at epoch: 78                                     
