==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.1998 -> 2.0243   acc: 32.90% -> 32.90%             
client [81] (test)  loss: 2.3212 -> 2.2085   acc: 3.10% -> 23.45%              
client [21] (test)  loss: 2.3214 -> 2.0314   acc: 27.73% -> 27.73%             
client [68] (test)  loss: 2.2555 -> 2.1476   acc: 19.06% -> 19.06%             
client [93] (test)  loss: 1.5365 -> 0.9811   acc: 78.78% -> 78.78%             
client [31] (test)  loss: 2.3835 -> 2.3034   acc: 1.76% -> 16.30%              
client [20] (test)  loss: 2.1834 -> 2.0146   acc: 42.16% -> 54.25%             
client [59] (test)  loss: 2.4091 -> 2.0560   acc: 6.95% -> 24.50%              
client [48] (test)  loss: 2.0149 -> 1.8703   acc: 32.77% -> 32.77%             
client [34] (test)  loss: 1.7793 -> 1.4916   acc: 52.96% -> 52.96%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.7722 -> 1.4135   acc: 25.75% -> 41.81%             
client [99] (test)  loss: 2.2738 -> 1.6448   acc: 32.07% -> 41.72%             
client [67] (test)  loss: 1.7274 -> 2.9730   acc: 35.14% -> 12.36%             
client [0] (test)  loss: 1.2457 -> 1.0893   acc: 51.48% -> 61.64%              
client [76] (test)  loss: 1.7736 -> 1.5981   acc: 44.41% -> 46.05%             
client [41] (test)  loss: 2.5062 -> 1.6999   acc: 39.60% -> 42.40%             
client [62] (test)  loss: 1.5054 -> 1.2673   acc: 54.86% -> 54.86%             
client [2] (test)  loss: 1.9864 -> 1.3497   acc: 20.96% -> 50.60%              
client [14] (test)  loss: 1.3309 -> 1.1844   acc: 47.88% -> 55.76%             
client [46] (test)  loss: 1.5149 -> 1.2484   acc: 49.57% -> 55.56%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.4371 -> 1.4916   acc: 38.07% -> 35.53%             
client [68] (test)  loss: 1.2273 -> 1.1195   acc: 58.99% -> 68.35%             
client [57] (test)  loss: 1.7331 -> 1.9085   acc: 41.84% -> 39.29%             
client [17] (test)  loss: 2.0757 -> 1.3672   acc: 43.84% -> 51.37%             
client [54] (test)  loss: 1.1511 -> 1.1229   acc: 58.94% -> 61.60%             
client [23] (test)  loss: 1.3683 -> 1.9439   acc: 49.44% -> 49.44%             
client [35] (test)  loss: 1.1463 -> 1.1572   acc: 65.51% -> 62.27%             
client [59] (test)  loss: 1.1188 -> 1.0645   acc: 69.87% -> 64.90%             
client [31] (test)  loss: 1.4933 -> 1.6817   acc: 45.81% -> 34.80%             
client [9] (test)  loss: 1.2399 -> 1.1641   acc: 56.93% -> 58.70%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0714 -> 1.0063   acc: 59.49% -> 67.09%             
client [33] (test)  loss: 0.6896 -> 0.6946   acc: 75.97% -> 74.35%             
client [16] (test)  loss: 0.7980 -> 0.8003   acc: 74.35% -> 75.84%             
client [44] (test)  loss: 1.9273 -> 0.9073   acc: 49.29% -> 66.57%             
client [8] (test)  loss: 0.5522 -> 0.4990   acc: 84.59% -> 85.57%              
client [31] (test)  loss: 1.2463 -> 1.2089   acc: 56.39% -> 58.15%             
client [47] (test)  loss: 0.8287 -> 0.7049   acc: 70.18% -> 71.08%             
client [36] (test)  loss: 0.9792 -> 0.9298   acc: 67.76% -> 70.07%             
client [20] (test)  loss: 0.5018 -> 0.4886   acc: 84.64% -> 84.64%             
client [56] (test)  loss: 0.6337 -> 3.2033   acc: 77.30% -> 42.64%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4534 -> 0.4164   acc: 84.36% -> 85.67%              
client [60] (test)  loss: 0.3964 -> 0.3869   acc: 87.65% -> 87.65%             
client [28] (test)  loss: 1.4284 -> 1.1158   acc: 43.25% -> 61.90%             
client [25] (test)  loss: 1.2350 -> 0.7263   acc: 53.67% -> 76.04%             
client [58] (test)  loss: 0.6916 -> 0.5418   acc: 74.81% -> 80.86%             
client [44] (test)  loss: 0.7613 -> 0.7808   acc: 72.24% -> 71.39%             
client [39] (test)  loss: 0.6495 -> 0.8808   acc: 77.03% -> 69.77%             
client [29] (test)  loss: 1.1342 -> 0.8999   acc: 59.66% -> 68.67%             
client [3] (test)  loss: 0.4921 -> 0.4934   acc: 84.64% -> 84.64%              
client [84] (test)  loss: 1.1186 -> 1.0006   acc: 57.30% -> 60.85%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8571 -> 0.7351   acc: 71.03% -> 73.83%             
client [84] (test)  loss: 0.9776 -> 0.9052   acc: 65.48% -> 64.41%             
client [10] (test)  loss: 0.7848 -> 0.6648   acc: 74.61% -> 78.91%             
client [36] (test)  loss: 0.7044 -> 0.6823   acc: 77.63% -> 75.99%             
client [65] (test)  loss: 0.5756 -> 0.5915   acc: 82.69% -> 81.41%             
client [81] (test)  loss: 1.1567 -> 1.0253   acc: 62.39% -> 67.70%             
client [79] (test)  loss: 0.9512 -> 0.9591   acc: 64.55% -> 64.09%             
client [42] (test)  loss: 1.0490 -> 1.0185   acc: 59.76% -> 61.86%             
client [11] (test)  loss: 1.1506 -> 0.9005   acc: 60.08% -> 67.65%             
client [96] (test)  loss: 1.1171 -> 0.9003   acc: 64.18% -> 69.86%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4571 -> 0.3790   acc: 86.56% -> 90.82%              
client [53] (test)  loss: 0.8147 -> 1.0946   acc: 69.41% -> 61.18%             
client [52] (test)  loss: 0.4232 -> 0.3733   acc: 83.71% -> 88.18%             
client [42] (test)  loss: 0.8289 -> 0.8869   acc: 69.67% -> 67.27%             
client [69] (test)  loss: 0.4279 -> 0.4970   acc: 82.27% -> 81.61%             
client [59] (test)  loss: 0.4990 -> 0.6007   acc: 84.44% -> 76.49%             
client [7] (test)  loss: 0.6661 -> 0.4957   acc: 81.27% -> 86.17%              
client [26] (test)  loss: 0.2936 -> 0.6176   acc: 89.54% -> 79.08%             
client [49] (test)  loss: 0.2175 -> 0.2530   acc: 92.21% -> 91.56%             
client [98] (test)  loss: 0.6021 -> 0.5951   acc: 81.15% -> 79.58%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5456 -> 0.5695   acc: 83.25% -> 79.06%             
client [47] (test)  loss: 0.5456 -> 0.4303   acc: 77.11% -> 81.93%             
client [21] (test)  loss: 0.4065 -> 0.5495   acc: 87.54% -> 83.49%             
client [77] (test)  loss: 0.6416 -> 0.6275   acc: 77.81% -> 76.24%             
client [95] (test)  loss: 0.7354 -> 0.7860   acc: 71.49% -> 69.88%             
client [91] (test)  loss: 0.7214 -> 0.7219   acc: 74.87% -> 75.94%             
client [14] (test)  loss: 0.2404 -> 0.2262   acc: 91.82% -> 92.73%             
client [99] (test)  loss: 0.6873 -> 0.6947   acc: 77.93% -> 80.69%             
client [20] (test)  loss: 0.2658 -> 0.3251   acc: 93.14% -> 92.16%             
client [39] (test)  loss: 0.4561 -> 0.6606   acc: 82.56% -> 76.74%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2968 -> 0.3125   acc: 90.42% -> 91.37%             
client [62] (test)  loss: 0.2993 -> 0.3150   acc: 88.57% -> 89.71%             
client [71] (test)  loss: 0.3906 -> 0.3936   acc: 91.20% -> 90.40%             
client [97] (test)  loss: 0.2995 -> 1.2127   acc: 91.11% -> 58.76%             
client [30] (test)  loss: 0.1699 -> 0.1921   acc: 93.99% -> 93.35%             
client [88] (test)  loss: 0.2813 -> 0.2214   acc: 90.06% -> 92.31%             
client [60] (test)  loss: 0.1749 -> 0.1796   acc: 94.44% -> 94.14%             
client [82] (test)  loss: 0.5488 -> 0.6031   acc: 83.50% -> 80.26%             
client [91] (test)  loss: 0.6855 -> 0.6837   acc: 74.33% -> 78.07%             
client [57] (test)  loss: 0.6486 -> 0.9170   acc: 79.59% -> 68.88%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7370 -> 0.9224   acc: 74.01% -> 70.04%             
client [15] (test)  loss: 0.1987 -> 0.1791   acc: 94.06% -> 96.25%             
client [71] (test)  loss: 0.3278 -> 0.4461   acc: 91.20% -> 88.00%             
client [97] (test)  loss: 0.2530 -> 1.4442   acc: 89.76% -> 58.22%             
client [53] (test)  loss: 0.7449 -> 0.9096   acc: 71.76% -> 69.41%             
client [77] (test)  loss: 0.6438 -> 0.5607   acc: 77.81% -> 79.63%             
client [76] (test)  loss: 0.5036 -> 0.4990   acc: 82.02% -> 82.29%             
client [79] (test)  loss: 0.6492 -> 0.6130   acc: 75.91% -> 74.55%             
client [28] (test)  loss: 0.7610 -> 0.7364   acc: 72.22% -> 76.59%             
client [99] (test)  loss: 0.6758 -> 0.6012   acc: 80.00% -> 82.76%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2023 -> 1.3092   acc: 93.80% -> 61.46%             
client [86] (test)  loss: 0.4644 -> 1.0343   acc: 84.62% -> 64.62%             
client [34] (test)  loss: 0.1975 -> 0.1966   acc: 93.01% -> 92.20%             
client [73] (test)  loss: 0.3031 -> 0.3081   acc: 88.26% -> 88.26%             
client [5] (test)  loss: 0.2018 -> 0.2137   acc: 91.48% -> 91.21%              
client [96] (test)  loss: 0.6124 -> 0.7732   acc: 81.91% -> 73.40%             
client [22] (test)  loss: 0.4418 -> 0.4499   acc: 86.67% -> 82.22%             
client [60] (test)  loss: 0.1694 -> 0.1760   acc: 94.44% -> 94.75%             
client [66] (test)  loss: 0.5162 -> 0.5317   acc: 80.07% -> 81.16%             
client [83] (test)  loss: 0.7309 -> 0.5045   acc: 67.73% -> 82.02%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4439 -> 0.4462   acc: 83.65% -> 84.74%             
client [65] (test)  loss: 0.3250 -> 0.3694   acc: 87.50% -> 87.82%             
client [95] (test)  loss: 0.6280 -> 0.6716   acc: 75.90% -> 75.10%             
client [17] (test)  loss: 0.8154 -> 1.0201   acc: 69.18% -> 67.12%             
client [8] (test)  loss: 0.2687 -> 0.3071   acc: 92.13% -> 93.11%              
client [35] (test)  loss: 0.3786 -> 0.4392   acc: 90.97% -> 87.50%             
client [98] (test)  loss: 0.3965 -> 0.4697   acc: 86.91% -> 85.34%             
client [53] (test)  loss: 0.6074 -> 0.8316   acc: 75.29% -> 70.20%             
client [43] (test)  loss: 0.3560 -> 0.3397   acc: 87.22% -> 85.75%             
client [64] (test)  loss: 0.4633 -> 0.4586   acc: 85.44% -> 85.44%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3164 -> 0.3657   acc: 90.34% -> 89.41%             
client [88] (test)  loss: 0.1727 -> 0.1584   acc: 94.23% -> 94.87%             
client [38] (test)  loss: 0.3078 -> 0.2825   acc: 89.61% -> 91.69%             
client [3] (test)  loss: 0.2239 -> 0.2229   acc: 93.14% -> 92.48%              
client [5] (test)  loss: 0.2031 -> 0.1713   acc: 90.66% -> 93.13%              
client [41] (test)  loss: 0.4557 -> 0.5317   acc: 85.60% -> 83.20%             
client [7] (test)  loss: 0.2514 -> 0.2499   acc: 93.95% -> 93.08%              
client [37] (test)  loss: 0.4150 -> 1.7544   acc: 86.33% -> 52.00%             
client [45] (test)  loss: 0.5180 -> 0.4772   acc: 82.02% -> 85.80%             
client [47] (test)  loss: 0.4416 -> 0.3072   acc: 83.73% -> 88.86%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2229 -> 0.2744   acc: 93.68% -> 92.94%             
client [11] (test)  loss: 0.5191 -> 1.1750   acc: 81.93% -> 65.13%             
client [37] (test)  loss: 0.3406 -> 3.5279   acc: 87.33% -> 44.67%             
client [41] (test)  loss: 0.4987 -> 0.6497   acc: 84.40% -> 78.80%             
client [95] (test)  loss: 0.4931 -> 0.6714   acc: 81.53% -> 73.49%             
client [53] (test)  loss: 0.5452 -> 0.7806   acc: 78.04% -> 71.76%             
client [22] (test)  loss: 0.3788 -> 0.3829   acc: 87.78% -> 86.67%             
client [25] (test)  loss: 0.3481 -> 0.3405   acc: 88.82% -> 89.46%             
client [69] (test)  loss: 0.2526 -> 0.2830   acc: 93.31% -> 91.64%             
client [46] (test)  loss: 0.2565 -> 0.2606   acc: 91.88% -> 91.45%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2519 -> 0.3137   acc: 91.27% -> 87.05%             
client [69] (test)  loss: 0.2313 -> 0.2629   acc: 93.65% -> 92.64%             
client [82] (test)  loss: 0.3988 -> 0.7153   acc: 89.00% -> 81.55%             
client [45] (test)  loss: 0.5176 -> 0.4411   acc: 85.17% -> 86.44%             
client [7] (test)  loss: 0.2092 -> 0.2422   acc: 93.95% -> 93.66%              
client [50] (test)  loss: 0.2521 -> 0.3876   acc: 92.34% -> 87.59%             
client [35] (test)  loss: 0.3144 -> 0.5923   acc: 92.36% -> 79.17%             
client [24] (test)  loss: 0.5810 -> 0.5765   acc: 81.22% -> 79.44%             
client [15] (test)  loss: 0.1209 -> 0.1347   acc: 97.19% -> 96.25%             
client [58] (test)  loss: 0.2126 -> 0.4236   acc: 91.69% -> 86.40%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3163 -> 0.3665   acc: 85.81% -> 85.47%             
client [76] (test)  loss: 0.3338 -> 0.3244   acc: 88.56% -> 87.74%             
client [67] (test)  loss: 0.4323 -> 0.4346   acc: 86.87% -> 88.42%             
client [37] (test)  loss: 0.3492 -> 1.3420   acc: 89.00% -> 63.33%             
client [58] (test)  loss: 0.1888 -> 0.3801   acc: 92.95% -> 88.16%             
client [64] (test)  loss: 0.3846 -> 0.3830   acc: 87.97% -> 87.97%             
client [77] (test)  loss: 0.3957 -> 0.4499   acc: 89.03% -> 86.42%             
client [55] (test)  loss: 0.4959 -> 0.5986   acc: 90.36% -> 86.75%             
client [12] (test)  loss: 0.3819 -> 0.5032   acc: 85.83% -> 83.07%             
client [89] (test)  loss: 0.2702 -> 0.3217   acc: 92.80% -> 91.07%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3709 -> 0.3749   acc: 87.19% -> 86.48%             
client [51] (test)  loss: 0.5237 -> 0.5042   acc: 85.04% -> 83.33%             
client [8] (test)  loss: 0.2010 -> 0.2281   acc: 95.08% -> 94.43%              
client [18] (test)  loss: 0.0831 -> 0.0833   acc: 96.70% -> 97.03%             
client [94] (test)  loss: 0.2126 -> 0.2026   acc: 92.97% -> 94.14%             
client [81] (test)  loss: 0.4817 -> 0.4480   acc: 86.28% -> 85.84%             
client [3] (test)  loss: 0.1754 -> 0.1935   acc: 94.44% -> 93.46%              
client [11] (test)  loss: 0.4240 -> 0.5482   acc: 86.13% -> 81.93%             
client [95] (test)  loss: 0.4308 -> 0.5955   acc: 84.34% -> 77.51%             
client [67] (test)  loss: 0.3998 -> 0.4077   acc: 88.80% -> 88.42%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2574 -> 0.3102   acc: 91.90% -> 91.28%             
client [79] (test)  loss: 0.3865 -> 0.4375   acc: 87.73% -> 85.00%             
client [58] (test)  loss: 0.1783 -> 0.2344   acc: 93.70% -> 91.94%             
client [88] (test)  loss: 0.1308 -> 0.1166   acc: 95.83% -> 96.47%             
client [46] (test)  loss: 0.2129 -> 0.1940   acc: 94.44% -> 94.44%             
client [11] (test)  loss: 0.4900 -> 0.4773   acc: 84.87% -> 83.61%             
client [55] (test)  loss: 0.4591 -> 0.4720   acc: 91.57% -> 90.36%             
client [13] (test)  loss: 0.1940 -> 0.1937   acc: 95.22% -> 94.66%             
client [31] (test)  loss: 0.4768 -> 0.5484   acc: 86.78% -> 84.14%             
client [75] (test)  loss: 0.3326 -> 0.3426   acc: 87.83% -> 89.95%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1579 -> 0.1570   acc: 95.40% -> 95.09%             
client [7] (test)  loss: 0.1974 -> 0.2232   acc: 95.10% -> 95.10%              
client [57] (test)  loss: 0.3040 -> 0.3558   acc: 89.80% -> 89.80%             
client [13] (test)  loss: 0.1953 -> 0.2035   acc: 94.94% -> 94.38%             
client [43] (test)  loss: 0.2269 -> 0.2406   acc: 91.15% -> 89.93%             
client [91] (test)  loss: 0.3667 -> 0.3867   acc: 86.63% -> 88.77%             
client [10] (test)  loss: 0.2326 -> 0.2192   acc: 92.97% -> 92.19%             
client [64] (test)  loss: 0.3266 -> 0.3326   acc: 89.24% -> 89.87%             
client [82] (test)  loss: 0.3475 -> 0.4997   acc: 89.32% -> 89.64%             
client [22] (test)  loss: 0.2863 -> 0.2972   acc: 92.78% -> 90.00%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1742 -> 0.1791   acc: 94.44% -> 94.44%             
client [23] (test)  loss: 0.2055 -> 0.2137   acc: 93.06% -> 92.78%             
client [88] (test)  loss: 0.1207 -> 0.1106   acc: 95.51% -> 96.79%             
client [98] (test)  loss: 0.3442 -> 0.4428   acc: 89.01% -> 87.96%             
client [79] (test)  loss: 0.3423 -> 0.3886   acc: 88.64% -> 85.91%             
client [21] (test)  loss: 0.2776 -> 0.2947   acc: 91.90% -> 91.59%             
client [92] (test)  loss: 0.4108 -> 0.4107   acc: 84.09% -> 84.85%             
client [56] (test)  loss: 0.1476 -> 0.1825   acc: 95.09% -> 93.25%             
client [5] (test)  loss: 0.1331 -> 0.1296   acc: 93.96% -> 94.51%              
client [52] (test)  loss: 0.2207 -> 0.2374   acc: 94.57% -> 94.57%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4232 -> 0.0000', 'accuracy': '85.59% -> 0.00%'},          
    200: {'loss': '0.2599 -> 0.0000', 'accuracy': '91.79% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(10.49%) at epoch: 0                                      
FedRep achieved 20.0%(20.44%) at epoch: 1                                      
FedRep achieved 30.0%(32.54%) at epoch: 9                                      
FedRep achieved 40.0%(40.29%) at epoch: 19                                     
FedRep achieved 50.0%(52.48%) at epoch: 25                                     
FedRep achieved 60.0%(61.26%) at epoch: 30                                     
FedRep achieved 70.0%(70.57%) at epoch: 39                                     
FedRep achieved 80.0%(80.60%) at epoch: 60                                     
FedRep achieved 90.0%(90.28%) at epoch: 133                                    
Convergence (test_after):                                                      
FedRep achieved 20.0%(24.14%) at epoch: 0                                      
FedRep achieved 30.0%(30.33%) at epoch: 1                                      
FedRep achieved 40.0%(41.26%) at epoch: 5                                      
FedRep achieved 50.0%(51.01%) at epoch: 18                                     
FedRep achieved 60.0%(62.28%) at epoch: 20                                     
FedRep achieved 70.0%(70.45%) at epoch: 37                                     
FedRep achieved 80.0%(80.09%) at epoch: 47                                     
FedRep achieved 90.0%(90.39%) at epoch: 152                                    
