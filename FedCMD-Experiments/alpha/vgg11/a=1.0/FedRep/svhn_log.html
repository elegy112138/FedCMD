==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.0001,                                                        
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4424 -> 1.4561   acc: 55.47% -> 53.48%             
client [81] (test)  loss: 1.9853 -> 2.0438   acc: 31.33% -> 31.14%             
client [21] (test)  loss: 2.7631 -> 1.4295   acc: 19.35% -> 45.88%             
client [68] (test)  loss: 2.0208 -> 1.7591   acc: 35.64% -> 39.80%             
client [93] (test)  loss: 1.2218 -> 0.9560   acc: 56.27% -> 62.35%             
client [31] (test)  loss: 3.3279 -> 1.4867   acc: 21.09% -> 54.98%             
client [20] (test)  loss: 2.1086 -> 2.0564   acc: 31.08% -> 31.98%             
client [59] (test)  loss: 3.2416 -> 2.6969   acc: 5.67% -> 16.49%              
client [48] (test)  loss: 1.6015 -> 1.5968   acc: 39.80% -> 40.98%             
client [34] (test)  loss: 2.0648 -> 2.1618   acc: 26.50% -> 23.98%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9954 -> 1.6031   acc: 30.74% -> 35.37%             
client [99] (test)  loss: 1.1216 -> 1.5128   acc: 60.74% -> 43.71%             
client [67] (test)  loss: 1.7019 -> 1.8147   acc: 45.31% -> 35.00%             
client [0] (test)  loss: 1.5616 -> 1.9737   acc: 49.51% -> 37.86%              
client [76] (test)  loss: 1.7527 -> 1.7437   acc: 36.96% -> 35.64%             
client [41] (test)  loss: 1.5743 -> 1.6310   acc: 48.43% -> 44.90%             
client [62] (test)  loss: 2.6735 -> 1.7532   acc: 7.89% -> 37.22%              
client [2] (test)  loss: 2.8013 -> 1.4335   acc: 7.07% -> 49.31%               
client [14] (test)  loss: 2.0026 -> 2.1230   acc: 29.82% -> 25.31%             
client [46] (test)  loss: 1.1970 -> 1.4409   acc: 62.08% -> 52.04%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.7964 -> 1.8511   acc: 38.46% -> 35.66%             
client [68] (test)  loss: 1.5650 -> 1.5296   acc: 46.73% -> 49.50%             
client [57] (test)  loss: 1.9244 -> 1.9696   acc: 36.34% -> 34.53%             
client [17] (test)  loss: 1.8646 -> 1.9292   acc: 35.56% -> 29.78%             
client [54] (test)  loss: 1.4017 -> 1.9383   acc: 53.73% -> 38.05%             
client [23] (test)  loss: 3.3061 -> 2.0591   acc: 13.05% -> 35.24%             
client [35] (test)  loss: 1.1369 -> 1.2606   acc: 58.37% -> 56.97%             
client [59] (test)  loss: 1.6598 -> 2.1691   acc: 43.04% -> 26.29%             
client [31] (test)  loss: 1.2542 -> 1.4638   acc: 59.72% -> 56.40%             
client [9] (test)  loss: 0.9646 -> 1.1185   acc: 65.35% -> 61.81%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.4992 -> 1.7818   acc: 47.86% -> 34.01%             
client [33] (test)  loss: 0.6660 -> 0.7017   acc: 74.77% -> 73.64%             
client [16] (test)  loss: 0.8836 -> 0.9506   acc: 68.83% -> 64.01%             
client [44] (test)  loss: 1.3109 -> 0.9870   acc: 53.83% -> 64.33%             
client [8] (test)  loss: 1.5345 -> 1.5521   acc: 45.26% -> 43.84%              
client [31] (test)  loss: 1.2011 -> 1.4891   acc: 61.14% -> 59.24%             
client [47] (test)  loss: 1.2190 -> 1.3188   acc: 58.54% -> 53.74%             
client [36] (test)  loss: 1.1804 -> 1.1738   acc: 60.15% -> 59.70%             
client [20] (test)  loss: 1.6828 -> 1.6949   acc: 43.69% -> 43.24%             
client [56] (test)  loss: 0.9546 -> 1.0867   acc: 64.23% -> 56.15%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.5063 -> 1.5871   acc: 50.15% -> 46.29%              
client [60] (test)  loss: 1.4305 -> 1.5242   acc: 49.10% -> 42.69%             
client [28] (test)  loss: 1.3824 -> 1.3866   acc: 54.34% -> 53.70%             
client [25] (test)  loss: 1.6918 -> 2.2027   acc: 39.82% -> 30.91%             
client [58] (test)  loss: 1.7476 -> 1.8601   acc: 39.64% -> 36.76%             
client [44] (test)  loss: 0.9143 -> 0.9173   acc: 64.00% -> 68.17%             
client [39] (test)  loss: 1.4261 -> 1.5315   acc: 52.44% -> 46.39%             
client [29] (test)  loss: 1.3837 -> 1.3953   acc: 48.74% -> 47.90%             
client [3] (test)  loss: 1.2349 -> 1.2152   acc: 59.97% -> 56.89%              
client [84] (test)  loss: 1.5324 -> 1.5391   acc: 49.10% -> 47.74%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9785 -> 1.0775   acc: 66.67% -> 61.29%             
client [84] (test)  loss: 1.3992 -> 1.4503   acc: 51.81% -> 51.58%             
client [10] (test)  loss: 1.5873 -> 1.5084   acc: 48.64% -> 51.36%             
client [36] (test)  loss: 1.0446 -> 1.0582   acc: 65.26% -> 64.96%             
client [65] (test)  loss: 0.7544 -> 0.8750   acc: 71.02% -> 68.79%             
client [81] (test)  loss: 1.5519 -> 1.5080   acc: 47.65% -> 45.78%             
client [79] (test)  loss: 0.3483 -> 0.4388   acc: 87.32% -> 85.48%             
client [42] (test)  loss: 1.0813 -> 1.1985   acc: 59.55% -> 53.38%             
client [11] (test)  loss: 0.4252 -> 0.2889   acc: 83.88% -> 90.87%             
client [96] (test)  loss: 1.1473 -> 1.1011   acc: 65.37% -> 60.11%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.2705 -> 1.2710   acc: 57.35% -> 57.82%              
client [53] (test)  loss: 1.1636 -> 1.1612   acc: 64.62% -> 66.08%             
client [52] (test)  loss: 1.2631 -> 1.2792   acc: 53.37% -> 50.19%             
client [42] (test)  loss: 1.0210 -> 1.1679   acc: 63.16% -> 55.79%             
client [69] (test)  loss: 1.3061 -> 1.3163   acc: 51.85% -> 47.04%             
client [59] (test)  loss: 1.3315 -> 1.8876   acc: 52.06% -> 36.08%             
client [7] (test)  loss: 1.4926 -> 1.6269   acc: 49.11% -> 39.68%              
client [26] (test)  loss: 0.8836 -> 0.8318   acc: 71.99% -> 70.49%             
client [49] (test)  loss: 1.3026 -> 1.3472   acc: 55.69% -> 54.70%             
client [98] (test)  loss: 1.1352 -> 1.2896   acc: 61.97% -> 52.92%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.0910 -> 1.2578   acc: 61.37% -> 55.13%             
client [47] (test)  loss: 0.9635 -> 1.0518   acc: 66.79% -> 62.38%             
client [21] (test)  loss: 0.8376 -> 0.9360   acc: 72.76% -> 65.59%             
client [77] (test)  loss: 0.8088 -> 0.8409   acc: 73.76% -> 73.36%             
client [95] (test)  loss: 0.7318 -> 0.8959   acc: 73.28% -> 64.05%             
client [91] (test)  loss: 1.2788 -> 1.2829   acc: 58.22% -> 57.44%             
client [14] (test)  loss: 1.4284 -> 1.6256   acc: 52.13% -> 43.11%             
client [99] (test)  loss: 0.5813 -> 0.8840   acc: 80.85% -> 68.47%             
client [20] (test)  loss: 1.4551 -> 1.4230   acc: 49.10% -> 50.45%             
client [39] (test)  loss: 1.1903 -> 1.3230   acc: 60.04% -> 54.39%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1665 -> 1.1910   acc: 56.74% -> 52.62%             
client [62] (test)  loss: 1.1066 -> 1.1258   acc: 63.16% -> 61.84%             
client [71] (test)  loss: 1.2704 -> 1.3440   acc: 56.48% -> 54.95%             
client [97] (test)  loss: 1.2890 -> 1.4689   acc: 53.27% -> 44.70%             
client [30] (test)  loss: 0.9476 -> 0.9773   acc: 69.52% -> 68.38%             
client [88] (test)  loss: 1.1711 -> 1.3067   acc: 61.26% -> 54.11%             
client [60] (test)  loss: 1.2421 -> 1.3009   acc: 56.11% -> 55.31%             
client [82] (test)  loss: 1.2238 -> 1.1939   acc: 55.99% -> 61.46%             
client [91] (test)  loss: 1.2820 -> 1.2189   acc: 61.62% -> 59.27%             
client [57] (test)  loss: 1.2968 -> 1.3951   acc: 58.86% -> 55.86%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9201 -> 1.2649   acc: 70.38% -> 68.01%             
client [15] (test)  loss: 1.0961 -> 1.1597   acc: 65.59% -> 62.15%             
client [71] (test)  loss: 1.2422 -> 1.2878   acc: 58.53% -> 56.48%             
client [97] (test)  loss: 1.2207 -> 1.4248   acc: 54.40% -> 46.28%             
client [53] (test)  loss: 1.0109 -> 0.9580   acc: 67.54% -> 70.47%             
client [77] (test)  loss: 0.6989 -> 0.7602   acc: 78.53% -> 76.74%             
client [76] (test)  loss: 1.2591 -> 1.2469   acc: 57.10% -> 54.79%             
client [79] (test)  loss: 0.2514 -> 0.3107   acc: 90.81% -> 89.71%             
client [28] (test)  loss: 0.9888 -> 1.0614   acc: 68.81% -> 66.72%             
client [99] (test)  loss: 0.5110 -> 0.8010   acc: 83.37% -> 72.34%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.1774 -> 1.3937   acc: 60.50% -> 47.40%             
client [86] (test)  loss: 1.1693 -> 1.8720   acc: 62.79% -> 48.64%             
client [34] (test)  loss: 1.1964 -> 1.5034   acc: 58.03% -> 51.26%             
client [73] (test)  loss: 0.7616 -> 0.7612   acc: 73.04% -> 73.20%             
client [5] (test)  loss: 1.0937 -> 1.2548   acc: 65.83% -> 58.25%              
client [96] (test)  loss: 0.7857 -> 0.8037   acc: 73.13% -> 71.47%             
client [22] (test)  loss: 0.8638 -> 0.9311   acc: 72.97% -> 68.11%             
client [60] (test)  loss: 1.0858 -> 1.1896   acc: 63.93% -> 57.92%             
client [66] (test)  loss: 0.0297 -> 0.0262   acc: 99.03% -> 99.03%             
client [83] (test)  loss: 1.1023 -> 1.3383   acc: 66.74% -> 56.96%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.1813 -> 1.1537   acc: 58.09% -> 58.09%             
client [65] (test)  loss: 0.5389 -> 0.6071   acc: 81.05% -> 79.78%             
client [95] (test)  loss: 0.6299 -> 0.6937   acc: 77.41% -> 74.07%             
client [17] (test)  loss: 1.1932 -> 1.3953   acc: 60.11% -> 51.44%             
client [8] (test)  loss: 1.0038 -> 1.0006   acc: 66.35% -> 68.96%              
client [35] (test)  loss: 0.7914 -> 0.9450   acc: 74.10% -> 69.12%             
client [98] (test)  loss: 0.8883 -> 0.9724   acc: 68.01% -> 67.40%             
client [53] (test)  loss: 0.9167 -> 0.8918   acc: 69.88% -> 73.10%             
client [43] (test)  loss: 0.9704 -> 2.1966   acc: 68.71% -> 42.52%             
client [64] (test)  loss: 1.0898 -> 1.5054   acc: 60.96% -> 50.13%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6544 -> 0.6955   acc: 79.39% -> 75.45%             
client [88] (test)  loss: 0.9668 -> 1.1049   acc: 70.32% -> 63.16%             
client [38] (test)  loss: 0.8876 -> 0.9181   acc: 68.69% -> 69.76%             
client [3] (test)  loss: 0.8512 -> 0.9186   acc: 72.45% -> 69.21%              
client [5] (test)  loss: 1.0112 -> 1.2219   acc: 68.16% -> 60.58%              
client [41] (test)  loss: 0.9775 -> 0.9776   acc: 69.80% -> 68.43%             
client [7] (test)  loss: 1.1518 -> 1.4794   acc: 60.32% -> 49.11%              
client [37] (test)  loss: 0.9618 -> 0.9730   acc: 69.70% -> 67.92%             
client [45] (test)  loss: 0.8943 -> 1.1069   acc: 71.40% -> 60.79%             
client [47] (test)  loss: 0.7192 -> 0.8829   acc: 74.66% -> 69.87%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5634 -> 0.5729   acc: 80.71% -> 83.12%             
client [11] (test)  loss: 0.1832 -> 0.1857   acc: 93.79% -> 93.59%             
client [37] (test)  loss: 0.9296 -> 0.9447   acc: 71.29% -> 68.91%             
client [41] (test)  loss: 0.9335 -> 0.9348   acc: 70.98% -> 69.22%             
client [95] (test)  loss: 0.5467 -> 0.6285   acc: 80.16% -> 77.21%             
client [53] (test)  loss: 0.9055 -> 0.8371   acc: 72.22% -> 75.44%             
client [22] (test)  loss: 0.8055 -> 0.8120   acc: 75.68% -> 74.41%             
client [25] (test)  loss: 1.0371 -> 1.1757   acc: 66.73% -> 63.27%             
client [69] (test)  loss: 0.9933 -> 1.0081   acc: 60.93% -> 62.22%             
client [46] (test)  loss: 0.6905 -> 0.8516   acc: 79.93% -> 72.49%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6344 -> 0.7960   acc: 77.35% -> 73.13%             
client [69] (test)  loss: 0.9674 -> 0.9893   acc: 63.15% -> 61.11%             
client [82] (test)  loss: 0.9335 -> 0.9724   acc: 68.23% -> 67.97%             
client [45] (test)  loss: 0.8436 -> 1.1960   acc: 70.55% -> 58.73%             
client [7] (test)  loss: 1.0893 -> 1.4736   acc: 61.21% -> 50.00%              
client [50] (test)  loss: 0.9171 -> 0.9605   acc: 67.73% -> 67.33%             
client [35] (test)  loss: 0.7403 -> 0.8789   acc: 73.31% -> 71.31%             
client [24] (test)  loss: 1.1448 -> 1.2836   acc: 65.03% -> 60.84%             
client [15] (test)  loss: 0.9286 -> 1.0562   acc: 71.40% -> 66.67%             
client [58] (test)  loss: 1.2450 -> 1.5410   acc: 60.36% -> 54.41%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7092 -> 0.7218   acc: 74.51% -> 72.75%             
client [76] (test)  loss: 1.0147 -> 1.0356   acc: 67.00% -> 62.71%             
client [67] (test)  loss: 0.8083 -> 0.8472   acc: 72.50% -> 70.94%             
client [37] (test)  loss: 0.8995 -> 0.9030   acc: 72.28% -> 71.09%             
client [58] (test)  loss: 1.2220 -> 1.4498   acc: 61.98% -> 56.22%             
client [64] (test)  loss: 0.9724 -> 1.4274   acc: 65.74% -> 54.16%             
client [77] (test)  loss: 0.5559 -> 0.6408   acc: 83.50% -> 80.91%             
client [55] (test)  loss: 0.6876 -> 0.8467   acc: 75.68% -> 70.08%             
client [12] (test)  loss: 0.7659 -> 0.8403   acc: 76.12% -> 73.88%             
client [89] (test)  loss: 0.7497 -> 0.7976   acc: 77.53% -> 74.70%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9526 -> 0.9755   acc: 66.29% -> 65.38%             
client [51] (test)  loss: 1.0262 -> 1.0667   acc: 68.98% -> 68.78%             
client [8] (test)  loss: 0.8812 -> 0.8537   acc: 72.99% -> 73.46%              
client [18] (test)  loss: 0.8595 -> 0.9262   acc: 72.65% -> 71.27%             
client [94] (test)  loss: 0.7861 -> 0.7526   acc: 76.19% -> 76.59%             
client [81] (test)  loss: 0.9646 -> 1.0266   acc: 66.60% -> 64.92%             
client [3] (test)  loss: 0.7932 -> 0.8450   acc: 73.58% -> 72.12%              
client [11] (test)  loss: 0.1891 -> 0.1694   acc: 93.20% -> 93.59%             
client [95] (test)  loss: 0.5384 -> 0.5492   acc: 80.94% -> 79.96%             
client [67] (test)  loss: 0.8030 -> 0.8549   acc: 74.69% -> 70.94%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5687 -> 0.5781   acc: 81.72% -> 79.93%             
client [79] (test)  loss: 0.1873 -> 0.2446   acc: 94.30% -> 92.28%             
client [58] (test)  loss: 1.1696 -> 1.4321   acc: 63.60% -> 56.22%             
client [88] (test)  loss: 0.8768 -> 0.9139   acc: 70.95% -> 70.53%             
client [46] (test)  loss: 0.6392 -> 0.7929   acc: 80.11% -> 75.09%             
client [11] (test)  loss: 0.1744 -> 0.1595   acc: 93.20% -> 94.76%             
client [55] (test)  loss: 0.6128 -> 0.8154   acc: 77.76% -> 72.16%             
client [13] (test)  loss: 0.1333 -> 0.1272   acc: 95.75% -> 95.59%             
client [31] (test)  loss: 0.8047 -> 0.7489   acc: 74.88% -> 77.49%             
client [75] (test)  loss: 0.6967 -> 0.7283   acc: 77.55% -> 75.09%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3997 -> 0.4195   acc: 87.43% -> 87.43%             
client [7] (test)  loss: 0.9851 -> 1.1623   acc: 65.12% -> 59.25%              
client [57] (test)  loss: 0.8808 -> 1.0154   acc: 74.47% -> 71.17%             
client [13] (test)  loss: 0.1284 -> 0.1238   acc: 95.59% -> 95.59%             
client [43] (test)  loss: 0.9531 -> 1.8353   acc: 71.43% -> 47.62%             
client [91] (test)  loss: 0.8732 -> 0.8537   acc: 71.80% -> 73.37%             
client [10] (test)  loss: 1.0667 -> 1.0187   acc: 68.64% -> 66.59%             
client [64] (test)  loss: 0.9060 -> 1.4248   acc: 68.51% -> 55.16%             
client [82] (test)  loss: 0.8945 -> 0.9039   acc: 68.23% -> 70.57%             
client [22] (test)  loss: 0.7196 -> 0.7275   acc: 78.56% -> 78.38%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0511 -> 1.0557   acc: 63.96% -> 62.61%             
client [23] (test)  loss: 0.8000 -> 0.8930   acc: 73.57% -> 70.31%             
client [88] (test)  loss: 0.7978 -> 0.8748   acc: 74.32% -> 71.58%             
client [98] (test)  loss: 0.6894 -> 0.8075   acc: 76.86% -> 72.43%             
client [79] (test)  loss: 0.1803 -> 0.2458   acc: 94.30% -> 92.46%             
client [21] (test)  loss: 0.5603 -> 0.5731   acc: 81.90% -> 80.11%             
client [92] (test)  loss: 1.0179 -> 1.1957   acc: 68.19% -> 61.66%             
client [56] (test)  loss: 0.3765 -> 0.4951   acc: 87.69% -> 83.08%             
client [5] (test)  loss: 0.8733 -> 1.0708   acc: 74.17% -> 67.77%              
client [52] (test)  loss: 0.8242 -> 0.8622   acc: 70.60% -> 69.10%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.9417 -> 0.0000', 'accuracy': '68.22% -> 0.00%'},          
    200: {'loss': '0.7053 -> 0.0000', 'accuracy': '77.06% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(10.48%) at epoch: 0                                      
FedRep achieved 20.0%(21.68%) at epoch: 3                                      
FedRep achieved 30.0%(36.13%) at epoch: 4                                      
FedRep achieved 40.0%(42.22%) at epoch: 21                                     
FedRep achieved 50.0%(50.59%) at epoch: 27                                     
FedRep achieved 60.0%(60.13%) at epoch: 36                                     
FedRep achieved 70.0%(70.25%) at epoch: 95                                     
FedRep achieved 80.0%(80.38%) at epoch: 171                                    
Convergence (test_after):                                                      
FedRep achieved 30.0%(34.95%) at epoch: 0                                      
FedRep achieved 40.0%(44.99%) at epoch: 4                                      
FedRep achieved 50.0%(50.96%) at epoch: 30                                     
FedRep achieved 60.0%(63.71%) at epoch: 59                                     
FedRep achieved 70.0%(71.00%) at epoch: 98                                     
