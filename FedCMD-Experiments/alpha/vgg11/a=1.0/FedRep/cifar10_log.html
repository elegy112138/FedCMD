==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4759 -> 1.5081   acc: 48.70% -> 39.38%             
client [81] (test)  loss: 1.6003 -> 1.9521   acc: 46.77% -> 34.46%             
client [21] (test)  loss: 1.8531 -> 1.5734   acc: 33.43% -> 46.20%             
client [68] (test)  loss: 1.6066 -> 1.5272   acc: 41.03% -> 46.79%             
client [93] (test)  loss: 1.5094 -> 1.4817   acc: 45.54% -> 45.83%             
client [31] (test)  loss: 2.4480 -> 1.5792   acc: 22.61% -> 36.75%             
client [20] (test)  loss: 1.1592 -> 1.2067   acc: 59.56% -> 60.29%             
client [59] (test)  loss: 1.7515 -> 1.7435   acc: 32.94% -> 41.11%             
client [48] (test)  loss: 1.1228 -> 1.3763   acc: 61.98% -> 47.11%             
client [34] (test)  loss: 1.5768 -> 1.6359   acc: 44.41% -> 43.32%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9660 -> 1.4845   acc: 41.89% -> 50.00%             
client [99] (test)  loss: 1.2769 -> 1.2498   acc: 50.94% -> 55.19%             
client [67] (test)  loss: 1.1783 -> 1.1988   acc: 59.76% -> 58.58%             
client [0] (test)  loss: 1.0871 -> 1.1821   acc: 65.02% -> 61.32%              
client [76] (test)  loss: 1.2343 -> 1.3240   acc: 59.15% -> 54.90%             
client [41] (test)  loss: 1.3953 -> 1.3807   acc: 45.35% -> 55.02%             
client [62] (test)  loss: 1.3836 -> 1.4002   acc: 50.34% -> 62.93%             
client [2] (test)  loss: 1.7393 -> 1.3168   acc: 37.72% -> 56.75%              
client [14] (test)  loss: 1.2773 -> 1.4204   acc: 53.94% -> 50.62%             
client [46] (test)  loss: 1.2165 -> 1.3504   acc: 57.85% -> 57.30%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9322 -> 1.0083   acc: 64.20% -> 62.72%             
client [68] (test)  loss: 1.2847 -> 1.3014   acc: 52.56% -> 54.81%             
client [57] (test)  loss: 1.3231 -> 1.9558   acc: 54.46% -> 42.86%             
client [17] (test)  loss: 1.0646 -> 1.3490   acc: 65.17% -> 53.55%             
client [54] (test)  loss: 1.1697 -> 1.1742   acc: 58.30% -> 56.28%             
client [23] (test)  loss: 1.3272 -> 1.2806   acc: 54.26% -> 53.63%             
client [35] (test)  loss: 1.2397 -> 1.2159   acc: 57.82% -> 64.00%             
client [59] (test)  loss: 1.2874 -> 1.4226   acc: 51.90% -> 49.27%             
client [31] (test)  loss: 1.1538 -> 1.3179   acc: 54.77% -> 50.18%             
client [9] (test)  loss: 0.9401 -> 1.0672   acc: 66.77% -> 60.50%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9414 -> 0.9628   acc: 67.78% -> 69.30%             
client [33] (test)  loss: 1.2769 -> 1.3852   acc: 53.80% -> 47.85%             
client [16] (test)  loss: 1.0206 -> 1.2603   acc: 63.00% -> 57.80%             
client [44] (test)  loss: 1.5549 -> 1.3866   acc: 50.17% -> 47.49%             
client [8] (test)  loss: 1.1200 -> 1.1451   acc: 62.22% -> 60.45%              
client [31] (test)  loss: 1.1401 -> 1.2754   acc: 57.95% -> 52.65%             
client [47] (test)  loss: 1.2056 -> 1.1843   acc: 54.98% -> 55.63%             
client [36] (test)  loss: 1.0507 -> 1.2782   acc: 63.69% -> 59.08%             
client [20] (test)  loss: 0.7805 -> 0.8826   acc: 73.90% -> 71.32%             
client [56] (test)  loss: 1.1368 -> 1.4003   acc: 66.03% -> 56.49%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.9074 -> 0.9849   acc: 69.51% -> 67.03%              
client [60] (test)  loss: 1.0714 -> 2.0032   acc: 62.29% -> 60.59%             
client [28] (test)  loss: 0.7960 -> 1.1904   acc: 71.43% -> 65.53%             
client [25] (test)  loss: 1.1315 -> 1.2985   acc: 55.19% -> 51.34%             
client [58] (test)  loss: 1.1784 -> 1.2227   acc: 56.00% -> 57.85%             
client [44] (test)  loss: 1.0346 -> 1.2281   acc: 62.88% -> 54.85%             
client [39] (test)  loss: 1.0826 -> 1.1406   acc: 62.22% -> 60.00%             
client [29] (test)  loss: 1.1131 -> 1.0586   acc: 64.82% -> 63.32%             
client [3] (test)  loss: 1.1219 -> 1.2058   acc: 64.92% -> 64.11%              
client [84] (test)  loss: 1.0874 -> 1.0056   acc: 63.64% -> 63.64%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.0422 -> 1.4107   acc: 65.05% -> 55.32%             
client [84] (test)  loss: 0.8762 -> 1.0120   acc: 68.18% -> 62.34%             
client [10] (test)  loss: 1.1875 -> 1.2542   acc: 57.95% -> 53.03%             
client [36] (test)  loss: 0.9322 -> 1.0408   acc: 69.23% -> 65.54%             
client [65] (test)  loss: 0.8193 -> 0.8935   acc: 64.68% -> 66.67%             
client [81] (test)  loss: 1.2292 -> 1.4384   acc: 59.08% -> 52.62%             
client [79] (test)  loss: 1.0578 -> 1.1727   acc: 62.43% -> 59.12%             
client [42] (test)  loss: 1.0475 -> 1.3381   acc: 63.31% -> 61.06%             
client [11] (test)  loss: 1.0243 -> 1.0418   acc: 65.04% -> 63.41%             
client [96] (test)  loss: 1.0532 -> 1.1778   acc: 65.85% -> 54.47%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.0064 -> 1.0763   acc: 69.27% -> 65.74%              
client [53] (test)  loss: 0.9428 -> 1.1006   acc: 66.45% -> 61.29%             
client [52] (test)  loss: 0.8993 -> 1.0196   acc: 69.84% -> 64.13%             
client [42] (test)  loss: 1.0571 -> 1.3174   acc: 64.71% -> 62.18%             
client [69] (test)  loss: 1.0408 -> 1.1165   acc: 67.57% -> 65.32%             
client [59] (test)  loss: 1.1077 -> 1.3299   acc: 63.85% -> 55.98%             
client [7] (test)  loss: 0.7067 -> 0.6465   acc: 80.71% -> 81.47%              
client [26] (test)  loss: 0.7635 -> 0.8021   acc: 75.83% -> 74.30%             
client [49] (test)  loss: 0.6681 -> 0.7018   acc: 78.23% -> 76.34%             
client [98] (test)  loss: 1.0604 -> 1.0935   acc: 67.23% -> 63.45%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9902 -> 1.0967   acc: 66.39% -> 63.87%             
client [47] (test)  loss: 1.0475 -> 1.1647   acc: 65.59% -> 59.49%             
client [21] (test)  loss: 0.9992 -> 1.3796   acc: 67.17% -> 58.36%             
client [77] (test)  loss: 1.0047 -> 1.0944   acc: 64.25% -> 63.21%             
client [95] (test)  loss: 0.8985 -> 0.9037   acc: 68.69% -> 70.52%             
client [91] (test)  loss: 0.6428 -> 0.6454   acc: 79.11% -> 79.11%             
client [14] (test)  loss: 0.9066 -> 1.0153   acc: 72.61% -> 70.12%             
client [99] (test)  loss: 0.9576 -> 0.9650   acc: 65.09% -> 64.62%             
client [20] (test)  loss: 0.6399 -> 0.8162   acc: 77.21% -> 76.10%             
client [39] (test)  loss: 0.9016 -> 1.0577   acc: 68.44% -> 64.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8850 -> 0.9921   acc: 71.43% -> 67.62%             
client [62] (test)  loss: 0.7604 -> 0.8153   acc: 75.85% -> 73.47%             
client [71] (test)  loss: 1.0327 -> 1.1533   acc: 65.32% -> 65.77%             
client [97] (test)  loss: 0.9505 -> 1.1756   acc: 67.04% -> 62.92%             
client [30] (test)  loss: 0.9358 -> 0.9942   acc: 66.17% -> 64.99%             
client [88] (test)  loss: 1.0900 -> 1.2971   acc: 64.78% -> 63.12%             
client [60] (test)  loss: 0.7634 -> 2.1978   acc: 75.42% -> 63.98%             
client [82] (test)  loss: 0.9207 -> 1.1091   acc: 72.38% -> 68.53%             
client [91] (test)  loss: 0.6756 -> 0.6569   acc: 78.83% -> 78.83%             
client [57] (test)  loss: 1.0957 -> 1.7121   acc: 63.99% -> 56.55%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.0689 -> 1.1626   acc: 61.48% -> 62.54%             
client [15] (test)  loss: 0.7703 -> 0.8243   acc: 75.00% -> 73.08%             
client [71] (test)  loss: 1.0603 -> 1.1436   acc: 66.67% -> 63.51%             
client [97] (test)  loss: 1.0086 -> 1.2088   acc: 66.29% -> 63.67%             
client [53] (test)  loss: 0.9417 -> 1.0406   acc: 66.77% -> 63.87%             
client [77] (test)  loss: 0.9796 -> 1.0889   acc: 67.36% -> 64.77%             
client [76] (test)  loss: 1.0379 -> 1.1651   acc: 64.71% -> 59.15%             
client [79] (test)  loss: 1.0548 -> 1.1730   acc: 64.64% -> 60.22%             
client [28] (test)  loss: 0.7616 -> 0.8571   acc: 76.40% -> 74.84%             
client [99] (test)  loss: 0.9990 -> 0.9695   acc: 65.09% -> 64.62%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.9470 -> 1.2439   acc: 69.66% -> 64.04%             
client [86] (test)  loss: 0.5550 -> 0.6640   acc: 82.14% -> 80.95%             
client [34] (test)  loss: 1.1093 -> 1.2185   acc: 66.21% -> 64.58%             
client [73] (test)  loss: 0.8206 -> 0.9229   acc: 73.70% -> 69.26%             
client [5] (test)  loss: 1.0578 -> 1.1174   acc: 66.31% -> 65.78%              
client [96] (test)  loss: 0.9060 -> 1.0731   acc: 69.92% -> 68.29%             
client [22] (test)  loss: 0.8750 -> 0.9697   acc: 69.97% -> 67.64%             
client [60] (test)  loss: 0.7045 -> 0.8047   acc: 77.97% -> 74.58%             
client [66] (test)  loss: 1.0132 -> 1.0574   acc: 67.04% -> 67.87%             
client [83] (test)  loss: 1.1343 -> 1.4486   acc: 64.55% -> 57.09%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0718 -> 1.1502   acc: 66.99% -> 63.40%             
client [65] (test)  loss: 0.7039 -> 1.2179   acc: 72.62% -> 66.27%             
client [95] (test)  loss: 0.8572 -> 0.8724   acc: 73.56% -> 72.95%             
client [17] (test)  loss: 0.9440 -> 1.0198   acc: 71.09% -> 67.06%             
client [8] (test)  loss: 1.1189 -> 1.2503   acc: 67.25% -> 66.25%              
client [35] (test)  loss: 1.1481 -> 1.1558   acc: 66.91% -> 70.18%             
client [98] (test)  loss: 1.0726 -> 1.1164   acc: 68.91% -> 64.71%             
client [53] (test)  loss: 0.9412 -> 0.9783   acc: 70.65% -> 68.71%             
client [43] (test)  loss: 0.7198 -> 0.8401   acc: 79.32% -> 74.69%             
client [64] (test)  loss: 0.9254 -> 1.0145   acc: 75.08% -> 74.47%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.9596 -> 1.0917   acc: 69.60% -> 65.65%             
client [88] (test)  loss: 1.1699 -> 1.3471   acc: 66.11% -> 65.12%             
client [38] (test)  loss: 1.0287 -> 1.1676   acc: 68.40% -> 63.60%             
client [3] (test)  loss: 0.9586 -> 1.1283   acc: 71.77% -> 71.37%              
client [5] (test)  loss: 1.0752 -> 1.1906   acc: 67.38% -> 63.64%              
client [41] (test)  loss: 0.9183 -> 1.3808   acc: 69.89% -> 65.80%             
client [7] (test)  loss: 0.5051 -> 0.5922   acc: 86.55% -> 85.28%              
client [37] (test)  loss: 0.7362 -> 0.7641   acc: 78.82% -> 76.47%             
client [45] (test)  loss: 1.1878 -> 1.2250   acc: 65.79% -> 63.16%             
client [47] (test)  loss: 1.0583 -> 1.1124   acc: 65.59% -> 64.31%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9905 -> 1.0851   acc: 66.36% -> 63.00%             
client [11] (test)  loss: 0.9021 -> 1.0315   acc: 72.76% -> 69.92%             
client [37] (test)  loss: 0.7377 -> 0.7586   acc: 79.41% -> 78.24%             
client [41] (test)  loss: 0.8908 -> 1.1344   acc: 70.63% -> 67.66%             
client [95] (test)  loss: 0.9367 -> 0.8949   acc: 72.04% -> 71.43%             
client [53] (test)  loss: 0.9663 -> 0.9864   acc: 69.35% -> 66.13%             
client [22] (test)  loss: 0.8521 -> 0.9394   acc: 72.30% -> 70.85%             
client [25] (test)  loss: 1.1455 -> 1.2504   acc: 62.31% -> 59.94%             
client [69] (test)  loss: 1.1484 -> 1.2135   acc: 66.67% -> 64.86%             
client [46] (test)  loss: 1.0144 -> 1.1645   acc: 69.97% -> 66.12%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.1385 -> 1.3583   acc: 63.99% -> 63.02%             
client [69] (test)  loss: 1.1748 -> 1.2473   acc: 67.57% -> 65.32%             
client [82] (test)  loss: 0.9778 -> 1.1012   acc: 74.13% -> 70.63%             
client [45] (test)  loss: 1.2116 -> 1.4165   acc: 67.11% -> 62.83%             
client [7] (test)  loss: 0.5528 -> 0.6071   acc: 86.80% -> 85.79%              
client [50] (test)  loss: 0.9963 -> 1.1622   acc: 70.80% -> 69.20%             
client [35] (test)  loss: 1.1495 -> 1.1641   acc: 70.55% -> 69.82%             
client [24] (test)  loss: 0.9098 -> 0.8608   acc: 73.37% -> 74.85%             
client [15] (test)  loss: 0.8679 -> 0.9531   acc: 75.96% -> 72.12%             
client [58] (test)  loss: 1.2046 -> 1.2611   acc: 62.15% -> 63.69%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8760 -> 1.0874   acc: 77.96% -> 71.07%             
client [76] (test)  loss: 1.0705 -> 1.2917   acc: 69.61% -> 62.75%             
client [67] (test)  loss: 0.9246 -> 1.2369   acc: 70.12% -> 65.68%             
client [37] (test)  loss: 0.8224 -> 0.8044   acc: 77.65% -> 78.82%             
client [58] (test)  loss: 1.2283 -> 1.3683   acc: 62.15% -> 60.92%             
client [64] (test)  loss: 0.9704 -> 1.0846   acc: 76.29% -> 73.25%             
client [77] (test)  loss: 1.0185 -> 1.1313   acc: 66.84% -> 68.91%             
client [55] (test)  loss: 1.0600 -> 1.0233   acc: 66.53% -> 67.35%             
client [12] (test)  loss: 0.7164 -> 0.7220   acc: 80.48% -> 79.95%             
client [89] (test)  loss: 1.2721 -> 2.5105   acc: 67.59% -> 47.53%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.9546 -> 1.0298   acc: 70.78% -> 70.78%             
client [51] (test)  loss: 1.0142 -> 1.3858   acc: 68.54% -> 63.25%             
client [8] (test)  loss: 1.1661 -> 1.2717   acc: 69.77% -> 69.02%              
client [18] (test)  loss: 0.8363 -> 0.9630   acc: 77.52% -> 75.90%             
client [94] (test)  loss: 1.3065 -> 1.4825   acc: 63.85% -> 61.97%             
client [81] (test)  loss: 1.2673 -> 1.3095   acc: 64.31% -> 65.23%             
client [3] (test)  loss: 0.9643 -> 1.0178   acc: 72.18% -> 72.98%              
client [11] (test)  loss: 1.0307 -> 1.0773   acc: 71.95% -> 69.92%             
client [95] (test)  loss: 0.9799 -> 0.9927   acc: 70.52% -> 71.43%             
client [67] (test)  loss: 0.9053 -> 1.3004   acc: 70.12% -> 66.57%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1329 -> 1.1614   acc: 64.44% -> 66.57%             
client [79] (test)  loss: 1.1366 -> 1.2077   acc: 67.40% -> 67.40%             
client [58] (test)  loss: 1.3102 -> 1.4988   acc: 62.77% -> 59.38%             
client [88] (test)  loss: 1.2627 -> 1.4964   acc: 66.78% -> 64.45%             
client [46] (test)  loss: 1.0990 -> 1.2072   acc: 71.90% -> 67.77%             
client [11] (test)  loss: 1.0308 -> 1.1294   acc: 69.92% -> 67.48%             
client [55] (test)  loss: 1.1181 -> 4.0198   acc: 68.98% -> 37.14%             
client [13] (test)  loss: 0.9679 -> 1.0175   acc: 74.19% -> 72.58%             
client [31] (test)  loss: 1.2625 -> 1.6421   acc: 67.14% -> 56.18%             
client [75] (test)  loss: 1.0462 -> 1.1340   acc: 72.43% -> 69.15%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.0448 -> 1.2086   acc: 72.65% -> 68.57%             
client [7] (test)  loss: 0.5884 -> 0.6505   acc: 87.56% -> 86.55%              
client [57] (test)  loss: 1.3070 -> 1.5390   acc: 65.48% -> 63.99%             
client [13] (test)  loss: 0.9992 -> 1.0273   acc: 72.98% -> 72.18%             
client [43] (test)  loss: 0.7886 -> 0.8779   acc: 81.48% -> 78.70%             
client [91] (test)  loss: 0.7249 -> 1.6212   acc: 82.45% -> 69.36%             
client [10] (test)  loss: 1.1609 -> 1.5338   acc: 66.29% -> 57.95%             
client [64] (test)  loss: 1.1194 -> 1.2164   acc: 74.77% -> 74.16%             
client [82] (test)  loss: 0.9866 -> 1.0553   acc: 75.17% -> 74.13%             
client [22] (test)  loss: 1.0108 -> 1.0648   acc: 71.14% -> 69.39%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7312 -> 0.9438   acc: 76.47% -> 75.37%             
client [23] (test)  loss: 1.2062 -> 1.2232   acc: 67.19% -> 64.04%             
client [88] (test)  loss: 1.2916 -> 1.4708   acc: 67.11% -> 65.12%             
client [98] (test)  loss: 1.1156 -> 1.1917   acc: 68.07% -> 68.91%             
client [79] (test)  loss: 1.2068 -> 1.2437   acc: 66.85% -> 67.40%             
client [21] (test)  loss: 0.9885 -> 1.2266   acc: 70.82% -> 66.57%             
client [92] (test)  loss: 1.2088 -> 1.2637   acc: 69.84% -> 68.52%             
client [56] (test)  loss: 1.2298 -> 1.3134   acc: 71.37% -> 72.14%             
client [5] (test)  loss: 1.1736 -> 1.2531   acc: 69.52% -> 67.91%              
client [52] (test)  loss: 1.1203 -> 1.1163   acc: 73.65% -> 72.70%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.9208 -> 0.0000', 'accuracy': '69.97% -> 0.00%'},          
    200: {'loss': '1.0706 -> 0.0000', 'accuracy': '71.95% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(11.93%) at epoch: 1                                      
FedRep achieved 20.0%(28.07%) at epoch: 3                                      
FedRep achieved 30.0%(33.61%) at epoch: 4                                      
FedRep achieved 40.0%(48.34%) at epoch: 7                                      
FedRep achieved 50.0%(53.05%) at epoch: 13                                     
FedRep achieved 60.0%(63.14%) at epoch: 24                                     
FedRep achieved 70.0%(70.75%) at epoch: 69                                     
Convergence (test_after):                                                      
FedRep achieved 30.0%(33.47%) at epoch: 0                                      
FedRep achieved 40.0%(41.23%) at epoch: 4                                      
FedRep achieved 50.0%(51.43%) at epoch: 10                                     
FedRep achieved 60.0%(64.76%) at epoch: 31                                     
FedRep achieved 70.0%(70.16%) at epoch: 101                                    
