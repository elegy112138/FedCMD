==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9919 -> 0.6659   acc: 69.11% -> 80.22%             
client [81] (test)  loss: 0.9011 -> 1.3675   acc: 69.42% -> 51.24%             
client [21] (test)  loss: 1.2222 -> 0.6637   acc: 64.64% -> 81.75%             
client [68] (test)  loss: 0.6439 -> 0.4752   acc: 78.92% -> 88.89%             
client [93] (test)  loss: 0.8888 -> 0.9914   acc: 61.46% -> 65.85%             
client [31] (test)  loss: 1.6275 -> 1.2640   acc: 44.81% -> 64.61%             
client [20] (test)  loss: 0.7715 -> 1.0764   acc: 72.19% -> 64.12%             
client [59] (test)  loss: 0.9899 -> 0.4801   acc: 70.30% -> 82.02%             
client [48] (test)  loss: 0.8040 -> 1.6641   acc: 72.97% -> 64.53%             
client [34] (test)  loss: 0.8151 -> 0.9021   acc: 74.86% -> 66.10%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4821 -> 0.7531   acc: 87.46% -> 72.59%             
client [99] (test)  loss: 0.6671 -> 0.3463   acc: 75.12% -> 88.29%             
client [67] (test)  loss: 0.5243 -> 2.4302   acc: 84.17% -> 54.83%             
client [0] (test)  loss: 0.2991 -> 0.2420   acc: 90.13% -> 92.80%              
client [76] (test)  loss: 0.0937 -> 0.0937   acc: 98.13% -> 98.13%             
client [41] (test)  loss: 0.4681 -> 0.4557   acc: 82.65% -> 85.16%             
client [62] (test)  loss: 0.3646 -> 0.3411   acc: 88.55% -> 90.78%             
client [2] (test)  loss: 0.7846 -> 0.2682   acc: 81.23% -> 91.34%              
client [14] (test)  loss: 0.5975 -> 0.7218   acc: 80.11% -> 70.17%             
client [46] (test)  loss: 0.5883 -> 1.0998   acc: 79.46% -> 54.21%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3164 -> 0.5110   acc: 91.83% -> 86.77%             
client [68] (test)  loss: 0.0832 -> 0.1280   acc: 97.44% -> 96.30%             
client [57] (test)  loss: 0.1710 -> 0.3146   acc: 95.01% -> 89.50%             
client [17] (test)  loss: 0.2081 -> 0.1615   acc: 93.11% -> 95.49%             
client [54] (test)  loss: 0.1697 -> 0.1703   acc: 94.71% -> 93.87%             
client [23] (test)  loss: 0.2085 -> 0.1660   acc: 93.00% -> 94.40%             
client [35] (test)  loss: 0.2561 -> 0.3750   acc: 94.81% -> 90.44%             
client [59] (test)  loss: 0.0880 -> 0.1021   acc: 97.28% -> 97.00%             
client [31] (test)  loss: 0.2261 -> 0.2829   acc: 91.88% -> 92.21%             
client [9] (test)  loss: 0.1542 -> 0.4174   acc: 94.83% -> 87.07%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.0519 -> 0.3027   acc: 98.43% -> 86.65%             
client [33] (test)  loss: 0.1016 -> 0.7066   acc: 95.07% -> 79.93%             
client [16] (test)  loss: 0.1018 -> 0.1083   acc: 96.28% -> 96.03%             
client [44] (test)  loss: 0.3142 -> 0.1314   acc: 89.97% -> 96.46%             
client [8] (test)  loss: 0.1190 -> 0.1696   acc: 96.68% -> 94.90%              
client [31] (test)  loss: 0.1876 -> 0.1948   acc: 94.16% -> 93.51%             
client [47] (test)  loss: 0.1233 -> 0.3453   acc: 95.72% -> 88.12%             
client [36] (test)  loss: 0.1182 -> 0.1176   acc: 97.08% -> 95.86%             
client [20] (test)  loss: 0.1133 -> 0.3412   acc: 96.82% -> 88.54%             
client [56] (test)  loss: 0.1160 -> 0.1042   acc: 96.62% -> 97.46%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1265 -> 0.1257   acc: 96.55% -> 96.55%              
client [60] (test)  loss: 0.0794 -> 0.2131   acc: 97.07% -> 95.35%             
client [28] (test)  loss: 0.1529 -> 0.1450   acc: 96.21% -> 95.86%             
client [25] (test)  loss: 0.1290 -> 0.6047   acc: 96.41% -> 81.49%             
client [58] (test)  loss: 0.0526 -> 0.0602   acc: 98.06% -> 98.06%             
client [44] (test)  loss: 0.1251 -> 0.1357   acc: 95.87% -> 96.17%             
client [39] (test)  loss: 0.0927 -> 0.1342   acc: 97.36% -> 95.92%             
client [29] (test)  loss: 0.0606 -> 0.7988   acc: 98.33% -> 87.08%             
client [3] (test)  loss: 0.1000 -> 0.1585   acc: 96.74% -> 95.35%              
client [84] (test)  loss: 0.2010 -> 1.0186   acc: 94.59% -> 84.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.1449 -> 0.1462   acc: 95.82% -> 95.82%             
client [84] (test)  loss: 0.1856 -> 0.1982   acc: 94.85% -> 93.56%             
client [10] (test)  loss: 0.0823 -> 0.1053   acc: 97.61% -> 97.07%             
client [36] (test)  loss: 0.0782 -> 0.0936   acc: 97.81% -> 96.84%             
client [65] (test)  loss: 0.0933 -> 0.1209   acc: 97.83% -> 96.74%             
client [81] (test)  loss: 0.0684 -> 0.0684   acc: 97.11% -> 97.93%             
client [79] (test)  loss: 0.0938 -> 0.1649   acc: 97.22% -> 94.79%             
client [42] (test)  loss: 0.0398 -> 0.0329   acc: 98.76% -> 99.17%             
client [11] (test)  loss: 0.0680 -> 0.0642   acc: 98.31% -> 98.03%             
client [96] (test)  loss: 0.0777 -> 0.1128   acc: 97.49% -> 98.24%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0891 -> 0.1162   acc: 97.19% -> 96.94%              
client [53] (test)  loss: 0.1185 -> 0.0951   acc: 96.34% -> 96.75%             
client [52] (test)  loss: 0.1273 -> 0.1274   acc: 98.22% -> 98.58%             
client [42] (test)  loss: 0.0543 -> 0.0366   acc: 97.93% -> 99.17%             
client [69] (test)  loss: 0.1047 -> 0.1034   acc: 97.67% -> 97.38%             
client [59] (test)  loss: 0.0332 -> 0.0315   acc: 98.37% -> 98.91%             
client [7] (test)  loss: 0.1127 -> 0.1099   acc: 95.83% -> 96.88%              
client [26] (test)  loss: 0.1153 -> 0.1932   acc: 96.04% -> 96.26%             
client [49] (test)  loss: 0.0627 -> 0.0804   acc: 98.58% -> 97.17%             
client [98] (test)  loss: 0.1288 -> 0.1722   acc: 97.00% -> 95.51%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1338 -> 0.1422   acc: 96.63% -> 97.00%             
client [47] (test)  loss: 0.0251 -> 0.6015   acc: 99.05% -> 81.71%             
client [21] (test)  loss: 0.1317 -> 0.1446   acc: 96.96% -> 96.58%             
client [77] (test)  loss: 0.0688 -> 0.0612   acc: 97.02% -> 97.56%             
client [95] (test)  loss: 0.0402 -> 0.0600   acc: 98.20% -> 98.46%             
client [91] (test)  loss: 0.0447 -> 0.0587   acc: 99.12% -> 98.23%             
client [14] (test)  loss: 0.2755 -> 0.2450   acc: 95.58% -> 94.48%             
client [99] (test)  loss: 0.1729 -> 0.1253   acc: 94.88% -> 96.34%             
client [20] (test)  loss: 0.0830 -> 0.0647   acc: 97.88% -> 98.51%             
client [39] (test)  loss: 0.0875 -> 0.0943   acc: 97.60% -> 97.36%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1213 -> 0.1404   acc: 97.51% -> 98.22%             
client [62] (test)  loss: 0.0950 -> 0.0996   acc: 98.04% -> 98.04%             
client [71] (test)  loss: 0.0716 -> 0.0667   acc: 97.28% -> 98.09%             
client [97] (test)  loss: 0.0745 -> 0.0903   acc: 98.12% -> 97.81%             
client [30] (test)  loss: 0.0528 -> 0.0601   acc: 98.40% -> 98.17%             
client [88] (test)  loss: 0.0349 -> 0.0486   acc: 99.15% -> 98.51%             
client [60] (test)  loss: 0.0617 -> 0.0633   acc: 98.78% -> 98.53%             
client [82] (test)  loss: 0.1324 -> 0.1159   acc: 96.73% -> 96.33%             
client [91] (test)  loss: 0.0439 -> 0.0615   acc: 98.67% -> 97.79%             
client [57] (test)  loss: 0.0547 -> 0.1234   acc: 99.21% -> 96.85%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1797 -> 0.1880   acc: 95.45% -> 96.75%             
client [15] (test)  loss: 0.1128 -> 0.1721   acc: 97.18% -> 95.36%             
client [71] (test)  loss: 0.0690 -> 0.0613   acc: 98.09% -> 98.09%             
client [97] (test)  loss: 0.0551 -> 0.0701   acc: 99.06% -> 98.12%             
client [53] (test)  loss: 0.1100 -> 0.1051   acc: 95.93% -> 97.15%             
client [77] (test)  loss: 0.0580 -> 0.0506   acc: 97.29% -> 97.29%             
client [76] (test)  loss: 0.0668 -> 0.0603   acc: 96.26% -> 97.20%             
client [79] (test)  loss: 0.0888 -> 0.0987   acc: 97.40% -> 96.35%             
client [28] (test)  loss: 0.1424 -> 0.1330   acc: 97.24% -> 97.59%             
client [99] (test)  loss: 0.1249 -> 0.0985   acc: 95.61% -> 96.59%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0484 -> 0.0699   acc: 98.75% -> 98.44%             
client [86] (test)  loss: 0.1489 -> 0.1552   acc: 96.01% -> 96.38%             
client [34] (test)  loss: 0.0697 -> 0.0938   acc: 98.02% -> 97.18%             
client [73] (test)  loss: 0.0329 -> 0.0499   acc: 98.93% -> 98.40%             
client [5] (test)  loss: 0.1219 -> 0.1322   acc: 96.45% -> 96.70%              
client [96] (test)  loss: 0.0529 -> 0.0586   acc: 98.24% -> 98.24%             
client [22] (test)  loss: 0.0772 -> 0.0771   acc: 98.59% -> 98.31%             
client [60] (test)  loss: 0.0562 -> 0.0586   acc: 98.29% -> 98.53%             
client [66] (test)  loss: 0.0515 -> 0.1254   acc: 97.88% -> 95.97%             
client [83] (test)  loss: 0.0773 -> 0.0758   acc: 97.70% -> 97.19%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0610 -> 0.0603   acc: 97.20% -> 97.20%             
client [65] (test)  loss: 0.0763 -> 0.0698   acc: 97.83% -> 98.64%             
client [95] (test)  loss: 0.0433 -> 0.0497   acc: 98.71% -> 98.46%             
client [17] (test)  loss: 0.0699 -> 0.0909   acc: 98.10% -> 98.10%             
client [8] (test)  loss: 0.0841 -> 0.1305   acc: 98.21% -> 97.19%              
client [35] (test)  loss: 0.1471 -> 0.1530   acc: 97.27% -> 96.99%             
client [98] (test)  loss: 0.1472 -> 0.1565   acc: 97.00% -> 97.00%             
client [53] (test)  loss: 0.0833 -> 0.0995   acc: 96.75% -> 97.15%             
client [43] (test)  loss: 0.0977 -> 1.3740   acc: 98.48% -> 82.13%             
client [64] (test)  loss: 0.0568 -> 0.6074   acc: 98.69% -> 92.41%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1282 -> 0.1281   acc: 96.96% -> 96.96%             
client [88] (test)  loss: 0.0397 -> 0.0533   acc: 98.93% -> 98.72%             
client [38] (test)  loss: 0.0641 -> 0.0906   acc: 98.49% -> 97.73%             
client [3] (test)  loss: 0.0797 -> 0.1056   acc: 97.44% -> 97.21%              
client [5] (test)  loss: 0.1098 -> 0.1346   acc: 96.95% -> 96.95%              
client [41] (test)  loss: 0.0797 -> 0.0804   acc: 98.40% -> 98.63%             
client [7] (test)  loss: 0.0868 -> 0.0864   acc: 97.14% -> 97.40%              
client [37] (test)  loss: 0.0496 -> 0.0531   acc: 98.63% -> 98.63%             
client [45] (test)  loss: 0.0406 -> 0.0528   acc: 98.45% -> 98.45%             
client [47] (test)  loss: 0.0219 -> 0.1378   acc: 99.05% -> 97.39%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0634 -> 0.0370   acc: 98.26% -> 98.76%             
client [11] (test)  loss: 0.0581 -> 0.0691   acc: 98.03% -> 98.03%             
client [37] (test)  loss: 0.0684 -> 0.0618   acc: 98.09% -> 98.36%             
client [41] (test)  loss: 0.0935 -> 0.0855   acc: 97.49% -> 98.40%             
client [95] (test)  loss: 0.0502 -> 0.0517   acc: 98.20% -> 98.20%             
client [53] (test)  loss: 0.0875 -> 0.0974   acc: 96.75% -> 97.56%             
client [22] (test)  loss: 0.1073 -> 0.0878   acc: 97.74% -> 98.02%             
client [25] (test)  loss: 0.1073 -> 0.1072   acc: 97.24% -> 97.79%             
client [69] (test)  loss: 0.1302 -> 0.1117   acc: 97.08% -> 97.38%             
client [46] (test)  loss: 0.1691 -> 0.1435   acc: 95.29% -> 96.30%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0272 -> 0.0485   acc: 99.05% -> 98.34%             
client [69] (test)  loss: 0.1076 -> 0.1103   acc: 97.38% -> 97.38%             
client [82] (test)  loss: 0.1167 -> 0.1149   acc: 97.55% -> 97.55%             
client [45] (test)  loss: 0.0595 -> 0.0549   acc: 98.45% -> 98.45%             
client [7] (test)  loss: 0.0484 -> 0.0971   acc: 98.18% -> 96.61%              
client [50] (test)  loss: 0.0089 -> 0.0701   acc: 99.73% -> 98.63%             
client [35] (test)  loss: 0.1588 -> 0.1646   acc: 97.27% -> 97.27%             
client [24] (test)  loss: 0.0946 -> 0.0688   acc: 98.05% -> 98.05%             
client [15] (test)  loss: 0.1001 -> 0.1223   acc: 97.58% -> 96.98%             
client [58] (test)  loss: 0.0267 -> 0.0255   acc: 99.45% -> 99.45%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0681 -> 0.0643   acc: 98.65% -> 98.99%             
client [76] (test)  loss: 0.0579 -> 0.0550   acc: 97.20% -> 97.20%             
client [67] (test)  loss: 0.0856 -> 0.1304   acc: 98.07% -> 94.98%             
client [37] (test)  loss: 0.0609 -> 0.0631   acc: 98.91% -> 98.91%             
client [58] (test)  loss: 0.0251 -> 0.0238   acc: 99.72% -> 99.72%             
client [64] (test)  loss: 0.0657 -> 0.0638   acc: 98.95% -> 98.69%             
client [77] (test)  loss: 0.0398 -> 0.0349   acc: 98.64% -> 98.64%             
client [55] (test)  loss: 0.0694 -> 0.0844   acc: 98.04% -> 98.04%             
client [12] (test)  loss: 0.0635 -> 0.0555   acc: 97.73% -> 97.73%             
client [89] (test)  loss: 0.0612 -> 0.0497   acc: 98.82% -> 98.43%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1510 -> 0.1543   acc: 96.39% -> 96.91%             
client [51] (test)  loss: 0.1220 -> 0.1336   acc: 97.44% -> 96.71%             
client [8] (test)  loss: 0.0840 -> 0.0912   acc: 98.21% -> 98.21%              
client [18] (test)  loss: 0.0653 -> 0.0653   acc: 97.81% -> 97.81%             
client [94] (test)  loss: 0.0245 -> 0.0343   acc: 98.78% -> 99.27%             
client [81] (test)  loss: 0.0574 -> 0.0617   acc: 98.35% -> 98.35%             
client [3] (test)  loss: 0.0893 -> 0.0937   acc: 97.91% -> 97.67%              
client [11] (test)  loss: 0.0555 -> 0.0520   acc: 98.31% -> 98.31%             
client [95] (test)  loss: 0.0322 -> 0.0329   acc: 98.97% -> 98.71%             
client [67] (test)  loss: 0.1149 -> 0.1554   acc: 96.91% -> 95.75%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4478 -> 0.1427   acc: 87.83% -> 96.20%             
client [79] (test)  loss: 0.1004 -> 0.0957   acc: 97.40% -> 97.92%             
client [58] (test)  loss: 0.0663 -> 0.0331   acc: 98.06% -> 98.61%             
client [88] (test)  loss: 0.0817 -> 0.0510   acc: 97.87% -> 98.51%             
client [46] (test)  loss: 0.4722 -> 0.1527   acc: 85.52% -> 95.96%             
client [11] (test)  loss: 0.0686 -> 0.0891   acc: 98.87% -> 98.31%             
client [55] (test)  loss: 0.4920 -> 0.0724   acc: 79.61% -> 98.43%             
client [13] (test)  loss: 0.2700 -> 0.1834   acc: 92.37% -> 95.42%             
client [31] (test)  loss: 0.3897 -> 0.1524   acc: 88.31% -> 96.10%             
client [75] (test)  loss: 0.0981 -> 0.0597   acc: 97.73% -> 98.02%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0918 -> 0.0814   acc: 97.87% -> 97.87%             
client [7] (test)  loss: 0.0748 -> 0.0723   acc: 98.44% -> 98.18%              
client [57] (test)  loss: 0.0501 -> 0.0476   acc: 98.95% -> 98.95%             
client [13] (test)  loss: 0.1581 -> 0.1689   acc: 95.80% -> 95.80%             
client [43] (test)  loss: 0.1063 -> 0.0994   acc: 97.34% -> 98.48%             
client [91] (test)  loss: 0.0875 -> 0.0395   acc: 98.23% -> 99.12%             
client [10] (test)  loss: 0.0990 -> 0.1027   acc: 97.34% -> 97.87%             
client [64] (test)  loss: 0.0666 -> 0.0686   acc: 98.95% -> 98.95%             
client [82] (test)  loss: 0.0995 -> 0.1101   acc: 97.96% -> 97.14%             
client [22] (test)  loss: 0.0846 -> 0.0880   acc: 98.31% -> 98.02%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0856 -> 0.1023   acc: 98.09% -> 97.88%             
client [23] (test)  loss: 0.0794 -> 0.0825   acc: 97.20% -> 97.48%             
client [88] (test)  loss: 0.0380 -> 0.0543   acc: 98.93% -> 98.72%             
client [98] (test)  loss: 0.1255 -> 0.1247   acc: 97.38% -> 97.38%             
client [79] (test)  loss: 0.1161 -> 0.1181   acc: 97.92% -> 97.57%             
client [21] (test)  loss: 0.1379 -> 0.1312   acc: 96.96% -> 97.34%             
client [92] (test)  loss: 0.0955 -> 0.0886   acc: 98.66% -> 98.66%             
client [56] (test)  loss: 0.0630 -> 0.0653   acc: 98.31% -> 97.75%             
client [5] (test)  loss: 0.1336 -> 0.1397   acc: 96.70% -> 96.95%              
client [52] (test)  loss: 0.1936 -> 0.1575   acc: 96.44% -> 97.86%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.0837 -> 0.0000', 'accuracy': '97.61% -> 0.00%'},          
    200: {'loss': '0.0833 -> 0.0000', 'accuracy': '97.97% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(15.47%) at epoch: 1                                      
FedRep achieved 20.0%(24.65%) at epoch: 2                                      
FedRep achieved 30.0%(38.26%) at epoch: 4                                      
FedRep achieved 40.0%(45.24%) at epoch: 6                                      
FedRep achieved 50.0%(55.46%) at epoch: 7                                      
FedRep achieved 60.0%(68.17%) at epoch: 9                                      
FedRep achieved 70.0%(71.87%) at epoch: 12                                     
FedRep achieved 80.0%(87.91%) at epoch: 16                                     
FedRep achieved 90.0%(92.05%) at epoch: 27                                     
Convergence (test_after):                                                      
FedRep achieved 20.0%(29.84%) at epoch: 0                                      
FedRep achieved 30.0%(36.36%) at epoch: 2                                      
FedRep achieved 40.0%(49.15%) at epoch: 3                                      
FedRep achieved 60.0%(64.99%) at epoch: 7                                      
FedRep achieved 70.0%(71.23%) at epoch: 9                                      
FedRep achieved 80.0%(87.44%) at epoch: 15                                     
FedRep achieved 90.0%(90.74%) at epoch: 26                                     
