==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6435 -> 0.5048   acc: 76.43% -> 78.93%             
client [81] (test)  loss: 0.9499 -> 0.7869   acc: 62.75% -> 68.35%             
client [21] (test)  loss: 0.5018 -> 0.5333   acc: 81.11% -> 83.33%             
client [68] (test)  loss: 0.6723 -> 0.6376   acc: 71.52% -> 74.05%             
client [93] (test)  loss: 0.8169 -> 0.4657   acc: 66.03% -> 82.54%             
client [31] (test)  loss: 1.0928 -> 0.6752   acc: 55.67% -> 74.55%             
client [20] (test)  loss: 0.7259 -> 0.7628   acc: 76.43% -> 77.39%             
client [59] (test)  loss: 0.4683 -> 0.3993   acc: 84.29% -> 86.29%             
client [48] (test)  loss: 0.4584 -> 0.2758   acc: 82.68% -> 87.66%             
client [34] (test)  loss: 0.5871 -> 0.5112   acc: 76.09% -> 82.88%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3905 -> 0.2934   acc: 85.71% -> 89.87%             
client [99] (test)  loss: 0.3887 -> 0.3113   acc: 87.57% -> 90.11%             
client [67] (test)  loss: 0.3794 -> 0.3720   acc: 86.65% -> 89.42%             
client [0] (test)  loss: 0.4854 -> 0.4808   acc: 83.51% -> 82.45%              
client [76] (test)  loss: 0.3922 -> 0.3274   acc: 88.01% -> 89.29%             
client [41] (test)  loss: 0.7118 -> 0.6423   acc: 76.38% -> 75.65%             
client [62] (test)  loss: 0.4963 -> 0.5271   acc: 85.02% -> 81.35%             
client [2] (test)  loss: 0.5349 -> 0.5681   acc: 78.32% -> 81.59%              
client [14] (test)  loss: 0.6009 -> 0.4815   acc: 78.84% -> 84.89%             
client [46] (test)  loss: 0.4942 -> 0.3302   acc: 82.80% -> 87.46%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3970 -> 0.4939   acc: 86.15% -> 85.64%             
client [68] (test)  loss: 0.4314 -> 0.5000   acc: 82.91% -> 82.28%             
client [57] (test)  loss: 0.3565 -> 0.3757   acc: 89.89% -> 88.81%             
client [17] (test)  loss: 0.4194 -> 0.2801   acc: 85.34% -> 91.10%             
client [54] (test)  loss: 0.3374 -> 0.2596   acc: 89.02% -> 92.36%             
client [23] (test)  loss: 0.7853 -> 0.3680   acc: 73.67% -> 89.60%             
client [35] (test)  loss: 0.4193 -> 0.3153   acc: 85.26% -> 88.81%             
client [59] (test)  loss: 0.4442 -> 0.3097   acc: 86.00% -> 88.00%             
client [31] (test)  loss: 0.6304 -> 0.5527   acc: 75.35% -> 79.92%             
client [9] (test)  loss: 0.4501 -> 0.4590   acc: 83.88% -> 83.63%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6909 -> 0.4965   acc: 74.79% -> 80.17%             
client [33] (test)  loss: 0.3813 -> 0.4024   acc: 85.41% -> 86.22%             
client [16] (test)  loss: 0.3135 -> 0.2191   acc: 90.05% -> 93.72%             
client [44] (test)  loss: 0.3621 -> 0.3043   acc: 85.46% -> 89.21%             
client [8] (test)  loss: 0.4128 -> 0.5100   acc: 85.16% -> 83.23%              
client [31] (test)  loss: 0.7156 -> 0.5507   acc: 70.38% -> 78.73%             
client [47] (test)  loss: 0.6132 -> 1.0063   acc: 76.40% -> 71.91%             
client [36] (test)  loss: 0.4667 -> 0.4396   acc: 82.21% -> 83.13%             
client [20] (test)  loss: 0.5585 -> 0.6062   acc: 81.21% -> 83.44%             
client [56] (test)  loss: 0.4576 -> 0.4652   acc: 86.25% -> 86.88%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5470 -> 0.6431   acc: 80.41% -> 75.00%              
client [60] (test)  loss: 0.3750 -> 0.2811   acc: 88.37% -> 91.34%             
client [28] (test)  loss: 0.5488 -> 0.5292   acc: 82.95% -> 82.95%             
client [25] (test)  loss: 0.5172 -> 0.4628   acc: 83.11% -> 82.85%             
client [58] (test)  loss: 0.3722 -> 0.2279   acc: 87.70% -> 91.36%             
client [44] (test)  loss: 0.4410 -> 0.2967   acc: 83.26% -> 89.65%             
client [39] (test)  loss: 0.7973 -> 0.3672   acc: 68.12% -> 88.01%             
client [29] (test)  loss: 0.6044 -> 0.4691   acc: 79.04% -> 85.33%             
client [3] (test)  loss: 0.4652 -> 0.3305   acc: 82.09% -> 87.05%              
client [84] (test)  loss: 0.5410 -> 0.3432   acc: 80.58% -> 88.41%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3981 -> 0.4239   acc: 86.94% -> 88.33%             
client [84] (test)  loss: 0.4993 -> 0.3383   acc: 82.32% -> 89.28%             
client [10] (test)  loss: 0.2489 -> 0.2686   acc: 91.39% -> 91.67%             
client [36] (test)  loss: 0.4638 -> 0.4285   acc: 83.74% -> 84.66%             
client [65] (test)  loss: 0.2832 -> 0.3528   acc: 89.73% -> 87.28%             
client [81] (test)  loss: 0.6036 -> 0.6061   acc: 79.27% -> 77.31%             
client [79] (test)  loss: 0.5439 -> 0.3731   acc: 82.60% -> 85.64%             
client [42] (test)  loss: 0.8428 -> 0.4118   acc: 71.63% -> 86.98%             
client [11] (test)  loss: 0.4978 -> 0.4875   acc: 84.78% -> 86.23%             
client [96] (test)  loss: 0.3017 -> 0.3105   acc: 91.41% -> 89.75%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3775 -> 0.4477   acc: 88.06% -> 85.81%              
client [53] (test)  loss: 0.3448 -> 0.1919   acc: 88.38% -> 94.52%             
client [52] (test)  loss: 0.5105 -> 0.4453   acc: 82.27% -> 85.04%             
client [42] (test)  loss: 0.6035 -> 0.4500   acc: 78.14% -> 85.12%             
client [69] (test)  loss: 0.3386 -> 0.2261   acc: 88.31% -> 92.21%             
client [59] (test)  loss: 0.3834 -> 0.3073   acc: 87.14% -> 90.00%             
client [7] (test)  loss: 0.4454 -> 0.5001   acc: 85.56% -> 83.06%              
client [26] (test)  loss: 0.3377 -> 0.2927   acc: 89.47% -> 89.47%             
client [49] (test)  loss: 0.4025 -> 0.4058   acc: 86.40% -> 86.87%             
client [98] (test)  loss: 0.5411 -> 0.5224   acc: 80.00% -> 82.78%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7430 -> 0.5201   acc: 75.00% -> 83.61%             
client [47] (test)  loss: 0.6762 -> 0.5085   acc: 76.03% -> 81.27%             
client [21] (test)  loss: 0.3932 -> 0.4322   acc: 86.39% -> 89.44%             
client [77] (test)  loss: 0.5125 -> 0.4525   acc: 83.93% -> 84.64%             
client [95] (test)  loss: 0.3641 -> 0.4034   acc: 87.61% -> 87.89%             
client [91] (test)  loss: 0.4943 -> 0.3901   acc: 82.63% -> 88.68%             
client [14] (test)  loss: 0.4823 -> 0.3935   acc: 85.64% -> 88.16%             
client [99] (test)  loss: 0.2962 -> 0.2797   acc: 90.68% -> 89.83%             
client [20] (test)  loss: 0.5322 -> 0.5555   acc: 82.17% -> 84.39%             
client [39] (test)  loss: 1.0621 -> 0.3586   acc: 66.21% -> 88.28%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5488 -> 0.4109   acc: 81.16% -> 84.76%             
client [62] (test)  loss: 0.3527 -> 0.3837   acc: 89.60% -> 85.63%             
client [71] (test)  loss: 0.3398 -> 0.3392   acc: 89.27% -> 90.40%             
client [97] (test)  loss: 0.5628 -> 0.5590   acc: 83.96% -> 82.46%             
client [30] (test)  loss: 0.3819 -> 0.2954   acc: 86.82% -> 91.89%             
client [88] (test)  loss: 0.6180 -> 0.4125   acc: 79.89% -> 85.12%             
client [60] (test)  loss: 0.3045 -> 0.2416   acc: 88.61% -> 94.31%             
client [82] (test)  loss: 0.3844 -> 0.2623   acc: 87.56% -> 92.29%             
client [91] (test)  loss: 0.4039 -> 0.3532   acc: 85.26% -> 89.74%             
client [57] (test)  loss: 0.3100 -> 0.3028   acc: 90.61% -> 90.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7394 -> 0.6071   acc: 72.37% -> 79.13%             
client [15] (test)  loss: 0.3292 -> 0.3798   acc: 88.64% -> 88.64%             
client [71] (test)  loss: 0.3930 -> 0.3351   acc: 86.16% -> 90.40%             
client [97] (test)  loss: 0.4838 -> 0.4583   acc: 84.70% -> 86.57%             
client [53] (test)  loss: 0.3866 -> 0.2176   acc: 88.60% -> 94.52%             
client [77] (test)  loss: 0.4616 -> 0.4550   acc: 84.64% -> 84.64%             
client [76] (test)  loss: 0.3207 -> 0.2433   acc: 88.44% -> 93.15%             
client [79] (test)  loss: 0.5146 -> 0.3887   acc: 82.87% -> 86.19%             
client [28] (test)  loss: 0.5098 -> 0.5302   acc: 85.25% -> 84.79%             
client [99] (test)  loss: 0.3255 -> 0.3000   acc: 88.98% -> 90.11%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.5177 -> 0.4924   acc: 82.84% -> 85.45%             
client [86] (test)  loss: 0.1637 -> 0.1789   acc: 93.72% -> 93.26%             
client [34] (test)  loss: 0.3745 -> 0.3863   acc: 88.32% -> 88.59%             
client [73] (test)  loss: 0.3478 -> 0.4499   acc: 88.06% -> 87.46%             
client [5] (test)  loss: 0.5064 -> 0.3758   acc: 81.99% -> 85.82%              
client [96] (test)  loss: 0.3182 -> 0.2819   acc: 90.58% -> 93.07%             
client [22] (test)  loss: 0.3424 -> 0.4325   acc: 88.71% -> 86.13%             
client [60] (test)  loss: 0.2879 -> 0.2378   acc: 91.09% -> 94.31%             
client [66] (test)  loss: 0.4944 -> 0.4954   acc: 84.07% -> 85.93%             
client [83] (test)  loss: 0.3878 -> 0.2306   acc: 87.63% -> 93.04%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.2646 -> 0.2472   acc: 91.65% -> 92.51%             
client [65] (test)  loss: 0.2652 -> 0.3475   acc: 91.29% -> 89.29%             
client [95] (test)  loss: 0.3411 -> 0.4199   acc: 86.76% -> 88.45%             
client [17] (test)  loss: 0.4498 -> 0.2986   acc: 87.43% -> 91.88%             
client [8] (test)  loss: 0.3436 -> 0.4327   acc: 88.71% -> 87.74%              
client [35] (test)  loss: 0.3365 -> 0.3387   acc: 89.18% -> 89.74%             
client [98] (test)  loss: 0.4825 -> 0.4982   acc: 83.89% -> 85.00%             
client [53] (test)  loss: 0.3379 -> 0.2081   acc: 89.47% -> 94.30%             
client [43] (test)  loss: 0.1668 -> 0.1226   acc: 93.01% -> 95.16%             
client [64] (test)  loss: 0.4825 -> 0.4273   acc: 85.55% -> 86.12%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.3238 -> 0.4319   acc: 89.44% -> 89.72%             
client [88] (test)  loss: 0.5198 -> 0.4364   acc: 82.37% -> 84.02%             
client [38] (test)  loss: 0.3265 -> 0.3518   acc: 89.62% -> 91.82%             
client [3] (test)  loss: 0.4688 -> 0.3652   acc: 82.37% -> 87.88%              
client [5] (test)  loss: 0.4378 -> 0.3820   acc: 84.67% -> 86.21%              
client [41] (test)  loss: 0.4081 -> 0.4301   acc: 86.72% -> 83.39%             
client [7] (test)  loss: 0.4039 -> 0.5053   acc: 86.67% -> 83.89%              
client [37] (test)  loss: 0.3273 -> 0.3321   acc: 90.50% -> 91.06%             
client [45] (test)  loss: 0.6608 -> 0.2907   acc: 77.49% -> 89.53%             
client [47] (test)  loss: 0.4874 -> 0.5649   acc: 84.64% -> 82.02%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.2424 -> 0.2513   acc: 92.67% -> 94.24%             
client [11] (test)  loss: 0.4761 -> 0.4623   acc: 85.51% -> 87.68%             
client [37] (test)  loss: 0.3032 -> 0.3394   acc: 90.50% -> 91.34%             
client [41] (test)  loss: 0.4000 -> 0.4807   acc: 86.72% -> 83.39%             
client [95] (test)  loss: 0.3337 -> 0.4317   acc: 88.73% -> 87.89%             
client [53] (test)  loss: 0.2913 -> 0.2135   acc: 91.23% -> 94.30%             
client [22] (test)  loss: 0.3635 -> 0.4449   acc: 88.06% -> 85.81%             
client [25] (test)  loss: 0.4460 -> 0.4340   acc: 84.17% -> 85.75%             
client [69] (test)  loss: 0.2438 -> 0.2547   acc: 92.99% -> 92.47%             
client [46] (test)  loss: 0.2810 -> 0.2723   acc: 90.96% -> 90.38%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.4047 -> 0.5794   acc: 88.01% -> 82.77%             
client [69] (test)  loss: 0.2406 -> 0.2513   acc: 93.51% -> 91.95%             
client [82] (test)  loss: 0.2666 -> 0.2579   acc: 91.29% -> 91.79%             
client [45] (test)  loss: 0.3841 -> 0.2992   acc: 84.82% -> 88.74%             
client [7] (test)  loss: 0.4067 -> 0.4934   acc: 87.78% -> 84.44%              
client [50] (test)  loss: 0.4127 -> 0.5261   acc: 86.27% -> 80.39%             
client [35] (test)  loss: 0.3055 -> 0.3498   acc: 89.55% -> 88.99%             
client [24] (test)  loss: 0.3190 -> 0.3832   acc: 88.41% -> 89.67%             
client [15] (test)  loss: 0.3112 -> 0.3960   acc: 90.03% -> 88.09%             
client [58] (test)  loss: 0.2016 -> 0.2445   acc: 92.41% -> 92.41%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.2608 -> 0.2269   acc: 91.60% -> 92.65%             
client [76] (test)  loss: 0.2673 -> 0.2529   acc: 92.29% -> 92.29%             
client [67] (test)  loss: 0.2664 -> 0.3453   acc: 93.20% -> 91.18%             
client [37] (test)  loss: 0.2977 -> 0.3392   acc: 90.78% -> 91.34%             
client [58] (test)  loss: 0.1983 -> 0.2491   acc: 92.67% -> 92.15%             
client [64] (test)  loss: 0.4372 -> 0.4494   acc: 85.27% -> 84.14%             
client [77] (test)  loss: 0.3921 -> 0.4600   acc: 86.79% -> 85.71%             
client [55] (test)  loss: 0.3389 -> 0.4194   acc: 88.45% -> 88.06%             
client [12] (test)  loss: 0.3818 -> 0.4732   acc: 86.36% -> 85.45%             
client [89] (test)  loss: 0.3203 -> 0.3340   acc: 88.75% -> 89.71%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.3096 -> 0.3564   acc: 90.14% -> 90.72%             
client [51] (test)  loss: 0.3048 -> 0.4069   acc: 88.59% -> 87.09%             
client [8] (test)  loss: 0.3059 -> 0.4616   acc: 90.00% -> 85.81%              
client [18] (test)  loss: 0.2553 -> 0.3009   acc: 92.71% -> 91.49%             
client [94] (test)  loss: 0.4659 -> 0.4378   acc: 82.02% -> 83.68%             
client [81] (test)  loss: 0.4827 -> 0.5872   acc: 82.63% -> 81.79%             
client [3] (test)  loss: 0.3911 -> 0.3682   acc: 86.78% -> 87.05%              
client [11] (test)  loss: 0.4664 -> 0.4699   acc: 86.23% -> 86.96%             
client [95] (test)  loss: 0.3272 -> 0.4467   acc: 89.01% -> 87.61%             
client [67] (test)  loss: 0.2711 -> 0.3461   acc: 93.20% -> 91.18%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.3310 -> 0.4389   acc: 88.89% -> 90.56%             
client [79] (test)  loss: 0.3297 -> 0.3878   acc: 89.23% -> 87.57%             
client [58] (test)  loss: 0.1939 -> 0.2497   acc: 92.67% -> 92.67%             
client [88] (test)  loss: 0.4803 -> 0.4475   acc: 83.47% -> 84.57%             
client [46] (test)  loss: 0.2478 -> 0.2667   acc: 90.96% -> 90.96%             
client [11] (test)  loss: 0.4626 -> 0.4568   acc: 86.96% -> 87.32%             
client [55] (test)  loss: 0.3351 -> 0.4403   acc: 88.26% -> 88.85%             
client [13] (test)  loss: 0.2277 -> 0.2897   acc: 91.86% -> 90.81%             
client [31] (test)  loss: 0.6023 -> 0.6242   acc: 78.13% -> 78.13%             
client [75] (test)  loss: 0.2427 -> 0.2787   acc: 89.57% -> 88.96%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.2009 -> 0.2236   acc: 91.38% -> 91.38%             
client [7] (test)  loss: 0.4226 -> 0.5020   acc: 87.22% -> 85.28%              
client [57] (test)  loss: 0.2714 -> 0.3038   acc: 91.70% -> 90.25%             
client [13] (test)  loss: 0.2256 -> 0.2915   acc: 92.13% -> 90.81%             
client [43] (test)  loss: 0.1235 -> 0.1223   acc: 95.16% -> 95.16%             
client [91] (test)  loss: 0.3211 -> 0.3426   acc: 88.42% -> 89.74%             
client [10] (test)  loss: 0.2048 -> 0.2849   acc: 93.33% -> 91.67%             
client [64] (test)  loss: 0.4139 -> 0.4720   acc: 86.97% -> 83.29%             
client [82] (test)  loss: 0.2470 -> 0.2490   acc: 91.79% -> 92.04%             
client [22] (test)  loss: 0.3822 -> 0.4751   acc: 87.74% -> 86.77%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.4781 -> 0.5519   acc: 85.03% -> 84.71%             
client [23] (test)  loss: 0.2810 -> 0.3442   acc: 92.36% -> 91.51%             
client [88] (test)  loss: 0.4722 -> 0.4497   acc: 84.02% -> 84.57%             
client [98] (test)  loss: 0.4166 -> 0.5404   acc: 86.39% -> 82.50%             
client [79] (test)  loss: 0.3244 -> 0.3945   acc: 89.50% -> 86.74%             
client [21] (test)  loss: 0.3302 -> 0.4396   acc: 88.89% -> 90.00%             
client [92] (test)  loss: 0.4696 -> 0.4837   acc: 85.18% -> 86.25%             
client [56] (test)  loss: 0.4136 -> 0.4823   acc: 89.38% -> 87.50%             
client [5] (test)  loss: 0.3966 -> 0.4005   acc: 86.59% -> 86.97%              
client [52] (test)  loss: 0.3891 -> 0.4282   acc: 87.81% -> 86.15%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.4349 -> 0.0000', 'accuracy': '85.50% -> 0.00%'},          
    200: {'loss': '0.3954 -> 0.0000', 'accuracy': '88.18% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(14.47%) at epoch: 0                                     
pFedSim achieved 30.0%(35.41%) at epoch: 1                                     
pFedSim achieved 60.0%(60.63%) at epoch: 2                                     
pFedSim achieved 70.0%(72.73%) at epoch: 4                                     
pFedSim achieved 80.0%(81.84%) at epoch: 13                                    
pFedSim achieved 90.0%(90.49%) at epoch: 152                                   
Convergence (test_after):                                                      
pFedSim achieved 70.0%(73.60%) at epoch: 0                                     
pFedSim achieved 80.0%(80.29%) at epoch: 3                                     
pFedSim achieved 90.0%(90.20%) at epoch: 74                                    
