==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.3912 -> 0.3736   acc: 85.59% -> 88.26%             
client [81] (test)  loss: 0.8790 -> 0.6781   acc: 79.19% -> 80.47%             
client [21] (test)  loss: 0.6270 -> 0.5849   acc: 80.21% -> 80.80%             
client [68] (test)  loss: 0.6152 -> 0.4484   acc: 80.89% -> 84.77%             
client [93] (test)  loss: 0.8596 -> 0.6289   acc: 75.67% -> 79.70%             
client [31] (test)  loss: 0.6447 -> 0.5451   acc: 79.46% -> 82.49%             
client [20] (test)  loss: 0.4821 -> 0.4858   acc: 84.76% -> 85.99%             
client [59] (test)  loss: 0.4095 -> 0.3523   acc: 87.24% -> 89.40%             
client [48] (test)  loss: 0.7744 -> 0.6747   acc: 78.24% -> 75.71%             
client [34] (test)  loss: 1.0328 -> 0.6055   acc: 70.78% -> 80.13%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3480 -> 0.2017   acc: 87.21% -> 93.47%             
client [99] (test)  loss: 0.7337 -> 0.5725   acc: 79.32% -> 81.93%             
client [67] (test)  loss: 0.4030 -> 0.2434   acc: 86.65% -> 93.45%             
client [0] (test)  loss: 0.7288 -> 0.5886   acc: 79.71% -> 81.82%              
client [76] (test)  loss: 0.7161 -> 0.4998   acc: 80.32% -> 83.92%             
client [41] (test)  loss: 0.9239 -> 0.5571   acc: 73.84% -> 79.41%             
client [62] (test)  loss: 0.7361 -> 0.4114   acc: 80.81% -> 86.88%             
client [2] (test)  loss: 0.7528 -> 0.5010   acc: 81.19% -> 84.48%              
client [14] (test)  loss: 0.6571 -> 0.5587   acc: 82.22% -> 82.25%             
client [46] (test)  loss: 1.2609 -> 0.5505   acc: 66.01% -> 85.55%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4738 -> 0.4609   acc: 83.09% -> 83.69%             
client [68] (test)  loss: 0.4744 -> 0.3912   acc: 83.76% -> 87.12%             
client [57] (test)  loss: 0.2732 -> 0.2368   acc: 90.39% -> 91.69%             
client [17] (test)  loss: 0.4408 -> 0.3563   acc: 85.61% -> 88.73%             
client [54] (test)  loss: 0.3623 -> 0.2982   acc: 87.67% -> 90.66%             
client [23] (test)  loss: 0.8141 -> 0.5980   acc: 78.04% -> 81.84%             
client [35] (test)  loss: 0.8049 -> 0.5828   acc: 77.51% -> 82.34%             
client [59] (test)  loss: 0.3287 -> 0.2607   acc: 89.38% -> 92.49%             
client [31] (test)  loss: 0.5100 -> 0.4971   acc: 82.86% -> 84.76%             
client [9] (test)  loss: 0.7973 -> 0.5361   acc: 77.14% -> 80.64%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7350 -> 0.4590   acc: 79.30% -> 86.14%             
client [33] (test)  loss: 0.8141 -> 0.5409   acc: 78.36% -> 84.10%             
client [16] (test)  loss: 1.0183 -> 0.5466   acc: 71.76% -> 82.63%             
client [44] (test)  loss: 0.8898 -> 0.6265   acc: 76.56% -> 77.06%             
client [8] (test)  loss: 0.4328 -> 0.3972   acc: 87.89% -> 88.11%              
client [31] (test)  loss: 0.5635 -> 0.4836   acc: 83.32% -> 85.32%             
client [47] (test)  loss: 0.3802 -> 0.2274   acc: 86.96% -> 92.11%             
client [36] (test)  loss: 0.3564 -> 0.1634   acc: 87.90% -> 94.85%             
client [20] (test)  loss: 0.4582 -> 0.4070   acc: 86.38% -> 88.07%             
client [56] (test)  loss: 0.4802 -> 0.3614   acc: 85.59% -> 87.31%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5973 -> 0.3866   acc: 82.32% -> 87.35%              
client [60] (test)  loss: 0.3840 -> 0.2877   acc: 88.61% -> 89.77%             
client [28] (test)  loss: 0.4008 -> 0.2763   acc: 87.42% -> 92.22%             
client [25] (test)  loss: 0.2848 -> 0.1979   acc: 92.31% -> 94.61%             
client [58] (test)  loss: 0.3879 -> 0.3033   acc: 88.92% -> 91.89%             
client [44] (test)  loss: 0.7972 -> 0.6509   acc: 75.81% -> 75.92%             
client [39] (test)  loss: 0.6541 -> 0.4620   acc: 79.02% -> 84.78%             
client [29] (test)  loss: 0.5802 -> 0.4966   acc: 82.85% -> 86.56%             
client [3] (test)  loss: 0.3598 -> 0.3303   acc: 87.99% -> 89.09%              
client [84] (test)  loss: 0.6959 -> 0.5896   acc: 80.21% -> 83.33%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7094 -> 0.4790   acc: 82.27% -> 84.18%             
client [84] (test)  loss: 1.0843 -> 0.6056   acc: 74.66% -> 83.78%             
client [10] (test)  loss: 0.9426 -> 0.4391   acc: 74.03% -> 86.96%             
client [36] (test)  loss: 0.2855 -> 0.1684   acc: 90.10% -> 95.00%             
client [65] (test)  loss: 0.2626 -> 0.2554   acc: 92.67% -> 93.25%             
client [81] (test)  loss: 0.9948 -> 0.5065   acc: 80.82% -> 85.65%             
client [79] (test)  loss: 0.1959 -> 0.2025   acc: 94.21% -> 94.25%             
client [42] (test)  loss: 0.8131 -> 0.4080   acc: 77.50% -> 88.25%             
client [11] (test)  loss: 0.4662 -> 0.3408   acc: 88.67% -> 89.93%             
client [96] (test)  loss: 0.2992 -> 0.2988   acc: 90.59% -> 90.85%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3971 -> 0.3899   acc: 88.59% -> 89.44%              
client [53] (test)  loss: 0.2784 -> 0.2157   acc: 92.38% -> 94.46%             
client [52] (test)  loss: 0.9387 -> 0.5066   acc: 73.43% -> 85.56%             
client [42] (test)  loss: 0.5642 -> 0.3942   acc: 80.93% -> 88.96%             
client [69] (test)  loss: 0.2636 -> 0.1944   acc: 91.74% -> 94.37%             
client [59] (test)  loss: 0.2945 -> 0.2491   acc: 91.76% -> 92.86%             
client [7] (test)  loss: 0.5795 -> 0.5089   acc: 79.23% -> 82.45%              
client [26] (test)  loss: 0.2889 -> 0.2308   acc: 92.07% -> 93.10%             
client [49] (test)  loss: 0.4467 -> 0.4134   acc: 87.00% -> 88.00%             
client [98] (test)  loss: 0.4604 -> 0.4490   acc: 85.73% -> 86.75%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5796 -> 0.4510   acc: 82.73% -> 86.73%             
client [47] (test)  loss: 0.3046 -> 0.2082   acc: 89.36% -> 93.14%             
client [21] (test)  loss: 0.5851 -> 0.4915   acc: 83.15% -> 84.65%             
client [77] (test)  loss: 0.2646 -> 0.2374   acc: 91.21% -> 91.82%             
client [95] (test)  loss: 0.3978 -> 0.3638   acc: 88.85% -> 89.66%             
client [91] (test)  loss: 1.4307 -> 0.5963   acc: 68.82% -> 82.65%             
client [14] (test)  loss: 0.6241 -> 0.5256   acc: 83.09% -> 84.52%             
client [99] (test)  loss: 0.7678 -> 0.5375   acc: 80.29% -> 83.79%             
client [20] (test)  loss: 0.4337 -> 0.3987   acc: 86.65% -> 89.32%             
client [39] (test)  loss: 0.8484 -> 0.4686   acc: 78.00% -> 85.75%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9420 -> 0.5055   acc: 74.32% -> 85.61%             
client [62] (test)  loss: 0.7519 -> 0.4472   acc: 82.30% -> 87.78%             
client [71] (test)  loss: 0.7775 -> 0.5811   acc: 80.93% -> 82.37%             
client [97] (test)  loss: 0.2619 -> 0.2224   acc: 92.31% -> 94.03%             
client [30] (test)  loss: 0.3337 -> 0.2775   acc: 89.54% -> 92.85%             
client [88] (test)  loss: 0.3672 -> 0.3356   acc: 89.21% -> 89.35%             
client [60] (test)  loss: 0.3399 -> 0.3027   acc: 90.13% -> 90.06%             
client [82] (test)  loss: 0.4207 -> 0.3630   acc: 86.23% -> 88.22%             
client [91] (test)  loss: 1.2344 -> 0.6212   acc: 69.63% -> 82.89%             
client [57] (test)  loss: 0.2788 -> 0.2129   acc: 90.87% -> 92.75%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5149 -> 0.5142   acc: 83.03% -> 86.32%             
client [15] (test)  loss: 0.4813 -> 0.4457   acc: 83.24% -> 83.87%             
client [71] (test)  loss: 0.7292 -> 0.6020   acc: 78.16% -> 81.91%             
client [97] (test)  loss: 0.3244 -> 0.2194   acc: 89.06% -> 94.29%             
client [53] (test)  loss: 0.4513 -> 0.2144   acc: 83.49% -> 94.76%             
client [77] (test)  loss: 0.3554 -> 0.2346   acc: 87.21% -> 92.19%             
client [76] (test)  loss: 0.6056 -> 0.4668   acc: 79.96% -> 86.35%             
client [79] (test)  loss: 0.3611 -> 0.2050   acc: 87.58% -> 94.67%             
client [28] (test)  loss: 0.4855 -> 0.2854   acc: 84.61% -> 92.75%             
client [99] (test)  loss: 0.6516 -> 0.5526   acc: 79.73% -> 83.57%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.1976 -> 0.2290   acc: 94.43% -> 93.91%             
client [86] (test)  loss: 0.2300 -> 0.2448   acc: 93.97% -> 94.12%             
client [34] (test)  loss: 0.5355 -> 0.5120   acc: 83.50% -> 85.86%             
client [73] (test)  loss: 0.6748 -> 0.5738   acc: 81.84% -> 85.21%             
client [5] (test)  loss: 0.5526 -> 0.4890   acc: 86.22% -> 87.88%              
client [96] (test)  loss: 0.3321 -> 0.3042   acc: 89.84% -> 90.99%             
client [22] (test)  loss: 0.6040 -> 0.5110   acc: 82.53% -> 86.21%             
client [60] (test)  loss: 0.2888 -> 0.3221   acc: 91.68% -> 91.04%             
client [66] (test)  loss: 0.3476 -> 0.3370   acc: 90.06% -> 90.25%             
client [83] (test)  loss: 0.4917 -> 0.3936   acc: 87.48% -> 87.61%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.4253 -> 0.4878   acc: 88.28% -> 86.72%             
client [65] (test)  loss: 0.2314 -> 0.2539   acc: 94.32% -> 93.45%             
client [95] (test)  loss: 0.3553 -> 0.3909   acc: 90.69% -> 90.05%             
client [17] (test)  loss: 0.3648 -> 0.3220   acc: 91.22% -> 90.90%             
client [8] (test)  loss: 0.4250 -> 0.3993   acc: 89.05% -> 89.34%              
client [35] (test)  loss: 0.6488 -> 0.6612   acc: 81.61% -> 83.48%             
client [98] (test)  loss: 0.4593 -> 0.4917   acc: 87.34% -> 86.35%             
client [53] (test)  loss: 0.2095 -> 0.2238   acc: 94.51% -> 95.10%             
client [43] (test)  loss: 0.4854 -> 0.3906   acc: 88.21% -> 89.30%             
client [64] (test)  loss: 0.5506 -> 0.5176   acc: 84.73% -> 86.04%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.4880 -> 0.5396   acc: 85.43% -> 84.82%             
client [88] (test)  loss: 0.3134 -> 0.4094   acc: 90.96% -> 89.19%             
client [38] (test)  loss: 0.4884 -> 0.5309   acc: 86.72% -> 84.60%             
client [3] (test)  loss: 0.3159 -> 0.3707   acc: 89.97% -> 89.63%              
client [5] (test)  loss: 0.5071 -> 0.4947   acc: 87.13% -> 88.04%              
client [41] (test)  loss: 0.5968 -> 0.6103   acc: 80.52% -> 81.35%             
client [7] (test)  loss: 0.4926 -> 0.5272   acc: 83.26% -> 83.73%              
client [37] (test)  loss: 0.7907 -> 0.7659   acc: 77.36% -> 78.25%             
client [45] (test)  loss: 0.5417 -> 0.4243   acc: 84.81% -> 87.43%             
client [47] (test)  loss: 0.3796 -> 0.2241   acc: 88.01% -> 92.82%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.7355 -> 0.6826   acc: 80.31% -> 83.20%             
client [11] (test)  loss: 0.3456 -> 0.4118   acc: 90.78% -> 89.88%             
client [37] (test)  loss: 0.6952 -> 0.7886   acc: 79.14% -> 78.31%             
client [41] (test)  loss: 0.5934 -> 0.6371   acc: 80.81% -> 80.69%             
client [95] (test)  loss: 0.3344 -> 0.3801   acc: 91.40% -> 90.10%             
client [53] (test)  loss: 0.2143 -> 0.2296   acc: 94.44% -> 94.85%             
client [22] (test)  loss: 0.5160 -> 0.5326   acc: 85.47% -> 86.18%             
client [25] (test)  loss: 0.1899 -> 0.2057   acc: 95.62% -> 95.45%             
client [69] (test)  loss: 0.1998 -> 0.2205   acc: 93.89% -> 94.47%             
client [46] (test)  loss: 0.5083 -> 0.5353   acc: 86.58% -> 87.79%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2224 -> 0.2400   acc: 92.99% -> 92.97%             
client [69] (test)  loss: 0.1949 -> 0.2268   acc: 94.06% -> 94.18%             
client [82] (test)  loss: 0.3480 -> 0.3909   acc: 89.00% -> 88.17%             
client [45] (test)  loss: 0.3847 -> 0.4762   acc: 88.76% -> 87.29%             
client [7] (test)  loss: 0.4889 -> 0.5386   acc: 83.36% -> 83.24%              
client [50] (test)  loss: 0.3258 -> 0.3697   acc: 91.83% -> 90.96%             
client [35] (test)  loss: 0.6804 -> 0.6973   acc: 82.53% -> 83.37%             
client [24] (test)  loss: 0.4431 -> 0.4936   acc: 85.98% -> 84.52%             
client [15] (test)  loss: 0.4506 -> 0.4867   acc: 85.53% -> 83.14%             
client [58] (test)  loss: 0.2803 -> 0.3385   acc: 92.72% -> 92.35%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.5403 -> 0.6564   acc: 84.16% -> 83.15%             
client [76] (test)  loss: 0.4319 -> 0.5048   acc: 88.03% -> 86.16%             
client [67] (test)  loss: 0.2348 -> 0.2758   acc: 95.13% -> 94.23%             
client [37] (test)  loss: 0.7149 -> 0.8114   acc: 79.34% -> 78.48%             
client [58] (test)  loss: 0.2835 -> 0.3462   acc: 92.60% -> 92.38%             
client [64] (test)  loss: 0.4543 -> 0.5415   acc: 87.51% -> 85.87%             
client [77] (test)  loss: 0.2309 -> 0.2772   acc: 92.63% -> 91.87%             
client [55] (test)  loss: 0.3205 -> 0.4029   acc: 89.83% -> 89.36%             
client [12] (test)  loss: 0.4702 -> 0.5583   acc: 87.33% -> 85.74%             
client [89] (test)  loss: 0.3785 -> 0.4684   acc: 89.54% -> 89.20%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.5568 -> 0.7192   acc: 85.26% -> 83.68%             
client [51] (test)  loss: 0.6226 -> 0.7694   acc: 81.63% -> 78.96%             
client [8] (test)  loss: 0.3666 -> 0.4161   acc: 90.52% -> 89.85%              
client [18] (test)  loss: 0.4669 -> 0.5512   acc: 88.00% -> 86.32%             
client [94] (test)  loss: 0.2071 -> 0.2580   acc: 93.81% -> 93.95%             
client [81] (test)  loss: 0.5436 -> 0.5460   acc: 86.93% -> 86.90%             
client [3] (test)  loss: 0.3204 -> 0.3943   acc: 89.78% -> 89.58%              
client [11] (test)  loss: 0.3540 -> 0.4256   acc: 90.53% -> 89.37%             
client [95] (test)  loss: 0.3493 -> 0.3944   acc: 91.06% -> 89.73%             
client [67] (test)  loss: 0.2351 -> 0.2738   acc: 95.23% -> 94.35%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.4957 -> 0.5576   acc: 85.90% -> 84.58%             
client [79] (test)  loss: 0.1901 -> 0.2295   acc: 95.04% -> 94.67%             
client [58] (test)  loss: 0.2907 -> 0.3438   acc: 92.35% -> 92.26%             
client [88] (test)  loss: 0.3300 -> 0.4094   acc: 91.04% -> 89.07%             
client [46] (test)  loss: 0.4788 -> 0.5686   acc: 88.45% -> 87.21%             
client [11] (test)  loss: 0.3615 -> 0.4295   acc: 90.20% -> 89.57%             
client [55] (test)  loss: 0.3300 -> 0.4281   acc: 90.03% -> 89.31%             
client [13] (test)  loss: 0.4049 -> 0.4719   acc: 89.23% -> 88.07%             
client [31] (test)  loss: 0.4885 -> 0.5984   acc: 87.08% -> 85.74%             
client [75] (test)  loss: 0.3842 -> 0.4670   acc: 89.64% -> 88.94%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.4291 -> 0.5221   acc: 89.15% -> 88.20%             
client [7] (test)  loss: 0.4792 -> 0.5761   acc: 84.32% -> 82.82%              
client [57] (test)  loss: 0.2167 -> 0.2439   acc: 93.21% -> 92.73%             
client [13] (test)  loss: 0.4031 -> 0.4847   acc: 89.48% -> 88.44%             
client [43] (test)  loss: 0.3646 -> 0.4430   acc: 90.56% -> 89.28%             
client [91] (test)  loss: 0.6340 -> 0.7004   acc: 83.44% -> 82.42%             
client [10] (test)  loss: 0.4545 -> 0.5567   acc: 88.53% -> 87.52%             
client [64] (test)  loss: 0.4676 -> 0.5740   acc: 87.43% -> 85.77%             
client [82] (test)  loss: 0.3732 -> 0.4160   acc: 88.66% -> 88.29%             
client [22] (test)  loss: 0.4962 -> 0.5664   acc: 87.04% -> 86.04%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.3737 -> 0.4348   acc: 90.27% -> 89.12%             
client [23] (test)  loss: 0.6348 -> 0.7183   acc: 83.84% -> 82.69%             
client [88] (test)  loss: 0.3381 -> 0.4117   acc: 90.96% -> 89.23%             
client [98] (test)  loss: 0.4582 -> 0.5356   acc: 87.53% -> 85.97%             
client [79] (test)  loss: 0.1973 -> 0.2339   acc: 94.97% -> 94.28%             
client [21] (test)  loss: 0.4994 -> 0.5770   acc: 86.02% -> 84.58%             
client [92] (test)  loss: 0.4768 -> 0.5532   acc: 87.40% -> 85.57%             
client [56] (test)  loss: 0.3799 -> 0.4498   acc: 88.28% -> 87.67%             
client [5] (test)  loss: 0.4821 -> 0.5352   acc: 87.94% -> 87.80%              
client [52] (test)  loss: 0.5379 -> 0.6372   acc: 85.87% -> 85.07%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.5255 -> 0.0000', 'accuracy': '83.29% -> 0.00%'},          
    200: {'loss': '0.4787 -> 0.0000', 'accuracy': '87.75% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 50.0%(50.00%) at epoch: 1                                     
pFedSim achieved 70.0%(72.22%) at epoch: 2                                     
pFedSim achieved 80.0%(80.66%) at epoch: 8                                     
pFedSim achieved 90.0%(90.51%) at epoch: 132                                   
Convergence (test_after):                                                      
pFedSim achieved 70.0%(70.39%) at epoch: 0                                     
pFedSim achieved 80.0%(81.47%) at epoch: 2                                     
pFedSim achieved 90.0%(91.17%) at epoch: 71                                    
