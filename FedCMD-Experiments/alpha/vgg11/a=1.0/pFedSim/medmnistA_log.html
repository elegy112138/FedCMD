==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6484 -> 0.9220   acc: 42.82% -> 67.36%             
client [81] (test)  loss: 1.7496 -> 1.0063   acc: 32.74% -> 65.93%             
client [21] (test)  loss: 1.0002 -> 0.7209   acc: 65.11% -> 76.64%             
client [68] (test)  loss: 0.9459 -> 0.6707   acc: 69.78% -> 79.14%             
client [93] (test)  loss: 0.3918 -> 0.2827   acc: 88.37% -> 90.99%             
client [31] (test)  loss: 1.5647 -> 1.1638   acc: 41.41% -> 59.03%             
client [20] (test)  loss: 0.5177 -> 0.4458   acc: 84.31% -> 85.29%             
client [59] (test)  loss: 1.2337 -> 0.6837   acc: 51.66% -> 77.15%             
client [48] (test)  loss: 0.9423 -> 0.7322   acc: 66.89% -> 68.92%             
client [34] (test)  loss: 0.7162 -> 0.6041   acc: 79.84% -> 79.03%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5127 -> 0.3607   acc: 81.61% -> 84.95%             
client [99] (test)  loss: 0.7494 -> 0.5689   acc: 75.17% -> 84.48%             
client [67] (test)  loss: 0.7406 -> 0.3897   acc: 69.50% -> 86.87%             
client [0] (test)  loss: 0.3521 -> 0.2697   acc: 87.87% -> 90.49%              
client [76] (test)  loss: 0.7539 -> 0.4685   acc: 70.03% -> 83.11%             
client [41] (test)  loss: 0.6692 -> 0.4753   acc: 76.40% -> 84.40%             
client [62] (test)  loss: 0.4518 -> 0.2905   acc: 84.00% -> 90.00%             
client [2] (test)  loss: 0.5575 -> 0.4444   acc: 78.44% -> 82.04%              
client [14] (test)  loss: 0.3888 -> 0.2322   acc: 85.45% -> 92.12%             
client [46] (test)  loss: 0.3303 -> 0.3531   acc: 87.61% -> 88.46%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5102 -> 0.7031   acc: 80.96% -> 76.65%             
client [68] (test)  loss: 0.3441 -> 0.3356   acc: 89.57% -> 90.29%             
client [57] (test)  loss: 0.3813 -> 0.3404   acc: 85.20% -> 88.78%             
client [17] (test)  loss: 0.4809 -> 0.4389   acc: 80.82% -> 85.62%             
client [54] (test)  loss: 0.2617 -> 0.2273   acc: 93.54% -> 92.78%             
client [23] (test)  loss: 0.2945 -> 0.2354   acc: 89.72% -> 91.94%             
client [35] (test)  loss: 0.4290 -> 0.2073   acc: 84.03% -> 93.06%             
client [59] (test)  loss: 0.2931 -> 0.2210   acc: 89.07% -> 93.71%             
client [31] (test)  loss: 0.4613 -> 0.4940   acc: 86.34% -> 84.58%             
client [9] (test)  loss: 0.3773 -> 0.4344   acc: 86.73% -> 85.25%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2918 -> 0.3026   acc: 90.51% -> 91.77%             
client [33] (test)  loss: 0.3021 -> 0.1595   acc: 88.96% -> 95.13%             
client [16] (test)  loss: 0.2340 -> 0.1372   acc: 92.19% -> 94.42%             
client [44] (test)  loss: 0.2442 -> 0.2432   acc: 92.63% -> 92.63%             
client [8] (test)  loss: 0.2112 -> 0.1617   acc: 93.77% -> 94.75%              
client [31] (test)  loss: 0.3157 -> 0.3079   acc: 91.63% -> 90.75%             
client [47] (test)  loss: 0.3117 -> 0.1565   acc: 90.06% -> 94.88%             
client [36] (test)  loss: 0.4184 -> 0.2689   acc: 84.21% -> 90.79%             
client [20] (test)  loss: 0.1145 -> 0.0821   acc: 95.75% -> 97.71%             
client [56] (test)  loss: 0.2051 -> 0.1612   acc: 93.56% -> 94.48%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1839 -> 0.0957   acc: 93.81% -> 97.39%              
client [60] (test)  loss: 0.0976 -> 0.0866   acc: 97.53% -> 97.84%             
client [28] (test)  loss: 0.4130 -> 0.3318   acc: 84.92% -> 90.08%             
client [25] (test)  loss: 0.5592 -> 0.2225   acc: 81.15% -> 92.65%             
client [58] (test)  loss: 0.1996 -> 0.1420   acc: 94.46% -> 94.46%             
client [44] (test)  loss: 0.4465 -> 0.2199   acc: 84.42% -> 93.48%             
client [39] (test)  loss: 0.3027 -> 0.1194   acc: 90.41% -> 96.51%             
client [29] (test)  loss: 0.4028 -> 0.1949   acc: 84.55% -> 95.28%             
client [3] (test)  loss: 0.2370 -> 0.1038   acc: 91.18% -> 96.08%              
client [84] (test)  loss: 0.7418 -> 0.2447   acc: 71.89% -> 91.46%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2206 -> 0.1832   acc: 94.39% -> 95.02%             
client [84] (test)  loss: 0.2578 -> 0.2070   acc: 91.46% -> 92.17%             
client [10] (test)  loss: 0.1499 -> 0.1651   acc: 94.53% -> 94.92%             
client [36] (test)  loss: 0.3016 -> 0.2197   acc: 88.82% -> 92.11%             
client [65] (test)  loss: 0.1479 -> 0.1658   acc: 95.51% -> 95.19%             
client [81] (test)  loss: 0.1664 -> 0.2062   acc: 93.36% -> 92.92%             
client [79] (test)  loss: 0.2286 -> 0.2190   acc: 93.64% -> 92.27%             
client [42] (test)  loss: 0.2405 -> 0.2442   acc: 91.29% -> 91.89%             
client [11] (test)  loss: 0.3780 -> 0.2665   acc: 88.24% -> 92.02%             
client [96] (test)  loss: 0.3052 -> 0.2223   acc: 90.43% -> 93.26%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1245 -> 0.1092   acc: 97.05% -> 96.39%              
client [53] (test)  loss: 0.3223 -> 0.3115   acc: 85.88% -> 86.67%             
client [52] (test)  loss: 0.1637 -> 0.1712   acc: 94.25% -> 96.81%             
client [42] (test)  loss: 0.2419 -> 0.2109   acc: 91.29% -> 92.79%             
client [69] (test)  loss: 0.1404 -> 0.0928   acc: 95.32% -> 97.66%             
client [59] (test)  loss: 0.0971 -> 0.0898   acc: 96.69% -> 97.35%             
client [7] (test)  loss: 0.0599 -> 0.0625   acc: 97.69% -> 97.98%              
client [26] (test)  loss: 0.1000 -> 0.0847   acc: 96.94% -> 97.45%             
client [49] (test)  loss: 0.1082 -> 0.0838   acc: 97.08% -> 97.40%             
client [98] (test)  loss: 0.3428 -> 0.2662   acc: 87.43% -> 93.19%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2996 -> 0.2437   acc: 91.62% -> 93.72%             
client [47] (test)  loss: 0.1902 -> 0.0966   acc: 94.28% -> 97.29%             
client [21] (test)  loss: 0.1878 -> 0.1481   acc: 95.33% -> 95.95%             
client [77] (test)  loss: 0.2613 -> 0.2550   acc: 92.43% -> 93.99%             
client [95] (test)  loss: 0.1822 -> 0.1727   acc: 93.57% -> 94.78%             
client [91] (test)  loss: 0.1697 -> 0.1273   acc: 94.12% -> 96.26%             
client [14] (test)  loss: 0.1099 -> 0.0583   acc: 96.06% -> 98.79%             
client [99] (test)  loss: 0.2033 -> 0.2320   acc: 93.10% -> 92.07%             
client [20] (test)  loss: 0.0395 -> 0.0384   acc: 99.02% -> 98.69%             
client [39] (test)  loss: 0.2053 -> 0.0846   acc: 93.90% -> 97.97%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1566 -> 0.1614   acc: 94.25% -> 97.12%             
client [62] (test)  loss: 0.0695 -> 0.0615   acc: 96.86% -> 97.43%             
client [71] (test)  loss: 0.2214 -> 0.0783   acc: 92.00% -> 96.80%             
client [97] (test)  loss: 0.1431 -> 0.0694   acc: 95.69% -> 98.11%             
client [30] (test)  loss: 0.0286 -> 0.0339   acc: 99.37% -> 99.37%             
client [88] (test)  loss: 0.1299 -> 0.0435   acc: 94.23% -> 98.40%             
client [60] (test)  loss: 0.0970 -> 0.0874   acc: 97.84% -> 98.77%             
client [82] (test)  loss: 0.1844 -> 0.1741   acc: 93.20% -> 95.15%             
client [91] (test)  loss: 0.1176 -> 0.1281   acc: 96.79% -> 95.72%             
client [57] (test)  loss: 0.0580 -> 0.0897   acc: 97.96% -> 96.43%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1099 -> 0.0954   acc: 95.59% -> 97.80%             
client [15] (test)  loss: 0.0238 -> 0.0219   acc: 99.38% -> 99.06%             
client [71] (test)  loss: 0.1695 -> 0.0760   acc: 94.40% -> 96.80%             
client [97] (test)  loss: 0.1037 -> 0.0581   acc: 95.96% -> 98.38%             
client [53] (test)  loss: 0.2192 -> 0.2351   acc: 90.20% -> 92.16%             
client [77] (test)  loss: 0.3150 -> 0.2417   acc: 91.38% -> 93.99%             
client [76] (test)  loss: 0.1541 -> 0.0829   acc: 94.82% -> 96.19%             
client [79] (test)  loss: 0.1915 -> 0.1757   acc: 95.00% -> 91.82%             
client [28] (test)  loss: 0.1524 -> 0.1498   acc: 95.63% -> 94.05%             
client [99] (test)  loss: 0.1883 -> 0.1778   acc: 93.79% -> 94.83%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.0890 -> 0.0621   acc: 96.77% -> 97.57%             
client [86] (test)  loss: 0.0596 -> 0.0377   acc: 96.92% -> 97.95%             
client [34] (test)  loss: 0.0796 -> 0.0569   acc: 98.12% -> 98.92%             
client [73] (test)  loss: 0.0667 -> 0.0373   acc: 97.57% -> 98.79%             
client [5] (test)  loss: 0.1446 -> 0.1063   acc: 95.33% -> 96.98%              
client [96] (test)  loss: 0.2187 -> 0.1462   acc: 93.97% -> 96.10%             
client [22] (test)  loss: 0.1103 -> 0.1233   acc: 96.11% -> 97.22%             
client [60] (test)  loss: 0.0889 -> 0.0849   acc: 98.77% -> 98.77%             
client [66] (test)  loss: 0.1116 -> 0.1229   acc: 96.38% -> 96.74%             
client [83] (test)  loss: 0.1835 -> 0.1666   acc: 92.36% -> 94.09%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.0929 -> 0.0800   acc: 96.19% -> 96.46%             
client [65] (test)  loss: 0.0897 -> 0.1050   acc: 97.12% -> 96.47%             
client [95] (test)  loss: 0.1712 -> 0.1559   acc: 93.98% -> 94.78%             
client [17] (test)  loss: 0.1479 -> 0.1964   acc: 95.21% -> 93.84%             
client [8] (test)  loss: 0.1007 -> 0.0939   acc: 97.70% -> 97.70%              
client [35] (test)  loss: 0.0801 -> 0.0496   acc: 96.76% -> 98.38%             
client [98] (test)  loss: 0.2596 -> 0.2335   acc: 92.15% -> 93.72%             
client [53] (test)  loss: 0.1801 -> 0.2315   acc: 92.55% -> 92.94%             
client [43] (test)  loss: 0.1598 -> 0.1011   acc: 95.82% -> 96.81%             
client [64] (test)  loss: 0.2120 -> 0.1798   acc: 93.04% -> 94.30%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.1500 -> 0.1134   acc: 95.33% -> 95.64%             
client [88] (test)  loss: 0.0478 -> 0.0248   acc: 97.76% -> 98.72%             
client [38] (test)  loss: 0.1031 -> 0.1049   acc: 96.44% -> 97.33%             
client [3] (test)  loss: 0.1135 -> 0.0724   acc: 96.73% -> 97.39%              
client [5] (test)  loss: 0.1349 -> 0.1031   acc: 96.43% -> 96.98%              
client [41] (test)  loss: 0.1418 -> 0.1941   acc: 95.20% -> 94.80%             
client [7] (test)  loss: 0.0221 -> 0.0267   acc: 99.14% -> 99.14%              
client [37] (test)  loss: 0.1033 -> 0.1271   acc: 96.67% -> 96.00%             
client [45] (test)  loss: 0.2032 -> 0.2689   acc: 93.06% -> 92.43%             
client [47] (test)  loss: 0.1193 -> 0.0844   acc: 96.39% -> 97.59%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.0855 -> 0.0767   acc: 96.65% -> 97.03%             
client [11] (test)  loss: 0.2034 -> 0.2064   acc: 94.54% -> 94.96%             
client [37] (test)  loss: 0.0907 -> 0.1247   acc: 97.00% -> 96.67%             
client [41] (test)  loss: 0.1399 -> 0.1990   acc: 95.20% -> 94.80%             
client [95] (test)  loss: 0.1398 -> 0.1575   acc: 94.38% -> 95.18%             
client [53] (test)  loss: 0.1865 -> 0.2241   acc: 92.55% -> 92.94%             
client [22] (test)  loss: 0.1134 -> 0.1368   acc: 96.11% -> 95.56%             
client [25] (test)  loss: 0.1347 -> 0.1467   acc: 95.53% -> 97.12%             
client [69] (test)  loss: 0.0577 -> 0.0599   acc: 97.66% -> 97.66%             
client [46] (test)  loss: 0.0422 -> 0.0660   acc: 98.72% -> 97.86%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.0833 -> 0.0757   acc: 97.29% -> 97.59%             
client [69] (test)  loss: 0.0536 -> 0.0601   acc: 97.66% -> 97.66%             
client [82] (test)  loss: 0.1674 -> 0.1467   acc: 94.17% -> 95.79%             
client [45] (test)  loss: 0.1695 -> 0.2476   acc: 94.95% -> 92.74%             
client [7] (test)  loss: 0.0186 -> 0.0220   acc: 99.14% -> 99.42%              
client [50] (test)  loss: 0.0743 -> 0.0693   acc: 97.81% -> 98.54%             
client [35] (test)  loss: 0.0514 -> 0.0412   acc: 98.15% -> 98.61%             
client [24] (test)  loss: 0.1899 -> 0.1738   acc: 91.88% -> 93.15%             
client [15] (test)  loss: 0.0182 -> 0.0235   acc: 99.38% -> 98.44%             
client [58] (test)  loss: 0.0388 -> 0.0579   acc: 98.74% -> 97.98%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.1102 -> 0.1149   acc: 95.61% -> 96.28%             
client [76] (test)  loss: 0.0685 -> 0.0763   acc: 97.55% -> 96.46%             
client [67] (test)  loss: 0.0886 -> 0.0707   acc: 98.07% -> 97.30%             
client [37] (test)  loss: 0.0883 -> 0.1192   acc: 97.00% -> 97.00%             
client [58] (test)  loss: 0.0371 -> 0.0558   acc: 98.74% -> 98.24%             
client [64] (test)  loss: 0.1677 -> 0.1699   acc: 94.94% -> 94.30%             
client [77] (test)  loss: 0.1819 -> 0.2357   acc: 95.30% -> 94.78%             
client [55] (test)  loss: 0.0344 -> 0.1107   acc: 98.80% -> 97.59%             
client [12] (test)  loss: 0.0484 -> 0.0690   acc: 98.03% -> 98.03%             
client [89] (test)  loss: 0.0498 -> 0.0486   acc: 98.56% -> 98.56%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.1256 -> 0.1723   acc: 95.73% -> 96.09%             
client [51] (test)  loss: 0.1908 -> 0.1990   acc: 93.16% -> 94.44%             
client [8] (test)  loss: 0.0915 -> 0.0982   acc: 98.03% -> 97.38%              
client [18] (test)  loss: 0.0397 -> 0.0461   acc: 99.01% -> 98.68%             
client [94] (test)  loss: 0.0279 -> 0.0436   acc: 99.22% -> 97.66%             
client [81] (test)  loss: 0.0766 -> 0.0986   acc: 98.23% -> 97.79%             
client [3] (test)  loss: 0.0635 -> 0.0653   acc: 97.06% -> 98.04%              
client [11] (test)  loss: 0.2019 -> 0.2042   acc: 94.54% -> 94.96%             
client [95] (test)  loss: 0.1456 -> 0.1685   acc: 94.78% -> 95.18%             
client [67] (test)  loss: 0.0829 -> 0.0720   acc: 98.07% -> 97.68%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.1508 -> 0.1014   acc: 95.33% -> 95.95%             
client [79] (test)  loss: 0.1673 -> 0.1700   acc: 95.45% -> 94.55%             
client [58] (test)  loss: 0.0348 -> 0.0527   acc: 98.74% -> 98.74%             
client [88] (test)  loss: 0.0246 -> 0.0260   acc: 98.72% -> 98.72%             
client [46] (test)  loss: 0.0520 -> 0.0752   acc: 98.29% -> 97.86%             
client [11] (test)  loss: 0.2035 -> 0.2039   acc: 94.54% -> 94.54%             
client [55] (test)  loss: 0.0370 -> 0.1078   acc: 98.80% -> 97.59%             
client [13] (test)  loss: 0.0847 -> 0.0804   acc: 98.03% -> 98.03%             
client [31] (test)  loss: 0.0696 -> 0.0757   acc: 96.48% -> 97.36%             
client [75] (test)  loss: 0.0628 -> 0.1185   acc: 98.41% -> 96.30%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.0569 -> 0.0466   acc: 99.08% -> 98.77%             
client [7] (test)  loss: 0.0098 -> 0.0182   acc: 99.71% -> 99.42%              
client [57] (test)  loss: 0.0487 -> 0.0937   acc: 97.45% -> 96.43%             
client [13] (test)  loss: 0.0844 -> 0.0804   acc: 98.03% -> 98.03%             
client [43] (test)  loss: 0.0946 -> 0.0792   acc: 97.05% -> 97.79%             
client [91] (test)  loss: 0.1033 -> 0.0950   acc: 96.26% -> 97.33%             
client [10] (test)  loss: 0.0876 -> 0.1031   acc: 96.88% -> 97.66%             
client [64] (test)  loss: 0.1717 -> 0.1668   acc: 94.30% -> 94.94%             
client [82] (test)  loss: 0.1388 -> 0.1527   acc: 95.79% -> 95.79%             
client [22] (test)  loss: 0.1049 -> 0.1266   acc: 96.67% -> 96.67%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.0228 -> 0.0261   acc: 99.67% -> 99.67%             
client [23] (test)  loss: 0.1306 -> 0.1336   acc: 96.67% -> 96.39%             
client [88] (test)  loss: 0.0224 -> 0.0252   acc: 98.72% -> 98.72%             
client [98] (test)  loss: 0.2110 -> 0.2174   acc: 94.24% -> 93.19%             
client [79] (test)  loss: 0.1675 -> 0.1691   acc: 95.00% -> 94.55%             
client [21] (test)  loss: 0.1467 -> 0.1037   acc: 95.64% -> 96.26%             
client [92] (test)  loss: 0.1806 -> 0.2573   acc: 92.42% -> 92.05%             
client [56] (test)  loss: 0.0409 -> 0.0529   acc: 98.47% -> 98.47%             
client [5] (test)  loss: 0.1070 -> 0.0977   acc: 97.25% -> 97.25%              
client [52] (test)  loss: 0.1003 -> 0.1340   acc: 97.12% -> 96.81%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1393 -> 0.0000', 'accuracy': '95.46% -> 0.00%'},          
    200: {'loss': '0.1068 -> 0.0000', 'accuracy': '96.90% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(10.49%) at epoch: 0                                     
pFedSim achieved 30.0%(30.69%) at epoch: 4                                     
pFedSim achieved 40.0%(48.28%) at epoch: 5                                     
pFedSim achieved 50.0%(58.07%) at epoch: 7                                     
pFedSim achieved 60.0%(60.93%) at epoch: 8                                     
pFedSim achieved 70.0%(71.98%) at epoch: 12                                    
pFedSim achieved 80.0%(82.68%) at epoch: 17                                    
pFedSim achieved 90.0%(90.42%) at epoch: 34                                    
Convergence (test_after):                                                      
pFedSim achieved 30.0%(32.54%) at epoch: 0                                     
pFedSim achieved 40.0%(42.74%) at epoch: 2                                     
pFedSim achieved 50.0%(55.00%) at epoch: 3                                     
pFedSim achieved 60.0%(63.95%) at epoch: 5                                     
pFedSim achieved 70.0%(74.77%) at epoch: 8                                     
pFedSim achieved 80.0%(81.50%) at epoch: 12                                    
pFedSim achieved 90.0%(90.86%) at epoch: 20                                    
