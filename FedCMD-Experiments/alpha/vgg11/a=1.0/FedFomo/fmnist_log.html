==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6699 -> 0.7039   acc: 70.00% -> 68.93%             
client [81] (test)  loss: 1.0705 -> 0.8953   acc: 55.46% -> 63.59%             
client [21] (test)  loss: 3.6210 -> 0.9232   acc: 4.17% -> 70.28%              
client [68] (test)  loss: 0.9531 -> 0.8769   acc: 63.29% -> 69.62%             
client [93] (test)  loss: 0.7573 -> 0.6220   acc: 76.19% -> 76.83%             
client [31] (test)  loss: 0.8325 -> 0.7790   acc: 71.97% -> 73.16%             
client [20] (test)  loss: 0.9935 -> 1.0311   acc: 74.84% -> 75.16%             
client [59] (test)  loss: 3.2281 -> 0.7247   acc: 0.57% -> 77.14%              
client [48] (test)  loss: 0.4638 -> 0.3881   acc: 82.94% -> 87.40%             
client [34] (test)  loss: 0.8558 -> 0.6840   acc: 60.05% -> 79.08%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6079 -> 0.5489   acc: 77.14% -> 80.52%             
client [99] (test)  loss: 0.8346 -> 0.4719   acc: 67.80% -> 83.05%             
client [67] (test)  loss: 0.6557 -> 0.5673   acc: 79.85% -> 83.38%             
client [0] (test)  loss: 0.8051 -> 0.7491   acc: 69.41% -> 75.80%              
client [76] (test)  loss: 0.5047 -> 0.4825   acc: 80.51% -> 83.08%             
client [41] (test)  loss: 0.9956 -> 0.8717   acc: 62.36% -> 66.79%             
client [62] (test)  loss: 0.7781 -> 0.7230   acc: 73.70% -> 75.23%             
client [2] (test)  loss: 3.2434 -> 0.8722   acc: 10.96% -> 65.97%              
client [14] (test)  loss: 0.6321 -> 0.6298   acc: 78.34% -> 78.59%             
client [46] (test)  loss: 0.4661 -> 0.4570   acc: 83.97% -> 84.55%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5818 -> 0.5745   acc: 81.11% -> 82.62%             
client [68] (test)  loss: 0.7168 -> 1.2090   acc: 71.52% -> 59.49%             
client [57] (test)  loss: 0.5597 -> 0.5438   acc: 83.39% -> 84.12%             
client [17] (test)  loss: 0.4093 -> 0.3965   acc: 88.74% -> 88.22%             
client [54] (test)  loss: 0.3696 -> 0.3743   acc: 89.02% -> 89.26%             
client [23] (test)  loss: 0.6845 -> 1.1352   acc: 80.04% -> 69.43%             
client [35] (test)  loss: 0.8756 -> 0.4674   acc: 72.20% -> 86.01%             
client [59] (test)  loss: 0.5768 -> 0.5510   acc: 82.00% -> 82.57%             
client [31] (test)  loss: 0.7646 -> 0.7706   acc: 75.55% -> 74.95%             
client [9] (test)  loss: 0.7387 -> 0.7133   acc: 75.57% -> 75.57%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6002 -> 0.6265   acc: 76.77% -> 76.49%             
client [33] (test)  loss: 0.6731 -> 0.6700   acc: 78.92% -> 78.11%             
client [16] (test)  loss: 0.3048 -> 0.2995   acc: 91.36% -> 92.15%             
client [44] (test)  loss: 0.6358 -> 0.6167   acc: 77.09% -> 80.18%             
client [8] (test)  loss: 0.6961 -> 0.6728   acc: 74.84% -> 76.77%              
client [31] (test)  loss: 0.7723 -> 0.7966   acc: 76.14% -> 75.55%             
client [47] (test)  loss: 0.9419 -> 1.5220   acc: 71.91% -> 64.04%             
client [36] (test)  loss: 1.0189 -> 0.8424   acc: 64.11% -> 72.39%             
client [20] (test)  loss: 1.1176 -> 1.2022   acc: 75.48% -> 73.57%             
client [56] (test)  loss: 0.6438 -> 0.6424   acc: 75.00% -> 75.94%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7439 -> 0.7994   acc: 66.49% -> 65.21%              
client [60] (test)  loss: 0.5551 -> 0.5205   acc: 85.40% -> 87.13%             
client [28] (test)  loss: 1.0143 -> 1.5128   acc: 63.13% -> 55.30%             
client [25] (test)  loss: 0.7047 -> 0.8225   acc: 70.98% -> 69.66%             
client [58] (test)  loss: 0.3316 -> 0.3683   acc: 86.91% -> 85.08%             
client [44] (test)  loss: 0.6167 -> 0.5258   acc: 80.18% -> 81.94%             
client [39] (test)  loss: 0.6881 -> 0.5851   acc: 77.11% -> 80.11%             
client [29] (test)  loss: 0.8260 -> 0.7946   acc: 74.25% -> 73.95%             
client [3] (test)  loss: 0.5211 -> 0.4462   acc: 83.47% -> 84.02%              
client [84] (test)  loss: 0.4562 -> 0.4636   acc: 83.48% -> 84.35%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8960 -> 0.8479   acc: 70.00% -> 70.83%             
client [84] (test)  loss: 0.4740 -> 0.4832   acc: 84.64% -> 84.35%             
client [10] (test)  loss: 0.5820 -> 0.5398   acc: 81.11% -> 82.78%             
client [36] (test)  loss: 1.0049 -> 0.6939   acc: 66.56% -> 75.46%             
client [65] (test)  loss: 0.5474 -> 0.5482   acc: 83.26% -> 82.81%             
client [81] (test)  loss: 1.0406 -> 0.8744   acc: 59.94% -> 65.83%             
client [79] (test)  loss: 0.8130 -> 0.6300   acc: 68.23% -> 78.18%             
client [42] (test)  loss: 0.6232 -> 0.6321   acc: 77.67% -> 75.81%             
client [11] (test)  loss: 0.7101 -> 0.7545   acc: 78.26% -> 78.26%             
client [96] (test)  loss: 0.8022 -> 0.5195   acc: 69.81% -> 83.38%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6324 -> 0.5844   acc: 78.71% -> 80.00%              
client [53] (test)  loss: 0.4839 -> 0.3323   acc: 80.92% -> 88.82%             
client [52] (test)  loss: 0.8040 -> 0.8344   acc: 72.58% -> 68.42%             
client [42] (test)  loss: 0.7157 -> 0.7796   acc: 78.14% -> 70.70%             
client [69] (test)  loss: 0.4558 -> 0.4329   acc: 86.23% -> 86.23%             
client [59] (test)  loss: 0.5310 -> 0.5373   acc: 84.86% -> 84.29%             
client [7] (test)  loss: 0.7577 -> 0.7795   acc: 76.67% -> 76.94%              
client [26] (test)  loss: 0.6841 -> 0.6889   acc: 80.70% -> 82.46%             
client [49] (test)  loss: 0.6793 -> 0.6475   acc: 74.70% -> 75.18%             
client [98] (test)  loss: 0.9353 -> 0.8624   acc: 69.17% -> 70.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8624 -> 0.7475   acc: 70.00% -> 74.44%             
client [47] (test)  loss: 1.0490 -> 0.9511   acc: 68.16% -> 68.54%             
client [21] (test)  loss: 0.7891 -> 0.7253   acc: 75.00% -> 76.67%             
client [77] (test)  loss: 0.6855 -> 0.6844   acc: 76.07% -> 76.79%             
client [95] (test)  loss: 0.5194 -> 0.5366   acc: 82.54% -> 82.54%             
client [91] (test)  loss: 0.7500 -> 0.7692   acc: 78.68% -> 78.95%             
client [14] (test)  loss: 0.5778 -> 0.5766   acc: 80.35% -> 82.12%             
client [99] (test)  loss: 0.4376 -> 0.4418   acc: 85.59% -> 84.46%             
client [20] (test)  loss: 1.4009 -> 1.3305   acc: 75.48% -> 75.80%             
client [39] (test)  loss: 0.6588 -> 0.7640   acc: 79.84% -> 75.20%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8344 -> 0.7856   acc: 68.42% -> 71.47%             
client [62] (test)  loss: 0.7720 -> 0.7167   acc: 74.31% -> 74.92%             
client [71] (test)  loss: 0.5869 -> 0.6333   acc: 83.62% -> 83.90%             
client [97] (test)  loss: 0.8870 -> 0.8753   acc: 69.03% -> 73.13%             
client [30] (test)  loss: 0.8111 -> 0.8410   acc: 83.11% -> 82.77%             
client [88] (test)  loss: 0.7285 -> 0.7130   acc: 72.45% -> 72.73%             
client [60] (test)  loss: 0.4979 -> 0.4754   acc: 88.37% -> 88.86%             
client [82] (test)  loss: 0.5325 -> 0.5354   acc: 80.85% -> 82.09%             
client [91] (test)  loss: 0.9955 -> 0.6701   acc: 68.16% -> 76.58%             
client [57] (test)  loss: 0.5914 -> 0.6233   acc: 85.20% -> 84.48%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9710 -> 0.9568   acc: 73.96% -> 74.35%             
client [15] (test)  loss: 0.6095 -> 0.6372   acc: 80.33% -> 79.78%             
client [71] (test)  loss: 0.8451 -> 0.4591   acc: 73.45% -> 84.46%             
client [97] (test)  loss: 1.1044 -> 0.9145   acc: 72.76% -> 70.52%             
client [53] (test)  loss: 0.3337 -> 0.3381   acc: 91.45% -> 91.23%             
client [77] (test)  loss: 0.6844 -> 0.6803   acc: 76.79% -> 77.86%             
client [76] (test)  loss: 0.4140 -> 0.4265   acc: 87.15% -> 87.37%             
client [79] (test)  loss: 0.6512 -> 0.7274   acc: 76.80% -> 72.93%             
client [28] (test)  loss: 0.9275 -> 0.9117   acc: 66.36% -> 64.98%             
client [99] (test)  loss: 0.4682 -> 0.4860   acc: 83.33% -> 84.18%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.9349 -> 0.9196   acc: 74.25% -> 74.25%             
client [86] (test)  loss: 0.7663 -> 0.4348   acc: 73.72% -> 84.88%             
client [34] (test)  loss: 0.8310 -> 0.9837   acc: 84.24% -> 83.42%             
client [73] (test)  loss: 0.5709 -> 0.6018   acc: 81.49% -> 82.09%             
client [5] (test)  loss: 0.8048 -> 0.6507   acc: 69.73% -> 78.54%              
client [96] (test)  loss: 0.5488 -> 0.5718   acc: 83.66% -> 83.66%             
client [22] (test)  loss: 0.7327 -> 0.7177   acc: 78.71% -> 78.06%             
client [60] (test)  loss: 0.4967 -> 0.4993   acc: 89.60% -> 89.60%             
client [66] (test)  loss: 1.0037 -> 0.6041   acc: 66.67% -> 78.52%             
client [83] (test)  loss: 0.3967 -> 0.4035   acc: 88.66% -> 88.14%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4137 -> 0.4215   acc: 85.65% -> 84.80%             
client [65] (test)  loss: 0.6352 -> 0.6326   acc: 82.81% -> 81.92%             
client [95] (test)  loss: 0.7456 -> 0.5270   acc: 78.03% -> 81.97%             
client [17] (test)  loss: 0.3357 -> 0.3471   acc: 90.58% -> 90.31%             
client [8] (test)  loss: 0.5836 -> 0.5944   acc: 81.94% -> 80.65%              
client [35] (test)  loss: 0.5444 -> 0.5560   acc: 86.38% -> 86.01%             
client [98] (test)  loss: 0.8674 -> 0.9202   acc: 73.06% -> 67.78%             
client [53] (test)  loss: 0.3423 -> 0.3477   acc: 91.23% -> 91.01%             
client [43] (test)  loss: 0.3723 -> 0.3794   acc: 87.63% -> 88.71%             
client [64] (test)  loss: 0.7540 -> 0.7939   acc: 73.94% -> 69.41%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6479 -> 0.6677   acc: 80.83% -> 80.28%             
client [88] (test)  loss: 0.7100 -> 0.6965   acc: 74.10% -> 75.48%             
client [38] (test)  loss: 0.6649 -> 0.6624   acc: 80.50% -> 81.45%             
client [3] (test)  loss: 0.4763 -> 0.5201   acc: 85.12% -> 83.47%              
client [5] (test)  loss: 0.6130 -> 0.6255   acc: 77.39% -> 78.93%              
client [41] (test)  loss: 0.8579 -> 0.8945   acc: 71.59% -> 70.48%             
client [7] (test)  loss: 0.8225 -> 0.8199   acc: 76.67% -> 77.78%              
client [37] (test)  loss: 0.6827 -> 0.7045   acc: 80.45% -> 80.73%             
client [45] (test)  loss: 0.4835 -> 0.4614   acc: 84.03% -> 84.82%             
client [47] (test)  loss: 0.7527 -> 0.8130   acc: 74.91% -> 72.66%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2880 -> 0.3045   acc: 93.46% -> 93.19%             
client [11] (test)  loss: 0.6788 -> 0.6821   acc: 80.43% -> 79.35%             
client [37] (test)  loss: 0.7953 -> 0.4355   acc: 75.98% -> 84.36%             
client [41] (test)  loss: 1.1025 -> 0.6465   acc: 60.52% -> 76.75%             
client [95] (test)  loss: 0.5509 -> 0.5660   acc: 83.10% -> 82.82%             
client [53] (test)  loss: 0.3477 -> 0.3549   acc: 91.01% -> 91.01%             
client [22] (test)  loss: 0.7104 -> 0.5899   acc: 78.39% -> 79.68%             
client [25] (test)  loss: 0.7041 -> 0.6918   acc: 75.46% -> 76.78%             
client [69] (test)  loss: 0.5534 -> 0.5471   acc: 87.27% -> 87.27%             
client [46] (test)  loss: 0.6439 -> 0.3789   acc: 77.26% -> 84.84%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.8598 -> 0.6469   acc: 69.29% -> 76.03%             
client [69] (test)  loss: 0.5488 -> 0.5457   acc: 87.01% -> 86.75%             
client [82] (test)  loss: 0.5218 -> 0.5216   acc: 83.83% -> 84.33%             
client [45] (test)  loss: 0.4631 -> 0.4721   acc: 84.55% -> 85.86%             
client [7] (test)  loss: 0.8146 -> 0.8533   acc: 77.78% -> 77.78%              
client [50] (test)  loss: 0.7403 -> 0.7377   acc: 76.19% -> 74.79%             
client [35] (test)  loss: 0.5691 -> 0.5533   acc: 86.75% -> 86.38%             
client [24] (test)  loss: 0.8013 -> 0.8001   acc: 83.63% -> 83.63%             
client [15] (test)  loss: 0.6617 -> 0.6695   acc: 80.61% -> 80.61%             
client [58] (test)  loss: 0.4592 -> 0.4643   acc: 87.43% -> 87.43%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3040 -> 0.2922   acc: 89.76% -> 86.61%             
client [76] (test)  loss: 0.3799 -> 0.4297   acc: 87.37% -> 85.87%             
client [67] (test)  loss: 0.4267 -> 0.4558   acc: 88.16% -> 88.16%             
client [37] (test)  loss: 0.5896 -> 0.4851   acc: 84.08% -> 85.20%             
client [58] (test)  loss: 0.4681 -> 0.4724   acc: 87.43% -> 87.43%             
client [64] (test)  loss: 0.6486 -> 0.6448   acc: 77.90% -> 79.60%             
client [77] (test)  loss: 0.7968 -> 0.8299   acc: 78.57% -> 77.50%             
client [55] (test)  loss: 0.6010 -> 0.6154   acc: 82.39% -> 81.80%             
client [12] (test)  loss: 0.8197 -> 0.7549   acc: 73.18% -> 73.64%             
client [89] (test)  loss: 0.7596 -> 0.7764   acc: 76.21% -> 76.85%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5363 -> 0.5364   acc: 80.29% -> 81.74%             
client [51] (test)  loss: 0.8161 -> 0.8660   acc: 78.38% -> 78.98%             
client [8] (test)  loss: 0.6949 -> 0.6880   acc: 80.00% -> 80.65%              
client [18] (test)  loss: 0.6297 -> 0.6389   acc: 87.23% -> 86.93%             
client [94] (test)  loss: 0.8720 -> 0.9292   acc: 74.79% -> 75.41%             
client [81] (test)  loss: 0.8820 -> 0.9233   acc: 74.79% -> 75.35%             
client [3] (test)  loss: 0.3859 -> 0.4094   acc: 84.85% -> 84.85%              
client [11] (test)  loss: 0.7299 -> 0.7455   acc: 80.80% -> 81.88%             
client [95] (test)  loss: 0.5107 -> 0.5506   acc: 83.38% -> 81.97%             
client [67] (test)  loss: 0.4558 -> 0.4738   acc: 88.16% -> 88.16%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6623 -> 0.6834   acc: 81.39% -> 81.11%             
client [79] (test)  loss: 0.5754 -> 0.5724   acc: 78.73% -> 77.35%             
client [58] (test)  loss: 0.4847 -> 0.4880   acc: 86.91% -> 87.17%             
client [88] (test)  loss: 0.7270 -> 0.7391   acc: 76.31% -> 76.03%             
client [46] (test)  loss: 0.4648 -> 0.4775   acc: 85.42% -> 85.42%             
client [11] (test)  loss: 0.7455 -> 0.7864   acc: 81.88% -> 80.43%             
client [55] (test)  loss: 0.5539 -> 0.5975   acc: 82.00% -> 82.97%             
client [13] (test)  loss: 0.5068 -> 0.5545   acc: 83.99% -> 83.73%             
client [31] (test)  loss: 1.0901 -> 1.0917   acc: 73.96% -> 74.35%             
client [75] (test)  loss: 0.6556 -> 0.6791   acc: 82.21% -> 80.37%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4125 -> 0.4258   acc: 88.97% -> 88.97%             
client [7] (test)  loss: 0.7915 -> 0.7042   acc: 76.11% -> 78.89%              
client [57] (test)  loss: 0.4957 -> 0.5033   acc: 87.73% -> 87.73%             
client [13] (test)  loss: 0.5741 -> 0.5773   acc: 83.73% -> 83.99%             
client [43] (test)  loss: 0.2928 -> 0.2974   acc: 90.32% -> 90.86%             
client [91] (test)  loss: 0.7311 -> 0.7486   acc: 80.53% -> 80.53%             
client [10] (test)  loss: 0.6580 -> 0.6621   acc: 84.72% -> 85.00%             
client [64] (test)  loss: 0.6459 -> 0.6534   acc: 78.47% -> 79.32%             
client [82] (test)  loss: 0.3921 -> 0.4070   acc: 86.82% -> 87.06%             
client [22] (test)  loss: 0.7339 -> 0.7075   acc: 80.32% -> 80.00%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1806 -> 1.2221   acc: 78.03% -> 77.71%             
client [23] (test)  loss: 0.4379 -> 0.4521   acc: 90.02% -> 89.81%             
client [88] (test)  loss: 0.7391 -> 0.7661   acc: 76.03% -> 76.31%             
client [98] (test)  loss: 0.6907 -> 0.5952   acc: 75.56% -> 76.67%             
client [79] (test)  loss: 0.7119 -> 0.6993   acc: 72.93% -> 75.69%             
client [21] (test)  loss: 0.7125 -> 0.7405   acc: 80.56% -> 80.56%             
client [92] (test)  loss: 0.9398 -> 0.9067   acc: 73.32% -> 75.47%             
client [56] (test)  loss: 0.5384 -> 0.5376   acc: 81.56% -> 84.38%             
client [5] (test)  loss: 0.7343 -> 0.7482   acc: 79.69% -> 78.93%              
client [52] (test)  loss: 0.6738 -> 0.6874   acc: 74.79% -> 73.96%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.6763 -> 0.0000', 'accuracy': '79.69% -> 0.00%'},          
    200: {'loss': '0.6318 -> 0.0000', 'accuracy': '81.91% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(14.47%) at epoch: 0                                     
FedFomo achieved 20.0%(27.01%) at epoch: 1                                     
FedFomo achieved 50.0%(59.24%) at epoch: 2                                     
FedFomo achieved 70.0%(71.36%) at epoch: 7                                     
FedFomo achieved 80.0%(80.80%) at epoch: 41                                    
Convergence (test_after):                                                      
FedFomo achieved 70.0%(71.90%) at epoch: 0                                     
FedFomo achieved 80.0%(80.21%) at epoch: 29                                    
