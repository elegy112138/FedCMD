==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2343 -> 5.9863   acc: 2.96% -> 4.61%               
client [81] (test)  loss: 4.8563 -> 5.4025   acc: 10.63% -> 11.63%             
client [21] (test)  loss: 26.9927 -> 4.6346   acc: 1.66% -> 3.99%              
client [68] (test)  loss: 4.9297 -> 5.5742   acc: 11.92% -> 12.91%             
client [93] (test)  loss: 4.7398 -> 5.6304   acc: 8.77% -> 11.04%              
client [31] (test)  loss: 4.8778 -> 5.6270   acc: 9.76% -> 8.01%               
client [20] (test)  loss: 5.5113 -> 4.8039   acc: 6.60% -> 13.19%              
client [59] (test)  loss: 5.0761 -> 4.5448   acc: 2.74% -> 10.64%              
client [48] (test)  loss: 5.3658 -> 4.8809   acc: 2.31% -> 4.95%               
client [34] (test)  loss: 4.4779 -> 5.3566   acc: 12.61% -> 9.61%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.9420 -> 5.6588   acc: 13.53% -> 17.49%             
client [99] (test)  loss: 4.5687 -> 5.4409   acc: 11.04% -> 10.73%             
client [67] (test)  loss: 5.0549 -> 5.8263   acc: 11.63% -> 11.96%             
client [0] (test)  loss: 5.1470 -> 5.9163   acc: 6.64% -> 10.30%               
client [76] (test)  loss: 4.6370 -> 5.1313   acc: 7.17% -> 8.60%               
client [41] (test)  loss: 4.9309 -> 5.6793   acc: 6.19% -> 8.14%               
client [62] (test)  loss: 5.1371 -> 5.5176   acc: 4.35% -> 10.51%              
client [2] (test)  loss: 5.3593 -> 5.3794   acc: 4.85% -> 12.94%               
client [14] (test)  loss: 4.9580 -> 5.9918   acc: 8.83% -> 7.07%               
client [46] (test)  loss: 4.2104 -> 4.8637   acc: 12.99% -> 13.31%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 5.7057 -> 6.2454   acc: 12.50% -> 13.85%             
client [68] (test)  loss: 6.0621 -> 7.2208   acc: 10.93% -> 14.24%             
client [57] (test)  loss: 5.4711 -> 6.4669   acc: 11.44% -> 10.78%             
client [17] (test)  loss: 5.5845 -> 6.2987   acc: 12.26% -> 9.35%              
client [54] (test)  loss: 5.0510 -> 6.2890   acc: 11.79% -> 11.79%             
client [23] (test)  loss: 37.6472 -> 4.5293   acc: 3.00% -> 7.33%              
client [35] (test)  loss: 6.5852 -> 7.2926   acc: 6.89% -> 8.52%               
client [59] (test)  loss: 5.9160 -> 6.5320   acc: 14.59% -> 13.68%             
client [31] (test)  loss: 4.6703 -> 5.2648   acc: 9.41% -> 10.80%              
client [9] (test)  loss: 6.0438 -> 6.6584   acc: 8.94% -> 9.27%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.7795 -> 5.4915   acc: 12.21% -> 10.89%             
client [33] (test)  loss: 5.8112 -> 6.4054   acc: 6.19% -> 11.40%              
client [16] (test)  loss: 4.8634 -> 5.5923   acc: 9.76% -> 10.80%              
client [44] (test)  loss: 4.7605 -> 5.7366   acc: 10.16% -> 13.77%             
client [8] (test)  loss: 5.9664 -> 4.9948   acc: 6.42% -> 9.12%                
client [31] (test)  loss: 4.4450 -> 4.9681   acc: 12.20% -> 13.24%             
client [47] (test)  loss: 5.9413 -> 6.3034   acc: 18.36% -> 17.70%             
client [36] (test)  loss: 4.4291 -> 5.2726   acc: 11.30% -> 11.30%             
client [20] (test)  loss: 5.0150 -> 5.5843   acc: 15.28% -> 13.19%             
client [56] (test)  loss: 6.1141 -> 6.9578   acc: 8.25% -> 8.93%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.3420 -> 5.0088   acc: 17.76% -> 20.07%              
client [60] (test)  loss: 5.2025 -> 5.9810   acc: 8.12% -> 12.01%              
client [28] (test)  loss: 4.6445 -> 5.3097   acc: 3.64% -> 4.64%               
client [25] (test)  loss: 6.0033 -> 6.7733   acc: 11.72% -> 11.03%             
client [58] (test)  loss: 6.9865 -> 7.2013   acc: 16.41% -> 16.41%             
client [44] (test)  loss: 5.7366 -> 6.7327   acc: 13.77% -> 13.11%             
client [39] (test)  loss: 6.7364 -> 7.0792   acc: 15.00% -> 15.33%             
client [29] (test)  loss: 5.1414 -> 6.1170   acc: 10.93% -> 9.60%              
client [3] (test)  loss: 5.2754 -> 6.2000   acc: 14.38% -> 13.07%              
client [84] (test)  loss: 5.7946 -> 7.1343   acc: 7.19% -> 8.50%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.2546 -> 5.8442   acc: 7.64% -> 9.63%               
client [84] (test)  loss: 5.1041 -> 5.8647   acc: 7.19% -> 8.17%               
client [10] (test)  loss: 6.6368 -> 7.7811   acc: 9.57% -> 9.24%               
client [36] (test)  loss: 5.4942 -> 4.2535   acc: 10.30% -> 14.62%             
client [65] (test)  loss: 6.4676 -> 7.3688   acc: 8.58% -> 6.93%               
client [81] (test)  loss: 5.4081 -> 5.9949   acc: 16.94% -> 18.60%             
client [79] (test)  loss: 5.0551 -> 4.8723   acc: 6.56% -> 17.70%              
client [42] (test)  loss: 4.8893 -> 5.7240   acc: 15.56% -> 17.88%             
client [11] (test)  loss: 4.7676 -> 5.6189   acc: 12.42% -> 13.09%             
client [96] (test)  loss: 4.7184 -> 5.4549   acc: 13.45% -> 17.45%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.5195 -> 4.9059   acc: 7.43% -> 11.15%               
client [53] (test)  loss: 5.0872 -> 5.9052   acc: 17.26% -> 15.64%             
client [52] (test)  loss: 5.1692 -> 5.7779   acc: 18.51% -> 18.51%             
client [42] (test)  loss: 5.8707 -> 4.6533   acc: 8.61% -> 20.20%              
client [69] (test)  loss: 5.1284 -> 5.4416   acc: 20.46% -> 20.46%             
client [59] (test)  loss: 7.0811 -> 7.1975   acc: 15.20% -> 15.20%             
client [7] (test)  loss: 5.6474 -> 6.4295   acc: 11.44% -> 14.38%              
client [26] (test)  loss: 6.3951 -> 7.1529   acc: 12.58% -> 12.91%             
client [49] (test)  loss: 6.2634 -> 6.7305   acc: 15.41% -> 14.75%             
client [98] (test)  loss: 6.5480 -> 6.7511   acc: 12.62% -> 12.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 6.7510 -> 6.8885   acc: 12.62% -> 12.62%             
client [47] (test)  loss: 4.5599 -> 4.3253   acc: 14.75% -> 24.59%             
client [21] (test)  loss: 4.3513 -> 4.8584   acc: 23.92% -> 24.92%             
client [77] (test)  loss: 6.6783 -> 6.9421   acc: 15.13% -> 14.80%             
client [95] (test)  loss: 5.3959 -> 4.7162   acc: 9.80% -> 16.55%              
client [91] (test)  loss: 5.3925 -> 5.6072   acc: 22.04% -> 22.37%             
client [14] (test)  loss: 5.0722 -> 5.6898   acc: 18.73% -> 17.31%             
client [99] (test)  loss: 5.6824 -> 5.8094   acc: 20.19% -> 20.50%             
client [20] (test)  loss: 4.5200 -> 5.1859   acc: 20.49% -> 20.49%             
client [39] (test)  loss: 5.0180 -> 5.7552   acc: 13.33% -> 18.67%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.3746 -> 4.7553   acc: 16.88% -> 22.08%             
client [62] (test)  loss: 8.3941 -> 8.5504   acc: 11.96% -> 12.32%             
client [71] (test)  loss: 4.6468 -> 4.4135   acc: 19.47% -> 18.48%             
client [97] (test)  loss: 4.8603 -> 5.5687   acc: 20.53% -> 18.87%             
client [30] (test)  loss: 6.0374 -> 6.1765   acc: 16.83% -> 17.49%             
client [88] (test)  loss: 5.3830 -> 4.7031   acc: 11.63% -> 22.59%             
client [60] (test)  loss: 5.8012 -> 5.9679   acc: 14.29% -> 14.61%             
client [82] (test)  loss: 5.6928 -> 4.5875   acc: 11.26% -> 18.54%             
client [91] (test)  loss: 5.7493 -> 5.8617   acc: 22.04% -> 21.71%             
client [57] (test)  loss: 5.0087 -> 4.5320   acc: 11.76% -> 22.22%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.1243 -> 4.6401   acc: 13.94% -> 19.86%             
client [15] (test)  loss: 4.3286 -> 4.4092   acc: 19.74% -> 22.04%             
client [71] (test)  loss: 4.4135 -> 4.8126   acc: 18.48% -> 21.45%             
client [97] (test)  loss: 5.9865 -> 6.0990   acc: 19.21% -> 18.87%             
client [53] (test)  loss: 5.9038 -> 6.0632   acc: 24.10% -> 24.43%             
client [77] (test)  loss: 4.7612 -> 4.8124   acc: 17.11% -> 20.72%             
client [76] (test)  loss: 4.8982 -> 5.4834   acc: 19.00% -> 19.00%             
client [79] (test)  loss: 5.5973 -> 4.4293   acc: 11.80% -> 21.97%             
client [28] (test)  loss: 5.5547 -> 5.7901   acc: 18.21% -> 18.54%             
client [99] (test)  loss: 5.0472 -> 4.3557   acc: 14.20% -> 20.19%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 6.1883 -> 6.2647   acc: 19.21% -> 19.21%             
client [86] (test)  loss: 6.5419 -> 6.6211   acc: 15.05% -> 15.38%             
client [34] (test)  loss: 5.3495 -> 5.4254   acc: 23.72% -> 24.02%             
client [73] (test)  loss: 4.2771 -> 4.5871   acc: 21.97% -> 22.95%             
client [5] (test)  loss: 5.4416 -> 4.5719   acc: 13.49% -> 21.71%              
client [96] (test)  loss: 4.3912 -> 4.8034   acc: 21.09% -> 22.18%             
client [22] (test)  loss: 4.5745 -> 4.7337   acc: 24.43% -> 23.45%             
client [60] (test)  loss: 5.2218 -> 5.4535   acc: 20.13% -> 20.13%             
client [66] (test)  loss: 5.2784 -> 5.3685   acc: 24.52% -> 24.19%             
client [83] (test)  loss: 4.7287 -> 5.2212   acc: 20.79% -> 19.80%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.5163 -> 4.5357   acc: 13.62% -> 21.15%             
client [65] (test)  loss: 4.9847 -> 5.5846   acc: 17.16% -> 16.17%             
client [95] (test)  loss: 4.9795 -> 4.8756   acc: 14.19% -> 18.24%             
client [17] (test)  loss: 8.3700 -> 8.5213   acc: 13.55% -> 14.19%             
client [8] (test)  loss: 5.7401 -> 5.8456   acc: 13.18% -> 12.84%              
client [35] (test)  loss: 5.2767 -> 5.4292   acc: 17.70% -> 18.69%             
client [98] (test)  loss: 5.3772 -> 5.6047   acc: 18.77% -> 19.09%             
client [53] (test)  loss: 6.1840 -> 6.2803   acc: 24.43% -> 24.43%             
client [43] (test)  loss: 5.1398 -> 5.2125   acc: 24.09% -> 24.42%             
client [64] (test)  loss: 5.2192 -> 4.6051   acc: 18.15% -> 23.10%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.0003 -> 3.8938   acc: 26.58% -> 30.90%             
client [88] (test)  loss: 5.7721 -> 5.8348   acc: 20.60% -> 20.60%             
client [38] (test)  loss: 4.1248 -> 4.0521   acc: 21.71% -> 27.30%             
client [3] (test)  loss: 4.9973 -> 5.0737   acc: 27.78% -> 27.12%              
client [5] (test)  loss: 4.7943 -> 4.3583   acc: 16.12% -> 26.32%              
client [41] (test)  loss: 6.7757 -> 6.8536   acc: 17.59% -> 17.59%             
client [7] (test)  loss: 4.8045 -> 4.9608   acc: 22.55% -> 22.55%              
client [37] (test)  loss: 4.1565 -> 4.0062   acc: 19.21% -> 28.81%             
client [45] (test)  loss: 4.5942 -> 5.0664   acc: 20.20% -> 21.85%             
client [47] (test)  loss: 4.9140 -> 5.0455   acc: 26.89% -> 26.89%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.8233 -> 4.3341   acc: 15.68% -> 27.18%             
client [11] (test)  loss: 3.9285 -> 4.2684   acc: 22.82% -> 22.15%             
client [37] (test)  loss: 4.4144 -> 4.5028   acc: 27.81% -> 27.48%             
client [41] (test)  loss: 6.8517 -> 6.9199   acc: 17.59% -> 17.59%             
client [95] (test)  loss: 5.6353 -> 5.7323   acc: 19.26% -> 19.26%             
client [53] (test)  loss: 6.2803 -> 6.3607   acc: 24.43% -> 24.43%             
client [22] (test)  loss: 3.8221 -> 4.1079   acc: 28.66% -> 28.66%             
client [25] (test)  loss: 4.6049 -> 4.3376   acc: 19.31% -> 24.83%             
client [69] (test)  loss: 4.7728 -> 4.8586   acc: 26.07% -> 26.40%             
client [46] (test)  loss: 4.0155 -> 3.7295   acc: 28.90% -> 32.14%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.3308 -> 5.3783   acc: 26.89% -> 26.89%             
client [69] (test)  loss: 4.9281 -> 4.9861   acc: 26.40% -> 26.40%             
client [82] (test)  loss: 5.2220 -> 4.0791   acc: 22.52% -> 25.83%             
client [45] (test)  loss: 5.4275 -> 5.5257   acc: 21.52% -> 21.19%             
client [7] (test)  loss: 4.9458 -> 5.0561   acc: 22.55% -> 22.88%              
client [50] (test)  loss: 4.1943 -> 4.4575   acc: 24.72% -> 25.47%             
client [35] (test)  loss: 5.1931 -> 4.5485   acc: 19.02% -> 21.64%             
client [24] (test)  loss: 4.6769 -> 4.7549   acc: 28.04% -> 28.04%             
client [15] (test)  loss: 5.0032 -> 5.0656   acc: 24.01% -> 24.34%             
client [58] (test)  loss: 4.7750 -> 4.9301   acc: 22.66% -> 23.44%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.7252 -> 4.8001   acc: 27.06% -> 27.39%             
client [76] (test)  loss: 4.9738 -> 5.0678   acc: 20.07% -> 20.07%             
client [67] (test)  loss: 4.9414 -> 5.0488   acc: 20.93% -> 20.93%             
client [37] (test)  loss: 4.5718 -> 4.6276   acc: 27.48% -> 28.15%             
client [58] (test)  loss: 5.0333 -> 5.1107   acc: 23.44% -> 23.83%             
client [64] (test)  loss: 5.3397 -> 5.4322   acc: 24.09% -> 24.75%             
client [77] (test)  loss: 6.0400 -> 4.6479   acc: 16.12% -> 24.01%             
client [55] (test)  loss: 4.0684 -> 4.2091   acc: 25.90% -> 25.90%             
client [12] (test)  loss: 5.0729 -> 4.0954   acc: 17.49% -> 24.09%             
client [89] (test)  loss: 4.6390 -> 4.8173   acc: 24.52% -> 23.55%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.5287 -> 4.5788   acc: 25.82% -> 25.82%             
client [51] (test)  loss: 4.7054 -> 4.1419   acc: 25.50% -> 23.18%             
client [8] (test)  loss: 5.1487 -> 5.2028   acc: 18.58% -> 18.58%              
client [18] (test)  loss: 4.4231 -> 4.4696   acc: 27.12% -> 27.12%             
client [94] (test)  loss: 4.8683 -> 4.9458   acc: 27.89% -> 28.23%             
client [81] (test)  loss: 4.5820 -> 4.6249   acc: 25.58% -> 25.91%             
client [3] (test)  loss: 5.2860 -> 5.3235   acc: 27.12% -> 27.45%              
client [11] (test)  loss: 4.6119 -> 4.6754   acc: 23.15% -> 23.15%             
client [95] (test)  loss: 5.5374 -> 5.6438   acc: 21.96% -> 21.96%             
client [67] (test)  loss: 5.0487 -> 5.1309   acc: 20.93% -> 20.93%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.4542 -> 4.5572   acc: 30.23% -> 30.23%             
client [79] (test)  loss: 4.2526 -> 4.3926   acc: 27.54% -> 27.21%             
client [58] (test)  loss: 4.4330 -> 4.7475   acc: 25.39% -> 26.95%             
client [88] (test)  loss: 5.9602 -> 6.0010   acc: 20.27% -> 20.27%             
client [46] (test)  loss: 4.1533 -> 4.2150   acc: 34.09% -> 34.09%             
client [11] (test)  loss: 4.6754 -> 4.7290   acc: 23.15% -> 23.49%             
client [55] (test)  loss: 4.5158 -> 4.5526   acc: 27.21% -> 27.21%             
client [13] (test)  loss: 4.0971 -> 4.3135   acc: 25.65% -> 26.30%             
client [31] (test)  loss: 4.8536 -> 4.2246   acc: 23.69% -> 24.74%             
client [75] (test)  loss: 3.9908 -> 4.1918   acc: 31.25% -> 31.58%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.8569 -> 4.9156   acc: 25.33% -> 25.33%             
client [7] (test)  loss: 4.2957 -> 4.3642   acc: 27.12% -> 27.12%              
client [57] (test)  loss: 5.5588 -> 5.6268   acc: 21.90% -> 21.90%             
client [13] (test)  loss: 4.4259 -> 4.5045   acc: 25.97% -> 26.30%             
client [43] (test)  loss: 4.4516 -> 4.4972   acc: 28.71% -> 29.04%             
client [91] (test)  loss: 4.0058 -> 4.0956   acc: 32.24% -> 33.22%             
client [10] (test)  loss: 5.4595 -> 5.5085   acc: 18.81% -> 18.81%             
client [64] (test)  loss: 4.9408 -> 5.0362   acc: 22.77% -> 23.10%             
client [82] (test)  loss: 4.7093 -> 4.7474   acc: 26.16% -> 26.16%             
client [22] (test)  loss: 4.5133 -> 4.5558   acc: 28.01% -> 28.01%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.1063 -> 4.7791   acc: 15.62% -> 26.39%             
client [23] (test)  loss: 4.1042 -> 4.4045   acc: 27.33% -> 27.00%             
client [88] (test)  loss: 6.0009 -> 6.0371   acc: 20.27% -> 20.27%             
client [98] (test)  loss: 4.7664 -> 4.8206   acc: 22.98% -> 22.65%             
client [79] (test)  loss: 4.5625 -> 4.6226   acc: 27.54% -> 27.21%             
client [21] (test)  loss: 4.6356 -> 4.6984   acc: 30.23% -> 29.90%             
client [92] (test)  loss: 4.5375 -> 4.6226   acc: 30.00% -> 30.31%             
client [56] (test)  loss: 4.7855 -> 4.8269   acc: 28.87% -> 28.87%             
client [5] (test)  loss: 5.1489 -> 5.1920   acc: 28.95% -> 28.95%              
client [52] (test)  loss: 4.1505 -> 4.3904   acc: 27.92% -> 28.57%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '5.4768 -> 0.0000', 'accuracy': '19.42% -> 0.00%'},          
    200: {'loss': '4.8440 -> 0.0000', 'accuracy': '25.83% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(10.21%) at epoch: 29                                    
FedFomo achieved 20.0%(20.68%) at epoch: 94                                    
Convergence (test_after):                                                      
FedFomo achieved 10.0%(10.49%) at epoch: 7                                     
FedFomo achieved 20.0%(20.13%) at epoch: 77                                    
