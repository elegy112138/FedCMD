==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5939 -> 4.1361   acc: 10.43% -> 22.26%             
client [81] (test)  loss: 4.0979 -> 4.0249   acc: 16.36% -> 24.73%             
client [21] (test)  loss: 4.8389 -> 3.5102   acc: 9.21% -> 26.90%              
client [68] (test)  loss: 4.4171 -> 3.8804   acc: 13.49% -> 25.90%             
client [93] (test)  loss: 4.3694 -> 3.9513   acc: 12.12% -> 22.97%             
client [31] (test)  loss: 4.6103 -> 3.6927   acc: 10.45% -> 29.55%             
client [20] (test)  loss: 4.0311 -> 3.8238   acc: 18.18% -> 30.48%             
client [59] (test)  loss: 4.6688 -> 3.8921   acc: 10.25% -> 23.74%             
client [48] (test)  loss: 3.9242 -> 4.0590   acc: 20.93% -> 30.05%             
client [34] (test)  loss: 3.9086 -> 3.8549   acc: 17.51% -> 28.52%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.3068 -> 3.6775   acc: 23.99% -> 32.23%             
client [99] (test)  loss: 3.7861 -> 4.1949   acc: 26.08% -> 32.19%             
client [67] (test)  loss: 3.4518 -> 3.1937   acc: 32.74% -> 39.12%             
client [0] (test)  loss: 3.5208 -> 3.6760   acc: 34.29% -> 37.88%              
client [76] (test)  loss: 3.3206 -> 3.5633   acc: 36.78% -> 38.41%             
client [41] (test)  loss: 3.3152 -> 3.3273   acc: 33.63% -> 37.07%             
client [62] (test)  loss: 4.7906 -> 3.6896   acc: 21.42% -> 34.85%             
client [2] (test)  loss: 4.4272 -> 3.5472   acc: 25.15% -> 36.56%              
client [14] (test)  loss: 3.6645 -> 4.2156   acc: 30.50% -> 29.94%             
client [46] (test)  loss: 3.4500 -> 3.5384   acc: 33.75% -> 36.10%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.1847 -> 3.2997   acc: 38.32% -> 36.13%             
client [68] (test)  loss: 3.1132 -> 3.5646   acc: 39.93% -> 40.65%             
client [57] (test)  loss: 3.4926 -> 3.5658   acc: 34.85% -> 37.93%             
client [17] (test)  loss: 3.3871 -> 3.6462   acc: 36.51% -> 38.90%             
client [54] (test)  loss: 3.2596 -> 3.4793   acc: 39.38% -> 42.11%             
client [23] (test)  loss: 4.0753 -> 3.4505   acc: 28.37% -> 37.90%             
client [35] (test)  loss: 3.1938 -> 3.6001   acc: 39.42% -> 38.52%             
client [59] (test)  loss: 3.1208 -> 3.3705   acc: 38.13% -> 35.97%             
client [31] (test)  loss: 3.1516 -> 3.5810   acc: 39.64% -> 40.54%             
client [9] (test)  loss: 3.2068 -> 3.4966   acc: 39.04% -> 39.25%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.1676 -> 3.3244   acc: 39.75% -> 41.38%             
client [33] (test)  loss: 2.9635 -> 3.1859   acc: 41.77% -> 39.78%             
client [16] (test)  loss: 3.1099 -> 3.3965   acc: 43.13% -> 40.00%             
client [44] (test)  loss: 3.6273 -> 3.2096   acc: 34.36% -> 39.78%             
client [8] (test)  loss: 3.0908 -> 3.5039   acc: 43.74% -> 43.56%              
client [31] (test)  loss: 3.1603 -> 3.5850   acc: 41.08% -> 41.44%             
client [47] (test)  loss: 3.2365 -> 3.3798   acc: 39.96% -> 43.09%             
client [36] (test)  loss: 3.7056 -> 3.4408   acc: 33.33% -> 37.30%             
client [20] (test)  loss: 3.0633 -> 3.3283   acc: 42.78% -> 45.45%             
client [56] (test)  loss: 3.0725 -> 3.0810   acc: 41.95% -> 44.30%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.8426 -> 3.0398   acc: 44.55% -> 44.00%              
client [60] (test)  loss: 2.7414 -> 2.7205   acc: 48.74% -> 49.46%             
client [28] (test)  loss: 2.8647 -> 3.0630   acc: 45.74% -> 43.56%             
client [25] (test)  loss: 3.2152 -> 3.2264   acc: 39.64% -> 42.91%             
client [58] (test)  loss: 3.4211 -> 3.7904   acc: 38.16% -> 36.53%             
client [44] (test)  loss: 3.0619 -> 3.1453   acc: 39.42% -> 41.05%             
client [39] (test)  loss: 3.2239 -> 3.4442   acc: 42.71% -> 43.22%             
client [29] (test)  loss: 3.2069 -> 3.3926   acc: 42.93% -> 41.50%             
client [3] (test)  loss: 3.2456 -> 3.2958   acc: 40.51% -> 39.60%              
client [84] (test)  loss: 3.1063 -> 3.3351   acc: 42.78% -> 44.40%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.9411 -> 3.0226   acc: 45.49% -> 47.11%             
client [84] (test)  loss: 3.0377 -> 3.3704   acc: 44.04% -> 44.04%             
client [10] (test)  loss: 3.0384 -> 3.1737   acc: 43.04% -> 39.96%             
client [36] (test)  loss: 3.3326 -> 3.4068   acc: 39.82% -> 41.44%             
client [65] (test)  loss: 3.3957 -> 3.6634   acc: 38.71% -> 39.66%             
client [81] (test)  loss: 3.2476 -> 3.6937   acc: 42.00% -> 41.09%             
client [79] (test)  loss: 3.2559 -> 3.5179   acc: 43.68% -> 41.64%             
client [42] (test)  loss: 3.0685 -> 3.4402   acc: 40.51% -> 37.79%             
client [11] (test)  loss: 2.9436 -> 3.0375   acc: 50.30% -> 47.92%             
client [96] (test)  loss: 3.1350 -> 3.2749   acc: 42.50% -> 41.95%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.0304 -> 3.4335   acc: 45.55% -> 45.37%              
client [53] (test)  loss: 3.2777 -> 3.3713   acc: 43.06% -> 40.54%             
client [52] (test)  loss: 2.9922 -> 3.3392   acc: 45.07% -> 40.41%             
client [42] (test)  loss: 3.1267 -> 3.5757   acc: 40.69% -> 37.61%             
client [69] (test)  loss: 3.2724 -> 3.6824   acc: 39.56% -> 38.64%             
client [59] (test)  loss: 2.8905 -> 3.1326   acc: 44.42% -> 42.99%             
client [7] (test)  loss: 3.2302 -> 3.5155   acc: 41.07% -> 40.18%              
client [26] (test)  loss: 2.8858 -> 3.0895   acc: 45.41% -> 45.58%             
client [49] (test)  loss: 3.3135 -> 3.4920   acc: 41.67% -> 39.31%             
client [98] (test)  loss: 3.0364 -> 3.2999   acc: 46.29% -> 46.11%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.2065 -> 3.4434   acc: 47.92% -> 46.47%             
client [47] (test)  loss: 3.3678 -> 3.3757   acc: 42.17% -> 46.59%             
client [21] (test)  loss: 3.0826 -> 3.2165   acc: 45.31% -> 45.67%             
client [77] (test)  loss: 3.3071 -> 3.6547   acc: 44.00% -> 41.04%             
client [95] (test)  loss: 3.0469 -> 3.3943   acc: 50.09% -> 49.37%             
client [91] (test)  loss: 3.0257 -> 3.2686   acc: 47.13% -> 44.26%             
client [14] (test)  loss: 3.3991 -> 3.8110   acc: 40.85% -> 38.82%             
client [99] (test)  loss: 3.5253 -> 3.8446   acc: 39.21% -> 37.41%             
client [20] (test)  loss: 2.9862 -> 3.3226   acc: 49.38% -> 47.24%             
client [39] (test)  loss: 3.3346 -> 3.5335   acc: 45.63% -> 45.28%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.0702 -> 3.3853   acc: 45.44% -> 42.27%             
client [62] (test)  loss: 3.2710 -> 3.7356   acc: 46.64% -> 45.55%             
client [71] (test)  loss: 3.0319 -> 3.2939   acc: 45.77% -> 45.23%             
client [97] (test)  loss: 3.3722 -> 3.3873   acc: 42.83% -> 40.62%             
client [30] (test)  loss: 3.2806 -> 3.6525   acc: 45.37% -> 46.64%             
client [88] (test)  loss: 3.1452 -> 3.2064   acc: 48.49% -> 46.00%             
client [60] (test)  loss: 2.9141 -> 2.9368   acc: 50.72% -> 50.72%             
client [82] (test)  loss: 3.5369 -> 3.8840   acc: 40.70% -> 37.74%             
client [91] (test)  loss: 3.0192 -> 3.3943   acc: 47.47% -> 44.43%             
client [57] (test)  loss: 3.1891 -> 3.4336   acc: 46.64% -> 44.46%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.3235 -> 3.8307   acc: 45.05% -> 43.60%             
client [15] (test)  loss: 3.6120 -> 3.6178   acc: 42.98% -> 42.98%             
client [71] (test)  loss: 3.1332 -> 3.3378   acc: 47.03% -> 46.13%             
client [97] (test)  loss: 3.5126 -> 3.6371   acc: 43.57% -> 39.52%             
client [53] (test)  loss: 3.5147 -> 3.5534   acc: 43.78% -> 42.16%             
client [77] (test)  loss: 3.4384 -> 3.7199   acc: 42.26% -> 41.74%             
client [76] (test)  loss: 3.2097 -> 3.3997   acc: 46.92% -> 45.11%             
client [79] (test)  loss: 3.5607 -> 3.6689   acc: 43.87% -> 42.19%             
client [28] (test)  loss: 3.0199 -> 3.4129   acc: 48.46% -> 47.37%             
client [99] (test)  loss: 3.7278 -> 3.9477   acc: 40.65% -> 36.69%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.4429 -> 3.8195   acc: 41.91% -> 40.26%             
client [86] (test)  loss: 3.0266 -> 3.1801   acc: 44.83% -> 43.38%             
client [34] (test)  loss: 3.3021 -> 3.8693   acc: 48.92% -> 46.75%             
client [73] (test)  loss: 3.0095 -> 3.3138   acc: 47.09% -> 47.64%             
client [5] (test)  loss: 3.3804 -> 3.6842   acc: 45.23% -> 43.42%              
client [96] (test)  loss: 3.3645 -> 3.7815   acc: 44.48% -> 43.94%             
client [22] (test)  loss: 3.4541 -> 3.6637   acc: 43.67% -> 42.60%             
client [60] (test)  loss: 2.8676 -> 3.1120   acc: 52.16% -> 52.34%             
client [66] (test)  loss: 3.2791 -> 3.7187   acc: 46.91% -> 44.73%             
client [83] (test)  loss: 3.3247 -> 3.5396   acc: 44.91% -> 43.27%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.3592 -> 3.6425   acc: 47.46% -> 46.38%             
client [65] (test)  loss: 3.9757 -> 3.8817   acc: 41.94% -> 42.13%             
client [95] (test)  loss: 3.4043 -> 3.7363   acc: 47.74% -> 48.46%             
client [17] (test)  loss: 3.7404 -> 3.7787   acc: 46.97% -> 44.95%             
client [8] (test)  loss: 3.4651 -> 3.8697   acc: 46.46% -> 46.82%              
client [35] (test)  loss: 3.6892 -> 4.1222   acc: 43.58% -> 42.86%             
client [98] (test)  loss: 3.4489 -> 3.6716   acc: 48.10% -> 46.11%             
client [53] (test)  loss: 3.6990 -> 3.8350   acc: 43.42% -> 41.62%             
client [43] (test)  loss: 3.1961 -> 3.3804   acc: 49.18% -> 46.46%             
client [64] (test)  loss: 3.5962 -> 3.6536   acc: 45.01% -> 43.01%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.6343 -> 3.4711   acc: 47.83% -> 45.67%             
client [88] (test)  loss: 3.6167 -> 3.7430   acc: 48.85% -> 46.36%             
client [38] (test)  loss: 3.7264 -> 4.0317   acc: 47.28% -> 46.56%             
client [3] (test)  loss: 3.7292 -> 3.8818   acc: 43.58% -> 42.50%              
client [5] (test)  loss: 3.7959 -> 3.9110   acc: 45.41% -> 43.42%              
client [41] (test)  loss: 3.3741 -> 3.3726   acc: 48.10% -> 47.38%             
client [7] (test)  loss: 3.9557 -> 3.9983   acc: 43.04% -> 41.96%              
client [37] (test)  loss: 3.3043 -> 3.3629   acc: 48.38% -> 46.57%             
client [45] (test)  loss: 3.4317 -> 3.1653   acc: 49.65% -> 48.94%             
client [47] (test)  loss: 3.9059 -> 3.7596   acc: 44.75% -> 42.91%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.6763 -> 3.9474   acc: 46.61% -> 46.09%             
client [11] (test)  loss: 3.5856 -> 3.5795   acc: 50.30% -> 50.10%             
client [37] (test)  loss: 3.2433 -> 3.5983   acc: 49.64% -> 47.29%             
client [41] (test)  loss: 3.2407 -> 3.3735   acc: 47.20% -> 46.47%             
client [95] (test)  loss: 3.4901 -> 3.8795   acc: 49.19% -> 49.37%             
client [53] (test)  loss: 3.8977 -> 3.9476   acc: 43.06% -> 41.62%             
client [22] (test)  loss: 3.7894 -> 3.9330   acc: 44.03% -> 42.07%             
client [25] (test)  loss: 3.7115 -> 3.7465   acc: 46.18% -> 46.36%             
client [69] (test)  loss: 3.8862 -> 4.2493   acc: 41.76% -> 40.66%             
client [46] (test)  loss: 3.4968 -> 3.6795   acc: 47.83% -> 43.86%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.1464 -> 4.3614   acc: 45.30% -> 44.57%             
client [69] (test)  loss: 4.1002 -> 4.4110   acc: 40.84% -> 41.39%             
client [82] (test)  loss: 4.5038 -> 4.5772   acc: 40.17% -> 39.48%             
client [45] (test)  loss: 3.6066 -> 3.5732   acc: 50.18% -> 48.24%             
client [7] (test)  loss: 4.1352 -> 3.9461   acc: 42.50% -> 42.50%              
client [50] (test)  loss: 3.7171 -> 3.6558   acc: 46.29% -> 43.22%             
client [35] (test)  loss: 3.9906 -> 4.3728   acc: 45.93% -> 45.21%             
client [24] (test)  loss: 3.9528 -> 4.2208   acc: 43.11% -> 43.71%             
client [15] (test)  loss: 4.3398 -> 4.2128   acc: 41.92% -> 41.21%             
client [58] (test)  loss: 4.3355 -> 4.7026   acc: 41.41% -> 41.23%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.3737 -> 4.6146   acc: 45.97% -> 44.90%             
client [76] (test)  loss: 3.9688 -> 4.0648   acc: 46.01% -> 46.38%             
client [67] (test)  loss: 3.4845 -> 3.4842   acc: 46.90% -> 46.55%             
client [37] (test)  loss: 3.7088 -> 3.8954   acc: 48.56% -> 48.74%             
client [58] (test)  loss: 4.6303 -> 4.8838   acc: 41.59% -> 41.59%             
client [64] (test)  loss: 4.2332 -> 4.1422   acc: 44.28% -> 43.92%             
client [77] (test)  loss: 4.3616 -> 4.5328   acc: 43.13% -> 40.17%             
client [55] (test)  loss: 4.5088 -> 4.5444   acc: 42.60% -> 41.53%             
client [12] (test)  loss: 4.2784 -> 4.3103   acc: 47.13% -> 46.93%             
client [89] (test)  loss: 4.7144 -> 4.6477   acc: 40.29% -> 41.56%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.9568 -> 4.2925   acc: 47.29% -> 47.83%             
client [51] (test)  loss: 4.2981 -> 4.5844   acc: 44.57% -> 41.67%             
client [8] (test)  loss: 3.9450 -> 4.4265   acc: 45.92% -> 47.37%              
client [18] (test)  loss: 3.8763 -> 4.0659   acc: 48.75% -> 49.29%             
client [94] (test)  loss: 4.2032 -> 4.3855   acc: 45.53% -> 44.67%             
client [81] (test)  loss: 4.4481 -> 4.9825   acc: 42.55% -> 44.36%             
client [3] (test)  loss: 3.9994 -> 4.2454   acc: 43.94% -> 44.67%              
client [11] (test)  loss: 3.9356 -> 4.0732   acc: 49.50% -> 50.30%             
client [95] (test)  loss: 3.8536 -> 4.1736   acc: 48.64% -> 49.19%             
client [67] (test)  loss: 3.3202 -> 3.6690   acc: 46.55% -> 46.90%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.1370 -> 3.7106   acc: 49.10% -> 47.11%             
client [79] (test)  loss: 4.6280 -> 4.8066   acc: 43.31% -> 45.72%             
client [58] (test)  loss: 4.8039 -> 5.0562   acc: 40.87% -> 40.14%             
client [88] (test)  loss: 4.1467 -> 4.0876   acc: 47.78% -> 46.36%             
client [46] (test)  loss: 4.1738 -> 4.1489   acc: 46.93% -> 46.21%             
client [11] (test)  loss: 4.2083 -> 4.2559   acc: 49.70% -> 50.89%             
client [55] (test)  loss: 4.5842 -> 4.8368   acc: 42.42% -> 42.60%             
client [13] (test)  loss: 4.2694 -> 4.3854   acc: 47.67% -> 46.50%             
client [31] (test)  loss: 4.2757 -> 4.5952   acc: 43.96% -> 43.96%             
client [75] (test)  loss: 4.0465 -> 4.1857   acc: 46.75% -> 45.67%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.5052 -> 4.6517   acc: 45.95% -> 46.13%             
client [7] (test)  loss: 4.5016 -> 4.7350   acc: 43.57% -> 43.04%              
client [57] (test)  loss: 4.5483 -> 4.5515   acc: 45.55% -> 46.28%             
client [13] (test)  loss: 4.3182 -> 4.4569   acc: 48.44% -> 47.08%             
client [43] (test)  loss: 4.0322 -> 4.2069   acc: 48.09% -> 47.01%             
client [91] (test)  loss: 4.0673 -> 3.9832   acc: 46.79% -> 45.44%             
client [10] (test)  loss: 4.2434 -> 4.3718   acc: 41.23% -> 42.68%             
client [64] (test)  loss: 4.4482 -> 4.5417   acc: 44.10% -> 43.56%             
client [82] (test)  loss: 4.9138 -> 5.1773   acc: 40.17% -> 39.83%             
client [22] (test)  loss: 4.5654 -> 4.6668   acc: 44.74% -> 43.67%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.0895 -> 4.1288   acc: 49.02% -> 47.06%             
client [23] (test)  loss: 4.7921 -> 4.5064   acc: 43.65% -> 42.46%             
client [88] (test)  loss: 4.4071 -> 4.3839   acc: 47.60% -> 46.18%             
client [98] (test)  loss: 4.5273 -> 4.6600   acc: 47.74% -> 47.20%             
client [79] (test)  loss: 4.9338 -> 5.0890   acc: 44.61% -> 45.17%             
client [21] (test)  loss: 4.4619 -> 4.0885   acc: 49.28% -> 47.65%             
client [92] (test)  loss: 4.4209 -> 4.5395   acc: 45.85% -> 46.21%             
client [56] (test)  loss: 4.1488 -> 4.3424   acc: 47.92% -> 46.84%             
client [5] (test)  loss: 4.6511 -> 4.3336   acc: 44.86% -> 44.50%              
client [52] (test)  loss: 4.5252 -> 4.7381   acc: 44.88% -> 43.20%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.3310 -> 0.0000', 'accuracy': '45.48% -> 0.00%'},          
    200: {'loss': '4.6220 -> 0.0000', 'accuracy': '45.33% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(13.89%) at epoch: 9                                      
FedPer achieved 20.0%(21.19%) at epoch: 12                                     
FedPer achieved 30.0%(30.72%) at epoch: 16                                     
FedPer achieved 40.0%(41.23%) at epoch: 38                                     
Convergence (test_after):                                                      
FedPer achieved 10.0%(11.47%) at epoch: 5                                      
FedPer achieved 20.0%(21.67%) at epoch: 7                                      
FedPer achieved 30.0%(30.80%) at epoch: 11                                     
FedPer achieved 40.0%(40.54%) at epoch: 31                                     
