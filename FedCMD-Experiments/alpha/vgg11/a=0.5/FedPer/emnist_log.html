==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6222 -> 0.5712   acc: 80.01% -> 81.60%             
client [81] (test)  loss: 0.3755 -> 0.3500   acc: 86.65% -> 86.31%             
client [21] (test)  loss: 0.2732 -> 0.1450   acc: 93.49% -> 95.55%             
client [68] (test)  loss: 0.1202 -> 0.0689   acc: 97.02% -> 98.12%             
client [93] (test)  loss: 0.3343 -> 0.3033   acc: 90.76% -> 92.43%             
client [31] (test)  loss: 0.7277 -> 0.4723   acc: 79.06% -> 84.53%             
client [20] (test)  loss: 0.5405 -> 0.5444   acc: 83.73% -> 84.96%             
client [59] (test)  loss: 0.6355 -> 0.4504   acc: 78.80% -> 83.05%             
client [48] (test)  loss: 0.3970 -> 0.4271   acc: 84.97% -> 84.75%             
client [34] (test)  loss: 0.4311 -> 0.4416   acc: 88.25% -> 87.70%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.2827 -> 0.1973   acc: 89.04% -> 95.45%             
client [99] (test)  loss: 0.5352 -> 0.3737   acc: 81.25% -> 89.76%             
client [67] (test)  loss: 0.4563 -> 0.4056   acc: 84.19% -> 87.43%             
client [0] (test)  loss: 0.1792 -> 0.1731   acc: 94.78% -> 95.11%              
client [76] (test)  loss: 0.4736 -> 0.4334   acc: 85.40% -> 86.72%             
client [41] (test)  loss: 1.0760 -> 0.6243   acc: 65.96% -> 79.88%             
client [62] (test)  loss: 1.4142 -> 0.5409   acc: 70.98% -> 82.18%             
client [2] (test)  loss: 0.2823 -> 0.2099   acc: 91.29% -> 92.62%              
client [14] (test)  loss: 0.3243 -> 0.3119   acc: 91.83% -> 92.07%             
client [46] (test)  loss: 0.3940 -> 0.4285   acc: 87.26% -> 87.17%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.1758 -> 0.1902   acc: 95.30% -> 95.21%             
client [68] (test)  loss: 0.0470 -> 0.0442   acc: 98.85% -> 98.97%             
client [57] (test)  loss: 0.1882 -> 0.2139   acc: 93.97% -> 93.92%             
client [17] (test)  loss: 0.1314 -> 0.1256   acc: 95.63% -> 96.47%             
client [54] (test)  loss: 0.3327 -> 0.4269   acc: 90.95% -> 87.99%             
client [23] (test)  loss: 0.5503 -> 0.3934   acc: 83.23% -> 85.60%             
client [35] (test)  loss: 0.5916 -> 0.5416   acc: 81.93% -> 83.71%             
client [59] (test)  loss: 0.3901 -> 0.4040   acc: 85.57% -> 84.82%             
client [31] (test)  loss: 0.3768 -> 0.4388   acc: 87.47% -> 86.47%             
client [9] (test)  loss: 0.9417 -> 0.7914   acc: 71.79% -> 76.94%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4522 -> 0.5439   acc: 84.33% -> 79.92%             
client [33] (test)  loss: 0.4800 -> 0.5766   acc: 84.06% -> 82.95%             
client [16] (test)  loss: 0.2822 -> 0.3176   acc: 92.15% -> 92.26%             
client [44] (test)  loss: 0.7931 -> 0.7170   acc: 75.79% -> 76.40%             
client [8] (test)  loss: 0.4646 -> 0.5421   acc: 88.02% -> 85.54%              
client [31] (test)  loss: 0.3900 -> 0.4484   acc: 87.55% -> 87.18%             
client [47] (test)  loss: 0.3108 -> 0.3097   acc: 89.29% -> 89.77%             
client [36] (test)  loss: 0.4126 -> 0.4493   acc: 86.76% -> 86.39%             
client [20] (test)  loss: 0.4421 -> 0.5018   acc: 87.80% -> 86.85%             
client [56] (test)  loss: 0.4365 -> 0.4744   acc: 87.23% -> 86.68%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2364 -> 0.2835   acc: 94.00% -> 92.59%              
client [60] (test)  loss: 0.2624 -> 0.2623   acc: 92.94% -> 92.96%             
client [28] (test)  loss: 0.4484 -> 0.4326   acc: 86.78% -> 86.91%             
client [25] (test)  loss: 0.0301 -> 0.0209   acc: 99.30% -> 99.47%             
client [58] (test)  loss: 0.1213 -> 0.1262   acc: 96.73% -> 96.90%             
client [44] (test)  loss: 0.6996 -> 0.7169   acc: 78.61% -> 76.86%             
client [39] (test)  loss: 0.2956 -> 0.3222   acc: 91.40% -> 90.97%             
client [29] (test)  loss: 0.5352 -> 0.5653   acc: 82.63% -> 81.61%             
client [3] (test)  loss: 0.2644 -> 0.2484   acc: 93.04% -> 93.78%              
client [84] (test)  loss: 0.2244 -> 0.2532   acc: 94.02% -> 93.48%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.1085 -> 0.1050   acc: 96.40% -> 96.94%             
client [84] (test)  loss: 0.2150 -> 0.2536   acc: 94.19% -> 93.75%             
client [10] (test)  loss: 0.4224 -> 0.4572   acc: 87.90% -> 87.30%             
client [36] (test)  loss: 0.3788 -> 0.4368   acc: 87.91% -> 87.25%             
client [65] (test)  loss: 0.5587 -> 0.5558   acc: 79.97% -> 82.76%             
client [81] (test)  loss: 0.2746 -> 0.3086   acc: 89.55% -> 88.27%             
client [79] (test)  loss: 0.3252 -> 0.3855   acc: 91.54% -> 90.22%             
client [42] (test)  loss: 0.1594 -> 0.1941   acc: 95.28% -> 95.26%             
client [11] (test)  loss: 0.3261 -> 0.3678   acc: 91.75% -> 90.09%             
client [96] (test)  loss: 0.3271 -> 0.3779   acc: 90.10% -> 88.79%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4779 -> 0.5732   acc: 87.34% -> 86.01%              
client [53] (test)  loss: 0.5231 -> 0.5247   acc: 85.31% -> 85.26%             
client [52] (test)  loss: 0.4587 -> 0.4970   acc: 85.97% -> 85.92%             
client [42] (test)  loss: 0.1629 -> 0.2032   acc: 95.69% -> 95.28%             
client [69] (test)  loss: 0.1720 -> 0.1937   acc: 96.64% -> 95.98%             
client [59] (test)  loss: 0.4043 -> 0.4262   acc: 86.25% -> 86.03%             
client [7] (test)  loss: 0.3014 -> 0.3448   acc: 90.79% -> 89.43%              
client [26] (test)  loss: 0.1678 -> 0.1779   acc: 93.74% -> 93.22%             
client [49] (test)  loss: 0.1228 -> 0.1411   acc: 97.02% -> 96.34%             
client [98] (test)  loss: 0.0899 -> 0.1057   acc: 97.29% -> 96.90%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.0973 -> 0.1049   acc: 97.31% -> 97.07%             
client [47] (test)  loss: 0.3406 -> 0.3158   acc: 89.80% -> 90.11%             
client [21] (test)  loss: 0.1007 -> 0.1080   acc: 96.55% -> 96.87%             
client [77] (test)  loss: 0.5201 -> 0.5794   acc: 85.00% -> 83.57%             
client [95] (test)  loss: 0.0708 -> 0.0680   acc: 98.84% -> 98.77%             
client [91] (test)  loss: 0.4471 -> 0.5154   acc: 87.11% -> 85.96%             
client [14] (test)  loss: 0.2943 -> 0.3047   acc: 93.54% -> 93.30%             
client [99] (test)  loss: 0.3342 -> 0.3898   acc: 91.24% -> 91.36%             
client [20] (test)  loss: 0.4777 -> 0.5570   acc: 88.34% -> 87.07%             
client [39] (test)  loss: 0.2974 -> 0.3343   acc: 91.66% -> 91.45%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4611 -> 0.5295   acc: 86.80% -> 85.95%             
client [62] (test)  loss: 0.5398 -> 0.6249   acc: 86.25% -> 84.38%             
client [71] (test)  loss: 0.5562 -> 0.5728   acc: 83.37% -> 82.51%             
client [97] (test)  loss: 0.1188 -> 0.1404   acc: 96.76% -> 96.02%             
client [30] (test)  loss: 0.2257 -> 0.2610   acc: 93.66% -> 93.20%             
client [88] (test)  loss: 0.3230 -> 0.3442   acc: 89.02% -> 88.32%             
client [60] (test)  loss: 0.2694 -> 0.2994   acc: 93.60% -> 92.89%             
client [82] (test)  loss: 0.4228 -> 0.4741   acc: 87.84% -> 87.25%             
client [91] (test)  loss: 0.4625 -> 0.5339   acc: 86.28% -> 85.98%             
client [57] (test)  loss: 0.1843 -> 0.1949   acc: 94.95% -> 94.83%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4237 -> 0.5296   acc: 88.18% -> 87.52%             
client [15] (test)  loss: 0.5126 -> 0.5779   acc: 87.23% -> 85.88%             
client [71] (test)  loss: 0.5502 -> 0.5847   acc: 83.44% -> 82.27%             
client [97] (test)  loss: 0.1211 -> 0.1479   acc: 96.95% -> 96.21%             
client [53] (test)  loss: 0.5638 -> 0.5759   acc: 85.79% -> 85.36%             
client [77] (test)  loss: 0.5283 -> 0.5448   acc: 84.48% -> 84.15%             
client [76] (test)  loss: 0.4206 -> 0.4851   acc: 89.11% -> 87.59%             
client [79] (test)  loss: 0.3465 -> 0.4129   acc: 91.39% -> 90.37%             
client [28] (test)  loss: 0.4702 -> 0.5066   acc: 87.44% -> 86.78%             
client [99] (test)  loss: 0.3403 -> 0.4145   acc: 91.70% -> 91.02%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1237 -> 0.1504   acc: 96.85% -> 96.50%             
client [86] (test)  loss: 0.2451 -> 0.2575   acc: 94.28% -> 94.01%             
client [34] (test)  loss: 0.3868 -> 0.4715   acc: 90.23% -> 89.47%             
client [73] (test)  loss: 0.6369 -> 0.7355   acc: 83.30% -> 82.10%             
client [5] (test)  loss: 0.4672 -> 0.5450   acc: 88.48% -> 87.95%              
client [96] (test)  loss: 0.3809 -> 0.4702   acc: 89.17% -> 88.58%             
client [22] (test)  loss: 0.6423 -> 0.7237   acc: 83.07% -> 81.87%             
client [60] (test)  loss: 0.2856 -> 0.3240   acc: 93.10% -> 92.89%             
client [66] (test)  loss: 0.3572 -> 0.4035   acc: 90.84% -> 90.13%             
client [83] (test)  loss: 0.1580 -> 0.1447   acc: 95.65% -> 96.17%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4453 -> 0.5231   acc: 88.90% -> 88.05%             
client [65] (test)  loss: 0.5791 -> 0.5851   acc: 83.05% -> 81.81%             
client [95] (test)  loss: 0.0751 -> 0.0739   acc: 98.67% -> 98.77%             
client [17] (test)  loss: 0.1190 -> 0.1223   acc: 96.56% -> 97.01%             
client [8] (test)  loss: 0.5492 -> 0.6339   acc: 87.65% -> 86.57%              
client [35] (test)  loss: 0.6801 -> 0.7089   acc: 85.51% -> 84.24%             
client [98] (test)  loss: 0.1068 -> 0.1114   acc: 97.36% -> 97.33%             
client [53] (test)  loss: 0.5894 -> 0.6198   acc: 85.38% -> 85.07%             
client [43] (test)  loss: 0.2574 -> 0.2845   acc: 94.43% -> 93.94%             
client [64] (test)  loss: 0.5353 -> 0.5602   acc: 84.26% -> 83.08%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1070 -> 0.1164   acc: 96.65% -> 96.84%             
client [88] (test)  loss: 0.3478 -> 0.3927   acc: 89.21% -> 87.79%             
client [38] (test)  loss: 0.0975 -> 0.1075   acc: 98.11% -> 97.99%             
client [3] (test)  loss: 0.2618 -> 0.2989   acc: 94.63% -> 94.34%              
client [5] (test)  loss: 0.5074 -> 0.5663   acc: 88.29% -> 88.09%              
client [41] (test)  loss: 0.6658 -> 0.7286   acc: 82.69% -> 81.78%             
client [7] (test)  loss: 0.3398 -> 0.3908   acc: 91.22% -> 88.92%              
client [37] (test)  loss: 0.4306 -> 0.4795   acc: 89.50% -> 88.73%             
client [45] (test)  loss: 0.6095 -> 0.6100   acc: 84.73% -> 83.13%             
client [47] (test)  loss: 0.3400 -> 0.3385   acc: 89.94% -> 89.87%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3419 -> 0.3923   acc: 92.81% -> 92.76%             
client [11] (test)  loss: 0.3644 -> 0.4168   acc: 91.56% -> 90.99%             
client [37] (test)  loss: 0.4505 -> 0.5274   acc: 89.27% -> 88.48%             
client [41] (test)  loss: 0.6954 -> 0.7606   acc: 82.33% -> 81.32%             
client [95] (test)  loss: 0.0783 -> 0.0762   acc: 98.67% -> 98.86%             
client [53] (test)  loss: 0.6464 -> 0.6308   acc: 85.36% -> 85.04%             
client [22] (test)  loss: 0.7579 -> 0.7698   acc: 82.75% -> 81.78%             
client [25] (test)  loss: 0.0256 -> 0.0196   acc: 99.47% -> 99.58%             
client [69] (test)  loss: 0.2027 -> 0.2234   acc: 96.73% -> 96.22%             
client [46] (test)  loss: 0.3846 -> 0.4470   acc: 90.25% -> 89.23%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4371 -> 0.4145   acc: 89.92% -> 89.85%             
client [69] (test)  loss: 0.2036 -> 0.2394   acc: 96.46% -> 95.60%             
client [82] (test)  loss: 0.5026 -> 0.5447   acc: 87.73% -> 86.99%             
client [45] (test)  loss: 0.6219 -> 0.6701   acc: 85.12% -> 83.77%             
client [7] (test)  loss: 0.3695 -> 0.4083   acc: 89.72% -> 89.36%              
client [50] (test)  loss: 0.4193 -> 0.4525   acc: 89.35% -> 89.11%             
client [35] (test)  loss: 0.6756 -> 0.7652   acc: 85.81% -> 84.43%             
client [24] (test)  loss: 0.2218 -> 0.2365   acc: 96.30% -> 96.61%             
client [15] (test)  loss: 0.5829 -> 0.6413   acc: 87.03% -> 85.99%             
client [58] (test)  loss: 0.1683 -> 0.1837   acc: 96.93% -> 96.90%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4106 -> 0.4288   acc: 88.14% -> 87.67%             
client [76] (test)  loss: 0.5098 -> 0.5493   acc: 88.61% -> 87.98%             
client [67] (test)  loss: 0.4429 -> 0.4465   acc: 89.76% -> 89.54%             
client [37] (test)  loss: 0.4610 -> 0.5564   acc: 89.61% -> 88.69%             
client [58] (test)  loss: 0.1657 -> 0.1937   acc: 96.68% -> 96.93%             
client [64] (test)  loss: 0.5831 -> 0.6313   acc: 83.99% -> 82.69%             
client [77] (test)  loss: 0.6204 -> 0.6371   acc: 84.41% -> 84.48%             
client [55] (test)  loss: 0.5253 -> 0.5550   acc: 86.44% -> 85.44%             
client [12] (test)  loss: 0.6068 -> 0.6845   acc: 86.10% -> 86.37%             
client [89] (test)  loss: 0.7057 -> 0.8649   acc: 84.56% -> 84.07%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.2727 -> 0.3254   acc: 94.46% -> 94.44%             
client [51] (test)  loss: 0.3351 -> 0.3582   acc: 91.89% -> 93.75%             
client [8] (test)  loss: 0.6099 -> 0.7158   acc: 87.47% -> 87.50%              
client [18] (test)  loss: 0.6166 -> 0.6034   acc: 83.86% -> 84.65%             
client [94] (test)  loss: 0.5488 -> 0.5865   acc: 88.52% -> 87.93%             
client [81] (test)  loss: 0.3877 -> 0.4398   acc: 89.65% -> 88.90%             
client [3] (test)  loss: 0.2762 -> 0.3060   acc: 94.73% -> 94.53%              
client [11] (test)  loss: 0.3909 -> 0.4323   acc: 91.58% -> 91.41%             
client [95] (test)  loss: 0.0847 -> 0.0818   acc: 98.67% -> 98.81%             
client [67] (test)  loss: 0.4387 -> 0.4593   acc: 89.90% -> 89.95%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1189 -> 0.1280   acc: 96.75% -> 96.87%             
client [79] (test)  loss: 0.4211 -> 0.5010   acc: 91.45% -> 91.33%             
client [58] (test)  loss: 0.1783 -> 0.2013   acc: 96.93% -> 96.88%             
client [88] (test)  loss: 0.4311 -> 0.4421   acc: 88.95% -> 88.49%             
client [46] (test)  loss: 0.4219 -> 0.4855   acc: 90.15% -> 89.20%             
client [11] (test)  loss: 0.3957 -> 0.4629   acc: 91.41% -> 90.97%             
client [55] (test)  loss: 0.5879 -> 0.6399   acc: 86.71% -> 85.76%             
client [13] (test)  loss: 0.6679 -> 0.7823   acc: 83.32% -> 82.46%             
client [31] (test)  loss: 0.5176 -> 0.5569   acc: 88.26% -> 87.55%             
client [75] (test)  loss: 0.6172 -> 0.6932   acc: 85.85% -> 84.93%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2044 -> 0.2269   acc: 96.32% -> 95.95%             
client [7] (test)  loss: 0.4128 -> 0.4580   acc: 90.16% -> 89.26%              
client [57] (test)  loss: 0.2364 -> 0.2527   acc: 94.16% -> 94.73%             
client [13] (test)  loss: 0.6749 -> 0.7979   acc: 83.11% -> 83.04%             
client [43] (test)  loss: 0.3180 -> 0.3464   acc: 94.27% -> 93.69%             
client [91] (test)  loss: 0.5572 -> 0.6047   acc: 86.64% -> 86.41%             
client [10] (test)  loss: 0.5508 -> 0.6009   acc: 88.22% -> 87.38%             
client [64] (test)  loss: 0.6471 -> 0.7304   acc: 84.16% -> 83.52%             
client [82] (test)  loss: 0.5601 -> 0.6361   acc: 87.45% -> 87.41%             
client [22] (test)  loss: 0.8191 -> 0.8831   acc: 82.41% -> 81.78%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6140 -> 0.6796   acc: 89.03% -> 87.80%             
client [23] (test)  loss: 0.5032 -> 0.4506   acc: 86.52% -> 87.49%             
client [88] (test)  loss: 0.4725 -> 0.4224   acc: 88.88% -> 88.35%             
client [98] (test)  loss: 0.1287 -> 0.1331   acc: 97.55% -> 97.53%             
client [79] (test)  loss: 0.4656 -> 0.5360   acc: 91.24% -> 90.91%             
client [21] (test)  loss: 0.1274 -> 0.1315   acc: 96.60% -> 96.60%             
client [92] (test)  loss: 0.4552 -> 0.4712   acc: 91.46% -> 90.81%             
client [56] (test)  loss: 0.6117 -> 0.7334   acc: 87.01% -> 86.75%             
client [5] (test)  loss: 0.6348 -> 0.6749   acc: 88.71% -> 87.48%              
client [52] (test)  loss: 0.6219 -> 0.6529   acc: 85.77% -> 85.87%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3522 -> 0.0000', 'accuracy': '90.45% -> 0.00%'},          
    200: {'loss': '0.4669 -> 0.0000', 'accuracy': '90.25% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 30.0%(35.96%) at epoch: 1                                      
FedPer achieved 60.0%(61.88%) at epoch: 2                                      
FedPer achieved 70.0%(74.93%) at epoch: 4                                      
FedPer achieved 80.0%(81.43%) at epoch: 7                                      
FedPer achieved 90.0%(92.47%) at epoch: 22                                     
Convergence (test_after):                                                      
FedPer achieved 70.0%(76.27%) at epoch: 0                                      
FedPer achieved 80.0%(83.58%) at epoch: 2                                      
FedPer achieved 90.0%(90.35%) at epoch: 18                                     
