==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8427 -> 0.5719   acc: 64.73% -> 80.19%             
client [81] (test)  loss: 0.2234 -> 0.1615   acc: 95.59% -> 95.81%             
client [21] (test)  loss: 1.9424 -> 1.4587   acc: 37.97% -> 56.95%             
client [68] (test)  loss: 0.4625 -> 0.3235   acc: 85.76% -> 88.67%             
client [93] (test)  loss: 0.7085 -> 0.5112   acc: 85.82% -> 87.31%             
client [31] (test)  loss: 0.7359 -> 0.7422   acc: 73.56% -> 73.22%             
client [20] (test)  loss: 0.8445 -> 0.6581   acc: 71.90% -> 77.69%             
client [59] (test)  loss: 0.6597 -> 0.3182   acc: 84.82% -> 89.44%             
client [48] (test)  loss: 0.5785 -> 0.6284   acc: 79.14% -> 77.81%             
client [34] (test)  loss: 0.6583 -> 0.5094   acc: 81.31% -> 83.28%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4522 -> 0.3703   acc: 85.19% -> 87.75%             
client [99] (test)  loss: 0.3201 -> 0.3752   acc: 90.32% -> 86.29%             
client [67] (test)  loss: 0.4682 -> 0.3403   acc: 84.18% -> 88.61%             
client [0] (test)  loss: 0.3023 -> 0.4462   acc: 89.47% -> 88.04%              
client [76] (test)  loss: 0.3826 -> 0.3842   acc: 82.76% -> 84.48%             
client [41] (test)  loss: 0.8474 -> 0.8570   acc: 66.04% -> 64.39%             
client [62] (test)  loss: 0.2338 -> 0.0655   acc: 93.13% -> 97.25%             
client [2] (test)  loss: 0.8955 -> 0.7977   acc: 67.35% -> 70.41%              
client [14] (test)  loss: 0.2410 -> 0.2652   acc: 92.25% -> 92.25%             
client [46] (test)  loss: 0.4428 -> 0.3894   acc: 85.03% -> 87.43%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3887 -> 0.3977   acc: 86.16% -> 86.61%             
client [68] (test)  loss: 0.1487 -> 0.1309   acc: 95.47% -> 94.50%             
client [57] (test)  loss: 0.1422 -> 0.1876   acc: 94.89% -> 94.09%             
client [17] (test)  loss: 0.1558 -> 0.1658   acc: 94.05% -> 93.68%             
client [54] (test)  loss: 0.1745 -> 0.2084   acc: 94.92% -> 95.56%             
client [23] (test)  loss: 0.5424 -> 0.2915   acc: 83.33% -> 89.90%             
client [35] (test)  loss: 0.4979 -> 0.4303   acc: 79.13% -> 84.17%             
client [59] (test)  loss: 0.1324 -> 0.1294   acc: 95.71% -> 95.38%             
client [31] (test)  loss: 0.2231 -> 0.2152   acc: 91.53% -> 91.53%             
client [9] (test)  loss: 0.3360 -> 0.3727   acc: 88.89% -> 87.50%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2126 -> 0.2354   acc: 91.86% -> 91.86%             
client [33] (test)  loss: 0.2387 -> 0.2740   acc: 93.12% -> 93.65%             
client [16] (test)  loss: 0.2958 -> 0.3496   acc: 89.45% -> 86.33%             
client [44] (test)  loss: 0.0286 -> 0.0342   acc: 99.07% -> 99.07%             
client [8] (test)  loss: 0.1487 -> 0.1518   acc: 95.31% -> 95.31%              
client [31] (test)  loss: 0.1743 -> 0.1715   acc: 93.22% -> 93.22%             
client [47] (test)  loss: 0.1738 -> 0.1990   acc: 96.36% -> 95.36%             
client [36] (test)  loss: 0.1657 -> 0.1097   acc: 95.64% -> 96.88%             
client [20] (test)  loss: 0.2570 -> 0.2944   acc: 90.91% -> 90.08%             
client [56] (test)  loss: 0.1129 -> 0.1435   acc: 96.82% -> 95.76%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2678 -> 0.2504   acc: 93.03% -> 92.62%              
client [60] (test)  loss: 0.0618 -> 0.0570   acc: 97.92% -> 97.92%             
client [28] (test)  loss: 0.0985 -> 0.1161   acc: 96.73% -> 94.77%             
client [25] (test)  loss: 0.2083 -> 0.2148   acc: 93.93% -> 94.39%             
client [58] (test)  loss: 0.0934 -> 0.1144   acc: 96.91% -> 96.60%             
client [44] (test)  loss: 0.0208 -> 0.0230   acc: 99.69% -> 99.07%             
client [39] (test)  loss: 0.1720 -> 0.2141   acc: 94.07% -> 91.10%             
client [29] (test)  loss: 0.1991 -> 0.1485   acc: 95.71% -> 96.04%             
client [3] (test)  loss: 0.1201 -> 0.1416   acc: 97.41% -> 95.79%              
client [84] (test)  loss: 0.3475 -> 0.3372   acc: 87.30% -> 86.97%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4030 -> 0.3585   acc: 89.49% -> 89.49%             
client [84] (test)  loss: 0.2918 -> 0.3110   acc: 88.93% -> 88.60%             
client [10] (test)  loss: 0.0250 -> 0.0272   acc: 99.12% -> 98.45%             
client [36] (test)  loss: 0.0878 -> 0.0875   acc: 97.82% -> 97.51%             
client [65] (test)  loss: 0.2140 -> 0.2394   acc: 94.72% -> 94.72%             
client [81] (test)  loss: 0.0306 -> 0.0348   acc: 99.34% -> 99.12%             
client [79] (test)  loss: 0.0426 -> 0.0471   acc: 99.23% -> 99.23%             
client [42] (test)  loss: 0.1658 -> 0.1411   acc: 93.35% -> 96.33%             
client [11] (test)  loss: 0.1793 -> 0.1900   acc: 93.72% -> 93.29%             
client [96] (test)  loss: 0.1450 -> 0.1429   acc: 95.65% -> 95.97%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0870 -> 0.0841   acc: 97.14% -> 97.14%              
client [53] (test)  loss: 0.1427 -> 0.1772   acc: 93.90% -> 94.19%             
client [52] (test)  loss: 0.1798 -> 0.1470   acc: 92.79% -> 94.10%             
client [42] (test)  loss: 0.2121 -> 0.1318   acc: 91.74% -> 95.87%             
client [69] (test)  loss: 0.1460 -> 0.1631   acc: 95.16% -> 95.44%             
client [59] (test)  loss: 0.0808 -> 0.0784   acc: 97.36% -> 97.36%             
client [7] (test)  loss: 0.0503 -> 0.0728   acc: 98.36% -> 96.72%              
client [26] (test)  loss: 0.0200 -> 0.0216   acc: 99.09% -> 99.09%             
client [49] (test)  loss: 0.2448 -> 0.2936   acc: 91.91% -> 89.79%             
client [98] (test)  loss: 0.2885 -> 0.3183   acc: 89.18% -> 88.01%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2857 -> 0.2948   acc: 91.23% -> 90.94%             
client [47] (test)  loss: 0.1471 -> 0.1128   acc: 96.36% -> 97.68%             
client [21] (test)  loss: 0.3158 -> 0.3002   acc: 90.51% -> 90.17%             
client [77] (test)  loss: 0.1625 -> 0.1542   acc: 95.17% -> 94.69%             
client [95] (test)  loss: 0.1117 -> 0.1152   acc: 96.32% -> 95.96%             
client [91] (test)  loss: 0.1621 -> 0.1669   acc: 93.83% -> 95.15%             
client [14] (test)  loss: 0.1013 -> 0.1421   acc: 96.12% -> 94.57%             
client [99] (test)  loss: 0.1550 -> 0.1619   acc: 94.35% -> 94.35%             
client [20] (test)  loss: 0.2360 -> 0.1931   acc: 93.39% -> 93.39%             
client [39] (test)  loss: 0.1357 -> 0.1390   acc: 95.76% -> 94.49%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1527 -> 0.1205   acc: 93.44% -> 95.74%             
client [62] (test)  loss: 0.0208 -> 0.0193   acc: 99.73% -> 99.73%             
client [71] (test)  loss: 0.2163 -> 0.2263   acc: 95.36% -> 95.88%             
client [97] (test)  loss: 0.1465 -> 0.1506   acc: 96.46% -> 96.70%             
client [30] (test)  loss: 0.0689 -> 0.0765   acc: 98.65% -> 98.31%             
client [88] (test)  loss: 0.1125 -> 0.0914   acc: 96.31% -> 96.77%             
client [60] (test)  loss: 0.0220 -> 0.0222   acc: 99.58% -> 99.58%             
client [82] (test)  loss: 0.3732 -> 0.3663   acc: 89.74% -> 87.75%             
client [91] (test)  loss: 0.1687 -> 0.1676   acc: 93.83% -> 94.71%             
client [57] (test)  loss: 0.0845 -> 0.0874   acc: 97.31% -> 97.31%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0844 -> 0.0806   acc: 96.95% -> 97.29%             
client [15] (test)  loss: 0.0804 -> 0.0781   acc: 97.79% -> 98.01%             
client [71] (test)  loss: 0.2022 -> 0.2330   acc: 96.39% -> 94.33%             
client [97] (test)  loss: 0.1384 -> 0.1459   acc: 96.93% -> 96.70%             
client [53] (test)  loss: 0.1007 -> 0.1167   acc: 96.80% -> 95.64%             
client [77] (test)  loss: 0.1508 -> 0.1443   acc: 95.17% -> 95.65%             
client [76] (test)  loss: 0.1109 -> 0.1328   acc: 96.90% -> 96.90%             
client [79] (test)  loss: 0.0279 -> 0.0333   acc: 99.23% -> 99.23%             
client [28] (test)  loss: 0.0587 -> 0.0586   acc: 97.39% -> 97.39%             
client [99] (test)  loss: 0.1463 -> 0.1586   acc: 95.97% -> 95.16%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1224 -> 0.1237   acc: 96.70% -> 97.17%             
client [86] (test)  loss: 0.1753 -> 0.1858   acc: 93.81% -> 94.33%             
client [34] (test)  loss: 0.0789 -> 0.0719   acc: 96.72% -> 97.05%             
client [73] (test)  loss: 0.0063 -> 0.0090   acc: 99.76% -> 99.76%             
client [5] (test)  loss: 0.0905 -> 0.0885   acc: 97.03% -> 97.40%              
client [96] (test)  loss: 0.1358 -> 0.2993   acc: 97.10% -> 91.47%             
client [22] (test)  loss: 0.0515 -> 0.0742   acc: 99.16% -> 98.33%             
client [60] (test)  loss: 0.0145 -> 0.0149   acc: 100.00% -> 99.58%            
client [66] (test)  loss: 0.1357 -> 0.1543   acc: 95.70% -> 95.70%             
client [83] (test)  loss: 0.0174 -> 0.0216   acc: 99.51% -> 99.26%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1060 -> 0.1348   acc: 97.24% -> 96.90%             
client [65] (test)  loss: 0.1424 -> 0.1455   acc: 96.34% -> 96.34%             
client [95] (test)  loss: 0.0934 -> 0.0994   acc: 97.06% -> 97.79%             
client [17] (test)  loss: 0.0594 -> 0.0893   acc: 97.77% -> 97.03%             
client [8] (test)  loss: 0.0672 -> 0.0696   acc: 97.66% -> 97.66%              
client [35] (test)  loss: 0.2123 -> 0.2481   acc: 94.27% -> 93.81%             
client [98] (test)  loss: 0.2448 -> 0.2334   acc: 91.81% -> 92.69%             
client [53] (test)  loss: 0.1091 -> 0.1145   acc: 96.22% -> 95.93%             
client [43] (test)  loss: 0.0061 -> 0.0075   acc: 100.00% -> 99.75%            
client [64] (test)  loss: 0.1167 -> 0.1317   acc: 95.74% -> 96.12%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2196 -> 0.2335   acc: 93.90% -> 94.58%             
client [88] (test)  loss: 0.0981 -> 0.0844   acc: 97.70% -> 97.70%             
client [38] (test)  loss: 0.0269 -> 0.0266   acc: 99.46% -> 99.46%             
client [3] (test)  loss: 0.0502 -> 0.0756   acc: 99.03% -> 98.06%              
client [5] (test)  loss: 0.0880 -> 0.0935   acc: 97.03% -> 97.40%              
client [41] (test)  loss: 0.1353 -> 0.1346   acc: 94.81% -> 95.52%             
client [7] (test)  loss: 0.0303 -> 0.0338   acc: 99.02% -> 98.69%              
client [37] (test)  loss: 0.0590 -> 0.0647   acc: 98.92% -> 98.56%             
client [45] (test)  loss: 0.1028 -> 0.1268   acc: 96.99% -> 96.99%             
client [47] (test)  loss: 0.1219 -> 0.1216   acc: 97.02% -> 97.35%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1852 -> 0.1817   acc: 93.36% -> 94.14%             
client [11] (test)  loss: 0.1141 -> 0.1121   acc: 97.19% -> 96.97%             
client [37] (test)  loss: 0.0644 -> 0.0668   acc: 98.56% -> 98.20%             
client [41] (test)  loss: 0.1297 -> 0.1378   acc: 95.28% -> 95.28%             
client [95] (test)  loss: 0.1002 -> 0.1018   acc: 96.69% -> 97.79%             
client [53] (test)  loss: 0.1002 -> 0.1069   acc: 96.51% -> 96.22%             
client [22] (test)  loss: 0.0411 -> 0.0595   acc: 99.16% -> 97.91%             
client [25] (test)  loss: 0.1094 -> 0.1419   acc: 96.73% -> 96.73%             
client [69] (test)  loss: 0.1344 -> 0.1361   acc: 96.58% -> 96.58%             
client [46] (test)  loss: 0.1810 -> 0.1961   acc: 95.81% -> 94.01%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1113 -> 0.1108   acc: 98.34% -> 98.01%             
client [69] (test)  loss: 0.1535 -> 0.1497   acc: 96.01% -> 96.58%             
client [82] (test)  loss: 0.3776 -> 0.3492   acc: 91.39% -> 91.06%             
client [45] (test)  loss: 0.1201 -> 0.1055   acc: 96.32% -> 96.99%             
client [7] (test)  loss: 0.0288 -> 0.0346   acc: 99.02% -> 98.69%              
client [50] (test)  loss: 0.1038 -> 0.1350   acc: 97.32% -> 97.11%             
client [35] (test)  loss: 0.2276 -> 0.2347   acc: 94.95% -> 94.50%             
client [24] (test)  loss: 0.1690 -> 0.1994   acc: 94.64% -> 93.30%             
client [15] (test)  loss: 0.0671 -> 0.0656   acc: 98.45% -> 98.45%             
client [58] (test)  loss: 0.0778 -> 0.0683   acc: 97.53% -> 97.53%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0990 -> 0.1067   acc: 96.79% -> 97.06%             
client [76] (test)  loss: 0.1064 -> 0.1197   acc: 97.59% -> 97.24%             
client [67] (test)  loss: 0.1392 -> 0.1631   acc: 95.57% -> 95.25%             
client [37] (test)  loss: 0.0668 -> 0.0700   acc: 98.56% -> 98.20%             
client [58] (test)  loss: 0.0662 -> 0.0648   acc: 97.84% -> 97.84%             
client [64] (test)  loss: 0.1004 -> 0.1096   acc: 96.90% -> 96.51%             
client [77] (test)  loss: 0.1335 -> 0.1240   acc: 96.14% -> 96.14%             
client [55] (test)  loss: 0.0377 -> 0.0368   acc: 98.69% -> 98.96%             
client [12] (test)  loss: 0.1367 -> 0.1587   acc: 95.92% -> 95.24%             
client [89] (test)  loss: 0.1212 -> 0.1142   acc: 97.00% -> 97.00%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.2408 -> 0.2019   acc: 92.51% -> 93.81%             
client [51] (test)  loss: 0.0954 -> 0.0977   acc: 96.60% -> 96.91%             
client [8] (test)  loss: 0.0536 -> 0.0547   acc: 98.44% -> 98.44%              
client [18] (test)  loss: 0.0924 -> 0.1029   acc: 97.27% -> 96.97%             
client [94] (test)  loss: 0.0169 -> 0.0112   acc: 99.02% -> 100.00%            
client [81] (test)  loss: 0.0098 -> 0.0161   acc: 99.78% -> 99.34%             
client [3] (test)  loss: 0.0548 -> 0.0687   acc: 98.71% -> 98.06%              
client [11] (test)  loss: 0.1075 -> 0.1271   acc: 96.97% -> 97.40%             
client [95] (test)  loss: 0.0964 -> 0.0998   acc: 97.79% -> 97.79%             
client [67] (test)  loss: 0.1417 -> 0.1544   acc: 95.57% -> 95.25%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1922 -> 0.2113   acc: 94.24% -> 94.92%             
client [79] (test)  loss: 0.0308 -> 0.0365   acc: 99.23% -> 99.23%             
client [58] (test)  loss: 0.0636 -> 0.0581   acc: 97.84% -> 97.84%             
client [88] (test)  loss: 0.0955 -> 0.0812   acc: 97.70% -> 97.24%             
client [46] (test)  loss: 0.1762 -> 0.1869   acc: 95.81% -> 95.21%             
client [11] (test)  loss: 0.1102 -> 0.1251   acc: 97.40% -> 97.40%             
client [55] (test)  loss: 0.0358 -> 0.0365   acc: 98.96% -> 99.22%             
client [13] (test)  loss: 0.0512 -> 0.0695   acc: 98.74% -> 98.49%             
client [31] (test)  loss: 0.0556 -> 0.0623   acc: 98.31% -> 97.29%             
client [75] (test)  loss: 0.0087 -> 0.0113   acc: 99.53% -> 99.53%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0913 -> 0.1082   acc: 97.38% -> 95.63%             
client [7] (test)  loss: 0.0426 -> 0.0323   acc: 98.69% -> 99.02%              
client [57] (test)  loss: 0.0728 -> 0.0846   acc: 97.85% -> 97.31%             
client [13] (test)  loss: 0.0521 -> 0.0692   acc: 98.74% -> 98.49%             
client [43] (test)  loss: 0.0031 -> 0.0029   acc: 100.00% -> 100.00%           
client [91] (test)  loss: 0.1662 -> 0.1742   acc: 96.48% -> 95.15%             
client [10] (test)  loss: 0.0219 -> 0.0226   acc: 99.56% -> 99.12%             
client [64] (test)  loss: 0.0964 -> 0.1068   acc: 96.90% -> 96.51%             
client [82] (test)  loss: 0.3761 -> 0.3240   acc: 91.06% -> 92.38%             
client [22] (test)  loss: 0.0306 -> 0.0454   acc: 99.16% -> 98.33%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1337 -> 0.0806   acc: 95.87% -> 97.52%             
client [23] (test)  loss: 0.1119 -> 0.0965   acc: 96.46% -> 97.98%             
client [88] (test)  loss: 0.1182 -> 0.0925   acc: 97.70% -> 97.24%             
client [98] (test)  loss: 0.2375 -> 0.2464   acc: 92.98% -> 92.98%             
client [79] (test)  loss: 0.0354 -> 0.0358   acc: 99.23% -> 99.23%             
client [21] (test)  loss: 0.1713 -> 0.2235   acc: 94.24% -> 95.25%             
client [92] (test)  loss: 0.2061 -> 0.2061   acc: 95.43% -> 95.43%             
client [56] (test)  loss: 0.0695 -> 0.0703   acc: 97.88% -> 98.41%             
client [5] (test)  loss: 0.1012 -> 0.0852   acc: 97.03% -> 97.77%              
client [52] (test)  loss: 0.1384 -> 0.1041   acc: 95.74% -> 97.05%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.1222 -> 0.0000', 'accuracy': '96.25% -> 0.00%'},          
    200: {'loss': '0.1026 -> 0.0000', 'accuracy': '97.17% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 20.0%(20.53%) at epoch: 0                                      
FedPer achieved 40.0%(44.34%) at epoch: 3                                      
FedPer achieved 50.0%(56.48%) at epoch: 4                                      
FedPer achieved 60.0%(69.08%) at epoch: 7                                      
FedPer achieved 70.0%(77.79%) at epoch: 9                                      
FedPer achieved 80.0%(82.25%) at epoch: 15                                     
FedPer achieved 90.0%(91.88%) at epoch: 20                                     
Convergence (test_after):                                                      
FedPer achieved 40.0%(48.36%) at epoch: 0                                      
FedPer achieved 50.0%(53.69%) at epoch: 1                                      
FedPer achieved 70.0%(71.15%) at epoch: 3                                      
FedPer achieved 80.0%(81.99%) at epoch: 9                                      
FedPer achieved 90.0%(92.86%) at epoch: 20                                     
