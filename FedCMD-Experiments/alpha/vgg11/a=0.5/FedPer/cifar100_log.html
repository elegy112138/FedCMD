==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.7237 -> 4.2889   acc: 18.36% -> 25.90%             
client [81] (test)  loss: 3.6774 -> 3.9970   acc: 24.01% -> 32.24%             
client [21] (test)  loss: 4.6636 -> 4.0250   acc: 12.89% -> 24.39%             
client [68] (test)  loss: 4.0411 -> 4.1348   acc: 18.54% -> 27.36%             
client [93] (test)  loss: 3.7494 -> 3.8289   acc: 18.57% -> 30.62%             
client [31] (test)  loss: 4.2933 -> 4.2083   acc: 14.18% -> 21.45%             
client [20] (test)  loss: 3.3785 -> 4.1940   acc: 25.52% -> 26.21%             
client [59] (test)  loss: 4.1873 -> 4.2043   acc: 16.18% -> 20.06%             
client [48] (test)  loss: 4.0207 -> 4.8210   acc: 18.03% -> 18.03%             
client [34] (test)  loss: 3.7203 -> 4.0035   acc: 18.82% -> 23.99%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.5634 -> 3.9524   acc: 27.34% -> 32.37%             
client [99] (test)  loss: 3.6486 -> 4.0205   acc: 29.81% -> 30.77%             
client [67] (test)  loss: 3.1607 -> 3.5772   acc: 28.34% -> 32.90%             
client [0] (test)  loss: 2.8078 -> 3.4605   acc: 36.33% -> 39.33%              
client [76] (test)  loss: 3.8309 -> 4.4648   acc: 23.48% -> 23.11%             
client [41] (test)  loss: 3.8107 -> 3.8486   acc: 23.26% -> 31.56%             
client [62] (test)  loss: 4.2407 -> 3.7323   acc: 16.83% -> 30.36%             
client [2] (test)  loss: 3.8592 -> 3.3482   acc: 26.16% -> 34.77%              
client [14] (test)  loss: 3.3849 -> 4.1535   acc: 29.07% -> 31.31%             
client [46] (test)  loss: 4.1053 -> 4.7742   acc: 21.93% -> 24.25%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4596 -> 3.8530   acc: 29.51% -> 31.94%             
client [68] (test)  loss: 3.0456 -> 3.4890   acc: 38.91% -> 39.21%             
client [57] (test)  loss: 3.1318 -> 3.2850   acc: 35.92% -> 36.89%             
client [17] (test)  loss: 3.6084 -> 3.8501   acc: 33.92% -> 30.70%             
client [54] (test)  loss: 3.3726 -> 3.7278   acc: 32.48% -> 34.41%             
client [23] (test)  loss: 4.1731 -> 4.0341   acc: 25.33% -> 31.00%             
client [35] (test)  loss: 3.5693 -> 4.1372   acc: 31.15% -> 31.15%             
client [59] (test)  loss: 2.9982 -> 3.5024   acc: 39.16% -> 40.13%             
client [31] (test)  loss: 3.6007 -> 4.1514   acc: 32.00% -> 34.18%             
client [9] (test)  loss: 3.4641 -> 4.1711   acc: 33.22% -> 31.27%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.2863 -> 3.5410   acc: 42.52% -> 38.21%             
client [33] (test)  loss: 3.0917 -> 3.6250   acc: 42.66% -> 40.27%             
client [16] (test)  loss: 2.7818 -> 2.6541   acc: 45.00% -> 52.89%             
client [44] (test)  loss: 3.2585 -> 3.1379   acc: 32.01% -> 38.28%             
client [8] (test)  loss: 3.6866 -> 4.1948   acc: 35.24% -> 36.51%              
client [31] (test)  loss: 3.7402 -> 4.0153   acc: 33.45% -> 35.64%             
client [47] (test)  loss: 3.4709 -> 4.0176   acc: 35.00% -> 34.38%             
client [36] (test)  loss: 3.4754 -> 3.6068   acc: 30.42% -> 34.17%             
client [20] (test)  loss: 2.9589 -> 3.4629   acc: 43.79% -> 39.31%             
client [56] (test)  loss: 3.4837 -> 3.7596   acc: 29.72% -> 32.87%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.0233 -> 3.5563   acc: 40.29% -> 39.93%              
client [60] (test)  loss: 3.2266 -> 3.3680   acc: 32.22% -> 34.07%             
client [28] (test)  loss: 3.3023 -> 3.6900   acc: 38.71% -> 36.77%             
client [25] (test)  loss: 3.0097 -> 3.1027   acc: 42.07% -> 44.66%             
client [58] (test)  loss: 3.0096 -> 3.3387   acc: 42.77% -> 42.77%             
client [44] (test)  loss: 2.9967 -> 3.0621   acc: 36.30% -> 43.23%             
client [39] (test)  loss: 3.9249 -> 4.4490   acc: 28.38% -> 31.68%             
client [29] (test)  loss: 2.9470 -> 3.4424   acc: 44.85% -> 44.19%             
client [3] (test)  loss: 3.2831 -> 3.1886   acc: 40.45% -> 44.98%              
client [84] (test)  loss: 3.2522 -> 3.8606   acc: 35.83% -> 34.27%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.1796 -> 3.3995   acc: 37.63% -> 44.25%             
client [84] (test)  loss: 3.3096 -> 3.8551   acc: 37.38% -> 36.45%             
client [10] (test)  loss: 2.7843 -> 2.9988   acc: 46.89% -> 45.57%             
client [36] (test)  loss: 3.1962 -> 3.7098   acc: 36.25% -> 37.50%             
client [65] (test)  loss: 2.6308 -> 3.1185   acc: 45.63% -> 45.95%             
client [81] (test)  loss: 3.0792 -> 3.5101   acc: 43.42% -> 43.75%             
client [79] (test)  loss: 3.0522 -> 3.5016   acc: 43.52% -> 39.87%             
client [42] (test)  loss: 3.2723 -> 3.8081   acc: 40.14% -> 36.05%             
client [11] (test)  loss: 3.0956 -> 3.3472   acc: 41.75% -> 39.30%             
client [96] (test)  loss: 3.2994 -> 3.9773   acc: 42.07% -> 37.86%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.6362 -> 4.1626   acc: 40.32% -> 35.56%              
client [53] (test)  loss: 3.5907 -> 3.8004   acc: 35.53% -> 32.89%             
client [52] (test)  loss: 3.4086 -> 3.7920   acc: 41.42% -> 37.86%             
client [42] (test)  loss: 3.3031 -> 3.9034   acc: 42.52% -> 37.41%             
client [69] (test)  loss: 3.4942 -> 4.1224   acc: 41.73% -> 41.01%             
client [59] (test)  loss: 2.8597 -> 3.2801   acc: 45.95% -> 46.28%             
client [7] (test)  loss: 3.4240 -> 3.8533   acc: 42.49% -> 38.98%              
client [26] (test)  loss: 3.2417 -> 3.6681   acc: 40.86% -> 41.20%             
client [49] (test)  loss: 3.2241 -> 3.6278   acc: 33.06% -> 35.48%             
client [98] (test)  loss: 3.2300 -> 3.7494   acc: 40.39% -> 37.79%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.4384 -> 3.9807   acc: 40.07% -> 38.76%             
client [47] (test)  loss: 3.5508 -> 3.8842   acc: 43.12% -> 40.31%             
client [21] (test)  loss: 3.2004 -> 3.5295   acc: 42.86% -> 44.95%             
client [77] (test)  loss: 3.3945 -> 3.5648   acc: 39.67% -> 38.69%             
client [95] (test)  loss: 3.2669 -> 3.8802   acc: 37.95% -> 36.30%             
client [91] (test)  loss: 3.3368 -> 3.9250   acc: 39.74% -> 35.58%             
client [14] (test)  loss: 3.7337 -> 4.1201   acc: 38.02% -> 38.02%             
client [99] (test)  loss: 3.5528 -> 3.9538   acc: 39.74% -> 35.90%             
client [20] (test)  loss: 3.1131 -> 3.4412   acc: 45.86% -> 45.17%             
client [39] (test)  loss: 4.1374 -> 4.4302   acc: 30.69% -> 30.36%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.5358 -> 3.9484   acc: 42.72% -> 36.89%             
client [62] (test)  loss: 3.4417 -> 3.9359   acc: 40.59% -> 39.27%             
client [71] (test)  loss: 3.6825 -> 4.0174   acc: 41.55% -> 39.19%             
client [97] (test)  loss: 3.2371 -> 3.4290   acc: 46.13% -> 42.72%             
client [30] (test)  loss: 3.0099 -> 3.3212   acc: 44.00% -> 44.00%             
client [88] (test)  loss: 2.8741 -> 3.0710   acc: 40.07% -> 46.10%             
client [60] (test)  loss: 3.4007 -> 3.6287   acc: 39.63% -> 34.07%             
client [82] (test)  loss: 3.1855 -> 3.4633   acc: 43.34% -> 41.98%             
client [91] (test)  loss: 3.3363 -> 3.9320   acc: 42.31% -> 38.78%             
client [57] (test)  loss: 2.9227 -> 3.1347   acc: 44.34% -> 43.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.1832 -> 4.4033   acc: 38.91% -> 36.00%             
client [15] (test)  loss: 3.0409 -> 3.4072   acc: 41.25% -> 36.96%             
client [71] (test)  loss: 3.9018 -> 4.1504   acc: 41.89% -> 41.22%             
client [97] (test)  loss: 3.4214 -> 3.6219   acc: 46.75% -> 45.51%             
client [53] (test)  loss: 4.0235 -> 4.1453   acc: 34.54% -> 33.88%             
client [77] (test)  loss: 3.5147 -> 3.7735   acc: 40.66% -> 37.70%             
client [76] (test)  loss: 4.0538 -> 4.3062   acc: 36.36% -> 34.47%             
client [79] (test)  loss: 3.2900 -> 3.5820   acc: 44.85% -> 42.86%             
client [28] (test)  loss: 3.3838 -> 3.8152   acc: 44.52% -> 43.55%             
client [99] (test)  loss: 3.6902 -> 3.9240   acc: 38.46% -> 38.78%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.4773 -> 3.6608   acc: 47.37% -> 46.75%             
client [86] (test)  loss: 3.7671 -> 4.1521   acc: 41.88% -> 39.61%             
client [34] (test)  loss: 3.5050 -> 3.8918   acc: 40.22% -> 38.01%             
client [73] (test)  loss: 3.6699 -> 3.9713   acc: 41.10% -> 41.42%             
client [5] (test)  loss: 3.7169 -> 4.2364   acc: 40.07% -> 39.07%              
client [96] (test)  loss: 3.7174 -> 4.4517   acc: 44.01% -> 41.42%             
client [22] (test)  loss: 3.7489 -> 4.3032   acc: 37.75% -> 35.10%             
client [60] (test)  loss: 3.5899 -> 3.9075   acc: 37.78% -> 35.56%             
client [66] (test)  loss: 3.8557 -> 4.0046   acc: 33.89% -> 32.56%             
client [83] (test)  loss: 3.9441 -> 4.2280   acc: 36.86% -> 33.11%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.2356 -> 4.5719   acc: 36.36% -> 36.74%             
client [65] (test)  loss: 2.9988 -> 3.4945   acc: 47.25% -> 45.31%             
client [95] (test)  loss: 3.6723 -> 4.2517   acc: 39.27% -> 38.28%             
client [17] (test)  loss: 3.7564 -> 4.0268   acc: 42.40% -> 38.30%             
client [8] (test)  loss: 4.3131 -> 4.7100   acc: 41.27% -> 38.41%              
client [35] (test)  loss: 4.1203 -> 4.9173   acc: 37.70% -> 35.08%             
client [98] (test)  loss: 3.7534 -> 4.1339   acc: 42.67% -> 40.39%             
client [53] (test)  loss: 4.1921 -> 4.1917   acc: 37.17% -> 36.84%             
client [43] (test)  loss: 3.8175 -> 4.0166   acc: 37.95% -> 38.61%             
client [64] (test)  loss: 3.5461 -> 4.0238   acc: 45.85% -> 43.52%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.5962 -> 3.9953   acc: 44.95% -> 42.86%             
client [88] (test)  loss: 3.5185 -> 3.5259   acc: 42.55% -> 45.39%             
client [38] (test)  loss: 3.2515 -> 3.4183   acc: 53.11% -> 52.46%             
client [3] (test)  loss: 3.8472 -> 4.0770   acc: 45.95% -> 47.57%              
client [5] (test)  loss: 4.0977 -> 4.3610   acc: 39.07% -> 39.74%              
client [41] (test)  loss: 3.6094 -> 4.5070   acc: 43.85% -> 37.87%             
client [7] (test)  loss: 4.1141 -> 4.3646   acc: 40.26% -> 39.94%              
client [37] (test)  loss: 3.8580 -> 4.1889   acc: 44.88% -> 45.21%             
client [45] (test)  loss: 3.3205 -> 3.5358   acc: 46.84% -> 41.20%             
client [47] (test)  loss: 4.0056 -> 4.1159   acc: 44.38% -> 42.50%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.1124 -> 3.0536   acc: 55.00% -> 55.26%             
client [11] (test)  loss: 3.8347 -> 3.8366   acc: 43.86% -> 43.16%             
client [37] (test)  loss: 3.8591 -> 4.0483   acc: 44.55% -> 44.88%             
client [41] (test)  loss: 3.7445 -> 4.0868   acc: 41.86% -> 42.52%             
client [95] (test)  loss: 4.0667 -> 4.3670   acc: 39.93% -> 39.93%             
client [53] (test)  loss: 4.6636 -> 4.4263   acc: 35.20% -> 38.16%             
client [22] (test)  loss: 4.0737 -> 4.5860   acc: 41.06% -> 36.75%             
client [25] (test)  loss: 3.5025 -> 3.6816   acc: 50.81% -> 46.93%             
client [69] (test)  loss: 4.4268 -> 4.5350   acc: 45.32% -> 44.24%             
client [46] (test)  loss: 5.0650 -> 5.3765   acc: 34.22% -> 33.22%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.3572 -> 4.6400   acc: 44.06% -> 44.69%             
client [69] (test)  loss: 4.7244 -> 4.7657   acc: 44.96% -> 44.60%             
client [82] (test)  loss: 4.0662 -> 4.3163   acc: 43.00% -> 42.32%             
client [45] (test)  loss: 3.5772 -> 4.0570   acc: 48.17% -> 42.86%             
client [7] (test)  loss: 4.3837 -> 4.5681   acc: 40.89% -> 38.98%              
client [50] (test)  loss: 4.3909 -> 4.5365   acc: 45.51% -> 40.20%             
client [35] (test)  loss: 4.6961 -> 5.1964   acc: 37.70% -> 39.02%             
client [24] (test)  loss: 4.6087 -> 4.8870   acc: 39.58% -> 36.11%             
client [15] (test)  loss: 3.6863 -> 3.7787   acc: 42.24% -> 38.61%             
client [58] (test)  loss: 3.9253 -> 4.1404   acc: 46.54% -> 47.80%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.7498 -> 5.0175   acc: 40.33% -> 36.72%             
client [76] (test)  loss: 5.0330 -> 5.0611   acc: 35.61% -> 34.85%             
client [67] (test)  loss: 3.8601 -> 3.9964   acc: 44.95% -> 45.28%             
client [37] (test)  loss: 4.0802 -> 4.2520   acc: 44.55% -> 45.87%             
client [58] (test)  loss: 4.0151 -> 4.1392   acc: 46.23% -> 47.17%             
client [64] (test)  loss: 4.0750 -> 4.1731   acc: 43.52% -> 44.19%             
client [77] (test)  loss: 4.3940 -> 4.4503   acc: 40.33% -> 37.70%             
client [55] (test)  loss: 4.7373 -> 5.0659   acc: 38.30% -> 36.88%             
client [12] (test)  loss: 4.8174 -> 4.9152   acc: 34.55% -> 33.22%             
client [89] (test)  loss: 4.1086 -> 4.3241   acc: 41.16% -> 42.12%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.4292 -> 4.7909   acc: 38.94% -> 39.56%             
client [51] (test)  loss: 3.6114 -> 4.0083   acc: 48.84% -> 48.17%             
client [8] (test)  loss: 4.9701 -> 5.2236   acc: 42.22% -> 40.63%              
client [18] (test)  loss: 4.0017 -> 4.0036   acc: 45.90% -> 45.25%             
client [94] (test)  loss: 4.5832 -> 4.3380   acc: 42.76% -> 42.76%             
client [81] (test)  loss: 4.1675 -> 4.4668   acc: 49.67% -> 48.68%             
client [3] (test)  loss: 4.2481 -> 4.4852   acc: 47.90% -> 48.54%              
client [11] (test)  loss: 4.3345 -> 4.3370   acc: 43.86% -> 44.21%             
client [95] (test)  loss: 4.4972 -> 4.6895   acc: 40.92% -> 39.93%             
client [67] (test)  loss: 4.0361 -> 4.1849   acc: 45.28% -> 44.95%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.1604 -> 4.5116   acc: 44.95% -> 42.86%             
client [79] (test)  loss: 4.1726 -> 4.1767   acc: 45.85% -> 46.51%             
client [58] (test)  loss: 4.2079 -> 4.3276   acc: 46.23% -> 47.17%             
client [88] (test)  loss: 4.1133 -> 4.1573   acc: 42.91% -> 41.49%             
client [46] (test)  loss: 5.8049 -> 5.7900   acc: 33.89% -> 33.89%             
client [11] (test)  loss: 4.3972 -> 4.5095   acc: 44.56% -> 41.40%             
client [55] (test)  loss: 4.9838 -> 5.1680   acc: 37.23% -> 39.01%             
client [13] (test)  loss: 4.3588 -> 4.4948   acc: 45.99% -> 44.60%             
client [31] (test)  loss: 5.2087 -> 5.3653   acc: 40.73% -> 39.64%             
client [75] (test)  loss: 4.4372 -> 4.5317   acc: 41.79% -> 40.60%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.3874 -> 4.5083   acc: 39.74% -> 36.48%             
client [7] (test)  loss: 5.1578 -> 5.2360   acc: 41.53% -> 41.85%              
client [57] (test)  loss: 4.1455 -> 4.3163   acc: 45.95% -> 45.95%             
client [13] (test)  loss: 4.4266 -> 4.5850   acc: 45.99% -> 48.08%             
client [43] (test)  loss: 4.6752 -> 4.8726   acc: 40.26% -> 38.28%             
client [91] (test)  loss: 4.7092 -> 4.8046   acc: 42.95% -> 36.54%             
client [10] (test)  loss: 4.0412 -> 4.1078   acc: 48.20% -> 46.56%             
client [64] (test)  loss: 4.3036 -> 4.4548   acc: 44.52% -> 44.52%             
client [82] (test)  loss: 4.4240 -> 4.5994   acc: 44.37% -> 44.37%             
client [22] (test)  loss: 4.8972 -> 5.1671   acc: 41.39% -> 40.73%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.3167 -> 4.5959   acc: 49.31% -> 47.93%             
client [23] (test)  loss: 5.4030 -> 4.9718   acc: 39.00% -> 36.33%             
client [88] (test)  loss: 4.4536 -> 4.4748   acc: 42.20% -> 44.33%             
client [98] (test)  loss: 4.7419 -> 4.8826   acc: 44.63% -> 43.97%             
client [79] (test)  loss: 4.5494 -> 4.5140   acc: 45.18% -> 46.84%             
client [21] (test)  loss: 4.4538 -> 4.5141   acc: 44.25% -> 43.90%             
client [92] (test)  loss: 5.0903 -> 5.4924   acc: 39.00% -> 34.33%             
client [56] (test)  loss: 5.3203 -> 5.3971   acc: 33.92% -> 33.22%             
client [5] (test)  loss: 5.0023 -> 5.1163   acc: 40.73% -> 39.07%              
client [52] (test)  loss: 5.1231 -> 5.2743   acc: 43.04% -> 44.34%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.4905 -> 0.0000', 'accuracy': '41.94% -> 0.00%'},          
    200: {'loss': '4.8020 -> 0.0000', 'accuracy': '43.34% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(10.75%) at epoch: 6                                      
FedPer achieved 20.0%(21.67%) at epoch: 13                                     
FedPer achieved 30.0%(30.74%) at epoch: 22                                     
FedPer achieved 40.0%(41.59%) at epoch: 59                                     
Convergence (test_after):                                                      
FedPer achieved 10.0%(14.82%) at epoch: 0                                      
FedPer achieved 20.0%(20.80%) at epoch: 5                                      
FedPer achieved 30.0%(31.94%) at epoch: 17                                     
FedPer achieved 40.0%(40.71%) at epoch: 59                                     
