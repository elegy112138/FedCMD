==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7153 -> 1.1189   acc: 74.56% -> 69.77%             
client [81] (test)  loss: 0.7871 -> 0.6717   acc: 77.61% -> 79.85%             
client [21] (test)  loss: 1.2422 -> 0.9840   acc: 59.09% -> 62.12%             
client [68] (test)  loss: 1.1763 -> 1.0301   acc: 69.02% -> 68.14%             
client [93] (test)  loss: 1.1585 -> 1.0984   acc: 47.80% -> 65.89%             
client [31] (test)  loss: 1.6376 -> 1.4449   acc: 31.01% -> 51.40%             
client [20] (test)  loss: 0.5188 -> 0.6082   acc: 81.53% -> 70.71%             
client [59] (test)  loss: 1.5890 -> 0.6937   acc: 47.60% -> 82.97%             
client [48] (test)  loss: 0.9613 -> 0.9064   acc: 65.71% -> 65.71%             
client [34] (test)  loss: 0.7547 -> 1.3818   acc: 76.08% -> 62.34%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.0230 -> 0.6598   acc: 63.69% -> 79.46%             
client [99] (test)  loss: 0.6400 -> 1.2227   acc: 82.22% -> 57.41%             
client [67] (test)  loss: 0.5039 -> 0.4332   acc: 85.11% -> 82.49%             
client [0] (test)  loss: 0.7402 -> 0.8627   acc: 76.03% -> 70.81%              
client [76] (test)  loss: 0.5392 -> 0.6109   acc: 78.79% -> 73.67%             
client [41] (test)  loss: 0.2738 -> 0.3600   acc: 92.78% -> 86.94%             
client [62] (test)  loss: 1.4518 -> 0.3646   acc: 43.90% -> 88.85%             
client [2] (test)  loss: 1.1724 -> 0.7151   acc: 63.41% -> 78.23%              
client [14] (test)  loss: 0.6297 -> 1.0251   acc: 77.38% -> 55.59%             
client [46] (test)  loss: 0.5462 -> 0.6850   acc: 76.53% -> 68.53%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7538 -> 0.7373   acc: 67.29% -> 69.15%             
client [68] (test)  loss: 0.7040 -> 0.8274   acc: 70.19% -> 69.75%             
client [57] (test)  loss: 0.1874 -> 0.8130   acc: 94.17% -> 54.72%             
client [17] (test)  loss: 0.4873 -> 0.4574   acc: 83.28% -> 84.50%             
client [54] (test)  loss: 0.6469 -> 0.7408   acc: 76.68% -> 72.92%             
client [23] (test)  loss: 1.7598 -> 0.3918   acc: 29.38% -> 86.25%             
client [35] (test)  loss: 0.4265 -> 1.6250   acc: 86.05% -> 49.10%             
client [59] (test)  loss: 0.3744 -> 0.4410   acc: 91.27% -> 87.34%             
client [31] (test)  loss: 0.5709 -> 0.7632   acc: 78.21% -> 75.70%             
client [9] (test)  loss: 0.2273 -> 0.1743   acc: 91.48% -> 93.91%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2585 -> 0.2707   acc: 91.14% -> 90.57%             
client [33] (test)  loss: 0.1436 -> 0.1410   acc: 96.21% -> 96.46%             
client [16] (test)  loss: 0.2619 -> 0.3244   acc: 93.09% -> 92.79%             
client [44] (test)  loss: 1.6926 -> 0.5955   acc: 66.49% -> 78.35%             
client [8] (test)  loss: 0.4898 -> 1.3639   acc: 85.15% -> 73.36%              
client [31] (test)  loss: 0.5049 -> 0.9746   acc: 83.80% -> 72.35%             
client [47] (test)  loss: 0.3164 -> 0.5414   acc: 90.11% -> 82.86%             
client [36] (test)  loss: 0.1915 -> 0.1989   acc: 94.42% -> 93.85%             
client [20] (test)  loss: 0.1998 -> 0.5197   acc: 92.08% -> 78.10%             
client [56] (test)  loss: 0.5773 -> 0.5953   acc: 77.09% -> 79.31%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5794 -> 0.5958   acc: 73.44% -> 74.61%              
client [60] (test)  loss: 0.3468 -> 0.3044   acc: 88.79% -> 89.09%             
client [28] (test)  loss: 0.2329 -> 0.2687   acc: 90.99% -> 88.73%             
client [25] (test)  loss: 0.4871 -> 0.5772   acc: 80.94% -> 78.66%             
client [58] (test)  loss: 0.6324 -> 0.7237   acc: 76.10% -> 71.15%             
client [44] (test)  loss: 0.3635 -> 1.2362   acc: 82.73% -> 74.23%             
client [39] (test)  loss: 0.3832 -> 0.7222   acc: 84.50% -> 78.12%             
client [29] (test)  loss: 0.5372 -> 0.5181   acc: 80.84% -> 80.31%             
client [3] (test)  loss: 0.3526 -> 0.7018   acc: 88.58% -> 78.17%              
client [84] (test)  loss: 0.3113 -> 0.3405   acc: 90.49% -> 88.59%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4412 -> 0.4364   acc: 83.64% -> 83.94%             
client [84] (test)  loss: 0.3078 -> 0.3257   acc: 90.49% -> 89.16%             
client [10] (test)  loss: 0.3168 -> 0.3238   acc: 88.92% -> 89.56%             
client [36] (test)  loss: 0.1448 -> 0.1569   acc: 96.15% -> 95.96%             
client [65] (test)  loss: 0.3733 -> 0.4250   acc: 84.42% -> 84.74%             
client [81] (test)  loss: 0.2773 -> 0.4259   acc: 93.28% -> 86.57%             
client [79] (test)  loss: 0.5627 -> 0.6089   acc: 75.79% -> 73.78%             
client [42] (test)  loss: 0.3869 -> 0.4166   acc: 84.78% -> 84.54%             
client [11] (test)  loss: 0.2500 -> 0.4808   acc: 92.10% -> 83.97%             
client [96] (test)  loss: 0.6455 -> 0.6947   acc: 78.04% -> 74.60%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4076 -> 0.6251   acc: 91.27% -> 81.66%              
client [53] (test)  loss: 0.4369 -> 0.5959   acc: 82.06% -> 74.42%             
client [52] (test)  loss: 0.3414 -> 0.3507   acc: 89.77% -> 90.35%             
client [42] (test)  loss: 0.3589 -> 0.4037   acc: 86.47% -> 85.27%             
client [69] (test)  loss: 0.3966 -> 0.4760   acc: 84.52% -> 82.14%             
client [59] (test)  loss: 0.2555 -> 0.3306   acc: 93.89% -> 89.96%             
client [7] (test)  loss: 0.4053 -> 0.4735   acc: 86.30% -> 83.48%              
client [26] (test)  loss: 0.1921 -> 0.1833   acc: 91.80% -> 91.80%             
client [49] (test)  loss: 0.5798 -> 0.7802   acc: 76.45% -> 72.48%             
client [98] (test)  loss: 0.1304 -> 0.1536   acc: 93.95% -> 93.16%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1238 -> 0.1424   acc: 93.95% -> 93.68%             
client [47] (test)  loss: 0.2588 -> 0.3643   acc: 90.77% -> 88.79%             
client [21] (test)  loss: 0.3665 -> 0.7057   acc: 87.58% -> 75.15%             
client [77] (test)  loss: 0.3307 -> 0.4146   acc: 91.69% -> 84.89%             
client [95] (test)  loss: 0.3295 -> 0.4097   acc: 89.53% -> 86.82%             
client [91] (test)  loss: 0.1847 -> 0.3165   acc: 93.64% -> 89.31%             
client [14] (test)  loss: 0.3363 -> 0.3627   acc: 86.92% -> 87.74%             
client [99] (test)  loss: 0.2460 -> 0.3113   acc: 93.33% -> 91.11%             
client [20] (test)  loss: 0.1650 -> 0.2264   acc: 94.72% -> 91.82%             
client [39] (test)  loss: 0.3006 -> 0.3482   acc: 88.15% -> 85.11%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2931 -> 0.3119   acc: 91.81% -> 91.81%             
client [62] (test)  loss: 0.1942 -> 0.2183   acc: 94.08% -> 93.03%             
client [71] (test)  loss: 0.4957 -> 0.5973   acc: 85.19% -> 83.95%             
client [97] (test)  loss: 0.4880 -> 0.4048   acc: 82.10% -> 84.05%             
client [30] (test)  loss: 0.4713 -> 0.5863   acc: 82.71% -> 76.64%             
client [88] (test)  loss: 0.3195 -> 0.3707   acc: 89.21% -> 85.71%             
client [60] (test)  loss: 0.2960 -> 0.2367   acc: 91.21% -> 91.82%             
client [82] (test)  loss: 0.6260 -> 0.6824   acc: 75.41% -> 73.76%             
client [91] (test)  loss: 0.1736 -> 0.1857   acc: 94.91% -> 92.88%             
client [57] (test)  loss: 0.0806 -> 0.0809   acc: 97.78% -> 97.50%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4269 -> 2.2969   acc: 87.15% -> 68.72%             
client [15] (test)  loss: 0.4227 -> 0.4296   acc: 83.16% -> 84.21%             
client [71] (test)  loss: 0.5376 -> 0.6181   acc: 83.95% -> 83.95%             
client [97] (test)  loss: 0.3862 -> 0.3998   acc: 84.44% -> 84.82%             
client [53] (test)  loss: 0.3843 -> 0.6030   acc: 86.05% -> 75.75%             
client [77] (test)  loss: 0.3205 -> 0.3743   acc: 91.69% -> 88.16%             
client [76] (test)  loss: 0.4030 -> 1.1911   acc: 85.19% -> 72.03%             
client [79] (test)  loss: 0.4927 -> 0.5011   acc: 78.39% -> 78.96%             
client [28] (test)  loss: 0.2262 -> 0.2424   acc: 93.24% -> 90.99%             
client [99] (test)  loss: 0.2403 -> 0.2835   acc: 93.70% -> 92.59%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3722 -> 0.3873   acc: 85.60% -> 84.82%             
client [86] (test)  loss: 0.2792 -> 0.3433   acc: 91.71% -> 89.14%             
client [34] (test)  loss: 0.2828 -> 0.2864   acc: 91.09% -> 90.59%             
client [73] (test)  loss: 0.3302 -> 0.4492   acc: 88.64% -> 86.63%             
client [5] (test)  loss: 0.1886 -> 0.2009   acc: 96.08% -> 95.62%              
client [96] (test)  loss: 0.4464 -> 0.5483   acc: 84.66% -> 80.16%             
client [22] (test)  loss: 0.4106 -> 0.4833   acc: 86.91% -> 84.90%             
client [60] (test)  loss: 0.2390 -> 0.2274   acc: 94.24% -> 92.73%             
client [66] (test)  loss: 0.2239 -> 0.2389   acc: 94.82% -> 95.22%             
client [83] (test)  loss: 0.3446 -> 0.4026   acc: 89.35% -> 87.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3571 -> 0.3906   acc: 86.65% -> 85.01%             
client [65] (test)  loss: 0.3537 -> 0.4061   acc: 87.34% -> 84.09%             
client [95] (test)  loss: 0.3207 -> 0.3868   acc: 88.76% -> 88.76%             
client [17] (test)  loss: 0.2602 -> 0.2772   acc: 91.49% -> 89.06%             
client [8] (test)  loss: 0.3591 -> 0.4245   acc: 91.27% -> 88.65%              
client [35] (test)  loss: 0.1612 -> 0.1915   acc: 94.32% -> 94.06%             
client [98] (test)  loss: 0.1114 -> 0.1205   acc: 95.53% -> 95.79%             
client [53] (test)  loss: 0.3913 -> 0.6117   acc: 85.38% -> 76.41%             
client [43] (test)  loss: 0.2915 -> 0.7683   acc: 87.94% -> 71.36%             
client [64] (test)  loss: 0.1870 -> 0.2091   acc: 91.43% -> 92.29%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3857 -> 0.3889   acc: 87.58% -> 87.27%             
client [88] (test)  loss: 0.2997 -> 0.3242   acc: 89.84% -> 87.94%             
client [38] (test)  loss: 0.3422 -> 0.6103   acc: 87.57% -> 83.43%             
client [3] (test)  loss: 0.2172 -> 0.3690   acc: 93.40% -> 88.83%              
client [5] (test)  loss: 0.1834 -> 0.2024   acc: 97.24% -> 95.85%              
client [41] (test)  loss: 0.0917 -> 0.1126   acc: 95.56% -> 94.72%             
client [7] (test)  loss: 0.2546 -> 0.3852   acc: 90.65% -> 86.74%              
client [37] (test)  loss: 0.1694 -> 0.1992   acc: 94.79% -> 91.67%             
client [45] (test)  loss: 0.2178 -> 0.3823   acc: 93.35% -> 88.56%             
client [47] (test)  loss: 0.2228 -> 0.5212   acc: 93.19% -> 83.08%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1585 -> 0.1808   acc: 94.59% -> 94.29%             
client [11] (test)  loss: 0.1203 -> 0.1210   acc: 96.16% -> 96.16%             
client [37] (test)  loss: 0.1724 -> 0.1889   acc: 93.23% -> 92.45%             
client [41] (test)  loss: 0.0829 -> 0.1093   acc: 96.39% -> 94.72%             
client [95] (test)  loss: 0.3132 -> 0.3987   acc: 90.70% -> 87.60%             
client [53] (test)  loss: 0.3805 -> 0.6335   acc: 85.38% -> 77.08%             
client [22] (test)  loss: 0.3882 -> 0.4413   acc: 87.58% -> 85.57%             
client [25] (test)  loss: 0.2392 -> 0.4121   acc: 91.86% -> 87.79%             
client [69] (test)  loss: 0.3270 -> 0.4307   acc: 88.10% -> 84.52%             
client [46] (test)  loss: 0.3105 -> 0.4701   acc: 87.47% -> 82.93%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2090 -> 0.3210   acc: 93.85% -> 88.79%             
client [69] (test)  loss: 0.3001 -> 0.4087   acc: 89.88% -> 84.82%             
client [82] (test)  loss: 0.6210 -> 0.8213   acc: 78.45% -> 74.86%             
client [45] (test)  loss: 0.2396 -> 0.2578   acc: 92.82% -> 92.02%             
client [7] (test)  loss: 0.2655 -> 0.4595   acc: 90.65% -> 85.22%              
client [50] (test)  loss: 0.2023 -> 0.2492   acc: 94.12% -> 92.44%             
client [35] (test)  loss: 0.1501 -> 0.1811   acc: 94.32% -> 93.54%             
client [24] (test)  loss: 0.4943 -> 0.6202   acc: 81.91% -> 74.20%             
client [15] (test)  loss: 0.4036 -> 0.4362   acc: 84.91% -> 84.56%             
client [58] (test)  loss: 0.5730 -> 0.6823   acc: 78.85% -> 76.65%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3728 -> 0.4295   acc: 85.36% -> 81.07%             
client [76] (test)  loss: 0.3406 -> 0.3626   acc: 87.02% -> 86.47%             
client [67] (test)  loss: 0.2516 -> 0.3442   acc: 90.74% -> 89.94%             
client [37] (test)  loss: 0.1763 -> 0.1960   acc: 93.49% -> 92.71%             
client [58] (test)  loss: 0.6052 -> 0.6776   acc: 78.02% -> 76.37%             
client [64] (test)  loss: 0.1616 -> 0.1727   acc: 94.29% -> 92.57%             
client [77] (test)  loss: 0.2947 -> 0.4124   acc: 92.19% -> 83.63%             
client [55] (test)  loss: 0.1835 -> 0.2260   acc: 93.69% -> 94.16%             
client [12] (test)  loss: 0.3008 -> 0.3851   acc: 91.87% -> 87.53%             
client [89] (test)  loss: 0.2871 -> 0.4028   acc: 92.16% -> 87.46%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.2794 -> 0.2919   acc: 91.83% -> 91.44%             
client [51] (test)  loss: 0.0834 -> 0.0853   acc: 97.84% -> 97.84%             
client [8] (test)  loss: 0.3718 -> 0.4374   acc: 91.70% -> 89.08%              
client [18] (test)  loss: 0.2354 -> 0.9673   acc: 90.41% -> 73.97%             
client [94] (test)  loss: 0.2338 -> 0.2348   acc: 92.15% -> 91.39%             
client [81] (test)  loss: 0.2349 -> 0.2541   acc: 94.03% -> 94.03%             
client [3] (test)  loss: 0.2182 -> 0.3172   acc: 93.65% -> 90.86%              
client [11] (test)  loss: 0.1028 -> 0.1111   acc: 96.61% -> 96.84%             
client [95] (test)  loss: 0.3597 -> 0.3894   acc: 89.15% -> 87.60%             
client [67] (test)  loss: 0.2560 -> 0.3305   acc: 91.55% -> 90.54%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3663 -> 0.3859   acc: 88.79% -> 88.79%             
client [79] (test)  loss: 0.4425 -> 0.5018   acc: 84.15% -> 77.52%             
client [58] (test)  loss: 0.6627 -> 0.7045   acc: 78.85% -> 75.55%             
client [88] (test)  loss: 0.3007 -> 0.2918   acc: 88.89% -> 91.11%             
client [46] (test)  loss: 0.2460 -> 0.9149   acc: 89.87% -> 68.53%             
client [11] (test)  loss: 0.1187 -> 0.1100   acc: 96.61% -> 97.07%             
client [55] (test)  loss: 0.1888 -> 0.2229   acc: 93.22% -> 94.39%             
client [13] (test)  loss: 0.3002 -> 0.3153   acc: 90.98% -> 88.92%             
client [31] (test)  loss: 0.4510 -> 0.9967   acc: 87.99% -> 80.17%             
client [75] (test)  loss: 0.0849 -> 0.1051   acc: 97.01% -> 97.28%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1754 -> 0.1961   acc: 97.18% -> 97.65%             
client [7] (test)  loss: 0.2305 -> 0.4951   acc: 92.39% -> 88.04%              
client [57] (test)  loss: 0.0475 -> 0.0480   acc: 98.06% -> 98.06%             
client [13] (test)  loss: 0.2884 -> 0.3022   acc: 89.43% -> 89.95%             
client [43] (test)  loss: 0.2081 -> 0.3578   acc: 92.21% -> 86.68%             
client [91] (test)  loss: 0.1366 -> 0.1610   acc: 95.42% -> 94.40%             
client [10] (test)  loss: 0.3216 -> 0.3570   acc: 91.14% -> 91.46%             
client [64] (test)  loss: 0.1662 -> 0.1695   acc: 93.14% -> 93.71%             
client [82] (test)  loss: 0.6134 -> 0.9946   acc: 80.66% -> 55.25%             
client [22] (test)  loss: 0.4367 -> 0.4614   acc: 87.58% -> 85.57%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1375 -> 0.1328   acc: 95.51% -> 95.51%             
client [23] (test)  loss: 0.3102 -> 0.2976   acc: 88.12% -> 88.12%             
client [88] (test)  loss: 0.2652 -> 0.2890   acc: 92.38% -> 90.79%             
client [98] (test)  loss: 0.1138 -> 0.1079   acc: 96.05% -> 97.11%             
client [79] (test)  loss: 0.4116 -> 0.6096   acc: 81.56% -> 73.20%             
client [21] (test)  loss: 0.3714 -> 0.3904   acc: 89.39% -> 88.18%             
client [92] (test)  loss: 0.0883 -> 0.0802   acc: 97.72% -> 97.47%             
client [56] (test)  loss: 0.3808 -> 0.4198   acc: 86.95% -> 84.24%             
client [5] (test)  loss: 0.2410 -> 0.2812   acc: 96.08% -> 94.93%              
client [52] (test)  loss: 0.3577 -> 0.3318   acc: 89.77% -> 90.35%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.2894 -> 0.0000', 'accuracy': '89.80% -> 0.00%'},          
    200: {'loss': '0.2783 -> 0.0000', 'accuracy': '90.95% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 20.0%(20.61%) at epoch: 2                                      
FedRep achieved 30.0%(36.53%) at epoch: 4                                      
FedRep achieved 60.0%(63.56%) at epoch: 7                                      
FedRep achieved 70.0%(74.02%) at epoch: 16                                     
FedRep achieved 80.0%(81.59%) at epoch: 22                                     
FedRep achieved 90.0%(90.97%) at epoch: 66                                     
Convergence (test_after):                                                      
FedRep achieved 30.0%(31.33%) at epoch: 0                                      
FedRep achieved 50.0%(52.73%) at epoch: 2                                      
FedRep achieved 60.0%(64.09%) at epoch: 6                                      
FedRep achieved 70.0%(70.71%) at epoch: 7                                      
FedRep achieved 80.0%(81.50%) at epoch: 17                                     
FedRep achieved 90.0%(90.19%) at epoch: 78                                     
