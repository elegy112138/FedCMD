==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3384 -> 2.3007   acc: 35.92% -> 38.83%             
client [81] (test)  loss: 2.3646 -> 2.3533   acc: 17.12% -> 17.12%             
client [21] (test)  loss: 2.3840 -> 2.1483   acc: 11.50% -> 67.70%             
client [68] (test)  loss: 2.3621 -> 2.3425   acc: 18.95% -> 18.95%             
client [93] (test)  loss: 2.2759 -> 2.2098   acc: 40.94% -> 40.94%             
client [31] (test)  loss: 2.3777 -> 2.3262   acc: 2.48% -> 19.01%              
client [20] (test)  loss: 1.8686 -> 1.4968   acc: 87.58% -> 87.58%             
client [59] (test)  loss: 2.3205 -> 2.2585   acc: 45.08% -> 45.08%             
client [48] (test)  loss: 2.1107 -> 2.0129   acc: 61.17% -> 61.17%             
client [34] (test)  loss: 2.3803 -> 2.3593   acc: 2.74% -> 2.74%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.1413 -> 1.9516   acc: 30.77% -> 30.77%             
client [99] (test)  loss: 2.2659 -> 1.9938   acc: 22.86% -> 22.86%             
client [67] (test)  loss: 2.2677 -> 1.8112   acc: 0.00% -> 33.77%              
client [0] (test)  loss: 2.1150 -> 1.7232   acc: 36.99% -> 35.84%              
client [76] (test)  loss: 2.1538 -> 1.8194   acc: 0.00% -> 46.32%              
client [41] (test)  loss: 2.2082 -> 1.5123   acc: 0.68% -> 55.10%              
client [62] (test)  loss: 2.5052 -> 1.4588   acc: 11.03% -> 62.50%             
client [2] (test)  loss: 1.8886 -> 1.6281   acc: 57.29% -> 57.29%              
client [14] (test)  loss: 2.1648 -> 2.0466   acc: 19.05% -> 15.08%             
client [46] (test)  loss: 1.1483 -> 1.0090   acc: 75.40% -> 75.40%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.6575 -> 1.6509   acc: 36.97% -> 36.97%             
client [68] (test)  loss: 2.1001 -> 1.9661   acc: 18.95% -> 36.84%             
client [57] (test)  loss: 1.6679 -> 1.6216   acc: 39.85% -> 39.85%             
client [17] (test)  loss: 1.5568 -> 1.0537   acc: 62.91% -> 62.91%             
client [54] (test)  loss: 1.8790 -> 1.7931   acc: 55.40% -> 55.40%             
client [23] (test)  loss: 3.0917 -> 1.8435   acc: 0.00% -> 30.71%              
client [35] (test)  loss: 2.0945 -> 2.1039   acc: 33.68% -> 33.68%             
client [59] (test)  loss: 1.6016 -> 1.5437   acc: 52.46% -> 64.75%             
client [31] (test)  loss: 1.5133 -> 1.4455   acc: 46.28% -> 46.28%             
client [9] (test)  loss: 2.2259 -> 2.2669   acc: 34.04% -> 34.04%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.5322 -> 1.4625   acc: 47.97% -> 54.05%             
client [33] (test)  loss: 1.6843 -> 1.6434   acc: 43.97% -> 43.97%             
client [16] (test)  loss: 1.4685 -> 1.3823   acc: 47.02% -> 49.01%             
client [44] (test)  loss: 1.6837 -> 0.0251   acc: 0.00% -> 100.00%             
client [8] (test)  loss: 1.3188 -> 1.2276   acc: 41.94% -> 58.87%              
client [31] (test)  loss: 1.2225 -> 1.1367   acc: 58.68% -> 58.68%             
client [47] (test)  loss: 1.8637 -> 1.7402   acc: 36.36% -> 36.36%             
client [36] (test)  loss: 1.5773 -> 1.5214   acc: 58.33% -> 58.33%             
client [20] (test)  loss: 0.6005 -> 0.4556   acc: 87.58% -> 87.58%             
client [56] (test)  loss: 1.6551 -> 1.5152   acc: 25.93% -> 40.74%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.9122 -> 0.8285   acc: 59.57% -> 63.83%              
client [60] (test)  loss: 1.8754 -> 1.7353   acc: 34.12% -> 42.35%             
client [28] (test)  loss: 2.0705 -> 1.5788   acc: 37.74% -> 37.74%             
client [25] (test)  loss: 2.5526 -> 1.5986   acc: 37.82% -> 27.73%             
client [58] (test)  loss: 1.7625 -> 1.9429   acc: 31.58% -> 13.53%             
client [44] (test)  loss: 0.0108 -> 0.0066   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 1.0591 -> 1.0285   acc: 68.47% -> 67.98%             
client [29] (test)  loss: 1.6415 -> 1.3148   acc: 40.68% -> 48.31%             
client [3] (test)  loss: 0.8833 -> 0.8140   acc: 76.28% -> 79.84%              
client [84] (test)  loss: 1.4204 -> 1.3517   acc: 63.87% -> 72.27%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.3162 -> 1.1383   acc: 67.70% -> 67.70%             
client [84] (test)  loss: 1.2486 -> 1.1644   acc: 62.18% -> 63.03%             
client [10] (test)  loss: 1.3814 -> 1.1858   acc: 56.39% -> 65.41%             
client [36] (test)  loss: 1.4464 -> 1.4261   acc: 58.33% -> 61.11%             
client [65] (test)  loss: 1.1415 -> 1.2790   acc: 63.93% -> 63.11%             
client [81] (test)  loss: 1.8123 -> 1.7383   acc: 29.73% -> 29.73%             
client [79] (test)  loss: 0.6331 -> 0.6057   acc: 82.39% -> 84.51%             
client [42] (test)  loss: 1.4334 -> 1.4328   acc: 54.76% -> 52.38%             
client [11] (test)  loss: 2.1043 -> 1.7294   acc: 27.14% -> 34.29%             
client [96] (test)  loss: 0.3944 -> 1.2044   acc: 89.02% -> 32.93%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9792 -> 1.1025   acc: 61.29% -> 61.29%              
client [53] (test)  loss: 1.0394 -> 1.0224   acc: 62.77% -> 52.55%             
client [52] (test)  loss: 0.8217 -> 0.7529   acc: 73.29% -> 77.02%             
client [42] (test)  loss: 1.3515 -> 1.3433   acc: 55.56% -> 55.56%             
client [69] (test)  loss: 1.5022 -> 1.5671   acc: 47.25% -> 40.66%             
client [59] (test)  loss: 0.7838 -> 0.8401   acc: 73.77% -> 72.13%             
client [7] (test)  loss: 1.3368 -> 1.2500   acc: 60.87% -> 56.52%              
client [26] (test)  loss: 1.3733 -> 1.2286   acc: 45.45% -> 47.11%             
client [49] (test)  loss: 0.5102 -> 0.5080   acc: 85.93% -> 86.67%             
client [98] (test)  loss: 0.8965 -> 0.8942   acc: 61.67% -> 60.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8400 -> 0.7974   acc: 68.33% -> 70.00%             
client [47] (test)  loss: 1.5331 -> 1.5415   acc: 37.88% -> 40.91%             
client [21] (test)  loss: 1.0489 -> 1.0512   acc: 69.47% -> 69.91%             
client [77] (test)  loss: 0.5301 -> 0.8979   acc: 82.52% -> 69.90%             
client [95] (test)  loss: 0.4552 -> 0.4476   acc: 87.76% -> 89.12%             
client [91] (test)  loss: 0.7466 -> 0.7233   acc: 76.74% -> 78.29%             
client [14] (test)  loss: 0.6115 -> 0.6431   acc: 86.51% -> 82.54%             
client [99] (test)  loss: 1.4996 -> 1.5509   acc: 34.29% -> 32.86%             
client [20] (test)  loss: 0.3071 -> 0.3166   acc: 92.81% -> 91.50%             
client [39] (test)  loss: 0.7071 -> 0.7314   acc: 71.92% -> 72.41%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6599 -> 0.6666   acc: 79.50% -> 82.61%             
client [62] (test)  loss: 0.5381 -> 0.6401   acc: 84.56% -> 80.15%             
client [71] (test)  loss: 0.8803 -> 0.8829   acc: 73.53% -> 73.53%             
client [97] (test)  loss: 0.8848 -> 0.9802   acc: 72.00% -> 66.00%             
client [30] (test)  loss: 0.8211 -> 0.8217   acc: 75.41% -> 72.13%             
client [88] (test)  loss: 1.2892 -> 1.1493   acc: 50.00% -> 57.58%             
client [60] (test)  loss: 1.3015 -> 1.2866   acc: 60.00% -> 60.00%             
client [82] (test)  loss: 1.4699 -> 1.5021   acc: 40.46% -> 37.40%             
client [91] (test)  loss: 0.6622 -> 0.6662   acc: 77.52% -> 79.07%             
client [57] (test)  loss: 1.2783 -> 1.2599   acc: 51.88% -> 52.63%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5528 -> 0.8394   acc: 79.34% -> 74.38%             
client [15] (test)  loss: 0.6888 -> 0.6952   acc: 84.85% -> 81.82%             
client [71] (test)  loss: 0.8719 -> 0.8485   acc: 73.53% -> 74.51%             
client [97] (test)  loss: 0.8417 -> 0.9464   acc: 76.00% -> 62.00%             
client [53] (test)  loss: 0.9165 -> 0.9621   acc: 62.04% -> 59.12%             
client [77] (test)  loss: 0.4983 -> 0.3813   acc: 86.41% -> 87.38%             
client [76] (test)  loss: 0.7952 -> 0.7849   acc: 70.59% -> 72.79%             
client [79] (test)  loss: 0.5814 -> 0.3979   acc: 84.51% -> 85.92%             
client [28] (test)  loss: 1.3207 -> 1.2935   acc: 52.83% -> 54.72%             
client [99] (test)  loss: 1.3449 -> 1.4535   acc: 54.29% -> 47.14%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.9494 -> 0.9156   acc: 62.00% -> 62.00%             
client [86] (test)  loss: 0.4249 -> 0.3974   acc: 84.09% -> 85.23%             
client [34] (test)  loss: 1.0834 -> 1.6506   acc: 60.27% -> 46.58%             
client [73] (test)  loss: 1.0632 -> 1.0174   acc: 57.89% -> 67.54%             
client [5] (test)  loss: 0.8110 -> 0.9878   acc: 71.76% -> 56.47%              
client [96] (test)  loss: 0.1270 -> 0.4038   acc: 94.51% -> 81.10%             
client [22] (test)  loss: 0.8112 -> 0.8727   acc: 74.31% -> 69.72%             
client [60] (test)  loss: 1.1760 -> 1.1973   acc: 61.18% -> 64.71%             
client [66] (test)  loss: 0.4947 -> 0.4597   acc: 83.93% -> 85.71%             
client [83] (test)  loss: 0.6564 -> 0.7061   acc: 77.57% -> 74.30%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4514 -> 0.6595   acc: 82.35% -> 77.94%             
client [65] (test)  loss: 0.6722 -> 0.6561   acc: 74.59% -> 73.77%             
client [95] (test)  loss: 0.3587 -> 0.4430   acc: 92.52% -> 90.48%             
client [17] (test)  loss: 0.5233 -> 0.3528   acc: 87.42% -> 90.73%             
client [8] (test)  loss: 0.4235 -> 0.4628   acc: 83.87% -> 83.87%              
client [35] (test)  loss: 1.3792 -> 1.2795   acc: 41.05% -> 48.42%             
client [98] (test)  loss: 0.7633 -> 0.7044   acc: 71.67% -> 68.33%             
client [53] (test)  loss: 0.7335 -> 0.8397   acc: 72.99% -> 65.69%             
client [43] (test)  loss: 0.5567 -> 0.5354   acc: 79.51% -> 82.79%             
client [64] (test)  loss: 0.7185 -> 0.6717   acc: 72.30% -> 81.76%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8894 -> 0.9162   acc: 69.91% -> 66.37%             
client [88] (test)  loss: 0.9841 -> 0.9754   acc: 68.94% -> 66.67%             
client [38] (test)  loss: 0.4406 -> 0.3828   acc: 88.24% -> 88.24%             
client [3] (test)  loss: 0.3902 -> 0.3947   acc: 88.93% -> 90.51%              
client [5] (test)  loss: 0.7595 -> 0.7209   acc: 69.41% -> 75.29%              
client [41] (test)  loss: 0.7418 -> 0.8448   acc: 72.11% -> 72.79%             
client [7] (test)  loss: 0.7895 -> 0.8409   acc: 74.78% -> 70.43%              
client [37] (test)  loss: 0.4818 -> 0.9733   acc: 84.56% -> 63.09%             
client [45] (test)  loss: 0.4780 -> 1.0754   acc: 82.58% -> 65.15%             
client [47] (test)  loss: 1.4267 -> 1.3588   acc: 53.03% -> 48.48%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.2975 -> 0.7911   acc: 60.93% -> 70.86%             
client [11] (test)  loss: 1.0547 -> 1.0358   acc: 64.29% -> 67.14%             
client [37] (test)  loss: 0.4600 -> 2.1272   acc: 83.89% -> 39.60%             
client [41] (test)  loss: 0.7903 -> 1.3713   acc: 76.87% -> 53.06%             
client [95] (test)  loss: 0.3675 -> 0.4357   acc: 92.52% -> 90.48%             
client [53] (test)  loss: 0.6466 -> 0.7097   acc: 76.64% -> 72.26%             
client [22] (test)  loss: 0.8084 -> 0.9271   acc: 73.39% -> 68.81%             
client [25] (test)  loss: 1.2997 -> 0.9028   acc: 50.42% -> 57.98%             
client [69] (test)  loss: 1.0787 -> 1.0038   acc: 63.74% -> 67.03%             
client [46] (test)  loss: 0.2769 -> 0.2560   acc: 87.30% -> 88.10%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9894 -> 1.0861   acc: 63.64% -> 60.61%             
client [69] (test)  loss: 0.9018 -> 1.2485   acc: 70.33% -> 59.34%             
client [82] (test)  loss: 0.7964 -> 2.3985   acc: 64.89% -> 37.40%             
client [45] (test)  loss: 0.2864 -> 0.3453   acc: 91.67% -> 87.12%             
client [7] (test)  loss: 0.7992 -> 0.7950   acc: 74.78% -> 73.04%              
client [50] (test)  loss: 0.2556 -> 0.2424   acc: 91.73% -> 90.23%             
client [35] (test)  loss: 1.0538 -> 1.1006   acc: 58.95% -> 57.89%             
client [24] (test)  loss: 0.8290 -> 1.0798   acc: 72.27% -> 60.50%             
client [15] (test)  loss: 0.5856 -> 0.5923   acc: 87.88% -> 87.88%             
client [58] (test)  loss: 0.9166 -> 1.7723   acc: 65.41% -> 42.11%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2578 -> 0.2834   acc: 94.17% -> 92.23%             
client [76] (test)  loss: 0.3663 -> 0.4649   acc: 85.29% -> 85.29%             
client [67] (test)  loss: 0.5951 -> 0.5746   acc: 78.57% -> 77.27%             
client [37] (test)  loss: 0.4425 -> 0.4229   acc: 83.89% -> 82.55%             
client [58] (test)  loss: 1.1335 -> 1.6137   acc: 58.65% -> 51.88%             
client [64] (test)  loss: 0.6132 -> 0.5636   acc: 78.38% -> 83.78%             
client [77] (test)  loss: 0.2136 -> 0.1951   acc: 92.23% -> 94.17%             
client [55] (test)  loss: 1.6403 -> 1.2764   acc: 50.96% -> 57.69%             
client [12] (test)  loss: 1.1974 -> 0.9656   acc: 60.68% -> 70.94%             
client [89] (test)  loss: 0.6510 -> 0.7918   acc: 77.14% -> 71.43%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4912 -> 0.6106   acc: 82.35% -> 74.79%             
client [51] (test)  loss: 0.8476 -> 0.7992   acc: 79.63% -> 81.48%             
client [8] (test)  loss: 0.2154 -> 0.2328   acc: 92.74% -> 90.32%              
client [18] (test)  loss: 0.7368 -> 0.7278   acc: 79.44% -> 78.50%             
client [94] (test)  loss: 0.0394 -> 0.0405   acc: 98.36% -> 98.36%             
client [81] (test)  loss: 0.8054 -> 0.9529   acc: 72.07% -> 69.37%             
client [3] (test)  loss: 0.2819 -> 0.2917   acc: 93.28% -> 92.89%              
client [11] (test)  loss: 0.7765 -> 0.8728   acc: 74.29% -> 70.00%             
client [95] (test)  loss: 0.3524 -> 0.5017   acc: 95.24% -> 91.16%             
client [67] (test)  loss: 0.5445 -> 0.5596   acc: 79.22% -> 78.57%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.0066 -> 0.7104   acc: 67.70% -> 72.57%             
client [79] (test)  loss: 0.3101 -> 0.3225   acc: 87.32% -> 87.32%             
client [58] (test)  loss: 0.9625 -> 1.5560   acc: 63.16% -> 52.63%             
client [88] (test)  loss: 0.8468 -> 0.8369   acc: 73.48% -> 73.48%             
client [46] (test)  loss: 0.2558 -> 0.2121   acc: 91.27% -> 91.27%             
client [11] (test)  loss: 0.7863 -> 0.8563   acc: 75.71% -> 71.43%             
client [55] (test)  loss: 1.2606 -> 1.2673   acc: 57.69% -> 56.73%             
client [13] (test)  loss: 0.6219 -> 1.2434   acc: 83.10% -> 67.61%             
client [31] (test)  loss: 0.3921 -> 0.3780   acc: 90.91% -> 89.26%             
client [75] (test)  loss: 1.2018 -> 1.2120   acc: 75.47% -> 77.36%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6749 -> 0.6663   acc: 76.92% -> 76.92%             
client [7] (test)  loss: 0.6165 -> 0.5716   acc: 81.74% -> 86.09%              
client [57] (test)  loss: 0.8141 -> 0.8332   acc: 68.42% -> 63.16%             
client [13] (test)  loss: 0.6158 -> 0.9169   acc: 84.51% -> 73.24%             
client [43] (test)  loss: 0.4423 -> 0.4190   acc: 86.07% -> 87.70%             
client [91] (test)  loss: 0.6521 -> 0.4809   acc: 81.40% -> 82.95%             
client [10] (test)  loss: 0.4950 -> 1.5639   acc: 81.20% -> 69.92%             
client [64] (test)  loss: 0.5123 -> 0.5048   acc: 89.19% -> 87.16%             
client [82] (test)  loss: 0.6435 -> 0.8503   acc: 73.28% -> 60.31%             
client [22] (test)  loss: 0.5956 -> 0.6373   acc: 81.65% -> 80.73%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1594 -> 0.1708   acc: 95.42% -> 94.77%             
client [23] (test)  loss: 0.8753 -> 1.0560   acc: 66.14% -> 59.84%             
client [88] (test)  loss: 0.8346 -> 0.7832   acc: 74.24% -> 77.27%             
client [98] (test)  loss: 0.4527 -> 0.5975   acc: 83.33% -> 76.67%             
client [79] (test)  loss: 0.2972 -> 0.3112   acc: 87.32% -> 87.32%             
client [21] (test)  loss: 0.6449 -> 0.6572   acc: 79.65% -> 74.34%             
client [92] (test)  loss: 0.4519 -> 0.5385   acc: 85.71% -> 83.67%             
client [56] (test)  loss: 0.3409 -> 0.4724   acc: 85.19% -> 80.00%             
client [5] (test)  loss: 0.6219 -> 0.9239   acc: 76.47% -> 72.94%              
client [52] (test)  loss: 0.3270 -> 0.5384   acc: 88.82% -> 78.88%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.8838 -> 0.0000', 'accuracy': '68.59% -> 0.00%'},          
    200: {'loss': '0.5030 -> 0.0000', 'accuracy': '83.03% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 20.0%(23.85%) at epoch: 0                                      
FedRep achieved 40.0%(44.00%) at epoch: 6                                      
FedRep achieved 50.0%(51.76%) at epoch: 24                                     
FedRep achieved 60.0%(62.60%) at epoch: 44                                     
FedRep achieved 70.0%(73.12%) at epoch: 71                                     
FedRep achieved 80.0%(81.76%) at epoch: 116                                    
Convergence (test_after):                                                      
FedRep achieved 30.0%(37.78%) at epoch: 0                                      
FedRep achieved 50.0%(51.95%) at epoch: 6                                      
FedRep achieved 60.0%(60.10%) at epoch: 39                                     
FedRep achieved 70.0%(73.45%) at epoch: 47                                     
FedRep achieved 80.0%(83.00%) at epoch: 123                                    
