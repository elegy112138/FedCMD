==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.1494 -> 1.6807   acc: 0.48% -> 57.97%              
client [81] (test)  loss: 0.7956 -> 0.7556   acc: 72.03% -> 72.03%             
client [21] (test)  loss: 2.3884 -> 1.9301   acc: 11.86% -> 37.97%             
client [68] (test)  loss: 2.0676 -> 1.6205   acc: 13.92% -> 43.69%             
client [93] (test)  loss: 1.0590 -> 0.9631   acc: 76.49% -> 76.49%             
client [31] (test)  loss: 1.7930 -> 1.6181   acc: 52.20% -> 52.20%             
client [20] (test)  loss: 1.8177 -> 1.7120   acc: 41.32% -> 41.32%             
client [59] (test)  loss: 1.6708 -> 1.0893   acc: 67.66% -> 67.66%             
client [48] (test)  loss: 1.6223 -> 1.5634   acc: 45.19% -> 45.19%             
client [34] (test)  loss: 1.5652 -> 1.4823   acc: 49.84% -> 49.84%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.7432 -> 1.3902   acc: 21.65% -> 36.47%             
client [99] (test)  loss: 1.6496 -> 1.4972   acc: 61.29% -> 64.52%             
client [67] (test)  loss: 1.2256 -> 1.0432   acc: 43.99% -> 61.71%             
client [0] (test)  loss: 0.9808 -> 0.8950   acc: 75.60% -> 76.08%              
client [76] (test)  loss: 1.4078 -> 1.2489   acc: 48.62% -> 51.72%             
client [41] (test)  loss: 1.4825 -> 1.2500   acc: 54.72% -> 56.13%             
client [62] (test)  loss: 1.0481 -> 0.8434   acc: 70.88% -> 70.88%             
client [2] (test)  loss: 2.4932 -> 1.9008   acc: 3.57% -> 21.94%               
client [14] (test)  loss: 1.3509 -> 1.2854   acc: 55.81% -> 58.14%             
client [46] (test)  loss: 1.6791 -> 1.3335   acc: 44.91% -> 47.31%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0762 -> 0.9888   acc: 67.41% -> 69.64%             
client [68] (test)  loss: 0.7829 -> 0.6315   acc: 75.73% -> 79.94%             
client [57] (test)  loss: 0.5352 -> 0.4465   acc: 86.56% -> 86.83%             
client [17] (test)  loss: 1.1438 -> 0.9029   acc: 66.54% -> 80.30%             
client [54] (test)  loss: 0.6000 -> 0.5887   acc: 80.00% -> 80.95%             
client [23] (test)  loss: 2.3682 -> 0.8496   acc: 1.01% -> 75.25%              
client [35] (test)  loss: 1.1952 -> 1.2615   acc: 57.80% -> 51.15%             
client [59] (test)  loss: 0.5820 -> 0.5372   acc: 82.84% -> 83.17%             
client [31] (test)  loss: 1.2709 -> 2.1213   acc: 52.54% -> 20.00%             
client [9] (test)  loss: 1.1478 -> 1.2640   acc: 62.78% -> 53.89%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0396 -> 1.1656   acc: 64.73% -> 60.47%             
client [33] (test)  loss: 0.7355 -> 0.7204   acc: 77.25% -> 77.78%             
client [16] (test)  loss: 1.0675 -> 0.9524   acc: 58.59% -> 64.84%             
client [44] (test)  loss: 0.9570 -> 0.2824   acc: 83.02% -> 89.51%             
client [8] (test)  loss: 0.6346 -> 0.6675   acc: 77.86% -> 76.30%              
client [31] (test)  loss: 1.0237 -> 2.6398   acc: 62.03% -> 17.29%             
client [47] (test)  loss: 0.5234 -> 0.4109   acc: 82.78% -> 87.09%             
client [36] (test)  loss: 0.7952 -> 0.5546   acc: 76.32% -> 82.55%             
client [20] (test)  loss: 0.8469 -> 0.7754   acc: 76.86% -> 76.86%             
client [56] (test)  loss: 0.4321 -> 0.5394   acc: 85.68% -> 79.31%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.9053 -> 0.8064   acc: 69.67% -> 71.72%              
client [60] (test)  loss: 0.6332 -> 0.4843   acc: 79.58% -> 84.58%             
client [28] (test)  loss: 0.8931 -> 0.6481   acc: 71.24% -> 81.70%             
client [25] (test)  loss: 1.1304 -> 1.3360   acc: 48.13% -> 41.59%             
client [58] (test)  loss: 0.5380 -> 0.5445   acc: 83.95% -> 81.17%             
client [44] (test)  loss: 0.3556 -> 0.2436   acc: 93.83% -> 90.43%             
client [39] (test)  loss: 0.8492 -> 0.8221   acc: 75.00% -> 70.76%             
client [29] (test)  loss: 0.9720 -> 0.6986   acc: 64.69% -> 74.59%             
client [3] (test)  loss: 0.7313 -> 0.5717   acc: 78.32% -> 81.55%              
client [84] (test)  loss: 1.0540 -> 0.9646   acc: 57.00% -> 57.98%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.3687 -> 1.7122   acc: 52.88% -> 46.44%             
client [84] (test)  loss: 0.9419 -> 0.8910   acc: 60.91% -> 59.61%             
client [10] (test)  loss: 0.1333 -> 0.1341   acc: 94.70% -> 94.48%             
client [36] (test)  loss: 0.3354 -> 0.4397   acc: 89.72% -> 86.60%             
client [65] (test)  loss: 0.5489 -> 0.5304   acc: 80.08% -> 81.71%             
client [81] (test)  loss: 0.1709 -> 0.1759   acc: 96.04% -> 95.81%             
client [79] (test)  loss: 0.3310 -> 0.3103   acc: 93.08% -> 91.54%             
client [42] (test)  loss: 0.3500 -> 0.3659   acc: 88.53% -> 89.22%             
client [11] (test)  loss: 0.6958 -> 0.5273   acc: 72.94% -> 82.68%             
client [96] (test)  loss: 0.3317 -> 0.5080   acc: 90.18% -> 81.80%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3902 -> 1.2520   acc: 85.94% -> 55.99%              
client [53] (test)  loss: 0.7241 -> 0.6737   acc: 70.64% -> 73.84%             
client [52] (test)  loss: 0.6669 -> 0.4977   acc: 74.10% -> 81.97%             
client [42] (test)  loss: 0.2847 -> 0.3122   acc: 89.45% -> 89.68%             
client [69] (test)  loss: 0.6894 -> 0.9624   acc: 71.23% -> 64.10%             
client [59] (test)  loss: 0.2723 -> 0.2689   acc: 90.10% -> 90.10%             
client [7] (test)  loss: 0.3302 -> 0.3574   acc: 91.80% -> 89.51%              
client [26] (test)  loss: 0.1831 -> 0.1277   acc: 93.66% -> 95.47%             
client [49] (test)  loss: 0.8148 -> 0.8662   acc: 63.40% -> 59.15%             
client [98] (test)  loss: 0.6948 -> 0.9640   acc: 74.56% -> 66.96%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6612 -> 1.0023   acc: 77.49% -> 65.20%             
client [47] (test)  loss: 0.3553 -> 0.2473   acc: 88.41% -> 91.06%             
client [21] (test)  loss: 1.0293 -> 1.5187   acc: 65.76% -> 50.85%             
client [77] (test)  loss: 0.4398 -> 0.6813   acc: 85.02% -> 74.88%             
client [95] (test)  loss: 0.3285 -> 0.5162   acc: 89.34% -> 81.99%             
client [91] (test)  loss: 0.4087 -> 0.4271   acc: 85.02% -> 86.78%             
client [14] (test)  loss: 0.3150 -> 0.3048   acc: 91.47% -> 92.25%             
client [99] (test)  loss: 0.4952 -> 0.5428   acc: 87.10% -> 86.29%             
client [20] (test)  loss: 0.5498 -> 0.5543   acc: 80.17% -> 81.82%             
client [39] (test)  loss: 0.6442 -> 0.5391   acc: 75.85% -> 77.97%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3996 -> 0.4163   acc: 84.59% -> 83.61%             
client [62] (test)  loss: 0.0951 -> 0.0847   acc: 97.53% -> 96.98%             
client [71] (test)  loss: 0.2879 -> 0.2845   acc: 92.78% -> 94.85%             
client [97] (test)  loss: 0.3228 -> 0.4861   acc: 89.15% -> 87.50%             
client [30] (test)  loss: 0.3549 -> 0.4356   acc: 87.50% -> 84.80%             
client [88] (test)  loss: 0.3446 -> 0.3220   acc: 86.64% -> 87.56%             
client [60] (test)  loss: 0.2654 -> 0.2326   acc: 92.08% -> 92.50%             
client [82] (test)  loss: 1.1188 -> 0.9083   acc: 55.30% -> 69.54%             
client [91] (test)  loss: 0.3151 -> 0.3300   acc: 88.55% -> 89.43%             
client [57] (test)  loss: 0.1790 -> 0.3278   acc: 94.89% -> 92.47%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.3133 -> 0.3782   acc: 87.46% -> 86.78%             
client [15] (test)  loss: 0.2210 -> 0.1966   acc: 93.36% -> 94.69%             
client [71] (test)  loss: 0.2955 -> 0.2755   acc: 91.75% -> 94.85%             
client [97] (test)  loss: 0.3165 -> 0.4605   acc: 89.62% -> 88.44%             
client [53] (test)  loss: 0.5502 -> 0.9065   acc: 78.49% -> 67.44%             
client [77] (test)  loss: 0.3679 -> 0.5615   acc: 87.92% -> 78.74%             
client [76] (test)  loss: 0.3872 -> 0.3824   acc: 85.86% -> 87.93%             
client [79] (test)  loss: 0.2168 -> 0.1946   acc: 93.08% -> 93.85%             
client [28] (test)  loss: 0.3402 -> 0.3330   acc: 90.85% -> 88.24%             
client [99] (test)  loss: 0.4520 -> 0.4566   acc: 87.10% -> 86.29%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2764 -> 0.4469   acc: 91.04% -> 88.21%             
client [86] (test)  loss: 0.4331 -> 0.4626   acc: 91.24% -> 88.66%             
client [34] (test)  loss: 0.2578 -> 0.2665   acc: 92.13% -> 92.13%             
client [73] (test)  loss: 0.0691 -> 0.0807   acc: 98.32% -> 97.60%             
client [5] (test)  loss: 0.2796 -> 0.2568   acc: 93.31% -> 93.31%              
client [96] (test)  loss: 0.2405 -> 0.4981   acc: 93.08% -> 79.23%             
client [22] (test)  loss: 0.3497 -> 0.4222   acc: 86.61% -> 84.52%             
client [60] (test)  loss: 0.1998 -> 0.1859   acc: 92.50% -> 93.33%             
client [66] (test)  loss: 0.3622 -> 0.4292   acc: 87.63% -> 87.10%             
client [83] (test)  loss: 0.0886 -> 0.0728   acc: 98.03% -> 98.03%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3530 -> 0.3430   acc: 85.86% -> 87.24%             
client [65] (test)  loss: 0.3361 -> 0.3030   acc: 89.43% -> 89.43%             
client [95] (test)  loss: 0.3033 -> 0.2595   acc: 90.07% -> 90.81%             
client [17] (test)  loss: 0.3223 -> 0.2763   acc: 90.33% -> 91.82%             
client [8] (test)  loss: 0.3622 -> 0.2559   acc: 86.98% -> 91.93%              
client [35] (test)  loss: 0.4702 -> 0.7038   acc: 83.72% -> 73.62%             
client [98] (test)  loss: 0.5475 -> 0.7991   acc: 78.65% -> 73.39%             
client [53] (test)  loss: 0.4304 -> 0.9422   acc: 83.72% -> 68.02%             
client [43] (test)  loss: 0.1063 -> 0.0818   acc: 96.46% -> 96.46%             
client [64] (test)  loss: 0.4533 -> 0.4549   acc: 84.11% -> 82.56%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8219 -> 0.7815   acc: 72.20% -> 71.86%             
client [88] (test)  loss: 0.2715 -> 0.2495   acc: 92.17% -> 92.17%             
client [38] (test)  loss: 0.1664 -> 0.1440   acc: 94.62% -> 95.16%             
client [3] (test)  loss: 0.2684 -> 0.3182   acc: 90.94% -> 89.00%              
client [5] (test)  loss: 0.2398 -> 0.2251   acc: 94.80% -> 94.42%              
client [41] (test)  loss: 0.5160 -> 0.6680   acc: 81.37% -> 74.06%             
client [7] (test)  loss: 0.1479 -> 0.1883   acc: 95.08% -> 92.46%              
client [37] (test)  loss: 0.2862 -> 0.2376   acc: 90.65% -> 91.01%             
client [45] (test)  loss: 0.4700 -> 0.4171   acc: 82.61% -> 84.62%             
client [47] (test)  loss: 0.2726 -> 0.1802   acc: 91.39% -> 94.37%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4287 -> 0.4288   acc: 81.25% -> 80.86%             
client [11] (test)  loss: 0.2775 -> 0.2616   acc: 91.77% -> 90.91%             
client [37] (test)  loss: 0.2280 -> 0.2193   acc: 92.81% -> 93.17%             
client [41] (test)  loss: 0.6076 -> 0.5691   acc: 76.65% -> 77.83%             
client [95] (test)  loss: 0.2138 -> 0.2273   acc: 91.91% -> 91.91%             
client [53] (test)  loss: 0.3575 -> 1.1050   acc: 88.66% -> 65.99%             
client [22] (test)  loss: 0.3191 -> 0.3450   acc: 87.45% -> 87.87%             
client [25] (test)  loss: 0.2799 -> 0.6533   acc: 89.25% -> 74.77%             
client [69] (test)  loss: 0.3031 -> 0.4111   acc: 89.17% -> 88.32%             
client [46] (test)  loss: 0.3065 -> 0.3015   acc: 90.42% -> 90.42%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1403 -> 0.1755   acc: 95.36% -> 94.37%             
client [69] (test)  loss: 0.2740 -> 0.3829   acc: 90.31% -> 86.04%             
client [82] (test)  loss: 0.7107 -> 0.7536   acc: 73.51% -> 73.84%             
client [45] (test)  loss: 0.3090 -> 0.3182   acc: 86.96% -> 88.63%             
client [7] (test)  loss: 0.1281 -> 0.1353   acc: 95.74% -> 95.08%              
client [50] (test)  loss: 0.4003 -> 0.3605   acc: 88.04% -> 89.69%             
client [35] (test)  loss: 0.3477 -> 1.0622   acc: 88.53% -> 59.40%             
client [24] (test)  loss: 0.4339 -> 0.4045   acc: 85.71% -> 86.61%             
client [15] (test)  loss: 0.1258 -> 0.1225   acc: 96.02% -> 96.24%             
client [58] (test)  loss: 0.1671 -> 0.1606   acc: 94.44% -> 94.75%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2519 -> 0.2835   acc: 92.51% -> 90.11%             
client [76] (test)  loss: 0.2903 -> 0.2783   acc: 87.93% -> 88.28%             
client [67] (test)  loss: 0.2659 -> 0.2877   acc: 91.14% -> 90.51%             
client [37] (test)  loss: 0.1936 -> 0.1982   acc: 92.45% -> 93.88%             
client [58] (test)  loss: 0.1656 -> 0.1502   acc: 93.52% -> 94.75%             
client [64] (test)  loss: 0.3380 -> 0.3289   acc: 87.21% -> 87.21%             
client [77] (test)  loss: 0.2448 -> 0.2636   acc: 92.75% -> 89.86%             
client [55] (test)  loss: 0.0586 -> 1.5570   acc: 98.17% -> 63.19%             
client [12] (test)  loss: 0.3508 -> 0.3812   acc: 88.44% -> 87.41%             
client [89] (test)  loss: 0.4257 -> 0.5059   acc: 85.77% -> 86.14%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4628 -> 0.6247   acc: 81.43% -> 73.29%             
client [51] (test)  loss: 0.3250 -> 0.3585   acc: 88.89% -> 88.27%             
client [8] (test)  loss: 0.1751 -> 0.1777   acc: 94.53% -> 94.79%              
client [18] (test)  loss: 0.2233 -> 0.3616   acc: 93.03% -> 89.09%             
client [94] (test)  loss: 0.0885 -> 0.0889   acc: 97.06% -> 96.08%             
client [81] (test)  loss: 0.0656 -> 0.0609   acc: 98.24% -> 98.46%             
client [3] (test)  loss: 0.2139 -> 0.2462   acc: 91.59% -> 90.61%              
client [11] (test)  loss: 0.2294 -> 0.2918   acc: 93.07% -> 90.48%             
client [95] (test)  loss: 0.1925 -> 0.1901   acc: 94.12% -> 93.75%             
client [67] (test)  loss: 0.2860 -> 0.2758   acc: 89.24% -> 89.87%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6051 -> 0.5840   acc: 82.37% -> 81.69%             
client [79] (test)  loss: 0.1147 -> 0.1022   acc: 96.15% -> 96.92%             
client [58] (test)  loss: 0.1396 -> 0.1427   acc: 95.68% -> 94.44%             
client [88] (test)  loss: 0.2394 -> 0.2076   acc: 91.24% -> 92.17%             
client [46] (test)  loss: 0.2689 -> 0.2802   acc: 92.22% -> 92.22%             
client [11] (test)  loss: 0.3051 -> 0.2871   acc: 90.48% -> 91.13%             
client [55] (test)  loss: 0.0679 -> 0.0675   acc: 97.65% -> 97.65%             
client [13] (test)  loss: 0.1270 -> 0.1414   acc: 95.97% -> 96.22%             
client [31] (test)  loss: 0.2426 -> 0.2585   acc: 91.53% -> 91.19%             
client [75] (test)  loss: 0.0419 -> 0.0400   acc: 98.59% -> 98.59%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3710 -> 0.3889   acc: 91.27% -> 91.27%             
client [7] (test)  loss: 0.1152 -> 0.1080   acc: 95.74% -> 96.39%              
client [57] (test)  loss: 0.1074 -> 0.1327   acc: 96.51% -> 95.97%             
client [13] (test)  loss: 0.1274 -> 0.1372   acc: 96.22% -> 96.22%             
client [43] (test)  loss: 0.0478 -> 0.0454   acc: 97.47% -> 98.23%             
client [91] (test)  loss: 0.1896 -> 0.1908   acc: 93.39% -> 92.51%             
client [10] (test)  loss: 0.0717 -> 0.0727   acc: 97.79% -> 98.01%             
client [64] (test)  loss: 0.2614 -> 0.2872   acc: 91.09% -> 89.92%             
client [82] (test)  loss: 0.5336 -> 0.7100   acc: 81.46% -> 73.84%             
client [22] (test)  loss: 0.2412 -> 0.2584   acc: 90.79% -> 90.79%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3384 -> 0.3544   acc: 89.26% -> 89.26%             
client [23] (test)  loss: 0.3302 -> 0.3707   acc: 88.89% -> 89.90%             
client [88] (test)  loss: 0.2087 -> 0.1963   acc: 92.17% -> 93.09%             
client [98] (test)  loss: 0.3866 -> 0.4500   acc: 85.09% -> 83.33%             
client [79] (test)  loss: 0.0906 -> 0.0924   acc: 97.69% -> 96.92%             
client [21] (test)  loss: 0.4913 -> 0.5364   acc: 84.41% -> 83.39%             
client [92] (test)  loss: 0.4771 -> 0.4389   acc: 85.14% -> 86.86%             
client [56] (test)  loss: 0.1253 -> 0.1313   acc: 97.08% -> 95.49%             
client [5] (test)  loss: 0.1702 -> 0.2196   acc: 95.17% -> 93.68%              
client [52] (test)  loss: 0.2126 -> 0.2163   acc: 92.13% -> 93.11%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3719 -> 0.0000', 'accuracy': '87.30% -> 0.00%'},          
    200: {'loss': '0.2180 -> 0.0000', 'accuracy': '92.79% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 20.0%(20.53%) at epoch: 0                                      
FedRep achieved 30.0%(31.51%) at epoch: 3                                      
FedRep achieved 40.0%(45.75%) at epoch: 9                                      
FedRep achieved 50.0%(51.46%) at epoch: 16                                     
FedRep achieved 60.0%(61.90%) at epoch: 20                                     
FedRep achieved 70.0%(75.15%) at epoch: 28                                     
FedRep achieved 80.0%(83.43%) at epoch: 51                                     
FedRep achieved 90.0%(91.99%) at epoch: 96                                     
Convergence (test_after):                                                      
FedRep achieved 40.0%(43.94%) at epoch: 0                                      
FedRep achieved 50.0%(52.11%) at epoch: 4                                      
FedRep achieved 60.0%(60.80%) at epoch: 16                                     
FedRep achieved 70.0%(72.19%) at epoch: 23                                     
FedRep achieved 80.0%(80.81%) at epoch: 51                                     
FedRep achieved 90.0%(90.43%) at epoch: 126                                    
