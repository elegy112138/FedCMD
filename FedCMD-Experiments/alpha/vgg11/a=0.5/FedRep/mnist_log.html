==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6442 -> 1.5622   acc: 52.09% -> 63.72%             
client [81] (test)  loss: 1.2690 -> 2.6952   acc: 58.20% -> 48.94%             
client [21] (test)  loss: 1.3732 -> 0.3798   acc: 78.63% -> 86.04%             
client [68] (test)  loss: 0.4283 -> 0.2610   acc: 90.02% -> 91.42%             
client [93] (test)  loss: 1.0545 -> 0.7041   acc: 51.92% -> 76.92%             
client [31] (test)  loss: 2.2840 -> 8.0826   acc: 24.02% -> 13.66%             
client [20] (test)  loss: 1.0889 -> 1.1092   acc: 66.98% -> 61.42%             
client [59] (test)  loss: 1.5003 -> 0.6956   acc: 75.12% -> 76.12%             
client [48] (test)  loss: 1.2512 -> 0.7446   acc: 62.10% -> 78.34%             
client [34] (test)  loss: 0.6546 -> 0.4446   acc: 79.09% -> 87.17%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.8960 -> 0.5477   acc: 67.93% -> 83.97%             
client [99] (test)  loss: 0.8786 -> 0.9679   acc: 75.82% -> 75.24%             
client [67] (test)  loss: 0.4769 -> 0.2863   acc: 85.32% -> 91.69%             
client [0] (test)  loss: 0.3805 -> 1.7655   acc: 87.61% -> 43.24%              
client [76] (test)  loss: 0.6801 -> 1.4465   acc: 77.03% -> 48.33%             
client [41] (test)  loss: 0.8754 -> 1.0236   acc: 66.92% -> 64.16%             
client [62] (test)  loss: 1.1099 -> 0.2610   acc: 78.07% -> 92.69%             
client [2] (test)  loss: 0.6007 -> 0.0875   acc: 81.56% -> 96.53%              
client [14] (test)  loss: 0.4701 -> 0.2948   acc: 86.65% -> 90.62%             
client [46] (test)  loss: 0.3945 -> 0.2389   acc: 88.84% -> 89.70%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.1184 -> 0.0904   acc: 97.25% -> 97.80%             
client [68] (test)  loss: 0.0488 -> 0.0399   acc: 98.14% -> 98.84%             
client [57] (test)  loss: 0.4483 -> 0.4177   acc: 83.81% -> 84.76%             
client [17] (test)  loss: 0.2546 -> 0.1513   acc: 92.55% -> 95.74%             
client [54] (test)  loss: 0.0422 -> 0.0298   acc: 98.75% -> 99.25%             
client [23] (test)  loss: 0.6834 -> 0.2930   acc: 81.42% -> 89.33%             
client [35] (test)  loss: 0.4183 -> 0.3918   acc: 89.31% -> 86.90%             
client [59] (test)  loss: 0.2894 -> 0.5423   acc: 93.03% -> 79.10%             
client [31] (test)  loss: 0.4319 -> 3.8115   acc: 87.58% -> 40.17%             
client [9] (test)  loss: 0.2229 -> 0.1902   acc: 94.83% -> 93.97%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1625 -> 0.8279   acc: 94.68% -> 79.43%             
client [33] (test)  loss: 0.1087 -> 0.1230   acc: 96.95% -> 96.40%             
client [16] (test)  loss: 0.1821 -> 0.1652   acc: 94.12% -> 95.69%             
client [44] (test)  loss: 0.3198 -> 0.1032   acc: 90.89% -> 97.17%             
client [8] (test)  loss: 0.2155 -> 0.5047   acc: 93.17% -> 86.96%              
client [31] (test)  loss: 0.1800 -> 0.1799   acc: 95.45% -> 95.65%             
client [47] (test)  loss: 0.0365 -> 0.0256   acc: 99.07% -> 99.07%             
client [36] (test)  loss: 0.1013 -> 0.2172   acc: 96.56% -> 94.41%             
client [20] (test)  loss: 0.1238 -> 1.8164   acc: 96.30% -> 63.89%             
client [56] (test)  loss: 0.1941 -> 0.2469   acc: 93.95% -> 91.65%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1371 -> 0.4680   acc: 95.42% -> 87.68%              
client [60] (test)  loss: 0.0530 -> 0.0622   acc: 99.09% -> 98.18%             
client [28] (test)  loss: 0.0179 -> 0.0262   acc: 99.72% -> 99.43%             
client [25] (test)  loss: 0.2410 -> 0.2337   acc: 94.08% -> 92.90%             
client [58] (test)  loss: 0.1419 -> 0.5241   acc: 96.31% -> 85.98%             
client [44] (test)  loss: 0.0818 -> 0.1004   acc: 97.98% -> 97.57%             
client [39] (test)  loss: 0.0723 -> 0.1677   acc: 98.29% -> 97.43%             
client [29] (test)  loss: 0.1952 -> 0.2780   acc: 93.55% -> 91.40%             
client [3] (test)  loss: 0.1538 -> 0.2678   acc: 95.75% -> 91.98%              
client [84] (test)  loss: 0.0635 -> 0.0517   acc: 97.96% -> 98.17%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0483 -> 0.0804   acc: 99.15% -> 98.29%             
client [84] (test)  loss: 0.0435 -> 0.0445   acc: 98.78% -> 98.98%             
client [10] (test)  loss: 0.0797 -> 0.0704   acc: 98.04% -> 98.04%             
client [36] (test)  loss: 0.0705 -> 0.0953   acc: 97.42% -> 97.63%             
client [65] (test)  loss: 0.0339 -> 0.0312   acc: 98.96% -> 98.96%             
client [81] (test)  loss: 0.0857 -> 0.0979   acc: 97.35% -> 97.62%             
client [79] (test)  loss: 0.0583 -> 0.1168   acc: 98.56% -> 96.84%             
client [42] (test)  loss: 0.0627 -> 0.0721   acc: 98.25% -> 98.50%             
client [11] (test)  loss: 0.0820 -> 4.0219   acc: 96.91% -> 40.17%             
client [96] (test)  loss: 0.1114 -> 0.0910   acc: 97.21% -> 96.65%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1062 -> 0.1251   acc: 95.03% -> 95.03%              
client [53] (test)  loss: 0.1628 -> 0.1923   acc: 94.81% -> 95.16%             
client [52] (test)  loss: 0.1462 -> 0.1457   acc: 95.57% -> 96.06%             
client [42] (test)  loss: 0.0647 -> 0.0698   acc: 98.00% -> 98.00%             
client [69] (test)  loss: 0.1053 -> 0.1190   acc: 96.74% -> 96.20%             
client [59] (test)  loss: 0.0657 -> 0.0803   acc: 97.51% -> 97.01%             
client [7] (test)  loss: 0.0416 -> 0.0451   acc: 98.72% -> 99.23%              
client [26] (test)  loss: 0.0859 -> 0.1981   acc: 97.03% -> 94.39%             
client [49] (test)  loss: 0.1221 -> 0.2150   acc: 96.93% -> 93.56%             
client [98] (test)  loss: 0.1304 -> 0.1185   acc: 96.33% -> 96.33%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1204 -> 0.1233   acc: 96.73% -> 95.92%             
client [47] (test)  loss: 0.0218 -> 0.0221   acc: 99.26% -> 99.44%             
client [21] (test)  loss: 0.0433 -> 0.1678   acc: 99.43% -> 96.87%             
client [77] (test)  loss: 0.0691 -> 1.6673   acc: 97.67% -> 60.00%             
client [95] (test)  loss: 0.0369 -> 0.0558   acc: 98.50% -> 98.25%             
client [91] (test)  loss: 0.0589 -> 0.1057   acc: 97.89% -> 96.20%             
client [14] (test)  loss: 0.0573 -> 0.0785   acc: 98.86% -> 98.58%             
client [99] (test)  loss: 0.0513 -> 0.0968   acc: 98.26% -> 96.91%             
client [20] (test)  loss: 0.0691 -> 0.0713   acc: 96.60% -> 97.22%             
client [39] (test)  loss: 0.0413 -> 0.0422   acc: 98.57% -> 98.57%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1541 -> 0.2426   acc: 96.55% -> 95.57%             
client [62] (test)  loss: 0.1034 -> 0.1024   acc: 96.78% -> 97.66%             
client [71] (test)  loss: 0.0610 -> 0.0720   acc: 97.98% -> 97.47%             
client [97] (test)  loss: 0.1060 -> 0.1004   acc: 97.27% -> 96.65%             
client [30] (test)  loss: 0.0634 -> 0.0886   acc: 98.55% -> 97.67%             
client [88] (test)  loss: 0.0668 -> 0.0805   acc: 97.78% -> 97.33%             
client [60] (test)  loss: 0.0410 -> 0.0574   acc: 99.09% -> 98.48%             
client [82] (test)  loss: 0.0347 -> 0.0340   acc: 99.17% -> 98.89%             
client [91] (test)  loss: 0.0644 -> 0.0717   acc: 98.31% -> 97.05%             
client [57] (test)  loss: 0.0514 -> 0.0750   acc: 98.57% -> 97.14%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1412 -> 0.1419   acc: 97.10% -> 97.31%             
client [15] (test)  loss: 0.1273 -> 0.1703   acc: 96.15% -> 95.88%             
client [71] (test)  loss: 0.0783 -> 0.0755   acc: 97.98% -> 96.97%             
client [97] (test)  loss: 0.1009 -> 0.1186   acc: 97.69% -> 97.69%             
client [53] (test)  loss: 0.1650 -> 0.1278   acc: 94.81% -> 96.19%             
client [77] (test)  loss: 0.0960 -> 2.2300   acc: 96.74% -> 54.42%             
client [76] (test)  loss: 0.1096 -> 3.8392   acc: 97.13% -> 42.11%             
client [79] (test)  loss: 0.0732 -> 0.1167   acc: 97.70% -> 96.84%             
client [28] (test)  loss: 0.0115 -> 0.0432   acc: 99.72% -> 98.30%             
client [99] (test)  loss: 0.0497 -> 0.3287   acc: 98.26% -> 92.26%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1095 -> 0.1131   acc: 97.69% -> 97.90%             
client [86] (test)  loss: 0.0569 -> 0.0594   acc: 98.43% -> 98.43%             
client [34] (test)  loss: 0.1499 -> 0.1562   acc: 97.19% -> 97.36%             
client [73] (test)  loss: 0.1140 -> 0.1200   acc: 98.21% -> 98.21%             
client [5] (test)  loss: 0.0500 -> 0.1052   acc: 98.24% -> 96.98%              
client [96] (test)  loss: 0.0309 -> 0.0313   acc: 98.60% -> 99.16%             
client [22] (test)  loss: 0.0549 -> 0.0686   acc: 98.01% -> 97.73%             
client [60] (test)  loss: 0.0472 -> 0.0647   acc: 98.78% -> 97.87%             
client [66] (test)  loss: 0.0169 -> 0.0145   acc: 99.60% -> 99.60%             
client [83] (test)  loss: 0.1965 -> 0.1778   acc: 95.37% -> 95.37%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1142 -> 0.1537   acc: 97.37% -> 95.93%             
client [65] (test)  loss: 0.0295 -> 0.0345   acc: 99.22% -> 98.96%             
client [95] (test)  loss: 0.0452 -> 0.0555   acc: 98.25% -> 98.25%             
client [17] (test)  loss: 0.0890 -> 0.0984   acc: 97.52% -> 98.23%             
client [8] (test)  loss: 0.0773 -> 0.1298   acc: 97.52% -> 96.89%              
client [35] (test)  loss: 0.1271 -> 0.1819   acc: 96.55% -> 95.86%             
client [98] (test)  loss: 0.1005 -> 0.1108   acc: 97.55% -> 97.55%             
client [53] (test)  loss: 0.1149 -> 0.1432   acc: 96.19% -> 95.85%             
client [43] (test)  loss: 0.1813 -> 0.1744   acc: 94.56% -> 95.24%             
client [64] (test)  loss: 0.1113 -> 0.0986   acc: 96.81% -> 97.52%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0447 -> 0.0421   acc: 99.43% -> 98.86%             
client [88] (test)  loss: 0.0639 -> 0.0648   acc: 97.33% -> 97.78%             
client [38] (test)  loss: 0.0363 -> 0.0311   acc: 98.50% -> 98.50%             
client [3] (test)  loss: 0.1653 -> 0.1903   acc: 96.23% -> 95.75%              
client [5] (test)  loss: 0.0665 -> 0.0860   acc: 97.99% -> 96.98%              
client [41] (test)  loss: 0.0747 -> 0.0777   acc: 97.74% -> 97.99%             
client [7] (test)  loss: 0.0309 -> 0.0299   acc: 99.49% -> 99.49%              
client [37] (test)  loss: 0.2500 -> 0.3015   acc: 93.31% -> 95.86%             
client [45] (test)  loss: 0.1100 -> 1.2467   acc: 96.98% -> 62.09%             
client [47] (test)  loss: 0.0169 -> 0.0195   acc: 99.44% -> 99.44%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1267 -> 0.1165   acc: 95.69% -> 96.08%             
client [11] (test)  loss: 0.0937 -> 0.0932   acc: 97.47% -> 97.47%             
client [37] (test)  loss: 0.2529 -> 0.2773   acc: 95.22% -> 95.54%             
client [41] (test)  loss: 0.0874 -> 0.0837   acc: 97.49% -> 97.99%             
client [95] (test)  loss: 0.0531 -> 0.0498   acc: 98.25% -> 98.25%             
client [53] (test)  loss: 0.1435 -> 0.1438   acc: 95.50% -> 95.50%             
client [22] (test)  loss: 0.0722 -> 0.0601   acc: 98.30% -> 97.73%             
client [25] (test)  loss: 0.1154 -> 0.1255   acc: 95.86% -> 95.86%             
client [69] (test)  loss: 0.0847 -> 0.1040   acc: 97.28% -> 96.74%             
client [46] (test)  loss: 0.1316 -> 0.1591   acc: 98.28% -> 97.42%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0202 -> 0.0210   acc: 99.44% -> 99.44%             
client [69] (test)  loss: 0.1063 -> 0.1137   acc: 97.28% -> 97.01%             
client [82] (test)  loss: 0.0447 -> 0.0440   acc: 98.89% -> 99.17%             
client [45] (test)  loss: 0.0654 -> 0.3801   acc: 98.35% -> 88.74%             
client [7] (test)  loss: 0.0322 -> 0.0279   acc: 99.49% -> 99.74%              
client [50] (test)  loss: 0.0994 -> 0.1235   acc: 96.62% -> 96.62%             
client [35] (test)  loss: 0.1058 -> 0.1563   acc: 97.24% -> 96.21%             
client [24] (test)  loss: 0.0544 -> 0.0551   acc: 98.62% -> 98.62%             
client [15] (test)  loss: 0.1797 -> 0.1889   acc: 95.60% -> 96.15%             
client [58] (test)  loss: 0.0865 -> 0.0886   acc: 98.34% -> 98.52%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0719 -> 0.0801   acc: 98.41% -> 98.41%             
client [76] (test)  loss: 0.1255 -> 0.1380   acc: 96.89% -> 96.41%             
client [67] (test)  loss: 0.0587 -> 0.0699   acc: 98.89% -> 98.61%             
client [37] (test)  loss: 0.2620 -> 0.2781   acc: 94.90% -> 94.90%             
client [58] (test)  loss: 0.0854 -> 0.0796   acc: 98.52% -> 98.52%             
client [64] (test)  loss: 0.0947 -> 0.0915   acc: 97.87% -> 97.52%             
client [77] (test)  loss: 0.0887 -> 0.1066   acc: 97.21% -> 97.67%             
client [55] (test)  loss: 0.0146 -> 0.0152   acc: 99.16% -> 99.16%             
client [12] (test)  loss: 0.0745 -> 0.0843   acc: 98.02% -> 98.02%             
client [89] (test)  loss: 0.0758 -> 0.0694   acc: 98.27% -> 98.02%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0440 -> 0.0420   acc: 99.39% -> 99.39%             
client [51] (test)  loss: 0.0515 -> 0.0410   acc: 98.99% -> 99.25%             
client [8] (test)  loss: 0.1190 -> 0.0652   acc: 96.27% -> 97.52%              
client [18] (test)  loss: 0.0963 -> 0.0848   acc: 97.66% -> 97.40%             
client [94] (test)  loss: 0.0811 -> 0.2007   acc: 98.28% -> 94.61%             
client [81] (test)  loss: 0.0696 -> 0.0802   acc: 98.15% -> 98.15%             
client [3] (test)  loss: 0.1775 -> 0.1889   acc: 96.23% -> 96.23%              
client [11] (test)  loss: 0.0998 -> 0.1032   acc: 97.75% -> 98.03%             
client [95] (test)  loss: 0.0504 -> 0.0453   acc: 98.25% -> 98.50%             
client [67] (test)  loss: 0.0587 -> 0.0569   acc: 98.61% -> 98.89%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0508 -> 0.0537   acc: 99.15% -> 99.15%             
client [79] (test)  loss: 0.0557 -> 0.0588   acc: 98.85% -> 98.85%             
client [58] (test)  loss: 0.0838 -> 0.0808   acc: 98.52% -> 98.34%             
client [88] (test)  loss: 0.0555 -> 0.0548   acc: 97.78% -> 97.78%             
client [46] (test)  loss: 0.1575 -> 0.1731   acc: 98.71% -> 97.85%             
client [11] (test)  loss: 0.0893 -> 0.0997   acc: 98.03% -> 98.03%             
client [55] (test)  loss: 0.0156 -> 0.0162   acc: 99.16% -> 99.16%             
client [13] (test)  loss: 0.0699 -> 0.0714   acc: 97.84% -> 98.11%             
client [31] (test)  loss: 0.1363 -> 0.1506   acc: 97.72% -> 96.89%             
client [75] (test)  loss: 0.0225 -> 0.0222   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0598 -> 0.0459   acc: 97.78% -> 98.89%             
client [7] (test)  loss: 0.0312 -> 0.0379   acc: 99.23% -> 99.23%              
client [57] (test)  loss: 0.0351 -> 0.0321   acc: 98.57% -> 98.57%             
client [13] (test)  loss: 0.0534 -> 0.0635   acc: 97.84% -> 97.84%             
client [43] (test)  loss: 0.1504 -> 0.1537   acc: 95.58% -> 95.58%             
client [91] (test)  loss: 0.0725 -> 0.0712   acc: 98.31% -> 98.31%             
client [10] (test)  loss: 0.0517 -> 0.0527   acc: 99.02% -> 99.02%             
client [64] (test)  loss: 0.0821 -> 0.0763   acc: 98.23% -> 97.87%             
client [82] (test)  loss: 0.0179 -> 0.0194   acc: 98.89% -> 98.89%             
client [22] (test)  loss: 0.0759 -> 0.0637   acc: 98.30% -> 98.01%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0493 -> 0.0601   acc: 98.77% -> 98.46%             
client [23] (test)  loss: 0.0994 -> 0.0926   acc: 97.63% -> 97.63%             
client [88] (test)  loss: 0.0508 -> 0.0535   acc: 98.22% -> 97.78%             
client [98] (test)  loss: 0.1045 -> 0.1034   acc: 97.55% -> 97.14%             
client [79] (test)  loss: 0.0570 -> 0.0595   acc: 99.14% -> 98.85%             
client [21] (test)  loss: 0.0449 -> 0.0460   acc: 99.43% -> 99.43%             
client [92] (test)  loss: 0.0361 -> 0.0341   acc: 98.41% -> 98.41%             
client [56] (test)  loss: 0.0778 -> 0.0760   acc: 97.29% -> 97.29%             
client [5] (test)  loss: 0.0734 -> 0.0771   acc: 98.24% -> 98.24%              
client [52] (test)  loss: 0.1843 -> 0.1774   acc: 96.55% -> 96.55%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.0791 -> 0.0000', 'accuracy': '97.83% -> 0.00%'},          
    200: {'loss': '0.0783 -> 0.0000', 'accuracy': '98.26% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(15.00%) at epoch: 1                                      
FedRep achieved 20.0%(26.59%) at epoch: 2                                      
FedRep achieved 30.0%(31.85%) at epoch: 4                                      
FedRep achieved 50.0%(54.51%) at epoch: 6                                      
FedRep achieved 60.0%(63.92%) at epoch: 9                                      
FedRep achieved 70.0%(74.42%) at epoch: 12                                     
FedRep achieved 80.0%(82.75%) at epoch: 13                                     
FedRep achieved 90.0%(90.01%) at epoch: 22                                     
Convergence (test_after):                                                      
FedRep achieved 30.0%(32.40%) at epoch: 0                                      
FedRep achieved 40.0%(41.38%) at epoch: 3                                      
FedRep achieved 50.0%(56.53%) at epoch: 5                                      
FedRep achieved 60.0%(64.40%) at epoch: 7                                      
FedRep achieved 80.0%(82.52%) at epoch: 11                                     
FedRep achieved 90.0%(92.06%) at epoch: 20                                     
