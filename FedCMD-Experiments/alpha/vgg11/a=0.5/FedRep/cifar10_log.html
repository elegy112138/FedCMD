==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.0001,                                                        
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.8675 -> 2.0693   acc: 34.76% -> 35.67%             
client [81] (test)  loss: 1.4978 -> 1.5035   acc: 53.02% -> 56.23%             
client [21] (test)  loss: 3.4208 -> 2.0432   acc: 14.75% -> 38.25%             
client [68] (test)  loss: 1.5229 -> 1.3821   acc: 53.16% -> 50.00%             
client [93] (test)  loss: 1.5334 -> 1.5164   acc: 43.96% -> 43.41%             
client [31] (test)  loss: 1.4532 -> 1.2361   acc: 50.29% -> 57.37%             
client [20] (test)  loss: 1.4907 -> 1.7783   acc: 49.68% -> 39.61%             
client [59] (test)  loss: 2.3660 -> 1.8009   acc: 27.63% -> 44.08%             
client [48] (test)  loss: 2.0648 -> 2.1082   acc: 36.88% -> 38.30%             
client [34] (test)  loss: 1.2298 -> 1.1812   acc: 54.50% -> 58.58%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6535 -> 1.1960   acc: 35.74% -> 62.95%             
client [99] (test)  loss: 1.5952 -> 1.7579   acc: 40.92% -> 38.04%             
client [67] (test)  loss: 1.3373 -> 1.4675   acc: 51.82% -> 45.87%             
client [0] (test)  loss: 1.5206 -> 1.5217   acc: 49.22% -> 50.47%              
client [76] (test)  loss: 0.9473 -> 0.9113   acc: 67.24% -> 68.23%             
client [41] (test)  loss: 1.0812 -> 1.1791   acc: 67.96% -> 68.51%             
client [62] (test)  loss: 2.2761 -> 1.5695   acc: 24.14% -> 47.29%             
client [2] (test)  loss: 3.0258 -> 1.8702   acc: 22.58% -> 42.74%              
client [14] (test)  loss: 1.6977 -> 1.7653   acc: 41.11% -> 37.04%             
client [46] (test)  loss: 1.5224 -> 1.6394   acc: 46.12% -> 43.97%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3674 -> 1.4295   acc: 56.11% -> 56.11%             
client [68] (test)  loss: 1.1810 -> 1.1186   acc: 56.33% -> 55.70%             
client [57] (test)  loss: 1.3399 -> 1.5292   acc: 53.33% -> 48.89%             
client [17] (test)  loss: 0.8411 -> 0.7854   acc: 72.03% -> 71.83%             
client [54] (test)  loss: 1.3815 -> 1.3850   acc: 49.79% -> 52.74%             
client [23] (test)  loss: 2.4004 -> 1.5931   acc: 23.00% -> 44.09%             
client [35] (test)  loss: 0.9711 -> 1.3282   acc: 68.35% -> 59.71%             
client [59] (test)  loss: 1.4200 -> 1.5892   acc: 46.38% -> 48.36%             
client [31] (test)  loss: 1.0911 -> 1.0959   acc: 61.69% -> 62.67%             
client [9] (test)  loss: 1.4626 -> 1.6078   acc: 42.08% -> 42.32%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0257 -> 1.1532   acc: 62.16% -> 58.40%             
client [33] (test)  loss: 0.9609 -> 1.0151   acc: 63.93% -> 61.94%             
client [16] (test)  loss: 1.2921 -> 1.2918   acc: 55.04% -> 56.47%             
client [44] (test)  loss: 0.0014 -> 0.0012   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 1.1470 -> 1.3226   acc: 60.45% -> 51.98%              
client [31] (test)  loss: 1.0634 -> 1.0645   acc: 63.65% -> 64.05%             
client [47] (test)  loss: 0.8771 -> 0.9066   acc: 73.08% -> 70.09%             
client [36] (test)  loss: 1.3751 -> 1.5072   acc: 56.54% -> 50.47%             
client [20] (test)  loss: 1.1060 -> 1.3732   acc: 62.66% -> 50.65%             
client [56] (test)  loss: 1.3570 -> 1.4888   acc: 54.62% -> 50.42%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8624 -> 0.8777   acc: 73.22% -> 74.69%              
client [60] (test)  loss: 1.0587 -> 1.0394   acc: 59.03% -> 58.71%             
client [28] (test)  loss: 0.9662 -> 1.0942   acc: 62.30% -> 60.38%             
client [25] (test)  loss: 1.0371 -> 1.6253   acc: 62.34% -> 49.35%             
client [58] (test)  loss: 1.0695 -> 1.1325   acc: 63.09% -> 63.09%             
client [44] (test)  loss: 0.0013 -> 0.0011   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 1.4601 -> 2.0160   acc: 51.89% -> 43.30%             
client [29] (test)  loss: 1.1798 -> 1.3433   acc: 61.70% -> 56.03%             
client [3] (test)  loss: 0.9143 -> 0.8931   acc: 67.44% -> 66.45%              
client [84] (test)  loss: 1.3877 -> 1.4464   acc: 50.84% -> 51.97%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.3482 -> 1.5471   acc: 55.19% -> 49.73%             
client [84] (test)  loss: 1.3097 -> 1.4169   acc: 53.37% -> 53.09%             
client [10] (test)  loss: 1.2273 -> 1.2604   acc: 56.94% -> 61.92%             
client [36] (test)  loss: 1.1821 -> 1.3854   acc: 58.41% -> 55.14%             
client [65] (test)  loss: 1.2308 -> 1.2941   acc: 55.14% -> 49.53%             
client [81] (test)  loss: 1.0279 -> 1.1052   acc: 69.04% -> 66.19%             
client [79] (test)  loss: 0.2737 -> 0.2887   acc: 90.00% -> 90.00%             
client [42] (test)  loss: 0.9746 -> 1.0994   acc: 67.09% -> 66.67%             
client [11] (test)  loss: 1.3245 -> 1.3288   acc: 52.80% -> 57.34%             
client [96] (test)  loss: 1.0931 -> 1.4831   acc: 65.47% -> 48.90%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9750 -> 1.0748   acc: 65.54% -> 59.89%              
client [53] (test)  loss: 1.2411 -> 1.3101   acc: 62.30% -> 54.10%             
client [52] (test)  loss: 1.1626 -> 1.2064   acc: 61.13% -> 62.13%             
client [42] (test)  loss: 1.0198 -> 1.0654   acc: 67.95% -> 67.09%             
client [69] (test)  loss: 1.0156 -> 1.1377   acc: 69.51% -> 67.87%             
client [59] (test)  loss: 1.2715 -> 1.4565   acc: 51.64% -> 52.96%             
client [7] (test)  loss: 1.1464 -> 1.1803   acc: 63.26% -> 63.26%              
client [26] (test)  loss: 0.5957 -> 0.6032   acc: 82.33% -> 82.67%             
client [49] (test)  loss: 0.9518 -> 1.0087   acc: 71.27% -> 68.56%             
client [98] (test)  loss: 0.9273 -> 0.9125   acc: 70.11% -> 72.55%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8729 -> 0.8892   acc: 72.83% -> 74.46%             
client [47] (test)  loss: 0.7736 -> 0.8016   acc: 76.50% -> 75.64%             
client [21] (test)  loss: 1.2502 -> 1.4543   acc: 62.30% -> 53.55%             
client [77] (test)  loss: 1.1488 -> 1.4727   acc: 57.62% -> 49.39%             
client [95] (test)  loss: 1.4026 -> 1.4598   acc: 55.04% -> 52.16%             
client [91] (test)  loss: 0.7899 -> 0.8775   acc: 70.06% -> 66.17%             
client [14] (test)  loss: 1.2780 -> 1.4223   acc: 55.93% -> 51.11%             
client [99] (test)  loss: 1.2228 -> 1.5331   acc: 55.33% -> 48.99%             
client [20] (test)  loss: 0.9174 -> 1.2237   acc: 72.40% -> 58.12%             
client [39] (test)  loss: 1.3918 -> 1.8800   acc: 51.55% -> 46.39%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.0927 -> 1.2128   acc: 61.46% -> 62.79%             
client [62] (test)  loss: 1.3207 -> 1.3040   acc: 58.13% -> 57.14%             
client [71] (test)  loss: 0.5959 -> 0.6083   acc: 81.38% -> 80.52%             
client [97] (test)  loss: 1.1467 -> 1.2030   acc: 62.33% -> 61.22%             
client [30] (test)  loss: 1.4391 -> 1.8813   acc: 49.34% -> 44.10%             
client [88] (test)  loss: 0.9457 -> 0.9030   acc: 62.50% -> 67.95%             
client [60] (test)  loss: 0.9437 -> 0.9279   acc: 65.48% -> 64.19%             
client [82] (test)  loss: 0.6157 -> 0.6326   acc: 79.46% -> 79.02%             
client [91] (test)  loss: 0.7473 -> 0.8348   acc: 72.75% -> 69.76%             
client [57] (test)  loss: 1.0599 -> 1.2005   acc: 65.08% -> 58.10%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9468 -> 0.9402   acc: 66.21% -> 68.96%             
client [15] (test)  loss: 0.8664 -> 0.8991   acc: 71.95% -> 71.65%             
client [71] (test)  loss: 0.5865 -> 0.5951   acc: 80.80% -> 81.38%             
client [97] (test)  loss: 1.1032 -> 1.1661   acc: 64.54% -> 61.77%             
client [53] (test)  loss: 1.1497 -> 1.2449   acc: 60.11% -> 55.74%             
client [77] (test)  loss: 1.0773 -> 1.4507   acc: 63.72% -> 50.61%             
client [76] (test)  loss: 0.6763 -> 0.7370   acc: 77.34% -> 74.63%             
client [79] (test)  loss: 0.2265 -> 0.2429   acc: 92.00% -> 92.00%             
client [28] (test)  loss: 0.8995 -> 0.9829   acc: 64.86% -> 65.81%             
client [99] (test)  loss: 1.2053 -> 1.4478   acc: 58.50% -> 53.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.1014 -> 1.1381   acc: 63.99% -> 62.88%             
client [86] (test)  loss: 0.8325 -> 0.8488   acc: 75.82% -> 75.82%             
client [34] (test)  loss: 0.7963 -> 0.8291   acc: 71.93% -> 71.66%             
client [73] (test)  loss: 0.9756 -> 1.0675   acc: 66.15% -> 59.69%             
client [5] (test)  loss: 1.0451 -> 1.1186   acc: 66.52% -> 65.64%              
client [96] (test)  loss: 0.9070 -> 1.1480   acc: 69.89% -> 59.67%             
client [22] (test)  loss: 0.9903 -> 1.1533   acc: 66.01% -> 62.09%             
client [60] (test)  loss: 0.8837 -> 0.8919   acc: 67.10% -> 65.48%             
client [66] (test)  loss: 0.8191 -> 1.0395   acc: 68.59% -> 61.22%             
client [83] (test)  loss: 0.8441 -> 0.8792   acc: 73.81% -> 73.81%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6654 -> 0.7198   acc: 78.08% -> 73.89%             
client [65] (test)  loss: 1.0548 -> 1.1680   acc: 60.75% -> 56.07%             
client [95] (test)  loss: 1.2778 -> 1.3692   acc: 58.99% -> 55.40%             
client [17] (test)  loss: 0.6129 -> 0.6200   acc: 79.48% -> 79.68%             
client [8] (test)  loss: 0.8142 -> 0.9040   acc: 72.32% -> 68.93%              
client [35] (test)  loss: 0.8018 -> 0.8543   acc: 74.82% -> 74.10%             
client [98] (test)  loss: 0.8226 -> 0.7996   acc: 75.54% -> 75.82%             
client [53] (test)  loss: 1.1637 -> 1.2222   acc: 57.92% -> 57.92%             
client [43] (test)  loss: 0.9844 -> 0.9663   acc: 68.91% -> 70.51%             
client [64] (test)  loss: 0.8062 -> 0.8586   acc: 70.68% -> 69.92%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.1931 -> 1.3694   acc: 60.11% -> 55.74%             
client [88] (test)  loss: 0.8744 -> 0.8598   acc: 67.95% -> 68.27%             
client [38] (test)  loss: 1.1033 -> 1.2231   acc: 62.16% -> 60.54%             
client [3] (test)  loss: 0.8165 -> 0.8109   acc: 68.77% -> 70.43%              
client [5] (test)  loss: 1.0006 -> 1.0937   acc: 66.52% -> 64.76%              
client [41] (test)  loss: 0.7858 -> 0.8512   acc: 73.48% -> 75.14%             
client [7] (test)  loss: 1.0324 -> 1.0856   acc: 66.02% -> 64.36%              
client [37] (test)  loss: 1.0198 -> 1.1229   acc: 66.12% -> 64.48%             
client [45] (test)  loss: 0.5937 -> 0.8529   acc: 74.93% -> 68.39%             
client [47] (test)  loss: 0.6752 -> 0.7049   acc: 81.20% -> 79.91%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0164 -> 1.0228   acc: 65.11% -> 64.39%             
client [11] (test)  loss: 1.2274 -> 1.2314   acc: 58.04% -> 57.69%             
client [37] (test)  loss: 1.0460 -> 1.0840   acc: 65.57% -> 66.12%             
client [41] (test)  loss: 0.7928 -> 0.8298   acc: 76.52% -> 75.14%             
client [95] (test)  loss: 1.2796 -> 1.3085   acc: 58.63% -> 57.19%             
client [53] (test)  loss: 1.0873 -> 1.1943   acc: 63.93% -> 59.02%             
client [22] (test)  loss: 0.9369 -> 1.1390   acc: 68.30% -> 62.42%             
client [25] (test)  loss: 0.9563 -> 1.1536   acc: 68.83% -> 62.34%             
client [69] (test)  loss: 0.9501 -> 1.0403   acc: 68.85% -> 70.49%             
client [46] (test)  loss: 1.1703 -> 1.2109   acc: 57.11% -> 57.33%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6677 -> 0.6922   acc: 79.91% -> 78.21%             
client [69] (test)  loss: 0.9286 -> 1.0419   acc: 70.82% -> 70.49%             
client [82] (test)  loss: 0.5474 -> 0.5841   acc: 83.04% -> 79.46%             
client [45] (test)  loss: 0.6133 -> 0.7521   acc: 76.84% -> 70.30%             
client [7] (test)  loss: 1.0020 -> 1.0359   acc: 64.92% -> 65.47%              
client [50] (test)  loss: 0.6080 -> 0.6978   acc: 80.31% -> 76.21%             
client [35] (test)  loss: 0.7366 -> 0.8129   acc: 75.54% -> 72.66%             
client [24] (test)  loss: 1.1191 -> 1.1756   acc: 66.01% -> 64.03%             
client [15] (test)  loss: 0.8118 -> 0.8384   acc: 72.87% -> 73.48%             
client [58] (test)  loss: 0.8934 -> 0.9229   acc: 69.97% -> 68.04%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.5146 -> 1.4915   acc: 49.65% -> 52.48%             
client [76] (test)  loss: 0.6590 -> 0.7008   acc: 79.31% -> 75.62%             
client [67] (test)  loss: 0.8823 -> 0.9645   acc: 69.64% -> 65.02%             
client [37] (test)  loss: 1.0280 -> 1.0895   acc: 65.57% -> 66.67%             
client [58] (test)  loss: 0.8899 -> 0.9110   acc: 69.70% -> 68.87%             
client [64] (test)  loss: 0.7635 -> 0.8324   acc: 71.68% -> 69.67%             
client [77] (test)  loss: 1.0134 -> 1.3017   acc: 62.50% -> 57.32%             
client [55] (test)  loss: 0.9816 -> 1.0185   acc: 69.31% -> 71.12%             
client [12] (test)  loss: 0.3763 -> 0.3454   acc: 87.13% -> 87.46%             
client [89] (test)  loss: 1.0033 -> 1.1010   acc: 65.38% -> 62.82%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1722 -> 1.2248   acc: 59.83% -> 58.15%             
client [51] (test)  loss: 0.9125 -> 1.0791   acc: 65.38% -> 57.26%             
client [8] (test)  loss: 0.7683 -> 0.8422   acc: 74.01% -> 69.49%              
client [18] (test)  loss: 0.8698 -> 0.9882   acc: 72.59% -> 70.85%             
client [94] (test)  loss: 0.8899 -> 0.9435   acc: 67.79% -> 66.44%             
client [81] (test)  loss: 0.8755 -> 0.9182   acc: 72.24% -> 72.60%             
client [3] (test)  loss: 0.8071 -> 0.8148   acc: 68.77% -> 70.43%              
client [11] (test)  loss: 1.1419 -> 1.2281   acc: 58.74% -> 57.69%             
client [95] (test)  loss: 1.2159 -> 1.2811   acc: 62.23% -> 57.91%             
client [67] (test)  loss: 0.8560 -> 0.9395   acc: 69.64% -> 63.70%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1883 -> 1.2429   acc: 60.66% -> 58.47%             
client [79] (test)  loss: 0.1865 -> 0.2074   acc: 92.57% -> 92.29%             
client [58] (test)  loss: 0.8713 -> 0.8915   acc: 69.97% -> 68.87%             
client [88] (test)  loss: 0.8292 -> 0.8181   acc: 71.15% -> 70.83%             
client [46] (test)  loss: 1.1434 -> 1.1736   acc: 57.33% -> 58.84%             
client [11] (test)  loss: 1.1614 -> 1.2199   acc: 58.74% -> 58.04%             
client [55] (test)  loss: 0.9649 -> 0.9994   acc: 68.95% -> 70.40%             
client [13] (test)  loss: 0.5488 -> 0.6478   acc: 79.28% -> 78.73%             
client [31] (test)  loss: 0.9257 -> 0.8856   acc: 68.17% -> 71.12%             
client [75] (test)  loss: 1.2255 -> 1.2385   acc: 62.64% -> 63.19%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7354 -> 0.8526   acc: 76.90% -> 73.68%             
client [7] (test)  loss: 0.9477 -> 0.9937   acc: 69.34% -> 67.68%              
client [57] (test)  loss: 0.9745 -> 1.0530   acc: 68.89% -> 66.03%             
client [13] (test)  loss: 0.5363 -> 0.6376   acc: 80.11% -> 79.28%             
client [43] (test)  loss: 0.9196 -> 0.9221   acc: 71.15% -> 72.12%             
client [91] (test)  loss: 0.6341 -> 0.7352   acc: 77.54% -> 73.35%             
client [10] (test)  loss: 0.9945 -> 1.0611   acc: 65.48% -> 65.12%             
client [64] (test)  loss: 0.7367 -> 0.7982   acc: 74.44% -> 71.93%             
client [82] (test)  loss: 0.5327 -> 0.5439   acc: 82.81% -> 81.70%             
client [22] (test)  loss: 0.9175 -> 1.0791   acc: 71.57% -> 64.38%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8036 -> 0.9493   acc: 76.95% -> 72.08%             
client [23] (test)  loss: 1.0193 -> 1.1107   acc: 67.09% -> 63.26%             
client [88] (test)  loss: 0.8586 -> 0.8137   acc: 70.19% -> 70.83%             
client [98] (test)  loss: 0.7053 -> 0.7001   acc: 76.90% -> 76.63%             
client [79] (test)  loss: 0.1812 -> 0.2043   acc: 92.86% -> 92.57%             
client [21] (test)  loss: 1.1205 -> 1.1721   acc: 64.48% -> 61.20%             
client [92] (test)  loss: 0.7160 -> 0.7439   acc: 77.51% -> 76.60%             
client [56] (test)  loss: 1.1393 -> 1.1653   acc: 63.03% -> 60.50%             
client [5] (test)  loss: 0.9671 -> 1.0098   acc: 67.40% -> 68.72%              
client [52] (test)  loss: 1.0489 -> 1.0759   acc: 66.45% -> 66.45%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.9427 -> 0.0000', 'accuracy': '67.43% -> 0.00%'},          
    200: {'loss': '0.8607 -> 0.0000', 'accuracy': '71.11% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(11.60%) at epoch: 0                                      
FedRep achieved 20.0%(25.27%) at epoch: 2                                      
FedRep achieved 30.0%(38.82%) at epoch: 7                                      
FedRep achieved 40.0%(43.46%) at epoch: 9                                      
FedRep achieved 50.0%(52.70%) at epoch: 16                                     
FedRep achieved 60.0%(63.35%) at epoch: 28                                     
FedRep achieved 70.0%(70.32%) at epoch: 50                                     
Convergence (test_after):                                                      
FedRep achieved 50.0%(50.76%) at epoch: 0                                      
FedRep achieved 60.0%(63.76%) at epoch: 28                                     
FedRep achieved 70.0%(70.45%) at epoch: 119                                    
