==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.3083 -> 5.3007   acc: 0.35% -> 0.35%               
client [81] (test)  loss: 5.3061 -> 5.3004   acc: 0.55% -> 0.55%               
client [21] (test)  loss: 5.3254 -> 5.3157   acc: 0.72% -> 0.54%               
client [68] (test)  loss: 5.2951 -> 5.2872   acc: 1.26% -> 1.44%               
client [93] (test)  loss: 5.2739 -> 5.2488   acc: 0.90% -> 5.24%               
client [31] (test)  loss: 5.2876 -> 5.2780   acc: 0.90% -> 0.90%               
client [20] (test)  loss: 5.2920 -> 5.2828   acc: 1.43% -> 1.60%               
client [59] (test)  loss: 5.2978 -> 5.2911   acc: 0.54% -> 0.54%               
client [48] (test)  loss: 5.2657 -> 5.2545   acc: 0.72% -> 1.25%               
client [34] (test)  loss: 5.2870 -> 5.2792   acc: 0.54% -> 0.72%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.2820 -> 5.2711   acc: 0.37% -> 1.28%               
client [99] (test)  loss: 5.2865 -> 5.2783   acc: 0.36% -> 0.72%               
client [67] (test)  loss: 5.2816 -> 5.2717   acc: 1.24% -> 1.42%               
client [0] (test)  loss: 5.2926 -> 5.2800   acc: 0.90% -> 1.26%                
client [76] (test)  loss: 5.2708 -> 5.2589   acc: 1.09% -> 1.63%               
client [41] (test)  loss: 5.2653 -> 5.2517   acc: 1.08% -> 1.81%               
client [62] (test)  loss: 5.2967 -> 5.2861   acc: 0.00% -> 0.00%               
client [2] (test)  loss: 5.2720 -> 5.2573   acc: 0.97% -> 1.16%                
client [14] (test)  loss: 5.2562 -> 5.2473   acc: 0.74% -> 1.29%               
client [46] (test)  loss: 5.2844 -> 5.2725   acc: 1.44% -> 1.99%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 5.2220 -> 5.1887   acc: 2.20% -> 3.99%               
client [68] (test)  loss: 5.2406 -> 5.2206   acc: 2.88% -> 3.96%               
client [57] (test)  loss: 5.2664 -> 5.2455   acc: 0.91% -> 2.54%               
client [17] (test)  loss: 5.2181 -> 5.1937   acc: 2.39% -> 3.12%               
client [54] (test)  loss: 5.2356 -> 5.2110   acc: 2.90% -> 3.99%               
client [23] (test)  loss: 5.2477 -> 5.2301   acc: 0.79% -> 1.79%               
client [35] (test)  loss: 5.2544 -> 5.2326   acc: 1.99% -> 2.17%               
client [59] (test)  loss: 5.2531 -> 5.2356   acc: 2.34% -> 3.24%               
client [31] (test)  loss: 5.2065 -> 5.1752   acc: 4.50% -> 7.21%               
client [9] (test)  loss: 5.2565 -> 5.2405   acc: 0.88% -> 1.75%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.1376 -> 4.9175   acc: 3.63% -> 5.44%               
client [33] (test)  loss: 4.9983 -> 4.7761   acc: 3.80% -> 5.97%               
client [16] (test)  loss: 5.0471 -> 4.8149   acc: 6.09% -> 8.35%               
client [44] (test)  loss: 5.1375 -> 4.8530   acc: 3.98% -> 7.41%               
client [8] (test)  loss: 5.0272 -> 4.8233   acc: 4.72% -> 6.35%                
client [31] (test)  loss: 4.9759 -> 4.7738   acc: 7.75% -> 8.47%               
client [47] (test)  loss: 5.1862 -> 4.9431   acc: 2.95% -> 5.34%               
client [36] (test)  loss: 5.2078 -> 4.9445   acc: 2.16% -> 6.67%               
client [20] (test)  loss: 5.0838 -> 4.8314   acc: 3.39% -> 10.34%              
client [56] (test)  loss: 5.1608 -> 4.9623   acc: 1.63% -> 5.61%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0869 -> 3.9960   acc: 18.18% -> 16.73%              
client [60] (test)  loss: 4.6762 -> 3.9031   acc: 11.69% -> 14.21%             
client [28] (test)  loss: 5.1749 -> 4.7637   acc: 6.17% -> 8.53%               
client [25] (test)  loss: 5.2340 -> 4.3297   acc: 6.55% -> 10.36%              
client [58] (test)  loss: 4.9212 -> 4.6789   acc: 7.41% -> 7.05%               
client [44] (test)  loss: 4.7598 -> 4.4272   acc: 6.33% -> 13.02%              
client [39] (test)  loss: 4.1226 -> 4.5280   acc: 17.32% -> 13.55%             
client [29] (test)  loss: 5.0861 -> 4.1971   acc: 7.16% -> 15.03%              
client [3] (test)  loss: 4.1352 -> 4.2291   acc: 13.74% -> 11.03%              
client [84] (test)  loss: 4.7723 -> 4.2729   acc: 9.21% -> 15.70%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.1246 -> 3.3263   acc: 8.12% -> 28.34%              
client [84] (test)  loss: 3.5647 -> 3.6964   acc: 24.91% -> 23.65%             
client [10] (test)  loss: 4.6764 -> 3.6377   acc: 14.10% -> 17.00%             
client [36] (test)  loss: 3.6223 -> 3.8835   acc: 25.95% -> 18.20%             
client [65] (test)  loss: 3.5024 -> 3.6110   acc: 26.00% -> 26.19%             
client [81] (test)  loss: 4.2803 -> 5.2326   acc: 13.09% -> 9.09%              
client [79] (test)  loss: 3.3616 -> 3.3390   acc: 28.62% -> 30.30%             
client [42] (test)  loss: 3.3812 -> 3.4981   acc: 26.94% -> 26.40%             
client [11] (test)  loss: 4.3014 -> 3.1912   acc: 20.20% -> 36.63%             
client [96] (test)  loss: 4.9533 -> 3.5561   acc: 13.38% -> 24.23%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.3619 -> 3.6256   acc: 29.95% -> 25.95%              
client [53] (test)  loss: 3.1923 -> 3.5286   acc: 29.37% -> 25.59%             
client [52] (test)  loss: 3.5335 -> 3.3024   acc: 28.12% -> 28.49%             
client [42] (test)  loss: 2.9868 -> 3.2304   acc: 34.54% -> 30.92%             
client [69] (test)  loss: 3.3198 -> 3.7640   acc: 23.44% -> 20.51%             
client [59] (test)  loss: 3.0386 -> 3.2883   acc: 28.78% -> 29.32%             
client [7] (test)  loss: 4.6862 -> 3.3677   acc: 17.32% -> 30.54%              
client [26] (test)  loss: 3.1886 -> 3.0787   acc: 32.93% -> 32.93%             
client [49] (test)  loss: 3.1799 -> 3.6217   acc: 30.07% -> 23.55%             
client [98] (test)  loss: 2.9345 -> 3.0788   acc: 34.90% -> 31.83%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.9198 -> 2.9580   acc: 37.25% -> 34.90%             
client [47] (test)  loss: 4.4360 -> 3.0442   acc: 18.78% -> 36.10%             
client [21] (test)  loss: 2.8421 -> 2.9604   acc: 36.64% -> 35.56%             
client [77] (test)  loss: 3.0474 -> 3.0939   acc: 34.96% -> 32.17%             
client [95] (test)  loss: 2.8302 -> 3.1599   acc: 38.16% -> 34.90%             
client [91] (test)  loss: 3.0123 -> 3.1496   acc: 30.57% -> 33.11%             
client [14] (test)  loss: 3.3462 -> 3.3948   acc: 30.50% -> 29.02%             
client [99] (test)  loss: 3.4533 -> 3.7807   acc: 32.55% -> 25.90%             
client [20] (test)  loss: 3.1857 -> 2.9533   acc: 36.01% -> 38.32%             
client [39] (test)  loss: 3.3200 -> 4.0583   acc: 32.76% -> 23.67%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.2674 -> 3.1221   acc: 33.71% -> 34.26%             
client [62] (test)  loss: 2.9286 -> 3.1952   acc: 37.39% -> 36.12%             
client [71] (test)  loss: 2.6788 -> 2.7824   acc: 39.10% -> 35.50%             
client [97] (test)  loss: 2.9159 -> 2.9166   acc: 36.40% -> 35.66%             
client [30] (test)  loss: 2.8791 -> 3.0930   acc: 39.38% -> 39.75%             
client [88] (test)  loss: 2.9068 -> 2.9108   acc: 36.23% -> 37.12%             
client [60] (test)  loss: 2.5107 -> 2.9642   acc: 45.86% -> 38.49%             
client [82] (test)  loss: 2.9778 -> 3.0600   acc: 33.39% -> 33.74%             
client [91] (test)  loss: 2.8434 -> 3.1388   acc: 36.82% -> 35.30%             
client [57] (test)  loss: 2.8055 -> 2.9613   acc: 38.66% -> 38.66%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.9448 -> 3.2690   acc: 40.72% -> 38.56%             
client [15] (test)  loss: 2.8964 -> 3.1356   acc: 36.77% -> 33.93%             
client [71] (test)  loss: 2.6856 -> 2.7548   acc: 40.72% -> 36.76%             
client [97] (test)  loss: 2.9108 -> 3.1159   acc: 35.48% -> 33.09%             
client [53] (test)  loss: 2.9041 -> 3.0447   acc: 38.74% -> 36.94%             
client [77] (test)  loss: 3.0277 -> 3.0540   acc: 37.74% -> 35.30%             
client [76] (test)  loss: 2.6974 -> 2.8333   acc: 40.22% -> 41.12%             
client [79] (test)  loss: 3.0560 -> 2.9946   acc: 37.36% -> 38.66%             
client [28] (test)  loss: 2.7261 -> 2.9099   acc: 37.93% -> 37.75%             
client [99] (test)  loss: 3.4510 -> 3.5839   acc: 35.97% -> 33.63%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.0047 -> 3.2732   acc: 36.40% -> 34.01%             
client [86] (test)  loss: 2.7142 -> 2.9150   acc: 39.02% -> 35.75%             
client [34] (test)  loss: 2.9819 -> 3.3132   acc: 42.60% -> 40.43%             
client [73] (test)  loss: 2.7548 -> 2.8858   acc: 41.27% -> 41.45%             
client [5] (test)  loss: 2.9557 -> 3.3053   acc: 40.18% -> 38.74%              
client [96] (test)  loss: 3.0303 -> 3.1840   acc: 40.14% -> 38.70%             
client [22] (test)  loss: 3.0765 -> 3.1344   acc: 39.22% -> 37.08%             
client [60] (test)  loss: 2.6043 -> 2.9402   acc: 47.66% -> 41.37%             
client [66] (test)  loss: 2.9584 -> 3.2184   acc: 40.73% -> 36.55%             
client [83] (test)  loss: 2.9601 -> 3.0377   acc: 40.36% -> 40.73%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.9345 -> 3.0699   acc: 42.75% -> 41.67%             
client [65] (test)  loss: 3.4251 -> 3.6417   acc: 38.71% -> 35.67%             
client [95] (test)  loss: 2.8658 -> 3.0499   acc: 43.76% -> 42.31%             
client [17] (test)  loss: 3.5438 -> 3.0788   acc: 34.50% -> 38.72%             
client [8] (test)  loss: 3.0428 -> 3.2151   acc: 42.47% -> 39.93%              
client [35] (test)  loss: 3.2604 -> 3.6149   acc: 40.33% -> 37.07%             
client [98] (test)  loss: 2.9816 -> 3.0723   acc: 43.04% -> 40.69%             
client [53] (test)  loss: 3.0301 -> 3.3018   acc: 38.20% -> 37.66%             
client [43] (test)  loss: 2.8486 -> 2.9516   acc: 43.56% -> 42.83%             
client [64] (test)  loss: 3.2725 -> 3.1453   acc: 38.29% -> 37.57%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.2147 -> 3.0772   acc: 41.52% -> 41.16%             
client [88] (test)  loss: 3.2981 -> 3.4611   acc: 40.32% -> 39.43%             
client [38] (test)  loss: 3.4829 -> 3.7652   acc: 38.95% -> 37.86%             
client [3] (test)  loss: 3.4295 -> 3.7659   acc: 41.77% -> 39.24%              
client [5] (test)  loss: 3.3341 -> 3.5930   acc: 41.44% -> 40.00%              
client [41] (test)  loss: 3.1374 -> 3.1209   acc: 39.78% -> 39.78%             
client [7] (test)  loss: 3.3381 -> 3.2576   acc: 36.79% -> 36.79%              
client [37] (test)  loss: 3.1007 -> 3.1381   acc: 45.13% -> 43.68%             
client [45] (test)  loss: 3.2165 -> 2.7848   acc: 41.73% -> 42.61%             
client [47] (test)  loss: 3.5640 -> 3.1676   acc: 39.59% -> 38.49%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.3944 -> 3.4387   acc: 41.04% -> 40.35%             
client [11] (test)  loss: 3.2102 -> 3.5069   acc: 44.36% -> 44.36%             
client [37] (test)  loss: 3.1195 -> 3.4580   acc: 45.49% -> 43.86%             
client [41] (test)  loss: 3.1330 -> 3.2672   acc: 40.69% -> 39.96%             
client [95] (test)  loss: 3.0912 -> 3.4038   acc: 45.75% -> 45.03%             
client [53] (test)  loss: 3.3293 -> 3.5689   acc: 39.10% -> 37.30%             
client [22] (test)  loss: 3.4459 -> 3.5017   acc: 39.39% -> 38.50%             
client [25] (test)  loss: 3.2105 -> 4.9191   acc: 42.91% -> 29.09%             
client [69] (test)  loss: 3.5753 -> 3.9860   acc: 37.36% -> 36.81%             
client [46] (test)  loss: 3.0801 -> 3.6268   acc: 42.24% -> 36.64%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.8827 -> 4.2250   acc: 39.41% -> 38.12%             
client [69] (test)  loss: 3.9931 -> 4.2574   acc: 37.36% -> 36.26%             
client [82] (test)  loss: 3.7564 -> 3.7799   acc: 35.48% -> 34.61%             
client [45] (test)  loss: 3.2890 -> 3.5131   acc: 42.96% -> 38.03%             
client [7] (test)  loss: 3.7166 -> 3.3794   acc: 38.93% -> 38.39%              
client [50] (test)  loss: 3.5800 -> 3.5915   acc: 39.96% -> 37.43%             
client [35] (test)  loss: 3.9180 -> 4.2639   acc: 39.06% -> 36.53%             
client [24] (test)  loss: 3.8079 -> 3.9475   acc: 41.52% -> 36.93%             
client [15] (test)  loss: 3.8891 -> 4.1024   acc: 38.19% -> 37.30%             
client [58] (test)  loss: 4.0094 -> 4.4914   acc: 37.07% -> 36.17%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.0762 -> 4.3230   acc: 40.61% -> 42.04%             
client [76] (test)  loss: 3.6246 -> 3.7800   acc: 41.85% -> 40.04%             
client [67] (test)  loss: 3.1116 -> 3.1584   acc: 42.12% -> 43.01%             
client [37] (test)  loss: 3.8878 -> 4.0188   acc: 43.14% -> 43.86%             
client [58] (test)  loss: 4.2796 -> 4.7167   acc: 36.71% -> 37.43%             
client [64] (test)  loss: 4.1936 -> 4.1384   acc: 38.11% -> 37.02%             
client [77] (test)  loss: 4.0826 -> 4.2879   acc: 36.00% -> 35.30%             
client [55] (test)  loss: 4.6244 -> 4.5281   acc: 38.15% -> 35.83%             
client [12] (test)  loss: 3.8544 -> 4.0888   acc: 39.85% -> 39.46%             
client [89] (test)  loss: 4.7661 -> 4.8905   acc: 35.75% -> 36.48%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.9525 -> 4.4041   acc: 41.16% -> 40.07%             
client [51] (test)  loss: 3.9609 -> 4.0507   acc: 37.68% -> 35.51%             
client [8] (test)  loss: 4.0192 -> 4.3965   acc: 41.56% -> 41.56%              
client [18] (test)  loss: 3.6287 -> 3.9805   acc: 44.11% -> 42.50%             
client [94] (test)  loss: 4.5172 -> 4.6414   acc: 40.21% -> 38.49%             
client [81] (test)  loss: 4.2717 -> 4.6361   acc: 38.73% -> 39.27%             
client [3] (test)  loss: 4.2368 -> 4.6806   acc: 41.41% -> 39.42%              
client [11] (test)  loss: 3.7968 -> 4.1737   acc: 45.35% -> 45.35%             
client [95] (test)  loss: 3.9346 -> 4.1750   acc: 43.58% -> 43.76%             
client [67] (test)  loss: 3.1790 -> 3.3901   acc: 43.54% -> 43.36%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.1380 -> 4.1361   acc: 44.95% -> 41.16%             
client [79] (test)  loss: 4.6873 -> 5.2095   acc: 38.10% -> 35.50%             
client [58] (test)  loss: 4.7784 -> 5.1276   acc: 37.79% -> 37.25%             
client [88] (test)  loss: 4.4627 -> 4.6140   acc: 41.92% -> 39.96%             
client [46] (test)  loss: 4.1164 -> 5.2147   acc: 41.52% -> 34.12%             
client [11] (test)  loss: 4.0485 -> 4.4421   acc: 46.73% -> 45.35%             
client [55] (test)  loss: 5.0386 -> 5.4081   acc: 35.65% -> 36.90%             
client [13] (test)  loss: 4.6073 -> 4.8096   acc: 44.75% -> 43.19%             
client [31] (test)  loss: 4.7786 -> 4.3930   acc: 38.92% -> 38.56%             
client [75] (test)  loss: 4.2105 -> 4.6082   acc: 40.97% -> 41.16%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.8389 -> 5.1830   acc: 37.30% -> 37.84%             
client [7] (test)  loss: 4.6284 -> 5.1322   acc: 38.21% -> 36.25%              
client [57] (test)  loss: 4.7238 -> 4.6924   acc: 38.11% -> 38.48%             
client [13] (test)  loss: 4.8974 -> 5.1991   acc: 42.61% -> 43.58%             
client [43] (test)  loss: 4.3627 -> 4.4632   acc: 43.56% -> 45.01%             
client [91] (test)  loss: 4.6224 -> 3.9252   acc: 38.85% -> 39.86%             
client [10] (test)  loss: 4.4485 -> 3.9665   acc: 38.16% -> 36.89%             
client [64] (test)  loss: 4.8310 -> 5.2620   acc: 39.02% -> 38.66%             
client [82] (test)  loss: 4.8901 -> 5.2313   acc: 34.61% -> 34.43%             
client [22] (test)  loss: 4.8306 -> 5.0015   acc: 39.57% -> 37.79%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.5481 -> 4.6353   acc: 42.96% -> 42.78%             
client [23] (test)  loss: 4.9830 -> 5.0006   acc: 39.09% -> 35.32%             
client [88] (test)  loss: 5.0978 -> 5.0979   acc: 41.56% -> 40.32%             
client [98] (test)  loss: 4.8642 -> 5.1318   acc: 42.13% -> 42.13%             
client [79] (test)  loss: 5.3144 -> 5.6803   acc: 36.06% -> 35.50%             
client [21] (test)  loss: 4.8021 -> 4.6190   acc: 43.50% -> 38.09%             
client [92] (test)  loss: 4.8483 -> 5.1175   acc: 40.25% -> 39.35%             
client [56] (test)  loss: 4.7339 -> 4.9260   acc: 39.96% -> 40.33%             
client [5] (test)  loss: 5.2642 -> 5.4151   acc: 38.02% -> 37.66%              
client [52] (test)  loss: 5.6346 -> 6.0749   acc: 34.64% -> 32.96%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '2.9505 -> 0.0000', 'accuracy': '38.83% -> 0.00%'},          
    200: {'loss': '5.1150 -> 0.0000', 'accuracy': '39.58% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(11.43%) at epoch: 47                                     
FedRep achieved 20.0%(21.65%) at epoch: 54                                     
FedRep achieved 30.0%(30.82%) at epoch: 71                                     
FedRep achieved 40.0%(40.40%) at epoch: 104                                    
Convergence (test_after):                                                      
FedRep achieved 10.0%(11.88%) at epoch: 42                                     
FedRep achieved 20.0%(22.65%) at epoch: 58                                     
FedRep achieved 30.0%(30.52%) at epoch: 73                                     
FedRep achieved 40.0%(40.62%) at epoch: 140                                    
