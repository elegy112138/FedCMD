==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.0001,                                                        
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.9762 -> 2.0307   acc: 31.67% -> 34.08%             
client [81] (test)  loss: 1.6858 -> 1.7825   acc: 47.36% -> 49.54%             
client [21] (test)  loss: 2.7243 -> 1.0677   acc: 7.12% -> 65.77%              
client [68] (test)  loss: 0.0944 -> 0.0943   acc: 99.14% -> 99.14%             
client [93] (test)  loss: 1.0701 -> 1.1960   acc: 54.21% -> 51.00%             
client [31] (test)  loss: 0.0423 -> 0.0369   acc: 99.65% -> 99.48%             
client [20] (test)  loss: 1.9529 -> 1.9038   acc: 34.41% -> 37.04%             
client [59] (test)  loss: 2.7985 -> 1.8546   acc: 12.55% -> 35.15%             
client [48] (test)  loss: 1.7677 -> 1.8324   acc: 32.86% -> 28.57%             
client [34] (test)  loss: 1.8271 -> 1.8724   acc: 33.23% -> 37.42%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.3518 -> 1.6427   acc: 32.64% -> 39.58%             
client [99] (test)  loss: 1.2390 -> 1.1855   acc: 58.63% -> 58.24%             
client [67] (test)  loss: 1.5270 -> 1.8857   acc: 51.50% -> 49.50%             
client [0] (test)  loss: 1.4781 -> 1.4659   acc: 45.34% -> 48.31%              
client [76] (test)  loss: 1.1454 -> 1.3052   acc: 65.36% -> 65.96%             
client [41] (test)  loss: 1.2091 -> 1.1787   acc: 57.94% -> 57.46%             
client [62] (test)  loss: 1.6337 -> 0.8505   acc: 35.93% -> 66.89%             
client [2] (test)  loss: 2.4396 -> 1.7945   acc: 19.88% -> 52.90%              
client [14] (test)  loss: 0.7852 -> 0.8121   acc: 76.08% -> 74.74%             
client [46] (test)  loss: 1.6476 -> 1.6757   acc: 47.56% -> 38.16%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9260 -> 1.0056   acc: 70.60% -> 64.40%             
client [68] (test)  loss: 0.0838 -> 0.0827   acc: 99.14% -> 99.14%             
client [57] (test)  loss: 0.8679 -> 0.8660   acc: 73.20% -> 71.40%             
client [17] (test)  loss: 1.8018 -> 1.7891   acc: 41.51% -> 40.97%             
client [54] (test)  loss: 1.4922 -> 1.5981   acc: 51.07% -> 46.30%             
client [23] (test)  loss: 1.9974 -> 0.8693   acc: 13.33% -> 74.51%             
client [35] (test)  loss: 1.4847 -> 1.4470   acc: 55.32% -> 53.77%             
client [59] (test)  loss: 1.5828 -> 1.5819   acc: 46.03% -> 47.91%             
client [31] (test)  loss: 0.0374 -> 0.0254   acc: 99.65% -> 99.65%             
client [9] (test)  loss: 1.5170 -> 1.5548   acc: 46.93% -> 46.37%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.3722 -> 1.4324   acc: 51.57% -> 50.39%             
client [33] (test)  loss: 1.4300 -> 1.4318   acc: 47.67% -> 49.22%             
client [16] (test)  loss: 0.9906 -> 0.9743   acc: 63.31% -> 65.55%             
client [44] (test)  loss: 1.0779 -> 0.9030   acc: 59.93% -> 67.07%             
client [8] (test)  loss: 1.0570 -> 1.1127   acc: 63.42% -> 63.42%              
client [31] (test)  loss: 0.0341 -> 0.0239   acc: 99.65% -> 99.65%             
client [47] (test)  loss: 0.4885 -> 0.3508   acc: 79.21% -> 86.66%             
client [36] (test)  loss: 1.7373 -> 1.6418   acc: 40.50% -> 39.67%             
client [20] (test)  loss: 1.5875 -> 1.5718   acc: 48.99% -> 49.19%             
client [56] (test)  loss: 1.7430 -> 1.7331   acc: 35.86% -> 38.45%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.6410 -> 1.8148   acc: 45.42% -> 33.17%              
client [60] (test)  loss: 1.8969 -> 1.3810   acc: 42.14% -> 52.22%             
client [28] (test)  loss: 1.9549 -> 1.7226   acc: 31.83% -> 41.48%             
client [25] (test)  loss: 1.7215 -> 1.4140   acc: 39.82% -> 50.18%             
client [58] (test)  loss: 1.4364 -> 1.3783   acc: 48.49% -> 47.74%             
client [44] (test)  loss: 0.8738 -> 0.8363   acc: 67.94% -> 70.91%             
client [39] (test)  loss: 1.1927 -> 2.0840   acc: 57.21% -> 30.50%             
client [29] (test)  loss: 1.4715 -> 1.0634   acc: 47.58% -> 62.56%             
client [3] (test)  loss: 1.3477 -> 1.2881   acc: 53.30% -> 56.08%              
client [84] (test)  loss: 1.1425 -> 1.1654   acc: 63.31% -> 63.13%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9618 -> 0.8582   acc: 63.85% -> 69.23%             
client [84] (test)  loss: 1.0895 -> 1.1382   acc: 64.62% -> 64.43%             
client [10] (test)  loss: 1.2815 -> 1.2288   acc: 56.56% -> 55.66%             
client [36] (test)  loss: 1.4524 -> 1.4319   acc: 43.80% -> 47.11%             
client [65] (test)  loss: 0.7960 -> 0.9403   acc: 68.66% -> 60.48%             
client [81] (test)  loss: 1.4283 -> 1.4167   acc: 47.36% -> 53.92%             
client [79] (test)  loss: 1.5642 -> 1.5790   acc: 44.89% -> 45.96%             
client [42] (test)  loss: 0.8857 -> 0.9484   acc: 61.60% -> 62.09%             
client [11] (test)  loss: 0.8138 -> 0.7520   acc: 69.24% -> 73.48%             
client [96] (test)  loss: 1.2019 -> 1.2027   acc: 58.15% -> 59.81%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8940 -> 0.9374   acc: 70.13% -> 67.10%              
client [53] (test)  loss: 0.9168 -> 1.0379   acc: 71.99% -> 67.81%             
client [52] (test)  loss: 0.7643 -> 0.7013   acc: 74.41% -> 77.69%             
client [42] (test)  loss: 0.8459 -> 0.9211   acc: 66.01% -> 62.25%             
client [69] (test)  loss: 1.1968 -> 1.2633   acc: 55.21% -> 48.96%             
client [59] (test)  loss: 1.2124 -> 1.2983   acc: 62.76% -> 56.07%             
client [7] (test)  loss: 1.0719 -> 0.9350   acc: 58.07% -> 65.31%              
client [26] (test)  loss: 0.6585 -> 0.8855   acc: 77.05% -> 75.23%             
client [49] (test)  loss: 1.0838 -> 1.2154   acc: 64.94% -> 62.34%             
client [98] (test)  loss: 1.1611 -> 1.1811   acc: 62.28% -> 60.18%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.1469 -> 1.1322   acc: 60.35% -> 60.88%             
client [47] (test)  loss: 0.3784 -> 0.2535   acc: 85.25% -> 91.43%             
client [21] (test)  loss: 0.6960 -> 0.6701   acc: 76.73% -> 75.00%             
client [77] (test)  loss: 1.3242 -> 1.3752   acc: 49.91% -> 48.88%             
client [95] (test)  loss: 0.3456 -> 0.3583   acc: 87.94% -> 85.99%             
client [91] (test)  loss: 1.3995 -> 1.4556   acc: 56.69% -> 54.01%             
client [14] (test)  loss: 0.5363 -> 0.5639   acc: 82.81% -> 82.36%             
client [99] (test)  loss: 0.7333 -> 0.7262   acc: 74.90% -> 75.29%             
client [20] (test)  loss: 1.3511 -> 1.3062   acc: 57.09% -> 58.10%             
client [39] (test)  loss: 0.9943 -> 2.1117   acc: 64.78% -> 33.57%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6222 -> 0.6110   acc: 79.10% -> 80.03%             
client [62] (test)  loss: 0.4666 -> 0.4795   acc: 84.77% -> 83.44%             
client [71] (test)  loss: 1.4548 -> 1.5167   acc: 49.16% -> 47.23%             
client [97] (test)  loss: 0.8758 -> 1.0223   acc: 67.72% -> 63.96%             
client [30] (test)  loss: 0.4566 -> 0.4692   acc: 83.27% -> 82.18%             
client [88] (test)  loss: 0.5739 -> 0.9078   acc: 77.98% -> 67.89%             
client [60] (test)  loss: 1.0977 -> 1.1638   acc: 63.51% -> 61.49%             
client [82] (test)  loss: 1.2163 -> 1.2063   acc: 62.50% -> 63.46%             
client [91] (test)  loss: 1.3408 -> 1.4019   acc: 59.61% -> 57.18%             
client [57] (test)  loss: 0.5566 -> 0.5913   acc: 83.00% -> 82.20%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0273 -> 0.0211   acc: 99.65% -> 99.65%             
client [15] (test)  loss: 0.8803 -> 1.0348   acc: 72.51% -> 65.09%             
client [71] (test)  loss: 1.4253 -> 1.4861   acc: 50.12% -> 49.88%             
client [97] (test)  loss: 0.8385 -> 0.9653   acc: 70.30% -> 64.75%             
client [53] (test)  loss: 0.7436 -> 0.8486   acc: 78.62% -> 71.74%             
client [77] (test)  loss: 1.2281 -> 1.2342   acc: 53.53% -> 53.01%             
client [76] (test)  loss: 0.6963 -> 0.7447   acc: 77.76% -> 77.00%             
client [79] (test)  loss: 1.3360 -> 1.3526   acc: 54.26% -> 56.60%             
client [28] (test)  loss: 1.2595 -> 1.4630   acc: 52.41% -> 49.52%             
client [99] (test)  loss: 0.6301 -> 0.6441   acc: 80.39% -> 78.63%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7640 -> 0.9034   acc: 71.88% -> 66.34%             
client [86] (test)  loss: 0.7586 -> 0.7648   acc: 73.91% -> 73.52%             
client [34] (test)  loss: 1.1698 -> 1.2594   acc: 58.39% -> 54.84%             
client [73] (test)  loss: 0.5749 -> 0.5789   acc: 81.44% -> 80.78%             
client [5] (test)  loss: 0.5237 -> 0.5447   acc: 85.20% -> 82.80%              
client [96] (test)  loss: 0.8913 -> 0.9446   acc: 70.93% -> 70.37%             
client [22] (test)  loss: 1.3644 -> 1.4927   acc: 57.43% -> 51.45%             
client [60] (test)  loss: 0.9636 -> 1.0599   acc: 67.34% -> 65.32%             
client [66] (test)  loss: 0.0839 -> 0.0814   acc: 97.23% -> 97.23%             
client [83] (test)  loss: 1.2128 -> 1.2111   acc: 65.66% -> 65.05%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6317 -> 0.6964   acc: 80.33% -> 78.06%             
client [65] (test)  loss: 0.5756 -> 0.6993   acc: 79.64% -> 72.46%             
client [95] (test)  loss: 0.2581 -> 0.2491   acc: 91.25% -> 91.44%             
client [17] (test)  loss: 1.1214 -> 1.1791   acc: 59.30% -> 59.30%             
client [8] (test)  loss: 0.6714 -> 0.7662   acc: 78.14% -> 72.08%              
client [35] (test)  loss: 1.0370 -> 1.0442   acc: 70.13% -> 67.79%             
client [98] (test)  loss: 0.9863 -> 0.9873   acc: 69.47% -> 67.54%             
client [53] (test)  loss: 0.6722 -> 0.7604   acc: 79.85% -> 76.66%             
client [43] (test)  loss: 1.3398 -> 1.3943   acc: 53.79% -> 51.10%             
client [64] (test)  loss: 1.0070 -> 1.0520   acc: 65.10% -> 65.69%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5254 -> 0.5415   acc: 81.92% -> 82.50%             
client [88] (test)  loss: 0.4476 -> 0.8154   acc: 84.04% -> 71.93%             
client [38] (test)  loss: 0.5073 -> 0.6024   acc: 82.90% -> 80.48%             
client [3] (test)  loss: 0.9774 -> 1.0364   acc: 64.82% -> 61.62%              
client [5] (test)  loss: 0.4816 -> 0.5027   acc: 85.60% -> 82.80%              
client [41] (test)  loss: 0.6917 -> 0.7162   acc: 76.19% -> 74.29%             
client [7] (test)  loss: 0.8078 -> 0.8107   acc: 71.04% -> 69.08%              
client [37] (test)  loss: 1.0538 -> 1.2936   acc: 62.20% -> 58.75%             
client [45] (test)  loss: 0.9551 -> 1.0227   acc: 66.23% -> 64.72%             
client [47] (test)  loss: 0.1908 -> 0.1932   acc: 92.42% -> 92.70%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5976 -> 0.6346   acc: 80.11% -> 79.27%             
client [11] (test)  loss: 0.4802 -> 0.5095   acc: 85.64% -> 82.87%             
client [37] (test)  loss: 1.0253 -> 1.3281   acc: 64.79% -> 58.10%             
client [41] (test)  loss: 0.6522 -> 0.6948   acc: 77.78% -> 74.76%             
client [95] (test)  loss: 0.2410 -> 0.2338   acc: 92.02% -> 92.22%             
client [53] (test)  loss: 0.6548 -> 0.7020   acc: 81.08% -> 79.85%             
client [22] (test)  loss: 1.2412 -> 1.4432   acc: 62.14% -> 54.35%             
client [25] (test)  loss: 0.9960 -> 0.9997   acc: 65.36% -> 64.11%             
client [69] (test)  loss: 0.8953 -> 0.9405   acc: 68.40% -> 63.89%             
client [46] (test)  loss: 1.0848 -> 1.2247   acc: 65.28% -> 60.04%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1939 -> 0.1814   acc: 91.99% -> 92.84%             
client [69] (test)  loss: 0.8752 -> 0.9184   acc: 68.40% -> 68.06%             
client [82] (test)  loss: 0.9382 -> 0.9776   acc: 69.87% -> 71.15%             
client [45] (test)  loss: 0.8699 -> 0.9793   acc: 67.92% -> 66.42%             
client [7] (test)  loss: 0.8104 -> 0.7915   acc: 69.83% -> 70.59%              
client [50] (test)  loss: 0.9609 -> 0.9720   acc: 71.27% -> 69.34%             
client [35] (test)  loss: 0.9579 -> 0.9541   acc: 73.51% -> 71.95%             
client [24] (test)  loss: 0.5200 -> 0.5317   acc: 84.20% -> 84.00%             
client [15] (test)  loss: 0.7504 -> 0.8974   acc: 77.09% -> 69.41%             
client [58] (test)  loss: 0.8279 -> 0.9969   acc: 71.70% -> 64.15%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8518 -> 0.8673   acc: 68.39% -> 68.93%             
client [76] (test)  loss: 0.5570 -> 0.6232   acc: 82.75% -> 80.94%             
client [67] (test)  loss: 0.6957 -> 0.7955   acc: 76.85% -> 73.65%             
client [37] (test)  loss: 1.0113 -> 1.2229   acc: 66.95% -> 60.91%             
client [58] (test)  loss: 0.8134 -> 1.0102   acc: 71.51% -> 63.40%             
client [64] (test)  loss: 0.9061 -> 0.9381   acc: 68.24% -> 69.02%             
client [77] (test)  loss: 1.0041 -> 1.0450   acc: 62.99% -> 59.38%             
client [55] (test)  loss: 0.7387 -> 0.6796   acc: 77.45% -> 79.50%             
client [12] (test)  loss: 0.2904 -> 0.3393   acc: 89.01% -> 86.88%             
client [89] (test)  loss: 1.0365 -> 1.0171   acc: 67.32% -> 67.32%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6732 -> 0.7788   acc: 78.77% -> 74.12%             
client [51] (test)  loss: 1.0151 -> 1.4735   acc: 67.27% -> 57.58%             
client [8] (test)  loss: 0.5947 -> 0.6633   acc: 81.39% -> 77.06%              
client [18] (test)  loss: 0.7773 -> 0.9052   acc: 74.07% -> 71.91%             
client [94] (test)  loss: 0.4985 -> 0.5650   acc: 83.64% -> 82.12%             
client [81] (test)  loss: 0.9415 -> 1.0417   acc: 68.49% -> 64.48%             
client [3] (test)  loss: 0.8769 -> 0.9085   acc: 69.08% -> 66.10%              
client [11] (test)  loss: 0.4225 -> 0.4373   acc: 86.92% -> 86.19%             
client [95] (test)  loss: 0.2223 -> 0.2227   acc: 92.80% -> 93.39%             
client [67] (test)  loss: 0.7002 -> 0.7695   acc: 76.05% -> 73.05%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5114 -> 0.4414   acc: 83.46% -> 85.58%             
client [79] (test)  loss: 1.0242 -> 1.1886   acc: 67.45% -> 63.19%             
client [58] (test)  loss: 0.7658 -> 0.9838   acc: 74.53% -> 66.04%             
client [88] (test)  loss: 0.3475 -> 0.6344   acc: 88.44% -> 77.43%             
client [46] (test)  loss: 1.0165 -> 1.1264   acc: 67.27% -> 65.46%             
client [11] (test)  loss: 0.4196 -> 0.4258   acc: 87.29% -> 86.74%             
client [55] (test)  loss: 0.6373 -> 0.6468   acc: 80.41% -> 79.95%             
client [13] (test)  loss: 0.7982 -> 0.8226   acc: 75.63% -> 76.55%             
client [31] (test)  loss: 0.0228 -> 0.0198   acc: 99.83% -> 99.83%             
client [75] (test)  loss: 0.9143 -> 1.0949   acc: 67.80% -> 63.22%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5769 -> 0.6764   acc: 80.11% -> 78.12%             
client [7] (test)  loss: 0.7087 -> 0.7254   acc: 75.72% -> 74.81%              
client [57] (test)  loss: 0.3888 -> 0.4628   acc: 88.40% -> 85.60%             
client [13] (test)  loss: 0.7817 -> 0.8055   acc: 77.01% -> 77.47%             
client [43] (test)  loss: 1.1412 -> 1.2526   acc: 57.70% -> 56.23%             
client [91] (test)  loss: 1.0461 -> 1.0541   acc: 69.10% -> 70.07%             
client [10] (test)  loss: 0.7062 -> 0.7102   acc: 77.60% -> 78.05%             
client [64] (test)  loss: 0.8429 -> 0.8909   acc: 70.78% -> 69.61%             
client [82] (test)  loss: 0.8437 -> 0.8682   acc: 71.79% -> 72.12%             
client [22] (test)  loss: 1.1270 -> 1.2745   acc: 66.85% -> 60.51%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9265 -> 0.9617   acc: 69.64% -> 71.05%             
client [23] (test)  loss: 0.4497 -> 0.4978   acc: 87.45% -> 86.67%             
client [88] (test)  loss: 0.3179 -> 0.6220   acc: 88.99% -> 79.63%             
client [98] (test)  loss: 0.8236 -> 0.8398   acc: 72.46% -> 72.81%             
client [79] (test)  loss: 1.0010 -> 1.1423   acc: 69.15% -> 64.68%             
client [21] (test)  loss: 0.4301 -> 0.4184   acc: 85.96% -> 87.31%             
client [92] (test)  loss: 0.7175 -> 0.8426   acc: 79.29% -> 75.74%             
client [56] (test)  loss: 1.1069 -> 1.0641   acc: 64.54% -> 65.34%             
client [5] (test)  loss: 0.3883 -> 0.4179   acc: 89.20% -> 87.60%              
client [52] (test)  loss: 0.4113 -> 0.4003   acc: 86.58% -> 86.74%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.8436 -> 0.0000', 'accuracy': '71.49% -> 0.00%'},          
    200: {'loss': '0.6350 -> 0.0000', 'accuracy': '79.16% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(10.24%) at epoch: 0                                      
FedRep achieved 20.0%(23.99%) at epoch: 4                                      
FedRep achieved 30.0%(34.98%) at epoch: 7                                      
FedRep achieved 40.0%(48.31%) at epoch: 9                                      
FedRep achieved 50.0%(53.61%) at epoch: 16                                     
FedRep achieved 60.0%(60.65%) at epoch: 28                                     
FedRep achieved 70.0%(74.38%) at epoch: 53                                     
FedRep achieved 80.0%(82.36%) at epoch: 142                                    
Convergence (test_after):                                                      
FedRep achieved 40.0%(49.43%) at epoch: 0                                      
FedRep achieved 50.0%(51.49%) at epoch: 5                                      
FedRep achieved 60.0%(62.46%) at epoch: 23                                     
FedRep achieved 70.0%(74.11%) at epoch: 53                                     
FedRep achieved 80.0%(80.46%) at epoch: 146                                    
