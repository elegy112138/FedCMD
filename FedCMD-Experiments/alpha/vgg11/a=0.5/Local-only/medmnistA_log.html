==================== ALGORITHM: Local-only ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.1640 -> 1.6605   acc: 31.88% -> 46.38%             
client [81] (test)  loss: 0.4193 -> 0.2472   acc: 88.11% -> 92.95%             
client [21] (test)  loss: 2.4047 -> 2.2175   acc: 11.86% -> 37.97%             
client [68] (test)  loss: 2.1293 -> 1.4912   acc: 43.69% -> 43.69%             
client [93] (test)  loss: 0.9873 -> 0.9024   acc: 76.49% -> 76.49%             
client [31] (test)  loss: 1.8660 -> 1.5305   acc: 52.20% -> 52.20%             
client [20] (test)  loss: 2.2719 -> 2.1388   acc: 41.32% -> 41.32%             
client [59] (test)  loss: 2.3564 -> 1.1943   acc: 67.66% -> 67.66%             
client [48] (test)  loss: 1.2229 -> 0.9311   acc: 64.44% -> 71.93%             
client [34] (test)  loss: 1.9691 -> 1.4193   acc: 49.84% -> 49.84%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4976 -> 1.4202   acc: 44.16% -> 48.15%             
client [99] (test)  loss: 2.3323 -> 2.2619   acc: 26.61% -> 38.71%             
client [67] (test)  loss: 1.9298 -> 1.2505   acc: 43.99% -> 45.25%             
client [0] (test)  loss: 1.4928 -> 1.0251   acc: 50.72% -> 76.08%              
client [76] (test)  loss: 1.9406 -> 1.8277   acc: 19.66% -> 27.24%             
client [41] (test)  loss: 1.4209 -> 1.3070   acc: 52.83% -> 52.83%             
client [62] (test)  loss: 2.3363 -> 1.0079   acc: 70.88% -> 70.88%             
client [2] (test)  loss: 2.3878 -> 2.3456   acc: 3.57% -> 25.51%               
client [14] (test)  loss: 1.7176 -> 1.5729   acc: 44.19% -> 44.19%             
client [46] (test)  loss: 2.1619 -> 1.7143   acc: 29.94% -> 44.31%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.8274 -> 1.4960   acc: 48.21% -> 50.89%             
client [68] (test)  loss: 0.9568 -> 0.8150   acc: 69.26% -> 75.40%             
client [57] (test)  loss: 1.1291 -> 0.6633   acc: 58.60% -> 77.69%             
client [17] (test)  loss: 1.0776 -> 0.9749   acc: 63.57% -> 63.57%             
client [54] (test)  loss: 0.7265 -> 0.7238   acc: 81.27% -> 84.13%             
client [23] (test)  loss: 2.3985 -> 2.0411   acc: 0.00% -> 59.60%              
client [35] (test)  loss: 1.5468 -> 1.0512   acc: 38.30% -> 61.47%             
client [59] (test)  loss: 0.7449 -> 0.5995   acc: 67.66% -> 78.22%             
client [31] (test)  loss: 0.9467 -> 0.8476   acc: 68.81% -> 72.54%             
client [9] (test)  loss: 1.3663 -> 1.0204   acc: 53.61% -> 70.28%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.6675 -> 1.5007   acc: 34.88% -> 42.64%             
client [33] (test)  loss: 0.8824 -> 0.8030   acc: 75.66% -> 77.78%             
client [16] (test)  loss: 1.9506 -> 1.7770   acc: 29.30% -> 40.62%             
client [44] (test)  loss: 0.7152 -> 0.5376   acc: 83.02% -> 83.02%             
client [8] (test)  loss: 0.4444 -> 0.4202   acc: 86.46% -> 86.98%              
client [31] (test)  loss: 0.7362 -> 0.7158   acc: 74.92% -> 75.59%             
client [47] (test)  loss: 0.8596 -> 0.7725   acc: 64.90% -> 69.54%             
client [36] (test)  loss: 2.1980 -> 1.5914   acc: 43.61% -> 43.61%             
client [20] (test)  loss: 1.2886 -> 1.1227   acc: 63.64% -> 63.64%             
client [56] (test)  loss: 1.2445 -> 0.9905   acc: 54.91% -> 64.46%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.7049 -> 1.4411   acc: 49.59% -> 52.87%              
client [60] (test)  loss: 1.2833 -> 1.1970   acc: 55.00% -> 55.00%             
client [28] (test)  loss: 1.3673 -> 1.1767   acc: 64.05% -> 67.97%             
client [25] (test)  loss: 1.6147 -> 1.5630   acc: 50.93% -> 50.93%             
client [58] (test)  loss: 0.4805 -> 0.4052   acc: 83.33% -> 87.35%             
client [44] (test)  loss: 0.5376 -> 0.4480   acc: 83.02% -> 83.02%             
client [39] (test)  loss: 1.8349 -> 1.5855   acc: 27.12% -> 42.80%             
client [29] (test)  loss: 0.4922 -> 0.4089   acc: 82.18% -> 88.78%             
client [3] (test)  loss: 1.2167 -> 0.8672   acc: 62.46% -> 77.67%              
client [84] (test)  loss: 1.2769 -> 1.1369   acc: 49.51% -> 58.96%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.8351 -> 1.8036   acc: 37.97% -> 37.97%             
client [84] (test)  loss: 1.0784 -> 1.0623   acc: 59.28% -> 62.54%             
client [10] (test)  loss: 0.2820 -> 0.2406   acc: 89.18% -> 92.27%             
client [36] (test)  loss: 1.0910 -> 0.9420   acc: 57.32% -> 64.80%             
client [65] (test)  loss: 1.1516 -> 1.0168   acc: 65.45% -> 67.07%             
client [81] (test)  loss: 0.2024 -> 0.2083   acc: 95.59% -> 96.26%             
client [79] (test)  loss: 1.4502 -> 1.1240   acc: 59.23% -> 59.23%             
client [42] (test)  loss: 0.3667 -> 0.3373   acc: 90.14% -> 89.68%             
client [11] (test)  loss: 0.7923 -> 0.6461   acc: 73.59% -> 77.27%             
client [96] (test)  loss: 0.4317 -> 0.4880   acc: 89.53% -> 85.02%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3704 -> 0.3700   acc: 89.58% -> 90.62%              
client [53] (test)  loss: 1.1692 -> 0.9288   acc: 59.01% -> 70.93%             
client [52] (test)  loss: 0.7640 -> 0.7194   acc: 77.05% -> 79.34%             
client [42] (test)  loss: 0.3168 -> 0.3213   acc: 89.45% -> 90.14%             
client [69] (test)  loss: 0.8744 -> 0.5520   acc: 74.36% -> 79.77%             
client [59] (test)  loss: 0.3784 -> 0.3533   acc: 87.79% -> 89.44%             
client [7] (test)  loss: 0.4078 -> 0.3852   acc: 89.84% -> 90.16%              
client [26] (test)  loss: 0.3402 -> 0.3125   acc: 88.52% -> 88.22%             
client [49] (test)  loss: 1.5193 -> 1.4120   acc: 44.26% -> 48.09%             
client [98] (test)  loss: 1.1734 -> 0.8877   acc: 63.45% -> 69.30%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8877 -> 0.8878   acc: 69.30% -> 71.35%             
client [47] (test)  loss: 0.6774 -> 0.5669   acc: 73.18% -> 79.14%             
client [21] (test)  loss: 1.7680 -> 1.6931   acc: 39.66% -> 46.10%             
client [77] (test)  loss: 0.6089 -> 0.5814   acc: 79.71% -> 80.68%             
client [95] (test)  loss: 0.7228 -> 0.5832   acc: 82.35% -> 82.72%             
client [91] (test)  loss: 0.8126 -> 0.7148   acc: 73.57% -> 80.18%             
client [14] (test)  loss: 0.9959 -> 0.9497   acc: 60.47% -> 65.89%             
client [99] (test)  loss: 1.5287 -> 1.3843   acc: 56.45% -> 62.10%             
client [20] (test)  loss: 0.9580 -> 0.9300   acc: 67.77% -> 64.46%             
client [39] (test)  loss: 1.3396 -> 1.2459   acc: 44.92% -> 54.24%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7194 -> 0.7377   acc: 79.34% -> 78.69%             
client [62] (test)  loss: 0.2500 -> 0.2670   acc: 90.93% -> 91.21%             
client [71] (test)  loss: 0.7043 -> 0.6721   acc: 78.35% -> 78.87%             
client [97] (test)  loss: 0.5913 -> 0.5189   acc: 84.20% -> 85.38%             
client [30] (test)  loss: 4.7620 -> 0.4317   acc: 39.86% -> 87.50%             
client [88] (test)  loss: 0.8095 -> 0.7338   acc: 75.58% -> 78.80%             
client [60] (test)  loss: 0.8595 -> 0.7923   acc: 72.50% -> 75.00%             
client [82] (test)  loss: 1.2595 -> 1.4253   acc: 55.96% -> 53.64%             
client [91] (test)  loss: 0.7256 -> 0.7228   acc: 80.62% -> 79.30%             
client [57] (test)  loss: 0.4372 -> 0.3797   acc: 81.45% -> 89.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5381 -> 0.5740   acc: 88.14% -> 88.14%             
client [15] (test)  loss: 0.2792 -> 0.2552   acc: 91.37% -> 91.59%             
client [71] (test)  loss: 0.6721 -> 0.6371   acc: 78.87% -> 78.35%             
client [97] (test)  loss: 0.5339 -> 0.5795   acc: 86.56% -> 86.32%             
client [53] (test)  loss: 0.6326 -> 0.6051   acc: 82.27% -> 79.36%             
client [77] (test)  loss: 0.5814 -> 0.5681   acc: 80.68% -> 81.16%             
client [76] (test)  loss: 0.5353 -> 0.5071   acc: 83.10% -> 84.14%             
client [79] (test)  loss: 0.9603 -> 0.9109   acc: 64.62% -> 65.38%             
client [28] (test)  loss: 0.8322 -> 0.7316   acc: 71.24% -> 79.08%             
client [99] (test)  loss: 1.2956 -> 1.2537   acc: 62.10% -> 62.10%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5026 -> 0.5289   acc: 87.97% -> 89.39%             
client [86] (test)  loss: 0.9111 -> 1.0096   acc: 73.71% -> 65.46%             
client [34] (test)  loss: 1.4371 -> 1.1339   acc: 49.84% -> 69.84%             
client [73] (test)  loss: 0.1642 -> 0.1607   acc: 94.72% -> 94.72%             
client [5] (test)  loss: 0.6131 -> 0.5415   acc: 81.78% -> 85.13%              
client [96] (test)  loss: 0.4516 -> 0.4706   acc: 92.27% -> 92.11%             
client [22] (test)  loss: 0.8979 -> 0.8516   acc: 78.24% -> 77.41%             
client [60] (test)  loss: 0.6915 -> 2.6045   acc: 77.50% -> 67.08%             
client [66] (test)  loss: 1.0292 -> 0.9827   acc: 68.28% -> 70.97%             
client [83] (test)  loss: 0.1940 -> 0.2125   acc: 94.58% -> 95.07%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4889 -> 0.7899   acc: 85.17% -> 72.41%             
client [65] (test)  loss: 0.7603 -> 0.7094   acc: 72.36% -> 73.17%             
client [95] (test)  loss: 0.8456 -> 0.8406   acc: 83.82% -> 84.19%             
client [17] (test)  loss: 0.7042 -> 0.6871   acc: 78.44% -> 79.55%             
client [8] (test)  loss: 0.3871 -> 0.4012   acc: 90.62% -> 90.62%              
client [35] (test)  loss: 0.8141 -> 1.5885   acc: 84.63% -> 47.48%             
client [98] (test)  loss: 1.2568 -> 0.8373   acc: 61.11% -> 76.32%             
client [53] (test)  loss: 0.5808 -> 0.5790   acc: 81.98% -> 82.56%             
client [43] (test)  loss: 0.2625 -> 0.2710   acc: 94.44% -> 94.19%             
client [64] (test)  loss: 1.0627 -> 1.0332   acc: 61.63% -> 64.73%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.6523 -> 1.4666   acc: 48.47% -> 52.54%             
client [88] (test)  loss: 0.5098 -> 0.5439   acc: 83.87% -> 82.49%             
client [38] (test)  loss: 2.0594 -> 1.1505   acc: 6.45% -> 69.89%              
client [3] (test)  loss: 0.4444 -> 0.5370   acc: 88.03% -> 82.85%              
client [5] (test)  loss: 0.5416 -> 0.5607   acc: 84.39% -> 83.27%              
client [41] (test)  loss: 0.8266 -> 0.8697   acc: 74.53% -> 74.29%             
client [7] (test)  loss: 0.3777 -> 0.3862   acc: 90.49% -> 90.49%              
client [37] (test)  loss: 0.5859 -> 0.5243   acc: 84.53% -> 85.25%             
client [45] (test)  loss: 0.5724 -> 0.5099   acc: 79.60% -> 82.27%             
client [47] (test)  loss: 0.4097 -> 0.4005   acc: 88.08% -> 87.75%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7577 -> 0.9116   acc: 73.44% -> 68.36%             
client [11] (test)  loss: 0.5770 -> 0.6028   acc: 85.06% -> 85.50%             
client [37] (test)  loss: 0.4732 -> 1.2612   acc: 86.33% -> 52.88%             
client [41] (test)  loss: 0.8697 -> 0.8045   acc: 74.29% -> 82.08%             
client [95] (test)  loss: 0.6609 -> 0.7623   acc: 82.72% -> 83.82%             
client [53] (test)  loss: 0.5790 -> 0.5799   acc: 82.56% -> 84.01%             
client [22] (test)  loss: 0.9154 -> 0.9593   acc: 80.33% -> 80.33%             
client [25] (test)  loss: 1.4017 -> 1.1974   acc: 44.86% -> 64.95%             
client [69] (test)  loss: 0.4677 -> 0.5069   acc: 87.75% -> 88.03%             
client [46] (test)  loss: 0.9443 -> 0.8749   acc: 64.07% -> 67.66%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3594 -> 0.3534   acc: 90.73% -> 91.72%             
client [69] (test)  loss: 0.5538 -> 0.6023   acc: 87.18% -> 86.32%             
client [82] (test)  loss: 0.9849 -> 1.0096   acc: 70.86% -> 68.54%             
client [45] (test)  loss: 0.4875 -> 0.4378   acc: 82.27% -> 84.62%             
client [7] (test)  loss: 0.3862 -> 0.3614   acc: 90.49% -> 90.82%              
client [50] (test)  loss: 0.5895 -> 0.6063   acc: 85.57% -> 87.01%             
client [35] (test)  loss: 1.5157 -> 1.1700   acc: 46.10% -> 57.11%             
client [24] (test)  loss: 1.1972 -> 0.8967   acc: 64.73% -> 70.98%             
client [15] (test)  loss: 0.2820 -> 0.2997   acc: 92.70% -> 92.92%             
client [58] (test)  loss: 0.5619 -> 0.5756   acc: 91.98% -> 91.36%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6067 -> 0.6227   acc: 90.11% -> 90.11%             
client [76] (test)  loss: 0.5189 -> 0.5301   acc: 84.83% -> 85.17%             
client [67] (test)  loss: 0.3911 -> 0.4179   acc: 87.34% -> 86.71%             
client [37] (test)  loss: 0.8457 -> 0.5721   acc: 60.43% -> 85.61%             
client [58] (test)  loss: 0.5867 -> 0.5986   acc: 91.36% -> 91.36%             
client [64] (test)  loss: 0.8014 -> 0.8312   acc: 75.97% -> 79.07%             
client [77] (test)  loss: 0.5819 -> 1.2798   acc: 84.06% -> 44.93%             
client [55] (test)  loss: 0.2170 -> 0.2190   acc: 93.99% -> 93.99%             
client [12] (test)  loss: 0.8544 -> 2.3560   acc: 79.59% -> 32.99%             
client [89] (test)  loss: 1.1791 -> 1.2519   acc: 73.41% -> 74.91%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.1651 -> 2.2225   acc: 75.24% -> 74.59%             
client [51] (test)  loss: 1.0969 -> 1.1749   acc: 79.01% -> 79.01%             
client [8] (test)  loss: 0.4768 -> 0.4846   acc: 90.89% -> 91.15%              
client [18] (test)  loss: 0.5862 -> 0.6406   acc: 85.15% -> 82.12%             
client [94] (test)  loss: 0.9388 -> 0.9037   acc: 63.73% -> 63.73%             
client [81] (test)  loss: 0.2332 -> 0.2368   acc: 96.48% -> 96.48%             
client [3] (test)  loss: 0.4928 -> 0.5220   acc: 88.03% -> 89.00%              
client [11] (test)  loss: 0.6928 -> 0.7110   acc: 85.93% -> 85.93%             
client [95] (test)  loss: 0.8956 -> 0.9266   acc: 85.66% -> 86.40%             
client [67] (test)  loss: 0.4179 -> 0.4265   acc: 86.71% -> 87.34%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.2661 -> 1.1408   acc: 60.00% -> 65.42%             
client [79] (test)  loss: 0.4851 -> 0.4666   acc: 84.62% -> 86.15%             
client [58] (test)  loss: 0.6297 -> 0.6381   acc: 91.36% -> 91.36%             
client [88] (test)  loss: 0.5694 -> 0.4862   acc: 82.95% -> 85.71%             
client [46] (test)  loss: 0.7332 -> 0.6889   acc: 77.25% -> 79.04%             
client [11] (test)  loss: 0.7110 -> 0.7244   acc: 85.93% -> 86.36%             
client [55] (test)  loss: 0.2308 -> 0.2320   acc: 94.26% -> 94.26%             
client [13] (test)  loss: 0.4798 -> 0.4234   acc: 88.41% -> 90.68%             
client [31] (test)  loss: 0.6595 -> 0.6847   acc: 88.47% -> 88.14%             
client [75] (test)  loss: 0.1278 -> 0.1311   acc: 96.72% -> 96.72%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.0832 -> 1.1112   acc: 79.91% -> 80.35%             
client [7] (test)  loss: 0.3868 -> 0.4054   acc: 91.15% -> 91.15%              
client [57] (test)  loss: 0.3498 -> 0.3139   acc: 91.94% -> 91.67%             
client [13] (test)  loss: 0.3954 -> 0.3794   acc: 91.94% -> 91.94%             
client [43] (test)  loss: 0.3407 -> 0.3494   acc: 94.19% -> 94.19%             
client [91] (test)  loss: 0.7905 -> 0.8356   acc: 81.94% -> 82.38%             
client [10] (test)  loss: 0.3025 -> 0.3144   acc: 95.36% -> 95.36%             
client [64] (test)  loss: 0.8636 -> 0.9075   acc: 77.13% -> 78.29%             
client [82] (test)  loss: 1.4844 -> 1.9711   acc: 72.85% -> 70.86%             
client [22] (test)  loss: 1.0188 -> 1.0641   acc: 83.68% -> 83.68%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8669 -> 0.9975   acc: 66.94% -> 68.60%             
client [23] (test)  loss: 0.6921 -> 0.7236   acc: 86.36% -> 86.36%             
client [88] (test)  loss: 0.4862 -> 0.4897   acc: 85.71% -> 88.02%             
client [98] (test)  loss: 0.8910 -> 0.9802   acc: 79.53% -> 79.82%             
client [79] (test)  loss: 0.4687 -> 0.4776   acc: 85.38% -> 86.15%             
client [21] (test)  loss: 1.1036 -> 1.1223   acc: 68.14% -> 68.47%             
client [92] (test)  loss: 2.2490 -> 1.6695   acc: 14.86% -> 50.29%             
client [56] (test)  loss: 0.3696 -> 0.3859   acc: 92.57% -> 92.31%             
client [5] (test)  loss: 0.6080 -> 0.6299   acc: 85.87% -> 86.62%              
client [52] (test)  loss: 0.8688 -> 0.8941   acc: 82.30% -> 82.30%             
==================== Local-only TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.7216 -> 0.0000', 'accuracy': '78.17% -> 0.00%'},          
    200: {'loss': '0.7353 -> 0.0000', 'accuracy': '84.68% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only achieved 20.0%(20.53%) at epoch: 0                                  
Local-only achieved 30.0%(33.60%) at epoch: 3                                  
Local-only achieved 40.0%(41.57%) at epoch: 4                                  
Local-only achieved 50.0%(56.06%) at epoch: 9                                  
Local-only achieved 60.0%(61.52%) at epoch: 20                                 
Local-only achieved 70.0%(70.04%) at epoch: 28                                 
Local-only achieved 80.0%(80.27%) at epoch: 72                                 
Convergence (test_after):                                                      
Local-only achieved 40.0%(48.36%) at epoch: 0                                  
Local-only achieved 50.0%(52.25%) at epoch: 3                                  
Local-only achieved 60.0%(61.41%) at epoch: 9                                  
Local-only achieved 70.0%(73.12%) at epoch: 28                                 
Local-only achieved 80.0%(80.88%) at epoch: 67                                 
