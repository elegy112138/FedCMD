==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5672 -> 0.4010   acc: 83.63% -> 90.43%             
client [81] (test)  loss: 0.3779 -> 0.2381   acc: 88.06% -> 91.79%             
client [21] (test)  loss: 0.5537 -> 0.5005   acc: 82.12% -> 85.45%             
client [68] (test)  loss: 1.2186 -> 0.6774   acc: 47.43% -> 70.19%             
client [93] (test)  loss: 0.4738 -> 0.5694   acc: 84.50% -> 79.07%             
client [31] (test)  loss: 0.5573 -> 0.5379   acc: 80.45% -> 84.64%             
client [20] (test)  loss: 0.3144 -> 0.1842   acc: 89.18% -> 93.67%             
client [59] (test)  loss: 0.4819 -> 0.3607   acc: 87.34% -> 90.39%             
client [48] (test)  loss: 0.8200 -> 0.6728   acc: 64.64% -> 75.00%             
client [34] (test)  loss: 0.3909 -> 0.3942   acc: 87.53% -> 87.79%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3729 -> 0.4292   acc: 90.48% -> 88.69%             
client [99] (test)  loss: 0.4893 -> 0.2679   acc: 86.67% -> 92.22%             
client [67] (test)  loss: 0.4998 -> 0.4246   acc: 83.90% -> 90.14%             
client [0] (test)  loss: 0.7515 -> 0.8930   acc: 74.73% -> 78.65%              
client [76] (test)  loss: 0.8365 -> 0.3895   acc: 72.21% -> 87.75%             
client [41] (test)  loss: 0.4277 -> 0.1393   acc: 85.56% -> 95.28%             
client [62] (test)  loss: 0.4146 -> 0.2567   acc: 86.06% -> 92.33%             
client [2] (test)  loss: 0.7938 -> 0.5914   acc: 72.87% -> 83.91%              
client [14] (test)  loss: 0.3983 -> 0.4169   acc: 86.65% -> 86.38%             
client [46] (test)  loss: 0.9245 -> 0.5149   acc: 67.47% -> 78.67%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9788 -> 0.5855   acc: 67.02% -> 80.59%             
client [68] (test)  loss: 0.9987 -> 0.4952   acc: 65.20% -> 82.67%             
client [57] (test)  loss: 0.2261 -> 0.0566   acc: 93.06% -> 98.06%             
client [17] (test)  loss: 0.3785 -> 0.2904   acc: 89.06% -> 92.40%             
client [54] (test)  loss: 0.6009 -> 0.6741   acc: 81.77% -> 81.77%             
client [23] (test)  loss: 0.5547 -> 0.4895   acc: 82.50% -> 78.75%             
client [35] (test)  loss: 0.2330 -> 0.1921   acc: 92.51% -> 95.09%             
client [59] (test)  loss: 0.3105 -> 0.3068   acc: 89.96% -> 93.01%             
client [31] (test)  loss: 0.5207 -> 0.5656   acc: 83.52% -> 83.52%             
client [9] (test)  loss: 0.3127 -> 0.0926   acc: 89.86% -> 96.15%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3636 -> 0.2531   acc: 85.43% -> 93.43%             
client [33] (test)  loss: 0.7575 -> 0.1459   acc: 75.76% -> 96.46%             
client [16] (test)  loss: 0.3447 -> 0.2278   acc: 91.89% -> 95.50%             
client [44] (test)  loss: 0.4497 -> 0.2444   acc: 88.66% -> 95.10%             
client [8] (test)  loss: 0.4083 -> 0.3630   acc: 88.21% -> 92.58%              
client [31] (test)  loss: 0.5493 -> 0.5240   acc: 81.56% -> 86.87%             
client [47] (test)  loss: 0.5581 -> 0.3208   acc: 80.00% -> 93.19%             
client [36] (test)  loss: 0.2367 -> 0.1903   acc: 92.88% -> 94.42%             
client [20] (test)  loss: 0.3570 -> 0.1584   acc: 89.97% -> 95.51%             
client [56] (test)  loss: 0.3629 -> 0.5252   acc: 84.73% -> 87.68%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6019 -> 0.4681   acc: 80.86% -> 86.33%              
client [60] (test)  loss: 0.3677 -> 0.2780   acc: 88.79% -> 93.33%             
client [28] (test)  loss: 0.5407 -> 0.2652   acc: 86.48% -> 95.49%             
client [25] (test)  loss: 0.4643 -> 0.2909   acc: 86.97% -> 92.18%             
client [58] (test)  loss: 0.9234 -> 0.8505   acc: 74.73% -> 73.08%             
client [44] (test)  loss: 0.3644 -> 0.2248   acc: 91.49% -> 95.36%             
client [39] (test)  loss: 0.3125 -> 0.3787   acc: 89.36% -> 88.45%             
client [29] (test)  loss: 0.5090 -> 0.4892   acc: 85.56% -> 86.35%             
client [3] (test)  loss: 0.2681 -> 0.2751   acc: 90.86% -> 92.89%              
client [84] (test)  loss: 0.5533 -> 0.3445   acc: 83.46% -> 90.68%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6588 -> 0.5464   acc: 83.64% -> 87.58%             
client [84] (test)  loss: 0.6139 -> 0.3937   acc: 82.89% -> 90.49%             
client [10] (test)  loss: 0.3534 -> 0.3068   acc: 90.51% -> 92.41%             
client [36] (test)  loss: 0.2418 -> 0.1540   acc: 92.31% -> 95.38%             
client [65] (test)  loss: 0.5827 -> 0.5138   acc: 86.36% -> 87.66%             
client [81] (test)  loss: 0.2767 -> 0.2383   acc: 93.28% -> 93.28%             
client [79] (test)  loss: 1.1871 -> 0.5793   acc: 66.86% -> 83.86%             
client [42] (test)  loss: 0.6199 -> 0.3985   acc: 80.92% -> 88.41%             
client [11] (test)  loss: 0.2248 -> 0.1081   acc: 94.36% -> 97.52%             
client [96] (test)  loss: 0.8257 -> 0.5608   acc: 80.42% -> 83.07%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4499 -> 0.3144   acc: 88.21% -> 93.89%              
client [53] (test)  loss: 0.5900 -> 0.5110   acc: 83.39% -> 87.04%             
client [52] (test)  loss: 0.3076 -> 0.2784   acc: 90.06% -> 92.69%             
client [42] (test)  loss: 0.4821 -> 0.5505   acc: 84.06% -> 85.02%             
client [69] (test)  loss: 0.3657 -> 0.4403   acc: 89.29% -> 88.39%             
client [59] (test)  loss: 0.4002 -> 0.3701   acc: 87.77% -> 92.14%             
client [7] (test)  loss: 0.3629 -> 0.4132   acc: 87.83% -> 91.30%              
client [26] (test)  loss: 0.2253 -> 0.1143   acc: 90.71% -> 96.72%             
client [49] (test)  loss: 0.4850 -> 0.4823   acc: 85.32% -> 86.24%             
client [98] (test)  loss: 0.2437 -> 0.1630   acc: 92.63% -> 96.32%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2193 -> 0.1586   acc: 92.63% -> 96.05%             
client [47] (test)  loss: 0.7975 -> 0.3780   acc: 75.60% -> 92.09%             
client [21] (test)  loss: 0.4710 -> 0.5489   acc: 89.09% -> 87.27%             
client [77] (test)  loss: 0.3602 -> 0.3664   acc: 91.44% -> 91.94%             
client [95] (test)  loss: 0.4306 -> 0.2866   acc: 86.82% -> 92.64%             
client [91] (test)  loss: 0.2217 -> 0.1631   acc: 92.62% -> 95.93%             
client [14] (test)  loss: 0.5559 -> 0.3333   acc: 82.02% -> 89.92%             
client [99] (test)  loss: 0.2959 -> 0.2226   acc: 90.74% -> 95.19%             
client [20] (test)  loss: 0.3073 -> 0.1758   acc: 92.35% -> 95.25%             
client [39] (test)  loss: 0.3696 -> 0.3084   acc: 88.75% -> 92.40%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3095 -> 0.2922   acc: 91.81% -> 92.11%             
client [62] (test)  loss: 0.2663 -> 0.1627   acc: 93.03% -> 95.82%             
client [71] (test)  loss: 0.4048 -> 0.3482   acc: 88.89% -> 88.89%             
client [97] (test)  loss: 0.5112 -> 0.5424   acc: 88.72% -> 88.33%             
client [30] (test)  loss: 0.5597 -> 0.4743   acc: 82.24% -> 86.92%             
client [88] (test)  loss: 0.3730 -> 0.3193   acc: 88.57% -> 92.38%             
client [60] (test)  loss: 0.4637 -> 0.3904   acc: 84.55% -> 93.64%             
client [82] (test)  loss: 0.8301 -> 0.7152   acc: 80.11% -> 83.98%             
client [91] (test)  loss: 0.2013 -> 0.1458   acc: 93.13% -> 96.18%             
client [57] (test)  loss: 0.2189 -> 0.0693   acc: 93.89% -> 98.06%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.3785 -> 0.4630   acc: 87.99% -> 88.83%             
client [15] (test)  loss: 0.5249 -> 0.4450   acc: 87.72% -> 91.93%             
client [71] (test)  loss: 0.5425 -> 0.3818   acc: 85.19% -> 87.65%             
client [97] (test)  loss: 0.6557 -> 0.5300   acc: 82.88% -> 87.55%             
client [53] (test)  loss: 0.6434 -> 0.5145   acc: 80.73% -> 88.37%             
client [77] (test)  loss: 0.5551 -> 0.3940   acc: 84.63% -> 92.19%             
client [76] (test)  loss: 0.8388 -> 0.5191   acc: 78.06% -> 87.02%             
client [79] (test)  loss: 0.9329 -> 0.6058   acc: 74.93% -> 82.42%             
client [28] (test)  loss: 0.5628 -> 0.2746   acc: 87.32% -> 95.49%             
client [99] (test)  loss: 0.1857 -> 0.2251   acc: 94.81% -> 94.44%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6496 -> 0.5380   acc: 82.49% -> 87.94%             
client [86] (test)  loss: 0.3987 -> 0.4547   acc: 92.29% -> 92.00%             
client [34] (test)  loss: 0.3354 -> 0.2537   acc: 92.11% -> 93.89%             
client [73] (test)  loss: 0.3300 -> 0.3220   acc: 91.94% -> 93.59%             
client [5] (test)  loss: 0.2666 -> 0.2583   acc: 94.47% -> 96.31%              
client [96] (test)  loss: 0.8308 -> 0.5773   acc: 80.69% -> 86.24%             
client [22] (test)  loss: 1.2678 -> 0.5015   acc: 70.13% -> 88.93%             
client [60] (test)  loss: 0.3578 -> 0.2975   acc: 90.30% -> 93.33%             
client [66] (test)  loss: 0.5288 -> 0.2983   acc: 89.24% -> 94.02%             
client [83] (test)  loss: 0.5169 -> 0.3330   acc: 88.89% -> 92.13%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5265 -> 0.4825   acc: 85.74% -> 89.03%             
client [65] (test)  loss: 0.5434 -> 0.4753   acc: 85.06% -> 88.64%             
client [95] (test)  loss: 0.5019 -> 0.3268   acc: 85.27% -> 92.64%             
client [17] (test)  loss: 0.3111 -> 0.3206   acc: 90.27% -> 93.01%             
client [8] (test)  loss: 0.4157 -> 0.3375   acc: 88.65% -> 95.20%              
client [35] (test)  loss: 0.1572 -> 0.1475   acc: 95.61% -> 97.16%             
client [98] (test)  loss: 0.2298 -> 0.1485   acc: 92.37% -> 96.32%             
client [53] (test)  loss: 0.6159 -> 0.5360   acc: 86.71% -> 87.04%             
client [43] (test)  loss: 0.3393 -> 0.2218   acc: 90.45% -> 92.96%             
client [64] (test)  loss: 0.3480 -> 0.2715   acc: 88.57% -> 92.86%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7263 -> 0.5295   acc: 84.55% -> 88.18%             
client [88] (test)  loss: 0.3421 -> 0.3051   acc: 90.79% -> 93.02%             
client [38] (test)  loss: 0.7681 -> 0.4509   acc: 80.66% -> 90.06%             
client [3] (test)  loss: 0.2058 -> 0.2647   acc: 93.91% -> 94.16%              
client [5] (test)  loss: 0.3965 -> 0.2477   acc: 91.24% -> 95.62%              
client [41] (test)  loss: 0.3948 -> 0.1381   acc: 89.44% -> 96.39%             
client [7] (test)  loss: 0.4992 -> 0.3184   acc: 84.35% -> 92.39%              
client [37] (test)  loss: 0.5173 -> 0.1661   acc: 85.42% -> 95.83%             
client [45] (test)  loss: 0.4124 -> 0.2451   acc: 90.16% -> 95.21%             
client [47] (test)  loss: 0.7298 -> 0.3320   acc: 80.66% -> 91.87%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3420 -> 0.2439   acc: 93.39% -> 95.20%             
client [11] (test)  loss: 0.2145 -> 0.1013   acc: 94.81% -> 97.97%             
client [37] (test)  loss: 0.4174 -> 0.1611   acc: 88.02% -> 95.57%             
client [41] (test)  loss: 0.3030 -> 0.1251   acc: 90.56% -> 97.22%             
client [95] (test)  loss: 0.5548 -> 0.2653   acc: 82.95% -> 91.86%             
client [53] (test)  loss: 0.6785 -> 0.5136   acc: 82.06% -> 87.38%             
client [22] (test)  loss: 1.0643 -> 0.4842   acc: 74.83% -> 89.60%             
client [25] (test)  loss: 0.4841 -> 0.3118   acc: 88.93% -> 93.32%             
client [69] (test)  loss: 0.3392 -> 0.4674   acc: 91.67% -> 89.88%             
client [46] (test)  loss: 0.5594 -> 0.3582   acc: 84.80% -> 91.20%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.8674 -> 0.2765   acc: 77.36% -> 93.19%             
client [69] (test)  loss: 0.3515 -> 0.3995   acc: 91.37% -> 91.07%             
client [82] (test)  loss: 1.1574 -> 1.0427   acc: 76.80% -> 78.73%             
client [45] (test)  loss: 0.4450 -> 0.2758   acc: 89.36% -> 94.95%             
client [7] (test)  loss: 0.3221 -> 0.3437   acc: 89.35% -> 93.04%              
client [50] (test)  loss: 0.4270 -> 0.3180   acc: 88.24% -> 93.84%             
client [35] (test)  loss: 0.2275 -> 0.1490   acc: 94.32% -> 96.12%             
client [24] (test)  loss: 0.8905 -> 0.6851   acc: 75.00% -> 83.78%             
client [15] (test)  loss: 0.4674 -> 0.4466   acc: 89.82% -> 90.88%             
client [58] (test)  loss: 0.9404 -> 0.8443   acc: 79.40% -> 78.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5646 -> 0.4704   acc: 83.21% -> 84.64%             
client [76] (test)  loss: 0.6839 -> 0.5349   acc: 83.00% -> 86.84%             
client [67] (test)  loss: 0.4002 -> 0.3167   acc: 89.54% -> 92.35%             
client [37] (test)  loss: 0.4830 -> 0.2407   acc: 88.54% -> 93.75%             
client [58] (test)  loss: 0.9891 -> 1.0091   acc: 78.57% -> 80.49%             
client [64] (test)  loss: 0.2099 -> 0.2362   acc: 93.43% -> 94.29%             
client [77] (test)  loss: 0.5382 -> 0.3764   acc: 88.41% -> 93.95%             
client [55] (test)  loss: 0.4077 -> 0.2085   acc: 89.25% -> 96.26%             
client [12] (test)  loss: 0.2948 -> 0.3731   acc: 92.14% -> 92.41%             
client [89] (test)  loss: 0.4312 -> 0.3225   acc: 90.28% -> 92.16%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6231 -> 0.3900   acc: 86.31% -> 92.40%             
client [51] (test)  loss: 0.4465 -> 0.0997   acc: 86.79% -> 97.84%             
client [8] (test)  loss: 0.3767 -> 0.3371   acc: 91.27% -> 94.32%              
client [18] (test)  loss: 0.2990 -> 0.3056   acc: 91.78% -> 93.15%             
client [94] (test)  loss: 0.3012 -> 0.2911   acc: 91.90% -> 94.18%             
client [81] (test)  loss: 0.2444 -> 0.2245   acc: 93.28% -> 93.28%             
client [3] (test)  loss: 0.2178 -> 0.2880   acc: 93.65% -> 93.91%              
client [11] (test)  loss: 0.1858 -> 0.0945   acc: 95.03% -> 98.65%             
client [95] (test)  loss: 0.5741 -> 0.3098   acc: 86.05% -> 93.02%             
client [67] (test)  loss: 0.3453 -> 0.3373   acc: 90.74% -> 92.35%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5945 -> 0.5652   acc: 87.88% -> 88.79%             
client [79] (test)  loss: 1.2979 -> 0.6969   acc: 70.03% -> 83.57%             
client [58] (test)  loss: 1.0984 -> 0.8507   acc: 76.65% -> 79.67%             
client [88] (test)  loss: 0.2786 -> 0.2788   acc: 93.02% -> 93.65%             
client [46] (test)  loss: 0.4334 -> 0.3373   acc: 90.13% -> 92.27%             
client [11] (test)  loss: 0.1921 -> 0.1050   acc: 94.36% -> 98.19%             
client [55] (test)  loss: 0.4888 -> 0.2503   acc: 87.15% -> 96.26%             
client [13] (test)  loss: 0.4672 -> 0.3480   acc: 87.37% -> 91.24%             
client [31] (test)  loss: 0.4095 -> 0.4175   acc: 89.39% -> 90.78%             
client [75] (test)  loss: 0.1379 -> 0.0848   acc: 96.74% -> 98.10%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3308 -> 0.2469   acc: 93.43% -> 96.71%             
client [7] (test)  loss: 0.3974 -> 0.3490   acc: 88.48% -> 92.17%              
client [57] (test)  loss: 0.2357 -> 0.0736   acc: 95.56% -> 98.33%             
client [13] (test)  loss: 0.4476 -> 0.3319   acc: 89.18% -> 91.24%             
client [43] (test)  loss: 0.2539 -> 0.2870   acc: 91.46% -> 91.96%             
client [91] (test)  loss: 0.2210 -> 0.1300   acc: 94.66% -> 95.93%             
client [10] (test)  loss: 0.4170 -> 0.3267   acc: 91.14% -> 93.67%             
client [64] (test)  loss: 0.2046 -> 0.2592   acc: 94.29% -> 94.57%             
client [82] (test)  loss: 1.4725 -> 0.8217   acc: 71.82% -> 85.36%             
client [22] (test)  loss: 1.3188 -> 0.5628   acc: 73.15% -> 89.60%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2547 -> 0.1770   acc: 95.78% -> 96.31%             
client [23] (test)  loss: 0.5391 -> 0.2929   acc: 85.00% -> 91.25%             
client [88] (test)  loss: 0.3830 -> 0.3667   acc: 89.84% -> 90.79%             
client [98] (test)  loss: 0.1683 -> 0.1480   acc: 95.26% -> 96.58%             
client [79] (test)  loss: 0.9251 -> 0.7227   acc: 77.23% -> 83.86%             
client [21] (test)  loss: 0.7241 -> 0.6177   acc: 86.36% -> 89.39%             
client [92] (test)  loss: 0.1972 -> 0.1239   acc: 96.71% -> 97.22%             
client [56] (test)  loss: 0.3320 -> 0.5340   acc: 89.90% -> 88.18%             
client [5] (test)  loss: 0.4615 -> 0.2828   acc: 89.40% -> 96.08%              
client [52] (test)  loss: 0.2423 -> 0.2581   acc: 92.11% -> 94.74%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4849 -> 0.0000', 'accuracy': '86.71% -> 0.00%'},          
    200: {'loss': '0.4860 -> 0.0000', 'accuracy': '88.83% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 60.0%(60.16%) at epoch: 1                                      
FedDyn achieved 70.0%(76.63%) at epoch: 3                                      
FedDyn achieved 80.0%(86.46%) at epoch: 10                                     
FedDyn achieved 90.0%(90.71%) at epoch: 67                                     
Convergence (test_after):                                                      
FedDyn achieved 70.0%(74.40%) at epoch: 0                                      
FedDyn achieved 80.0%(80.91%) at epoch: 1                                      
FedDyn achieved 90.0%(90.75%) at epoch: 11                                     
