==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.3983 -> 4.0296   acc: 6.56% -> 13.77%              
client [81] (test)  loss: 4.2756 -> 3.7340   acc: 7.89% -> 20.07%              
client [21] (test)  loss: 4.6801 -> 3.8866   acc: 5.57% -> 16.03%              
client [68] (test)  loss: 4.8253 -> 3.8488   acc: 4.86% -> 15.20%              
client [93] (test)  loss: 4.2375 -> 3.7171   acc: 10.42% -> 21.82%             
client [31] (test)  loss: 4.4929 -> 3.9721   acc: 5.09% -> 17.82%              
client [20] (test)  loss: 4.1902 -> 3.9559   acc: 10.00% -> 13.79%             
client [59] (test)  loss: 4.2622 -> 3.6553   acc: 10.03% -> 18.12%             
client [48] (test)  loss: 4.4048 -> 3.8291   acc: 5.57% -> 17.70%              
client [34] (test)  loss: 4.1315 -> 3.8265   acc: 7.01% -> 14.76%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.9606 -> 3.4546   acc: 13.31% -> 25.18%             
client [99] (test)  loss: 4.1856 -> 3.6986   acc: 10.26% -> 21.79%             
client [67] (test)  loss: 3.8327 -> 3.3545   acc: 14.33% -> 26.38%             
client [0] (test)  loss: 3.7706 -> 3.0920   acc: 16.00% -> 27.67%              
client [76] (test)  loss: 4.0783 -> 4.0039   acc: 8.71% -> 13.26%              
client [41] (test)  loss: 4.0818 -> 3.5848   acc: 9.97% -> 17.94%              
client [62] (test)  loss: 4.1157 -> 3.5088   acc: 8.91% -> 20.13%              
client [2] (test)  loss: 3.8806 -> 3.3163   acc: 11.59% -> 24.83%              
client [14] (test)  loss: 3.9798 -> 3.8011   acc: 12.46% -> 17.25%             
client [46] (test)  loss: 4.0590 -> 3.6565   acc: 9.30% -> 19.93%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.6772 -> 3.5958   acc: 17.01% -> 22.22%             
client [68] (test)  loss: 3.9288 -> 3.5040   acc: 17.33% -> 21.88%             
client [57] (test)  loss: 3.6875 -> 3.3130   acc: 18.12% -> 25.24%             
client [17] (test)  loss: 4.4831 -> 3.7253   acc: 7.31% -> 21.93%              
client [54] (test)  loss: 3.7144 -> 3.4590   acc: 15.76% -> 26.69%             
client [23] (test)  loss: 3.8546 -> 3.7309   acc: 16.00% -> 20.33%             
client [35] (test)  loss: 3.8651 -> 3.4207   acc: 14.43% -> 22.62%             
client [59] (test)  loss: 3.6731 -> 3.2481   acc: 17.15% -> 25.24%             
client [31] (test)  loss: 3.8174 -> 3.6581   acc: 12.36% -> 19.27%             
client [9] (test)  loss: 3.7584 -> 3.4121   acc: 15.64% -> 24.76%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.6244 -> 3.1287   acc: 18.27% -> 29.90%             
client [33] (test)  loss: 3.5365 -> 3.4641   acc: 18.77% -> 23.21%             
client [16] (test)  loss: 3.9361 -> 2.8265   acc: 16.32% -> 33.95%             
client [44] (test)  loss: 3.4339 -> 3.0483   acc: 20.79% -> 29.37%             
client [8] (test)  loss: 3.4353 -> 3.1806   acc: 20.63% -> 26.67%              
client [31] (test)  loss: 3.9315 -> 3.5456   acc: 9.82% -> 21.09%              
client [47] (test)  loss: 3.8757 -> 3.3738   acc: 16.88% -> 26.88%             
client [36] (test)  loss: 3.3167 -> 3.3165   acc: 23.75% -> 28.33%             
client [20] (test)  loss: 3.3599 -> 3.1071   acc: 20.34% -> 24.83%             
client [56] (test)  loss: 3.8240 -> 3.4861   acc: 14.69% -> 25.17%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.3908 -> 3.1703   acc: 23.44% -> 32.60%              
client [60] (test)  loss: 3.4366 -> 3.2840   acc: 18.15% -> 25.93%             
client [28] (test)  loss: 3.5180 -> 3.1145   acc: 14.84% -> 26.45%             
client [25] (test)  loss: 3.4113 -> 2.9948   acc: 20.39% -> 30.42%             
client [58] (test)  loss: 3.3175 -> 2.8463   acc: 23.58% -> 35.85%             
client [44] (test)  loss: 3.3022 -> 2.9300   acc: 19.80% -> 32.34%             
client [39] (test)  loss: 3.6616 -> 3.5587   acc: 17.49% -> 24.75%             
client [29] (test)  loss: 3.5297 -> 3.0806   acc: 19.93% -> 29.90%             
client [3] (test)  loss: 3.5486 -> 2.8942   acc: 22.01% -> 31.07%              
client [84] (test)  loss: 3.2591 -> 3.2475   acc: 22.74% -> 28.66%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.6565 -> 2.9466   acc: 16.72% -> 31.71%             
client [84] (test)  loss: 3.3129 -> 3.2195   acc: 20.87% -> 29.28%             
client [10] (test)  loss: 3.3705 -> 2.7251   acc: 21.97% -> 33.77%             
client [36] (test)  loss: 3.1307 -> 3.1633   acc: 26.25% -> 29.58%             
client [65] (test)  loss: 2.9460 -> 2.6833   acc: 25.89% -> 37.54%             
client [81] (test)  loss: 3.4321 -> 3.2437   acc: 21.71% -> 30.59%             
client [79] (test)  loss: 3.4440 -> 2.9443   acc: 21.26% -> 30.23%             
client [42] (test)  loss: 3.5605 -> 3.3209   acc: 20.75% -> 29.59%             
client [11] (test)  loss: 3.3289 -> 3.0248   acc: 23.86% -> 31.23%             
client [96] (test)  loss: 3.3522 -> 3.1029   acc: 22.98% -> 30.74%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.2161 -> 2.8916   acc: 24.44% -> 31.75%              
client [53] (test)  loss: 3.4435 -> 2.8247   acc: 20.72% -> 28.95%             
client [52] (test)  loss: 3.6135 -> 2.7568   acc: 17.48% -> 31.39%             
client [42] (test)  loss: 3.4079 -> 3.3568   acc: 23.13% -> 28.23%             
client [69] (test)  loss: 3.2558 -> 3.2301   acc: 23.38% -> 31.29%             
client [59] (test)  loss: 3.1062 -> 2.9376   acc: 27.83% -> 31.07%             
client [7] (test)  loss: 3.4323 -> 3.0407   acc: 18.53% -> 34.82%              
client [26] (test)  loss: 3.5988 -> 3.0144   acc: 17.94% -> 32.89%             
client [49] (test)  loss: 3.3724 -> 3.0986   acc: 22.18% -> 31.45%             
client [98] (test)  loss: 3.2467 -> 3.0145   acc: 23.78% -> 28.34%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.0795 -> 2.9203   acc: 28.01% -> 29.32%             
client [47] (test)  loss: 3.6740 -> 3.0469   acc: 20.62% -> 32.50%             
client [21] (test)  loss: 3.6559 -> 2.8001   acc: 18.82% -> 33.45%             
client [77] (test)  loss: 3.4671 -> 3.2392   acc: 20.98% -> 26.89%             
client [95] (test)  loss: 3.4815 -> 3.1583   acc: 19.14% -> 26.07%             
client [91] (test)  loss: 3.2445 -> 2.7480   acc: 22.76% -> 36.22%             
client [14] (test)  loss: 3.3086 -> 3.1530   acc: 24.92% -> 30.35%             
client [99] (test)  loss: 3.4676 -> 3.1037   acc: 20.51% -> 32.37%             
client [20] (test)  loss: 2.8574 -> 2.7257   acc: 32.07% -> 35.17%             
client [39] (test)  loss: 3.4545 -> 3.4287   acc: 22.11% -> 26.07%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.2765 -> 2.6956   acc: 21.68% -> 34.30%             
client [62] (test)  loss: 3.0153 -> 2.8898   acc: 28.71% -> 35.31%             
client [71] (test)  loss: 3.5270 -> 3.6391   acc: 23.99% -> 30.74%             
client [97] (test)  loss: 3.2963 -> 2.7758   acc: 23.84% -> 35.91%             
client [30] (test)  loss: 2.7688 -> 3.0003   acc: 32.33% -> 32.33%             
client [88] (test)  loss: 3.1819 -> 2.8048   acc: 26.95% -> 36.17%             
client [60] (test)  loss: 3.0428 -> 3.1699   acc: 25.19% -> 31.11%             
client [82] (test)  loss: 3.1103 -> 2.9962   acc: 31.06% -> 33.79%             
client [91] (test)  loss: 3.1401 -> 2.6826   acc: 26.60% -> 37.50%             
client [57] (test)  loss: 3.3188 -> 2.9224   acc: 23.62% -> 32.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.3722 -> 3.1348   acc: 25.45% -> 31.27%             
client [15] (test)  loss: 3.3717 -> 2.8773   acc: 21.45% -> 33.00%             
client [71] (test)  loss: 3.5223 -> 3.6073   acc: 22.64% -> 31.42%             
client [97] (test)  loss: 3.3492 -> 2.7900   acc: 25.08% -> 36.53%             
client [53] (test)  loss: 3.3317 -> 2.7125   acc: 22.37% -> 35.20%             
client [77] (test)  loss: 3.1999 -> 3.0916   acc: 24.92% -> 30.82%             
client [76] (test)  loss: 3.2009 -> 3.5528   acc: 23.48% -> 27.27%             
client [79] (test)  loss: 3.2391 -> 2.8171   acc: 25.91% -> 35.88%             
client [28] (test)  loss: 3.3060 -> 2.8376   acc: 21.94% -> 33.23%             
client [99] (test)  loss: 3.2835 -> 3.0432   acc: 23.72% -> 33.97%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.2057 -> 2.8832   acc: 29.10% -> 37.77%             
client [86] (test)  loss: 3.1176 -> 3.2011   acc: 30.52% -> 33.44%             
client [34] (test)  loss: 3.0710 -> 2.9215   acc: 26.57% -> 31.00%             
client [73] (test)  loss: 3.1478 -> 3.0598   acc: 24.92% -> 34.63%             
client [5] (test)  loss: 3.3268 -> 3.2256   acc: 25.17% -> 28.48%              
client [96] (test)  loss: 2.9906 -> 2.9317   acc: 27.83% -> 33.98%             
client [22] (test)  loss: 3.2187 -> 2.8455   acc: 26.16% -> 34.44%             
client [60] (test)  loss: 3.0366 -> 3.0255   acc: 25.93% -> 31.85%             
client [66] (test)  loss: 3.2666 -> 3.4849   acc: 24.25% -> 23.26%             
client [83] (test)  loss: 3.4746 -> 3.3084   acc: 21.16% -> 25.26%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.1641 -> 3.4709   acc: 26.89% -> 28.03%             
client [65] (test)  loss: 2.8780 -> 2.3274   acc: 29.45% -> 48.87%             
client [95] (test)  loss: 3.2709 -> 3.1063   acc: 20.46% -> 27.39%             
client [17] (test)  loss: 3.9156 -> 3.2396   acc: 16.37% -> 29.53%             
client [8] (test)  loss: 2.9086 -> 2.7586   acc: 31.75% -> 37.46%              
client [35] (test)  loss: 3.0585 -> 2.9158   acc: 28.52% -> 36.07%             
client [98] (test)  loss: 2.7826 -> 2.7812   acc: 29.32% -> 35.83%             
client [53] (test)  loss: 3.1807 -> 2.6509   acc: 25.66% -> 35.86%             
client [43] (test)  loss: 3.5621 -> 3.1618   acc: 21.78% -> 30.03%             
client [64] (test)  loss: 3.2231 -> 2.7993   acc: 25.91% -> 39.53%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.4650 -> 2.7015   acc: 25.44% -> 37.98%             
client [88] (test)  loss: 3.2284 -> 2.7862   acc: 27.30% -> 36.17%             
client [38] (test)  loss: 2.6568 -> 2.0863   acc: 32.46% -> 49.18%             
client [3] (test)  loss: 3.2970 -> 2.6611   acc: 28.80% -> 39.81%              
client [5] (test)  loss: 3.3209 -> 3.1985   acc: 25.50% -> 32.45%              
client [41] (test)  loss: 3.3077 -> 3.0053   acc: 26.58% -> 32.56%             
client [7] (test)  loss: 3.3249 -> 2.9085   acc: 24.60% -> 35.78%              
client [37] (test)  loss: 3.1973 -> 2.6649   acc: 28.05% -> 36.30%             
client [45] (test)  loss: 2.8975 -> 2.5804   acc: 31.56% -> 42.52%             
client [47] (test)  loss: 3.3793 -> 2.9016   acc: 25.94% -> 36.88%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.4612 -> 2.4103   acc: 28.68% -> 48.95%             
client [11] (test)  loss: 3.0484 -> 2.6611   acc: 26.32% -> 39.30%             
client [37] (test)  loss: 3.0691 -> 2.6476   acc: 28.38% -> 37.95%             
client [41] (test)  loss: 3.2062 -> 2.9751   acc: 28.90% -> 34.22%             
client [95] (test)  loss: 3.3335 -> 3.1464   acc: 21.45% -> 30.03%             
client [53] (test)  loss: 3.2586 -> 2.6588   acc: 24.01% -> 36.18%             
client [22] (test)  loss: 3.1458 -> 2.8269   acc: 29.14% -> 38.41%             
client [25] (test)  loss: 3.0419 -> 2.6248   acc: 31.07% -> 42.07%             
client [69] (test)  loss: 3.2748 -> 3.0614   acc: 28.06% -> 34.89%             
client [46] (test)  loss: 3.3150 -> 3.2637   acc: 26.91% -> 31.89%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.1120 -> 2.9033   acc: 30.00% -> 38.75%             
client [69] (test)  loss: 3.2139 -> 3.0946   acc: 26.98% -> 36.33%             
client [82] (test)  loss: 3.0938 -> 2.9128   acc: 28.33% -> 35.49%             
client [45] (test)  loss: 2.9274 -> 2.5286   acc: 33.22% -> 44.85%             
client [7] (test)  loss: 3.2613 -> 2.8426   acc: 24.60% -> 36.74%              
client [50] (test)  loss: 2.9937 -> 3.0524   acc: 30.90% -> 37.54%             
client [35] (test)  loss: 3.0275 -> 3.0001   acc: 30.16% -> 36.07%             
client [24] (test)  loss: 3.0196 -> 3.1075   acc: 31.94% -> 33.33%             
client [15] (test)  loss: 3.2172 -> 2.8022   acc: 26.40% -> 33.66%             
client [58] (test)  loss: 2.7582 -> 2.7477   acc: 38.36% -> 39.31%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.2239 -> 3.0264   acc: 29.51% -> 32.79%             
client [76] (test)  loss: 3.1403 -> 3.6328   acc: 28.79% -> 27.65%             
client [67] (test)  loss: 2.4251 -> 2.3973   acc: 43.65% -> 49.51%             
client [37] (test)  loss: 2.9041 -> 2.6380   acc: 32.67% -> 38.94%             
client [58] (test)  loss: 2.8393 -> 2.7966   acc: 34.59% -> 39.62%             
client [64] (test)  loss: 3.0255 -> 2.7009   acc: 30.23% -> 41.53%             
client [77] (test)  loss: 3.0532 -> 2.9713   acc: 33.44% -> 33.77%             
client [55] (test)  loss: 3.3069 -> 3.1940   acc: 24.47% -> 32.62%             
client [12] (test)  loss: 3.2720 -> 3.2498   acc: 26.58% -> 33.89%             
client [89] (test)  loss: 3.2999 -> 2.9739   acc: 27.97% -> 39.87%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.0254 -> 3.2189   acc: 29.60% -> 31.78%             
client [51] (test)  loss: 2.8424 -> 2.4943   acc: 34.88% -> 44.19%             
client [8] (test)  loss: 2.8808 -> 2.7756   acc: 32.70% -> 38.10%              
client [18] (test)  loss: 3.0554 -> 2.7145   acc: 32.13% -> 42.62%             
client [94] (test)  loss: 3.3695 -> 2.7326   acc: 24.73% -> 45.58%             
client [81] (test)  loss: 3.0103 -> 3.0317   acc: 28.29% -> 38.82%             
client [3] (test)  loss: 3.2219 -> 2.6837   acc: 32.04% -> 42.72%              
client [11] (test)  loss: 2.7594 -> 2.6752   acc: 32.63% -> 40.00%             
client [95] (test)  loss: 3.1962 -> 3.2392   acc: 24.42% -> 31.35%             
client [67] (test)  loss: 2.5117 -> 2.4198   acc: 41.69% -> 50.81%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.7394 -> 2.7252   acc: 24.04% -> 40.07%             
client [79] (test)  loss: 3.1255 -> 2.6858   acc: 29.24% -> 39.87%             
client [58] (test)  loss: 2.9850 -> 2.7958   acc: 35.85% -> 39.94%             
client [88] (test)  loss: 3.0610 -> 2.6538   acc: 32.98% -> 42.91%             
client [46] (test)  loss: 3.5326 -> 3.2980   acc: 23.92% -> 35.22%             
client [11] (test)  loss: 3.1842 -> 2.6504   acc: 29.47% -> 41.40%             
client [55] (test)  loss: 3.3649 -> 3.3780   acc: 24.11% -> 31.21%             
client [13] (test)  loss: 2.9752 -> 2.7724   acc: 33.45% -> 37.98%             
client [31] (test)  loss: 3.2946 -> 3.0708   acc: 25.82% -> 32.73%             
client [75] (test)  loss: 3.4104 -> 2.7202   acc: 26.57% -> 45.07%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.1688 -> 2.8234   acc: 27.04% -> 36.16%             
client [7] (test)  loss: 3.2659 -> 2.8472   acc: 28.12% -> 39.94%              
client [57] (test)  loss: 2.8763 -> 2.7764   acc: 32.69% -> 38.83%             
client [13] (test)  loss: 3.0340 -> 2.7483   acc: 31.01% -> 40.42%             
client [43] (test)  loss: 3.4665 -> 3.1535   acc: 27.39% -> 31.68%             
client [91] (test)  loss: 2.9684 -> 2.7355   acc: 29.81% -> 41.03%             
client [10] (test)  loss: 2.9154 -> 2.4816   acc: 31.15% -> 42.62%             
client [64] (test)  loss: 2.8639 -> 2.8207   acc: 31.56% -> 42.52%             
client [82] (test)  loss: 2.9732 -> 2.8248   acc: 35.15% -> 38.23%             
client [22] (test)  loss: 2.9968 -> 2.7434   acc: 32.45% -> 39.07%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.5270 -> 2.4766   acc: 37.93% -> 43.79%             
client [23] (test)  loss: 3.3071 -> 3.1214   acc: 31.00% -> 36.00%             
client [88] (test)  loss: 2.9580 -> 2.6742   acc: 31.56% -> 44.33%             
client [98] (test)  loss: 2.7730 -> 2.8430   acc: 32.90% -> 36.81%             
client [79] (test)  loss: 2.8345 -> 2.6474   acc: 37.21% -> 39.87%             
client [21] (test)  loss: 3.2571 -> 2.7532   acc: 26.13% -> 38.68%             
client [92] (test)  loss: 3.2532 -> 3.0016   acc: 28.00% -> 37.00%             
client [56] (test)  loss: 2.9628 -> 2.9012   acc: 31.47% -> 34.97%             
client [5] (test)  loss: 3.2646 -> 3.3237   acc: 27.15% -> 35.10%              
client [52] (test)  loss: 3.2698 -> 2.9971   acc: 30.42% -> 37.86%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.1900 -> 0.0000', 'accuracy': '25.80% -> 0.00%'},          
    200: {'loss': '3.0644 -> 0.0000', 'accuracy': '31.52% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 10.0%(10.47%) at epoch: 15                                     
FedDyn achieved 20.0%(20.25%) at epoch: 49                                     
FedDyn achieved 30.0%(31.31%) at epoch: 132                                    
Convergence (test_after):                                                      
FedDyn achieved 10.0%(15.13%) at epoch: 1                                      
FedDyn achieved 20.0%(21.86%) at epoch: 17                                     
FedDyn achieved 30.0%(30.18%) at epoch: 57                                     
FedDyn achieved 40.0%(40.72%) at epoch: 153                                    
