==================== ALGORITHM: FedDyn ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9458 -> 0.6641   acc: 72.00% -> 78.39%             
client [81] (test)  loss: 0.6203 -> 0.3822   acc: 80.79% -> 85.35%             
client [21] (test)  loss: 0.3543 -> 0.1883   acc: 90.85% -> 93.81%             
client [68] (test)  loss: 0.3625 -> 0.1069   acc: 89.21% -> 97.00%             
client [93] (test)  loss: 0.6401 -> 0.3428   acc: 81.16% -> 91.18%             
client [31] (test)  loss: 0.7699 -> 0.5573   acc: 76.54% -> 81.47%             
client [20] (test)  loss: 0.8871 -> 0.6439   acc: 72.79% -> 80.76%             
client [59] (test)  loss: 0.8195 -> 0.4930   acc: 73.11% -> 81.74%             
client [48] (test)  loss: 0.7793 -> 0.5370   acc: 71.88% -> 81.98%             
client [34] (test)  loss: 0.6993 -> 0.4971   acc: 81.20% -> 85.19%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4259 -> 0.2264   acc: 84.60% -> 94.48%             
client [99] (test)  loss: 1.0379 -> 0.3912   acc: 70.52% -> 89.05%             
client [67] (test)  loss: 0.7698 -> 0.4227   acc: 77.19% -> 86.37%             
client [0] (test)  loss: 0.4472 -> 0.2365   acc: 85.97% -> 93.65%              
client [76] (test)  loss: 1.1843 -> 0.4838   acc: 72.31% -> 84.36%             
client [41] (test)  loss: 2.2041 -> 0.6829   acc: 45.63% -> 78.66%             
client [62] (test)  loss: 1.5594 -> 0.5573   acc: 63.14% -> 81.83%             
client [2] (test)  loss: 0.3069 -> 0.2400   acc: 89.69% -> 91.82%              
client [14] (test)  loss: 0.5918 -> 0.3551   acc: 82.82% -> 90.73%             
client [46] (test)  loss: 0.7540 -> 0.4312   acc: 78.55% -> 86.55%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4187 -> 0.2666   acc: 87.20% -> 92.99%             
client [68] (test)  loss: 0.2118 -> 0.0566   acc: 93.43% -> 98.51%             
client [57] (test)  loss: 0.2798 -> 0.2437   acc: 92.50% -> 93.11%             
client [17] (test)  loss: 0.3278 -> 0.1716   acc: 89.62% -> 95.31%             
client [54] (test)  loss: 0.6324 -> 0.4141   acc: 81.12% -> 87.43%             
client [23] (test)  loss: 0.6170 -> 0.4151   acc: 79.28% -> 85.58%             
client [35] (test)  loss: 1.9631 -> 0.5635   acc: 56.05% -> 83.43%             
client [59] (test)  loss: 0.7599 -> 0.3945   acc: 76.23% -> 84.68%             
client [31] (test)  loss: 0.5819 -> 0.4480   acc: 82.25% -> 84.85%             
client [9] (test)  loss: 2.1337 -> 0.6798   acc: 53.42% -> 76.51%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8316 -> 0.4902   acc: 75.11% -> 81.76%             
client [33] (test)  loss: 0.8046 -> 0.5589   acc: 74.90% -> 81.40%             
client [16] (test)  loss: 0.5000 -> 0.3108   acc: 85.32% -> 91.13%             
client [44] (test)  loss: 1.0829 -> 0.6324   acc: 69.06% -> 78.97%             
client [8] (test)  loss: 0.7518 -> 0.4843   acc: 80.08% -> 85.91%              
client [31] (test)  loss: 0.5764 -> 0.4477   acc: 82.79% -> 85.66%             
client [47] (test)  loss: 0.5036 -> 0.3358   acc: 82.63% -> 88.47%             
client [36] (test)  loss: 0.6312 -> 0.4455   acc: 81.47% -> 86.36%             
client [20] (test)  loss: 0.8206 -> 0.4612   acc: 76.22% -> 86.53%             
client [56] (test)  loss: 1.0750 -> 0.4523   acc: 66.79% -> 85.52%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2851 -> 0.2721   acc: 92.15% -> 92.36%              
client [60] (test)  loss: 0.5247 -> 0.2743   acc: 79.15% -> 92.16%             
client [28] (test)  loss: 0.6202 -> 0.4336   acc: 82.65% -> 85.95%             
client [25] (test)  loss: 0.2504 -> 0.0237   acc: 92.36% -> 99.47%             
client [58] (test)  loss: 0.2188 -> 0.1233   acc: 92.83% -> 96.51%             
client [44] (test)  loss: 0.8635 -> 0.6388   acc: 72.12% -> 78.94%             
client [39] (test)  loss: 0.4247 -> 0.3711   acc: 87.25% -> 89.55%             
client [29] (test)  loss: 1.0160 -> 0.6116   acc: 69.27% -> 79.27%             
client [3] (test)  loss: 0.4549 -> 0.2637   acc: 85.53% -> 92.70%              
client [84] (test)  loss: 0.3978 -> 0.2479   acc: 86.82% -> 93.14%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2772 -> 0.1204   acc: 92.46% -> 96.21%             
client [84] (test)  loss: 0.4929 -> 0.2446   acc: 80.72% -> 93.14%             
client [10] (test)  loss: 0.6699 -> 0.4310   acc: 80.27% -> 86.30%             
client [36] (test)  loss: 0.5076 -> 0.4404   acc: 82.35% -> 86.49%             
client [65] (test)  loss: 1.0768 -> 0.5118   acc: 60.01% -> 80.76%             
client [81] (test)  loss: 0.4295 -> 0.2839   acc: 84.14% -> 88.92%             
client [79] (test)  loss: 0.5595 -> 0.3337   acc: 84.15% -> 90.10%             
client [42] (test)  loss: 0.2793 -> 0.1928   acc: 90.49% -> 94.84%             
client [11] (test)  loss: 0.5725 -> 0.3365   acc: 84.32% -> 90.21%             
client [96] (test)  loss: 0.6444 -> 0.3464   acc: 78.84% -> 88.67%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8777 -> 0.4685   acc: 76.61% -> 86.35%              
client [53] (test)  loss: 0.9160 -> 0.4606   acc: 76.67% -> 84.99%             
client [52] (test)  loss: 0.9000 -> 0.4958   acc: 76.62% -> 85.70%             
client [42] (test)  loss: 0.3198 -> 0.1860   acc: 88.39% -> 94.86%             
client [69] (test)  loss: 0.2098 -> 0.1809   acc: 94.39% -> 96.27%             
client [59] (test)  loss: 0.7594 -> 0.3637   acc: 80.01% -> 86.48%             
client [7] (test)  loss: 0.5277 -> 0.3251   acc: 82.81% -> 89.29%              
client [26] (test)  loss: 0.2570 -> 0.1710   acc: 89.71% -> 93.17%             
client [49] (test)  loss: 0.2171 -> 0.1395   acc: 94.00% -> 96.24%             
client [98] (test)  loss: 0.1751 -> 0.1217   acc: 94.38% -> 96.15%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1661 -> 0.1115   acc: 95.44% -> 96.44%             
client [47] (test)  loss: 0.4919 -> 0.3044   acc: 82.31% -> 89.41%             
client [21] (test)  loss: 0.1861 -> 0.1281   acc: 95.25% -> 96.21%             
client [77] (test)  loss: 0.6977 -> 0.4901   acc: 81.01% -> 83.60%             
client [95] (test)  loss: 0.2276 -> 0.0744   acc: 92.58% -> 98.31%             
client [91] (test)  loss: 0.7568 -> 0.4479   acc: 77.29% -> 85.96%             
client [14] (test)  loss: 0.3166 -> 0.2847   acc: 90.73% -> 92.92%             
client [99] (test)  loss: 0.7702 -> 0.3139   acc: 79.82% -> 91.09%             
client [20] (test)  loss: 0.8270 -> 0.4099   acc: 77.33% -> 88.37%             
client [39] (test)  loss: 0.4271 -> 0.3359   acc: 87.99% -> 90.89%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6467 -> 0.4701   acc: 76.86% -> 86.43%             
client [62] (test)  loss: 0.8784 -> 0.4669   acc: 75.95% -> 85.20%             
client [71] (test)  loss: 0.7608 -> 0.5246   acc: 70.29% -> 82.95%             
client [97] (test)  loss: 0.3356 -> 0.1209   acc: 86.99% -> 96.66%             
client [30] (test)  loss: 0.2800 -> 0.2495   acc: 90.96% -> 92.94%             
client [88] (test)  loss: 0.4462 -> 0.3316   acc: 85.00% -> 87.98%             
client [60] (test)  loss: 0.5017 -> 0.2681   acc: 81.48% -> 92.57%             
client [82] (test)  loss: 0.7148 -> 0.4020   acc: 79.60% -> 87.18%             
client [91] (test)  loss: 0.5448 -> 0.4292   acc: 80.54% -> 86.70%             
client [57] (test)  loss: 0.3367 -> 0.2105   acc: 89.38% -> 94.29%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5402 -> 0.4021   acc: 83.99% -> 88.09%             
client [15] (test)  loss: 0.8507 -> 0.4886   acc: 75.92% -> 85.59%             
client [71] (test)  loss: 0.8943 -> 0.5148   acc: 72.59% -> 84.15%             
client [97] (test)  loss: 0.2379 -> 0.1213   acc: 92.23% -> 96.62%             
client [53] (test)  loss: 0.7986 -> 0.4744   acc: 78.55% -> 85.28%             
client [77] (test)  loss: 0.6886 -> 0.4554   acc: 80.84% -> 84.48%             
client [76] (test)  loss: 0.9450 -> 0.3897   acc: 70.29% -> 88.20%             
client [79] (test)  loss: 0.6080 -> 0.3337   acc: 83.82% -> 90.91%             
client [28] (test)  loss: 0.6880 -> 0.4094   acc: 82.09% -> 87.15%             
client [99] (test)  loss: 0.6009 -> 0.3136   acc: 84.88% -> 91.38%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2904 -> 0.1241   acc: 90.18% -> 96.57%             
client [86] (test)  loss: 0.3803 -> 0.2348   acc: 88.86% -> 93.75%             
client [34] (test)  loss: 0.5683 -> 0.3726   acc: 83.23% -> 90.21%             
client [73] (test)  loss: 0.6649 -> 0.5319   acc: 78.98% -> 83.96%             
client [5] (test)  loss: 0.7509 -> 0.4263   acc: 76.83% -> 88.01%              
client [96] (test)  loss: 0.5591 -> 0.3783   acc: 81.91% -> 89.10%             
client [22] (test)  loss: 0.7897 -> 0.5882   acc: 76.77% -> 82.18%             
client [60] (test)  loss: 0.5025 -> 0.2691   acc: 81.23% -> 92.91%             
client [66] (test)  loss: 0.4547 -> 0.3355   acc: 85.56% -> 90.20%             
client [83] (test)  loss: 0.3857 -> 0.1371   acc: 88.21% -> 95.95%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7046 -> 0.4157   acc: 80.47% -> 87.52%             
client [65] (test)  loss: 1.4730 -> 0.4859   acc: 57.70% -> 82.26%             
client [95] (test)  loss: 0.2838 -> 0.0679   acc: 91.12% -> 98.67%             
client [17] (test)  loss: 0.3233 -> 0.1080   acc: 90.50% -> 96.83%             
client [8] (test)  loss: 0.7234 -> 0.4445   acc: 82.16% -> 87.00%              
client [35] (test)  loss: 1.6571 -> 0.5740   acc: 59.60% -> 85.67%             
client [98] (test)  loss: 0.1638 -> 0.1015   acc: 95.32% -> 96.95%             
client [53] (test)  loss: 0.9341 -> 0.4891   acc: 76.98% -> 85.40%             
client [43] (test)  loss: 0.3679 -> 0.2640   acc: 90.27% -> 93.88%             
client [64] (test)  loss: 0.7190 -> 0.4498   acc: 76.43% -> 83.52%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3420 -> 0.1251   acc: 89.33% -> 96.57%             
client [88] (test)  loss: 0.4536 -> 0.3191   acc: 85.31% -> 88.83%             
client [38] (test)  loss: 0.1824 -> 0.1088   acc: 95.87% -> 97.82%             
client [3] (test)  loss: 0.4607 -> 0.2495   acc: 87.97% -> 93.95%              
client [5] (test)  loss: 0.9354 -> 0.4302   acc: 76.30% -> 88.18%              
client [41] (test)  loss: 1.1505 -> 0.5708   acc: 61.51% -> 82.30%             
client [7] (test)  loss: 0.3775 -> 0.3316   acc: 88.00% -> 89.17%              
client [37] (test)  loss: 0.6206 -> 0.3680   acc: 82.25% -> 88.88%             
client [45] (test)  loss: 0.9479 -> 0.4989   acc: 75.71% -> 84.66%             
client [47] (test)  loss: 0.4070 -> 0.3137   acc: 84.58% -> 90.01%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4626 -> 0.2836   acc: 88.56% -> 92.87%             
client [11] (test)  loss: 0.6322 -> 0.3528   acc: 83.17% -> 90.04%             
client [37] (test)  loss: 0.5765 -> 0.3885   acc: 84.01% -> 89.29%             
client [41] (test)  loss: 1.5725 -> 0.5545   acc: 54.21% -> 82.69%             
client [95] (test)  loss: 0.2588 -> 0.0634   acc: 91.58% -> 98.72%             
client [53] (test)  loss: 1.0241 -> 0.5042   acc: 76.41% -> 85.33%             
client [22] (test)  loss: 0.9375 -> 0.5855   acc: 75.83% -> 82.27%             
client [25] (test)  loss: 0.2780 -> 0.0217   acc: 90.57% -> 99.60%             
client [69] (test)  loss: 0.3029 -> 0.1714   acc: 89.44% -> 96.75%             
client [46] (test)  loss: 0.4861 -> 0.3758   acc: 87.31% -> 89.61%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3673 -> 0.3472   acc: 86.16% -> 89.85%             
client [69] (test)  loss: 0.3405 -> 0.1746   acc: 88.42% -> 96.84%             
client [82] (test)  loss: 0.7500 -> 0.4221   acc: 82.64% -> 87.73%             
client [45] (test)  loss: 0.9883 -> 0.5015   acc: 76.53% -> 84.98%             
client [7] (test)  loss: 0.3804 -> 0.3393   acc: 88.05% -> 88.80%              
client [50] (test)  loss: 0.5209 -> 0.3594   acc: 88.14% -> 88.77%             
client [35] (test)  loss: 1.4106 -> 0.5716   acc: 62.02% -> 85.42%             
client [24] (test)  loss: 0.3139 -> 0.1876   acc: 91.51% -> 96.26%             
client [15] (test)  loss: 0.8350 -> 0.5104   acc: 76.44% -> 85.94%             
client [58] (test)  loss: 0.2053 -> 0.1322   acc: 94.00% -> 96.59%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5351 -> 0.3938   acc: 80.93% -> 87.01%             
client [76] (test)  loss: 0.7230 -> 0.4389   acc: 77.55% -> 87.42%             
client [67] (test)  loss: 0.4386 -> 0.3440   acc: 85.35% -> 89.90%             
client [37] (test)  loss: 0.4462 -> 0.3946   acc: 85.52% -> 88.84%             
client [58] (test)  loss: 0.3126 -> 0.1326   acc: 90.15% -> 96.76%             
client [64] (test)  loss: 0.5675 -> 0.4628   acc: 81.27% -> 84.06%             
client [77] (test)  loss: 0.5730 -> 0.5007   acc: 81.65% -> 84.24%             
client [55] (test)  loss: 0.5720 -> 0.4691   acc: 80.01% -> 85.29%             
client [12] (test)  loss: 0.6402 -> 0.5162   acc: 79.59% -> 85.18%             
client [89] (test)  loss: 0.6540 -> 0.5255   acc: 79.88% -> 85.19%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3818 -> 0.2507   acc: 87.58% -> 93.85%             
client [51] (test)  loss: 0.3187 -> 0.2655   acc: 90.86% -> 94.47%             
client [8] (test)  loss: 0.8082 -> 0.5041   acc: 81.94% -> 87.28%              
client [18] (test)  loss: 1.3469 -> 0.4822   acc: 71.61% -> 84.48%             
client [94] (test)  loss: 0.8067 -> 0.4584   acc: 82.45% -> 88.36%             
client [81] (test)  loss: 0.3955 -> 0.3349   acc: 87.74% -> 89.23%             
client [3] (test)  loss: 0.5032 -> 0.2565   acc: 86.82% -> 94.48%              
client [11] (test)  loss: 0.6559 -> 0.3416   acc: 84.37% -> 90.99%             
client [95] (test)  loss: 0.2562 -> 0.0674   acc: 91.66% -> 98.72%             
client [67] (test)  loss: 0.6055 -> 0.3480   acc: 83.73% -> 89.93%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2263 -> 0.1244   acc: 93.93% -> 96.57%             
client [79] (test)  loss: 0.6496 -> 0.3882   acc: 84.21% -> 90.43%             
client [58] (test)  loss: 0.2061 -> 0.1363   acc: 93.86% -> 96.71%             
client [88] (test)  loss: 0.4777 -> 0.3219   acc: 85.29% -> 89.07%             
client [46] (test)  loss: 0.4457 -> 0.3967   acc: 87.52% -> 89.35%             
client [11] (test)  loss: 0.5900 -> 0.3445   acc: 83.88% -> 91.04%             
client [55] (test)  loss: 0.5858 -> 0.5238   acc: 82.42% -> 84.06%             
client [13] (test)  loss: 0.6798 -> 0.5466   acc: 80.25% -> 81.72%             
client [31] (test)  loss: 0.5136 -> 0.3901   acc: 85.24% -> 88.09%             
client [75] (test)  loss: 0.8215 -> 0.5071   acc: 76.76% -> 86.14%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3316 -> 0.1912   acc: 90.21% -> 96.00%             
client [7] (test)  loss: 0.4473 -> 0.3775   acc: 85.13% -> 89.41%              
client [57] (test)  loss: 0.3852 -> 0.2177   acc: 86.66% -> 94.78%             
client [13] (test)  loss: 0.6282 -> 0.5462   acc: 81.25% -> 82.04%             
client [43] (test)  loss: 0.4482 -> 0.2818   acc: 86.96% -> 94.04%             
client [91] (test)  loss: 0.6845 -> 0.4786   acc: 77.31% -> 86.84%             
client [10] (test)  loss: 0.6766 -> 0.4722   acc: 82.21% -> 88.20%             
client [64] (test)  loss: 0.7458 -> 0.4947   acc: 74.25% -> 84.33%             
client [82] (test)  loss: 0.6626 -> 0.4402   acc: 79.92% -> 87.47%             
client [22] (test)  loss: 0.8783 -> 0.6248   acc: 74.83% -> 82.67%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8663 -> 0.4420   acc: 80.15% -> 88.71%             
client [23] (test)  loss: 0.5828 -> 0.4014   acc: 84.00% -> 87.61%             
client [88] (test)  loss: 0.4900 -> 0.3522   acc: 86.42% -> 88.88%             
client [98] (test)  loss: 0.1924 -> 0.1092   acc: 94.76% -> 97.04%             
client [79] (test)  loss: 0.7831 -> 0.3848   acc: 82.98% -> 91.33%             
client [21] (test)  loss: 0.2310 -> 0.1312   acc: 93.83% -> 96.55%             
client [92] (test)  loss: 1.1174 -> 0.3576   acc: 77.31% -> 91.93%             
client [56] (test)  loss: 1.1233 -> 0.4882   acc: 71.08% -> 87.69%             
client [5] (test)  loss: 1.1262 -> 0.4770   acc: 76.21% -> 88.29%              
client [52] (test)  loss: 0.8022 -> 0.4882   acc: 77.42% -> 87.17%             
==================== FedDyn TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.5914 -> 0.0000', 'accuracy': '82.17% -> 0.00%'},          
    200: {'loss': '0.6931 -> 0.0000', 'accuracy': '83.34% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn achieved 30.0%(34.52%) at epoch: 1                                      
FedDyn achieved 50.0%(54.55%) at epoch: 2                                      
FedDyn achieved 60.0%(65.80%) at epoch: 4                                      
FedDyn achieved 70.0%(71.65%) at epoch: 7                                      
FedDyn achieved 80.0%(80.26%) at epoch: 11                                     
Convergence (test_after):                                                      
FedDyn achieved 70.0%(71.57%) at epoch: 0                                      
FedDyn achieved 80.0%(81.54%) at epoch: 3                                      
FedDyn achieved 90.0%(91.37%) at epoch: 22                                     
