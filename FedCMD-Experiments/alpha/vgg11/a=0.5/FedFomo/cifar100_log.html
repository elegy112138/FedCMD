==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.7710 -> 5.0176   acc: 16.07% -> 20.98%             
client [81] (test)  loss: 4.7389 -> 4.8557   acc: 12.83% -> 21.38%             
client [21] (test)  loss: 35.6200 -> 4.3621   acc: 1.05% -> 13.24%             
client [68] (test)  loss: 4.4618 -> 5.0053   acc: 18.54% -> 20.36%             
client [93] (test)  loss: 4.4718 -> 4.7134   acc: 14.33% -> 23.78%             
client [31] (test)  loss: 4.4727 -> 4.8195   acc: 14.91% -> 14.91%             
client [20] (test)  loss: 4.3571 -> 4.6765   acc: 11.72% -> 11.38%             
client [59] (test)  loss: 35.0366 -> 4.2936   acc: 0.32% -> 10.68%             
client [48] (test)  loss: 4.2030 -> 4.5805   acc: 13.11% -> 13.44%             
client [34] (test)  loss: 4.7720 -> 5.3655   acc: 11.44% -> 19.93%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.1782 -> 4.4723   acc: 18.71% -> 19.42%             
client [99] (test)  loss: 4.9700 -> 6.2588   acc: 14.10% -> 14.42%             
client [67] (test)  loss: 4.4403 -> 4.9646   acc: 15.96% -> 22.48%             
client [0] (test)  loss: 3.7857 -> 4.0579   acc: 21.33% -> 24.67%              
client [76] (test)  loss: 5.2073 -> 6.1332   acc: 9.09% -> 12.50%              
client [41] (test)  loss: 4.4452 -> 4.4683   acc: 7.31% -> 6.98%               
client [62] (test)  loss: 5.8994 -> 4.3152   acc: 2.64% -> 12.87%              
client [2] (test)  loss: 5.7262 -> 4.2113   acc: 3.31% -> 14.24%               
client [14] (test)  loss: 5.7813 -> 6.6904   acc: 16.61% -> 18.21%             
client [46] (test)  loss: 6.2006 -> 6.4578   acc: 14.29% -> 13.29%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 5.9273 -> 6.3345   acc: 19.10% -> 21.18%             
client [68] (test)  loss: 5.3857 -> 5.6433   acc: 25.53% -> 24.92%             
client [57] (test)  loss: 5.1206 -> 5.1393   acc: 17.15% -> 19.09%             
client [17] (test)  loss: 5.2492 -> 6.0869   acc: 21.93% -> 20.18%             
client [54] (test)  loss: 5.0101 -> 5.5988   acc: 20.90% -> 22.51%             
client [23] (test)  loss: 22.8939 -> 4.5933   acc: 0.00% -> 9.67%              
client [35] (test)  loss: 5.6882 -> 6.4144   acc: 13.11% -> 15.41%             
client [59] (test)  loss: 4.9991 -> 6.0018   acc: 17.15% -> 17.48%             
client [31] (test)  loss: 7.0991 -> 7.2873   acc: 17.09% -> 17.09%             
client [9] (test)  loss: 6.3507 -> 6.6689   acc: 17.26% -> 17.59%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.9285 -> 5.1295   acc: 24.92% -> 25.58%             
client [33] (test)  loss: 5.3824 -> 5.5362   acc: 21.50% -> 21.50%             
client [16] (test)  loss: 6.6910 -> 4.2214   acc: 24.47% -> 33.68%             
client [44] (test)  loss: 4.8837 -> 5.0299   acc: 8.25% -> 15.84%              
client [8] (test)  loss: 6.9733 -> 4.2492   acc: 2.22% -> 15.87%               
client [31] (test)  loss: 7.4263 -> 7.5399   acc: 17.45% -> 17.45%             
client [47] (test)  loss: 5.6605 -> 6.4288   acc: 11.88% -> 18.12%             
client [36] (test)  loss: 4.9634 -> 5.8818   acc: 15.83% -> 16.67%             
client [20] (test)  loss: 4.4815 -> 4.8408   acc: 16.55% -> 16.90%             
client [56] (test)  loss: 6.5146 -> 7.1079   acc: 14.69% -> 14.69%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.5422 -> 6.0372   acc: 13.19% -> 16.12%              
client [60] (test)  loss: 4.9335 -> 4.8775   acc: 13.33% -> 14.44%             
client [28] (test)  loss: 7.1572 -> 4.3044   acc: 6.77% -> 20.00%              
client [25] (test)  loss: 5.7310 -> 5.2147   acc: 11.33% -> 22.01%             
client [58] (test)  loss: 4.3555 -> 4.8669   acc: 23.58% -> 24.53%             
client [44] (test)  loss: 5.0299 -> 5.8242   acc: 15.84% -> 14.52%             
client [39] (test)  loss: 5.0637 -> 5.9295   acc: 12.21% -> 12.87%             
client [29] (test)  loss: 6.0708 -> 6.2188   acc: 26.58% -> 26.58%             
client [3] (test)  loss: 5.7674 -> 6.0544   acc: 26.86% -> 26.86%              
client [84] (test)  loss: 6.1220 -> 6.2396   acc: 23.68% -> 23.68%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.3662 -> 5.8853   acc: 18.47% -> 19.16%             
client [84] (test)  loss: 6.3359 -> 6.4178   acc: 23.99% -> 23.99%             
client [10] (test)  loss: 6.1671 -> 6.3258   acc: 20.98% -> 20.33%             
client [36] (test)  loss: 4.5872 -> 5.2210   acc: 22.08% -> 21.67%             
client [65] (test)  loss: 6.6558 -> 6.8038   acc: 22.65% -> 22.33%             
client [81] (test)  loss: 4.6216 -> 5.2940   acc: 20.72% -> 23.03%             
client [79] (test)  loss: 5.9073 -> 6.9242   acc: 16.94% -> 16.28%             
client [42] (test)  loss: 7.3105 -> 7.5809   acc: 17.01% -> 17.35%             
client [11] (test)  loss: 6.5094 -> 6.9819   acc: 17.19% -> 17.19%             
client [96] (test)  loss: 6.6420 -> 6.7615   acc: 20.39% -> 20.39%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.6434 -> 6.4219   acc: 19.68% -> 19.37%              
client [53] (test)  loss: 5.2361 -> 5.9781   acc: 22.37% -> 21.38%             
client [52] (test)  loss: 6.5268 -> 6.7689   acc: 20.06% -> 20.71%             
client [42] (test)  loss: 7.7802 -> 7.9374   acc: 17.35% -> 17.35%             
client [69] (test)  loss: 6.4514 -> 6.5302   acc: 26.98% -> 26.98%             
client [59] (test)  loss: 7.0961 -> 7.2520   acc: 17.48% -> 17.80%             
client [7] (test)  loss: 7.2387 -> 7.3302   acc: 20.13% -> 20.13%              
client [26] (test)  loss: 5.6738 -> 6.5530   acc: 23.92% -> 26.58%             
client [49] (test)  loss: 6.8970 -> 7.0381   acc: 15.73% -> 15.73%             
client [98] (test)  loss: 6.4168 -> 6.5118   acc: 17.59% -> 17.92%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 6.5118 -> 6.5922   acc: 17.92% -> 17.92%             
client [47] (test)  loss: 8.0280 -> 8.4385   acc: 15.94% -> 15.62%             
client [21] (test)  loss: 6.2370 -> 6.4549   acc: 20.21% -> 20.56%             
client [77] (test)  loss: 5.9753 -> 6.0976   acc: 19.02% -> 18.69%             
client [95] (test)  loss: 6.5447 -> 6.7127   acc: 20.13% -> 20.13%             
client [91] (test)  loss: 6.3628 -> 6.4671   acc: 19.55% -> 19.55%             
client [14] (test)  loss: 8.2736 -> 8.3876   acc: 20.13% -> 20.13%             
client [99] (test)  loss: 7.3566 -> 7.4920   acc: 18.59% -> 18.91%             
client [20] (test)  loss: 6.9323 -> 7.0758   acc: 21.03% -> 21.03%             
client [39] (test)  loss: 7.1679 -> 7.4149   acc: 16.83% -> 17.16%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 6.7660 -> 6.9408   acc: 20.71% -> 20.39%             
client [62] (test)  loss: 6.6444 -> 4.0609   acc: 6.93% -> 20.46%              
client [71] (test)  loss: 7.6657 -> 7.7756   acc: 19.59% -> 19.59%             
client [97] (test)  loss: 5.5710 -> 5.6566   acc: 23.53% -> 23.84%             
client [30] (test)  loss: 7.7786 -> 7.8556   acc: 17.67% -> 17.67%             
client [88] (test)  loss: 6.2741 -> 6.3841   acc: 17.73% -> 18.09%             
client [60] (test)  loss: 6.9170 -> 7.0196   acc: 14.44% -> 14.44%             
client [82] (test)  loss: 6.3654 -> 6.4265   acc: 19.45% -> 19.45%             
client [91] (test)  loss: 6.5543 -> 6.6311   acc: 19.23% -> 19.23%             
client [57] (test)  loss: 6.3106 -> 6.4487   acc: 19.42% -> 19.42%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 6.9328 -> 4.4920   acc: 4.73% -> 21.09%              
client [15] (test)  loss: 6.5770 -> 6.7255   acc: 18.81% -> 19.14%             
client [71] (test)  loss: 7.7756 -> 7.8704   acc: 19.59% -> 19.59%             
client [97] (test)  loss: 5.7921 -> 5.8467   acc: 24.15% -> 24.15%             
client [53] (test)  loss: 6.7154 -> 6.8339   acc: 19.74% -> 19.74%             
client [77] (test)  loss: 6.0976 -> 6.1947   acc: 18.69% -> 18.36%             
client [76] (test)  loss: 8.7748 -> 8.8979   acc: 9.47% -> 9.47%               
client [79] (test)  loss: 5.7718 -> 4.1418   acc: 9.63% -> 21.26%              
client [28] (test)  loss: 5.7750 -> 6.4199   acc: 17.42% -> 18.39%             
client [99] (test)  loss: 7.5854 -> 7.6861   acc: 18.91% -> 19.23%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.6298 -> 4.0099   acc: 26.63% -> 29.10%             
client [86] (test)  loss: 6.1823 -> 4.2053   acc: 8.77% -> 28.25%              
client [34] (test)  loss: 6.0326 -> 3.9798   acc: 10.33% -> 24.72%             
client [73] (test)  loss: 4.9236 -> 5.3210   acc: 22.01% -> 22.98%             
client [5] (test)  loss: 6.7047 -> 6.7839   acc: 17.22% -> 17.22%              
client [96] (test)  loss: 6.6197 -> 4.3463   acc: 11.00% -> 24.27%             
client [22] (test)  loss: 4.9137 -> 5.4943   acc: 22.19% -> 24.17%             
client [60] (test)  loss: 8.3413 -> 4.1885   acc: 7.04% -> 21.11%              
client [66] (test)  loss: 5.5681 -> 5.8628   acc: 16.28% -> 16.28%             
client [83] (test)  loss: 7.1248 -> 7.2981   acc: 19.11% -> 19.45%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.2524 -> 5.4228   acc: 20.45% -> 20.45%             
client [65] (test)  loss: 3.6176 -> 4.0443   acc: 34.30% -> 33.98%             
client [95] (test)  loss: 7.0531 -> 7.1368   acc: 20.13% -> 20.13%             
client [17] (test)  loss: 7.0571 -> 7.1666   acc: 20.76% -> 21.05%             
client [8] (test)  loss: 4.9626 -> 3.8987   acc: 16.83% -> 29.84%              
client [35] (test)  loss: 4.2534 -> 4.7294   acc: 22.62% -> 22.30%             
client [98] (test)  loss: 4.7487 -> 4.2039   acc: 14.01% -> 23.45%             
client [53] (test)  loss: 6.2305 -> 3.6615   acc: 7.24% -> 25.00%              
client [43] (test)  loss: 4.6978 -> 4.0050   acc: 15.51% -> 26.40%             
client [64] (test)  loss: 6.0151 -> 3.7954   acc: 13.29% -> 30.90%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 6.5950 -> 6.7073   acc: 20.56% -> 20.56%             
client [88] (test)  loss: 5.0866 -> 5.1943   acc: 26.24% -> 26.24%             
client [38] (test)  loss: 3.0722 -> 3.2752   acc: 42.95% -> 42.95%             
client [3] (test)  loss: 5.5699 -> 5.7630   acc: 30.10% -> 30.42%              
client [5] (test)  loss: 4.3763 -> 4.7367   acc: 20.20% -> 22.19%              
client [41] (test)  loss: 5.0269 -> 5.1260   acc: 31.56% -> 31.89%             
client [7] (test)  loss: 7.4756 -> 7.5384   acc: 20.45% -> 20.45%              
client [37] (test)  loss: 4.7067 -> 4.9541   acc: 29.70% -> 30.36%             
client [45] (test)  loss: 5.7594 -> 5.9085   acc: 23.59% -> 23.92%             
client [47] (test)  loss: 6.1642 -> 4.6550   acc: 12.81% -> 23.12%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.5936 -> 3.7439   acc: 41.58% -> 41.84%             
client [11] (test)  loss: 4.3570 -> 4.5499   acc: 32.28% -> 32.28%             
client [37] (test)  loss: 5.8978 -> 4.0769   acc: 11.22% -> 28.71%             
client [41] (test)  loss: 5.1260 -> 5.2036   acc: 31.89% -> 31.56%             
client [95] (test)  loss: 7.3240 -> 7.3825   acc: 20.13% -> 20.13%             
client [53] (test)  loss: 3.6615 -> 4.2585   acc: 25.00% -> 26.64%             
client [22] (test)  loss: 5.7391 -> 5.8879   acc: 24.17% -> 23.84%             
client [25] (test)  loss: 5.3742 -> 3.9086   acc: 13.92% -> 29.45%             
client [69] (test)  loss: 4.6629 -> 4.7520   acc: 34.17% -> 34.53%             
client [46] (test)  loss: 5.2792 -> 5.5469   acc: 19.60% -> 19.93%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.7212 -> 5.8087   acc: 24.06% -> 24.38%             
client [69] (test)  loss: 4.8238 -> 4.8846   acc: 34.17% -> 34.89%             
client [82] (test)  loss: 4.3753 -> 4.4703   acc: 27.30% -> 26.96%             
client [45] (test)  loss: 3.9710 -> 4.1103   acc: 36.88% -> 36.88%             
client [7] (test)  loss: 7.5384 -> 7.5935   acc: 20.45% -> 20.77%              
client [50] (test)  loss: 4.3978 -> 4.5553   acc: 28.57% -> 28.57%             
client [35] (test)  loss: 5.1048 -> 5.2068   acc: 22.62% -> 22.62%             
client [24] (test)  loss: 4.5625 -> 4.6820   acc: 25.69% -> 25.69%             
client [15] (test)  loss: 4.7202 -> 4.8214   acc: 26.07% -> 25.74%             
client [58] (test)  loss: 4.5115 -> 4.5562   acc: 34.28% -> 33.96%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.5029 -> 4.8685   acc: 23.93% -> 22.95%             
client [76] (test)  loss: 5.6472 -> 5.7300   acc: 21.21% -> 21.21%             
client [67] (test)  loss: 3.8448 -> 3.9728   acc: 31.92% -> 31.92%             
client [37] (test)  loss: 4.4158 -> 4.5823   acc: 29.70% -> 29.70%             
client [58] (test)  loss: 4.5962 -> 4.6317   acc: 33.96% -> 33.96%             
client [64] (test)  loss: 4.4787 -> 4.5658   acc: 31.89% -> 32.23%             
client [77] (test)  loss: 4.9652 -> 5.0937   acc: 26.23% -> 25.90%             
client [55] (test)  loss: 4.4116 -> 4.7694   acc: 23.40% -> 24.82%             
client [12] (test)  loss: 5.9016 -> 5.9706   acc: 20.60% -> 20.60%             
client [89] (test)  loss: 5.0910 -> 5.1521   acc: 28.62% -> 28.62%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.7876 -> 5.8213   acc: 26.79% -> 26.79%             
client [51] (test)  loss: 4.4998 -> 4.5939   acc: 31.56% -> 32.56%             
client [8] (test)  loss: 4.8704 -> 4.9244   acc: 31.75% -> 31.75%              
client [18] (test)  loss: 4.4130 -> 4.5017   acc: 35.41% -> 35.41%             
client [94] (test)  loss: 5.1107 -> 3.9511   acc: 14.49% -> 27.92%             
client [81] (test)  loss: 5.1933 -> 5.2388   acc: 31.25% -> 31.58%             
client [3] (test)  loss: 4.2286 -> 4.3033   acc: 38.83% -> 39.16%              
client [11] (test)  loss: 4.8344 -> 4.8953   acc: 32.28% -> 31.93%             
client [95] (test)  loss: 4.5396 -> 4.5948   acc: 30.36% -> 30.69%             
client [67] (test)  loss: 3.9728 -> 4.0628   acc: 31.92% -> 32.57%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 6.8841 -> 6.9538   acc: 20.21% -> 20.21%             
client [79] (test)  loss: 4.7440 -> 4.8071   acc: 31.23% -> 31.56%             
client [58] (test)  loss: 4.7200 -> 4.7450   acc: 33.96% -> 34.28%             
client [88] (test)  loss: 5.4059 -> 5.4566   acc: 26.60% -> 26.60%             
client [46] (test)  loss: 5.9048 -> 5.9798   acc: 21.26% -> 21.26%             
client [11] (test)  loss: 4.8953 -> 4.9453   acc: 31.93% -> 31.93%             
client [55] (test)  loss: 5.3180 -> 5.3688   acc: 27.30% -> 27.30%             
client [13] (test)  loss: 4.0258 -> 4.3212   acc: 23.69% -> 28.22%             
client [31] (test)  loss: 5.7429 -> 5.8680   acc: 23.27% -> 22.91%             
client [75] (test)  loss: 4.7767 -> 4.8119   acc: 28.06% -> 28.06%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.9483 -> 5.0032   acc: 24.76% -> 25.08%             
client [7] (test)  loss: 7.8121 -> 7.8484   acc: 21.41% -> 21.41%              
client [57] (test)  loss: 5.3710 -> 5.4215   acc: 24.27% -> 24.27%             
client [13] (test)  loss: 4.4918 -> 4.6050   acc: 28.22% -> 28.22%             
client [43] (test)  loss: 4.8619 -> 4.9123   acc: 26.07% -> 26.07%             
client [91] (test)  loss: 4.4306 -> 4.5806   acc: 27.24% -> 27.56%             
client [10] (test)  loss: 7.1624 -> 7.1937   acc: 20.66% -> 20.66%             
client [64] (test)  loss: 4.8253 -> 4.8599   acc: 31.56% -> 31.56%             
client [82] (test)  loss: 4.7590 -> 4.7897   acc: 27.30% -> 27.30%             
client [22] (test)  loss: 6.2825 -> 6.3340   acc: 24.17% -> 24.17%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.6016 -> 4.6626   acc: 27.59% -> 27.59%             
client [23] (test)  loss: 6.1232 -> 6.2079   acc: 20.33% -> 21.00%             
client [88] (test)  loss: 5.4566 -> 5.5028   acc: 26.60% -> 26.24%             
client [98] (test)  loss: 5.3931 -> 5.4380   acc: 25.08% -> 25.08%             
client [79] (test)  loss: 4.9075 -> 4.9484   acc: 31.23% -> 31.23%             
client [21] (test)  loss: 3.5731 -> 3.9055   acc: 30.66% -> 32.06%             
client [92] (test)  loss: 5.1579 -> 5.2341   acc: 26.33% -> 26.67%             
client [56] (test)  loss: 5.8114 -> 5.8442   acc: 24.13% -> 24.13%             
client [5] (test)  loss: 5.4105 -> 5.4534   acc: 22.85% -> 23.18%              
client [52] (test)  loss: 5.4209 -> 5.4587   acc: 26.21% -> 26.21%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '6.7317 -> 0.0000', 'accuracy': '20.13% -> 0.00%'},          
    200: {'loss': '5.2621 -> 0.0000', 'accuracy': '27.93% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(13.15%) at epoch: 7                                     
FedFomo achieved 20.0%(20.43%) at epoch: 56                                    
FedFomo achieved 30.0%(32.20%) at epoch: 153                                   
Convergence (test_after):                                                      
FedFomo achieved 10.0%(12.94%) at epoch: 0                                     
FedFomo achieved 20.0%(20.05%) at epoch: 32                                    
FedFomo achieved 30.0%(30.63%) at epoch: 132                                   
