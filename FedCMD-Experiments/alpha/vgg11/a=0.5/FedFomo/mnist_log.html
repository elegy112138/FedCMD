==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7650 -> 1.0277   acc: 46.51% -> 65.12%             
client [81] (test)  loss: 1.8001 -> 1.4146   acc: 45.24% -> 46.83%             
client [21] (test)  loss: 3.6314 -> 1.0566   acc: 8.83% -> 71.23%              
client [68] (test)  loss: 0.0948 -> 0.1054   acc: 96.98% -> 96.52%             
client [93] (test)  loss: 0.2974 -> 0.3088   acc: 88.78% -> 90.38%             
client [31] (test)  loss: 2.0227 -> 1.2689   acc: 25.67% -> 72.46%             
client [20] (test)  loss: 0.4630 -> 0.2877   acc: 83.64% -> 91.98%             
client [59] (test)  loss: 1.2169 -> 0.2490   acc: 62.19% -> 92.54%             
client [48] (test)  loss: 0.3885 -> 0.3825   acc: 91.08% -> 91.08%             
client [34] (test)  loss: 0.2887 -> 0.3153   acc: 90.86% -> 92.62%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.3701 -> 1.6598   acc: 58.15% -> 53.53%             
client [99] (test)  loss: 0.3407 -> 1.4051   acc: 89.17% -> 55.90%             
client [67] (test)  loss: 1.2001 -> 0.9899   acc: 53.19% -> 73.13%             
client [0] (test)  loss: 0.6929 -> 0.1948   acc: 73.87% -> 93.69%              
client [76] (test)  loss: 0.3751 -> 0.4024   acc: 90.43% -> 91.87%             
client [41] (test)  loss: 0.2764 -> 0.3486   acc: 93.48% -> 93.73%             
client [62] (test)  loss: 3.2610 -> 0.6552   acc: 0.29% -> 75.73%              
client [2] (test)  loss: 2.4493 -> 0.6784   acc: 0.00% -> 69.41%               
client [14] (test)  loss: 0.2266 -> 0.4332   acc: 94.89% -> 83.52%             
client [46] (test)  loss: 1.0135 -> 1.1185   acc: 65.67% -> 63.09%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: nan -> nan   acc: 0.55% -> 0.55%                     
client [68] (test)  loss: 0.1258 -> 0.1307   acc: 96.29% -> 96.29%             
client [57] (test)  loss: 0.9892 -> 0.8639   acc: 67.62% -> 79.52%             
client [17] (test)  loss: 0.2559 -> 0.2731   acc: 93.62% -> 93.26%             
client [54] (test)  loss: 0.1945 -> 0.2192   acc: 95.99% -> 96.49%             
client [23] (test)  loss: 3.5279 -> 2.9964   acc: 1.98% -> 8.70%               
client [35] (test)  loss: 0.5518 -> 0.5359   acc: 87.59% -> 88.28%             
client [59] (test)  loss: 0.2503 -> 0.1229   acc: 93.03% -> 96.02%             
client [31] (test)  loss: 0.4675 -> 0.4799   acc: 91.72% -> 91.93%             
client [9] (test)  loss: 0.6340 -> 0.7142   acc: 86.21% -> 86.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.6888 -> 1.7858   acc: 45.39% -> 55.32%             
client [33] (test)  loss: 0.3188 -> 0.3334   acc: 91.97% -> 91.41%             
client [16] (test)  loss: 0.8085 -> 0.4861   acc: 79.61% -> 89.02%             
client [44] (test)  loss: 1.0737 -> 0.1931   acc: 66.40% -> 95.95%             
client [8] (test)  loss: 0.6833 -> 0.6941   acc: 88.20% -> 88.20%              
client [31] (test)  loss: 0.4895 -> 0.4977   acc: 91.93% -> 91.93%             
client [47] (test)  loss: 0.0853 -> 0.0878   acc: 98.89% -> 98.89%             
client [36] (test)  loss: 1.3505 -> 0.5433   acc: 54.19% -> 81.08%             
client [20] (test)  loss: 0.3474 -> 0.3542   acc: 92.90% -> 92.90%             
client [56] (test)  loss: 0.3280 -> 0.3891   acc: 93.53% -> 93.95%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4624 -> 0.5014   acc: 91.12% -> 91.40%              
client [60] (test)  loss: 0.4292 -> 0.1518   acc: 91.19% -> 96.35%             
client [28] (test)  loss: 0.1329 -> 0.1020   acc: 96.60% -> 96.60%             
client [25] (test)  loss: 1.4858 -> 1.3881   acc: 33.73% -> 36.09%             
client [58] (test)  loss: 0.2901 -> 0.2949   acc: 94.46% -> 94.46%             
client [44] (test)  loss: 0.2269 -> 0.1544   acc: 96.36% -> 97.37%             
client [39] (test)  loss: 0.2026 -> 0.2096   acc: 94.29% -> 94.00%             
client [29] (test)  loss: 0.4957 -> 0.5254   acc: 90.11% -> 90.32%             
client [3] (test)  loss: 0.7716 -> 0.8213   acc: 90.09% -> 90.09%              
client [84] (test)  loss: 0.1581 -> 0.1625   acc: 95.93% -> 95.93%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.1600 -> 0.1694   acc: 95.44% -> 95.44%             
client [84] (test)  loss: 0.1664 -> 0.1696   acc: 95.93% -> 95.93%             
client [10] (test)  loss: 0.1744 -> 0.1579   acc: 95.34% -> 96.32%             
client [36] (test)  loss: 0.3284 -> 0.1432   acc: 92.47% -> 96.34%             
client [65] (test)  loss: 0.1777 -> 0.1812   acc: 96.89% -> 96.89%             
client [81] (test)  loss: 0.3540 -> 0.3644   acc: 93.12% -> 93.12%             
client [79] (test)  loss: 0.2715 -> 0.2785   acc: 95.11% -> 95.11%             
client [42] (test)  loss: 0.1168 -> 0.1181   acc: 96.75% -> 96.75%             
client [11] (test)  loss: 0.2149 -> 0.1375   acc: 93.26% -> 96.07%             
client [96] (test)  loss: 0.1623 -> 0.1775   acc: 95.53% -> 95.53%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7113 -> 0.7187   acc: 88.20% -> 88.20%              
client [53] (test)  loss: 0.4394 -> 0.4590   acc: 91.70% -> 91.70%             
client [52] (test)  loss: 0.4823 -> 0.4237   acc: 83.74% -> 90.15%             
client [42] (test)  loss: 0.1192 -> 0.1201   acc: 96.75% -> 96.75%             
client [69] (test)  loss: 0.8866 -> 0.9140   acc: 85.05% -> 85.05%             
client [59] (test)  loss: 0.1625 -> 0.1665   acc: 96.02% -> 96.02%             
client [7] (test)  loss: 0.2160 -> 0.2214   acc: 94.64% -> 94.90%              
client [26] (test)  loss: 0.4153 -> 0.4342   acc: 91.09% -> 91.09%             
client [49] (test)  loss: 0.4422 -> 0.4573   acc: 90.49% -> 90.49%             
client [98] (test)  loss: 0.5939 -> 0.6039   acc: 89.80% -> 89.80%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6039 -> 0.6121   acc: 89.80% -> 89.80%             
client [47] (test)  loss: 0.0898 -> 0.0913   acc: 98.89% -> 98.89%             
client [21] (test)  loss: 0.1736 -> 0.1766   acc: 95.44% -> 95.44%             
client [77] (test)  loss: 0.6273 -> 0.6406   acc: 88.37% -> 88.37%             
client [95] (test)  loss: 0.1490 -> 0.1515   acc: 96.51% -> 96.51%             
client [91] (test)  loss: 0.2582 -> 0.2615   acc: 95.36% -> 95.36%             
client [14] (test)  loss: 0.2620 -> 0.2711   acc: 94.60% -> 94.60%             
client [99] (test)  loss: 0.4342 -> 0.2837   acc: 84.14% -> 92.46%             
client [20] (test)  loss: 0.3716 -> 0.3745   acc: 92.90% -> 92.90%             
client [39] (test)  loss: 0.2213 -> 0.2251   acc: 94.00% -> 94.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4237 -> 0.4675   acc: 90.15% -> 90.15%             
client [62] (test)  loss: 0.6712 -> 0.6895   acc: 90.35% -> 90.35%             
client [71] (test)  loss: 0.4900 -> 0.4489   acc: 84.85% -> 88.89%             
client [97] (test)  loss: 0.4133 -> 0.4215   acc: 93.08% -> 93.08%             
client [30] (test)  loss: 0.3713 -> 0.2585   acc: 89.53% -> 92.73%             
client [88] (test)  loss: 0.3654 -> 0.3784   acc: 92.44% -> 92.44%             
client [60] (test)  loss: 0.1812 -> 0.1845   acc: 96.35% -> 96.35%             
client [82] (test)  loss: 0.0863 -> 0.0874   acc: 97.51% -> 97.51%             
client [91] (test)  loss: 0.2644 -> 0.2671   acc: 95.36% -> 95.36%             
client [57] (test)  loss: 0.2721 -> 0.2825   acc: 93.81% -> 93.81%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5925 -> 0.3560   acc: 68.32% -> 91.30%             
client [15] (test)  loss: 0.5930 -> 0.6092   acc: 90.93% -> 90.93%             
client [71] (test)  loss: 0.4489 -> 0.5017   acc: 88.89% -> 89.90%             
client [97] (test)  loss: 0.4344 -> 0.4395   acc: 93.08% -> 93.08%             
client [53] (test)  loss: 0.4921 -> 0.4995   acc: 91.35% -> 91.35%             
client [77] (test)  loss: 0.6406 -> 0.6511   acc: 88.37% -> 88.37%             
client [76] (test)  loss: 0.4971 -> 0.5033   acc: 91.63% -> 91.87%             
client [79] (test)  loss: 0.2879 -> 0.2915   acc: 95.11% -> 95.11%             
client [28] (test)  loss: 0.1468 -> 0.1493   acc: 96.03% -> 96.03%             
client [99] (test)  loss: 0.3330 -> 0.2825   acc: 87.23% -> 93.42%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4441 -> 0.4482   acc: 93.08% -> 93.08%             
client [86] (test)  loss: 0.2016 -> 0.2231   acc: 95.29% -> 95.29%             
client [34] (test)  loss: 0.2356 -> 0.2405   acc: 95.96% -> 95.96%             
client [73] (test)  loss: 0.3116 -> 0.3213   acc: 95.66% -> 95.66%             
client [5] (test)  loss: 0.4139 -> 0.1978   acc: 89.70% -> 95.23%              
client [96] (test)  loss: 0.2104 -> 0.2128   acc: 95.53% -> 95.53%             
client [22] (test)  loss: 0.1573 -> 0.1675   acc: 96.59% -> 96.88%             
client [60] (test)  loss: 0.1919 -> 0.1939   acc: 96.05% -> 96.35%             
client [66] (test)  loss: 0.2705 -> 0.2736   acc: 95.45% -> 95.45%             
client [83] (test)  loss: 0.7759 -> 0.7828   acc: 86.49% -> 86.49%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5184 -> 0.5224   acc: 91.63% -> 91.63%             
client [65] (test)  loss: 0.1868 -> 0.1890   acc: 96.89% -> 96.89%             
client [95] (test)  loss: 0.1567 -> 0.1581   acc: 96.51% -> 96.51%             
client [17] (test)  loss: 0.3047 -> 0.3095   acc: 92.91% -> 92.91%             
client [8] (test)  loss: 0.7364 -> 0.7411   acc: 88.20% -> 88.20%              
client [35] (test)  loss: 0.3371 -> 0.3543   acc: 90.69% -> 91.03%             
client [98] (test)  loss: 0.6259 -> 0.6318   acc: 90.20% -> 90.20%             
client [53] (test)  loss: 0.5055 -> 0.5108   acc: 91.35% -> 91.35%             
client [43] (test)  loss: 0.3662 -> 0.2656   acc: 89.80% -> 93.20%             
client [64] (test)  loss: 0.5190 -> 0.5390   acc: 91.49% -> 91.49%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1791 -> 0.1808   acc: 95.44% -> 95.44%             
client [88] (test)  loss: 0.4186 -> 0.4224   acc: 92.00% -> 92.00%             
client [38] (test)  loss: 0.3805 -> 0.3839   acc: 94.25% -> 94.25%             
client [3] (test)  loss: 0.9848 -> 0.9920   acc: 90.57% -> 90.57%              
client [5] (test)  loss: 0.2409 -> 0.2587   acc: 93.72% -> 93.72%              
client [41] (test)  loss: 0.4606 -> 0.4653   acc: 94.24% -> 93.98%             
client [7] (test)  loss: 0.2959 -> 0.0639   acc: 92.35% -> 97.70%              
client [37] (test)  loss: 0.4587 -> 0.5216   acc: 93.31% -> 93.95%             
client [45] (test)  loss: 0.1897 -> 0.1931   acc: 95.33% -> 95.33%             
client [47] (test)  loss: 0.0937 -> 0.0946   acc: 98.89% -> 98.89%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6523 -> 0.6591   acc: 88.24% -> 88.24%             
client [11] (test)  loss: 0.2109 -> 0.2137   acc: 94.94% -> 94.94%             
client [37] (test)  loss: 0.5642 -> 0.5766   acc: 93.63% -> 93.63%             
client [41] (test)  loss: 0.4653 -> 0.4694   acc: 93.98% -> 93.98%             
client [95] (test)  loss: 0.1612 -> 0.1622   acc: 96.51% -> 96.51%             
client [53] (test)  loss: 0.5108 -> 0.5157   acc: 91.35% -> 91.35%             
client [22] (test)  loss: 0.1769 -> 0.1836   acc: 96.88% -> 96.88%             
client [25] (test)  loss: 0.5560 -> 0.2263   acc: 88.76% -> 95.27%             
client [69] (test)  loss: 0.2668 -> 0.2732   acc: 94.29% -> 94.29%             
client [46] (test)  loss: 0.5062 -> 0.3885   acc: 87.98% -> 91.42%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0975 -> 0.0981   acc: 98.89% -> 98.89%             
client [69] (test)  loss: 0.2786 -> 0.2831   acc: 94.29% -> 94.29%             
client [82] (test)  loss: 0.0921 -> 0.0926   acc: 97.51% -> 97.51%             
client [45] (test)  loss: 0.1986 -> 0.2009   acc: 95.60% -> 95.60%             
client [7] (test)  loss: 0.0639 -> 0.0687   acc: 97.70% -> 97.45%              
client [50] (test)  loss: 0.5822 -> 0.6022   acc: 87.44% -> 87.44%             
client [35] (test)  loss: 0.3750 -> 0.3845   acc: 91.03% -> 91.03%             
client [24] (test)  loss: nan -> nan   acc: 0.55% -> 0.55%                     
client [15] (test)  loss: 0.3423 -> 0.2290   acc: 90.93% -> 93.41%             
client [58] (test)  loss: 0.2326 -> 0.1128   acc: 93.54% -> 96.31%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2374 -> 0.1022   acc: 93.95% -> 96.82%             
client [76] (test)  loss: 0.5297 -> 0.5327   acc: 91.63% -> 91.63%             
client [67] (test)  loss: 0.4536 -> 0.4589   acc: 92.80% -> 92.80%             
client [37] (test)  loss: 0.4634 -> 0.4222   acc: 89.81% -> 93.63%             
client [58] (test)  loss: 0.1395 -> 0.1510   acc: 96.31% -> 96.13%             
client [64] (test)  loss: 2.0814 -> 1.2899   acc: 27.30% -> 51.42%             
client [77] (test)  loss: 0.2696 -> 0.0975   acc: 92.56% -> 97.67%             
client [55] (test)  loss: 0.0494 -> 0.0498   acc: 98.32% -> 98.32%             
client [12] (test)  loss: 0.1916 -> 0.2025   acc: 95.71% -> 96.04%             
client [89] (test)  loss: 0.1198 -> 0.1142   acc: 96.04% -> 96.29%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0871 -> 0.0889   acc: 97.56% -> 97.56%             
client [51] (test)  loss: 0.1236 -> 0.1242   acc: 97.49% -> 97.49%             
client [8] (test)  loss: 0.3564 -> 0.3641   acc: 92.55% -> 92.55%              
client [18] (test)  loss: 0.2140 -> 0.2301   acc: 95.32% -> 95.32%             
client [94] (test)  loss: 0.2325 -> 0.1536   acc: 92.65% -> 95.10%             
client [81] (test)  loss: 0.1425 -> 0.1542   acc: 96.56% -> 96.56%             
client [3] (test)  loss: 0.1617 -> 0.1365   acc: 96.23% -> 97.64%              
client [11] (test)  loss: 0.1521 -> 0.1677   acc: 96.35% -> 95.51%             
client [95] (test)  loss: 0.1667 -> 0.1673   acc: 96.76% -> 96.76%             
client [67] (test)  loss: 0.4589 -> 0.4636   acc: 92.80% -> 92.80%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1837 -> 0.1849   acc: 95.44% -> 95.44%             
client [79] (test)  loss: 0.3106 -> 0.3118   acc: 95.69% -> 95.69%             
client [58] (test)  loss: 0.1681 -> 0.1718   acc: 96.13% -> 96.13%             
client [88] (test)  loss: 0.4326 -> 0.4355   acc: 92.00% -> 92.00%             
client [46] (test)  loss: 0.2422 -> 0.2464   acc: 95.28% -> 95.28%             
client [11] (test)  loss: 0.1677 -> 0.1789   acc: 95.51% -> 95.51%             
client [55] (test)  loss: 0.0516 -> 0.0519   acc: 98.32% -> 98.32%             
client [13] (test)  loss: 0.1110 -> 0.1140   acc: 96.49% -> 96.49%             
client [31] (test)  loss: 0.3574 -> 0.2310   acc: 90.68% -> 95.24%             
client [75] (test)  loss: 0.0988 -> 0.1026   acc: 96.59% -> 96.59%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3450 -> 0.3564   acc: 92.78% -> 92.78%             
client [7] (test)  loss: 0.0606 -> 0.0610   acc: 98.21% -> 98.21%              
client [57] (test)  loss: 0.3149 -> 0.3170   acc: 93.81% -> 93.81%             
client [13] (test)  loss: 0.1162 -> 0.1180   acc: 96.49% -> 96.49%             
client [43] (test)  loss: 0.2280 -> 0.2387   acc: 94.56% -> 94.56%             
client [91] (test)  loss: 0.2753 -> 0.2770   acc: 95.36% -> 95.36%             
client [10] (test)  loss: 0.1299 -> 0.1337   acc: 97.30% -> 97.30%             
client [64] (test)  loss: 0.3019 -> 0.3124   acc: 94.33% -> 94.33%             
client [82] (test)  loss: 0.0968 -> 0.0972   acc: 97.51% -> 97.51%             
client [22] (test)  loss: 0.2012 -> 0.2034   acc: 96.88% -> 96.88%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1493 -> 0.1542   acc: 96.30% -> 96.30%             
client [23] (test)  loss: 0.1124 -> 0.1139   acc: 96.84% -> 96.05%             
client [88] (test)  loss: 0.4355 -> 0.4383   acc: 92.00% -> 92.00%             
client [98] (test)  loss: 0.2067 -> 0.2081   acc: 94.29% -> 94.29%             
client [79] (test)  loss: 0.1507 -> 0.1577   acc: 97.41% -> 97.41%             
client [21] (test)  loss: 0.1081 -> 0.1150   acc: 97.72% -> 97.72%             
client [92] (test)  loss: 0.5141 -> 0.5165   acc: 89.68% -> 89.68%             
client [56] (test)  loss: 0.2193 -> 0.2233   acc: 95.82% -> 95.82%             
client [5] (test)  loss: 0.3000 -> 0.3030   acc: 93.97% -> 93.97%              
client [52] (test)  loss: 0.2059 -> 0.2114   acc: 95.07% -> 95.57%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': 'nan -> 0.0000', 'accuracy': '91.05% -> 0.00%'},             
    200: {'loss': 'nan -> 0.0000', 'accuracy': '94.87% -> 0.00%'}              
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 20.0%(25.01%) at epoch: 1                                     
FedFomo achieved 50.0%(58.54%) at epoch: 4                                     
FedFomo achieved 60.0%(69.76%) at epoch: 7                                     
FedFomo achieved 70.0%(78.90%) at epoch: 16                                    
FedFomo achieved 80.0%(82.76%) at epoch: 22                                    
FedFomo achieved 90.0%(93.96%) at epoch: 38                                    
Convergence (test_after):                                                      
FedFomo achieved 40.0%(42.53%) at epoch: 0                                     
FedFomo achieved 60.0%(62.35%) at epoch: 1                                     
FedFomo achieved 70.0%(72.64%) at epoch: 4                                     
FedFomo achieved 80.0%(86.66%) at epoch: 5                                     
FedFomo achieved 90.0%(90.46%) at epoch: 24                                    
