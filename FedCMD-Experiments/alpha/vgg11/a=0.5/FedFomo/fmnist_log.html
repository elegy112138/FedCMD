==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5201 -> 0.5515   acc: 82.87% -> 83.63%             
client [81] (test)  loss: 0.4455 -> 0.6043   acc: 88.06% -> 78.36%             
client [21] (test)  loss: 0.6739 -> 0.7320   acc: 78.48% -> 70.30%             
client [68] (test)  loss: 0.6459 -> 0.6139   acc: 74.30% -> 76.80%             
client [93] (test)  loss: 0.6983 -> 0.8095   acc: 69.77% -> 72.61%             
client [31] (test)  loss: 0.8132 -> 0.7595   acc: 76.26% -> 77.37%             
client [20] (test)  loss: 0.2597 -> 0.2906   acc: 91.03% -> 91.03%             
client [59] (test)  loss: 3.1025 -> 0.9042   acc: 0.87% -> 77.29%              
client [48] (test)  loss: 0.8830 -> 0.8253   acc: 66.07% -> 67.86%             
client [34] (test)  loss: 0.4794 -> 0.4733   acc: 83.21% -> 87.02%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6919 -> 0.8966   acc: 77.08% -> 76.19%             
client [99] (test)  loss: 0.3296 -> 0.3560   acc: 92.22% -> 91.85%             
client [67] (test)  loss: 0.6181 -> 0.4692   acc: 82.29% -> 87.32%             
client [0] (test)  loss: 1.0619 -> 1.1419   acc: 74.51% -> 74.95%              
client [76] (test)  loss: 0.7715 -> 0.5848   acc: 66.00% -> 72.03%             
client [41] (test)  loss: 0.1769 -> 0.1984   acc: 94.17% -> 93.61%             
client [62] (test)  loss: 3.7301 -> 1.0356   acc: 0.35% -> 70.38%              
client [2] (test)  loss: 3.0394 -> 1.4358   acc: 2.52% -> 50.79%               
client [14] (test)  loss: 0.5871 -> 0.6761   acc: 82.83% -> 77.66%             
client [46] (test)  loss: 0.8982 -> 0.6389   acc: 66.40% -> 74.13%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8985 -> 1.1046   acc: 67.02% -> 68.62%             
client [68] (test)  loss: 0.6528 -> 0.5895   acc: 79.59% -> 80.47%             
client [57] (test)  loss: 0.4076 -> 0.0691   acc: 89.72% -> 98.06%             
client [17] (test)  loss: 0.6106 -> 0.6006   acc: 81.16% -> 80.24%             
client [54] (test)  loss: 0.7022 -> 0.6532   acc: 80.43% -> 81.23%             
client [23] (test)  loss: 1.0797 -> 0.3512   acc: 70.62% -> 89.38%             
client [35] (test)  loss: 0.4460 -> 0.4979   acc: 87.86% -> 75.71%             
client [59] (test)  loss: 0.4411 -> 0.5049   acc: 90.83% -> 90.39%             
client [31] (test)  loss: 0.6113 -> 0.6486   acc: 81.56% -> 80.73%             
client [9] (test)  loss: 0.2644 -> 0.2685   acc: 91.48% -> 91.48%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4387 -> 0.3800   acc: 87.71% -> 88.00%             
client [33] (test)  loss: 0.2058 -> 0.2258   acc: 95.20% -> 95.96%             
client [16] (test)  loss: 0.3857 -> 0.4211   acc: 92.49% -> 92.79%             
client [44] (test)  loss: 0.8433 -> 0.8335   acc: 74.23% -> 75.00%             
client [8] (test)  loss: 0.5834 -> 0.4554   acc: 86.46% -> 88.21%              
client [31] (test)  loss: 1.0496 -> 0.5966   acc: 74.86% -> 83.80%             
client [47] (test)  loss: 0.5539 -> 0.3857   acc: 85.05% -> 89.67%             
client [36] (test)  loss: 0.3613 -> 0.2867   acc: 89.62% -> 92.12%             
client [20] (test)  loss: 0.3221 -> 0.3866   acc: 91.29% -> 91.29%             
client [56] (test)  loss: 1.1481 -> 1.2757   acc: 67.00% -> 67.24%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.9704 -> 0.7170   acc: 71.09% -> 75.00%              
client [60] (test)  loss: 0.3663 -> 0.5343   acc: 88.18% -> 89.70%             
client [28] (test)  loss: 0.3112 -> 0.3432   acc: 92.96% -> 92.39%             
client [25] (test)  loss: 0.5692 -> 0.5412   acc: 82.74% -> 87.62%             
client [58] (test)  loss: 0.9408 -> 0.9782   acc: 67.31% -> 73.35%             
client [44] (test)  loss: 0.5403 -> 0.4894   acc: 85.57% -> 80.15%             
client [39] (test)  loss: 0.6409 -> 0.7654   acc: 84.50% -> 79.03%             
client [29] (test)  loss: 0.7473 -> 0.8723   acc: 73.75% -> 71.92%             
client [3] (test)  loss: 0.4485 -> 0.4718   acc: 85.03% -> 87.82%              
client [84] (test)  loss: 0.6134 -> 0.6819   acc: 89.35% -> 87.83%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5871 -> 0.6079   acc: 79.39% -> 81.52%             
client [84] (test)  loss: 0.5187 -> 0.6675   acc: 89.35% -> 88.59%             
client [10] (test)  loss: 0.6927 -> 0.9810   acc: 84.81% -> 83.86%             
client [36] (test)  loss: 0.3203 -> 0.3588   acc: 92.31% -> 92.88%             
client [65] (test)  loss: 0.9830 -> 1.0378   acc: 82.47% -> 82.47%             
client [81] (test)  loss: 0.7507 -> 0.8197   acc: 86.57% -> 86.57%             
client [79] (test)  loss: 0.7329 -> 1.2087   acc: 73.78% -> 71.76%             
client [42] (test)  loss: 0.8909 -> 0.7768   acc: 76.09% -> 69.57%             
client [11] (test)  loss: 0.4526 -> 0.2755   acc: 91.20% -> 93.45%             
client [96] (test)  loss: 0.8193 -> 0.8237   acc: 75.40% -> 76.98%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6547 -> 0.7160   acc: 88.65% -> 88.65%              
client [53] (test)  loss: 0.7353 -> 0.8278   acc: 75.08% -> 71.10%             
client [52] (test)  loss: 0.9539 -> 0.7042   acc: 83.63% -> 88.60%             
client [42] (test)  loss: 0.9823 -> 0.7170   acc: 67.39% -> 78.50%             
client [69] (test)  loss: 0.9144 -> 0.9073   acc: 81.55% -> 66.37%             
client [59] (test)  loss: 0.6056 -> 0.6667   acc: 89.96% -> 90.39%             
client [7] (test)  loss: 1.0664 -> 1.1213   acc: 86.52% -> 86.74%              
client [26] (test)  loss: 0.6190 -> 0.6256   acc: 85.79% -> 87.43%             
client [49] (test)  loss: 1.4212 -> 0.9787   acc: 52.60% -> 76.76%             
client [98] (test)  loss: 0.3084 -> 0.3246   acc: 93.16% -> 92.89%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3246 -> 0.3373   acc: 92.89% -> 93.16%             
client [47] (test)  loss: 0.4753 -> 0.4972   acc: 87.91% -> 90.33%             
client [21] (test)  loss: 0.4871 -> 0.4417   acc: 83.94% -> 86.06%             
client [77] (test)  loss: 0.4591 -> 0.4307   acc: 88.41% -> 89.17%             
client [95] (test)  loss: 0.8838 -> 0.9169   acc: 86.05% -> 86.05%             
client [91] (test)  loss: 0.3838 -> 0.4631   acc: 87.53% -> 83.97%             
client [14] (test)  loss: 0.5333 -> 0.5541   acc: 86.10% -> 85.83%             
client [99] (test)  loss: 0.3879 -> 0.4274   acc: 89.63% -> 89.26%             
client [20] (test)  loss: 0.4478 -> 0.4556   acc: 91.29% -> 91.29%             
client [39] (test)  loss: 1.1004 -> 0.8003   acc: 61.70% -> 72.95%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7042 -> 0.6236   acc: 88.60% -> 83.33%             
client [62] (test)  loss: 0.5016 -> 0.5543   acc: 89.55% -> 89.55%             
client [71] (test)  loss: 0.6867 -> 0.9512   acc: 76.54% -> 74.07%             
client [97] (test)  loss: 0.9883 -> 1.0531   acc: 77.04% -> 75.88%             
client [30] (test)  loss: 1.0069 -> 1.1743   acc: 78.50% -> 78.97%             
client [88] (test)  loss: 0.5443 -> 1.3828   acc: 82.86% -> 51.75%             
client [60] (test)  loss: 0.4747 -> 0.5427   acc: 90.30% -> 90.00%             
client [82] (test)  loss: 0.7938 -> nan   acc: 79.01% -> 2.49%                 
client [91] (test)  loss: 0.3983 -> 0.4667   acc: 89.82% -> 90.33%             
client [57] (test)  loss: 0.4530 -> 0.1144   acc: 90.28% -> 96.11%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7418 -> 0.8649   acc: 81.28% -> 79.05%             
client [15] (test)  loss: 0.8224 -> 0.8473   acc: 82.81% -> 82.46%             
client [71] (test)  loss: 0.9362 -> 0.5548   acc: 61.73% -> 80.25%             
client [97] (test)  loss: 1.1924 -> 1.2859   acc: 75.49% -> 75.49%             
client [53] (test)  loss: 1.0384 -> 0.9050   acc: 80.73% -> 79.73%             
client [77] (test)  loss: 0.4307 -> 0.6395   acc: 89.17% -> 83.12%             
client [76] (test)  loss: 0.6368 -> 0.5482   acc: 75.32% -> 76.97%             
client [79] (test)  loss: 1.2910 -> 1.5637   acc: 73.78% -> 73.49%             
client [28] (test)  loss: 0.4036 -> 0.4089   acc: 92.39% -> 92.39%             
client [99] (test)  loss: 0.3563 -> 0.3720   acc: 91.11% -> 91.48%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.3528 -> 1.4011   acc: 75.49% -> 75.49%             
client [86] (test)  loss: 0.6715 -> 0.6825   acc: 88.29% -> 88.29%             
client [34] (test)  loss: 0.8528 -> 0.8632   acc: 86.51% -> 86.51%             
client [73] (test)  loss: 0.8604 -> 0.8946   acc: 86.63% -> 86.45%             
client [5] (test)  loss: 0.3816 -> 0.4058   acc: 94.47% -> 94.47%              
client [96] (test)  loss: 0.8420 -> 0.8603   acc: 77.78% -> 78.57%             
client [22] (test)  loss: 0.8815 -> 1.0713   acc: 79.87% -> 78.19%             
client [60] (test)  loss: 0.6398 -> 0.6578   acc: 89.39% -> 89.39%             
client [66] (test)  loss: 0.5584 -> 0.5804   acc: 93.23% -> 93.23%             
client [83] (test)  loss: 0.8498 -> 0.8687   acc: 84.72% -> 84.72%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7930 -> 0.8943   acc: 83.00% -> 84.28%             
client [65] (test)  loss: 1.1105 -> 1.1366   acc: 82.47% -> 82.47%             
client [95] (test)  loss: 1.0159 -> 0.4865   acc: 78.29% -> 87.21%             
client [17] (test)  loss: 0.3870 -> 0.4194   acc: 88.75% -> 90.58%             
client [8] (test)  loss: 0.8027 -> 0.8209   acc: 87.77% -> 87.77%              
client [35] (test)  loss: 0.5647 -> 0.2572   acc: 86.82% -> 92.25%             
client [98] (test)  loss: 0.3551 -> 0.3619   acc: 92.89% -> 92.89%             
client [53] (test)  loss: 1.1547 -> 1.2833   acc: 81.06% -> 81.40%             
client [43] (test)  loss: 0.5635 -> 0.3780   acc: 86.18% -> 83.17%             
client [64] (test)  loss: 0.4111 -> 0.4178   acc: 87.71% -> 86.57%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5081 -> 0.5521   acc: 86.67% -> 85.76%             
client [88] (test)  loss: 0.8376 -> 0.8527   acc: 83.81% -> 83.81%             
client [38] (test)  loss: 0.8307 -> 0.5660   acc: 80.94% -> 79.56%             
client [3] (test)  loss: 0.5085 -> 0.4733   acc: 89.34% -> 89.85%              
client [5] (test)  loss: 0.4219 -> 0.4341   acc: 94.47% -> 94.47%              
client [41] (test)  loss: 0.3631 -> 0.3679   acc: 93.06% -> 93.06%             
client [7] (test)  loss: 1.1890 -> 1.2109   acc: 86.74% -> 86.96%              
client [37] (test)  loss: 0.4158 -> 0.4832   acc: 89.58% -> 89.32%             
client [45] (test)  loss: 0.7457 -> 0.8161   acc: 84.57% -> 86.97%             
client [47] (test)  loss: 0.6559 -> 0.5906   acc: 87.47% -> 88.35%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3219 -> 0.3811   acc: 93.09% -> 92.79%             
client [11] (test)  loss: 0.5640 -> 0.5753   acc: 94.36% -> 94.36%             
client [37] (test)  loss: 0.5444 -> 0.5662   acc: 89.06% -> 89.06%             
client [41] (test)  loss: 0.3678 -> 0.3726   acc: 93.06% -> 93.06%             
client [95] (test)  loss: 0.7707 -> 0.8066   acc: 88.76% -> 88.76%             
client [53] (test)  loss: 1.2833 -> 1.3572   acc: 81.40% -> 81.40%             
client [22] (test)  loss: 1.0237 -> 1.5933   acc: 79.53% -> 79.53%             
client [25] (test)  loss: 0.7079 -> 0.7439   acc: 89.25% -> 89.25%             
client [69] (test)  loss: 0.8914 -> 0.9441   acc: 80.06% -> 81.25%             
client [46] (test)  loss: 0.7488 -> 0.5903   acc: 69.07% -> 68.80%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7031 -> 0.8129   acc: 89.23% -> 90.11%             
client [69] (test)  loss: 0.6124 -> 0.7056   acc: 82.14% -> 80.95%             
client [82] (test)  loss: nan -> nan   acc: 2.49% -> 2.49%                     
client [45] (test)  loss: 0.8064 -> 0.3126   acc: 80.05% -> 89.89%             
client [7] (test)  loss: 1.2109 -> 1.2313   acc: 86.96% -> 86.96%              
client [50] (test)  loss: 0.6401 -> 0.3692   acc: 86.27% -> 89.92%             
client [35] (test)  loss: 0.4103 -> 0.3105   acc: 86.05% -> 94.06%             
client [24] (test)  loss: 1.3561 -> 1.4440   acc: 79.26% -> 79.26%             
client [15] (test)  loss: 0.9118 -> 0.9225   acc: 82.46% -> 82.46%             
client [58] (test)  loss: 2.3467 -> 2.3712   acc: 75.27% -> 75.27%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7669 -> 0.9561   acc: 75.00% -> 65.00%             
client [76] (test)  loss: 1.0475 -> 1.0761   acc: 85.19% -> 85.19%             
client [67] (test)  loss: 0.4575 -> 0.5060   acc: 85.92% -> 86.92%             
client [37] (test)  loss: 0.7384 -> 0.4275   acc: 88.02% -> 88.54%             
client [58] (test)  loss: 2.3936 -> 2.4144   acc: 75.27% -> 75.27%             
client [64] (test)  loss: 0.4014 -> 0.4247   acc: 87.14% -> 86.57%             
client [77] (test)  loss: 0.4107 -> 0.4386   acc: 89.42% -> 88.16%             
client [55] (test)  loss: 0.5761 -> 0.5926   acc: 91.12% -> 91.12%             
client [12] (test)  loss: 0.9408 -> 0.9580   acc: 87.80% -> 87.80%             
client [89] (test)  loss: 0.8342 -> 0.8398   acc: 87.77% -> 87.77%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4847 -> 0.5567   acc: 87.64% -> 87.45%             
client [51] (test)  loss: 0.4287 -> 0.4320   acc: 96.50% -> 96.50%             
client [8] (test)  loss: 0.8924 -> 0.9005   acc: 87.34% -> 87.34%              
client [18] (test)  loss: 0.6855 -> 0.7200   acc: 86.64% -> 86.64%             
client [94] (test)  loss: 0.7893 -> 0.8032   acc: 87.59% -> 87.59%             
client [81] (test)  loss: 0.5347 -> 0.5441   acc: 91.04% -> 91.04%             
client [3] (test)  loss: 0.6077 -> 0.6235   acc: 89.34% -> 89.34%              
client [11] (test)  loss: 0.6007 -> 0.6074   acc: 94.58% -> 94.58%             
client [95] (test)  loss: 0.9190 -> 0.9298   acc: 88.76% -> 88.76%             
client [67] (test)  loss: 0.5060 -> 0.4323   acc: 86.92% -> 89.34%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5234 -> 0.5250   acc: 83.94% -> 85.15%             
client [79] (test)  loss: 0.6393 -> 0.7283   acc: 76.95% -> 77.81%             
client [58] (test)  loss: 0.7470 -> 0.7661   acc: 74.18% -> 76.65%             
client [88] (test)  loss: 0.8865 -> 0.8958   acc: 83.81% -> 83.81%             
client [46] (test)  loss: 0.6747 -> 0.4645   acc: 74.13% -> 82.13%             
client [11] (test)  loss: 0.6074 -> 0.6129   acc: 94.58% -> 94.58%             
client [55] (test)  loss: 0.6435 -> 0.6499   acc: 91.12% -> 91.12%             
client [13] (test)  loss: 0.6504 -> 0.7572   acc: 87.89% -> 87.11%             
client [31] (test)  loss: 0.8402 -> 0.9493   acc: 79.61% -> 82.68%             
client [75] (test)  loss: 0.1994 -> 0.2011   acc: 95.65% -> 95.65%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5582 -> 0.5624   acc: 94.37% -> 94.37%             
client [7] (test)  loss: 1.2993 -> 1.3090   acc: 86.96% -> 86.96%              
client [57] (test)  loss: 0.1397 -> 0.1429   acc: 96.94% -> 96.94%             
client [13] (test)  loss: 0.8042 -> 0.8375   acc: 87.11% -> 86.86%             
client [43] (test)  loss: 0.7993 -> 0.8221   acc: 87.44% -> 87.44%             
client [91] (test)  loss: 0.5568 -> 0.5671   acc: 90.33% -> 90.33%             
client [10] (test)  loss: 0.5664 -> 0.6269   acc: 88.92% -> 88.61%             
client [64] (test)  loss: 0.7658 -> 0.5620   acc: 86.00% -> 79.43%             
client [82] (test)  loss: nan -> nan   acc: 2.49% -> 2.49%                     
client [22] (test)  loss: 2.1747 -> 2.2609   acc: 80.87% -> 80.87%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5446 -> 0.2176   acc: 61.21% -> 92.88%             
client [23] (test)  loss: 0.4291 -> 0.5456   acc: 88.75% -> 85.00%             
client [88] (test)  loss: 0.8958 -> 0.9038   acc: 83.81% -> 83.81%             
client [98] (test)  loss: 0.3974 -> 0.4008   acc: 92.63% -> 92.63%             
client [79] (test)  loss: 1.3942 -> 0.7960   acc: 70.61% -> 72.33%             
client [21] (test)  loss: 0.5632 -> 0.5759   acc: 84.24% -> 82.12%             
client [92] (test)  loss: 0.2650 -> 0.2668   acc: 95.95% -> 95.95%             
client [56] (test)  loss: 1.1949 -> 1.2113   acc: 82.27% -> 82.27%             
client [5] (test)  loss: 0.4815 -> 0.4858   acc: 94.47% -> 94.47%              
client [52] (test)  loss: 0.5700 -> 0.4309   acc: 85.67% -> 88.01%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': 'nan -> 0.0000', 'accuracy': '85.24% -> 0.00%'},             
    200: {'loss': 'nan -> 0.0000', 'accuracy': '84.78% -> 0.00%'}              
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 40.0%(41.08%) at epoch: 1                                     
FedFomo achieved 50.0%(50.58%) at epoch: 5                                     
FedFomo achieved 60.0%(68.40%) at epoch: 7                                     
FedFomo achieved 70.0%(73.26%) at epoch: 9                                     
FedFomo achieved 80.0%(82.10%) at epoch: 24                                    
Convergence (test_after):                                                      
FedFomo achieved 70.0%(70.47%) at epoch: 0                                     
FedFomo achieved 80.0%(84.41%) at epoch: 10                                    
FedFomo achieved 90.0%(90.55%) at epoch: 87                                    
