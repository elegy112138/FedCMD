==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9165 -> 0.8821   acc: 73.04% -> 74.99%             
client [81] (test)  loss: 0.8066 -> 0.6752   acc: 76.20% -> 79.82%             
client [21] (test)  loss: 5.0332 -> 0.3641   acc: 3.67% -> 89.82%              
client [68] (test)  loss: 0.2115 -> 0.1540   acc: 93.65% -> 95.46%             
client [93] (test)  loss: 0.6380 -> 0.6424   acc: 84.24% -> 85.37%             
client [31] (test)  loss: 0.9794 -> 0.8061   acc: 71.34% -> 75.44%             
client [20] (test)  loss: 0.7566 -> 0.8277   acc: 79.90% -> 78.43%             
client [59] (test)  loss: 4.6255 -> 0.9109   acc: 4.05% -> 71.43%              
client [48] (test)  loss: 0.7245 -> 0.7786   acc: 78.41% -> 77.40%             
client [34] (test)  loss: 0.8637 -> 0.7518   acc: 79.23% -> 82.21%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4098 -> 0.3856   acc: 88.71% -> 90.54%             
client [99] (test)  loss: 0.5860 -> 0.5951   acc: 83.28% -> 83.55%             
client [67] (test)  loss: 0.6479 -> 0.6651   acc: 80.41% -> 81.19%             
client [0] (test)  loss: 0.3620 -> 0.3710   acc: 89.96% -> 90.39%              
client [76] (test)  loss: 0.7730 -> 0.7539   acc: 76.80% -> 77.41%             
client [41] (test)  loss: 0.9780 -> 0.9530   acc: 70.57% -> 72.47%             
client [62] (test)  loss: 4.6376 -> 0.8524   acc: 46.61% -> 76.01%             
client [2] (test)  loss: 5.4896 -> 0.6754   acc: 1.72% -> 80.35%               
client [14] (test)  loss: 0.5707 -> 0.6320   acc: 85.93% -> 85.79%             
client [46] (test)  loss: 0.6776 -> 0.6919   acc: 82.58% -> 83.03%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4353 -> 0.3880   acc: 89.89% -> 91.34%             
client [68] (test)  loss: 0.1557 -> 0.1566   acc: 96.02% -> 96.12%             
client [57] (test)  loss: 0.4341 -> 0.4361   acc: 87.62% -> 87.89%             
client [17] (test)  loss: 0.2980 -> 0.3091   acc: 91.63% -> 92.15%             
client [54] (test)  loss: 0.8223 -> 0.8742   acc: 82.12% -> 83.08%             
client [23] (test)  loss: 5.5721 -> 0.9862   acc: 0.29% -> 68.54%              
client [35] (test)  loss: 0.9642 -> 1.0330   acc: 75.75% -> 76.37%             
client [59] (test)  loss: 0.7201 -> 0.7036   acc: 77.89% -> 79.53%             
client [31] (test)  loss: 0.9020 -> 0.9152   acc: 78.35% -> 78.67%             
client [9] (test)  loss: 1.1092 -> 1.1813   acc: 67.66% -> 66.71%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9479 -> 0.9597   acc: 72.09% -> 73.57%             
client [33] (test)  loss: 1.1646 -> 1.3107   acc: 73.60% -> 73.53%             
client [16] (test)  loss: 0.5473 -> 0.6085   acc: 87.18% -> 88.06%             
client [44] (test)  loss: 1.5384 -> 1.2311   acc: 58.82% -> 65.31%             
client [8] (test)  loss: 1.1308 -> 1.2239   acc: 75.99% -> 75.58%              
client [31] (test)  loss: 1.0263 -> 1.0815   acc: 78.79% -> 78.84%             
client [47] (test)  loss: 0.4753 -> 0.5084   acc: 85.88% -> 85.71%             
client [36] (test)  loss: 1.1536 -> 0.8163   acc: 69.28% -> 77.26%             
client [20] (test)  loss: 0.9633 -> 1.0313   acc: 81.69% -> 81.10%             
client [56] (test)  loss: 0.9018 -> 1.2753   acc: 74.34% -> 66.96%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6927 -> 0.6923   acc: 82.62% -> 83.96%              
client [60] (test)  loss: 0.6224 -> 0.5397   acc: 82.92% -> 85.83%             
client [28] (test)  loss: 0.9508 -> 0.9809   acc: 78.41% -> 78.83%             
client [25] (test)  loss: 0.0388 -> 0.0408   acc: 98.85% -> 98.94%             
client [58] (test)  loss: 0.3427 -> 0.3537   acc: 93.05% -> 92.98%             
client [44] (test)  loss: 1.2311 -> 1.1782   acc: 65.31% -> 66.57%             
client [39] (test)  loss: 0.9897 -> 0.6704   acc: 81.16% -> 85.24%             
client [29] (test)  loss: 1.0509 -> 1.0869   acc: 73.47% -> 72.86%             
client [3] (test)  loss: 0.6273 -> 0.6517   acc: 86.06% -> 86.80%              
client [84] (test)  loss: 0.5612 -> 0.5939   acc: 88.71% -> 88.88%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2905 -> 0.2805   acc: 91.53% -> 92.29%             
client [84] (test)  loss: 0.6224 -> 0.6377   acc: 88.95% -> 88.76%             
client [10] (test)  loss: 0.9516 -> 1.0271   acc: 76.29% -> 76.29%             
client [36] (test)  loss: 0.8152 -> 0.8291   acc: 79.05% -> 80.07%             
client [65] (test)  loss: 1.0279 -> 1.0399   acc: 75.18% -> 75.49%             
client [81] (test)  loss: 0.7385 -> 0.5587   acc: 80.18% -> 84.96%             
client [79] (test)  loss: 0.9452 -> 0.9587   acc: 78.41% -> 81.07%             
client [42] (test)  loss: 0.4365 -> 0.4622   acc: 91.42% -> 91.38%             
client [11] (test)  loss: 0.7668 -> 0.7972   acc: 83.75% -> 83.90%             
client [96] (test)  loss: 0.7093 -> 0.7207   acc: 82.20% -> 82.13%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.2977 -> 1.3267   acc: 77.63% -> 79.30%              
client [53] (test)  loss: 0.9607 -> 1.0248   acc: 77.66% -> 78.84%             
client [52] (test)  loss: 1.0211 -> 1.1562   acc: 75.59% -> 75.24%             
client [42] (test)  loss: 0.4837 -> 0.5031   acc: 91.34% -> 91.36%             
client [69] (test)  loss: 0.5092 -> 0.5186   acc: 91.09% -> 91.31%             
client [59] (test)  loss: 0.8029 -> 0.8288   acc: 80.50% -> 80.66%             
client [7] (test)  loss: 0.7802 -> 0.8379   acc: 80.89% -> 81.31%              
client [26] (test)  loss: 0.3442 -> 0.3686   acc: 89.96% -> 89.98%             
client [49] (test)  loss: 0.2817 -> 0.2921   acc: 93.59% -> 93.82%             
client [98] (test)  loss: 0.3226 -> 0.3345   acc: 93.26% -> 93.38%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3345 -> 0.3470   acc: 93.38% -> 93.46%             
client [47] (test)  loss: 0.5519 -> 0.5820   acc: 85.47% -> 85.18%             
client [21] (test)  loss: 0.2952 -> 0.2858   acc: 92.51% -> 92.98%             
client [77] (test)  loss: 1.2321 -> 1.2702   acc: 76.82% -> 76.37%             
client [95] (test)  loss: 0.1638 -> 0.1661   acc: 96.52% -> 96.52%             
client [91] (test)  loss: 0.9227 -> 0.9808   acc: 80.52% -> 81.13%             
client [14] (test)  loss: 0.7237 -> 0.7862   acc: 87.06% -> 86.49%             
client [99] (test)  loss: 0.8267 -> 0.8691   acc: 84.32% -> 84.12%             
client [20] (test)  loss: 1.1110 -> 1.1313   acc: 82.65% -> 82.65%             
client [39] (test)  loss: 0.7357 -> 0.7674   acc: 85.81% -> 85.89%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1562 -> 1.1910   acc: 75.24% -> 77.11%             
client [62] (test)  loss: 1.3083 -> 1.3869   acc: 78.61% -> 78.79%             
client [71] (test)  loss: 1.2716 -> 1.1064   acc: 70.17% -> 75.00%             
client [97] (test)  loss: 0.4156 -> 0.4323   acc: 91.23% -> 90.97%             
client [30] (test)  loss: 0.5642 -> 0.5722   acc: 89.32% -> 89.37%             
client [88] (test)  loss: 0.6744 -> 0.6161   acc: 82.13% -> 82.09%             
client [60] (test)  loss: 0.6420 -> 0.7090   acc: 87.04% -> 87.33%             
client [82] (test)  loss: 0.7961 -> 0.9348   acc: 81.31% -> 82.39%             
client [91] (test)  loss: 0.8984 -> 1.0388   acc: 78.71% -> 81.33%             
client [57] (test)  loss: 0.4653 -> 0.4626   acc: 89.43% -> 89.28%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.0588 -> 1.1239   acc: 81.10% -> 81.00%             
client [15] (test)  loss: 1.1905 -> 1.2486   acc: 77.70% -> 77.78%             
client [71] (test)  loss: 1.1064 -> 1.1902   acc: 75.00% -> 69.98%             
client [97] (test)  loss: 0.4439 -> 0.4496   acc: 91.42% -> 91.56%             
client [53] (test)  loss: 1.2045 -> 1.2578   acc: 78.36% -> 77.23%             
client [77] (test)  loss: 1.2702 -> 1.2632   acc: 76.37% -> 76.40%             
client [76] (test)  loss: 0.9809 -> 0.9546   acc: 77.65% -> 78.11%             
client [79] (test)  loss: 1.0364 -> 1.0776   acc: 81.97% -> 81.76%             
client [28] (test)  loss: 1.0044 -> 1.1408   acc: 79.27% -> 79.78%             
client [99] (test)  loss: 0.9062 -> 0.9179   acc: 84.32% -> 84.76%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4540 -> 0.4592   acc: 91.73% -> 91.80%             
client [86] (test)  loss: 0.7143 -> 0.7252   acc: 86.47% -> 86.50%             
client [34] (test)  loss: 1.1089 -> 1.1312   acc: 83.35% -> 83.80%             
client [73] (test)  loss: 1.4166 -> 1.5380   acc: 73.35% -> 72.69%             
client [5] (test)  loss: 1.3208 -> 0.9662   acc: 77.98% -> 80.11%              
client [96] (test)  loss: 0.9677 -> 1.0684   acc: 82.94% -> 82.27%             
client [22] (test)  loss: 1.6521 -> 1.7036   acc: 70.95% -> 71.55%             
client [60] (test)  loss: 0.7971 -> 0.6572   acc: 87.61% -> 87.45%             
client [66] (test)  loss: 0.7447 -> 0.7989   acc: 85.97% -> 85.56%             
client [83] (test)  loss: 0.4319 -> 0.4650   acc: 91.50% -> 91.14%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0918 -> 0.9780   acc: 80.98% -> 80.76%             
client [65] (test)  loss: 1.0979 -> 1.1731   acc: 76.25% -> 76.08%             
client [95] (test)  loss: 0.1715 -> 0.1731   acc: 96.54% -> 96.54%             
client [17] (test)  loss: 0.3580 -> 0.3569   acc: 92.86% -> 92.76%             
client [8] (test)  loss: 1.3464 -> 1.3924   acc: 80.27% -> 80.24%              
client [35] (test)  loss: 1.5183 -> 1.5613   acc: 78.93% -> 78.89%             
client [98] (test)  loss: 0.3650 -> 0.3717   acc: 93.38% -> 93.29%             
client [53] (test)  loss: 1.2414 -> 1.3010   acc: 78.96% -> 79.28%             
client [43] (test)  loss: 0.7308 -> 0.8074   acc: 88.78% -> 88.59%             
client [64] (test)  loss: 1.1363 -> 1.2483   acc: 76.75% -> 75.31%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2949 -> 0.3052   acc: 93.12% -> 92.95%             
client [88] (test)  loss: 0.8446 -> 0.9217   acc: 82.47% -> 82.01%             
client [38] (test)  loss: 0.2856 -> 0.2890   acc: 94.59% -> 94.54%             
client [3] (test)  loss: 0.7940 -> 0.8015   acc: 88.04% -> 88.09%              
client [5] (test)  loss: 1.0412 -> 1.1108   acc: 81.40% -> 81.48%              
client [41] (test)  loss: 1.3628 -> 1.3960   acc: 75.18% -> 75.18%             
client [7] (test)  loss: 0.8453 -> 0.8786   acc: 82.93% -> 82.95%              
client [37] (test)  loss: 0.8247 -> 0.9613   acc: 82.70% -> 83.02%             
client [45] (test)  loss: 1.3539 -> 1.2724   acc: 71.80% -> 72.59%             
client [47] (test)  loss: 0.6679 -> 0.7020   acc: 84.87% -> 84.70%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7919 -> 0.8077   acc: 88.06% -> 88.04%             
client [11] (test)  loss: 0.9437 -> 1.0160   acc: 82.75% -> 81.55%             
client [37] (test)  loss: 1.0678 -> 0.8127   acc: 82.40% -> 81.68%             
client [41] (test)  loss: 1.3960 -> 1.4456   acc: 75.18% -> 75.06%             
client [95] (test)  loss: 0.1772 -> 0.1784   acc: 96.59% -> 96.59%             
client [53] (test)  loss: 1.3010 -> 1.3481   acc: 79.28% -> 79.35%             
client [22] (test)  loss: 1.8812 -> 2.0837   acc: 71.92% -> 69.47%             
client [25] (test)  loss: 0.0449 -> 0.0451   acc: 98.90% -> 98.90%             
client [69] (test)  loss: 0.5633 -> 0.5671   acc: 91.87% -> 91.96%             
client [46] (test)  loss: 0.9026 -> 0.8516   acc: 83.74% -> 83.93%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.8025 -> 0.8153   acc: 84.82% -> 84.94%             
client [69] (test)  loss: 0.5712 -> 0.5758   acc: 91.91% -> 91.93%             
client [82] (test)  loss: 1.1159 -> 1.1897   acc: 82.21% -> 82.12%             
client [45] (test)  loss: 1.4641 -> 1.5367   acc: 71.91% -> 73.05%             
client [7] (test)  loss: 0.8786 -> 0.9254   acc: 82.95% -> 83.17%              
client [50] (test)  loss: 1.0123 -> 1.0594   acc: 81.45% -> 81.79%             
client [35] (test)  loss: 1.3949 -> 1.5105   acc: 79.12% -> 79.16%             
client [24] (test)  loss: 0.5475 -> 0.5520   acc: 91.65% -> 91.68%             
client [15] (test)  loss: 1.4837 -> 1.1672   acc: 77.10% -> 75.43%             
client [58] (test)  loss: 0.4714 -> 0.4766   acc: 93.44% -> 93.42%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0523 -> 0.8786   acc: 81.77% -> 81.02%             
client [76] (test)  loss: 1.1256 -> 0.9817   acc: 81.78% -> 81.56%             
client [67] (test)  loss: 0.8675 -> 0.8857   acc: 85.33% -> 85.40%             
client [37] (test)  loss: 0.9900 -> 1.0423   acc: 83.00% -> 83.15%             
client [58] (test)  loss: 0.4817 -> 0.4861   acc: 93.39% -> 93.39%             
client [64] (test)  loss: 1.1823 -> 1.2909   acc: 76.26% -> 77.51%             
client [77] (test)  loss: 1.5628 -> 1.5691   acc: 76.35% -> 76.54%             
client [55] (test)  loss: 1.2280 -> 1.3296   acc: 78.29% -> 78.88%             
client [12] (test)  loss: 1.3085 -> 1.3620   acc: 79.69% -> 79.35%             
client [89] (test)  loss: 1.4692 -> 1.5124   acc: 77.97% -> 77.97%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7840 -> 0.7885   acc: 89.12% -> 89.12%             
client [51] (test)  loss: 0.8078 -> 0.8145   acc: 88.39% -> 88.46%             
client [8] (test)  loss: 1.5684 -> 1.5775   acc: 80.11% -> 79.99%              
client [18] (test)  loss: 1.2807 -> 1.3420   acc: 76.93% -> 76.61%             
client [94] (test)  loss: 1.2967 -> 1.3624   acc: 81.14% -> 81.41%             
client [81] (test)  loss: 0.7824 -> 1.1356   acc: 84.94% -> 79.51%             
client [3] (test)  loss: 0.8267 -> 0.8322   acc: 88.11% -> 88.09%              
client [11] (test)  loss: 0.9860 -> 1.0276   acc: 83.46% -> 83.24%             
client [95] (test)  loss: 0.1842 -> 0.1851   acc: 96.61% -> 96.61%             
client [67] (test)  loss: 0.8857 -> 0.9018   acc: 85.40% -> 85.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3196 -> 0.3304   acc: 93.30% -> 93.22%             
client [79] (test)  loss: 1.2284 -> 1.2448   acc: 82.63% -> 82.69%             
client [58] (test)  loss: 0.4975 -> 0.5008   acc: 93.39% -> 93.42%             
client [88] (test)  loss: 0.9992 -> 1.0361   acc: 83.39% -> 83.24%             
client [46] (test)  loss: 1.0077 -> 1.0353   acc: 83.38% -> 83.45%             
client [11] (test)  loss: 1.0276 -> 0.9730   acc: 83.24% -> 84.25%             
client [55] (test)  loss: 1.4704 -> 1.3599   acc: 79.05% -> 79.27%             
client [13] (test)  loss: 1.4446 -> 1.5758   acc: 75.22% -> 75.07%             
client [31] (test)  loss: 0.9940 -> 1.0622   acc: 79.55% -> 81.15%             
client [75] (test)  loss: 1.3932 -> 1.4249   acc: 77.94% -> 78.91%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5386 -> 0.5437   acc: 92.17% -> 92.15%             
client [7] (test)  loss: 1.0761 -> 1.1017   acc: 83.53% -> 83.53%              
client [57] (test)  loss: 0.5462 -> 0.5838   acc: 89.19% -> 89.50%             
client [13] (test)  loss: 1.6333 -> 1.6558   acc: 75.28% -> 75.43%             
client [43] (test)  loss: 0.6991 -> 0.7120   acc: 89.33% -> 89.55%             
client [91] (test)  loss: 1.1123 -> 1.1624   acc: 81.65% -> 81.33%             
client [10] (test)  loss: 1.4721 -> 1.4872   acc: 80.37% -> 80.48%             
client [64] (test)  loss: 1.4053 -> 1.4566   acc: 78.40% -> 78.13%             
client [82] (test)  loss: 1.3821 -> 1.4104   acc: 81.84% -> 81.57%             
client [22] (test)  loss: 2.0151 -> 1.8170   acc: 72.52% -> 72.15%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.2592 -> 1.2612   acc: 82.72% -> 82.85%             
client [23] (test)  loss: 0.7770 -> 0.8621   acc: 81.44% -> 82.62%             
client [88] (test)  loss: 1.0361 -> 0.9200   acc: 83.24% -> 83.51%             
client [98] (test)  loss: 0.4031 -> 0.4057   acc: 93.21% -> 93.26%             
client [79] (test)  loss: 1.2634 -> 1.3035   acc: 83.10% -> 82.21%             
client [21] (test)  loss: 0.3542 -> 0.3188   acc: 93.32% -> 93.37%             
client [92] (test)  loss: 1.2182 -> 0.9024   acc: 82.14% -> 80.71%             
client [56] (test)  loss: 1.3212 -> 1.3585   acc: 80.64% -> 80.45%             
client [5] (test)  loss: 1.1921 -> 1.2356   acc: 82.29% -> 82.21%              
client [52] (test)  loss: 1.4946 -> 1.5168   acc: 78.57% -> 78.55%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.8453 -> 0.0000', 'accuracy': '83.93% -> 0.00%'},          
    200: {'loss': '1.0277 -> 0.0000', 'accuracy': '84.33% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 30.0%(36.50%) at epoch: 1                                     
FedFomo achieved 40.0%(42.39%) at epoch: 3                                     
FedFomo achieved 50.0%(51.21%) at epoch: 4                                     
FedFomo achieved 70.0%(74.58%) at epoch: 7                                     
FedFomo achieved 80.0%(85.03%) at epoch: 22                                    
FedFomo achieved 90.0%(90.06%) at epoch: 146                                   
Convergence (test_after):                                                      
FedFomo achieved 70.0%(73.72%) at epoch: 0                                     
FedFomo achieved 80.0%(82.21%) at epoch: 3                                     
FedFomo achieved 90.0%(90.15%) at epoch: 146                                   
