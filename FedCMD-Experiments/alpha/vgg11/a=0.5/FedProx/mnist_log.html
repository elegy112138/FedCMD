==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6572 -> 0.2314   acc: 78.60% -> 93.49%             
client [81] (test)  loss: 0.3738 -> 0.2852   acc: 88.89% -> 91.27%             
client [21] (test)  loss: 0.2675 -> 0.1096   acc: 90.60% -> 97.15%             
client [68] (test)  loss: 0.2629 -> 0.0489   acc: 92.11% -> 97.91%             
client [93] (test)  loss: 0.3115 -> 0.1145   acc: 88.78% -> 96.79%             
client [31] (test)  loss: 0.5758 -> 0.2736   acc: 81.37% -> 91.72%             
client [20] (test)  loss: 0.5553 -> 0.1766   acc: 82.41% -> 94.44%             
client [59] (test)  loss: 0.1961 -> 0.1137   acc: 93.03% -> 96.52%             
client [48] (test)  loss: 0.3566 -> 0.1219   acc: 88.22% -> 96.82%             
client [34] (test)  loss: 0.2952 -> 0.1908   acc: 90.16% -> 95.43%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.2959 -> 0.1895   acc: 92.12% -> 95.11%             
client [99] (test)  loss: 0.3028 -> 0.1581   acc: 89.75% -> 94.97%             
client [67] (test)  loss: 0.2851 -> 0.1117   acc: 90.86% -> 96.40%             
client [0] (test)  loss: 0.2018 -> 0.0421   acc: 92.57% -> 98.65%              
client [76] (test)  loss: 0.3435 -> 0.2049   acc: 90.19% -> 93.06%             
client [41] (test)  loss: 0.2780 -> 0.1503   acc: 91.73% -> 96.49%             
client [62] (test)  loss: 0.2156 -> 0.1630   acc: 94.15% -> 95.32%             
client [2] (test)  loss: 0.0876 -> 0.0511   acc: 97.61% -> 98.48%              
client [14] (test)  loss: 0.1393 -> 0.0885   acc: 95.17% -> 97.16%             
client [46] (test)  loss: 0.2090 -> 0.1406   acc: 93.56% -> 95.71%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.1131 -> 0.0626   acc: 95.87% -> 97.52%             
client [68] (test)  loss: 0.0913 -> 0.0247   acc: 96.98% -> 99.30%             
client [57] (test)  loss: 0.1706 -> 0.0931   acc: 94.76% -> 97.62%             
client [17] (test)  loss: 0.1813 -> 0.1068   acc: 94.68% -> 97.16%             
client [54] (test)  loss: 0.1188 -> 0.0094   acc: 96.99% -> 100.00%            
client [23] (test)  loss: 0.1520 -> 0.0812   acc: 94.47% -> 96.05%             
client [35] (test)  loss: 0.2133 -> 0.1793   acc: 93.45% -> 95.52%             
client [59] (test)  loss: 0.0511 -> 0.0430   acc: 98.01% -> 98.51%             
client [31] (test)  loss: 0.3430 -> 0.1900   acc: 90.89% -> 94.41%             
client [9] (test)  loss: 0.1775 -> 0.0918   acc: 94.83% -> 97.41%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1599 -> 0.1503   acc: 94.68% -> 95.04%             
client [33] (test)  loss: 0.1641 -> 0.1540   acc: 95.29% -> 95.29%             
client [16] (test)  loss: 0.1116 -> 0.1248   acc: 96.08% -> 94.90%             
client [44] (test)  loss: 0.0846 -> 0.0523   acc: 97.98% -> 98.18%             
client [8] (test)  loss: 0.2326 -> 0.1690   acc: 95.03% -> 95.65%              
client [31] (test)  loss: 0.2479 -> 0.1610   acc: 92.34% -> 95.45%             
client [47] (test)  loss: 0.1188 -> 0.0467   acc: 97.40% -> 99.07%             
client [36] (test)  loss: 0.2345 -> 0.0770   acc: 93.55% -> 97.85%             
client [20] (test)  loss: 0.1863 -> 0.0732   acc: 94.14% -> 96.30%             
client [56] (test)  loss: 0.1406 -> 0.1156   acc: 95.20% -> 96.87%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1351 -> 0.1176   acc: 95.99% -> 96.56%              
client [60] (test)  loss: 0.0249 -> 0.0112   acc: 99.09% -> 99.70%             
client [28] (test)  loss: 0.0962 -> 0.0194   acc: 97.73% -> 99.43%             
client [25] (test)  loss: 0.1572 -> 0.1308   acc: 95.27% -> 96.45%             
client [58] (test)  loss: 0.1629 -> 0.0748   acc: 95.57% -> 97.60%             
client [44] (test)  loss: 0.0754 -> 0.0453   acc: 98.18% -> 98.18%             
client [39] (test)  loss: 0.0865 -> 0.0542   acc: 96.57% -> 97.43%             
client [29] (test)  loss: 0.2497 -> 0.1796   acc: 93.55% -> 94.84%             
client [3] (test)  loss: 0.1488 -> 0.1223   acc: 96.23% -> 97.17%              
client [84] (test)  loss: 0.0694 -> 0.0656   acc: 97.76% -> 98.17%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0617 -> 0.0319   acc: 97.44% -> 99.43%             
client [84] (test)  loss: 0.0776 -> 0.0600   acc: 97.35% -> 98.37%             
client [10] (test)  loss: 0.1024 -> 0.0640   acc: 97.30% -> 98.77%             
client [36] (test)  loss: 0.1314 -> 0.0635   acc: 95.48% -> 98.06%             
client [65] (test)  loss: 0.0772 -> 0.0647   acc: 98.19% -> 97.93%             
client [81] (test)  loss: 0.1710 -> 0.1303   acc: 94.44% -> 96.03%             
client [79] (test)  loss: 0.0813 -> 0.0665   acc: 97.70% -> 97.99%             
client [42] (test)  loss: 0.0993 -> 0.0256   acc: 95.75% -> 99.50%             
client [11] (test)  loss: 0.1206 -> 0.0729   acc: 96.91% -> 97.47%             
client [96] (test)  loss: 0.1216 -> 0.0341   acc: 95.25% -> 98.88%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2145 -> 0.1531   acc: 96.27% -> 96.89%              
client [53] (test)  loss: 0.1829 -> 0.1625   acc: 93.08% -> 94.81%             
client [52] (test)  loss: 0.1511 -> 0.1252   acc: 95.07% -> 96.06%             
client [42] (test)  loss: 0.0704 -> 0.0241   acc: 96.75% -> 99.25%             
client [69] (test)  loss: 0.1146 -> 0.1016   acc: 95.92% -> 97.28%             
client [59] (test)  loss: 0.0389 -> 0.0306   acc: 98.01% -> 98.51%             
client [7] (test)  loss: 0.0912 -> 0.0389   acc: 97.70% -> 99.23%              
client [26] (test)  loss: 0.1531 -> 0.0922   acc: 95.38% -> 97.69%             
client [49] (test)  loss: 0.0853 -> 0.0997   acc: 97.24% -> 97.55%             
client [98] (test)  loss: 0.1155 -> 0.0705   acc: 95.10% -> 97.96%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1116 -> 0.0656   acc: 96.33% -> 98.37%             
client [47] (test)  loss: 0.1068 -> 0.0352   acc: 97.22% -> 99.07%             
client [21] (test)  loss: 0.0543 -> 0.0287   acc: 98.01% -> 99.72%             
client [77] (test)  loss: 0.1318 -> 0.1040   acc: 96.28% -> 96.74%             
client [95] (test)  loss: 0.1351 -> 0.0545   acc: 96.01% -> 97.76%             
client [91] (test)  loss: 0.0673 -> 0.0394   acc: 97.05% -> 98.31%             
client [14] (test)  loss: 0.0600 -> 0.0602   acc: 98.30% -> 98.30%             
client [99] (test)  loss: 0.1151 -> 0.0644   acc: 97.10% -> 98.26%             
client [20] (test)  loss: 0.1341 -> 0.0544   acc: 95.68% -> 97.84%             
client [39] (test)  loss: 0.0664 -> 0.0312   acc: 97.43% -> 98.29%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1999 -> 0.1159   acc: 96.06% -> 96.06%             
client [62] (test)  loss: 0.1228 -> 0.0876   acc: 97.08% -> 97.37%             
client [71] (test)  loss: 0.1606 -> 0.0611   acc: 95.96% -> 97.98%             
client [97] (test)  loss: 0.2357 -> 0.1027   acc: 94.76% -> 97.06%             
client [30] (test)  loss: 0.0838 -> 0.1055   acc: 97.67% -> 97.38%             
client [88] (test)  loss: 0.1412 -> 0.0797   acc: 96.44% -> 98.22%             
client [60] (test)  loss: 0.0134 -> 0.0070   acc: 99.70% -> 100.00%            
client [82] (test)  loss: 0.1040 -> 0.0292   acc: 97.78% -> 99.17%             
client [91] (test)  loss: 0.0451 -> 0.0326   acc: 97.89% -> 98.31%             
client [57] (test)  loss: 0.1051 -> 0.0588   acc: 96.19% -> 97.62%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1463 -> 0.1019   acc: 96.07% -> 97.72%             
client [15] (test)  loss: 0.1791 -> 0.1412   acc: 95.05% -> 96.15%             
client [71] (test)  loss: 0.1167 -> 0.0640   acc: 94.95% -> 97.98%             
client [97] (test)  loss: 0.1405 -> 0.0968   acc: 97.06% -> 97.48%             
client [53] (test)  loss: 0.1261 -> 0.1423   acc: 95.16% -> 95.50%             
client [77] (test)  loss: 0.1102 -> 0.0968   acc: 95.81% -> 97.21%             
client [76] (test)  loss: 0.1120 -> 0.0857   acc: 96.89% -> 97.61%             
client [79] (test)  loss: 0.0651 -> 0.0627   acc: 98.28% -> 98.56%             
client [28] (test)  loss: 0.0883 -> 0.0190   acc: 97.73% -> 99.72%             
client [99] (test)  loss: 0.1065 -> 0.0557   acc: 97.10% -> 98.65%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1533 -> 0.0945   acc: 96.02% -> 97.27%             
client [86] (test)  loss: 0.0787 -> 0.0368   acc: 97.53% -> 98.65%             
client [34] (test)  loss: 0.1453 -> 0.1052   acc: 96.66% -> 98.07%             
client [73] (test)  loss: 0.0350 -> 0.0264   acc: 98.72% -> 98.98%             
client [5] (test)  loss: 0.0645 -> 0.0502   acc: 97.49% -> 98.24%              
client [96] (test)  loss: 0.1033 -> 0.0362   acc: 96.09% -> 98.60%             
client [22] (test)  loss: 0.0988 -> 0.0481   acc: 98.01% -> 98.86%             
client [60] (test)  loss: 0.0174 -> 0.0055   acc: 99.39% -> 100.00%            
client [66] (test)  loss: 0.0396 -> 0.0142   acc: 98.42% -> 99.41%             
client [83] (test)  loss: 0.1850 -> 0.1983   acc: 96.53% -> 94.59%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1284 -> 0.0885   acc: 96.65% -> 97.61%             
client [65] (test)  loss: 0.0576 -> 0.0596   acc: 98.45% -> 98.70%             
client [95] (test)  loss: 0.1331 -> 0.0453   acc: 96.26% -> 98.50%             
client [17] (test)  loss: 0.0705 -> 0.0568   acc: 98.58% -> 98.58%             
client [8] (test)  loss: 0.1587 -> 0.1073   acc: 96.27% -> 97.52%              
client [35] (test)  loss: 0.0769 -> 0.0943   acc: 97.24% -> 97.24%             
client [98] (test)  loss: 0.0803 -> 0.0654   acc: 97.14% -> 98.37%             
client [53] (test)  loss: 0.1517 -> 0.1432   acc: 93.77% -> 95.16%             
client [43] (test)  loss: 0.0952 -> 0.1079   acc: 97.62% -> 97.28%             
client [64] (test)  loss: 0.0897 -> 0.0937   acc: 96.81% -> 97.52%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0324 -> 0.0217   acc: 98.29% -> 99.43%             
client [88] (test)  loss: 0.1446 -> 0.0673   acc: 96.89% -> 98.67%             
client [38] (test)  loss: 0.0445 -> 0.0246   acc: 98.25% -> 99.50%             
client [3] (test)  loss: 0.1433 -> 0.1556   acc: 97.17% -> 96.70%              
client [5] (test)  loss: 0.0723 -> 0.0471   acc: 97.74% -> 98.49%              
client [41] (test)  loss: 0.1279 -> 0.0676   acc: 96.74% -> 97.74%             
client [7] (test)  loss: 0.0665 -> 0.0374   acc: 97.96% -> 98.98%              
client [37] (test)  loss: 0.3173 -> 0.1344   acc: 92.36% -> 97.45%             
client [45] (test)  loss: 0.1861 -> 0.0221   acc: 94.78% -> 99.45%             
client [47] (test)  loss: 0.0979 -> 0.0323   acc: 97.59% -> 99.44%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0787 -> 0.1040   acc: 97.65% -> 96.08%             
client [11] (test)  loss: 0.1052 -> 0.0549   acc: 96.91% -> 98.60%             
client [37] (test)  loss: 0.1987 -> 0.1337   acc: 94.59% -> 97.45%             
client [41] (test)  loss: 0.1239 -> 0.0617   acc: 96.74% -> 97.99%             
client [95] (test)  loss: 0.1206 -> 0.0545   acc: 96.76% -> 97.76%             
client [53] (test)  loss: 0.1272 -> 0.1284   acc: 95.85% -> 95.50%             
client [22] (test)  loss: 0.0765 -> 0.0403   acc: 98.01% -> 98.86%             
client [25] (test)  loss: 0.1180 -> 0.1311   acc: 97.04% -> 97.63%             
client [69] (test)  loss: 0.1204 -> 0.0714   acc: 96.47% -> 97.55%             
client [46] (test)  loss: 0.1365 -> 0.0893   acc: 96.14% -> 97.85%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0706 -> 0.0349   acc: 98.52% -> 99.26%             
client [69] (test)  loss: 0.0814 -> 0.0646   acc: 97.01% -> 97.83%             
client [82] (test)  loss: 0.1229 -> 0.0380   acc: 97.78% -> 98.89%             
client [45] (test)  loss: 0.0877 -> 0.0183   acc: 96.98% -> 99.73%             
client [7] (test)  loss: 0.0458 -> 0.0345   acc: 98.72% -> 99.23%              
client [50] (test)  loss: 0.1494 -> 0.1289   acc: 95.17% -> 95.65%             
client [35] (test)  loss: 0.0657 -> 0.0771   acc: 97.93% -> 97.93%             
client [24] (test)  loss: 0.0686 -> 0.0379   acc: 96.97% -> 98.35%             
client [15] (test)  loss: 0.1927 -> 0.1238   acc: 95.88% -> 96.43%             
client [58] (test)  loss: 0.0813 -> 0.0521   acc: 97.79% -> 98.34%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0573 -> 0.0156   acc: 98.09% -> 99.68%             
client [76] (test)  loss: 0.1125 -> 0.0767   acc: 97.13% -> 98.09%             
client [67] (test)  loss: 0.0966 -> 0.0416   acc: 96.95% -> 99.17%             
client [37] (test)  loss: 0.2277 -> 0.1453   acc: 94.59% -> 95.86%             
client [58] (test)  loss: 0.0765 -> 0.0513   acc: 97.97% -> 98.52%             
client [64] (test)  loss: 0.0965 -> 0.0946   acc: 96.81% -> 97.16%             
client [77] (test)  loss: 0.0955 -> 0.1039   acc: 96.74% -> 97.67%             
client [55] (test)  loss: 0.0784 -> 0.0366   acc: 98.11% -> 98.53%             
client [12] (test)  loss: 0.1179 -> 0.0992   acc: 97.69% -> 97.69%             
client [89] (test)  loss: 0.0750 -> 0.0623   acc: 97.77% -> 99.01%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0625 -> 0.0474   acc: 98.37% -> 98.37%             
client [51] (test)  loss: 0.0331 -> 0.0410   acc: 98.99% -> 98.99%             
client [8] (test)  loss: 0.1419 -> 0.1189   acc: 96.89% -> 97.52%              
client [18] (test)  loss: 0.1939 -> 0.0875   acc: 94.81% -> 97.66%             
client [94] (test)  loss: 0.0799 -> 0.0629   acc: 97.55% -> 98.53%             
client [81] (test)  loss: 0.1043 -> 0.1014   acc: 97.35% -> 97.62%             
client [3] (test)  loss: 0.1489 -> 0.1512   acc: 97.17% -> 96.70%              
client [11] (test)  loss: 0.1035 -> 0.0571   acc: 97.47% -> 98.03%             
client [95] (test)  loss: 0.1382 -> 0.0501   acc: 97.01% -> 97.76%             
client [67] (test)  loss: 0.0885 -> 0.0408   acc: 97.78% -> 99.17%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0382 -> 0.0229   acc: 98.86% -> 99.72%             
client [79] (test)  loss: 0.0865 -> 0.0583   acc: 98.28% -> 98.85%             
client [58] (test)  loss: 0.1271 -> 0.0513   acc: 95.94% -> 98.34%             
client [88] (test)  loss: 0.1152 -> 0.0781   acc: 97.78% -> 98.22%             
client [46] (test)  loss: 0.1319 -> 0.0753   acc: 97.42% -> 98.28%             
client [11] (test)  loss: 0.0906 -> 0.0593   acc: 98.03% -> 98.60%             
client [55] (test)  loss: 0.0768 -> 0.0362   acc: 98.32% -> 98.95%             
client [13] (test)  loss: 0.0632 -> 0.0242   acc: 98.38% -> 99.19%             
client [31] (test)  loss: 0.1732 -> 0.0979   acc: 95.03% -> 97.72%             
client [75] (test)  loss: 0.0133 -> 0.0192   acc: 100.00% -> 98.86%            
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1077 -> 0.0278   acc: 97.78% -> 98.89%             
client [7] (test)  loss: 0.0604 -> 0.0329   acc: 98.21% -> 99.49%              
client [57] (test)  loss: 0.0857 -> 0.0288   acc: 97.62% -> 98.57%             
client [13] (test)  loss: 0.0951 -> 0.0248   acc: 97.84% -> 99.19%             
client [43] (test)  loss: 0.1202 -> 0.1109   acc: 97.62% -> 97.28%             
client [91] (test)  loss: 0.0274 -> 0.0228   acc: 99.16% -> 99.58%             
client [10] (test)  loss: 0.0730 -> 0.0537   acc: 97.79% -> 99.02%             
client [64] (test)  loss: 0.0990 -> 0.0808   acc: 96.81% -> 97.16%             
client [82] (test)  loss: 0.1290 -> 0.0414   acc: 97.51% -> 98.89%             
client [22] (test)  loss: 0.0957 -> 0.0401   acc: 97.44% -> 98.58%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1098 -> 0.0544   acc: 97.22% -> 98.15%             
client [23] (test)  loss: 0.0776 -> 0.0771   acc: 97.23% -> 97.63%             
client [88] (test)  loss: 0.1152 -> 0.0722   acc: 97.78% -> 98.67%             
client [98] (test)  loss: 0.0822 -> 0.0773   acc: 97.96% -> 97.96%             
client [79] (test)  loss: 0.0487 -> 0.0572   acc: 98.56% -> 98.56%             
client [21] (test)  loss: 0.0507 -> 0.0233   acc: 97.44% -> 99.43%             
client [92] (test)  loss: 0.0920 -> 0.0342   acc: 97.62% -> 98.41%             
client [56] (test)  loss: 0.0732 -> 0.0576   acc: 97.70% -> 98.12%             
client [5] (test)  loss: 0.0612 -> 0.0522   acc: 97.74% -> 98.74%              
client [52] (test)  loss: 0.1275 -> 0.1024   acc: 96.55% -> 96.55%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1023 -> 0.0000', 'accuracy': '97.02% -> 0.00%'},          
    200: {'loss': '0.0892 -> 0.0000', 'accuracy': '97.53% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(23.67%) at epoch: 1                                     
FedProx achieved 60.0%(68.64%) at epoch: 2                                     
FedProx achieved 70.0%(73.83%) at epoch: 3                                     
FedProx achieved 80.0%(84.99%) at epoch: 5                                     
FedProx achieved 90.0%(91.69%) at epoch: 11                                    
Convergence (test_after):                                                      
FedProx achieved 70.0%(74.51%) at epoch: 0                                     
FedProx achieved 80.0%(88.75%) at epoch: 3                                     
FedProx achieved 90.0%(91.71%) at epoch: 4                                     
