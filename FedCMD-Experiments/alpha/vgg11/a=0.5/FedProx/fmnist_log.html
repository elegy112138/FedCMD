==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6247 -> 0.4684   acc: 82.12% -> 85.14%             
client [81] (test)  loss: 0.4631 -> 0.2753   acc: 82.09% -> 90.30%             
client [21] (test)  loss: 0.6029 -> 2.3953   acc: 78.79% -> 44.24%             
client [68] (test)  loss: 1.3301 -> 0.5880   acc: 41.41% -> 77.83%             
client [93] (test)  loss: 0.5232 -> 0.8776   acc: 81.65% -> 70.28%             
client [31] (test)  loss: 0.5521 -> 0.5553   acc: 78.21% -> 81.28%             
client [20] (test)  loss: 0.4096 -> 0.1838   acc: 83.38% -> 92.61%             
client [59] (test)  loss: 0.4568 -> 0.3680   acc: 84.28% -> 89.96%             
client [48] (test)  loss: 0.9511 -> 0.6173   acc: 61.43% -> 73.93%             
client [34] (test)  loss: 0.4585 -> 0.3635   acc: 84.22% -> 87.28%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5334 -> 0.5153   acc: 80.95% -> 83.33%             
client [99] (test)  loss: 0.6899 -> 0.2673   acc: 71.85% -> 91.85%             
client [67] (test)  loss: 0.4154 -> 0.3211   acc: 86.32% -> 89.94%             
client [0] (test)  loss: 0.7082 -> 0.6659   acc: 74.29% -> 79.96%              
client [76] (test)  loss: 0.6968 -> 0.3884   acc: 75.14% -> 85.74%             
client [41] (test)  loss: 0.5106 -> 0.1344   acc: 80.56% -> 95.28%             
client [62] (test)  loss: 0.5462 -> 0.2537   acc: 77.70% -> 90.24%             
client [2] (test)  loss: 0.7715 -> 0.5225   acc: 70.35% -> 84.23%              
client [14] (test)  loss: 0.4466 -> 0.3937   acc: 83.65% -> 87.74%             
client [46] (test)  loss: 0.8217 -> 0.3648   acc: 70.67% -> 85.87%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0123 -> 0.8897   acc: 64.63% -> 73.14%             
client [68] (test)  loss: 1.0221 -> 0.5658   acc: 60.65% -> 80.76%             
client [57] (test)  loss: 0.2200 -> 0.1871   acc: 92.50% -> 96.67%             
client [17] (test)  loss: 0.4165 -> 0.3007   acc: 86.32% -> 90.88%             
client [54] (test)  loss: 0.6268 -> 0.6227   acc: 80.97% -> 82.04%             
client [23] (test)  loss: 0.6466 -> 0.3856   acc: 78.75% -> 85.00%             
client [35] (test)  loss: 0.2927 -> 0.5090   acc: 89.92% -> 84.50%             
client [59] (test)  loss: 0.3154 -> 0.2814   acc: 89.52% -> 93.45%             
client [31] (test)  loss: 0.5413 -> 0.4929   acc: 80.17% -> 84.92%             
client [9] (test)  loss: 0.2568 -> 0.1012   acc: 90.87% -> 96.15%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3416 -> 0.2270   acc: 87.14% -> 93.71%             
client [33] (test)  loss: 0.6909 -> 0.1360   acc: 77.78% -> 95.96%             
client [16] (test)  loss: 0.3342 -> 0.1948   acc: 91.89% -> 95.20%             
client [44] (test)  loss: 0.4398 -> 0.2287   acc: 85.82% -> 94.33%             
client [8] (test)  loss: 0.3443 -> 0.3317   acc: 90.39% -> 93.45%              
client [31] (test)  loss: 0.5921 -> 0.4716   acc: 80.17% -> 84.92%             
client [47] (test)  loss: 0.5398 -> 0.2577   acc: 80.88% -> 91.65%             
client [36] (test)  loss: 0.2427 -> 0.1942   acc: 91.92% -> 93.46%             
client [20] (test)  loss: 0.3715 -> 0.2020   acc: 87.34% -> 93.93%             
client [56] (test)  loss: 0.3894 -> 0.4767   acc: 85.22% -> 86.70%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5881 -> 0.5109   acc: 78.91% -> 80.47%              
client [60] (test)  loss: 0.4549 -> 0.2851   acc: 86.67% -> 90.91%             
client [28] (test)  loss: 0.5779 -> 0.2155   acc: 83.94% -> 94.08%             
client [25] (test)  loss: 0.4708 -> 0.3252   acc: 85.34% -> 88.93%             
client [58] (test)  loss: 0.9165 -> 0.6756   acc: 73.08% -> 77.75%             
client [44] (test)  loss: 0.3772 -> 0.2002   acc: 89.43% -> 95.88%             
client [39] (test)  loss: 0.3151 -> 0.2757   acc: 89.97% -> 91.79%             
client [29] (test)  loss: 0.4697 -> 0.4725   acc: 87.14% -> 85.83%             
client [3] (test)  loss: 0.2836 -> 0.2283   acc: 90.86% -> 92.64%              
client [84] (test)  loss: 0.5538 -> 0.3570   acc: 84.60% -> 91.06%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5952 -> 0.4573   acc: 83.64% -> 88.18%             
client [84] (test)  loss: 0.5712 -> 0.3528   acc: 83.65% -> 90.30%             
client [10] (test)  loss: 0.3038 -> 0.2893   acc: 91.46% -> 93.99%             
client [36] (test)  loss: 0.2285 -> 0.1673   acc: 92.88% -> 95.00%             
client [65] (test)  loss: 0.5354 -> 0.4736   acc: 86.36% -> 87.34%             
client [81] (test)  loss: 0.2600 -> 0.1631   acc: 93.28% -> 94.03%             
client [79] (test)  loss: 1.0190 -> 1.0741   acc: 70.32% -> 75.22%             
client [42] (test)  loss: 0.6419 -> 0.4221   acc: 79.47% -> 89.61%             
client [11] (test)  loss: 0.2262 -> 0.1105   acc: 93.00% -> 96.84%             
client [96] (test)  loss: 0.6533 -> 0.4697   acc: 80.16% -> 85.71%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3661 -> 0.3286   acc: 90.39% -> 92.58%              
client [53] (test)  loss: 0.6015 -> 0.4974   acc: 82.39% -> 86.05%             
client [52] (test)  loss: 0.3323 -> 0.2838   acc: 89.18% -> 91.52%             
client [42] (test)  loss: 0.4592 -> 0.3565   acc: 84.06% -> 90.82%             
client [69] (test)  loss: 0.3643 -> 0.3879   acc: 87.80% -> 88.99%             
client [59] (test)  loss: 0.3263 -> 0.3086   acc: 89.96% -> 93.01%             
client [7] (test)  loss: 0.3693 -> 0.3207   acc: 88.48% -> 91.96%              
client [26] (test)  loss: 0.2005 -> 0.0899   acc: 93.99% -> 96.72%             
client [49] (test)  loss: 0.4743 -> 0.4348   acc: 83.18% -> 85.93%             
client [98] (test)  loss: 0.2282 -> 0.1549   acc: 90.79% -> 96.32%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2836 -> 0.1486   acc: 89.74% -> 95.26%             
client [47] (test)  loss: 0.7292 -> 0.2582   acc: 77.14% -> 92.97%             
client [21] (test)  loss: 0.4472 -> 0.4989   acc: 88.18% -> 86.06%             
client [77] (test)  loss: 0.3778 -> 0.2933   acc: 88.41% -> 91.69%             
client [95] (test)  loss: 0.5086 -> 0.2894   acc: 86.82% -> 93.02%             
client [91] (test)  loss: 0.2440 -> 0.1759   acc: 91.60% -> 94.91%             
client [14] (test)  loss: 0.5714 -> 0.3627   acc: 83.11% -> 90.19%             
client [99] (test)  loss: 0.3355 -> 0.2448   acc: 91.11% -> 92.59%             
client [20] (test)  loss: 0.3326 -> 0.2060   acc: 91.03% -> 94.46%             
client [39] (test)  loss: 0.3318 -> 0.3439   acc: 89.97% -> 91.49%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3276 -> 0.2604   acc: 91.23% -> 92.69%             
client [62] (test)  loss: 0.2611 -> 0.1900   acc: 91.64% -> 94.77%             
client [71] (test)  loss: 0.4371 -> 0.3066   acc: 88.89% -> 90.12%             
client [97] (test)  loss: 0.5560 -> 0.5176   acc: 85.99% -> 89.88%             
client [30] (test)  loss: 0.5407 -> 0.4494   acc: 82.71% -> 87.38%             
client [88] (test)  loss: 0.3508 -> 0.3239   acc: 90.16% -> 93.02%             
client [60] (test)  loss: 0.4353 -> 0.2803   acc: 84.24% -> 92.73%             
client [82] (test)  loss: 0.7911 -> 1.0296   acc: 78.73% -> 77.62%             
client [91] (test)  loss: 0.1806 -> 0.1502   acc: 94.15% -> 96.44%             
client [57] (test)  loss: 0.2116 -> 0.0730   acc: 94.17% -> 97.22%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4496 -> 0.5146   acc: 89.11% -> 87.15%             
client [15] (test)  loss: 0.5449 -> 0.4330   acc: 86.32% -> 90.88%             
client [71] (test)  loss: 0.6211 -> 0.3755   acc: 83.95% -> 82.72%             
client [97] (test)  loss: 0.6663 -> 0.5445   acc: 85.99% -> 90.27%             
client [53] (test)  loss: 0.6350 -> 0.4576   acc: 80.73% -> 85.38%             
client [77] (test)  loss: 0.5728 -> 0.2941   acc: 83.63% -> 91.69%             
client [76] (test)  loss: 0.9198 -> 0.3636   acc: 76.97% -> 87.75%             
client [79] (test)  loss: 0.9626 -> 0.5177   acc: 74.35% -> 84.44%             
client [28] (test)  loss: 0.5602 -> 0.2208   acc: 86.48% -> 93.80%             
client [99] (test)  loss: 0.2208 -> 0.2143   acc: 94.07% -> 93.70%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6804 -> 0.5847   acc: 84.44% -> 89.49%             
client [86] (test)  loss: 0.3841 -> 0.3831   acc: 92.57% -> 92.57%             
client [34] (test)  loss: 0.3634 -> 0.3144   acc: 90.84% -> 93.38%             
client [73] (test)  loss: 0.3564 -> 0.3541   acc: 90.11% -> 91.94%             
client [5] (test)  loss: 0.2981 -> 0.2483   acc: 92.86% -> 96.08%              
client [96] (test)  loss: 0.6886 -> 0.7043   acc: 81.75% -> 83.33%             
client [22] (test)  loss: 1.2306 -> 0.5180   acc: 69.80% -> 88.26%             
client [60] (test)  loss: 0.3593 -> 0.2858   acc: 89.09% -> 92.73%             
client [66] (test)  loss: 0.4908 -> 0.2680   acc: 88.45% -> 94.42%             
client [83] (test)  loss: 0.4264 -> 0.3056   acc: 89.81% -> 93.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6176 -> 0.5167   acc: 83.36% -> 86.47%             
client [65] (test)  loss: 0.5021 -> 0.5323   acc: 85.39% -> 87.99%             
client [95] (test)  loss: 0.6022 -> 0.3242   acc: 85.66% -> 91.86%             
client [17] (test)  loss: 0.3219 -> 0.3215   acc: 90.88% -> 91.79%             
client [8] (test)  loss: 0.3750 -> 0.3059   acc: 90.83% -> 93.45%              
client [35] (test)  loss: 0.2015 -> 0.1831   acc: 95.09% -> 94.83%             
client [98] (test)  loss: 0.2313 -> 0.1423   acc: 93.16% -> 96.05%             
client [53] (test)  loss: 0.5767 -> 0.5000   acc: 85.38% -> 85.71%             
client [43] (test)  loss: 0.3839 -> 0.2751   acc: 89.95% -> 90.45%             
client [64] (test)  loss: 0.3680 -> 0.2374   acc: 89.43% -> 93.14%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7186 -> 0.4462   acc: 80.61% -> 88.79%             
client [88] (test)  loss: 0.3635 -> 0.3280   acc: 89.52% -> 92.38%             
client [38] (test)  loss: 0.8667 -> 0.4631   acc: 75.69% -> 88.95%             
client [3] (test)  loss: 0.2308 -> 0.2191   acc: 93.40% -> 94.42%              
client [5] (test)  loss: 0.3999 -> 0.2658   acc: 91.01% -> 96.54%              
client [41] (test)  loss: 0.3542 -> 0.1546   acc: 89.72% -> 95.56%             
client [7] (test)  loss: 0.5495 -> 0.3741   acc: 83.48% -> 91.52%              
client [37] (test)  loss: 0.5625 -> 0.2461   acc: 84.90% -> 93.75%             
client [45] (test)  loss: 0.4070 -> 0.2193   acc: 90.96% -> 95.48%             
client [47] (test)  loss: 0.7920 -> 0.2931   acc: 79.78% -> 92.53%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2623 -> 0.1664   acc: 92.49% -> 96.40%             
client [11] (test)  loss: 0.2044 -> 0.0885   acc: 94.58% -> 97.07%             
client [37] (test)  loss: 0.4030 -> 0.2095   acc: 88.54% -> 94.53%             
client [41] (test)  loss: 0.2999 -> 0.1108   acc: 90.00% -> 96.94%             
client [95] (test)  loss: 0.5224 -> 0.2859   acc: 85.66% -> 92.25%             
client [53] (test)  loss: 0.5231 -> 0.5022   acc: 86.71% -> 85.38%             
client [22] (test)  loss: 0.8954 -> 0.4693   acc: 72.82% -> 88.59%             
client [25] (test)  loss: 0.4142 -> 0.2992   acc: 89.09% -> 93.49%             
client [69] (test)  loss: 0.3596 -> 0.3691   acc: 90.48% -> 90.77%             
client [46] (test)  loss: 0.5485 -> 0.2419   acc: 82.13% -> 93.07%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7791 -> 0.2946   acc: 78.02% -> 93.19%             
client [69] (test)  loss: 0.3619 -> 0.3759   acc: 88.69% -> 91.37%             
client [82] (test)  loss: 0.9356 -> 0.7077   acc: 77.07% -> 83.70%             
client [45] (test)  loss: 0.4070 -> 0.2202   acc: 90.16% -> 95.74%             
client [7] (test)  loss: 0.3535 -> 0.3238   acc: 88.48% -> 92.39%              
client [50] (test)  loss: 0.3914 -> 0.3024   acc: 88.80% -> 93.00%             
client [35] (test)  loss: 0.2258 -> 0.1818   acc: 93.80% -> 95.61%             
client [24] (test)  loss: 0.7996 -> 0.5928   acc: 76.86% -> 85.64%             
client [15] (test)  loss: 0.4010 -> 0.3910   acc: 91.23% -> 91.93%             
client [58] (test)  loss: 0.8533 -> 0.8044   acc: 78.02% -> 80.77%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5540 -> 0.4681   acc: 82.50% -> 87.14%             
client [76] (test)  loss: 0.7061 -> 0.5856   acc: 81.35% -> 86.29%             
client [67] (test)  loss: 0.4082 -> 0.3270   acc: 89.34% -> 91.95%             
client [37] (test)  loss: 0.4845 -> 0.2495   acc: 87.24% -> 94.79%             
client [58] (test)  loss: 1.0212 -> 0.8602   acc: 75.00% -> 81.59%             
client [64] (test)  loss: 0.2876 -> 0.2577   acc: 91.71% -> 93.14%             
client [77] (test)  loss: 0.4531 -> 0.3273   acc: 87.66% -> 93.95%             
client [55] (test)  loss: 0.4462 -> 0.2306   acc: 87.85% -> 94.86%             
client [12] (test)  loss: 0.2975 -> 0.3335   acc: 92.41% -> 92.14%             
client [89] (test)  loss: 0.3917 -> 0.2800   acc: 91.22% -> 91.85%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5764 -> 0.3892   acc: 87.07% -> 92.40%             
client [51] (test)  loss: 0.7139 -> 0.0971   acc: 81.13% -> 97.30%             
client [8] (test)  loss: 0.3742 -> 0.3467   acc: 92.58% -> 93.45%              
client [18] (test)  loss: 0.3471 -> 0.3081   acc: 90.41% -> 91.78%             
client [94] (test)  loss: 0.2689 -> 0.2418   acc: 92.15% -> 94.94%             
client [81] (test)  loss: 0.2230 -> 0.1521   acc: 93.28% -> 94.78%             
client [3] (test)  loss: 0.2301 -> 0.2317   acc: 92.89% -> 94.67%              
client [11] (test)  loss: 0.1863 -> 0.0745   acc: 95.26% -> 97.97%             
client [95] (test)  loss: 0.6837 -> 0.3174   acc: 82.95% -> 91.86%             
client [67] (test)  loss: 0.4053 -> 0.3219   acc: 89.34% -> 91.35%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4942 -> 0.4715   acc: 88.48% -> 89.09%             
client [79] (test)  loss: 1.1200 -> 0.5565   acc: 71.76% -> 84.15%             
client [58] (test)  loss: 1.0029 -> 0.8443   acc: 78.57% -> 81.04%             
client [88] (test)  loss: 0.3012 -> 0.2864   acc: 92.06% -> 92.70%             
client [46] (test)  loss: 0.4438 -> 0.3185   acc: 87.47% -> 90.67%             
client [11] (test)  loss: 0.1776 -> 0.0736   acc: 94.36% -> 97.74%             
client [55] (test)  loss: 0.5174 -> 0.2537   acc: 86.92% -> 94.86%             
client [13] (test)  loss: 0.5106 -> 0.3420   acc: 86.08% -> 90.98%             
client [31] (test)  loss: 0.4522 -> 0.4286   acc: 87.43% -> 89.39%             
client [75] (test)  loss: 0.1794 -> 0.0920   acc: 95.38% -> 98.10%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2424 -> 0.2144   acc: 95.31% -> 96.71%             
client [7] (test)  loss: 0.4440 -> 0.3528   acc: 86.96% -> 93.04%              
client [57] (test)  loss: 0.2028 -> 0.0688   acc: 95.83% -> 98.06%             
client [13] (test)  loss: 0.4293 -> 0.4466   acc: 88.66% -> 87.37%             
client [43] (test)  loss: 0.2820 -> 0.2591   acc: 90.70% -> 91.96%             
client [91] (test)  loss: 0.1844 -> 0.1607   acc: 95.17% -> 95.93%             
client [10] (test)  loss: 0.3376 -> 0.2788   acc: 90.82% -> 93.99%             
client [64] (test)  loss: 0.2538 -> 0.2626   acc: 93.14% -> 92.57%             
client [82] (test)  loss: 1.3126 -> 0.7132   acc: 71.55% -> 84.25%             
client [22] (test)  loss: 1.3138 -> 0.4789   acc: 69.13% -> 88.59%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2859 -> 0.2181   acc: 94.20% -> 95.51%             
client [23] (test)  loss: 0.5083 -> 0.3077   acc: 87.50% -> 91.88%             
client [88] (test)  loss: 0.3681 -> 0.2928   acc: 90.16% -> 90.79%             
client [98] (test)  loss: 0.1560 -> 0.1349   acc: 95.00% -> 96.84%             
client [79] (test)  loss: 0.9217 -> 0.6576   acc: 75.79% -> 82.42%             
client [21] (test)  loss: 0.6090 -> 0.4572   acc: 85.45% -> 89.39%             
client [92] (test)  loss: 0.1818 -> 0.1224   acc: 96.46% -> 98.23%             
client [56] (test)  loss: 0.3070 -> 0.4560   acc: 91.38% -> 90.15%             
client [5] (test)  loss: 0.4275 -> 0.2959   acc: 91.94% -> 95.62%              
client [52] (test)  loss: 0.2839 -> 0.2294   acc: 91.81% -> 92.98%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.5069 -> 0.0000', 'accuracy': '86.08% -> 0.00%'},          
    200: {'loss': '0.4630 -> 0.0000', 'accuracy': '88.38% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(26.03%) at epoch: 1                                     
FedProx achieved 50.0%(52.26%) at epoch: 2                                     
FedProx achieved 60.0%(61.27%) at epoch: 5                                     
FedProx achieved 70.0%(72.82%) at epoch: 7                                     
FedProx achieved 80.0%(83.23%) at epoch: 10                                    
FedProx achieved 90.0%(91.57%) at epoch: 115                                   
Convergence (test_after):                                                      
FedProx achieved 60.0%(61.15%) at epoch: 0                                     
FedProx achieved 70.0%(74.65%) at epoch: 1                                     
FedProx achieved 80.0%(81.17%) at epoch: 4                                     
FedProx achieved 90.0%(90.05%) at epoch: 34                                    
