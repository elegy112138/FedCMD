==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4681 -> 0.6277   acc: 44.93% -> 78.26%             
client [81] (test)  loss: 1.1647 -> 0.1726   acc: 58.59% -> 96.04%             
client [21] (test)  loss: 2.0294 -> 1.7130   acc: 36.61% -> 44.75%             
client [68] (test)  loss: 0.7982 -> 0.3717   acc: 78.64% -> 87.70%             
client [93] (test)  loss: 2.7082 -> 0.4960   acc: 17.91% -> 86.94%             
client [31] (test)  loss: 1.1246 -> 0.7254   acc: 61.36% -> 72.88%             
client [20] (test)  loss: 1.5349 -> 0.8197   acc: 39.67% -> 71.90%             
client [59] (test)  loss: 1.0931 -> 0.3696   acc: 66.34% -> 87.13%             
client [48] (test)  loss: 1.4915 -> 0.9587   acc: 39.30% -> 67.65%             
client [34] (test)  loss: 1.0844 -> 0.7494   acc: 59.34% -> 77.05%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.7024 -> 0.9060   acc: 78.35% -> 67.81%             
client [99] (test)  loss: 0.4014 -> 0.4033   acc: 88.71% -> 86.29%             
client [67] (test)  loss: 0.8912 -> 0.3625   acc: 68.99% -> 87.97%             
client [0] (test)  loss: 0.3455 -> 0.3365   acc: 89.00% -> 89.47%              
client [76] (test)  loss: 0.6543 -> 0.3551   acc: 72.07% -> 86.21%             
client [41] (test)  loss: 1.4240 -> 0.8385   acc: 41.27% -> 64.62%             
client [62] (test)  loss: 0.3052 -> 0.0743   acc: 90.38% -> 97.53%             
client [2] (test)  loss: 0.9667 -> 0.8859   acc: 61.73% -> 62.76%              
client [14] (test)  loss: 0.3428 -> 0.2694   acc: 88.37% -> 91.47%             
client [46] (test)  loss: 0.4472 -> 0.4406   acc: 86.83% -> 84.43%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4370 -> 0.4643   acc: 82.14% -> 81.70%             
client [68] (test)  loss: 0.2437 -> 0.1275   acc: 90.94% -> 95.47%             
client [57] (test)  loss: 0.1783 -> 0.1619   acc: 94.09% -> 94.62%             
client [17] (test)  loss: 0.2661 -> 0.1434   acc: 89.59% -> 94.42%             
client [54] (test)  loss: 0.2868 -> 0.2005   acc: 91.75% -> 95.24%             
client [23] (test)  loss: 1.0401 -> 0.3142   acc: 60.61% -> 89.90%             
client [35] (test)  loss: 0.7748 -> 0.5933   acc: 67.20% -> 74.77%             
client [59] (test)  loss: 0.1903 -> 0.1310   acc: 94.72% -> 95.05%             
client [31] (test)  loss: 0.2390 -> 0.2833   acc: 90.17% -> 90.85%             
client [9] (test)  loss: 0.9392 -> 0.4541   acc: 62.50% -> 84.44%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3024 -> 0.2246   acc: 89.92% -> 91.86%             
client [33] (test)  loss: 0.2960 -> 0.2136   acc: 89.42% -> 94.71%             
client [16] (test)  loss: 0.4309 -> 0.3613   acc: 81.64% -> 85.94%             
client [44] (test)  loss: 0.1374 -> 0.0433   acc: 95.99% -> 98.46%             
client [8] (test)  loss: 0.2427 -> 0.1727   acc: 92.19% -> 95.05%              
client [31] (test)  loss: 0.1823 -> 0.1790   acc: 94.24% -> 92.88%             
client [47] (test)  loss: 0.2521 -> 0.2627   acc: 93.05% -> 93.38%             
client [36] (test)  loss: 0.4365 -> 0.1185   acc: 86.29% -> 96.57%             
client [20] (test)  loss: 0.6244 -> 0.3427   acc: 82.64% -> 90.08%             
client [56] (test)  loss: 0.3862 -> 0.1716   acc: 84.62% -> 95.23%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3446 -> 0.1940   acc: 90.98% -> 93.85%              
client [60] (test)  loss: 0.1342 -> 0.0591   acc: 94.58% -> 97.50%             
client [28] (test)  loss: 0.1315 -> 0.1283   acc: 94.77% -> 95.42%             
client [25] (test)  loss: 1.1929 -> 0.1792   acc: 52.34% -> 95.33%             
client [58] (test)  loss: 0.1171 -> 0.1122   acc: 95.68% -> 96.91%             
client [44] (test)  loss: 0.0824 -> 0.0379   acc: 97.22% -> 98.46%             
client [39] (test)  loss: 0.2452 -> 0.1960   acc: 90.68% -> 91.95%             
client [29] (test)  loss: 0.4373 -> 0.1498   acc: 84.82% -> 95.71%             
client [3] (test)  loss: 0.2681 -> 0.1435   acc: 89.97% -> 95.15%              
client [84] (test)  loss: 0.4662 -> 0.3564   acc: 84.36% -> 86.97%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5032 -> 0.3439   acc: 81.02% -> 88.47%             
client [84] (test)  loss: 0.4019 -> 0.3252   acc: 85.02% -> 88.27%             
client [10] (test)  loss: 0.0571 -> 0.0253   acc: 98.01% -> 98.45%             
client [36] (test)  loss: 0.2257 -> 0.0902   acc: 92.21% -> 97.20%             
client [65] (test)  loss: 0.1604 -> 0.1840   acc: 95.53% -> 95.12%             
client [81] (test)  loss: 0.6377 -> 0.0341   acc: 75.77% -> 99.12%             
client [79] (test)  loss: 0.1869 -> 0.0379   acc: 91.54% -> 99.23%             
client [42] (test)  loss: 0.1525 -> 0.1370   acc: 94.04% -> 95.41%             
client [11] (test)  loss: 0.4493 -> 0.2357   acc: 85.71% -> 91.56%             
client [96] (test)  loss: 0.6660 -> 0.1256   acc: 75.85% -> 96.30%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1152 -> 0.0930   acc: 96.88% -> 97.14%              
client [53] (test)  loss: 0.4640 -> 0.1690   acc: 83.14% -> 94.19%             
client [52] (test)  loss: 0.1604 -> 0.1302   acc: 92.79% -> 94.75%             
client [42] (test)  loss: 0.2940 -> 0.1323   acc: 87.84% -> 95.64%             
client [69] (test)  loss: 0.2724 -> 0.1451   acc: 91.45% -> 95.16%             
client [59] (test)  loss: 0.0995 -> 0.0723   acc: 96.37% -> 98.02%             
client [7] (test)  loss: 0.3801 -> 0.0553   acc: 90.16% -> 97.38%              
client [26] (test)  loss: 0.0230 -> 0.0183   acc: 99.09% -> 99.09%             
client [49] (test)  loss: 0.3359 -> 0.2583   acc: 87.66% -> 91.91%             
client [98] (test)  loss: 0.3430 -> 0.3023   acc: 86.84% -> 90.35%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3370 -> 0.2782   acc: 86.55% -> 90.64%             
client [47] (test)  loss: 0.1944 -> 0.1116   acc: 96.03% -> 96.36%             
client [21] (test)  loss: 0.3863 -> 0.2782   acc: 85.76% -> 90.51%             
client [77] (test)  loss: 0.3511 -> 0.1755   acc: 91.79% -> 94.69%             
client [95] (test)  loss: 0.1602 -> 0.1302   acc: 95.22% -> 95.96%             
client [91] (test)  loss: 0.3296 -> 0.1754   acc: 88.99% -> 94.27%             
client [14] (test)  loss: 0.1262 -> 0.1065   acc: 94.57% -> 96.90%             
client [99] (test)  loss: 0.3354 -> 0.1865   acc: 90.32% -> 93.55%             
client [20] (test)  loss: 0.3949 -> 0.1595   acc: 87.60% -> 93.39%             
client [39] (test)  loss: 0.2154 -> 0.1255   acc: 91.95% -> 94.49%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1673 -> 0.1085   acc: 93.77% -> 96.39%             
client [62] (test)  loss: 0.1244 -> 0.0298   acc: 96.43% -> 98.90%             
client [71] (test)  loss: 0.1543 -> 0.1923   acc: 96.39% -> 95.36%             
client [97] (test)  loss: 0.3978 -> 0.1171   acc: 88.92% -> 96.46%             
client [30] (test)  loss: 0.1025 -> 0.0515   acc: 96.96% -> 98.99%             
client [88] (test)  loss: 0.2193 -> 0.1047   acc: 91.71% -> 96.77%             
client [60] (test)  loss: 0.0479 -> 0.0247   acc: 98.75% -> 99.58%             
client [82] (test)  loss: 0.2507 -> 0.3596   acc: 92.38% -> 88.08%             
client [91] (test)  loss: 0.3921 -> 0.1673   acc: 88.55% -> 94.71%             
client [57] (test)  loss: 0.0763 -> 0.0670   acc: 96.77% -> 97.85%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1065 -> 0.0695   acc: 97.97% -> 97.63%             
client [15] (test)  loss: 0.1590 -> 0.0744   acc: 95.35% -> 98.23%             
client [71] (test)  loss: 0.1377 -> 0.1837   acc: 95.88% -> 95.36%             
client [97] (test)  loss: 0.3080 -> 0.1120   acc: 90.57% -> 97.17%             
client [53] (test)  loss: 0.3310 -> 0.1295   acc: 87.50% -> 95.35%             
client [77] (test)  loss: 0.2698 -> 0.1520   acc: 91.79% -> 95.17%             
client [76] (test)  loss: 0.2575 -> 0.1041   acc: 89.31% -> 96.55%             
client [79] (test)  loss: 0.0690 -> 0.0327   acc: 96.92% -> 98.46%             
client [28] (test)  loss: 0.1231 -> 0.1017   acc: 95.42% -> 96.73%             
client [99] (test)  loss: 0.2119 -> 0.1818   acc: 91.94% -> 94.35%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2258 -> 0.0981   acc: 92.92% -> 96.70%             
client [86] (test)  loss: 0.1379 -> 0.1283   acc: 96.39% -> 95.36%             
client [34] (test)  loss: 0.1763 -> 0.0531   acc: 92.46% -> 97.70%             
client [73] (test)  loss: 0.0155 -> 0.0085   acc: 99.28% -> 99.76%             
client [5] (test)  loss: 0.1563 -> 0.0712   acc: 93.68% -> 98.14%              
client [96] (test)  loss: 0.2987 -> 0.1059   acc: 88.89% -> 97.10%             
client [22] (test)  loss: 0.1040 -> 0.0380   acc: 96.23% -> 98.74%             
client [60] (test)  loss: 0.0204 -> 0.0176   acc: 99.58% -> 99.58%             
client [66] (test)  loss: 0.2373 -> 0.1312   acc: 91.94% -> 96.24%             
client [83] (test)  loss: 0.0913 -> 0.0238   acc: 97.04% -> 99.26%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2540 -> 0.1061   acc: 90.00% -> 97.24%             
client [65] (test)  loss: 0.1087 -> 0.1079   acc: 97.15% -> 96.34%             
client [95] (test)  loss: 0.1021 -> 0.1007   acc: 97.06% -> 97.06%             
client [17] (test)  loss: 0.0649 -> 0.0384   acc: 98.14% -> 98.14%             
client [8] (test)  loss: 0.0718 -> 0.0452   acc: 96.88% -> 98.44%              
client [35] (test)  loss: 0.4677 -> 0.1807   acc: 84.17% -> 94.72%             
client [98] (test)  loss: 0.2543 -> 0.2202   acc: 89.77% -> 92.40%             
client [53] (test)  loss: 0.3077 -> 0.1047   acc: 89.24% -> 96.22%             
client [43] (test)  loss: 0.0488 -> 0.0111   acc: 97.98% -> 99.75%             
client [64] (test)  loss: 0.1364 -> 0.1199   acc: 95.74% -> 95.74%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3904 -> 0.1911   acc: 86.44% -> 94.58%             
client [88] (test)  loss: 0.1322 -> 0.0877   acc: 95.85% -> 97.24%             
client [38] (test)  loss: 0.0420 -> 0.0210   acc: 98.92% -> 99.46%             
client [3] (test)  loss: 0.0596 -> 0.0331   acc: 97.73% -> 99.35%              
client [5] (test)  loss: 0.2197 -> 0.0730   acc: 91.45% -> 97.77%              
client [41] (test)  loss: 0.4487 -> 0.1302   acc: 83.49% -> 95.75%             
client [7] (test)  loss: 0.0985 -> 0.0312   acc: 95.74% -> 99.02%              
client [37] (test)  loss: 0.2276 -> 0.0705   acc: 91.37% -> 98.56%             
client [45] (test)  loss: 0.1400 -> 0.1053   acc: 96.32% -> 95.99%             
client [47] (test)  loss: 0.1954 -> 0.0946   acc: 96.36% -> 97.68%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2239 -> 0.1607   acc: 92.97% -> 95.70%             
client [11] (test)  loss: 0.2330 -> 0.1252   acc: 92.64% -> 96.97%             
client [37] (test)  loss: 0.0805 -> 0.0608   acc: 98.20% -> 98.56%             
client [41] (test)  loss: 0.1493 -> 0.1183   acc: 94.34% -> 95.75%             
client [95] (test)  loss: 0.1387 -> 0.1095   acc: 95.96% -> 96.69%             
client [53] (test)  loss: 0.1375 -> 0.1021   acc: 95.64% -> 96.80%             
client [22] (test)  loss: 0.1013 -> 0.0213   acc: 96.23% -> 98.74%             
client [25] (test)  loss: 0.1124 -> 0.0911   acc: 96.73% -> 97.20%             
client [69] (test)  loss: 0.1468 -> 0.1044   acc: 94.59% -> 97.15%             
client [46] (test)  loss: 0.1529 -> 0.1310   acc: 97.01% -> 96.41%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1311 -> 0.0759   acc: 97.35% -> 99.01%             
client [69] (test)  loss: 0.1153 -> 0.1080   acc: 96.87% -> 97.44%             
client [82] (test)  loss: 0.2352 -> 0.2601   acc: 93.05% -> 91.72%             
client [45] (test)  loss: 0.1429 -> 0.1068   acc: 94.98% -> 96.99%             
client [7] (test)  loss: 0.1550 -> 0.0299   acc: 95.74% -> 99.02%              
client [50] (test)  loss: 0.2216 -> 0.0896   acc: 93.40% -> 97.53%             
client [35] (test)  loss: 0.2437 -> 0.1230   acc: 91.97% -> 95.87%             
client [24] (test)  loss: 0.1373 -> 0.1318   acc: 94.64% -> 95.98%             
client [15] (test)  loss: 0.0738 -> 0.0536   acc: 98.23% -> 98.45%             
client [58] (test)  loss: 0.0545 -> 0.0469   acc: 98.77% -> 99.07%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1663 -> 0.0629   acc: 94.65% -> 97.86%             
client [76] (test)  loss: 0.2539 -> 0.0889   acc: 91.38% -> 97.59%             
client [67] (test)  loss: 0.2283 -> 0.1094   acc: 93.04% -> 96.20%             
client [37] (test)  loss: 0.2023 -> 0.0618   acc: 92.81% -> 98.56%             
client [58] (test)  loss: 0.0714 -> 0.0497   acc: 98.46% -> 98.77%             
client [64] (test)  loss: 0.1175 -> 0.0921   acc: 96.51% -> 96.90%             
client [77] (test)  loss: 0.2418 -> 0.1179   acc: 91.79% -> 96.62%             
client [55] (test)  loss: 0.0264 -> 0.0173   acc: 99.22% -> 99.22%             
client [12] (test)  loss: 0.2080 -> 0.0876   acc: 93.20% -> 96.60%             
client [89] (test)  loss: 0.3472 -> 0.0873   acc: 86.52% -> 97.00%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1997 -> 0.1859   acc: 92.83% -> 93.49%             
client [51] (test)  loss: 0.1511 -> 0.0624   acc: 94.75% -> 98.15%             
client [8] (test)  loss: 0.0311 -> 0.0253   acc: 98.70% -> 98.96%              
client [18] (test)  loss: 0.1127 -> 0.0846   acc: 95.76% -> 96.67%             
client [94] (test)  loss: 0.0583 -> 0.0192   acc: 97.06% -> 99.02%             
client [81] (test)  loss: 0.1397 -> 0.0100   acc: 95.15% -> 99.56%             
client [3] (test)  loss: 0.0334 -> 0.0238   acc: 99.03% -> 99.35%              
client [11] (test)  loss: 0.1537 -> 0.1019   acc: 95.24% -> 96.75%             
client [95] (test)  loss: 0.0898 -> 0.0909   acc: 97.43% -> 97.43%             
client [67] (test)  loss: 0.2209 -> 0.1020   acc: 93.67% -> 96.52%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1577 -> 0.1524   acc: 94.92% -> 94.92%             
client [79] (test)  loss: 0.1244 -> 0.0701   acc: 96.92% -> 96.92%             
client [58] (test)  loss: 0.0657 -> 0.0452   acc: 98.46% -> 99.07%             
client [88] (test)  loss: 0.1199 -> 0.0782   acc: 96.77% -> 97.70%             
client [46] (test)  loss: 0.1397 -> 0.1165   acc: 97.60% -> 96.41%             
client [11] (test)  loss: 0.2444 -> 0.0972   acc: 92.42% -> 97.40%             
client [55] (test)  loss: 0.0195 -> 0.0170   acc: 99.22% -> 99.22%             
client [13] (test)  loss: 0.0768 -> 0.0288   acc: 97.48% -> 99.24%             
client [31] (test)  loss: 0.0616 -> 0.0417   acc: 98.64% -> 99.32%             
client [75] (test)  loss: 0.0248 -> 0.0069   acc: 98.83% -> 100.00%            
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1272 -> 0.0747   acc: 95.20% -> 96.51%             
client [7] (test)  loss: 0.1739 -> 0.0358   acc: 95.08% -> 99.02%              
client [57] (test)  loss: 0.0505 -> 0.0461   acc: 98.39% -> 98.92%             
client [13] (test)  loss: 0.0449 -> 0.0248   acc: 98.24% -> 99.24%             
client [43] (test)  loss: 0.0373 -> 0.0036   acc: 98.74% -> 100.00%            
client [91] (test)  loss: 0.2179 -> 0.1503   acc: 94.27% -> 96.04%             
client [10] (test)  loss: 0.0369 -> 0.0280   acc: 98.90% -> 99.34%             
client [64] (test)  loss: 0.0633 -> 0.0643   acc: 98.06% -> 97.29%             
client [82] (test)  loss: 0.2062 -> 0.2233   acc: 93.05% -> 92.72%             
client [22] (test)  loss: 0.0861 -> 0.0375   acc: 97.49% -> 98.74%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1139 -> 0.0363   acc: 98.35% -> 97.52%             
client [23] (test)  loss: 0.1978 -> 0.0533   acc: 94.44% -> 98.48%             
client [88] (test)  loss: 0.1373 -> 0.0898   acc: 95.39% -> 97.70%             
client [98] (test)  loss: 0.2060 -> 0.1537   acc: 94.44% -> 95.03%             
client [79] (test)  loss: 0.1281 -> 0.0692   acc: 96.92% -> 96.92%             
client [21] (test)  loss: 0.1767 -> 0.1394   acc: 93.56% -> 95.93%             
client [92] (test)  loss: 0.2395 -> 0.1845   acc: 94.29% -> 94.86%             
client [56] (test)  loss: 0.0827 -> 0.0332   acc: 97.08% -> 99.47%             
client [5] (test)  loss: 0.1068 -> 0.0640   acc: 95.54% -> 98.51%              
client [52] (test)  loss: 0.1168 -> 0.0824   acc: 96.07% -> 98.03%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1950 -> 0.0000', 'accuracy': '93.17% -> 0.00%'},          
    200: {'loss': '0.1188 -> 0.0000', 'accuracy': '96.30% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(20.53%) at epoch: 0                                     
FedProx achieved 30.0%(36.55%) at epoch: 3                                     
FedProx achieved 40.0%(48.35%) at epoch: 6                                     
FedProx achieved 50.0%(59.12%) at epoch: 8                                     
FedProx achieved 60.0%(64.43%) at epoch: 12                                    
FedProx achieved 70.0%(71.29%) at epoch: 13                                    
FedProx achieved 80.0%(88.17%) at epoch: 23                                    
FedProx achieved 90.0%(90.84%) at epoch: 42                                    
Convergence (test_after):                                                      
FedProx achieved 50.0%(52.12%) at epoch: 0                                     
FedProx achieved 60.0%(67.49%) at epoch: 3                                     
FedProx achieved 70.0%(71.19%) at epoch: 5                                     
FedProx achieved 80.0%(81.86%) at epoch: 13                                    
FedProx achieved 90.0%(90.75%) at epoch: 20                                    
