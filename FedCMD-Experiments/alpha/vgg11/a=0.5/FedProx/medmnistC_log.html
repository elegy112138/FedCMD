==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.5429 -> 1.0448   acc: 0.00% -> 56.31%              
client [81] (test)  loss: 2.1612 -> 2.0134   acc: 17.12% -> 23.42%             
client [21] (test)  loss: 1.9723 -> 1.2378   acc: 11.50% -> 67.70%             
client [68] (test)  loss: 2.1886 -> 1.8413   acc: 18.95% -> 31.58%             
client [93] (test)  loss: 1.8122 -> 1.2126   acc: 40.94% -> 60.63%             
client [31] (test)  loss: 2.2523 -> 0.8238   acc: 2.48% -> 80.99%              
client [20] (test)  loss: 0.9153 -> 0.4052   acc: 87.58% -> 87.58%             
client [59] (test)  loss: 1.6029 -> 0.9575   acc: 45.08% -> 70.49%             
client [48] (test)  loss: 1.4237 -> 0.7897   acc: 61.17% -> 77.67%             
client [34] (test)  loss: 2.2136 -> 1.6857   acc: 2.74% -> 34.25%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4607 -> 1.1011   acc: 39.56% -> 59.34%             
client [99] (test)  loss: 1.5250 -> 1.1116   acc: 48.57% -> 50.00%             
client [67] (test)  loss: 1.4789 -> 0.7035   acc: 40.91% -> 73.38%             
client [0] (test)  loss: 0.5722 -> 0.2207   acc: 86.71% -> 94.22%              
client [76] (test)  loss: 1.6204 -> 0.9006   acc: 37.50% -> 67.65%             
client [41] (test)  loss: 1.5008 -> 1.0215   acc: 34.01% -> 64.63%             
client [62] (test)  loss: 1.7958 -> 0.9521   acc: 27.21% -> 62.50%             
client [2] (test)  loss: 0.8220 -> 0.5874   acc: 73.96% -> 84.38%              
client [14] (test)  loss: 0.6231 -> 0.4753   acc: 83.33% -> 85.71%             
client [46] (test)  loss: 0.7084 -> 1.5158   acc: 78.57% -> 76.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7098 -> 0.6434   acc: 82.35% -> 78.15%             
client [68] (test)  loss: 1.1751 -> 0.6468   acc: 49.47% -> 83.16%             
client [57] (test)  loss: 1.4665 -> 0.9012   acc: 35.34% -> 67.67%             
client [17] (test)  loss: 1.1171 -> 0.2839   acc: 41.06% -> 92.05%             
client [54] (test)  loss: 0.9205 -> 0.7336   acc: 62.59% -> 74.82%             
client [23] (test)  loss: 1.3239 -> 1.0757   acc: 48.03% -> 56.69%             
client [35] (test)  loss: 0.9170 -> 1.1914   acc: 67.37% -> 49.47%             
client [59] (test)  loss: 0.4206 -> 0.2565   acc: 81.97% -> 89.34%             
client [31] (test)  loss: 0.4530 -> 0.2368   acc: 82.64% -> 92.56%             
client [9] (test)  loss: 0.7641 -> 0.8296   acc: 68.09% -> 63.83%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9973 -> 0.4160   acc: 61.49% -> 88.51%             
client [33] (test)  loss: 0.6285 -> 0.5211   acc: 78.72% -> 77.30%             
client [16] (test)  loss: 0.8515 -> 0.7303   acc: 66.23% -> 75.50%             
client [44] (test)  loss: 1.1037 -> 0.0070   acc: 70.45% -> 100.00%            
client [8] (test)  loss: 0.3962 -> 0.2039   acc: 87.10% -> 91.13%              
client [31] (test)  loss: 0.2624 -> 0.2018   acc: 90.91% -> 91.74%             
client [47] (test)  loss: 0.6516 -> 0.5124   acc: 74.24% -> 86.36%             
client [36] (test)  loss: 0.4705 -> 0.4445   acc: 87.50% -> 83.33%             
client [20] (test)  loss: 0.3132 -> 0.1402   acc: 91.50% -> 95.42%             
client [56] (test)  loss: 0.8373 -> 0.2398   acc: 66.67% -> 89.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3138 -> 0.1346   acc: 89.89% -> 96.28%              
client [60] (test)  loss: 0.7554 -> 0.7071   acc: 72.94% -> 77.65%             
client [28] (test)  loss: 0.8042 -> 1.1350   acc: 71.70% -> 54.72%             
client [25] (test)  loss: 0.6824 -> 1.0097   acc: 78.15% -> 62.18%             
client [58] (test)  loss: 0.7411 -> 0.6752   acc: 66.92% -> 75.19%             
client [44] (test)  loss: 0.6290 -> 0.0084   acc: 77.27% -> 100.00%            
client [39] (test)  loss: 0.3959 -> 0.2880   acc: 87.68% -> 88.18%             
client [29] (test)  loss: 0.6773 -> 0.6579   acc: 72.03% -> 80.51%             
client [3] (test)  loss: 0.2883 -> 0.2105   acc: 92.49% -> 93.28%              
client [84] (test)  loss: 0.7505 -> 0.4391   acc: 70.59% -> 85.71%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9842 -> 0.3233   acc: 64.16% -> 89.38%             
client [84] (test)  loss: 0.7422 -> 0.6394   acc: 71.43% -> 70.59%             
client [10] (test)  loss: 0.4615 -> 0.2549   acc: 85.71% -> 87.97%             
client [36] (test)  loss: 0.3010 -> 0.3382   acc: 90.28% -> 88.89%             
client [65] (test)  loss: 0.3488 -> 0.2976   acc: 89.34% -> 88.52%             
client [81] (test)  loss: 0.5028 -> 0.3962   acc: 78.38% -> 84.68%             
client [79] (test)  loss: 0.2636 -> 0.2009   acc: 89.44% -> 89.44%             
client [42] (test)  loss: 0.5696 -> 0.5441   acc: 80.16% -> 84.13%             
client [11] (test)  loss: 0.6140 -> 0.6116   acc: 68.57% -> 78.57%             
client [96] (test)  loss: 0.0739 -> 0.0100   acc: 97.56% -> 100.00%            
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2364 -> 0.1310   acc: 91.94% -> 94.35%              
client [53] (test)  loss: 0.3489 -> 0.3000   acc: 88.32% -> 88.32%             
client [52] (test)  loss: 0.2662 -> 0.2176   acc: 91.30% -> 91.93%             
client [42] (test)  loss: 0.5386 -> 0.5118   acc: 82.54% -> 85.71%             
client [69] (test)  loss: 0.4397 -> 0.4426   acc: 84.62% -> 85.71%             
client [59] (test)  loss: 0.1734 -> 0.1530   acc: 96.72% -> 93.44%             
client [7] (test)  loss: 0.5132 -> 0.4152   acc: 83.48% -> 90.43%              
client [26] (test)  loss: 0.3359 -> 0.2351   acc: 89.26% -> 89.26%             
client [49] (test)  loss: 0.2421 -> 0.1984   acc: 91.85% -> 94.07%             
client [98] (test)  loss: 0.5428 -> 0.3518   acc: 83.33% -> 86.67%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4209 -> 0.3125   acc: 86.67% -> 86.67%             
client [47] (test)  loss: 0.2572 -> 0.2852   acc: 93.94% -> 92.42%             
client [21] (test)  loss: 0.4732 -> 0.2732   acc: 82.74% -> 91.59%             
client [77] (test)  loss: 0.4061 -> 0.1619   acc: 91.26% -> 94.17%             
client [95] (test)  loss: 0.4478 -> 0.1237   acc: 87.76% -> 97.28%             
client [91] (test)  loss: 0.6133 -> 0.3769   acc: 79.07% -> 87.60%             
client [14] (test)  loss: 0.2959 -> 0.2670   acc: 92.86% -> 92.86%             
client [99] (test)  loss: 0.4544 -> 0.4677   acc: 84.29% -> 84.29%             
client [20] (test)  loss: 0.2981 -> 0.1189   acc: 92.16% -> 96.73%             
client [39] (test)  loss: 0.2151 -> 0.1901   acc: 92.12% -> 92.61%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2326 -> 0.1687   acc: 90.68% -> 93.17%             
client [62] (test)  loss: 0.5712 -> 0.2456   acc: 80.88% -> 91.91%             
client [71] (test)  loss: 0.5677 -> 0.4542   acc: 82.35% -> 86.27%             
client [97] (test)  loss: 0.3727 -> 0.3615   acc: 84.00% -> 84.00%             
client [30] (test)  loss: 0.3426 -> 0.6098   acc: 90.16% -> 85.25%             
client [88] (test)  loss: 0.6411 -> 0.4331   acc: 78.03% -> 83.33%             
client [60] (test)  loss: 0.5090 -> 0.5786   acc: 83.53% -> 81.18%             
client [82] (test)  loss: 0.4812 -> 0.3448   acc: 83.21% -> 86.26%             
client [91] (test)  loss: 0.6468 -> 0.3313   acc: 76.74% -> 89.92%             
client [57] (test)  loss: 0.5672 -> 0.3566   acc: 81.20% -> 87.97%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1508 -> 0.0750   acc: 95.04% -> 96.69%             
client [15] (test)  loss: 0.2068 -> 0.1240   acc: 90.91% -> 93.94%             
client [71] (test)  loss: 0.5823 -> 0.3893   acc: 81.37% -> 88.24%             
client [97] (test)  loss: 0.3912 -> 0.3475   acc: 84.00% -> 84.00%             
client [53] (test)  loss: 0.2944 -> 0.2619   acc: 89.78% -> 90.51%             
client [77] (test)  loss: 0.4674 -> 0.1235   acc: 88.35% -> 96.12%             
client [76] (test)  loss: 0.3509 -> 0.2354   acc: 90.44% -> 94.85%             
client [79] (test)  loss: 0.2045 -> 0.1356   acc: 94.37% -> 97.18%             
client [28] (test)  loss: 0.2198 -> 0.3485   acc: 94.34% -> 88.68%             
client [99] (test)  loss: 0.4322 -> 0.4459   acc: 84.29% -> 84.29%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4683 -> 0.3381   acc: 84.00% -> 86.00%             
client [86] (test)  loss: 0.0962 -> 0.0447   acc: 96.59% -> 98.86%             
client [34] (test)  loss: 0.4777 -> 0.4427   acc: 87.67% -> 89.04%             
client [73] (test)  loss: 0.5104 -> 0.4223   acc: 81.58% -> 87.72%             
client [5] (test)  loss: 0.3669 -> 0.2737   acc: 87.06% -> 91.76%              
client [96] (test)  loss: 0.0134 -> 0.0032   acc: 99.39% -> 100.00%            
client [22] (test)  loss: 0.2327 -> 0.2268   acc: 92.66% -> 91.74%             
client [60] (test)  loss: 0.4941 -> 0.4759   acc: 83.53% -> 85.88%             
client [66] (test)  loss: 0.1266 -> 0.0622   acc: 92.86% -> 98.21%             
client [83] (test)  loss: 0.5240 -> 0.1676   acc: 85.51% -> 94.86%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3124 -> 0.2537   acc: 92.65% -> 94.12%             
client [65] (test)  loss: 0.2790 -> 0.1998   acc: 90.16% -> 91.80%             
client [95] (test)  loss: 0.3017 -> 0.0814   acc: 91.84% -> 97.28%             
client [17] (test)  loss: 0.4946 -> 0.1476   acc: 82.12% -> 95.36%             
client [8] (test)  loss: 0.1747 -> 0.0980   acc: 91.94% -> 96.77%              
client [35] (test)  loss: 0.3997 -> 0.7160   acc: 87.37% -> 82.11%             
client [98] (test)  loss: 0.3816 -> 0.3063   acc: 90.00% -> 90.00%             
client [53] (test)  loss: 0.2008 -> 0.2469   acc: 94.16% -> 90.51%             
client [43] (test)  loss: 0.4025 -> 0.2022   acc: 82.79% -> 93.44%             
client [64] (test)  loss: 0.3044 -> 0.2164   acc: 91.22% -> 92.57%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4408 -> 0.2943   acc: 86.28% -> 91.15%             
client [88] (test)  loss: 0.4089 -> 0.3315   acc: 87.12% -> 87.88%             
client [38] (test)  loss: 0.1824 -> 0.1468   acc: 96.08% -> 96.08%             
client [3] (test)  loss: 0.1765 -> 0.1343   acc: 93.28% -> 96.05%              
client [5] (test)  loss: 0.3800 -> 0.2846   acc: 85.88% -> 89.41%              
client [41] (test)  loss: 0.3986 -> 0.1212   acc: 82.31% -> 95.24%             
client [7] (test)  loss: 0.3506 -> 0.3170   acc: 89.57% -> 92.17%              
client [37] (test)  loss: 0.4575 -> 0.2087   acc: 85.91% -> 93.29%             
client [45] (test)  loss: 0.2032 -> 0.1530   acc: 94.70% -> 94.70%             
client [47] (test)  loss: 0.1776 -> 0.2288   acc: 95.45% -> 92.42%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3545 -> 0.2235   acc: 86.09% -> 94.70%             
client [11] (test)  loss: 0.3551 -> 0.3248   acc: 85.71% -> 87.14%             
client [37] (test)  loss: 0.4059 -> 0.1832   acc: 89.93% -> 93.96%             
client [41] (test)  loss: 0.6050 -> 0.1237   acc: 79.59% -> 94.56%             
client [95] (test)  loss: 0.2377 -> 0.0552   acc: 93.20% -> 96.60%             
client [53] (test)  loss: 0.1896 -> 0.2337   acc: 95.62% -> 91.24%             
client [22] (test)  loss: 0.1761 -> 0.2246   acc: 93.58% -> 94.50%             
client [25] (test)  loss: 0.5305 -> 0.2548   acc: 88.24% -> 93.28%             
client [69] (test)  loss: 0.5325 -> 0.4335   acc: 80.22% -> 86.81%             
client [46] (test)  loss: 0.1622 -> 0.1477   acc: 96.03% -> 96.03%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2033 -> 0.1973   acc: 90.91% -> 92.42%             
client [69] (test)  loss: 0.5483 -> 0.3909   acc: 81.32% -> 87.91%             
client [82] (test)  loss: 0.2558 -> 0.2725   acc: 90.08% -> 92.37%             
client [45] (test)  loss: 0.2040 -> 0.0964   acc: 94.70% -> 96.97%             
client [7] (test)  loss: 0.4120 -> 0.3099   acc: 88.70% -> 91.30%              
client [50] (test)  loss: 0.2347 -> 0.1094   acc: 92.48% -> 96.24%             
client [35] (test)  loss: 0.4259 -> 0.7015   acc: 87.37% -> 80.00%             
client [24] (test)  loss: 0.3859 -> 0.2441   acc: 89.92% -> 92.44%             
client [15] (test)  loss: 0.1844 -> 0.1156   acc: 93.94% -> 96.97%             
client [58] (test)  loss: 0.4233 -> 0.4056   acc: 84.21% -> 84.96%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1510 -> 0.0892   acc: 95.15% -> 97.09%             
client [76] (test)  loss: 0.4042 -> 0.2625   acc: 90.44% -> 94.12%             
client [67] (test)  loss: 0.3003 -> 0.3109   acc: 90.91% -> 92.21%             
client [37] (test)  loss: 0.4101 -> 0.1930   acc: 89.93% -> 95.97%             
client [58] (test)  loss: 0.3494 -> 0.4241   acc: 87.97% -> 84.21%             
client [64] (test)  loss: 0.2156 -> 0.1803   acc: 94.59% -> 93.24%             
client [77] (test)  loss: 0.3706 -> 0.1270   acc: 93.20% -> 93.20%             
client [55] (test)  loss: 0.4716 -> 0.3893   acc: 86.54% -> 90.38%             
client [12] (test)  loss: 0.2091 -> 0.2146   acc: 92.31% -> 92.31%             
client [89] (test)  loss: 0.2509 -> 0.1549   acc: 90.00% -> 92.86%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4100 -> 0.2855   acc: 84.87% -> 88.24%             
client [51] (test)  loss: 0.3638 -> 0.1341   acc: 87.96% -> 96.30%             
client [8] (test)  loss: 0.1231 -> 0.0781   acc: 96.77% -> 97.58%              
client [18] (test)  loss: 0.1921 -> 0.1954   acc: 92.52% -> 95.33%             
client [94] (test)  loss: 0.1862 -> 0.0750   acc: 94.26% -> 97.54%             
client [81] (test)  loss: 0.1838 -> 0.1642   acc: 93.69% -> 94.59%             
client [3] (test)  loss: 0.1647 -> 0.1165   acc: 94.47% -> 96.44%              
client [11] (test)  loss: 0.2408 -> 0.3154   acc: 90.00% -> 90.00%             
client [95] (test)  loss: 0.2049 -> 0.0399   acc: 94.56% -> 97.96%             
client [67] (test)  loss: 0.4012 -> 0.2501   acc: 87.01% -> 93.51%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2860 -> 0.2448   acc: 91.15% -> 92.04%             
client [79] (test)  loss: 0.1494 -> 0.1181   acc: 96.48% -> 96.48%             
client [58] (test)  loss: 0.3206 -> 0.3656   acc: 87.22% -> 89.47%             
client [88] (test)  loss: 0.3810 -> 0.3214   acc: 88.64% -> 90.91%             
client [46] (test)  loss: 0.1510 -> 0.1340   acc: 95.24% -> 96.03%             
client [11] (test)  loss: 0.2003 -> 0.2856   acc: 92.86% -> 91.43%             
client [55] (test)  loss: 0.4775 -> 0.4103   acc: 85.58% -> 90.38%             
client [13] (test)  loss: 0.3118 -> 0.1888   acc: 90.14% -> 94.37%             
client [31] (test)  loss: 0.0567 -> 0.0407   acc: 97.52% -> 98.35%             
client [75] (test)  loss: 0.1737 -> 0.2204   acc: 92.45% -> 90.57%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1725 -> 0.2083   acc: 93.41% -> 92.31%             
client [7] (test)  loss: 0.3024 -> 0.3273   acc: 92.17% -> 91.30%              
client [57] (test)  loss: 0.2471 -> 0.1899   acc: 92.48% -> 92.48%             
client [13] (test)  loss: 0.3513 -> 0.2414   acc: 91.55% -> 92.96%             
client [43] (test)  loss: 0.4042 -> 0.1441   acc: 82.79% -> 94.26%             
client [91] (test)  loss: 0.5346 -> 0.2151   acc: 81.40% -> 94.57%             
client [10] (test)  loss: 0.2476 -> 0.1242   acc: 91.73% -> 96.99%             
client [64] (test)  loss: 0.2463 -> 0.1758   acc: 93.24% -> 95.95%             
client [82] (test)  loss: 0.3893 -> 0.2617   acc: 88.55% -> 94.66%             
client [22] (test)  loss: 0.1723 -> 0.1626   acc: 92.66% -> 94.50%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1483 -> 0.0466   acc: 96.08% -> 98.69%             
client [23] (test)  loss: 0.4087 -> 0.3106   acc: 82.68% -> 87.40%             
client [88] (test)  loss: 0.3388 -> 0.3179   acc: 88.64% -> 87.88%             
client [98] (test)  loss: 0.3238 -> 0.2492   acc: 91.67% -> 95.00%             
client [79] (test)  loss: 0.1339 -> 0.1035   acc: 96.48% -> 97.18%             
client [21] (test)  loss: 0.3815 -> 0.2402   acc: 88.50% -> 92.92%             
client [92] (test)  loss: 0.2215 -> 0.1957   acc: 92.86% -> 90.82%             
client [56] (test)  loss: 0.3358 -> 0.0867   acc: 88.15% -> 95.56%             
client [5] (test)  loss: 0.3659 -> 0.2509   acc: 88.24% -> 90.59%              
client [52] (test)  loss: 0.1879 -> 0.1506   acc: 94.41% -> 96.27%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.3401 -> 0.0000', 'accuracy': '88.66% -> 0.00%'},          
    200: {'loss': '0.2743 -> 0.0000', 'accuracy': '91.47% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 20.0%(23.85%) at epoch: 0                                     
FedProx achieved 40.0%(44.00%) at epoch: 6                                     
FedProx achieved 50.0%(52.90%) at epoch: 16                                    
FedProx achieved 60.0%(66.78%) at epoch: 24                                    
FedProx achieved 70.0%(70.25%) at epoch: 27                                    
FedProx achieved 80.0%(81.03%) at epoch: 40                                    
FedProx achieved 90.0%(91.17%) at epoch: 114                                   
Convergence (test_after):                                                      
FedProx achieved 40.0%(45.42%) at epoch: 0                                     
FedProx achieved 60.0%(63.87%) at epoch: 6                                     
FedProx achieved 70.0%(72.02%) at epoch: 18                                    
FedProx achieved 80.0%(80.08%) at epoch: 28                                    
FedProx achieved 90.0%(90.09%) at epoch: 48                                    
