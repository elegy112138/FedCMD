==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4205 -> 0.5203   acc: 47.34% -> 84.06%             
client [81] (test)  loss: 0.9591 -> 0.1395   acc: 61.45% -> 96.26%             
client [21] (test)  loss: 2.0181 -> 2.1324   acc: 38.98% -> 30.17%             
client [68] (test)  loss: 0.6528 -> 0.3022   acc: 79.94% -> 89.64%             
client [93] (test)  loss: 2.8769 -> 0.4236   acc: 17.54% -> 89.55%             
client [31] (test)  loss: 0.7833 -> 0.7292   acc: 73.56% -> 75.25%             
client [20] (test)  loss: 1.4322 -> 0.6899   acc: 40.50% -> 76.86%             
client [59] (test)  loss: 0.7120 -> 0.2830   acc: 77.23% -> 90.43%             
client [48] (test)  loss: 1.3355 -> 0.5331   acc: 40.37% -> 80.48%             
client [34] (test)  loss: 0.9101 -> 0.4452   acc: 63.93% -> 85.57%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6504 -> 1.5540   acc: 78.92% -> 58.40%             
client [99] (test)  loss: 0.3411 -> 0.3117   acc: 90.32% -> 90.32%             
client [67] (test)  loss: 0.8270 -> 0.3327   acc: 71.20% -> 88.92%             
client [0] (test)  loss: 0.3243 -> 0.3470   acc: 87.56% -> 89.95%              
client [76] (test)  loss: 0.5844 -> 0.3434   acc: 77.59% -> 86.90%             
client [41] (test)  loss: 1.3189 -> 0.7672   acc: 49.29% -> 66.98%             
client [62] (test)  loss: 0.2410 -> 0.0549   acc: 93.41% -> 97.80%             
client [2] (test)  loss: 0.8008 -> 0.7279   acc: 71.43% -> 72.45%              
client [14] (test)  loss: 0.2858 -> 0.2473   acc: 89.92% -> 92.25%             
client [46] (test)  loss: 0.3871 -> 0.3540   acc: 90.42% -> 90.42%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3876 -> 0.3562   acc: 83.48% -> 85.27%             
client [68] (test)  loss: 0.1992 -> 0.1116   acc: 93.20% -> 96.12%             
client [57] (test)  loss: 0.1575 -> 0.1478   acc: 94.09% -> 95.16%             
client [17] (test)  loss: 0.2144 -> 0.1235   acc: 91.82% -> 95.54%             
client [54] (test)  loss: 0.2598 -> 0.1924   acc: 91.75% -> 95.56%             
client [23] (test)  loss: 0.8828 -> 0.2740   acc: 69.19% -> 90.91%             
client [35] (test)  loss: 0.6991 -> 0.3233   acc: 72.71% -> 87.61%             
client [59] (test)  loss: 0.1506 -> 0.1175   acc: 96.04% -> 95.71%             
client [31] (test)  loss: 0.1882 -> 0.1756   acc: 93.22% -> 92.54%             
client [9] (test)  loss: 0.7820 -> 0.3429   acc: 69.44% -> 89.17%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2689 -> 0.2035   acc: 91.86% -> 93.80%             
client [33] (test)  loss: 0.2638 -> 0.2212   acc: 90.48% -> 95.24%             
client [16] (test)  loss: 0.3966 -> 0.3137   acc: 83.98% -> 87.50%             
client [44] (test)  loss: 0.1157 -> 0.0380   acc: 96.60% -> 98.46%             
client [8] (test)  loss: 0.1970 -> 0.1465   acc: 95.05% -> 96.09%              
client [31] (test)  loss: 0.1526 -> 0.1283   acc: 94.58% -> 94.24%             
client [47] (test)  loss: 0.2417 -> 0.1702   acc: 93.71% -> 94.70%             
client [36] (test)  loss: 0.3631 -> 0.1057   acc: 88.47% -> 96.88%             
client [20] (test)  loss: 0.5575 -> 0.2621   acc: 84.30% -> 90.91%             
client [56] (test)  loss: 0.3122 -> 0.1698   acc: 87.00% -> 94.43%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3304 -> 0.1563   acc: 90.16% -> 94.67%              
client [60] (test)  loss: 0.1049 -> 0.0362   acc: 95.42% -> 99.17%             
client [28] (test)  loss: 0.1093 -> 0.1195   acc: 96.08% -> 95.42%             
client [25] (test)  loss: 1.1668 -> 0.1716   acc: 56.54% -> 96.26%             
client [58] (test)  loss: 0.0934 -> 0.0945   acc: 97.53% -> 97.22%             
client [44] (test)  loss: 0.0684 -> 0.0227   acc: 97.84% -> 98.77%             
client [39] (test)  loss: 0.2044 -> 0.1657   acc: 91.95% -> 93.22%             
client [29] (test)  loss: 0.3792 -> 0.1279   acc: 87.46% -> 96.37%             
client [3] (test)  loss: 0.2375 -> 0.1099   acc: 90.94% -> 97.41%              
client [84] (test)  loss: 0.4176 -> 0.3290   acc: 87.30% -> 87.95%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4092 -> 0.3093   acc: 84.75% -> 89.83%             
client [84] (test)  loss: 0.3236 -> 0.3000   acc: 88.27% -> 89.58%             
client [10] (test)  loss: 0.0497 -> 0.0250   acc: 98.23% -> 99.12%             
client [36] (test)  loss: 0.2146 -> 0.0824   acc: 93.15% -> 97.20%             
client [65] (test)  loss: 0.1542 -> 0.1754   acc: 95.53% -> 95.53%             
client [81] (test)  loss: 0.5106 -> 0.0258   acc: 80.62% -> 99.34%             
client [79] (test)  loss: 0.1706 -> 0.0362   acc: 94.62% -> 99.23%             
client [42] (test)  loss: 0.1308 -> 0.1256   acc: 94.95% -> 96.10%             
client [11] (test)  loss: 0.3935 -> 0.1656   acc: 88.53% -> 93.94%             
client [96] (test)  loss: 0.5022 -> 0.1245   acc: 82.45% -> 96.14%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0944 -> 0.0730   acc: 96.88% -> 97.92%              
client [53] (test)  loss: 0.4575 -> 0.1211   acc: 84.01% -> 94.77%             
client [52] (test)  loss: 0.1437 -> 0.1149   acc: 94.43% -> 96.39%             
client [42] (test)  loss: 0.2555 -> 0.1213   acc: 89.68% -> 96.10%             
client [69] (test)  loss: 0.2589 -> 0.1377   acc: 92.31% -> 96.87%             
client [59] (test)  loss: 0.0821 -> 0.0514   acc: 96.70% -> 98.02%             
client [7] (test)  loss: 0.3934 -> 0.0517   acc: 88.85% -> 97.70%              
client [26] (test)  loss: 0.0201 -> 0.0173   acc: 99.40% -> 99.09%             
client [49] (test)  loss: 0.2985 -> 0.2085   acc: 89.79% -> 93.62%             
client [98] (test)  loss: 0.3288 -> 0.2886   acc: 86.84% -> 90.94%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3191 -> 0.2737   acc: 87.43% -> 91.52%             
client [47] (test)  loss: 0.1782 -> 0.1034   acc: 96.36% -> 97.02%             
client [21] (test)  loss: 0.3439 -> 0.2365   acc: 86.78% -> 92.54%             
client [77] (test)  loss: 0.3414 -> 0.1605   acc: 92.27% -> 95.65%             
client [95] (test)  loss: 0.1469 -> 0.1188   acc: 95.96% -> 96.32%             
client [91] (test)  loss: 0.3212 -> 0.1722   acc: 91.19% -> 94.27%             
client [14] (test)  loss: 0.0923 -> 0.0598   acc: 96.12% -> 97.67%             
client [99] (test)  loss: 0.3163 -> 0.1955   acc: 90.32% -> 95.16%             
client [20] (test)  loss: 0.3519 -> 0.1539   acc: 89.26% -> 94.21%             
client [39] (test)  loss: 0.1882 -> 0.1152   acc: 93.22% -> 94.92%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1478 -> 0.0961   acc: 95.08% -> 97.38%             
client [62] (test)  loss: 0.1147 -> 0.0233   acc: 96.70% -> 99.18%             
client [71] (test)  loss: 0.1311 -> 0.1608   acc: 96.91% -> 95.88%             
client [97] (test)  loss: 0.3424 -> 0.1073   acc: 90.57% -> 96.93%             
client [30] (test)  loss: 0.0866 -> 0.0445   acc: 97.64% -> 99.32%             
client [88] (test)  loss: 0.1837 -> 0.1005   acc: 93.09% -> 96.31%             
client [60] (test)  loss: 0.0419 -> 0.0195   acc: 98.75% -> 99.58%             
client [82] (test)  loss: 0.2141 -> 0.2865   acc: 93.71% -> 91.39%             
client [91] (test)  loss: 0.3644 -> 0.1568   acc: 90.75% -> 95.15%             
client [57] (test)  loss: 0.0602 -> 0.0638   acc: 97.85% -> 97.85%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0888 -> 0.0583   acc: 97.63% -> 97.97%             
client [15] (test)  loss: 0.1276 -> 0.0656   acc: 96.24% -> 98.23%             
client [71] (test)  loss: 0.1177 -> 0.1615   acc: 95.88% -> 95.88%             
client [97] (test)  loss: 0.2685 -> 0.0972   acc: 92.45% -> 97.17%             
client [53] (test)  loss: 0.2875 -> 0.1079   acc: 89.53% -> 96.80%             
client [77] (test)  loss: 0.2411 -> 0.1327   acc: 91.79% -> 96.62%             
client [76] (test)  loss: 0.2535 -> 0.0862   acc: 90.00% -> 97.93%             
client [79] (test)  loss: 0.0721 -> 0.0412   acc: 96.92% -> 98.46%             
client [28] (test)  loss: 0.1117 -> 0.0951   acc: 96.08% -> 96.08%             
client [99] (test)  loss: 0.2003 -> 0.1629   acc: 92.74% -> 95.97%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.1450 -> 0.0890   acc: 95.52% -> 96.93%             
client [86] (test)  loss: 0.1256 -> 0.1239   acc: 97.42% -> 95.36%             
client [34] (test)  loss: 0.1209 -> 0.0431   acc: 95.41% -> 98.69%             
client [73] (test)  loss: 0.0096 -> 0.0063   acc: 99.28% -> 99.76%             
client [5] (test)  loss: 0.1082 -> 0.0818   acc: 96.28% -> 97.77%              
client [96] (test)  loss: 0.3173 -> 0.1163   acc: 89.37% -> 97.10%             
client [22] (test)  loss: 0.0687 -> 0.0321   acc: 97.91% -> 98.74%             
client [60] (test)  loss: 0.0149 -> 0.0113   acc: 99.17% -> 100.00%            
client [66] (test)  loss: 0.2223 -> 0.1176   acc: 93.01% -> 96.77%             
client [83] (test)  loss: 0.0908 -> 0.0248   acc: 96.80% -> 99.26%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.1050 -> 0.0880   acc: 96.21% -> 97.93%             
client [65] (test)  loss: 0.1164 -> 0.1143   acc: 95.93% -> 95.93%             
client [95] (test)  loss: 0.1246 -> 0.1179   acc: 97.06% -> 97.06%             
client [17] (test)  loss: 0.0520 -> 0.0467   acc: 98.14% -> 98.14%             
client [8] (test)  loss: 0.0839 -> 0.0537   acc: 97.14% -> 97.92%              
client [35] (test)  loss: 0.4106 -> 0.1772   acc: 86.47% -> 95.18%             
client [98] (test)  loss: 0.2114 -> 0.2235   acc: 91.23% -> 92.69%             
client [53] (test)  loss: 0.2080 -> 0.1010   acc: 92.44% -> 96.22%             
client [43] (test)  loss: 0.0219 -> 0.0073   acc: 98.99% -> 99.75%             
client [64] (test)  loss: 0.1033 -> 0.1056   acc: 96.12% -> 96.90%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.2061 -> 0.1862   acc: 92.54% -> 94.92%             
client [88] (test)  loss: 0.1211 -> 0.0955   acc: 97.24% -> 97.24%             
client [38] (test)  loss: 0.0292 -> 0.0181   acc: 98.92% -> 99.46%             
client [3] (test)  loss: 0.0292 -> 0.0428   acc: 99.35% -> 99.03%              
client [5] (test)  loss: 0.0719 -> 0.0746   acc: 97.77% -> 98.14%              
client [41] (test)  loss: 0.1379 -> 0.1253   acc: 95.28% -> 94.81%             
client [7] (test)  loss: 0.1160 -> 0.0288   acc: 96.39% -> 99.67%              
client [37] (test)  loss: 0.0941 -> 0.0599   acc: 98.20% -> 98.56%             
client [45] (test)  loss: 0.1490 -> 0.0999   acc: 95.99% -> 96.99%             
client [47] (test)  loss: 0.1941 -> 0.1015   acc: 96.36% -> 98.01%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.1880 -> 0.1731   acc: 95.31% -> 94.14%             
client [11] (test)  loss: 0.1231 -> 0.1114   acc: 95.89% -> 96.54%             
client [37] (test)  loss: 0.0782 -> 0.0599   acc: 98.56% -> 98.92%             
client [41] (test)  loss: 0.1395 -> 0.1261   acc: 95.28% -> 94.58%             
client [95] (test)  loss: 0.1056 -> 0.1055   acc: 97.43% -> 97.06%             
client [53] (test)  loss: 0.1782 -> 0.1055   acc: 94.48% -> 96.22%             
client [22] (test)  loss: 0.0630 -> 0.0330   acc: 98.33% -> 98.74%             
client [25] (test)  loss: 0.1196 -> 0.0998   acc: 95.79% -> 97.20%             
client [69] (test)  loss: 0.1083 -> 0.1209   acc: 96.87% -> 97.15%             
client [46] (test)  loss: 0.1437 -> 0.1361   acc: 96.41% -> 96.41%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.1233 -> 0.0952   acc: 97.68% -> 98.01%             
client [69] (test)  loss: 0.1046 -> 0.1199   acc: 97.15% -> 97.15%             
client [82] (test)  loss: 0.2173 -> 0.2897   acc: 93.71% -> 91.72%             
client [45] (test)  loss: 0.0953 -> 0.0953   acc: 96.99% -> 96.99%             
client [7] (test)  loss: 0.1082 -> 0.0267   acc: 97.05% -> 99.67%              
client [50] (test)  loss: 0.0809 -> 0.1106   acc: 97.53% -> 96.91%             
client [35] (test)  loss: 0.1798 -> 0.1677   acc: 93.58% -> 95.41%             
client [24] (test)  loss: 0.1238 -> 0.1288   acc: 96.43% -> 96.43%             
client [15] (test)  loss: 0.0747 -> 0.0615   acc: 98.67% -> 98.23%             
client [58] (test)  loss: 0.0582 -> 0.0584   acc: 98.15% -> 98.15%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.0913 -> 0.0642   acc: 96.79% -> 97.59%             
client [76] (test)  loss: 0.0880 -> 0.0862   acc: 96.90% -> 97.93%             
client [67] (test)  loss: 0.1600 -> 0.1247   acc: 94.62% -> 95.89%             
client [37] (test)  loss: 0.0769 -> 0.0614   acc: 98.56% -> 98.92%             
client [58] (test)  loss: 0.0580 -> 0.0576   acc: 98.15% -> 98.15%             
client [64] (test)  loss: 0.0874 -> 0.0948   acc: 96.90% -> 96.90%             
client [77] (test)  loss: 0.1533 -> 0.1208   acc: 95.65% -> 97.10%             
client [55] (test)  loss: 0.0213 -> 0.0245   acc: 99.22% -> 99.22%             
client [12] (test)  loss: 0.0999 -> 0.1261   acc: 96.26% -> 95.58%             
client [89] (test)  loss: 0.1190 -> 0.1104   acc: 95.51% -> 96.63%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.2183 -> 0.2247   acc: 93.16% -> 92.51%             
client [51] (test)  loss: 0.0755 -> 0.0809   acc: 97.84% -> 96.91%             
client [8] (test)  loss: 0.0420 -> 0.0390   acc: 97.92% -> 98.96%              
client [18] (test)  loss: 0.1025 -> 0.0928   acc: 96.97% -> 96.36%             
client [94] (test)  loss: 0.0240 -> 0.0175   acc: 98.04% -> 99.02%             
client [81] (test)  loss: 0.0113 -> 0.0142   acc: 100.00% -> 99.78%            
client [3] (test)  loss: 0.0316 -> 0.0434   acc: 99.35% -> 99.03%              
client [11] (test)  loss: 0.1164 -> 0.1089   acc: 95.89% -> 96.97%             
client [95] (test)  loss: 0.1012 -> 0.1031   acc: 97.43% -> 97.43%             
client [67] (test)  loss: 0.1531 -> 0.1238   acc: 94.62% -> 95.57%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.1429 -> 0.1779   acc: 94.24% -> 94.92%             
client [79] (test)  loss: 0.0463 -> 0.0379   acc: 97.69% -> 98.46%             
client [58] (test)  loss: 0.0572 -> 0.0573   acc: 98.15% -> 98.15%             
client [88] (test)  loss: 0.1147 -> 0.0953   acc: 97.24% -> 97.24%             
client [46] (test)  loss: 0.1297 -> 0.1291   acc: 95.81% -> 96.41%             
client [11] (test)  loss: 0.1138 -> 0.1085   acc: 96.10% -> 96.75%             
client [55] (test)  loss: 0.0236 -> 0.0255   acc: 99.22% -> 99.22%             
client [13] (test)  loss: 0.0377 -> 0.0469   acc: 98.49% -> 98.99%             
client [31] (test)  loss: 0.0621 -> 0.0483   acc: 98.31% -> 98.64%             
client [75] (test)  loss: 0.0129 -> 0.0085   acc: 99.30% -> 99.77%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.1116 -> 0.1052   acc: 94.32% -> 95.63%             
client [7] (test)  loss: 0.0664 -> 0.0226   acc: 97.70% -> 99.67%              
client [57] (test)  loss: 0.0416 -> 0.0480   acc: 98.39% -> 98.66%             
client [13] (test)  loss: 0.0351 -> 0.0487   acc: 98.74% -> 98.99%             
client [43] (test)  loss: 0.0061 -> 0.0046   acc: 100.00% -> 100.00%           
client [91] (test)  loss: 0.1641 -> 0.1455   acc: 95.15% -> 95.15%             
client [10] (test)  loss: 0.0267 -> 0.0221   acc: 99.12% -> 99.56%             
client [64] (test)  loss: 0.0833 -> 0.0904   acc: 96.90% -> 97.29%             
client [82] (test)  loss: 0.2435 -> 0.2839   acc: 93.05% -> 91.72%             
client [22] (test)  loss: 0.0456 -> 0.0328   acc: 98.33% -> 98.74%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.0977 -> 0.0525   acc: 96.69% -> 96.69%             
client [23] (test)  loss: 0.1056 -> 0.0823   acc: 95.96% -> 98.48%             
client [88] (test)  loss: 0.1126 -> 0.0940   acc: 97.24% -> 97.24%             
client [98] (test)  loss: 0.1883 -> 0.2144   acc: 92.69% -> 92.69%             
client [79] (test)  loss: 0.0445 -> 0.0361   acc: 97.69% -> 98.46%             
client [21] (test)  loss: 0.1354 -> 0.1805   acc: 94.92% -> 94.58%             
client [92] (test)  loss: 0.1840 -> 0.1999   acc: 94.29% -> 93.14%             
client [56] (test)  loss: 0.0508 -> 0.0474   acc: 98.41% -> 98.94%             
client [5] (test)  loss: 0.0535 -> 0.0636   acc: 98.14% -> 98.88%              
client [52] (test)  loss: 0.1013 -> 0.0985   acc: 97.05% -> 97.05%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1706 -> 0.0000', 'accuracy': '94.08% -> 0.00%'},          
    200: {'loss': '0.0887 -> 0.0000', 'accuracy': '97.36% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 20.0%(20.53%) at epoch: 0                                     
pFedSim achieved 30.0%(32.92%) at epoch: 3                                     
pFedSim achieved 40.0%(42.32%) at epoch: 5                                     
pFedSim achieved 50.0%(54.36%) at epoch: 6                                     
pFedSim achieved 60.0%(62.87%) at epoch: 8                                     
pFedSim achieved 70.0%(75.95%) at epoch: 13                                    
pFedSim achieved 80.0%(83.75%) at epoch: 20                                    
pFedSim achieved 90.0%(90.49%) at epoch: 23                                    
Convergence (test_after):                                                      
pFedSim achieved 40.0%(48.36%) at epoch: 0                                     
pFedSim achieved 50.0%(54.07%) at epoch: 1                                     
pFedSim achieved 70.0%(72.50%) at epoch: 3                                     
pFedSim achieved 80.0%(80.79%) at epoch: 9                                     
pFedSim achieved 90.0%(90.40%) at epoch: 17                                    
