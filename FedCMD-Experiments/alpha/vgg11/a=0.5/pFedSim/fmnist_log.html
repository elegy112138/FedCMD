==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5555 -> 0.4264   acc: 83.63% -> 85.39%             
client [81] (test)  loss: 0.4642 -> 0.2910   acc: 83.58% -> 88.81%             
client [21] (test)  loss: 0.5564 -> 0.4310   acc: 80.91% -> 84.55%             
client [68] (test)  loss: 1.3133 -> 0.5721   acc: 40.23% -> 79.59%             
client [93] (test)  loss: 0.5036 -> 0.6182   acc: 83.72% -> 77.52%             
client [31] (test)  loss: 0.5675 -> 1.2287   acc: 78.49% -> 68.72%             
client [20] (test)  loss: 0.3817 -> 0.1812   acc: 86.54% -> 93.40%             
client [59] (test)  loss: 0.4362 -> 0.2844   acc: 86.46% -> 91.70%             
client [48] (test)  loss: 0.9024 -> 0.6695   acc: 63.93% -> 75.00%             
client [34] (test)  loss: 0.4268 -> 0.3640   acc: 84.22% -> 88.80%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4827 -> 0.6030   acc: 84.82% -> 80.95%             
client [99] (test)  loss: 0.7841 -> 0.2541   acc: 69.63% -> 94.07%             
client [67] (test)  loss: 0.4350 -> 0.3375   acc: 86.12% -> 88.53%             
client [0] (test)  loss: 0.6830 -> 0.7218   acc: 74.73% -> 79.52%              
client [76] (test)  loss: 0.6558 -> 0.7641   acc: 76.60% -> 77.33%             
client [41] (test)  loss: 0.5095 -> 0.1745   acc: 81.94% -> 94.44%             
client [62] (test)  loss: 0.4704 -> 0.2424   acc: 83.28% -> 92.33%             
client [2] (test)  loss: 0.7008 -> 0.4717   acc: 74.45% -> 84.54%              
client [14] (test)  loss: 0.4172 -> 0.4055   acc: 85.83% -> 86.10%             
client [46] (test)  loss: 0.7191 -> 0.3400   acc: 73.07% -> 85.87%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0314 -> 1.0576   acc: 65.96% -> 73.67%             
client [68] (test)  loss: 1.0811 -> 0.6042   acc: 58.00% -> 83.26%             
client [57] (test)  loss: 0.2010 -> 0.0556   acc: 92.78% -> 97.78%             
client [17] (test)  loss: 0.4042 -> 0.3726   acc: 86.63% -> 90.27%             
client [54] (test)  loss: 0.6050 -> 0.6409   acc: 79.89% -> 81.50%             
client [23] (test)  loss: 0.5483 -> 0.3227   acc: 81.25% -> 89.38%             
client [35] (test)  loss: 0.2592 -> 0.1942   acc: 90.96% -> 94.83%             
client [59] (test)  loss: 0.2969 -> 0.2618   acc: 90.83% -> 93.89%             
client [31] (test)  loss: 0.5496 -> 0.5399   acc: 82.68% -> 83.80%             
client [9] (test)  loss: 0.4284 -> 0.1102   acc: 86.61% -> 95.74%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3274 -> 0.1937   acc: 89.43% -> 93.14%             
client [33] (test)  loss: 0.6807 -> 0.1295   acc: 79.04% -> 96.46%             
client [16] (test)  loss: 0.3348 -> 0.2126   acc: 92.49% -> 95.20%             
client [44] (test)  loss: 0.4620 -> 0.2211   acc: 85.82% -> 95.36%             
client [8] (test)  loss: 0.3682 -> 0.4017   acc: 89.96% -> 90.83%              
client [31] (test)  loss: 0.5567 -> 0.5586   acc: 81.84% -> 85.20%             
client [47] (test)  loss: 0.4909 -> 0.3748   acc: 83.74% -> 90.11%             
client [36] (test)  loss: 0.2065 -> 0.1842   acc: 94.04% -> 94.62%             
client [20] (test)  loss: 0.3615 -> 0.1757   acc: 89.97% -> 93.93%             
client [56] (test)  loss: 0.3896 -> 0.5725   acc: 84.73% -> 87.19%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6663 -> 0.5526   acc: 76.95% -> 82.81%              
client [60] (test)  loss: 0.4253 -> 0.2599   acc: 86.67% -> 93.64%             
client [28] (test)  loss: 0.6105 -> 0.1583   acc: 82.82% -> 94.93%             
client [25] (test)  loss: 0.4436 -> 0.3065   acc: 87.79% -> 91.21%             
client [58] (test)  loss: 0.9324 -> 0.6601   acc: 73.90% -> 79.12%             
client [44] (test)  loss: 0.3712 -> 0.2044   acc: 90.46% -> 95.10%             
client [39] (test)  loss: 0.2823 -> 0.3152   acc: 91.19% -> 90.58%             
client [29] (test)  loss: 0.5030 -> 0.5460   acc: 85.30% -> 87.40%             
client [3] (test)  loss: 0.2590 -> 0.2308   acc: 91.37% -> 92.64%              
client [84] (test)  loss: 0.5544 -> 0.3873   acc: 85.17% -> 92.40%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6217 -> 0.4402   acc: 82.12% -> 88.18%             
client [84] (test)  loss: 0.6526 -> 0.3976   acc: 82.70% -> 91.25%             
client [10] (test)  loss: 0.2754 -> 0.2614   acc: 92.09% -> 92.72%             
client [36] (test)  loss: 0.2322 -> 0.1354   acc: 92.88% -> 96.73%             
client [65] (test)  loss: 0.5919 -> 0.4503   acc: 86.04% -> 88.31%             
client [81] (test)  loss: 0.2704 -> 0.2292   acc: 94.03% -> 92.54%             
client [79] (test)  loss: 1.1787 -> 0.5571   acc: 67.15% -> 83.86%             
client [42] (test)  loss: 0.6191 -> 0.3218   acc: 80.68% -> 91.79%             
client [11] (test)  loss: 0.2646 -> 0.0881   acc: 92.55% -> 97.52%             
client [96] (test)  loss: 0.8145 -> 0.6253   acc: 79.89% -> 84.13%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3719 -> 0.3691   acc: 89.52% -> 92.58%              
client [53] (test)  loss: 0.5741 -> 0.4634   acc: 82.72% -> 84.72%             
client [52] (test)  loss: 0.3622 -> 0.2770   acc: 90.06% -> 90.94%             
client [42] (test)  loss: 0.4459 -> 0.3305   acc: 85.51% -> 91.79%             
client [69] (test)  loss: 0.4227 -> 0.4108   acc: 88.10% -> 88.99%             
client [59] (test)  loss: 0.2966 -> 0.2752   acc: 89.08% -> 93.89%             
client [7] (test)  loss: 0.3716 -> 0.3565   acc: 87.83% -> 91.96%              
client [26] (test)  loss: 0.1992 -> 0.0937   acc: 94.54% -> 97.27%             
client [49] (test)  loss: 0.4937 -> 0.4382   acc: 84.10% -> 86.24%             
client [98] (test)  loss: 0.2534 -> 0.1524   acc: 91.84% -> 96.32%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2884 -> 0.1490   acc: 90.00% -> 96.58%             
client [47] (test)  loss: 0.7392 -> 0.3339   acc: 77.14% -> 92.31%             
client [21] (test)  loss: 0.4336 -> 0.4978   acc: 87.88% -> 87.27%             
client [77] (test)  loss: 0.3467 -> 0.3065   acc: 90.93% -> 92.19%             
client [95] (test)  loss: 0.5365 -> 0.3700   acc: 84.50% -> 91.86%             
client [91] (test)  loss: 0.1846 -> 0.1552   acc: 93.64% -> 95.42%             
client [14] (test)  loss: 0.5594 -> 0.3393   acc: 83.65% -> 89.92%             
client [99] (test)  loss: 0.2963 -> 0.2246   acc: 91.85% -> 95.93%             
client [20] (test)  loss: 0.3032 -> 0.1791   acc: 91.82% -> 95.51%             
client [39] (test)  loss: 0.3302 -> 0.3810   acc: 89.06% -> 90.27%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3284 -> 0.2910   acc: 91.52% -> 92.98%             
client [62] (test)  loss: 0.3020 -> 0.1716   acc: 92.33% -> 95.47%             
client [71] (test)  loss: 0.4062 -> 0.2975   acc: 88.89% -> 88.89%             
client [97] (test)  loss: 0.5483 -> 0.4972   acc: 84.82% -> 88.72%             
client [30] (test)  loss: 0.6516 -> 0.4940   acc: 81.78% -> 86.92%             
client [88] (test)  loss: 0.3628 -> 0.2909   acc: 89.21% -> 93.65%             
client [60] (test)  loss: 0.4562 -> 0.2746   acc: 84.85% -> 94.24%             
client [82] (test)  loss: 0.8789 -> 0.8898   acc: 79.01% -> 81.22%             
client [91] (test)  loss: 0.1628 -> 0.1554   acc: 95.17% -> 95.17%             
client [57] (test)  loss: 0.2065 -> 0.1171   acc: 93.33% -> 96.39%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4074 -> 0.4707   acc: 89.66% -> 87.71%             
client [15] (test)  loss: 0.5418 -> 0.4525   acc: 85.96% -> 90.18%             
client [71] (test)  loss: 0.5952 -> 0.2757   acc: 80.25% -> 92.59%             
client [97] (test)  loss: 0.6791 -> 0.5507   acc: 83.27% -> 88.33%             
client [53] (test)  loss: 0.7043 -> 0.4763   acc: 78.07% -> 86.38%             
client [77] (test)  loss: 0.6349 -> 0.3305   acc: 80.60% -> 93.95%             
client [76] (test)  loss: 0.9609 -> 0.3721   acc: 75.69% -> 88.85%             
client [79] (test)  loss: 0.9087 -> 0.5066   acc: 73.20% -> 85.59%             
client [28] (test)  loss: 0.5549 -> 0.1773   acc: 85.92% -> 95.49%             
client [99] (test)  loss: 0.1729 -> 0.1877   acc: 95.93% -> 94.81%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.6077 -> 0.5078   acc: 86.77% -> 89.88%             
client [86] (test)  loss: 0.3918 -> 0.4300   acc: 91.43% -> 90.86%             
client [34] (test)  loss: 0.2641 -> 0.2763   acc: 92.11% -> 93.38%             
client [73] (test)  loss: 0.3512 -> 0.3683   acc: 91.76% -> 91.94%             
client [5] (test)  loss: 0.2770 -> 0.2490   acc: 94.70% -> 96.77%              
client [96] (test)  loss: 0.4917 -> 0.6075   acc: 85.45% -> 87.04%             
client [22] (test)  loss: 0.7076 -> 0.5848   acc: 80.87% -> 88.59%             
client [60] (test)  loss: 0.2490 -> 0.2772   acc: 92.73% -> 93.64%             
client [66] (test)  loss: 0.4165 -> 0.2793   acc: 90.84% -> 95.22%             
client [83] (test)  loss: 0.3808 -> 0.3427   acc: 91.20% -> 92.13%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.4937 -> 0.4646   acc: 86.84% -> 88.48%             
client [65] (test)  loss: 0.4614 -> 0.4864   acc: 87.34% -> 85.71%             
client [95] (test)  loss: 0.4325 -> 0.3054   acc: 87.60% -> 92.25%             
client [17] (test)  loss: 0.2981 -> 0.3157   acc: 89.36% -> 92.10%             
client [8] (test)  loss: 0.3024 -> 0.2617   acc: 90.39% -> 93.89%              
client [35] (test)  loss: 0.1755 -> 0.1657   acc: 94.57% -> 96.12%             
client [98] (test)  loss: 0.1678 -> 0.1644   acc: 94.74% -> 95.26%             
client [53] (test)  loss: 0.5000 -> 0.4683   acc: 85.71% -> 86.71%             
client [43] (test)  loss: 0.3220 -> 0.2027   acc: 88.69% -> 92.96%             
client [64] (test)  loss: 0.2015 -> 0.2282   acc: 93.43% -> 94.00%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.4701 -> 0.5033   acc: 88.79% -> 88.18%             
client [88] (test)  loss: 0.2456 -> 0.3365   acc: 92.38% -> 92.38%             
client [38] (test)  loss: 0.4423 -> 0.4135   acc: 86.19% -> 89.23%             
client [3] (test)  loss: 0.1973 -> 0.2322   acc: 93.15% -> 94.16%              
client [5] (test)  loss: 0.2874 -> 0.2435   acc: 94.70% -> 97.00%              
client [41] (test)  loss: 0.2207 -> 0.1623   acc: 92.78% -> 94.44%             
client [7] (test)  loss: 0.3034 -> 0.4140   acc: 90.00% -> 92.17%              
client [37] (test)  loss: 0.2361 -> 0.2319   acc: 94.01% -> 94.79%             
client [45] (test)  loss: 0.4330 -> 0.2678   acc: 88.03% -> 94.68%             
client [47] (test)  loss: 0.6566 -> 0.2878   acc: 80.22% -> 93.63%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.2065 -> 0.1897   acc: 95.20% -> 96.10%             
client [11] (test)  loss: 0.0933 -> 0.1065   acc: 97.29% -> 97.07%             
client [37] (test)  loss: 0.1992 -> 0.1989   acc: 94.53% -> 94.53%             
client [41] (test)  loss: 0.2075 -> 0.1538   acc: 92.78% -> 95.28%             
client [95] (test)  loss: 0.3749 -> 0.2970   acc: 89.92% -> 93.80%             
client [53] (test)  loss: 0.4436 -> 0.4228   acc: 86.38% -> 84.72%             
client [22] (test)  loss: 0.6725 -> 0.5750   acc: 83.56% -> 88.26%             
client [25] (test)  loss: 0.3397 -> 0.2984   acc: 92.51% -> 94.14%             
client [69] (test)  loss: 0.3539 -> 0.4076   acc: 90.18% -> 91.07%             
client [46] (test)  loss: 0.3485 -> 0.3075   acc: 90.13% -> 92.53%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2125 -> 0.3297   acc: 92.53% -> 91.65%             
client [69] (test)  loss: 0.3441 -> 0.4265   acc: 90.48% -> 89.88%             
client [82] (test)  loss: 0.6619 -> 0.8389   acc: 83.15% -> 82.60%             
client [45] (test)  loss: 0.2879 -> 0.3015   acc: 93.62% -> 93.88%             
client [7] (test)  loss: 0.2773 -> 0.3232   acc: 90.43% -> 93.48%              
client [50] (test)  loss: 0.2499 -> 0.2394   acc: 94.68% -> 93.84%             
client [35] (test)  loss: 0.1596 -> 0.1932   acc: 95.61% -> 95.61%             
client [24] (test)  loss: 0.7537 -> 0.7491   acc: 80.05% -> 82.18%             
client [15] (test)  loss: 0.3775 -> 0.4761   acc: 91.58% -> 91.58%             
client [58] (test)  loss: 0.7152 -> 0.9557   acc: 79.67% -> 81.04%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.4034 -> 0.4420   acc: 86.07% -> 87.14%             
client [76] (test)  loss: 0.4394 -> 0.4525   acc: 88.30% -> 88.12%             
client [67] (test)  loss: 0.3781 -> 0.3698   acc: 90.54% -> 90.95%             
client [37] (test)  loss: 0.1973 -> 0.2146   acc: 94.27% -> 95.05%             
client [58] (test)  loss: 0.7224 -> 1.0256   acc: 79.67% -> 79.40%             
client [64] (test)  loss: 0.1999 -> 0.2268   acc: 94.00% -> 93.71%             
client [77] (test)  loss: 0.3123 -> 0.3693   acc: 91.44% -> 93.70%             
client [55] (test)  loss: 0.3241 -> 0.2279   acc: 90.65% -> 95.33%             
client [12] (test)  loss: 0.2620 -> 0.3553   acc: 93.50% -> 91.87%             
client [89] (test)  loss: 0.2740 -> 0.2840   acc: 92.79% -> 93.10%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.3220 -> 0.3719   acc: 92.40% -> 92.59%             
client [51] (test)  loss: 0.1914 -> 0.1085   acc: 93.53% -> 97.57%             
client [8] (test)  loss: 0.2808 -> 0.3120   acc: 92.58% -> 94.32%              
client [18] (test)  loss: 0.3287 -> 0.2741   acc: 91.10% -> 93.15%             
client [94] (test)  loss: 0.2426 -> 0.2067   acc: 94.43% -> 95.44%             
client [81] (test)  loss: 0.2403 -> 0.2241   acc: 94.03% -> 94.78%             
client [3] (test)  loss: 0.1973 -> 0.2218   acc: 94.16% -> 94.67%              
client [11] (test)  loss: 0.0720 -> 0.0841   acc: 97.97% -> 97.74%             
client [95] (test)  loss: 0.3369 -> 0.3027   acc: 91.86% -> 93.41%             
client [67] (test)  loss: 0.3631 -> 0.3860   acc: 91.15% -> 91.35%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.4836 -> 0.5303   acc: 88.79% -> 88.18%             
client [79] (test)  loss: 0.5199 -> 0.4926   acc: 83.29% -> 84.15%             
client [58] (test)  loss: 0.7280 -> 0.9330   acc: 79.67% -> 81.04%             
client [88] (test)  loss: 0.2452 -> 0.3140   acc: 94.29% -> 92.70%             
client [46] (test)  loss: 0.2947 -> 0.3166   acc: 91.73% -> 91.73%             
client [11] (test)  loss: 0.0734 -> 0.0817   acc: 97.97% -> 97.74%             
client [55] (test)  loss: 0.2851 -> 0.1914   acc: 91.12% -> 95.09%             
client [13] (test)  loss: 0.3205 -> 0.3283   acc: 89.18% -> 90.72%             
client [31] (test)  loss: 0.3677 -> 0.4697   acc: 90.50% -> 87.43%             
client [75] (test)  loss: 0.0997 -> 0.0869   acc: 97.28% -> 98.10%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.1799 -> 0.3119   acc: 98.59% -> 98.12%             
client [7] (test)  loss: 0.2375 -> 0.3664   acc: 93.26% -> 92.39%              
client [57] (test)  loss: 0.1109 -> 0.0937   acc: 96.39% -> 97.78%             
client [13] (test)  loss: 0.3074 -> 0.3766   acc: 89.43% -> 91.24%             
client [43] (test)  loss: 0.2075 -> 0.2883   acc: 93.97% -> 91.71%             
client [91] (test)  loss: 0.1307 -> 0.1343   acc: 96.18% -> 96.44%             
client [10] (test)  loss: 0.2558 -> 0.2981   acc: 93.67% -> 93.35%             
client [64] (test)  loss: 0.1824 -> 0.2465   acc: 94.29% -> 93.14%             
client [82] (test)  loss: 0.5350 -> 0.7523   acc: 84.53% -> 83.15%             
client [22] (test)  loss: 0.5603 -> 0.5721   acc: 86.58% -> 87.58%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.1594 -> 0.1731   acc: 95.78% -> 95.25%             
client [23] (test)  loss: 0.3456 -> 0.3764   acc: 88.75% -> 89.38%             
client [88] (test)  loss: 0.2399 -> 0.2840   acc: 94.60% -> 93.02%             
client [98] (test)  loss: 0.1384 -> 0.1431   acc: 94.74% -> 95.26%             
client [79] (test)  loss: 0.4789 -> 0.5200   acc: 84.15% -> 84.73%             
client [21] (test)  loss: 0.4763 -> 0.4878   acc: 90.30% -> 89.39%             
client [92] (test)  loss: 0.1263 -> 0.1260   acc: 97.97% -> 97.72%             
client [56] (test)  loss: 0.3610 -> 0.5023   acc: 90.89% -> 87.93%             
client [5] (test)  loss: 0.2641 -> 0.2752   acc: 95.85% -> 96.31%              
client [52] (test)  loss: 0.2677 -> 0.3057   acc: 92.69% -> 93.57%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.5222 -> 0.0000', 'accuracy': '85.20% -> 0.00%'},          
    200: {'loss': '0.3358 -> 0.0000', 'accuracy': '92.23% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 30.0%(32.04%) at epoch: 1                                     
pFedSim achieved 50.0%(51.50%) at epoch: 2                                     
pFedSim achieved 60.0%(62.34%) at epoch: 4                                     
pFedSim achieved 70.0%(72.61%) at epoch: 7                                     
pFedSim achieved 80.0%(84.96%) at epoch: 10                                    
pFedSim achieved 90.0%(90.54%) at epoch: 67                                    
Convergence (test_after):                                                      
pFedSim achieved 60.0%(62.83%) at epoch: 0                                     
pFedSim achieved 70.0%(74.87%) at epoch: 1                                     
pFedSim achieved 80.0%(80.59%) at epoch: 3                                     
pFedSim achieved 90.0%(90.73%) at epoch: 18                                    
