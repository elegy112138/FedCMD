==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7486 -> 0.5493   acc: 77.61% -> 81.48%             
client [81] (test)  loss: 0.4749 -> 0.3505   acc: 84.96% -> 86.92%             
client [21] (test)  loss: 0.2744 -> 0.1405   acc: 93.10% -> 95.42%             
client [68] (test)  loss: 0.2603 -> 0.0701   acc: 92.02% -> 98.02%             
client [93] (test)  loss: 0.5287 -> 0.2944   acc: 83.51% -> 92.75%             
client [31] (test)  loss: 0.6126 -> 0.4708   acc: 80.80% -> 84.04%             
client [20] (test)  loss: 0.7428 -> 0.5473   acc: 76.66% -> 84.44%             
client [59] (test)  loss: 0.6398 -> 0.4345   acc: 77.89% -> 83.42%             
client [48] (test)  loss: 0.6245 -> 0.4379   acc: 76.70% -> 84.26%             
client [34] (test)  loss: 0.5630 -> 0.4364   acc: 85.55% -> 87.61%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3555 -> 0.1930   acc: 86.30% -> 95.58%             
client [99] (test)  loss: 0.8879 -> 0.3378   acc: 73.59% -> 90.03%             
client [67] (test)  loss: 0.6384 -> 0.3857   acc: 80.58% -> 87.60%             
client [0] (test)  loss: 0.3742 -> 0.1707   acc: 88.79% -> 95.16%              
client [76] (test)  loss: 0.9969 -> 0.4148   acc: 77.05% -> 86.60%             
client [41] (test)  loss: 1.9487 -> 0.5934   acc: 49.73% -> 81.07%             
client [62] (test)  loss: 1.3142 -> 0.5351   acc: 69.87% -> 82.53%             
client [2] (test)  loss: 0.2409 -> 0.1924   acc: 92.75% -> 92.96%              
client [14] (test)  loss: 0.5119 -> 0.2993   acc: 84.05% -> 92.44%             
client [46] (test)  loss: 0.6252 -> 0.4001   acc: 82.48% -> 87.88%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3506 -> 0.1786   acc: 89.37% -> 95.85%             
client [68] (test)  loss: 0.1951 -> 0.0471   acc: 93.78% -> 98.90%             
client [57] (test)  loss: 0.2427 -> 0.1975   acc: 93.38% -> 94.19%             
client [17] (test)  loss: 0.2945 -> 0.1230   acc: 90.97% -> 96.29%             
client [54] (test)  loss: 0.5557 -> 0.4066   acc: 84.47% -> 88.31%             
client [23] (test)  loss: 0.5546 -> 0.3632   acc: 80.93% -> 87.08%             
client [35] (test)  loss: 1.8674 -> 0.5020   acc: 58.44% -> 84.38%             
client [59] (test)  loss: 0.6411 -> 0.3851   acc: 79.37% -> 85.19%             
client [31] (test)  loss: 0.5042 -> 0.3967   acc: 84.16% -> 86.98%             
client [9] (test)  loss: 2.1321 -> 0.7292   acc: 56.23% -> 77.40%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8117 -> 0.4750   acc: 76.53% -> 82.39%             
client [33] (test)  loss: 0.7393 -> 0.5029   acc: 77.73% -> 83.29%             
client [16] (test)  loss: 0.4478 -> 0.2999   acc: 87.20% -> 92.40%             
client [44] (test)  loss: 1.0821 -> 0.6326   acc: 71.00% -> 78.09%             
client [8] (test)  loss: 0.7381 -> 0.4677   acc: 81.04% -> 86.72%              
client [31] (test)  loss: 0.5305 -> 0.3824   acc: 85.05% -> 87.45%             
client [47] (test)  loss: 0.4689 -> 0.2971   acc: 84.34% -> 90.28%             
client [36] (test)  loss: 0.5985 -> 0.4256   acc: 83.08% -> 86.56%             
client [20] (test)  loss: 0.7548 -> 0.4421   acc: 79.51% -> 87.26%             
client [56] (test)  loss: 1.0400 -> 0.4137   acc: 69.18% -> 87.11%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2767 -> 0.2566   acc: 92.91% -> 93.44%              
client [60] (test)  loss: 0.5012 -> 0.2432   acc: 81.32% -> 93.37%             
client [28] (test)  loss: 0.6033 -> 0.4053   acc: 84.46% -> 87.40%             
client [25] (test)  loss: 0.2604 -> 0.0210   acc: 91.65% -> 99.54%             
client [58] (test)  loss: 0.2109 -> 0.1165   acc: 93.25% -> 96.90%             
client [44] (test)  loss: 0.8671 -> 0.6444   acc: 73.38% -> 78.31%             
client [39] (test)  loss: 0.3945 -> 0.3275   acc: 88.16% -> 91.09%             
client [29] (test)  loss: 1.0553 -> 0.5157   acc: 70.29% -> 81.92%             
client [3] (test)  loss: 0.4362 -> 0.2295   acc: 86.40% -> 93.78%              
client [84] (test)  loss: 0.4115 -> 0.2214   acc: 86.45% -> 94.15%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2931 -> 0.0966   acc: 92.05% -> 96.99%             
client [84] (test)  loss: 0.5030 -> 0.2327   acc: 81.09% -> 94.29%             
client [10] (test)  loss: 0.6378 -> 0.4035   acc: 81.94% -> 88.33%             
client [36] (test)  loss: 0.4943 -> 0.3816   acc: 83.30% -> 87.96%             
client [65] (test)  loss: 1.0493 -> 0.5121   acc: 62.37% -> 82.71%             
client [81] (test)  loss: 0.4307 -> 0.2948   acc: 84.60% -> 89.28%             
client [79] (test)  loss: 0.5676 -> 0.3248   acc: 84.27% -> 91.15%             
client [42] (test)  loss: 0.2676 -> 0.1744   acc: 90.80% -> 95.38%             
client [11] (test)  loss: 0.5725 -> 0.3513   acc: 84.27% -> 88.91%             
client [96] (test)  loss: 0.6255 -> 0.3428   acc: 79.75% -> 89.55%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8912 -> 0.4575   acc: 77.75% -> 86.69%              
client [53] (test)  loss: 0.9495 -> 0.4798   acc: 76.38% -> 85.31%             
client [52] (test)  loss: 0.9090 -> 0.4453   acc: 77.28% -> 86.78%             
client [42] (test)  loss: 0.2919 -> 0.1718   acc: 89.71% -> 95.65%             
client [69] (test)  loss: 0.2047 -> 0.1678   acc: 94.32% -> 96.35%             
client [59] (test)  loss: 0.7748 -> 0.3695   acc: 80.59% -> 86.01%             
client [7] (test)  loss: 0.5304 -> 0.3113   acc: 83.19% -> 89.55%              
client [26] (test)  loss: 0.2628 -> 0.1700   acc: 90.40% -> 93.37%             
client [49] (test)  loss: 0.1872 -> 0.1265   acc: 95.16% -> 96.78%             
client [98] (test)  loss: 0.1754 -> 0.0974   acc: 94.43% -> 97.02%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1626 -> 0.0921   acc: 95.69% -> 97.14%             
client [47] (test)  loss: 0.5066 -> 0.2876   acc: 82.39% -> 90.50%             
client [21] (test)  loss: 0.1951 -> 0.0980   acc: 94.49% -> 96.79%             
client [77] (test)  loss: 0.6633 -> 0.4829   acc: 82.72% -> 84.43%             
client [95] (test)  loss: 0.2228 -> 0.0667   acc: 92.99% -> 98.77%             
client [91] (test)  loss: 0.7453 -> 0.4071   acc: 78.26% -> 86.93%             
client [14] (test)  loss: 0.3275 -> 0.2712   acc: 90.73% -> 93.45%             
client [99] (test)  loss: 0.7740 -> 0.3265   acc: 79.90% -> 91.41%             
client [20] (test)  loss: 0.7635 -> 0.4244   acc: 79.46% -> 88.29%             
client [39] (test)  loss: 0.4015 -> 0.3017   acc: 88.33% -> 92.14%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6739 -> 0.4505   acc: 78.40% -> 86.83%             
client [62] (test)  loss: 0.8924 -> 0.5292   acc: 75.98% -> 84.79%             
client [71] (test)  loss: 0.7683 -> 0.5269   acc: 71.49% -> 83.78%             
client [97] (test)  loss: 0.3349 -> 0.1281   acc: 86.92% -> 96.19%             
client [30] (test)  loss: 0.2815 -> 0.2428   acc: 91.15% -> 93.40%             
client [88] (test)  loss: 0.4565 -> 0.2843   acc: 84.85% -> 89.07%             
client [60] (test)  loss: 0.5027 -> 0.2539   acc: 81.37% -> 93.51%             
client [82] (test)  loss: 0.7251 -> 0.3971   acc: 80.58% -> 87.77%             
client [91] (test)  loss: 0.5464 -> 0.4334   acc: 81.65% -> 86.64%             
client [57] (test)  loss: 0.3385 -> 0.1745   acc: 88.70% -> 95.12%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5632 -> 0.4069   acc: 84.14% -> 88.50%             
client [15] (test)  loss: 0.8568 -> 0.4808   acc: 76.75% -> 86.48%             
client [71] (test)  loss: 0.9110 -> 0.5159   acc: 73.76% -> 83.51%             
client [97] (test)  loss: 0.2364 -> 0.1260   acc: 92.61% -> 96.62%             
client [53] (test)  loss: 0.8784 -> 0.4947   acc: 76.94% -> 85.36%             
client [77] (test)  loss: 0.7231 -> 0.5113   acc: 81.22% -> 84.74%             
client [76] (test)  loss: 0.9386 -> 0.3980   acc: 72.36% -> 88.68%             
client [79] (test)  loss: 0.6288 -> 0.3177   acc: 84.81% -> 91.12%             
client [28] (test)  loss: 0.7091 -> 0.4161   acc: 82.18% -> 87.49%             
client [99] (test)  loss: 0.6205 -> 0.3241   acc: 84.98% -> 91.92%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.1703 -> 0.1315   acc: 94.35% -> 96.50%             
client [86] (test)  loss: 0.2676 -> 0.2421   acc: 92.75% -> 94.26%             
client [34] (test)  loss: 0.3642 -> 0.3803   acc: 90.40% -> 90.30%             
client [73] (test)  loss: 0.5968 -> 0.5906   acc: 81.56% -> 83.25%             
client [5] (test)  loss: 0.5090 -> 0.4354   acc: 84.84% -> 89.04%              
client [96] (test)  loss: 0.6745 -> 0.3742   acc: 78.82% -> 89.17%             
client [22] (test)  loss: 0.6716 -> 0.6535   acc: 79.96% -> 82.38%             
client [60] (test)  loss: 0.2863 -> 0.2781   acc: 91.82% -> 93.37%             
client [66] (test)  loss: 0.3662 -> 0.3755   acc: 89.84% -> 89.10%             
client [83] (test)  loss: 0.3273 -> 0.1294   acc: 90.94% -> 96.48%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.4046 -> 0.4349   acc: 88.08% -> 88.68%             
client [65] (test)  loss: 0.7552 -> 0.4991   acc: 79.18% -> 84.41%             
client [95] (test)  loss: 0.0957 -> 0.0629   acc: 97.99% -> 98.81%             
client [17] (test)  loss: 0.4043 -> 0.1006   acc: 86.13% -> 97.18%             
client [8] (test)  loss: 0.6739 -> 0.4780   acc: 82.25% -> 86.81%              
client [35] (test)  loss: 0.7073 -> 0.5980   acc: 78.10% -> 85.00%             
client [98] (test)  loss: 0.1169 -> 0.0996   acc: 96.87% -> 97.07%             
client [53] (test)  loss: 0.6866 -> 0.5340   acc: 80.89% -> 85.40%             
client [43] (test)  loss: 0.4008 -> 0.2304   acc: 88.43% -> 94.33%             
client [64] (test)  loss: 0.4992 -> 0.4849   acc: 84.33% -> 83.42%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.1477 -> 0.1046   acc: 95.72% -> 96.89%             
client [88] (test)  loss: 0.2927 -> 0.3271   acc: 89.96% -> 89.00%             
client [38] (test)  loss: 0.0993 -> 0.0897   acc: 97.86% -> 98.42%             
client [3] (test)  loss: 0.2353 -> 0.2348   acc: 94.02% -> 94.63%              
client [5] (test)  loss: 0.4408 -> 0.4511   acc: 88.51% -> 88.76%              
client [41] (test)  loss: 0.6128 -> 0.6142   acc: 80.77% -> 82.17%             
client [7] (test)  loss: 0.2983 -> 0.3383   acc: 91.00% -> 89.07%              
client [37] (test)  loss: 0.3823 -> 0.4246   acc: 89.25% -> 89.20%             
client [45] (test)  loss: 0.7944 -> 0.5190   acc: 79.15% -> 84.09%             
client [47] (test)  loss: 0.5776 -> 0.2973   acc: 78.13% -> 90.50%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.3039 -> 0.3176   acc: 92.33% -> 92.71%             
client [11] (test)  loss: 0.3123 -> 0.3544   acc: 91.75% -> 89.91%             
client [37] (test)  loss: 0.3858 -> 0.4248   acc: 89.37% -> 89.37%             
client [41] (test)  loss: 0.6188 -> 0.6329   acc: 80.98% -> 82.17%             
client [95] (test)  loss: 0.0719 -> 0.0664   acc: 98.50% -> 98.74%             
client [53] (test)  loss: 0.6170 -> 0.5505   acc: 83.11% -> 85.28%             
client [22] (test)  loss: 0.6202 -> 0.6718   acc: 82.16% -> 82.55%             
client [25] (test)  loss: 0.0470 -> 0.0221   acc: 98.99% -> 99.54%             
client [69] (test)  loss: 0.1470 -> 0.1751   acc: 96.95% -> 96.20%             
client [46] (test)  loss: 0.3607 -> 0.3756   acc: 89.99% -> 89.54%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2898 -> 0.3149   acc: 90.01% -> 90.86%             
client [69] (test)  loss: 0.1483 -> 0.1771   acc: 96.86% -> 96.11%             
client [82] (test)  loss: 0.4412 -> 0.4370   acc: 87.75% -> 87.43%             
client [45] (test)  loss: 0.5392 -> 0.5481   acc: 84.06% -> 84.91%             
client [7] (test)  loss: 0.2921 -> 0.3404   acc: 91.46% -> 89.21%              
client [50] (test)  loss: 0.3650 -> 0.3745   acc: 89.94% -> 89.91%             
client [35] (test)  loss: 0.5924 -> 0.6123   acc: 83.78% -> 84.43%             
client [24] (test)  loss: 0.1794 -> 0.1880   acc: 96.02% -> 96.95%             
client [15] (test)  loss: 0.4910 -> 0.5437   acc: 85.71% -> 85.91%             
client [58] (test)  loss: 0.1251 -> 0.1482   acc: 96.81% -> 96.78%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.3408 -> 0.3989   acc: 87.88% -> 86.94%             
client [76] (test)  loss: 0.3875 -> 0.4645   acc: 88.78% -> 88.37%             
client [67] (test)  loss: 0.3557 -> 0.3830   acc: 89.59% -> 90.34%             
client [37] (test)  loss: 0.3871 -> 0.4284   acc: 89.59% -> 89.27%             
client [58] (test)  loss: 0.1257 -> 0.1482   acc: 96.81% -> 96.71%             
client [64] (test)  loss: 0.4595 -> 0.5008   acc: 86.12% -> 83.72%             
client [77] (test)  loss: 0.4832 -> 0.5421   acc: 86.02% -> 84.62%             
client [55] (test)  loss: 0.4341 -> 0.4863   acc: 86.52% -> 86.10%             
client [12] (test)  loss: 0.4700 -> 0.5465   acc: 86.78% -> 86.51%             
client [89] (test)  loss: 0.5230 -> 0.6827   acc: 85.61% -> 84.85%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.2214 -> 0.2689   acc: 94.71% -> 94.41%             
client [51] (test)  loss: 0.2257 -> 0.2740   acc: 94.21% -> 94.06%             
client [8] (test)  loss: 0.4796 -> 0.5420   acc: 88.64% -> 87.12%              
client [18] (test)  loss: 0.5342 -> 0.4859   acc: 83.76% -> 84.67%             
client [94] (test)  loss: 0.4646 -> 0.4908   acc: 88.25% -> 88.38%             
client [81] (test)  loss: 0.2890 -> 0.3172   acc: 90.51% -> 89.45%             
client [3] (test)  loss: 0.2283 -> 0.2497   acc: 94.48% -> 94.63%              
client [11] (test)  loss: 0.3038 -> 0.3451   acc: 92.29% -> 91.12%             
client [95] (test)  loss: 0.0653 -> 0.0674   acc: 98.72% -> 98.89%             
client [67] (test)  loss: 0.3542 -> 0.3831   acc: 89.90% -> 90.29%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.1106 -> 0.1063   acc: 96.70% -> 96.84%             
client [79] (test)  loss: 0.3111 -> 0.3527   acc: 92.34% -> 91.60%             
client [58] (test)  loss: 0.1301 -> 0.1528   acc: 96.81% -> 96.66%             
client [88] (test)  loss: 0.3119 -> 0.3443   acc: 89.72% -> 89.00%             
client [46] (test)  loss: 0.3333 -> 0.3871   acc: 90.79% -> 89.49%             
client [11] (test)  loss: 0.3071 -> 0.3496   acc: 92.22% -> 90.94%             
client [55] (test)  loss: 0.4372 -> 0.5042   acc: 86.98% -> 85.56%             
client [13] (test)  loss: 0.5150 -> 0.5939   acc: 84.32% -> 82.98%             
client [31] (test)  loss: 0.3837 -> 0.4391   acc: 89.04% -> 88.50%             
client [75] (test)  loss: 0.4705 -> 0.5502   acc: 86.38% -> 85.58%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.1690 -> 0.1857   acc: 96.46% -> 96.41%             
client [7] (test)  loss: 0.3083 -> 0.3736   acc: 91.03% -> 89.43%              
client [57] (test)  loss: 0.1584 -> 0.1857   acc: 95.64% -> 95.22%             
client [13] (test)  loss: 0.5204 -> 0.5982   acc: 84.09% -> 83.22%             
client [43] (test)  loss: 0.2338 -> 0.2604   acc: 94.73% -> 94.33%             
client [91] (test)  loss: 0.4221 -> 0.4760   acc: 88.15% -> 86.52%             
client [10] (test)  loss: 0.4229 -> 0.5022   acc: 89.20% -> 87.71%             
client [64] (test)  loss: 0.4783 -> 0.5164   acc: 85.43% -> 83.13%             
client [82] (test)  loss: 0.4469 -> 0.4662   acc: 88.05% -> 86.97%             
client [22] (test)  loss: 0.6183 -> 0.6925   acc: 83.27% -> 82.61%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.4315 -> 0.4823   acc: 88.88% -> 88.52%             
client [23] (test)  loss: 0.3826 -> 0.4166   acc: 87.10% -> 87.03%             
client [88] (test)  loss: 0.3184 -> 0.3475   acc: 89.69% -> 89.00%             
client [98] (test)  loss: 0.0899 -> 0.1054   acc: 97.72% -> 97.24%             
client [79] (test)  loss: 0.3190 -> 0.3709   acc: 92.37% -> 91.48%             
client [21] (test)  loss: 0.1098 -> 0.1129   acc: 96.82% -> 96.77%             
client [92] (test)  loss: 0.3262 -> 0.3655   acc: 92.37% -> 91.59%             
client [56] (test)  loss: 0.4214 -> 0.5363   acc: 89.11% -> 87.28%             
client [5] (test)  loss: 0.4509 -> 0.5014   acc: 88.99% -> 88.93%              
client [52] (test)  loss: 0.4562 -> 0.5121   acc: 86.58% -> 86.58%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.6064 -> 0.0000', 'accuracy': '82.69% -> 0.00%'},          
    200: {'loss': '0.3741 -> 0.0000', 'accuracy': '90.34% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 40.0%(48.43%) at epoch: 1                                     
pFedSim achieved 60.0%(63.94%) at epoch: 2                                     
pFedSim achieved 70.0%(74.02%) at epoch: 4                                     
pFedSim achieved 80.0%(82.80%) at epoch: 9                                     
pFedSim achieved 90.0%(90.12%) at epoch: 114                                   
Convergence (test_after):                                                      
pFedSim achieved 70.0%(76.27%) at epoch: 0                                     
pFedSim achieved 80.0%(83.82%) at epoch: 2                                     
pFedSim achieved 90.0%(90.19%) at epoch: 16                                    
