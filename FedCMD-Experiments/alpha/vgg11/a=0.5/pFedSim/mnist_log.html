==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6550 -> 0.1314   acc: 76.28% -> 96.28%             
client [81] (test)  loss: 0.2612 -> 0.1692   acc: 92.33% -> 96.30%             
client [21] (test)  loss: 0.1728 -> 0.0862   acc: 95.73% -> 98.01%             
client [68] (test)  loss: 0.1389 -> 0.0184   acc: 95.59% -> 99.30%             
client [93] (test)  loss: 0.2055 -> 0.0517   acc: 93.27% -> 97.12%             
client [31] (test)  loss: 0.4233 -> 0.2333   acc: 87.16% -> 94.00%             
client [20] (test)  loss: 0.4311 -> 0.5570   acc: 86.11% -> 84.88%             
client [59] (test)  loss: 0.2002 -> 0.0814   acc: 96.02% -> 97.51%             
client [48] (test)  loss: 0.3948 -> 0.0762   acc: 87.26% -> 97.45%             
client [34] (test)  loss: 0.1806 -> 0.1703   acc: 95.78% -> 97.01%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.1973 -> 0.1442   acc: 95.11% -> 95.92%             
client [99] (test)  loss: 0.1322 -> 0.0616   acc: 96.13% -> 98.26%             
client [67] (test)  loss: 0.1506 -> 0.0418   acc: 95.29% -> 98.34%             
client [0] (test)  loss: 0.1202 -> 0.0183   acc: 95.95% -> 99.55%              
client [76] (test)  loss: 0.1894 -> 0.1017   acc: 94.98% -> 97.37%             
client [41] (test)  loss: 0.1335 -> 0.1124   acc: 95.74% -> 96.74%             
client [62] (test)  loss: 0.1383 -> 0.1029   acc: 95.91% -> 97.66%             
client [2] (test)  loss: 0.0748 -> 0.0417   acc: 97.83% -> 98.70%              
client [14] (test)  loss: 0.1840 -> 0.1396   acc: 94.03% -> 96.59%             
client [46] (test)  loss: 0.0977 -> 0.0905   acc: 95.28% -> 97.42%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.0984 -> 0.0767   acc: 96.69% -> 97.52%             
client [68] (test)  loss: 0.0464 -> 0.0127   acc: 98.14% -> 99.77%             
client [57] (test)  loss: 0.1047 -> 0.0779   acc: 97.14% -> 97.14%             
client [17] (test)  loss: 0.0804 -> 0.0459   acc: 98.23% -> 98.94%             
client [54] (test)  loss: 0.0962 -> 0.0184   acc: 97.49% -> 99.25%             
client [23] (test)  loss: 0.0896 -> 0.0316   acc: 97.23% -> 98.81%             
client [35] (test)  loss: 0.1007 -> 0.0733   acc: 96.90% -> 97.59%             
client [59] (test)  loss: 0.0123 -> 0.0258   acc: 100.00% -> 99.00%            
client [31] (test)  loss: 0.1731 -> 0.1343   acc: 96.27% -> 96.89%             
client [9] (test)  loss: 0.0999 -> 0.0598   acc: 97.41% -> 98.28%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1031 -> 0.0763   acc: 96.81% -> 98.23%             
client [33] (test)  loss: 0.0741 -> 0.0668   acc: 98.06% -> 98.61%             
client [16] (test)  loss: 0.1235 -> 0.1339   acc: 96.08% -> 96.86%             
client [44] (test)  loss: 0.0809 -> 0.0692   acc: 98.38% -> 98.38%             
client [8] (test)  loss: 0.1661 -> 0.0760   acc: 96.89% -> 97.52%              
client [31] (test)  loss: 0.1508 -> 0.1322   acc: 96.27% -> 97.31%             
client [47] (test)  loss: 0.0675 -> 0.0323   acc: 98.33% -> 99.07%             
client [36] (test)  loss: 0.1540 -> 0.0649   acc: 95.91% -> 98.06%             
client [20] (test)  loss: 0.1319 -> 0.0666   acc: 96.60% -> 98.15%             
client [56] (test)  loss: 0.0836 -> 0.0737   acc: 97.08% -> 98.33%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1005 -> 0.0600   acc: 97.42% -> 98.57%              
client [60] (test)  loss: 0.0173 -> 0.0145   acc: 99.39% -> 99.70%             
client [28] (test)  loss: 0.0653 -> 0.0196   acc: 98.02% -> 99.15%             
client [25] (test)  loss: 0.1147 -> 0.1188   acc: 97.04% -> 97.04%             
client [58] (test)  loss: 0.0919 -> 0.0595   acc: 97.42% -> 98.52%             
client [44] (test)  loss: 0.0661 -> 0.0793   acc: 98.58% -> 98.18%             
client [39] (test)  loss: 0.0404 -> 0.0175   acc: 98.57% -> 99.43%             
client [29] (test)  loss: 0.1565 -> 0.0837   acc: 96.13% -> 97.85%             
client [3] (test)  loss: 0.0959 -> 0.1143   acc: 97.64% -> 97.64%              
client [84] (test)  loss: 0.0425 -> 0.0503   acc: 98.78% -> 98.57%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0214 -> 0.0123   acc: 99.15% -> 99.72%             
client [84] (test)  loss: 0.0524 -> 0.0526   acc: 98.17% -> 98.57%             
client [10] (test)  loss: 0.0472 -> 0.0390   acc: 99.26% -> 98.77%             
client [36] (test)  loss: 0.0902 -> 0.0284   acc: 97.63% -> 99.14%             
client [65] (test)  loss: 0.0414 -> 0.0281   acc: 98.70% -> 99.48%             
client [81] (test)  loss: 0.0759 -> 0.0897   acc: 97.62% -> 98.15%             
client [79] (test)  loss: 0.0543 -> 0.0446   acc: 98.56% -> 99.14%             
client [42] (test)  loss: 0.0720 -> 0.0418   acc: 98.00% -> 98.75%             
client [11] (test)  loss: 0.0660 -> 0.0474   acc: 97.75% -> 98.60%             
client [96] (test)  loss: 0.0512 -> 0.0196   acc: 98.60% -> 99.16%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1007 -> 0.0879   acc: 97.52% -> 98.14%              
client [53] (test)  loss: 0.0992 -> 0.1030   acc: 96.89% -> 96.89%             
client [52] (test)  loss: 0.1241 -> 0.1084   acc: 97.54% -> 96.55%             
client [42] (test)  loss: 0.0575 -> 0.0429   acc: 98.75% -> 99.00%             
client [69] (test)  loss: 0.0802 -> 0.0580   acc: 97.83% -> 98.10%             
client [59] (test)  loss: 0.0071 -> 0.0186   acc: 100.00% -> 99.50%            
client [7] (test)  loss: 0.0679 -> 0.0469   acc: 98.47% -> 98.98%              
client [26] (test)  loss: 0.0552 -> 0.0475   acc: 98.02% -> 98.02%             
client [49] (test)  loss: 0.0719 -> 0.0736   acc: 98.16% -> 98.77%             
client [98] (test)  loss: 0.0523 -> 0.0321   acc: 97.14% -> 98.78%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.0503 -> 0.0385   acc: 97.55% -> 99.18%             
client [47] (test)  loss: 0.0401 -> 0.0079   acc: 98.89% -> 99.63%             
client [21] (test)  loss: 0.0166 -> 0.0075   acc: 99.43% -> 99.72%             
client [77] (test)  loss: 0.0506 -> 0.1046   acc: 98.14% -> 97.67%             
client [95] (test)  loss: 0.1078 -> 0.0374   acc: 97.01% -> 98.50%             
client [91] (test)  loss: 0.0470 -> 0.0218   acc: 98.73% -> 99.16%             
client [14] (test)  loss: 0.0796 -> 0.0750   acc: 97.73% -> 98.86%             
client [99] (test)  loss: 0.0649 -> 0.0250   acc: 97.68% -> 99.23%             
client [20] (test)  loss: 0.1005 -> 0.0518   acc: 97.22% -> 98.77%             
client [39] (test)  loss: 0.0309 -> 0.0196   acc: 98.86% -> 99.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1605 -> 0.1050   acc: 97.04% -> 96.55%             
client [62] (test)  loss: 0.0744 -> 0.0726   acc: 97.95% -> 98.54%             
client [71] (test)  loss: 0.0697 -> 0.0267   acc: 96.97% -> 99.49%             
client [97] (test)  loss: 0.0969 -> 0.0408   acc: 97.69% -> 99.16%             
client [30] (test)  loss: 0.0495 -> 0.0366   acc: 98.26% -> 99.13%             
client [88] (test)  loss: 0.0644 -> 0.0646   acc: 98.22% -> 97.78%             
client [60] (test)  loss: 0.0173 -> 0.0682   acc: 99.70% -> 98.48%             
client [82] (test)  loss: 0.0422 -> 0.0090   acc: 99.17% -> 99.45%             
client [91] (test)  loss: 0.0190 -> 0.0208   acc: 99.16% -> 99.16%             
client [57] (test)  loss: 0.0669 -> 0.0424   acc: 98.10% -> 99.52%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0935 -> 0.0880   acc: 97.93% -> 98.34%             
client [15] (test)  loss: 0.0869 -> 0.0894   acc: 98.08% -> 97.80%             
client [71] (test)  loss: 0.0533 -> 0.0295   acc: 98.48% -> 99.49%             
client [97] (test)  loss: 0.0691 -> 0.0409   acc: 98.74% -> 99.16%             
client [53] (test)  loss: 0.0942 -> 0.1013   acc: 96.89% -> 96.89%             
client [77] (test)  loss: 0.0495 -> 0.0452   acc: 98.60% -> 99.07%             
client [76] (test)  loss: 0.0602 -> 0.0454   acc: 98.80% -> 98.80%             
client [79] (test)  loss: 0.0417 -> 0.0414   acc: 99.14% -> 99.43%             
client [28] (test)  loss: 0.0304 -> 0.0087   acc: 98.58% -> 99.72%             
client [99] (test)  loss: 0.0459 -> 0.0288   acc: 98.65% -> 99.42%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.0426 -> 0.0402   acc: 99.16% -> 98.95%             
client [86] (test)  loss: 0.0579 -> 0.0582   acc: 99.10% -> 98.88%             
client [34] (test)  loss: 0.1841 -> 0.1448   acc: 96.84% -> 97.72%             
client [73] (test)  loss: 0.0237 -> 0.0202   acc: 99.23% -> 99.49%             
client [5] (test)  loss: 0.0517 -> 0.0469   acc: 98.74% -> 98.99%              
client [96] (test)  loss: 0.0363 -> 0.0157   acc: 98.60% -> 99.16%             
client [22] (test)  loss: 0.0665 -> 0.0523   acc: 98.30% -> 98.86%             
client [60] (test)  loss: 0.0275 -> 0.0214   acc: 98.48% -> 99.39%             
client [66] (test)  loss: 0.0240 -> 0.0108   acc: 99.41% -> 99.60%             
client [83] (test)  loss: 0.1325 -> 0.1795   acc: 97.68% -> 96.14%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.0670 -> 0.0759   acc: 98.80% -> 98.33%             
client [65] (test)  loss: 0.0323 -> 0.0327   acc: 99.22% -> 99.48%             
client [95] (test)  loss: 0.0587 -> 0.0250   acc: 97.51% -> 99.00%             
client [17] (test)  loss: 0.0347 -> 0.0418   acc: 99.29% -> 98.94%             
client [8] (test)  loss: 0.0637 -> 0.0468   acc: 98.14% -> 99.38%              
client [35] (test)  loss: 0.0764 -> 0.0608   acc: 97.93% -> 98.62%             
client [98] (test)  loss: 0.0321 -> 0.0248   acc: 98.78% -> 99.18%             
client [53] (test)  loss: 0.0975 -> 0.1022   acc: 96.89% -> 97.23%             
client [43] (test)  loss: 0.0896 -> 0.0934   acc: 98.98% -> 98.98%             
client [64] (test)  loss: 0.0243 -> 0.0473   acc: 99.29% -> 98.58%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.0077 -> 0.0063   acc: 99.43% -> 99.72%             
client [88] (test)  loss: 0.0646 -> 0.0602   acc: 98.67% -> 98.67%             
client [38] (test)  loss: 0.0260 -> 0.0302   acc: 99.25% -> 99.50%             
client [3] (test)  loss: 0.1064 -> 0.0996   acc: 97.64% -> 98.11%              
client [5] (test)  loss: 0.0498 -> 0.0516   acc: 98.74% -> 98.99%              
client [41] (test)  loss: 0.0513 -> 0.0382   acc: 98.75% -> 99.25%             
client [7] (test)  loss: 0.0491 -> 0.0467   acc: 98.47% -> 98.72%              
client [37] (test)  loss: 0.1721 -> 0.1407   acc: 96.50% -> 97.77%             
client [45] (test)  loss: 0.0582 -> 0.0404   acc: 98.35% -> 99.45%             
client [47] (test)  loss: 0.0422 -> 0.0148   acc: 98.89% -> 99.26%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.0842 -> 0.0875   acc: 98.04% -> 97.65%             
client [11] (test)  loss: 0.0696 -> 0.0521   acc: 98.31% -> 98.60%             
client [37] (test)  loss: 0.1595 -> 0.1333   acc: 96.50% -> 97.77%             
client [41] (test)  loss: 0.0508 -> 0.0377   acc: 98.75% -> 99.25%             
client [95] (test)  loss: 0.0594 -> 0.0179   acc: 97.51% -> 99.25%             
client [53] (test)  loss: 0.0916 -> 0.0999   acc: 96.89% -> 97.23%             
client [22] (test)  loss: 0.0603 -> 0.0439   acc: 98.86% -> 98.86%             
client [25] (test)  loss: 0.0731 -> 0.0823   acc: 98.22% -> 98.22%             
client [69] (test)  loss: 0.0705 -> 0.0480   acc: 97.55% -> 98.64%             
client [46] (test)  loss: 0.0206 -> 0.0271   acc: 99.57% -> 99.14%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.0323 -> 0.0161   acc: 99.07% -> 99.26%             
client [69] (test)  loss: 0.0696 -> 0.0464   acc: 97.83% -> 98.64%             
client [82] (test)  loss: 0.0282 -> 0.0094   acc: 99.45% -> 99.45%             
client [45] (test)  loss: 0.0562 -> 0.0403   acc: 98.08% -> 99.45%             
client [7] (test)  loss: 0.0471 -> 0.0438   acc: 98.72% -> 98.72%              
client [50] (test)  loss: 0.0496 -> 0.0482   acc: 98.55% -> 99.03%             
client [35] (test)  loss: 0.0727 -> 0.0571   acc: 97.93% -> 98.62%             
client [24] (test)  loss: 0.0846 -> 0.0912   acc: 97.52% -> 97.52%             
client [15] (test)  loss: 0.0991 -> 0.0952   acc: 98.08% -> 97.53%             
client [58] (test)  loss: 0.0557 -> 0.0401   acc: 98.52% -> 98.89%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.0514 -> 0.0409   acc: 98.73% -> 99.36%             
client [76] (test)  loss: 0.0585 -> 0.0447   acc: 98.80% -> 99.04%             
client [67] (test)  loss: 0.0220 -> 0.0042   acc: 98.89% -> 99.72%             
client [37] (test)  loss: 0.1537 -> 0.1352   acc: 97.45% -> 97.77%             
client [58] (test)  loss: 0.0539 -> 0.0417   acc: 98.52% -> 99.08%             
client [64] (test)  loss: 0.0266 -> 0.0376   acc: 99.29% -> 98.58%             
client [77] (test)  loss: 0.0552 -> 0.0532   acc: 98.60% -> 98.60%             
client [55] (test)  loss: 0.0280 -> 0.0157   acc: 99.16% -> 99.37%             
client [12] (test)  loss: 0.0766 -> 0.0695   acc: 98.35% -> 98.35%             
client [89] (test)  loss: 0.0721 -> 0.0686   acc: 98.51% -> 98.76%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.0289 -> 0.0302   acc: 99.39% -> 99.39%             
client [51] (test)  loss: 0.0289 -> 0.0218   acc: 99.50% -> 99.25%             
client [8] (test)  loss: 0.0520 -> 0.0407   acc: 98.76% -> 99.38%              
client [18] (test)  loss: 0.0391 -> 0.0558   acc: 98.96% -> 98.18%             
client [94] (test)  loss: 0.0728 -> 0.0637   acc: 98.53% -> 98.53%             
client [81] (test)  loss: 0.0723 -> 0.0832   acc: 97.88% -> 98.15%             
client [3] (test)  loss: 0.1108 -> 0.1042   acc: 97.64% -> 98.11%              
client [11] (test)  loss: 0.0738 -> 0.0505   acc: 98.31% -> 98.60%             
client [95] (test)  loss: 0.0485 -> 0.0210   acc: 98.00% -> 99.00%             
client [67] (test)  loss: 0.0183 -> 0.0028   acc: 98.89% -> 100.00%            
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.0053 -> 0.0063   acc: 99.72% -> 99.72%             
client [79] (test)  loss: 0.0379 -> 0.0471   acc: 99.14% -> 99.43%             
client [58] (test)  loss: 0.0509 -> 0.0408   acc: 98.71% -> 98.71%             
client [88] (test)  loss: 0.0601 -> 0.0578   acc: 98.67% -> 98.67%             
client [46] (test)  loss: 0.0199 -> 0.0288   acc: 99.14% -> 99.14%             
client [11] (test)  loss: 0.0746 -> 0.0506   acc: 98.31% -> 98.60%             
client [55] (test)  loss: 0.0231 -> 0.0153   acc: 99.37% -> 99.58%             
client [13] (test)  loss: 0.0485 -> 0.0390   acc: 98.65% -> 98.92%             
client [31] (test)  loss: 0.0937 -> 0.0901   acc: 97.93% -> 98.34%             
client [75] (test)  loss: 0.0774 -> 0.0744   acc: 98.86% -> 98.86%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.0297 -> 0.0180   acc: 99.44% -> 99.44%             
client [7] (test)  loss: 0.0474 -> 0.0450   acc: 98.72% -> 98.47%              
client [57] (test)  loss: 0.0330 -> 0.0413   acc: 99.52% -> 99.52%             
client [13] (test)  loss: 0.0432 -> 0.0317   acc: 98.65% -> 98.92%             
client [43] (test)  loss: 0.0975 -> 0.0946   acc: 98.98% -> 98.98%             
client [91] (test)  loss: 0.0286 -> 0.0327   acc: 99.16% -> 99.16%             
client [10] (test)  loss: 0.0449 -> 0.0367   acc: 99.51% -> 99.51%             
client [64] (test)  loss: 0.0302 -> 0.0360   acc: 99.29% -> 98.58%             
client [82] (test)  loss: 0.0225 -> 0.0080   acc: 99.45% -> 99.45%             
client [22] (test)  loss: 0.0541 -> 0.0542   acc: 98.86% -> 98.86%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.0541 -> 0.0331   acc: 97.84% -> 98.77%             
client [23] (test)  loss: 0.0352 -> 0.0208   acc: 98.81% -> 99.21%             
client [88] (test)  loss: 0.0604 -> 0.0582   acc: 98.67% -> 98.67%             
client [98] (test)  loss: 0.0211 -> 0.0267   acc: 98.37% -> 99.59%             
client [79] (test)  loss: 0.0376 -> 0.0473   acc: 99.14% -> 99.43%             
client [21] (test)  loss: 0.0049 -> 0.0092   acc: 99.72% -> 99.72%             
client [92] (test)  loss: 0.0165 -> 0.0147   acc: 99.21% -> 99.21%             
client [56] (test)  loss: 0.0301 -> 0.0315   acc: 98.96% -> 99.37%             
client [5] (test)  loss: 0.0545 -> 0.0578   acc: 98.99% -> 98.99%              
client [52] (test)  loss: 0.1264 -> 0.1470   acc: 97.04% -> 97.04%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.0638 -> 0.0000', 'accuracy': '98.42% -> 0.00%'},          
    200: {'loss': '0.0509 -> 0.0000', 'accuracy': '98.90% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(15.65%) at epoch: 1                                     
pFedSim achieved 50.0%(51.07%) at epoch: 2                                     
pFedSim achieved 70.0%(74.79%) at epoch: 3                                     
pFedSim achieved 80.0%(86.88%) at epoch: 5                                     
pFedSim achieved 90.0%(90.44%) at epoch: 6                                     
Convergence (test_after):                                                      
pFedSim achieved 40.0%(43.84%) at epoch: 0                                     
pFedSim achieved 70.0%(74.37%) at epoch: 1                                     
pFedSim achieved 80.0%(85.92%) at epoch: 3                                     
pFedSim achieved 90.0%(94.16%) at epoch: 4                                     
