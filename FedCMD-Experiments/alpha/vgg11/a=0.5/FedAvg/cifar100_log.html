==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.0328 -> 4.0468   acc: 15.74% -> 23.93%             
client [81] (test)  loss: 3.8575 -> 3.9337   acc: 18.75% -> 31.25%             
client [21] (test)  loss: 4.4039 -> 3.7635   acc: 16.72% -> 26.13%             
client [68] (test)  loss: 4.5903 -> 3.9251   acc: 14.59% -> 28.27%             
client [93] (test)  loss: 4.2261 -> 3.8494   acc: 14.66% -> 28.99%             
client [31] (test)  loss: 4.4016 -> 4.3241   acc: 16.73% -> 24.00%             
client [20] (test)  loss: 3.5842 -> 3.9126   acc: 21.38% -> 29.66%             
client [59] (test)  loss: 4.0531 -> 3.7636   acc: 16.50% -> 27.83%             
client [48] (test)  loss: 4.4327 -> 4.6742   acc: 12.13% -> 18.69%             
client [34] (test)  loss: 3.8201 -> 4.2139   acc: 18.08% -> 19.56%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.9419 -> 3.8403   acc: 22.30% -> 35.25%             
client [99] (test)  loss: 3.8215 -> 3.7340   acc: 26.92% -> 33.65%             
client [67] (test)  loss: 3.6028 -> 3.5599   acc: 24.10% -> 33.55%             
client [0] (test)  loss: 3.4074 -> 3.3965   acc: 31.00% -> 38.00%              
client [76] (test)  loss: 4.0229 -> 4.1929   acc: 22.73% -> 24.24%             
client [41] (test)  loss: 4.3900 -> 3.7132   acc: 20.27% -> 32.56%             
client [62] (test)  loss: 3.9619 -> 3.5387   acc: 17.49% -> 29.37%             
client [2] (test)  loss: 3.4933 -> 3.2101   acc: 30.13% -> 36.75%              
client [14] (test)  loss: 3.7219 -> 3.7272   acc: 26.84% -> 34.50%             
client [46] (test)  loss: 4.3204 -> 4.6013   acc: 15.95% -> 22.92%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4695 -> 3.6904   acc: 24.65% -> 34.38%             
client [68] (test)  loss: 3.4757 -> 2.9401   acc: 31.61% -> 41.64%             
client [57] (test)  loss: 3.5473 -> 3.2550   acc: 29.77% -> 34.30%             
client [17] (test)  loss: 4.1360 -> 3.7694   acc: 19.01% -> 34.21%             
client [54] (test)  loss: 3.6830 -> 3.4945   acc: 24.44% -> 36.66%             
client [23] (test)  loss: 3.6028 -> 3.7801   acc: 30.00% -> 30.67%             
client [35] (test)  loss: 3.7908 -> 3.9482   acc: 22.95% -> 29.51%             
client [59] (test)  loss: 3.4172 -> 3.2077   acc: 31.07% -> 41.75%             
client [31] (test)  loss: 3.5723 -> 3.6141   acc: 27.27% -> 34.55%             
client [9] (test)  loss: 3.6315 -> 3.7460   acc: 28.99% -> 34.20%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.5810 -> 2.8838   acc: 32.23% -> 43.85%             
client [33] (test)  loss: 3.6372 -> 3.3354   acc: 30.72% -> 43.34%             
client [16] (test)  loss: 3.8572 -> 2.4658   acc: 26.32% -> 52.89%             
client [44] (test)  loss: 3.2067 -> 2.9258   acc: 32.01% -> 40.26%             
client [8] (test)  loss: 3.5998 -> 3.5630   acc: 26.03% -> 36.51%              
client [31] (test)  loss: 3.8437 -> 3.5098   acc: 24.36% -> 36.36%             
client [47] (test)  loss: 3.8043 -> 3.6286   acc: 26.56% -> 37.81%             
client [36] (test)  loss: 3.4107 -> 3.2267   acc: 27.08% -> 37.92%             
client [20] (test)  loss: 3.0166 -> 2.9660   acc: 34.14% -> 43.45%             
client [56] (test)  loss: 3.5294 -> 3.3980   acc: 27.27% -> 34.62%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.3305 -> 3.0001   acc: 32.60% -> 42.12%              
client [60] (test)  loss: 3.3119 -> 2.9990   acc: 27.41% -> 36.67%             
client [28] (test)  loss: 3.3753 -> 3.1961   acc: 31.61% -> 41.61%             
client [25] (test)  loss: 3.5238 -> 2.8465   acc: 28.80% -> 41.42%             
client [58] (test)  loss: 3.1965 -> 3.0328   acc: 37.42% -> 44.03%             
client [44] (test)  loss: 3.1222 -> 2.8036   acc: 34.65% -> 41.25%             
client [39] (test)  loss: 3.6109 -> 3.9494   acc: 31.35% -> 30.69%             
client [29] (test)  loss: 3.4537 -> 2.9594   acc: 31.56% -> 44.19%             
client [3] (test)  loss: 3.4604 -> 2.9815   acc: 30.10% -> 46.28%              
client [84] (test)  loss: 3.2524 -> 3.2809   acc: 31.15% -> 38.94%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.3504 -> 2.9780   acc: 32.75% -> 44.95%             
client [84] (test)  loss: 3.1830 -> 3.2264   acc: 33.02% -> 38.63%             
client [10] (test)  loss: 3.3712 -> 2.7508   acc: 32.13% -> 43.93%             
client [36] (test)  loss: 3.0896 -> 3.2909   acc: 32.92% -> 40.00%             
client [65] (test)  loss: 3.0035 -> 2.8292   acc: 34.63% -> 48.54%             
client [81] (test)  loss: 3.1117 -> 2.8768   acc: 34.54% -> 48.03%             
client [79] (test)  loss: 3.4788 -> 3.3819   acc: 31.23% -> 36.54%             
client [42] (test)  loss: 3.3502 -> 3.2127   acc: 32.31% -> 38.10%             
client [11] (test)  loss: 3.2712 -> 2.9763   acc: 34.39% -> 40.35%             
client [96] (test)  loss: 3.2247 -> 3.1720   acc: 37.22% -> 42.72%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.4144 -> 3.1731   acc: 27.94% -> 43.81%              
client [53] (test)  loss: 3.7705 -> 3.3828   acc: 25.99% -> 40.13%             
client [52] (test)  loss: 3.8804 -> 3.1838   acc: 27.83% -> 43.04%             
client [42] (test)  loss: 3.1204 -> 3.1186   acc: 35.71% -> 39.80%             
client [69] (test)  loss: 3.4419 -> 3.3427   acc: 31.65% -> 42.45%             
client [59] (test)  loss: 2.8973 -> 2.8111   acc: 37.54% -> 46.93%             
client [7] (test)  loss: 3.7628 -> 3.2708   acc: 28.43% -> 37.38%              
client [26] (test)  loss: 3.6600 -> 3.3242   acc: 28.57% -> 42.19%             
client [49] (test)  loss: 3.2876 -> 2.9469   acc: 34.27% -> 38.71%             
client [98] (test)  loss: 3.2682 -> 3.2517   acc: 35.18% -> 42.02%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.2678 -> 3.2419   acc: 35.18% -> 43.00%             
client [47] (test)  loss: 3.7727 -> 3.3335   acc: 31.87% -> 40.62%             
client [21] (test)  loss: 3.3698 -> 2.9362   acc: 32.40% -> 47.39%             
client [77] (test)  loss: 3.3012 -> 3.0567   acc: 31.80% -> 41.97%             
client [95] (test)  loss: 3.5417 -> 3.3649   acc: 32.34% -> 39.60%             
client [91] (test)  loss: 3.2823 -> 3.2393   acc: 33.97% -> 44.23%             
client [14] (test)  loss: 3.2243 -> 3.1780   acc: 36.10% -> 43.77%             
client [99] (test)  loss: 3.3073 -> 3.0637   acc: 35.58% -> 41.67%             
client [20] (test)  loss: 2.7540 -> 2.7568   acc: 42.07% -> 48.62%             
client [39] (test)  loss: 3.5159 -> 3.6496   acc: 30.69% -> 34.32%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.7490 -> 3.2511   acc: 33.01% -> 39.81%             
client [62] (test)  loss: 3.1987 -> 3.0259   acc: 34.32% -> 41.58%             
client [71] (test)  loss: 3.5508 -> 3.6154   acc: 31.08% -> 36.15%             
client [97] (test)  loss: 3.4434 -> 2.7897   acc: 30.65% -> 48.61%             
client [30] (test)  loss: 2.8430 -> 2.6787   acc: 39.33% -> 46.33%             
client [88] (test)  loss: 2.9628 -> 2.7120   acc: 38.30% -> 44.33%             
client [60] (test)  loss: 3.1264 -> 2.9621   acc: 29.63% -> 40.00%             
client [82] (test)  loss: 2.9793 -> 2.7781   acc: 39.93% -> 43.69%             
client [91] (test)  loss: 3.1212 -> 3.0955   acc: 36.22% -> 45.51%             
client [57] (test)  loss: 3.4852 -> 2.9031   acc: 32.04% -> 43.37%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.4279 -> 3.3214   acc: 33.82% -> 41.09%             
client [15] (test)  loss: 3.3082 -> 2.7192   acc: 30.36% -> 43.89%             
client [71] (test)  loss: 3.7862 -> 3.5625   acc: 27.03% -> 37.50%             
client [97] (test)  loss: 3.5847 -> 2.8695   acc: 33.13% -> 47.99%             
client [53] (test)  loss: 3.9247 -> 3.2837   acc: 25.99% -> 40.46%             
client [77] (test)  loss: 3.0802 -> 2.9443   acc: 37.05% -> 44.59%             
client [76] (test)  loss: 3.3531 -> 3.3543   acc: 34.09% -> 35.61%             
client [79] (test)  loss: 3.4845 -> 3.1629   acc: 32.56% -> 42.86%             
client [28] (test)  loss: 3.1976 -> 3.1184   acc: 35.16% -> 45.48%             
client [99] (test)  loss: 3.2679 -> 2.9470   acc: 39.42% -> 44.55%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.6185 -> 2.9836   acc: 32.20% -> 45.82%             
client [86] (test)  loss: 3.2033 -> 3.1149   acc: 40.91% -> 46.10%             
client [34] (test)  loss: 3.3065 -> 3.0939   acc: 33.95% -> 42.80%             
client [73] (test)  loss: 3.1283 -> 3.1292   acc: 36.25% -> 41.42%             
client [5] (test)  loss: 3.2378 -> 3.4242   acc: 34.11% -> 39.07%              
client [96] (test)  loss: 3.1131 -> 3.1524   acc: 41.75% -> 46.28%             
client [22] (test)  loss: 3.4745 -> 3.3084   acc: 33.77% -> 43.71%             
client [60] (test)  loss: 3.1792 -> 2.9352   acc: 31.11% -> 40.00%             
client [66] (test)  loss: 3.6386 -> 3.4615   acc: 27.91% -> 33.55%             
client [83] (test)  loss: 3.7329 -> 3.4463   acc: 31.06% -> 37.54%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.2798 -> 3.3764   acc: 33.33% -> 37.12%             
client [65] (test)  loss: 3.1907 -> 2.7582   acc: 34.30% -> 47.90%             
client [95] (test)  loss: 3.4604 -> 3.2677   acc: 34.98% -> 41.58%             
client [17] (test)  loss: 4.0371 -> 3.3619   acc: 28.95% -> 39.77%             
client [8] (test)  loss: 3.2586 -> 3.2477   acc: 36.83% -> 44.44%              
client [35] (test)  loss: 3.4675 -> 3.7021   acc: 32.46% -> 39.67%             
client [98] (test)  loss: 3.2420 -> 3.0779   acc: 34.85% -> 46.91%             
client [53] (test)  loss: 3.5153 -> 3.2899   acc: 30.59% -> 44.08%             
client [43] (test)  loss: 3.6029 -> 3.2840   acc: 31.35% -> 38.94%             
client [64] (test)  loss: 3.5090 -> 2.7524   acc: 35.88% -> 46.84%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.3711 -> 2.9492   acc: 37.28% -> 44.25%             
client [88] (test)  loss: 3.2203 -> 2.9197   acc: 40.07% -> 43.26%             
client [38] (test)  loss: 2.9333 -> 2.4402   acc: 37.70% -> 54.10%             
client [3] (test)  loss: 3.5211 -> 2.9851   acc: 36.89% -> 47.90%              
client [5] (test)  loss: 3.5017 -> 3.4435   acc: 33.11% -> 36.42%              
client [41] (test)  loss: 3.4677 -> 3.0825   acc: 37.54% -> 46.18%             
client [7] (test)  loss: 4.1668 -> 3.1932   acc: 25.56% -> 41.21%              
client [37] (test)  loss: 3.2007 -> 2.8688   acc: 42.57% -> 48.51%             
client [45] (test)  loss: 3.2765 -> 2.7209   acc: 39.53% -> 46.51%             
client [47] (test)  loss: 3.5498 -> 3.3876   acc: 38.44% -> 43.75%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.4797 -> 2.4694   acc: 33.68% -> 56.84%             
client [11] (test)  loss: 3.2986 -> 2.8811   acc: 36.49% -> 45.26%             
client [37] (test)  loss: 3.0324 -> 2.9282   acc: 39.27% -> 47.19%             
client [41] (test)  loss: 3.3687 -> 3.0166   acc: 36.21% -> 44.52%             
client [95] (test)  loss: 3.5045 -> 3.2146   acc: 31.02% -> 45.54%             
client [53] (test)  loss: 3.7011 -> 3.2937   acc: 29.61% -> 43.75%             
client [22] (test)  loss: 3.4372 -> 3.1575   acc: 34.44% -> 44.04%             
client [25] (test)  loss: 3.4098 -> 2.9706   acc: 37.86% -> 49.84%             
client [69] (test)  loss: 3.7538 -> 3.3045   acc: 37.41% -> 42.45%             
client [46] (test)  loss: 3.7266 -> 3.8534   acc: 30.23% -> 36.88%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.4499 -> 3.4301   acc: 35.94% -> 44.69%             
client [69] (test)  loss: 3.8140 -> 3.3699   acc: 36.69% -> 44.60%             
client [82] (test)  loss: 3.1773 -> 2.8382   acc: 43.00% -> 45.05%             
client [45] (test)  loss: 3.4234 -> 2.7515   acc: 39.53% -> 44.52%             
client [7] (test)  loss: 4.0762 -> 3.1689   acc: 28.12% -> 42.49%              
client [50] (test)  loss: 3.4897 -> 3.3935   acc: 43.85% -> 44.19%             
client [35] (test)  loss: 3.6989 -> 3.8480   acc: 33.44% -> 39.34%             
client [24] (test)  loss: 3.3993 -> 3.2680   acc: 36.81% -> 45.49%             
client [15] (test)  loss: 3.4166 -> 2.6270   acc: 35.97% -> 44.88%             
client [58] (test)  loss: 3.2489 -> 3.1228   acc: 41.51% -> 47.80%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.6310 -> 3.3243   acc: 31.48% -> 45.25%             
client [76] (test)  loss: 3.4756 -> 3.3985   acc: 33.71% -> 35.98%             
client [67] (test)  loss: 3.1683 -> 2.8316   acc: 44.95% -> 48.86%             
client [37] (test)  loss: 3.0667 -> 2.9288   acc: 44.22% -> 50.50%             
client [58] (test)  loss: 3.3082 -> 3.2288   acc: 42.45% -> 48.43%             
client [64] (test)  loss: 3.5197 -> 2.9233   acc: 38.54% -> 46.84%             
client [77] (test)  loss: 3.1767 -> 3.0403   acc: 40.66% -> 44.59%             
client [55] (test)  loss: 3.6070 -> 3.3311   acc: 32.62% -> 41.49%             
client [12] (test)  loss: 3.6868 -> 3.1914   acc: 35.88% -> 44.52%             
client [89] (test)  loss: 3.5610 -> 3.1214   acc: 35.37% -> 42.44%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.2596 -> 3.2305   acc: 38.01% -> 46.11%             
client [51] (test)  loss: 3.1146 -> 2.7583   acc: 36.54% -> 49.17%             
client [8] (test)  loss: 3.4498 -> 3.2485   acc: 33.65% -> 47.62%              
client [18] (test)  loss: 3.2549 -> 2.7922   acc: 39.67% -> 50.49%             
client [94] (test)  loss: 3.9768 -> 3.1651   acc: 31.80% -> 45.94%             
client [81] (test)  loss: 3.1991 -> 2.9913   acc: 46.38% -> 48.68%             
client [3] (test)  loss: 3.6620 -> 3.0656   acc: 36.89% -> 48.22%              
client [11] (test)  loss: 3.2279 -> 3.0058   acc: 42.46% -> 50.88%             
client [95] (test)  loss: 3.6057 -> 3.4050   acc: 34.98% -> 44.55%             
client [67] (test)  loss: 3.1679 -> 2.8322   acc: 44.63% -> 48.21%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.7480 -> 2.9835   acc: 34.84% -> 46.34%             
client [79] (test)  loss: 3.8916 -> 3.5100   acc: 32.89% -> 43.52%             
client [58] (test)  loss: 3.5033 -> 3.2453   acc: 40.25% -> 48.43%             
client [88] (test)  loss: 3.2784 -> 3.0335   acc: 40.07% -> 45.04%             
client [46] (test)  loss: 4.3110 -> 4.0274   acc: 27.91% -> 37.21%             
client [11] (test)  loss: 3.8692 -> 3.0192   acc: 35.09% -> 45.61%             
client [55] (test)  loss: 3.8348 -> 3.3812   acc: 31.91% -> 43.26%             
client [13] (test)  loss: 3.4906 -> 3.3676   acc: 40.42% -> 42.16%             
client [31] (test)  loss: 3.6521 -> 3.5030   acc: 35.64% -> 41.82%             
client [75] (test)  loss: 3.9934 -> 3.1452   acc: 31.94% -> 45.37%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.6068 -> 3.3262   acc: 35.50% -> 38.76%             
client [7] (test)  loss: 4.0413 -> 3.4516   acc: 30.03% -> 41.53%              
client [57] (test)  loss: 3.4174 -> 3.2172   acc: 38.19% -> 42.72%             
client [13] (test)  loss: 3.4425 -> 3.2669   acc: 37.28% -> 45.30%             
client [43] (test)  loss: 3.7767 -> 3.6555   acc: 33.66% -> 40.59%             
client [91] (test)  loss: 3.5428 -> 3.3163   acc: 37.50% -> 43.59%             
client [10] (test)  loss: 3.6975 -> 2.8201   acc: 37.38% -> 47.54%             
client [64] (test)  loss: 3.4958 -> 2.9911   acc: 37.54% -> 51.50%             
client [82] (test)  loss: 3.1864 -> 3.0023   acc: 41.98% -> 45.39%             
client [22] (test)  loss: 3.7116 -> 3.4429   acc: 33.11% -> 43.05%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.7703 -> 3.7418   acc: 46.90% -> 31.72%             
client [23] (test)  loss: 3.9537 -> 3.7937   acc: 35.67% -> 39.67%             
client [88] (test)  loss: 3.3138 -> 3.0365   acc: 37.23% -> 43.97%             
client [98] (test)  loss: 3.6560 -> 3.4479   acc: 35.50% -> 47.56%             
client [79] (test)  loss: 3.7630 -> 3.7140   acc: 37.87% -> 43.85%             
client [21] (test)  loss: 3.4333 -> 3.1034   acc: 40.77% -> 46.69%             
client [92] (test)  loss: 4.0715 -> 3.7308   acc: 32.33% -> 39.67%             
client [56] (test)  loss: 3.8408 -> 3.6432   acc: 36.71% -> 41.96%             
client [5] (test)  loss: 3.7151 -> 3.7276   acc: 36.09% -> 40.73%              
client [52] (test)  loss: 4.2099 -> 3.6718   acc: 32.04% -> 45.31%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '3.3462 -> 0.0000', 'accuracy': '34.70% -> 0.00%'},          
    200: {'loss': '3.7044 -> 0.0000', 'accuracy': '37.77% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(10.39%) at epoch: 6                                      
FedAvg achieved 20.0%(22.38%) at epoch: 16                                     
FedAvg achieved 30.0%(30.70%) at epoch: 38                                     
FedAvg achieved 40.0%(40.59%) at epoch: 132                                    
Convergence (test_after):                                                      
FedAvg achieved 10.0%(14.82%) at epoch: 0                                      
FedAvg achieved 20.0%(20.41%) at epoch: 5                                      
FedAvg achieved 30.0%(30.07%) at epoch: 16                                     
FedAvg achieved 40.0%(41.56%) at epoch: 37                                     
