==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5555 -> 0.4264   acc: 83.63% -> 85.39%             
client [81] (test)  loss: 0.4642 -> 0.2910   acc: 83.58% -> 88.81%             
client [21] (test)  loss: 0.5564 -> 0.4310   acc: 80.91% -> 84.55%             
client [68] (test)  loss: 1.3133 -> 0.5721   acc: 40.23% -> 79.59%             
client [93] (test)  loss: 0.5036 -> 0.6182   acc: 83.72% -> 77.52%             
client [31] (test)  loss: 0.5675 -> 1.2287   acc: 78.49% -> 68.72%             
client [20] (test)  loss: 0.3817 -> 0.1812   acc: 86.54% -> 93.40%             
client [59] (test)  loss: 0.4362 -> 0.2844   acc: 86.46% -> 91.70%             
client [48] (test)  loss: 0.9024 -> 0.6695   acc: 63.93% -> 75.00%             
client [34] (test)  loss: 0.4268 -> 0.3640   acc: 84.22% -> 88.80%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4827 -> 0.6030   acc: 84.82% -> 80.95%             
client [99] (test)  loss: 0.7841 -> 0.2541   acc: 69.63% -> 94.07%             
client [67] (test)  loss: 0.4350 -> 0.3375   acc: 86.12% -> 88.53%             
client [0] (test)  loss: 0.6830 -> 0.7218   acc: 74.73% -> 79.52%              
client [76] (test)  loss: 0.6558 -> 0.7641   acc: 76.60% -> 77.33%             
client [41] (test)  loss: 0.5095 -> 0.1745   acc: 81.94% -> 94.44%             
client [62] (test)  loss: 0.4704 -> 0.2424   acc: 83.28% -> 92.33%             
client [2] (test)  loss: 0.7008 -> 0.4717   acc: 74.45% -> 84.54%              
client [14] (test)  loss: 0.4172 -> 0.4055   acc: 85.83% -> 86.10%             
client [46] (test)  loss: 0.7191 -> 0.3400   acc: 73.07% -> 85.87%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0314 -> 1.0576   acc: 65.96% -> 73.67%             
client [68] (test)  loss: 1.0811 -> 0.6042   acc: 58.00% -> 83.26%             
client [57] (test)  loss: 0.2010 -> 0.0556   acc: 92.78% -> 97.78%             
client [17] (test)  loss: 0.4042 -> 0.3726   acc: 86.63% -> 90.27%             
client [54] (test)  loss: 0.6050 -> 0.6409   acc: 79.89% -> 81.50%             
client [23] (test)  loss: 0.5483 -> 0.3227   acc: 81.25% -> 89.38%             
client [35] (test)  loss: 0.2592 -> 0.1942   acc: 90.96% -> 94.83%             
client [59] (test)  loss: 0.2969 -> 0.2618   acc: 90.83% -> 93.89%             
client [31] (test)  loss: 0.5496 -> 0.5399   acc: 82.68% -> 83.80%             
client [9] (test)  loss: 0.4284 -> 0.1102   acc: 86.61% -> 95.74%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3274 -> 0.1937   acc: 89.43% -> 93.14%             
client [33] (test)  loss: 0.6807 -> 0.1295   acc: 79.04% -> 96.46%             
client [16] (test)  loss: 0.3348 -> 0.2126   acc: 92.49% -> 95.20%             
client [44] (test)  loss: 0.4620 -> 0.2211   acc: 85.82% -> 95.36%             
client [8] (test)  loss: 0.3682 -> 0.4017   acc: 89.96% -> 90.83%              
client [31] (test)  loss: 0.5567 -> 0.5586   acc: 81.84% -> 85.20%             
client [47] (test)  loss: 0.4909 -> 0.3748   acc: 83.74% -> 90.11%             
client [36] (test)  loss: 0.2065 -> 0.1842   acc: 94.04% -> 94.62%             
client [20] (test)  loss: 0.3615 -> 0.1757   acc: 89.97% -> 93.93%             
client [56] (test)  loss: 0.3896 -> 0.5725   acc: 84.73% -> 87.19%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6663 -> 0.5526   acc: 76.95% -> 82.81%              
client [60] (test)  loss: 0.4253 -> 0.2599   acc: 86.67% -> 93.64%             
client [28] (test)  loss: 0.6105 -> 0.1583   acc: 82.82% -> 94.93%             
client [25] (test)  loss: 0.4436 -> 0.3065   acc: 87.79% -> 91.21%             
client [58] (test)  loss: 0.9324 -> 0.6601   acc: 73.90% -> 79.12%             
client [44] (test)  loss: 0.3712 -> 0.2044   acc: 90.46% -> 95.10%             
client [39] (test)  loss: 0.2823 -> 0.3152   acc: 91.19% -> 90.58%             
client [29] (test)  loss: 0.5030 -> 0.5460   acc: 85.30% -> 87.40%             
client [3] (test)  loss: 0.2590 -> 0.2308   acc: 91.37% -> 92.64%              
client [84] (test)  loss: 0.5544 -> 0.3873   acc: 85.17% -> 92.40%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6217 -> 0.4402   acc: 82.12% -> 88.18%             
client [84] (test)  loss: 0.6526 -> 0.3976   acc: 82.70% -> 91.25%             
client [10] (test)  loss: 0.2754 -> 0.2614   acc: 92.09% -> 92.72%             
client [36] (test)  loss: 0.2322 -> 0.1354   acc: 92.88% -> 96.73%             
client [65] (test)  loss: 0.5919 -> 0.4503   acc: 86.04% -> 88.31%             
client [81] (test)  loss: 0.2704 -> 0.2292   acc: 94.03% -> 92.54%             
client [79] (test)  loss: 1.1787 -> 0.5571   acc: 67.15% -> 83.86%             
client [42] (test)  loss: 0.6191 -> 0.3218   acc: 80.68% -> 91.79%             
client [11] (test)  loss: 0.2646 -> 0.0881   acc: 92.55% -> 97.52%             
client [96] (test)  loss: 0.8145 -> 0.6253   acc: 79.89% -> 84.13%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3719 -> 0.3691   acc: 89.52% -> 92.58%              
client [53] (test)  loss: 0.5741 -> 0.4634   acc: 82.72% -> 84.72%             
client [52] (test)  loss: 0.3622 -> 0.2770   acc: 90.06% -> 90.94%             
client [42] (test)  loss: 0.4459 -> 0.3305   acc: 85.51% -> 91.79%             
client [69] (test)  loss: 0.4227 -> 0.4108   acc: 88.10% -> 88.99%             
client [59] (test)  loss: 0.2966 -> 0.2752   acc: 89.08% -> 93.89%             
client [7] (test)  loss: 0.3716 -> 0.3565   acc: 87.83% -> 91.96%              
client [26] (test)  loss: 0.1992 -> 0.0937   acc: 94.54% -> 97.27%             
client [49] (test)  loss: 0.4937 -> 0.4382   acc: 84.10% -> 86.24%             
client [98] (test)  loss: 0.2534 -> 0.1524   acc: 91.84% -> 96.32%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2884 -> 0.1490   acc: 90.00% -> 96.58%             
client [47] (test)  loss: 0.7392 -> 0.3339   acc: 77.14% -> 92.31%             
client [21] (test)  loss: 0.4336 -> 0.4978   acc: 87.88% -> 87.27%             
client [77] (test)  loss: 0.3467 -> 0.3065   acc: 90.93% -> 92.19%             
client [95] (test)  loss: 0.5365 -> 0.3700   acc: 84.50% -> 91.86%             
client [91] (test)  loss: 0.1846 -> 0.1552   acc: 93.64% -> 95.42%             
client [14] (test)  loss: 0.5594 -> 0.3393   acc: 83.65% -> 89.92%             
client [99] (test)  loss: 0.2963 -> 0.2246   acc: 91.85% -> 95.93%             
client [20] (test)  loss: 0.3032 -> 0.1791   acc: 91.82% -> 95.51%             
client [39] (test)  loss: 0.3302 -> 0.3810   acc: 89.06% -> 90.27%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3284 -> 0.2910   acc: 91.52% -> 92.98%             
client [62] (test)  loss: 0.3020 -> 0.1716   acc: 92.33% -> 95.47%             
client [71] (test)  loss: 0.4062 -> 0.2975   acc: 88.89% -> 88.89%             
client [97] (test)  loss: 0.5483 -> 0.4972   acc: 84.82% -> 88.72%             
client [30] (test)  loss: 0.6516 -> 0.4940   acc: 81.78% -> 86.92%             
client [88] (test)  loss: 0.3628 -> 0.2909   acc: 89.21% -> 93.65%             
client [60] (test)  loss: 0.4562 -> 0.2746   acc: 84.85% -> 94.24%             
client [82] (test)  loss: 0.8789 -> 0.8898   acc: 79.01% -> 81.22%             
client [91] (test)  loss: 0.1628 -> 0.1554   acc: 95.17% -> 95.17%             
client [57] (test)  loss: 0.2065 -> 0.1171   acc: 93.33% -> 96.39%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4074 -> 0.4707   acc: 89.66% -> 87.71%             
client [15] (test)  loss: 0.5418 -> 0.4525   acc: 85.96% -> 90.18%             
client [71] (test)  loss: 0.5952 -> 0.2757   acc: 80.25% -> 92.59%             
client [97] (test)  loss: 0.6791 -> 0.5507   acc: 83.27% -> 88.33%             
client [53] (test)  loss: 0.7043 -> 0.4763   acc: 78.07% -> 86.38%             
client [77] (test)  loss: 0.6349 -> 0.3305   acc: 80.60% -> 93.95%             
client [76] (test)  loss: 0.9609 -> 0.3721   acc: 75.69% -> 88.85%             
client [79] (test)  loss: 0.9087 -> 0.5066   acc: 73.20% -> 85.59%             
client [28] (test)  loss: 0.5549 -> 0.1773   acc: 85.92% -> 95.49%             
client [99] (test)  loss: 0.1729 -> 0.1877   acc: 95.93% -> 94.81%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7243 -> 0.5420   acc: 82.10% -> 88.72%             
client [86] (test)  loss: 0.3834 -> 0.4132   acc: 91.43% -> 92.00%             
client [34] (test)  loss: 0.3226 -> 0.3280   acc: 91.35% -> 93.13%             
client [73] (test)  loss: 0.3642 -> 0.3597   acc: 90.48% -> 91.58%             
client [5] (test)  loss: 0.2738 -> 0.2337   acc: 94.01% -> 97.00%              
client [96] (test)  loss: 0.7208 -> 0.5551   acc: 83.86% -> 84.92%             
client [22] (test)  loss: 1.3166 -> 0.5936   acc: 71.48% -> 86.91%             
client [60] (test)  loss: 0.3525 -> 0.2618   acc: 90.30% -> 93.64%             
client [66] (test)  loss: 0.4678 -> 0.2717   acc: 89.24% -> 94.02%             
client [83] (test)  loss: 0.4618 -> 0.2704   acc: 90.74% -> 92.13%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5244 -> 0.4464   acc: 85.19% -> 88.67%             
client [65] (test)  loss: 0.4894 -> 0.5035   acc: 86.04% -> 87.01%             
client [95] (test)  loss: 0.5630 -> 0.3001   acc: 85.27% -> 93.02%             
client [17] (test)  loss: 0.3041 -> 0.2665   acc: 89.67% -> 92.10%             
client [8] (test)  loss: 0.3302 -> 0.2818   acc: 89.96% -> 95.20%              
client [35] (test)  loss: 0.1814 -> 0.1554   acc: 95.35% -> 96.64%             
client [98] (test)  loss: 0.2465 -> 0.1415   acc: 93.16% -> 95.53%             
client [53] (test)  loss: 0.5587 -> 0.4777   acc: 83.06% -> 88.04%             
client [43] (test)  loss: 0.3146 -> 0.2564   acc: 91.46% -> 90.95%             
client [64] (test)  loss: 0.3415 -> 0.2539   acc: 88.86% -> 93.14%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7035 -> 0.4841   acc: 81.21% -> 89.09%             
client [88] (test)  loss: 0.3065 -> 0.2810   acc: 89.84% -> 93.65%             
client [38] (test)  loss: 0.8624 -> 0.3986   acc: 76.80% -> 90.33%             
client [3] (test)  loss: 0.2096 -> 0.2594   acc: 93.91% -> 92.64%              
client [5] (test)  loss: 0.3366 -> 0.2311   acc: 93.78% -> 97.24%              
client [41] (test)  loss: 0.3573 -> 0.1896   acc: 89.44% -> 95.00%             
client [7] (test)  loss: 0.5393 -> 0.3655   acc: 83.04% -> 93.26%              
client [37] (test)  loss: 0.5249 -> 0.2160   acc: 86.46% -> 95.05%             
client [45] (test)  loss: 0.3622 -> 0.2623   acc: 90.96% -> 93.88%             
client [47] (test)  loss: 0.7123 -> 0.3634   acc: 80.66% -> 91.43%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2394 -> 0.2037   acc: 94.59% -> 96.40%             
client [11] (test)  loss: 0.2016 -> 0.1093   acc: 94.81% -> 97.07%             
client [37] (test)  loss: 0.3722 -> 0.2125   acc: 90.10% -> 94.79%             
client [41] (test)  loss: 0.3477 -> 0.2159   acc: 88.61% -> 94.72%             
client [95] (test)  loss: 0.5611 -> 0.2491   acc: 86.43% -> 93.41%             
client [53] (test)  loss: 0.5517 -> 0.4903   acc: 82.06% -> 87.38%             
client [22] (test)  loss: 1.1206 -> 0.4745   acc: 73.83% -> 88.93%             
client [25] (test)  loss: 0.4556 -> 0.3265   acc: 89.25% -> 93.81%             
client [69] (test)  loss: 0.3419 -> 0.3720   acc: 91.07% -> 91.37%             
client [46] (test)  loss: 0.4778 -> 0.3119   acc: 86.13% -> 91.73%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7407 -> 0.3352   acc: 78.24% -> 92.53%             
client [69] (test)  loss: 0.3345 -> 0.3629   acc: 90.48% -> 91.67%             
client [82] (test)  loss: 1.0282 -> 0.6342   acc: 76.52% -> 84.81%             
client [45] (test)  loss: 0.3951 -> 0.2767   acc: 91.49% -> 94.68%             
client [7] (test)  loss: 0.3147 -> 0.2920   acc: 90.65% -> 92.61%              
client [50] (test)  loss: 0.4119 -> 0.2128   acc: 87.39% -> 95.24%             
client [35] (test)  loss: 0.2103 -> 0.1696   acc: 94.83% -> 97.42%             
client [24] (test)  loss: 0.8628 -> 0.7236   acc: 75.80% -> 82.45%             
client [15] (test)  loss: 0.4071 -> 0.4332   acc: 91.23% -> 92.28%             
client [58] (test)  loss: 0.9367 -> 0.8241   acc: 75.82% -> 81.32%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5117 -> 0.4528   acc: 86.07% -> 86.43%             
client [76] (test)  loss: 0.5948 -> 0.4150   acc: 85.01% -> 88.85%             
client [67] (test)  loss: 0.3750 -> 0.3422   acc: 88.93% -> 91.55%             
client [37] (test)  loss: 0.4520 -> 0.1881   acc: 87.50% -> 94.79%             
client [58] (test)  loss: 0.9858 -> 0.9270   acc: 75.55% -> 80.49%             
client [64] (test)  loss: 0.2713 -> 0.1916   acc: 92.57% -> 95.14%             
client [77] (test)  loss: 0.4422 -> 0.3452   acc: 88.92% -> 94.71%             
client [55] (test)  loss: 0.4128 -> 0.2099   acc: 88.32% -> 95.33%             
client [12] (test)  loss: 0.2684 -> 0.3258   acc: 94.04% -> 93.22%             
client [89] (test)  loss: 0.3641 -> 0.2789   acc: 92.16% -> 92.79%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6313 -> 0.3499   acc: 85.74% -> 93.73%             
client [51] (test)  loss: 0.6976 -> 0.0999   acc: 81.67% -> 97.57%             
client [8] (test)  loss: 0.3452 -> 0.3219   acc: 90.83% -> 93.89%              
client [18] (test)  loss: 0.4175 -> 0.2971   acc: 89.04% -> 92.81%             
client [94] (test)  loss: 0.3029 -> 0.2053   acc: 93.42% -> 94.18%             
client [81] (test)  loss: 0.2555 -> 0.2456   acc: 94.03% -> 94.03%             
client [3] (test)  loss: 0.2105 -> 0.2429   acc: 94.16% -> 94.16%              
client [11] (test)  loss: 0.1888 -> 0.1045   acc: 94.58% -> 97.29%             
client [95] (test)  loss: 0.6543 -> 0.3055   acc: 83.72% -> 92.64%             
client [67] (test)  loss: 0.4650 -> 0.3435   acc: 88.13% -> 92.15%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4199 -> 0.4626   acc: 87.58% -> 88.79%             
client [79] (test)  loss: 0.9607 -> 0.5402   acc: 72.05% -> 84.73%             
client [58] (test)  loss: 0.8531 -> 0.9161   acc: 77.47% -> 79.95%             
client [88] (test)  loss: 0.2718 -> 0.2898   acc: 92.38% -> 93.02%             
client [46] (test)  loss: 0.3912 -> 0.2681   acc: 88.80% -> 93.60%             
client [11] (test)  loss: 0.1847 -> 0.1005   acc: 95.03% -> 97.29%             
client [55] (test)  loss: 0.5571 -> 0.2797   acc: 82.94% -> 94.86%             
client [13] (test)  loss: 0.4766 -> 0.3364   acc: 86.08% -> 92.01%             
client [31] (test)  loss: 0.4041 -> 0.4172   acc: 88.55% -> 89.66%             
client [75] (test)  loss: 0.1536 -> 0.0946   acc: 96.74% -> 98.10%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2264 -> 0.2700   acc: 95.31% -> 98.59%             
client [7] (test)  loss: 0.4207 -> 0.3511   acc: 88.70% -> 93.70%              
client [57] (test)  loss: 0.2281 -> 0.0849   acc: 95.00% -> 97.78%             
client [13] (test)  loss: 0.3714 -> 0.3035   acc: 88.92% -> 92.53%             
client [43] (test)  loss: 0.2239 -> 0.2429   acc: 91.96% -> 93.47%             
client [91] (test)  loss: 0.1773 -> 0.1286   acc: 96.69% -> 96.95%             
client [10] (test)  loss: 0.3468 -> 0.3126   acc: 92.41% -> 93.04%             
client [64] (test)  loss: 0.2446 -> 0.2221   acc: 93.43% -> 95.14%             
client [82] (test)  loss: 1.3976 -> 0.6372   acc: 73.48% -> 85.36%             
client [22] (test)  loss: 1.3458 -> 0.5982   acc: 72.15% -> 89.26%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2149 -> 0.1912   acc: 95.25% -> 95.78%             
client [23] (test)  loss: 0.4790 -> 0.3630   acc: 87.50% -> 91.88%             
client [88] (test)  loss: 0.3988 -> 0.3303   acc: 88.25% -> 91.43%             
client [98] (test)  loss: 0.1783 -> 0.1357   acc: 95.26% -> 96.32%             
client [79] (test)  loss: 0.8028 -> 0.6211   acc: 78.96% -> 84.44%             
client [21] (test)  loss: 0.6550 -> 0.5311   acc: 86.67% -> 87.88%             
client [92] (test)  loss: 0.2164 -> 0.1201   acc: 96.46% -> 97.97%             
client [56] (test)  loss: 0.3022 -> 0.3043   acc: 90.89% -> 90.15%             
client [5] (test)  loss: 0.5040 -> 0.2462   acc: 88.94% -> 96.54%              
client [52] (test)  loss: 0.2946 -> 0.2989   acc: 91.23% -> 92.98%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.5222 -> 0.0000', 'accuracy': '85.20% -> 0.00%'},          
    200: {'loss': '0.4714 -> 0.0000', 'accuracy': '88.75% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 30.0%(32.04%) at epoch: 1                                      
FedAvg achieved 50.0%(51.50%) at epoch: 2                                      
FedAvg achieved 60.0%(62.34%) at epoch: 4                                      
FedAvg achieved 70.0%(72.61%) at epoch: 7                                      
FedAvg achieved 80.0%(84.96%) at epoch: 10                                     
FedAvg achieved 90.0%(90.54%) at epoch: 67                                     
Convergence (test_after):                                                      
FedAvg achieved 60.0%(62.83%) at epoch: 0                                      
FedAvg achieved 70.0%(74.87%) at epoch: 1                                      
FedAvg achieved 80.0%(80.59%) at epoch: 3                                      
FedAvg achieved 90.0%(90.73%) at epoch: 18                                     
