==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.6550 -> 0.1314   acc: 76.28% -> 96.28%             
client [81] (test)  loss: 0.2612 -> 0.1692   acc: 92.33% -> 96.30%             
client [21] (test)  loss: 0.1728 -> 0.0862   acc: 95.73% -> 98.01%             
client [68] (test)  loss: 0.1389 -> 0.0184   acc: 95.59% -> 99.30%             
client [93] (test)  loss: 0.2055 -> 0.0517   acc: 93.27% -> 97.12%             
client [31] (test)  loss: 0.4233 -> 0.2333   acc: 87.16% -> 94.00%             
client [20] (test)  loss: 0.4311 -> 0.5570   acc: 86.11% -> 84.88%             
client [59] (test)  loss: 0.2002 -> 0.0814   acc: 96.02% -> 97.51%             
client [48] (test)  loss: 0.3948 -> 0.0762   acc: 87.26% -> 97.45%             
client [34] (test)  loss: 0.1806 -> 0.1703   acc: 95.78% -> 97.01%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.1973 -> 0.1442   acc: 95.11% -> 95.92%             
client [99] (test)  loss: 0.1322 -> 0.0616   acc: 96.13% -> 98.26%             
client [67] (test)  loss: 0.1506 -> 0.0418   acc: 95.29% -> 98.34%             
client [0] (test)  loss: 0.1202 -> 0.0183   acc: 95.95% -> 99.55%              
client [76] (test)  loss: 0.1894 -> 0.1017   acc: 94.98% -> 97.37%             
client [41] (test)  loss: 0.1335 -> 0.1124   acc: 95.74% -> 96.74%             
client [62] (test)  loss: 0.1383 -> 0.1029   acc: 95.91% -> 97.66%             
client [2] (test)  loss: 0.0748 -> 0.0417   acc: 97.83% -> 98.70%              
client [14] (test)  loss: 0.1840 -> 0.1396   acc: 94.03% -> 96.59%             
client [46] (test)  loss: 0.0977 -> 0.0905   acc: 95.28% -> 97.42%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.0984 -> 0.0767   acc: 96.69% -> 97.52%             
client [68] (test)  loss: 0.0464 -> 0.0127   acc: 98.14% -> 99.77%             
client [57] (test)  loss: 0.1047 -> 0.0779   acc: 97.14% -> 97.14%             
client [17] (test)  loss: 0.0804 -> 0.0459   acc: 98.23% -> 98.94%             
client [54] (test)  loss: 0.0962 -> 0.0184   acc: 97.49% -> 99.25%             
client [23] (test)  loss: 0.0896 -> 0.0316   acc: 97.23% -> 98.81%             
client [35] (test)  loss: 0.1007 -> 0.0733   acc: 96.90% -> 97.59%             
client [59] (test)  loss: 0.0123 -> 0.0258   acc: 100.00% -> 99.00%            
client [31] (test)  loss: 0.1731 -> 0.1343   acc: 96.27% -> 96.89%             
client [9] (test)  loss: 0.0999 -> 0.0598   acc: 97.41% -> 98.28%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1031 -> 0.0763   acc: 96.81% -> 98.23%             
client [33] (test)  loss: 0.0741 -> 0.0668   acc: 98.06% -> 98.61%             
client [16] (test)  loss: 0.1235 -> 0.1339   acc: 96.08% -> 96.86%             
client [44] (test)  loss: 0.0809 -> 0.0692   acc: 98.38% -> 98.38%             
client [8] (test)  loss: 0.1661 -> 0.0760   acc: 96.89% -> 97.52%              
client [31] (test)  loss: 0.1508 -> 0.1322   acc: 96.27% -> 97.31%             
client [47] (test)  loss: 0.0675 -> 0.0323   acc: 98.33% -> 99.07%             
client [36] (test)  loss: 0.1540 -> 0.0649   acc: 95.91% -> 98.06%             
client [20] (test)  loss: 0.1319 -> 0.0666   acc: 96.60% -> 98.15%             
client [56] (test)  loss: 0.0836 -> 0.0737   acc: 97.08% -> 98.33%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1005 -> 0.0600   acc: 97.42% -> 98.57%              
client [60] (test)  loss: 0.0173 -> 0.0145   acc: 99.39% -> 99.70%             
client [28] (test)  loss: 0.0653 -> 0.0196   acc: 98.02% -> 99.15%             
client [25] (test)  loss: 0.1147 -> 0.1188   acc: 97.04% -> 97.04%             
client [58] (test)  loss: 0.0919 -> 0.0595   acc: 97.42% -> 98.52%             
client [44] (test)  loss: 0.0661 -> 0.0793   acc: 98.58% -> 98.18%             
client [39] (test)  loss: 0.0404 -> 0.0175   acc: 98.57% -> 99.43%             
client [29] (test)  loss: 0.1565 -> 0.0837   acc: 96.13% -> 97.85%             
client [3] (test)  loss: 0.0959 -> 0.1143   acc: 97.64% -> 97.64%              
client [84] (test)  loss: 0.0425 -> 0.0503   acc: 98.78% -> 98.57%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0214 -> 0.0123   acc: 99.15% -> 99.72%             
client [84] (test)  loss: 0.0524 -> 0.0526   acc: 98.17% -> 98.57%             
client [10] (test)  loss: 0.0472 -> 0.0390   acc: 99.26% -> 98.77%             
client [36] (test)  loss: 0.0902 -> 0.0284   acc: 97.63% -> 99.14%             
client [65] (test)  loss: 0.0414 -> 0.0281   acc: 98.70% -> 99.48%             
client [81] (test)  loss: 0.0759 -> 0.0897   acc: 97.62% -> 98.15%             
client [79] (test)  loss: 0.0543 -> 0.0446   acc: 98.56% -> 99.14%             
client [42] (test)  loss: 0.0720 -> 0.0418   acc: 98.00% -> 98.75%             
client [11] (test)  loss: 0.0660 -> 0.0474   acc: 97.75% -> 98.60%             
client [96] (test)  loss: 0.0512 -> 0.0196   acc: 98.60% -> 99.16%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1007 -> 0.0879   acc: 97.52% -> 98.14%              
client [53] (test)  loss: 0.0992 -> 0.1030   acc: 96.89% -> 96.89%             
client [52] (test)  loss: 0.1241 -> 0.1084   acc: 97.54% -> 96.55%             
client [42] (test)  loss: 0.0575 -> 0.0429   acc: 98.75% -> 99.00%             
client [69] (test)  loss: 0.0802 -> 0.0580   acc: 97.83% -> 98.10%             
client [59] (test)  loss: 0.0071 -> 0.0186   acc: 100.00% -> 99.50%            
client [7] (test)  loss: 0.0679 -> 0.0469   acc: 98.47% -> 98.98%              
client [26] (test)  loss: 0.0552 -> 0.0475   acc: 98.02% -> 98.02%             
client [49] (test)  loss: 0.0719 -> 0.0736   acc: 98.16% -> 98.77%             
client [98] (test)  loss: 0.0523 -> 0.0321   acc: 97.14% -> 98.78%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.0503 -> 0.0385   acc: 97.55% -> 99.18%             
client [47] (test)  loss: 0.0401 -> 0.0079   acc: 98.89% -> 99.63%             
client [21] (test)  loss: 0.0166 -> 0.0075   acc: 99.43% -> 99.72%             
client [77] (test)  loss: 0.0506 -> 0.1046   acc: 98.14% -> 97.67%             
client [95] (test)  loss: 0.1078 -> 0.0374   acc: 97.01% -> 98.50%             
client [91] (test)  loss: 0.0470 -> 0.0218   acc: 98.73% -> 99.16%             
client [14] (test)  loss: 0.0796 -> 0.0750   acc: 97.73% -> 98.86%             
client [99] (test)  loss: 0.0649 -> 0.0250   acc: 97.68% -> 99.23%             
client [20] (test)  loss: 0.1005 -> 0.0518   acc: 97.22% -> 98.77%             
client [39] (test)  loss: 0.0309 -> 0.0196   acc: 98.86% -> 99.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1605 -> 0.1050   acc: 97.04% -> 96.55%             
client [62] (test)  loss: 0.0744 -> 0.0726   acc: 97.95% -> 98.54%             
client [71] (test)  loss: 0.0697 -> 0.0267   acc: 96.97% -> 99.49%             
client [97] (test)  loss: 0.0969 -> 0.0408   acc: 97.69% -> 99.16%             
client [30] (test)  loss: 0.0495 -> 0.0366   acc: 98.26% -> 99.13%             
client [88] (test)  loss: 0.0644 -> 0.0646   acc: 98.22% -> 97.78%             
client [60] (test)  loss: 0.0173 -> 0.0682   acc: 99.70% -> 98.48%             
client [82] (test)  loss: 0.0422 -> 0.0090   acc: 99.17% -> 99.45%             
client [91] (test)  loss: 0.0190 -> 0.0208   acc: 99.16% -> 99.16%             
client [57] (test)  loss: 0.0669 -> 0.0424   acc: 98.10% -> 99.52%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0935 -> 0.0880   acc: 97.93% -> 98.34%             
client [15] (test)  loss: 0.0869 -> 0.0894   acc: 98.08% -> 97.80%             
client [71] (test)  loss: 0.0533 -> 0.0295   acc: 98.48% -> 99.49%             
client [97] (test)  loss: 0.0691 -> 0.0409   acc: 98.74% -> 99.16%             
client [53] (test)  loss: 0.0942 -> 0.1013   acc: 96.89% -> 96.89%             
client [77] (test)  loss: 0.0495 -> 0.0452   acc: 98.60% -> 99.07%             
client [76] (test)  loss: 0.0602 -> 0.0454   acc: 98.80% -> 98.80%             
client [79] (test)  loss: 0.0417 -> 0.0414   acc: 99.14% -> 99.43%             
client [28] (test)  loss: 0.0304 -> 0.0087   acc: 98.58% -> 99.72%             
client [99] (test)  loss: 0.0459 -> 0.0288   acc: 98.65% -> 99.42%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0845 -> 0.0514   acc: 98.32% -> 98.95%             
client [86] (test)  loss: 0.0611 -> 0.0601   acc: 99.10% -> 99.10%             
client [34] (test)  loss: 0.1985 -> 0.1675   acc: 97.36% -> 97.54%             
client [73] (test)  loss: 0.0299 -> 0.0320   acc: 98.98% -> 99.49%             
client [5] (test)  loss: 0.0530 -> 0.0442   acc: 98.24% -> 98.99%              
client [96] (test)  loss: 0.0366 -> 0.0215   acc: 98.60% -> 99.16%             
client [22] (test)  loss: 0.1112 -> 0.0531   acc: 97.16% -> 98.58%             
client [60] (test)  loss: 0.0201 -> 0.0187   acc: 98.78% -> 99.09%             
client [66] (test)  loss: 0.0165 -> 0.0094   acc: 99.41% -> 99.80%             
client [83] (test)  loss: 0.1265 -> 0.1618   acc: 97.30% -> 96.53%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0739 -> 0.0370   acc: 98.80% -> 99.28%             
client [65] (test)  loss: 0.0306 -> 0.0281   acc: 99.22% -> 99.48%             
client [95] (test)  loss: 0.0730 -> 0.0203   acc: 97.51% -> 99.25%             
client [17] (test)  loss: 0.0302 -> 0.0811   acc: 99.29% -> 98.58%             
client [8] (test)  loss: 0.0614 -> 0.0473   acc: 98.76% -> 98.76%              
client [35] (test)  loss: 0.0786 -> 0.0639   acc: 97.59% -> 98.28%             
client [98] (test)  loss: 0.0374 -> 0.0249   acc: 97.96% -> 99.18%             
client [53] (test)  loss: 0.1018 -> 0.1021   acc: 96.89% -> 97.23%             
client [43] (test)  loss: 0.0888 -> 0.0827   acc: 98.98% -> 98.98%             
client [64] (test)  loss: 0.0312 -> 0.0401   acc: 99.29% -> 98.58%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0033 -> 0.0018   acc: 100.00% -> 100.00%           
client [88] (test)  loss: 0.0722 -> 0.0660   acc: 98.67% -> 98.67%             
client [38] (test)  loss: 0.0251 -> 0.0178   acc: 99.50% -> 99.25%             
client [3] (test)  loss: 0.1212 -> 0.1110   acc: 97.17% -> 98.11%              
client [5] (test)  loss: 0.0549 -> 0.0479   acc: 98.74% -> 98.99%              
client [41] (test)  loss: 0.0603 -> 0.0327   acc: 98.75% -> 99.25%             
client [7] (test)  loss: 0.0431 -> 0.0546   acc: 98.21% -> 98.98%              
client [37] (test)  loss: 0.1850 -> 0.1294   acc: 97.13% -> 98.09%             
client [45] (test)  loss: 0.0774 -> 0.0311   acc: 97.53% -> 99.45%             
client [47] (test)  loss: 0.0362 -> 0.0103   acc: 99.07% -> 99.44%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0850 -> 0.0951   acc: 97.65% -> 97.65%             
client [11] (test)  loss: 0.0856 -> 0.0350   acc: 97.75% -> 99.16%             
client [37] (test)  loss: 0.1777 -> 0.1233   acc: 96.82% -> 97.77%             
client [41] (test)  loss: 0.0542 -> 0.0362   acc: 99.00% -> 99.00%             
client [95] (test)  loss: 0.0596 -> 0.0181   acc: 97.76% -> 99.00%             
client [53] (test)  loss: 0.0987 -> 0.1023   acc: 97.23% -> 96.89%             
client [22] (test)  loss: 0.0707 -> 0.0397   acc: 98.86% -> 99.15%             
client [25] (test)  loss: 0.0856 -> 0.1084   acc: 97.63% -> 98.22%             
client [69] (test)  loss: 0.0721 -> 0.0491   acc: 97.83% -> 98.64%             
client [46] (test)  loss: 0.0203 -> 0.0326   acc: 99.57% -> 98.71%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0332 -> 0.0217   acc: 99.26% -> 99.44%             
client [69] (test)  loss: 0.0525 -> 0.0466   acc: 98.37% -> 98.64%             
client [82] (test)  loss: 0.0495 -> 0.0100   acc: 99.45% -> 99.72%             
client [45] (test)  loss: 0.0768 -> 0.0533   acc: 98.35% -> 99.45%             
client [7] (test)  loss: 0.0454 -> 0.0324   acc: 98.21% -> 98.98%              
client [50] (test)  loss: 0.0553 -> 0.0548   acc: 98.55% -> 99.03%             
client [35] (test)  loss: 0.0686 -> 0.0628   acc: 97.93% -> 98.62%             
client [24] (test)  loss: 0.1077 -> 0.1067   acc: 97.25% -> 98.07%             
client [15] (test)  loss: 0.0921 -> 0.0718   acc: 98.35% -> 98.35%             
client [58] (test)  loss: 0.0584 -> 0.0435   acc: 98.71% -> 98.89%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0512 -> 0.0506   acc: 98.73% -> 99.36%             
client [76] (test)  loss: 0.0648 -> 0.0359   acc: 98.80% -> 98.80%             
client [67] (test)  loss: 0.0159 -> 0.0046   acc: 99.17% -> 100.00%            
client [37] (test)  loss: 0.1652 -> 0.1336   acc: 97.45% -> 97.77%             
client [58] (test)  loss: 0.0591 -> 0.0431   acc: 98.71% -> 98.71%             
client [64] (test)  loss: 0.0266 -> 0.0342   acc: 99.29% -> 98.94%             
client [77] (test)  loss: 0.0627 -> 0.0634   acc: 98.60% -> 98.60%             
client [55] (test)  loss: 0.0473 -> 0.0273   acc: 98.74% -> 99.16%             
client [12] (test)  loss: 0.0861 -> 0.0758   acc: 98.35% -> 98.02%             
client [89] (test)  loss: 0.0610 -> 0.0508   acc: 98.51% -> 98.51%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0410 -> 0.0318   acc: 99.19% -> 99.59%             
client [51] (test)  loss: 0.0270 -> 0.0165   acc: 99.50% -> 99.50%             
client [8] (test)  loss: 0.1078 -> 0.0924   acc: 96.89% -> 98.14%              
client [18] (test)  loss: 0.0593 -> 0.0385   acc: 98.70% -> 98.96%             
client [94] (test)  loss: 0.0723 -> 0.0638   acc: 98.53% -> 98.77%             
client [81] (test)  loss: 0.0744 -> 0.0938   acc: 98.41% -> 98.15%             
client [3] (test)  loss: 0.1085 -> 0.0968   acc: 97.64% -> 98.11%              
client [11] (test)  loss: 0.0781 -> 0.0482   acc: 98.03% -> 98.60%             
client [95] (test)  loss: 0.0646 -> 0.0188   acc: 97.76% -> 99.00%             
client [67] (test)  loss: 0.0341 -> 0.0067   acc: 98.89% -> 100.00%            
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0061 -> 0.0055   acc: 99.72% -> 99.72%             
client [79] (test)  loss: 0.0458 -> 0.0415   acc: 99.14% -> 99.71%             
client [58] (test)  loss: 0.0928 -> 0.0405   acc: 97.97% -> 98.71%             
client [88] (test)  loss: 0.0771 -> 0.0750   acc: 98.67% -> 98.67%             
client [46] (test)  loss: 0.0252 -> 0.0143   acc: 99.14% -> 99.14%             
client [11] (test)  loss: 0.0695 -> 0.0479   acc: 98.60% -> 98.60%             
client [55] (test)  loss: 0.0373 -> 0.0175   acc: 98.95% -> 99.58%             
client [13] (test)  loss: 0.0396 -> 0.0152   acc: 98.38% -> 98.92%             
client [31] (test)  loss: 0.0999 -> 0.0899   acc: 98.14% -> 98.76%             
client [75] (test)  loss: 0.1037 -> 0.0997   acc: 97.73% -> 97.73%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0560 -> 0.0203   acc: 98.89% -> 98.89%             
client [7] (test)  loss: 0.0403 -> 0.0260   acc: 98.21% -> 98.72%              
client [57] (test)  loss: 0.0298 -> 0.0173   acc: 99.05% -> 99.52%             
client [13] (test)  loss: 0.0631 -> 0.0220   acc: 98.65% -> 99.19%             
client [43] (test)  loss: 0.1001 -> 0.0902   acc: 98.98% -> 99.32%             
client [91] (test)  loss: 0.0209 -> 0.0235   acc: 99.58% -> 99.16%             
client [10] (test)  loss: 0.0540 -> 0.0288   acc: 98.77% -> 99.51%             
client [64] (test)  loss: 0.0280 -> 0.0255   acc: 99.29% -> 99.29%             
client [82] (test)  loss: 0.0407 -> 0.0039   acc: 99.45% -> 99.72%             
client [22] (test)  loss: 0.0793 -> 0.0706   acc: 98.58% -> 98.86%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0801 -> 0.0647   acc: 97.84% -> 98.46%             
client [23] (test)  loss: 0.0445 -> 0.0391   acc: 99.21% -> 99.21%             
client [88] (test)  loss: 0.0737 -> 0.0690   acc: 98.67% -> 98.67%             
client [98] (test)  loss: 0.0378 -> 0.0272   acc: 98.37% -> 98.37%             
client [79] (test)  loss: 0.0346 -> 0.0435   acc: 99.43% -> 99.43%             
client [21] (test)  loss: 0.0075 -> 0.0010   acc: 99.43% -> 100.00%            
client [92] (test)  loss: 0.0150 -> 0.0344   acc: 99.21% -> 98.41%             
client [56] (test)  loss: 0.0210 -> 0.0224   acc: 99.37% -> 99.37%             
client [5] (test)  loss: 0.0607 -> 0.0608   acc: 98.74% -> 98.74%              
client [52] (test)  loss: 0.1552 -> 0.1800   acc: 97.04% -> 97.04%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.0638 -> 0.0000', 'accuracy': '98.42% -> 0.00%'},          
    200: {'loss': '0.0634 -> 0.0000', 'accuracy': '98.67% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(15.65%) at epoch: 1                                      
FedAvg achieved 50.0%(51.07%) at epoch: 2                                      
FedAvg achieved 70.0%(74.79%) at epoch: 3                                      
FedAvg achieved 80.0%(86.88%) at epoch: 5                                      
FedAvg achieved 90.0%(90.44%) at epoch: 6                                      
Convergence (test_after):                                                      
FedAvg achieved 40.0%(43.84%) at epoch: 0                                      
FedAvg achieved 70.0%(74.37%) at epoch: 1                                      
FedAvg achieved 80.0%(85.92%) at epoch: 3                                      
FedAvg achieved 90.0%(94.16%) at epoch: 4                                      
