==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedVGG11',                                                  
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.001,                                                         
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7486 -> 0.5493   acc: 77.61% -> 81.48%             
client [81] (test)  loss: 0.4749 -> 0.3505   acc: 84.96% -> 86.92%             
client [21] (test)  loss: 0.2744 -> 0.1405   acc: 93.10% -> 95.42%             
client [68] (test)  loss: 0.2603 -> 0.0701   acc: 92.02% -> 98.02%             
client [93] (test)  loss: 0.5287 -> 0.2944   acc: 83.51% -> 92.75%             
client [31] (test)  loss: 0.6126 -> 0.4708   acc: 80.80% -> 84.04%             
client [20] (test)  loss: 0.7428 -> 0.5473   acc: 76.66% -> 84.44%             
client [59] (test)  loss: 0.6398 -> 0.4345   acc: 77.89% -> 83.42%             
client [48] (test)  loss: 0.6245 -> 0.4379   acc: 76.70% -> 84.26%             
client [34] (test)  loss: 0.5630 -> 0.4364   acc: 85.55% -> 87.61%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3555 -> 0.1930   acc: 86.30% -> 95.58%             
client [99] (test)  loss: 0.8879 -> 0.3378   acc: 73.59% -> 90.03%             
client [67] (test)  loss: 0.6384 -> 0.3857   acc: 80.58% -> 87.60%             
client [0] (test)  loss: 0.3742 -> 0.1707   acc: 88.79% -> 95.16%              
client [76] (test)  loss: 0.9969 -> 0.4148   acc: 77.05% -> 86.60%             
client [41] (test)  loss: 1.9487 -> 0.5934   acc: 49.73% -> 81.07%             
client [62] (test)  loss: 1.3142 -> 0.5351   acc: 69.87% -> 82.53%             
client [2] (test)  loss: 0.2409 -> 0.1924   acc: 92.75% -> 92.96%              
client [14] (test)  loss: 0.5119 -> 0.2993   acc: 84.05% -> 92.44%             
client [46] (test)  loss: 0.6252 -> 0.4001   acc: 82.48% -> 87.88%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3506 -> 0.1786   acc: 89.37% -> 95.85%             
client [68] (test)  loss: 0.1951 -> 0.0471   acc: 93.78% -> 98.90%             
client [57] (test)  loss: 0.2427 -> 0.1975   acc: 93.38% -> 94.19%             
client [17] (test)  loss: 0.2945 -> 0.1230   acc: 90.97% -> 96.29%             
client [54] (test)  loss: 0.5557 -> 0.4066   acc: 84.47% -> 88.31%             
client [23] (test)  loss: 0.5546 -> 0.3632   acc: 80.93% -> 87.08%             
client [35] (test)  loss: 1.8674 -> 0.5020   acc: 58.44% -> 84.38%             
client [59] (test)  loss: 0.6411 -> 0.3851   acc: 79.37% -> 85.19%             
client [31] (test)  loss: 0.5042 -> 0.3967   acc: 84.16% -> 86.98%             
client [9] (test)  loss: 2.1321 -> 0.7292   acc: 56.23% -> 77.40%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8117 -> 0.4750   acc: 76.53% -> 82.39%             
client [33] (test)  loss: 0.7393 -> 0.5029   acc: 77.73% -> 83.29%             
client [16] (test)  loss: 0.4478 -> 0.2999   acc: 87.20% -> 92.40%             
client [44] (test)  loss: 1.0821 -> 0.6326   acc: 71.00% -> 78.09%             
client [8] (test)  loss: 0.7381 -> 0.4677   acc: 81.04% -> 86.72%              
client [31] (test)  loss: 0.5305 -> 0.3824   acc: 85.05% -> 87.45%             
client [47] (test)  loss: 0.4689 -> 0.2971   acc: 84.34% -> 90.28%             
client [36] (test)  loss: 0.5985 -> 0.4256   acc: 83.08% -> 86.56%             
client [20] (test)  loss: 0.7548 -> 0.4421   acc: 79.51% -> 87.26%             
client [56] (test)  loss: 1.0400 -> 0.4137   acc: 69.18% -> 87.11%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2767 -> 0.2566   acc: 92.91% -> 93.44%              
client [60] (test)  loss: 0.5012 -> 0.2432   acc: 81.32% -> 93.37%             
client [28] (test)  loss: 0.6033 -> 0.4053   acc: 84.46% -> 87.40%             
client [25] (test)  loss: 0.2604 -> 0.0210   acc: 91.65% -> 99.54%             
client [58] (test)  loss: 0.2109 -> 0.1165   acc: 93.25% -> 96.90%             
client [44] (test)  loss: 0.8671 -> 0.6444   acc: 73.38% -> 78.31%             
client [39] (test)  loss: 0.3945 -> 0.3275   acc: 88.16% -> 91.09%             
client [29] (test)  loss: 1.0553 -> 0.5157   acc: 70.29% -> 81.92%             
client [3] (test)  loss: 0.4362 -> 0.2295   acc: 86.40% -> 93.78%              
client [84] (test)  loss: 0.4115 -> 0.2214   acc: 86.45% -> 94.15%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2931 -> 0.0966   acc: 92.05% -> 96.99%             
client [84] (test)  loss: 0.5030 -> 0.2327   acc: 81.09% -> 94.29%             
client [10] (test)  loss: 0.6378 -> 0.4035   acc: 81.94% -> 88.33%             
client [36] (test)  loss: 0.4943 -> 0.3816   acc: 83.30% -> 87.96%             
client [65] (test)  loss: 1.0493 -> 0.5121   acc: 62.37% -> 82.71%             
client [81] (test)  loss: 0.4307 -> 0.2948   acc: 84.60% -> 89.28%             
client [79] (test)  loss: 0.5676 -> 0.3248   acc: 84.27% -> 91.15%             
client [42] (test)  loss: 0.2676 -> 0.1744   acc: 90.80% -> 95.38%             
client [11] (test)  loss: 0.5725 -> 0.3513   acc: 84.27% -> 88.91%             
client [96] (test)  loss: 0.6255 -> 0.3428   acc: 79.75% -> 89.55%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8912 -> 0.4575   acc: 77.75% -> 86.69%              
client [53] (test)  loss: 0.9495 -> 0.4798   acc: 76.38% -> 85.31%             
client [52] (test)  loss: 0.9090 -> 0.4453   acc: 77.28% -> 86.78%             
client [42] (test)  loss: 0.2919 -> 0.1718   acc: 89.71% -> 95.65%             
client [69] (test)  loss: 0.2047 -> 0.1678   acc: 94.32% -> 96.35%             
client [59] (test)  loss: 0.7748 -> 0.3695   acc: 80.59% -> 86.01%             
client [7] (test)  loss: 0.5304 -> 0.3113   acc: 83.19% -> 89.55%              
client [26] (test)  loss: 0.2628 -> 0.1700   acc: 90.40% -> 93.37%             
client [49] (test)  loss: 0.1872 -> 0.1265   acc: 95.16% -> 96.78%             
client [98] (test)  loss: 0.1754 -> 0.0974   acc: 94.43% -> 97.02%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1626 -> 0.0921   acc: 95.69% -> 97.14%             
client [47] (test)  loss: 0.5066 -> 0.2876   acc: 82.39% -> 90.50%             
client [21] (test)  loss: 0.1951 -> 0.0980   acc: 94.49% -> 96.79%             
client [77] (test)  loss: 0.6633 -> 0.4829   acc: 82.72% -> 84.43%             
client [95] (test)  loss: 0.2228 -> 0.0667   acc: 92.99% -> 98.77%             
client [91] (test)  loss: 0.7453 -> 0.4071   acc: 78.26% -> 86.93%             
client [14] (test)  loss: 0.3275 -> 0.2712   acc: 90.73% -> 93.45%             
client [99] (test)  loss: 0.7740 -> 0.3265   acc: 79.90% -> 91.41%             
client [20] (test)  loss: 0.7635 -> 0.4244   acc: 79.46% -> 88.29%             
client [39] (test)  loss: 0.4015 -> 0.3017   acc: 88.33% -> 92.14%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6739 -> 0.4505   acc: 78.40% -> 86.83%             
client [62] (test)  loss: 0.8924 -> 0.5292   acc: 75.98% -> 84.79%             
client [71] (test)  loss: 0.7683 -> 0.5269   acc: 71.49% -> 83.78%             
client [97] (test)  loss: 0.3349 -> 0.1281   acc: 86.92% -> 96.19%             
client [30] (test)  loss: 0.2815 -> 0.2428   acc: 91.15% -> 93.40%             
client [88] (test)  loss: 0.4565 -> 0.2843   acc: 84.85% -> 89.07%             
client [60] (test)  loss: 0.5027 -> 0.2539   acc: 81.37% -> 93.51%             
client [82] (test)  loss: 0.7251 -> 0.3971   acc: 80.58% -> 87.77%             
client [91] (test)  loss: 0.5464 -> 0.4334   acc: 81.65% -> 86.64%             
client [57] (test)  loss: 0.3385 -> 0.1745   acc: 88.70% -> 95.12%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5632 -> 0.4069   acc: 84.14% -> 88.50%             
client [15] (test)  loss: 0.8568 -> 0.4808   acc: 76.75% -> 86.48%             
client [71] (test)  loss: 0.9110 -> 0.5159   acc: 73.76% -> 83.51%             
client [97] (test)  loss: 0.2364 -> 0.1260   acc: 92.61% -> 96.62%             
client [53] (test)  loss: 0.8784 -> 0.4947   acc: 76.94% -> 85.36%             
client [77] (test)  loss: 0.7231 -> 0.5113   acc: 81.22% -> 84.74%             
client [76] (test)  loss: 0.9386 -> 0.3980   acc: 72.36% -> 88.68%             
client [79] (test)  loss: 0.6288 -> 0.3177   acc: 84.81% -> 91.12%             
client [28] (test)  loss: 0.7091 -> 0.4161   acc: 82.18% -> 87.49%             
client [99] (test)  loss: 0.6205 -> 0.3241   acc: 84.98% -> 91.92%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2943 -> 0.1300   acc: 90.44% -> 96.52%             
client [86] (test)  loss: 0.3830 -> 0.2354   acc: 89.10% -> 94.21%             
client [34] (test)  loss: 0.5487 -> 0.3647   acc: 84.65% -> 90.70%             
client [73] (test)  loss: 0.6813 -> 0.5791   acc: 79.49% -> 83.25%             
client [5] (test)  loss: 0.7986 -> 0.4235   acc: 77.22% -> 89.38%              
client [96] (test)  loss: 0.5618 -> 0.3801   acc: 82.13% -> 89.65%             
client [22] (test)  loss: 0.8367 -> 0.6180   acc: 76.62% -> 82.67%             
client [60] (test)  loss: 0.5268 -> 0.2667   acc: 81.34% -> 93.42%             
client [66] (test)  loss: 0.4716 -> 0.3259   acc: 85.70% -> 91.04%             
client [83] (test)  loss: 0.3901 -> 0.1260   acc: 87.77% -> 96.53%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6862 -> 0.4154   acc: 81.32% -> 88.66%             
client [65] (test)  loss: 1.4772 -> 0.4939   acc: 59.42% -> 83.86%             
client [95] (test)  loss: 0.3069 -> 0.0626   acc: 90.50% -> 98.84%             
client [17] (test)  loss: 0.3578 -> 0.0918   acc: 90.13% -> 97.35%             
client [8] (test)  loss: 0.7477 -> 0.4739   acc: 82.38% -> 86.88%              
client [35] (test)  loss: 1.7461 -> 0.5883   acc: 60.29% -> 84.56%             
client [98] (test)  loss: 0.1825 -> 0.0932   acc: 95.08% -> 97.41%             
client [53] (test)  loss: 0.9677 -> 0.5149   acc: 76.57% -> 85.31%             
client [43] (test)  loss: 0.3647 -> 0.2329   acc: 90.20% -> 94.27%             
client [64] (test)  loss: 0.7323 -> 0.4456   acc: 76.56% -> 84.50%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3604 -> 0.1082   acc: 87.72% -> 96.94%             
client [88] (test)  loss: 0.4549 -> 0.3187   acc: 86.13% -> 89.04%             
client [38] (test)  loss: 0.1790 -> 0.0881   acc: 95.75% -> 98.57%             
client [3] (test)  loss: 0.4670 -> 0.2287   acc: 88.43% -> 94.80%              
client [5] (test)  loss: 1.0051 -> 0.4325   acc: 76.69% -> 88.90%              
client [41] (test)  loss: 1.2159 -> 0.5810   acc: 62.03% -> 82.84%             
client [7] (test)  loss: 0.3816 -> 0.3218   acc: 88.49% -> 90.04%              
client [37] (test)  loss: 0.6503 -> 0.4060   acc: 82.83% -> 89.59%             
client [45] (test)  loss: 0.9612 -> 0.5257   acc: 76.63% -> 85.16%             
client [47] (test)  loss: 0.4288 -> 0.2980   acc: 84.46% -> 90.54%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4494 -> 0.3010   acc: 89.31% -> 93.08%             
client [11] (test)  loss: 0.6503 -> 0.3128   acc: 83.88% -> 91.66%             
client [37] (test)  loss: 0.6007 -> 0.4260   acc: 84.78% -> 89.20%             
client [41] (test)  loss: 1.5855 -> 0.5733   acc: 55.49% -> 82.17%             
client [95] (test)  loss: 0.2172 -> 0.0593   acc: 92.65% -> 98.94%             
client [53] (test)  loss: 1.0385 -> 0.5178   acc: 76.91% -> 85.57%             
client [22] (test)  loss: 0.9824 -> 0.6277   acc: 76.25% -> 82.92%             
client [25] (test)  loss: 0.2613 -> 0.0151   acc: 91.23% -> 99.58%             
client [69] (test)  loss: 0.3159 -> 0.1662   acc: 89.97% -> 96.33%             
client [46] (test)  loss: 0.4921 -> 0.3482   acc: 87.64% -> 89.87%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4117 -> 0.3348   acc: 84.87% -> 90.71%             
client [69] (test)  loss: 0.3626 -> 0.1674   acc: 88.46% -> 96.73%             
client [82] (test)  loss: 0.8290 -> 0.4378   acc: 82.28% -> 87.98%             
client [45] (test)  loss: 1.0331 -> 0.5228   acc: 77.81% -> 85.30%             
client [7] (test)  loss: 0.3994 -> 0.3259   acc: 88.20% -> 89.46%              
client [50] (test)  loss: 0.5406 -> 0.3686   acc: 88.24% -> 89.65%             
client [35] (test)  loss: 1.3234 -> 0.6198   acc: 63.43% -> 84.75%             
client [24] (test)  loss: 0.3140 -> 0.1844   acc: 92.08% -> 96.88%             
client [15] (test)  loss: 0.8426 -> 0.5035   acc: 77.55% -> 86.57%             
client [58] (test)  loss: 0.2129 -> 0.1471   acc: 93.81% -> 96.56%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5685 -> 0.3965   acc: 80.88% -> 87.20%             
client [76] (test)  loss: 0.7689 -> 0.4398   acc: 77.05% -> 88.95%             
client [67] (test)  loss: 0.4820 -> 0.3683   acc: 85.35% -> 90.56%             
client [37] (test)  loss: 0.4956 -> 0.4196   acc: 85.93% -> 89.52%             
client [58] (test)  loss: 0.3358 -> 0.1541   acc: 89.71% -> 96.71%             
client [64] (test)  loss: 0.6084 -> 0.4910   acc: 81.29% -> 84.18%             
client [77] (test)  loss: 0.6127 -> 0.5234   acc: 82.03% -> 85.26%             
client [55] (test)  loss: 0.6137 -> 0.4760   acc: 79.67% -> 85.46%             
client [12] (test)  loss: 0.6860 -> 0.5523   acc: 79.35% -> 86.17%             
client [89] (test)  loss: 0.7118 -> 0.5976   acc: 79.51% -> 85.40%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3864 -> 0.2643   acc: 88.54% -> 95.12%             
client [51] (test)  loss: 0.3495 -> 0.2554   acc: 90.26% -> 94.81%             
client [8] (test)  loss: 0.8314 -> 0.5053   acc: 82.53% -> 87.09%              
client [18] (test)  loss: 1.3427 -> 0.4957   acc: 72.06% -> 84.90%             
client [94] (test)  loss: 0.8503 -> 0.4706   acc: 82.56% -> 88.49%             
client [81] (test)  loss: 0.4039 -> 0.3394   acc: 87.57% -> 89.04%             
client [3] (test)  loss: 0.4660 -> 0.2266   acc: 87.99% -> 95.02%              
client [11] (test)  loss: 0.6868 -> 0.3144   acc: 84.91% -> 91.73%             
client [95] (test)  loss: 0.2382 -> 0.0629   acc: 92.53% -> 98.84%             
client [67] (test)  loss: 0.6406 -> 0.3637   acc: 84.12% -> 90.63%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2209 -> 0.1127   acc: 94.32% -> 96.75%             
client [79] (test)  loss: 0.6377 -> 0.3212   acc: 84.99% -> 92.14%             
client [58] (test)  loss: 0.1986 -> 0.1696   acc: 94.15% -> 96.63%             
client [88] (test)  loss: 0.4804 -> 0.3468   acc: 85.48% -> 88.73%             
client [46] (test)  loss: 0.4764 -> 0.3617   acc: 87.14% -> 90.06%             
client [11] (test)  loss: 0.6033 -> 0.3233   acc: 84.27% -> 91.95%             
client [55] (test)  loss: 0.5985 -> 0.5338   acc: 82.93% -> 86.22%             
client [13] (test)  loss: 0.7005 -> 0.5411   acc: 81.77% -> 84.03%             
client [31] (test)  loss: 0.5390 -> 0.4104   acc: 85.54% -> 88.75%             
client [75] (test)  loss: 0.8790 -> 0.5315   acc: 77.51% -> 86.50%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3389 -> 0.1812   acc: 90.24% -> 96.41%             
client [7] (test)  loss: 0.4453 -> 0.3536   acc: 86.17% -> 89.33%              
client [57] (test)  loss: 0.3991 -> 0.1917   acc: 85.51% -> 95.29%             
client [13] (test)  loss: 0.6576 -> 0.5706   acc: 81.04% -> 83.64%             
client [43] (test)  loss: 0.4570 -> 0.2508   acc: 86.27% -> 94.43%             
client [91] (test)  loss: 0.6930 -> 0.4775   acc: 78.65% -> 86.88%             
client [10] (test)  loss: 0.6820 -> 0.4999   acc: 82.05% -> 88.01%             
client [64] (test)  loss: 0.7543 -> 0.5583   acc: 76.14% -> 84.21%             
client [82] (test)  loss: 0.6876 -> 0.4822   acc: 80.95% -> 87.89%             
client [22] (test)  loss: 0.8904 -> 0.6541   acc: 75.54% -> 83.38%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8528 -> 0.4512   acc: 81.60% -> 89.13%             
client [23] (test)  loss: 0.6067 -> 0.3946   acc: 83.62% -> 88.02%             
client [88] (test)  loss: 0.5264 -> 0.3497   acc: 86.11% -> 88.90%             
client [98] (test)  loss: 0.1833 -> 0.1062   acc: 95.42% -> 97.41%             
client [79] (test)  loss: 0.7782 -> 0.3359   acc: 83.28% -> 92.02%             
client [21] (test)  loss: 0.2383 -> 0.1180   acc: 93.47% -> 96.75%             
client [92] (test)  loss: 1.1617 -> 0.3566   acc: 78.16% -> 92.40%             
client [56] (test)  loss: 1.1761 -> 0.4797   acc: 72.31% -> 89.19%             
client [5] (test)  loss: 1.1886 -> 0.4762   acc: 75.99% -> 88.88%              
client [52] (test)  loss: 0.8602 -> 0.5339   acc: 77.67% -> 87.00%             
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.6064 -> 0.0000', 'accuracy': '82.69% -> 0.00%'},          
    200: {'loss': '0.7031 -> 0.0000', 'accuracy': '83.84% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 40.0%(48.43%) at epoch: 1                                      
FedAvg achieved 60.0%(63.94%) at epoch: 2                                      
FedAvg achieved 70.0%(74.02%) at epoch: 4                                      
FedAvg achieved 80.0%(82.80%) at epoch: 9                                      
Convergence (test_after):                                                      
FedAvg achieved 70.0%(76.27%) at epoch: 0                                      
FedAvg achieved 80.0%(83.82%) at epoch: 2                                      
FedAvg achieved 90.0%(90.19%) at epoch: 16                                     
