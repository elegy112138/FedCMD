==================== ALGORITHM: LG-FedAvg ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.4412 -> 0.3347   acc: 82.30% -> 84.26%             
client [81] (test)  loss: 0.6400 -> 0.5249   acc: 91.09% -> 91.09%             
client [21] (test)  loss: 8.5337 -> 2.1139   acc: 3.26% -> 58.70%              
client [68] (test)  loss: 1.1373 -> 0.5175   acc: 93.14% -> 93.14%             
client [93] (test)  loss: 1.1259 -> 1.0267   acc: 54.87% -> 63.98%             
client [31] (test)  loss: 2.0520 -> 1.5492   acc: 54.88% -> 58.54%             
client [20] (test)  loss: 1.0344 -> 0.9753   acc: 69.58% -> 69.58%             
client [59] (test)  loss: 11.4105 -> 1.1071   acc: 6.32% -> 63.18%             
client [48] (test)  loss: 1.7533 -> 1.6305   acc: 38.14% -> 39.18%             
client [34] (test)  loss: 2.2789 -> 2.1436   acc: 22.45% -> 36.73%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4220 -> 1.1919   acc: 43.79% -> 50.00%             
client [99] (test)  loss: 0.2760 -> 0.2396   acc: 95.40% -> 95.40%             
client [67] (test)  loss: 0.9986 -> 0.7018   acc: 72.33% -> 79.45%             
client [0] (test)  loss: 1.0513 -> 1.0405   acc: 57.71% -> 57.31%              
client [76] (test)  loss: 0.0601 -> 0.0565   acc: 99.28% -> 99.28%             
client [41] (test)  loss: 0.5363 -> 0.4353   acc: 87.72% -> 87.72%             
client [62] (test)  loss: 2.8859 -> 1.3467   acc: 40.80% -> 52.20%             
client [2] (test)  loss: 4.6563 -> 0.0046   acc: 5.51% -> 99.96%               
client [14] (test)  loss: 0.6003 -> 0.5889   acc: 86.96% -> 86.96%             
client [46] (test)  loss: 1.2915 -> 1.2447   acc: 63.33% -> 63.33%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5662 -> 0.4474   acc: 84.43% -> 84.43%             
client [68] (test)  loss: 0.4617 -> 0.3468   acc: 93.14% -> 93.14%             
client [57] (test)  loss: 0.6076 -> 0.4414   acc: 79.37% -> 84.81%             
client [17] (test)  loss: 0.3359 -> 0.3269   acc: 91.83% -> 91.83%             
client [54] (test)  loss: 0.3875 -> 0.3794   acc: 91.94% -> 91.94%             
client [23] (test)  loss: 7.4937 -> 0.9892   acc: 11.07% -> 73.66%             
client [35] (test)  loss: 0.0389 -> 0.0386   acc: 99.62% -> 99.62%             
client [59] (test)  loss: 0.9447 -> 0.8519   acc: 67.15% -> 69.13%             
client [31] (test)  loss: 0.9558 -> 0.9296   acc: 60.98% -> 67.07%             
client [9] (test)  loss: 1.3851 -> 1.1763   acc: 41.72% -> 50.64%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9651 -> 0.7646   acc: 68.28% -> 78.25%             
client [33] (test)  loss: 0.1755 -> 0.0903   acc: 97.12% -> 97.29%             
client [16] (test)  loss: 0.5866 -> 0.3718   acc: 64.86% -> 84.86%             
client [44] (test)  loss: 1.3726 -> 1.1432   acc: 50.41% -> 50.83%             
client [8] (test)  loss: 0.8025 -> 0.7739   acc: 80.77% -> 80.77%              
client [31] (test)  loss: 0.8868 -> 0.8613   acc: 64.63% -> 65.85%             
client [47] (test)  loss: 0.0001 -> 0.0005   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 2.2701 -> 2.1927   acc: 33.33% -> 41.67%             
client [20] (test)  loss: 0.8739 -> 0.6778   acc: 70.15% -> 77.76%             
client [56] (test)  loss: 0.0392 -> 0.0346   acc: 99.63% -> 99.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0063 -> 0.0182   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.4510 -> 0.2927   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.3641 -> 0.3257   acc: 89.54% -> 89.74%             
client [25] (test)  loss: 0.1127 -> 0.1607   acc: 98.32% -> 98.32%             
client [58] (test)  loss: 0.4112 -> 0.3254   acc: 87.28% -> 90.30%             
client [44] (test)  loss: 1.1377 -> 1.0568   acc: 50.41% -> 71.49%             
client [39] (test)  loss: 0.8296 -> 0.7650   acc: 66.91% -> 72.06%             
client [29] (test)  loss: 0.2431 -> 0.1905   acc: 93.21% -> 93.52%             
client [3] (test)  loss: 0.7413 -> 0.5242   acc: 72.33% -> 80.39%              
client [84] (test)  loss: 1.0035 -> 0.9961   acc: 66.16% -> 64.83%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2140 -> 1.1168   acc: 48.91% -> 50.00%             
client [84] (test)  loss: 0.8813 -> 1.0616   acc: 72.05% -> 65.59%             
client [10] (test)  loss: 0.2481 -> 0.1206   acc: 94.26% -> 95.55%             
client [36] (test)  loss: 1.8726 -> 1.6591   acc: 41.67% -> 41.67%             
client [65] (test)  loss: 0.0242 -> 0.0232   acc: 99.66% -> 99.66%             
client [81] (test)  loss: 0.5149 -> 0.4835   acc: 91.09% -> 91.09%             
client [79] (test)  loss: 0.1960 -> 0.1594   acc: 94.30% -> 95.38%             
client [42] (test)  loss: 0.6331 -> 0.5641   acc: 82.37% -> 82.37%             
client [11] (test)  loss: 1.1408 -> 1.0020   acc: 66.67% -> 71.19%             
client [96] (test)  loss: 0.2719 -> 0.2597   acc: 95.62% -> 95.62%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7966 -> 0.7516   acc: 80.77% -> 80.77%              
client [53] (test)  loss: 0.4304 -> 0.2857   acc: 87.47% -> 93.54%             
client [52] (test)  loss: 0.1891 -> 0.1515   acc: 94.06% -> 95.18%             
client [42] (test)  loss: 0.5610 -> 0.5178   acc: 81.69% -> 83.39%             
client [69] (test)  loss: 0.8510 -> 0.7294   acc: 72.03% -> 75.71%             
client [59] (test)  loss: 0.7076 -> 0.6550   acc: 76.90% -> 77.26%             
client [7] (test)  loss: 0.0494 -> 0.0441   acc: 99.04% -> 99.04%              
client [26] (test)  loss: 0.3026 -> 0.2525   acc: 92.92% -> 92.92%             
client [49] (test)  loss: 0.3962 -> 0.3335   acc: 87.86% -> 88.50%             
client [98] (test)  loss: 0.3996 -> 0.3126   acc: 87.60% -> 88.95%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3592 -> 0.3075   acc: 87.98% -> 88.95%             
client [47] (test)  loss: 0.0001 -> 0.0003   acc: 100.00% -> 100.00%           
client [21] (test)  loss: 1.0399 -> 1.0035   acc: 55.43% -> 59.78%             
client [77] (test)  loss: 0.3262 -> 0.1918   acc: 88.85% -> 93.77%             
client [95] (test)  loss: 0.4359 -> 0.3874   acc: 81.45% -> 85.97%             
client [91] (test)  loss: 0.9469 -> 0.6813   acc: 70.76% -> 79.37%             
client [14] (test)  loss: 0.6001 -> 0.5597   acc: 86.96% -> 86.96%             
client [99] (test)  loss: 0.2303 -> 0.2056   acc: 95.40% -> 95.40%             
client [20] (test)  loss: 0.8935 -> 0.6160   acc: 74.71% -> 79.85%             
client [39] (test)  loss: 0.6603 -> 0.5915   acc: 86.03% -> 84.56%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1784 -> 0.1585   acc: 94.15% -> 95.35%             
client [62] (test)  loss: 0.7101 -> 0.7394   acc: 79.80% -> 79.80%             
client [71] (test)  loss: 0.5782 -> 0.5164   acc: 79.95% -> 83.83%             
client [97] (test)  loss: 0.0005 -> 0.0003   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 0.3005 -> 0.2905   acc: 92.25% -> 92.25%             
client [88] (test)  loss: 0.0890 -> 0.0816   acc: 97.26% -> 97.39%             
client [60] (test)  loss: 0.0224 -> 0.0166   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 1.2244 -> 1.1739   acc: 51.22% -> 53.66%             
client [91] (test)  loss: 0.7524 -> 0.6245   acc: 77.02% -> 80.16%             
client [57] (test)  loss: 0.4583 -> 0.3997   acc: 83.48% -> 86.06%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6215 -> 0.6202   acc: 84.15% -> 82.93%             
client [15] (test)  loss: 0.3335 -> 0.1964   acc: 87.94% -> 94.63%             
client [71] (test)  loss: 0.6173 -> 0.5180   acc: 80.41% -> 83.83%             
client [97] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.3383 -> 0.3034   acc: 90.30% -> 92.93%             
client [77] (test)  loss: 0.3403 -> 0.1945   acc: 89.34% -> 93.93%             
client [76] (test)  loss: 0.0553 -> 0.0559   acc: 99.28% -> 99.28%             
client [79] (test)  loss: 0.2175 -> 0.1655   acc: 94.12% -> 95.92%             
client [28] (test)  loss: 0.4748 -> 0.4122   acc: 85.71% -> 89.13%             
client [99] (test)  loss: 0.2161 -> 0.1913   acc: 95.40% -> 95.40%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 0.3265 -> 0.3788   acc: 90.43% -> 89.67%             
client [34] (test)  loss: 1.4665 -> 1.4781   acc: 55.10% -> 55.10%             
client [73] (test)  loss: 0.0382 -> 0.0382   acc: 99.56% -> 99.56%             
client [5] (test)  loss: 0.5443 -> 0.5034   acc: 83.54% -> 84.18%              
client [96] (test)  loss: 0.2646 -> 0.2623   acc: 95.62% -> 95.62%             
client [22] (test)  loss: 1.0104 -> 0.9667   acc: 64.86% -> 68.92%             
client [60] (test)  loss: 0.0059 -> 0.0080   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.6382 -> 0.7786   acc: 79.52% -> 75.43%             
client [83] (test)  loss: 0.9603 -> 0.9110   acc: 52.50% -> 57.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0580 -> 0.0576   acc: 99.28% -> 99.28%             
client [65] (test)  loss: 0.0226 -> 0.0217   acc: 99.66% -> 99.66%             
client [95] (test)  loss: 0.4563 -> 0.3875   acc: 82.81% -> 86.43%             
client [17] (test)  loss: 0.3004 -> 0.2916   acc: 91.83% -> 91.83%             
client [8] (test)  loss: 0.7884 -> 0.7458   acc: 80.77% -> 80.77%              
client [35] (test)  loss: 0.0486 -> 0.0467   acc: 99.62% -> 99.62%             
client [98] (test)  loss: 0.3496 -> 0.3073   acc: 88.76% -> 90.31%             
client [53] (test)  loss: 0.2988 -> 0.2954   acc: 93.54% -> 93.94%             
client [43] (test)  loss: 0.1703 -> 0.1876   acc: 93.04% -> 93.41%             
client [64] (test)  loss: 0.7379 -> 0.5697   acc: 74.92% -> 82.78%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.9788 -> 0.9523   acc: 63.04% -> 64.13%             
client [88] (test)  loss: 0.0654 -> 0.0673   acc: 98.08% -> 98.08%             
client [38] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.4709 -> 0.4757   acc: 85.46% -> 85.81%              
client [5] (test)  loss: 0.5348 -> 0.4996   acc: 81.65% -> 82.28%              
client [41] (test)  loss: 0.2640 -> 0.2231   acc: 91.68% -> 93.47%             
client [7] (test)  loss: 0.0428 -> 0.0410   acc: 99.04% -> 99.04%              
client [37] (test)  loss: 0.0309 -> 0.0289   acc: 99.64% -> 99.64%             
client [45] (test)  loss: 0.3449 -> 0.3135   acc: 93.64% -> 93.64%             
client [47] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1667 -> 0.1561   acc: 94.59% -> 96.22%             
client [11] (test)  loss: 0.8065 -> 0.7673   acc: 73.45% -> 75.71%             
client [37] (test)  loss: 0.0298 -> 0.0289   acc: 99.64% -> 99.64%             
client [41] (test)  loss: 0.2768 -> 0.2227   acc: 91.49% -> 93.66%             
client [95] (test)  loss: 0.5234 -> 0.4344   acc: 82.81% -> 86.43%             
client [53] (test)  loss: 0.3392 -> 0.2972   acc: 91.72% -> 93.74%             
client [22] (test)  loss: 0.9418 -> 0.8809   acc: 67.57% -> 68.92%             
client [25] (test)  loss: 0.0921 -> 0.1036   acc: 98.32% -> 98.32%             
client [69] (test)  loss: 0.9122 -> 0.7493   acc: 75.14% -> 78.81%             
client [46] (test)  loss: 1.1690 -> 1.0925   acc: 64.17% -> 69.17%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [69] (test)  loss: 0.8408 -> 0.7684   acc: 76.27% -> 78.81%             
client [82] (test)  loss: 1.1380 -> 1.0859   acc: 56.10% -> 56.10%             
client [45] (test)  loss: 0.3330 -> 0.3145   acc: 93.64% -> 93.64%             
client [7] (test)  loss: 0.0433 -> 0.0403   acc: 99.04% -> 99.04%              
client [50] (test)  loss: 0.7892 -> 0.7520   acc: 69.61% -> 70.59%             
client [35] (test)  loss: 0.0485 -> 0.0480   acc: 99.62% -> 99.62%             
client [24] (test)  loss: 0.5185 -> 0.2659   acc: 82.68% -> 93.02%             
client [15] (test)  loss: 0.2605 -> 0.2193   acc: 92.40% -> 94.22%             
client [58] (test)  loss: 0.4940 -> 0.5025   acc: 88.08% -> 91.41%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.3349 -> 1.3464   acc: 54.64% -> 50.52%             
client [76] (test)  loss: 0.0597 -> 0.0596   acc: 99.28% -> 99.28%             
client [67] (test)  loss: 0.3898 -> 0.4679   acc: 87.86% -> 85.92%             
client [37] (test)  loss: 0.0312 -> 0.0291   acc: 99.64% -> 99.64%             
client [58] (test)  loss: 0.5205 -> 0.5099   acc: 89.03% -> 91.57%             
client [64] (test)  loss: 0.6366 -> 0.5797   acc: 80.36% -> 83.69%             
client [77] (test)  loss: 0.2954 -> 0.2131   acc: 92.79% -> 94.75%             
client [55] (test)  loss: 0.0534 -> 0.0547   acc: 98.99% -> 98.99%             
client [12] (test)  loss: 0.4817 -> 0.4851   acc: 93.75% -> 93.75%             
client [89] (test)  loss: 0.2545 -> 0.1683   acc: 93.99% -> 95.76%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.3219 -> 1.2841   acc: 70.15% -> 73.95%             
client [51] (test)  loss: 0.4133 -> 0.3994   acc: 90.12% -> 92.06%             
client [8] (test)  loss: 0.7846 -> 0.7354   acc: 80.77% -> 80.77%              
client [18] (test)  loss: 0.4116 -> 0.4124   acc: 89.68% -> 89.68%             
client [94] (test)  loss: 0.1234 -> 0.1120   acc: 95.91% -> 96.35%             
client [81] (test)  loss: 0.5385 -> 0.4884   acc: 91.09% -> 91.09%             
client [3] (test)  loss: 0.4834 -> 0.4027   acc: 86.51% -> 90.72%              
client [11] (test)  loss: 0.7772 -> 0.7494   acc: 75.14% -> 77.40%             
client [95] (test)  loss: 0.4982 -> 0.4620   acc: 84.16% -> 85.97%             
client [67] (test)  loss: 0.4046 -> 0.4601   acc: 87.86% -> 86.25%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.9258 -> 0.9115   acc: 67.39% -> 67.39%             
client [79] (test)  loss: 0.2319 -> 0.2484   acc: 95.92% -> 95.98%             
client [58] (test)  loss: 0.5329 -> 0.5220   acc: 88.55% -> 91.26%             
client [88] (test)  loss: 0.0693 -> 0.0720   acc: 98.22% -> 98.22%             
client [46] (test)  loss: 1.1612 -> 1.0729   acc: 68.33% -> 70.83%             
client [11] (test)  loss: 0.7999 -> 0.7518   acc: 74.58% -> 77.97%             
client [55] (test)  loss: 0.0522 -> 0.0539   acc: 98.99% -> 98.99%             
client [13] (test)  loss: 0.2831 -> 0.2629   acc: 90.65% -> 92.95%             
client [31] (test)  loss: 0.6100 -> 0.5950   acc: 85.37% -> 84.15%             
client [75] (test)  loss: 0.4853 -> 0.4846   acc: 86.70% -> 87.26%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3700 -> 0.3368   acc: 89.72% -> 90.78%             
client [7] (test)  loss: 0.0373 -> 0.0361   acc: 99.04% -> 99.04%              
client [57] (test)  loss: 0.8309 -> 0.5672   acc: 85.10% -> 86.63%             
client [13] (test)  loss: 0.3378 -> 0.2659   acc: 88.54% -> 92.77%             
client [43] (test)  loss: 0.2071 -> 0.2197   acc: 93.59% -> 93.41%             
client [91] (test)  loss: 0.6365 -> 0.5724   acc: 82.51% -> 84.60%             
client [10] (test)  loss: 0.0850 -> 0.0699   acc: 97.42% -> 97.56%             
client [64] (test)  loss: 0.7155 -> 0.6635   acc: 80.97% -> 83.69%             
client [82] (test)  loss: 1.2186 -> 0.9405   acc: 56.10% -> 65.85%             
client [22] (test)  loss: 0.8030 -> 0.7152   acc: 71.62% -> 70.27%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9404 -> 0.7712   acc: 74.71% -> 80.42%             
client [23] (test)  loss: 0.5087 -> 0.4609   acc: 83.59% -> 85.11%             
client [88] (test)  loss: 0.0832 -> 0.0729   acc: 98.08% -> 98.22%             
client [98] (test)  loss: 0.3486 -> 0.3553   acc: 90.70% -> 90.89%             
client [79] (test)  loss: 0.2501 -> 0.2610   acc: 96.22% -> 95.86%             
client [21] (test)  loss: 0.9201 -> 0.9009   acc: 68.48% -> 69.57%             
client [92] (test)  loss: 0.7185 -> 0.5977   acc: 80.15% -> 83.25%             
client [56] (test)  loss: 0.0359 -> 0.0330   acc: 99.63% -> 99.63%             
client [5] (test)  loss: 0.7329 -> 0.5190   acc: 77.22% -> 82.91%              
client [52] (test)  loss: 0.2419 -> 0.1897   acc: 95.52% -> 96.13%             
==================== LG-FedAvg TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.3221 -> 0.0000', 'accuracy': '90.06% -> 0.00%'},          
    200: {'loss': '0.3639 -> 0.0000', 'accuracy': '91.20% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg achieved 10.0%(10.14%) at epoch: 0                                   
LG-FedAvg achieved 20.0%(27.10%) at epoch: 1                                   
LG-FedAvg achieved 30.0%(39.06%) at epoch: 3                                   
LG-FedAvg achieved 60.0%(66.33%) at epoch: 4                                   
LG-FedAvg achieved 80.0%(83.93%) at epoch: 7                                   
LG-FedAvg achieved 90.0%(91.39%) at epoch: 46                                  
Convergence (test_after):                                                      
LG-FedAvg achieved 80.0%(83.44%) at epoch: 0                                   
LG-FedAvg achieved 90.0%(91.38%) at epoch: 7                                   
