==================== ALGORITHM: LG-FedAvg                    
====================                                         
Experiment Arguments:                                        
{                                                            
    'model': 'lenet5',                                       
    'dataset': 'cifar10',                                    
    'seed': 42,                                              
    'join_ratio': 0.1,                                       
    'global_epoch': 100,                                     
    'local_epoch': 5,                                        
    'finetune_epoch': 0,                                     
    'test_gap': 100,                                         
    'eval_test': 1,                                          
    'eval_train': 0,                                         
    'local_lr': 0.01,                                        
    'momentum': 0.0,                                         
    'weight_decay': 0.0,                                     
    'verbose_gap': 10,                                       
    'batch_size': 32,                                        
    'visible': 0,                                            
    'global_testset': 0,                                     
    'straggler_ratio': 0,                                    
    'straggler_min_local_epoch': 1,                          
    'external_model_params_file': '',                        
    'use_cuda': 1,                                           
    'save_log': 1,                                           
    'save_model': 0,                                         
    'save_fig': 1,                                           
    'save_metrics': 1,                                       
    'viz_win_name': None,                                    
    'num_global_layers': 1,                                  
    'dataset_args': {                                        
        'dataset': 'cifar10',                                
        'client_num': 100,                                   
        'fraction': 0.5,                                     
        'seed': 42,                                          
        'split': 'sample',                                   
        'alpha': 0.1,                                        
        'least_samples': 40                                  
    }                                                        
}                                                            
-------------------------- TRAINING EPOCH: 10                
--------------------------                                   
client [77] (test)  loss: 1.1331 -> 0.8126   acc: 60.79% ->  
73.13%                                                       
client [81] (test)  loss: 1.5530 -> 1.4016   acc: 36.61% ->  
55.80%                                                       
client [21] (test)  loss: 2.0268 -> 0.7722   acc: 35.05% ->  
80.37%                                                       
client [68] (test)  loss: 1.0263 -> 0.8744   acc: 57.69% ->  
68.80%                                                       
client [93] (test)  loss: 0.5873 -> 0.5581   acc: 86.35% ->  
86.35%                                                       
client [31] (test)  loss: 1.3168 -> 0.8647   acc: 57.39% ->  
57.39%                                                       
client [20] (test)  loss: 0.3100 -> 0.2917   acc: 93.33% ->  
93.33%                                                       
client [59] (test)  loss: 9.0043 -> 0.2840   acc: 0.17% ->   
96.80%                                                       
client [48] (test)  loss: 1.1146 -> 1.0102   acc: 62.79% ->  
62.79%                                                       
client [34] (test)  loss: 0.8626 -> 0.8103   acc: 68.40% ->  
76.04%                                                       
-------------------------- TRAINING EPOCH: 20                
--------------------------                                   
client [69] (test)  loss: 1.1083 -> 0.9320   acc: 60.22% ->  
69.52%                                                       
client [99] (test)  loss: 2.2527 -> 2.1111   acc: 21.76% ->  
20.59%                                                       
client [67] (test)  loss: 1.9217 -> 1.4516   acc: 63.41% ->  
63.41%                                                       
client [0] (test)  loss: 0.8038 -> 0.6094   acc: 73.38% ->   
80.84%                                                       
client [76] (test)  loss: 0.8019 -> 0.5448   acc: 60.23% ->  
76.09%                                                       
client [41] (test)  loss: 1.6373 -> 1.3872   acc: 52.96% ->  
52.96%                                                       
client [62] (test)  loss: 6.8604 -> 0.4098   acc: 1.61% ->   
87.10%                                                       
client [2] (test)  loss: 5.6831 -> 2.2891   acc: 0.00% ->    
12.50%                                                       
client [14] (test)  loss: 0.0872 -> 0.0963   acc: 98.13% ->  
98.13%                                                       
client [46] (test)  loss: 0.6273 -> 0.3984   acc: 67.77% ->  
82.46%                                                       
-------------------------- TRAINING EPOCH: 30                
--------------------------                                   
client [24] (test)  loss: 2.6351 -> 0.6905   acc: 32.13% ->  
77.43%                                                       
client [68] (test)  loss: 1.0345 -> 0.7774   acc: 63.25% ->  
73.50%                                                       
client [57] (test)  loss: 0.5741 -> 0.6943   acc: 70.32% ->  
61.05%                                                       
client [17] (test)  loss: 0.3752 -> 0.2510   acc: 92.72% ->  
92.72%                                                       
client [54] (test)  loss: 1.1896 -> 1.2966   acc: 80.96% ->  
39.74%                                                       
client [23] (test)  loss: 4.0550 -> 2.1622   acc: 25.71% ->  
17.14%                                                       
client [35] (test)  loss: 0.9808 -> 0.8094   acc: 70.42% ->  
70.42%                                                       
client [59] (test)  loss: 0.2340 -> 0.2115   acc: 96.80% ->  
96.80%                                                       
client [31] (test)  loss: 0.7979 -> 0.7662   acc: 59.66% ->  
64.77%                                                       
client [9] (test)  loss: 0.3461 -> 0.2329   acc: 93.21% ->   
93.21%                                                       
-------------------------- TRAINING EPOCH: 40                
--------------------------                                   
client [64] (test)  loss: 1.7812 -> 1.5286   acc: 59.26% ->  
59.26%                                                       
client [33] (test)  loss: 0.6381 -> 0.5222   acc: 86.93% ->  
86.93%                                                       
client [16] (test)  loss: 0.4908 -> 0.4888   acc: 88.27% ->  
88.27%                                                       
client [44] (test)  loss: 0.1100 -> 0.0987   acc: 98.66% ->  
98.66%                                                       
client [8] (test)  loss: 0.0017 -> 0.0004   acc: 100.00% ->  
100.00%                                                      
client [31] (test)  loss: 0.9756 -> 0.8667   acc: 44.32% ->  
65.91%                                                       
client [47] (test)  loss: 0.9536 -> 0.7807   acc: 74.19% ->  
74.19%                                                       
client [36] (test)  loss: 1.3351 -> 0.6913   acc: 67.83% ->  
69.57%                                                       
client [20] (test)  loss: 0.2968 -> 0.2848   acc: 93.33% ->  
93.33%                                                       
client [56] (test)  loss: 0.3303 -> 0.3252   acc: 94.32% ->  
94.32%                                                       
-------------------------- TRAINING EPOCH: 50                
--------------------------                                   
client [4] (test)  loss: 0.6381 -> 0.5164   acc: 86.22% ->   
86.22%                                                       
client [60] (test)  loss: 0.3502 -> 0.3422   acc: 92.92% ->  
92.92%                                                       
client [28] (test)  loss: 0.9918 -> 1.0610   acc: 66.31% ->  
66.31%                                                       
client [25] (test)  loss: 0.6554 -> 0.6684   acc: 76.51% ->  
77.62%                                                       
client [58] (test)  loss: 0.9577 -> 0.9430   acc: 68.72% ->  
68.72%                                                       
client [44] (test)  loss: 0.1228 -> 0.0951   acc: 98.66% ->  
98.66%                                                       
client [39] (test)  loss: 0.4171 -> 0.3836   acc: 82.98% ->  
83.28%                                                       
client [29] (test)  loss: 0.8741 -> 0.5792   acc: 76.67% ->  
87.14%                                                       
client [3] (test)  loss: 0.4773 -> 0.4045   acc: 81.61% ->   
87.10%                                                       
client [84] (test)  loss: 1.1632 -> 1.0185   acc: 64.97% ->  
67.80%                                                       
-------------------------- TRAINING EPOCH: 60                
--------------------------                                   
client [21] (test)  loss: 0.6043 -> 0.5856   acc: 80.37% ->  
80.37%                                                       
client [84] (test)  loss: 2.3236 -> 1.3476   acc: 39.55% ->  
57.63%                                                       
client [10] (test)  loss: 0.4698 -> 1.1743   acc: 79.96% ->  
73.03%                                                       
client [36] (test)  loss: 0.4817 -> 0.4010   acc: 86.96% ->  
89.57%                                                       
client [65] (test)  loss: 0.6216 -> 0.7551   acc: 76.47% ->  
69.41%                                                       
client [81] (test)  loss: 1.3980 -> 1.4602   acc: 42.41% ->  
45.98%                                                       
client [79] (test)  loss: 1.0799 -> 1.0183   acc: 56.73% ->  
56.73%                                                       
client [42] (test)  loss: 0.3050 -> 0.1145   acc: 97.23% ->  
97.23%                                                       
client [11] (test)  loss: 0.8144 -> 0.9566   acc: 68.10% ->  
56.96%                                                       
client [96] (test)  loss: 1.4156 -> 1.3366   acc: 47.12% ->  
50.00%                                                       
-------------------------- TRAINING EPOCH: 70                
--------------------------                                   
client [8] (test)  loss: 0.0007 -> 0.0003   acc: 100.00% ->  
100.00%                                                      
client [53] (test)  loss: 0.3070 -> 0.2861   acc: 91.59% ->  
91.59%                                                       
client [52] (test)  loss: 0.5781 -> 0.4633   acc: 81.27% ->  
85.60%                                                       
client [42] (test)  loss: 0.3171 -> 0.1105   acc: 97.23% ->  
97.23%                                                       
client [69] (test)  loss: 0.9146 -> 1.5376   acc: 67.29% ->  
52.79%                                                       
client [59] (test)  loss: 0.2103 -> 0.1900   acc: 96.80% ->  
96.80%                                                       
client [7] (test)  loss: 0.8332 -> 0.7821   acc: 56.94% ->   
68.06%                                                       
client [26] (test)  loss: 0.7806 -> 0.8250   acc: 78.95% ->  
69.74%                                                       
client [49] (test)  loss: 0.0331 -> 0.0316   acc: 99.64% ->  
99.64%                                                       
client [98] (test)  loss: 0.7831 -> 0.7496   acc: 68.66% ->  
70.15%                                                       
-------------------------- TRAINING EPOCH: 80                
--------------------------                                   
client [98] (test)  loss: 0.7673 -> 0.7457   acc: 70.15% ->  
68.66%                                                       
client [47] (test)  loss: 1.0034 -> 0.7031   acc: 74.19% ->  
79.21%                                                       
client [21] (test)  loss: 0.5847 -> 0.5579   acc: 80.37% ->  
80.37%                                                       
client [77] (test)  loss: 1.2516 -> 0.6300   acc: 65.64% ->  
79.30%                                                       
client [95] (test)  loss: 1.8922 -> 0.6696   acc: 42.37% ->  
80.00%                                                       
client [91] (test)  loss: 0.6512 -> 0.6262   acc: 80.67% ->  
80.67%                                                       
client [14] (test)  loss: 0.0769 -> 0.0619   acc: 98.13% ->  
98.13%                                                       
client [99] (test)  loss: 1.9595 -> 2.2064   acc: 25.88% ->  
22.35%                                                       
client [20] (test)  loss: 0.3445 -> 0.2717   acc: 93.85% ->  
94.87%                                                       
client [39] (test)  loss: 0.3285 -> 0.3729   acc: 87.84% ->  
86.02%                                                       
-------------------------- TRAINING EPOCH: 90                
--------------------------                                   
client [52] (test)  loss: 0.5462 -> 0.4614   acc: 82.20% ->  
85.91%                                                       
client [62] (test)  loss: 1.1675 -> 0.1828   acc: 81.05% ->  
94.96%                                                       
client [71] (test)  loss: 0.1813 -> 0.1271   acc: 97.97% ->  
97.97%                                                       
client [97] (test)  loss: 0.0000 -> 0.0003   acc: 100.00% -> 
100.00%                                                      
client [30] (test)  loss: 0.9784 -> 0.9827   acc: 72.00% ->  
72.00%                                                       
client [88] (test)  loss: 0.7140 -> 0.7305   acc: 81.16% ->  
81.16%                                                       
client [60] (test)  loss: 0.2935 -> 0.2872   acc: 92.92% ->  
92.92%                                                       
client [82] (test)  loss: 1.2817 -> 1.6985   acc: 50.56% ->  
38.76%                                                       
client [91] (test)  loss: 0.5907 -> 0.6155   acc: 82.67% ->  
81.33%                                                       
client [57] (test)  loss: 0.6884 -> 0.7899   acc: 70.11% ->  
68.84%                                                       
-------------------------- TRAINING EPOCH: 100               
--------------------------                                   
client [31] (test)  loss: 2.6694 -> 1.0973   acc: 43.18% ->  
64.20%                                                       
client [15] (test)  loss: 0.8598 -> 0.8265   acc: 63.86% ->  
66.27%                                                       
client [71] (test)  loss: 0.1818 -> 0.1295   acc: 97.97% ->  
97.97%                                                       
client [97] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 
100.00%                                                      
client [53] (test)  loss: 0.2902 -> 0.2612   acc: 91.59% ->  
91.59%                                                       
client [77] (test)  loss: 1.3563 -> 0.6187   acc: 66.08% ->  
80.18%                                                       
client [76] (test)  loss: 0.6488 -> 0.7701   acc: 74.02% ->  
76.32%                                                       
client [79] (test)  loss: 0.9852 -> 1.0406   acc: 63.16% ->  
59.06%                                                       
client [28] (test)  loss: 1.2074 -> 1.0482   acc: 66.31% ->  
62.57%                                                       
client [99] (test)  loss: 1.8126 -> 2.3218   acc: 35.88% ->  
22.94%                                                       
==================== LG-FedAvg TEST RESULTS:                 
====================                                         
{                                                            
    100: {                                                   
        'loss': '0.6286 -> 0.0000',                          
        'accuracy': '82.44% -> 0.00%'                        
    }                                                        
}                                                            
Convergence (test_before):                                   
LG-FedAvg achieved 10.0%(17.79%) at epoch: 0                 
LG-FedAvg achieved 20.0%(27.20%) at epoch: 2                 
LG-FedAvg achieved 50.0%(55.99%) at epoch: 4                 
LG-FedAvg achieved 60.0%(61.66%) at epoch: 7                 
LG-FedAvg achieved 70.0%(72.89%) at epoch: 13                
LG-FedAvg achieved 80.0%(80.71%) at epoch: 17                
LG-FedAvg achieved 90.0%(91.49%) at epoch: 68                
Convergence (test_after):                                    
LG-FedAvg achieved 70.0%(75.11%) at epoch: 0                 
LG-FedAvg achieved 80.0%(80.86%) at epoch: 3                 
LG-FedAvg achieved 90.0%(90.73%) at epoch: 11                
