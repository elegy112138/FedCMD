==================== ALGORITHM: LG-FedAvg ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.5154 -> 3.2403   acc: 8.76% -> 13.57%              
client [81] (test)  loss: 3.4390 -> 3.3721   acc: 13.35% -> 16.01%             
client [21] (test)  loss: 5.2929 -> 3.6862   acc: 0.20% -> 18.40%              
client [68] (test)  loss: 3.6901 -> 3.5251   acc: 12.68% -> 16.59%             
client [93] (test)  loss: 3.8476 -> 3.5109   acc: 12.68% -> 18.57%             
client [31] (test)  loss: 3.3094 -> 3.0035   acc: 24.04% -> 30.31%             
client [20] (test)  loss: 3.5760 -> 3.2218   acc: 7.61% -> 17.47%              
client [59] (test)  loss: 5.3023 -> 3.6965   acc: 0.18% -> 8.10%               
client [48] (test)  loss: 3.0643 -> 3.0136   acc: 29.76% -> 32.39%             
client [34] (test)  loss: 3.8316 -> 3.6744   acc: 13.92% -> 16.01%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.0217 -> 3.8992   acc: 10.64% -> 11.70%             
client [99] (test)  loss: 4.2488 -> 4.1284   acc: 5.11% -> 10.43%              
client [67] (test)  loss: 3.5956 -> 3.3653   acc: 15.34% -> 17.28%             
client [0] (test)  loss: 3.5560 -> 3.4463   acc: 12.37% -> 14.16%              
client [76] (test)  loss: 3.5203 -> 3.3918   acc: 11.64% -> 15.64%             
client [41] (test)  loss: 3.4201 -> 3.1668   acc: 20.82% -> 22.78%             
client [62] (test)  loss: 5.2999 -> 3.9720   acc: 0.00% -> 5.30%               
client [2] (test)  loss: 5.2833 -> 3.4655   acc: 0.65% -> 10.65%               
client [14] (test)  loss: 2.8688 -> 2.7746   acc: 22.42% -> 29.00%             
client [46] (test)  loss: 3.6451 -> 3.7293   acc: 9.01% -> 13.33%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4149 -> 3.3088   acc: 20.00% -> 24.66%             
client [68] (test)  loss: 3.2440 -> 3.2367   acc: 22.93% -> 22.28%             
client [57] (test)  loss: 3.8580 -> 3.7051   acc: 12.91% -> 14.18%             
client [17] (test)  loss: 3.4937 -> 2.9215   acc: 22.75% -> 27.01%             
client [54] (test)  loss: 3.4410 -> 3.3184   acc: 25.00% -> 26.54%             
client [23] (test)  loss: 5.2820 -> 3.2804   acc: 0.00% -> 15.04%              
client [35] (test)  loss: 3.3627 -> 3.1647   acc: 13.05% -> 21.69%             
client [59] (test)  loss: 3.3241 -> 3.2766   acc: 17.61% -> 21.30%             
client [31] (test)  loss: 2.8742 -> 2.8214   acc: 37.11% -> 41.46%             
client [9] (test)  loss: 4.4254 -> 3.7103   acc: 7.82% -> 16.18%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.0251 -> 3.1599   acc: 27.56% -> 27.06%             
client [33] (test)  loss: 3.5370 -> 3.5293   acc: 22.50% -> 25.68%             
client [16] (test)  loss: 3.4674 -> 3.3170   acc: 15.12% -> 21.68%             
client [44] (test)  loss: 3.6497 -> 3.3419   acc: 9.66% -> 19.81%              
client [8] (test)  loss: 3.3414 -> 3.3458   acc: 29.57% -> 28.93%              
client [31] (test)  loss: 2.8830 -> 2.8417   acc: 37.63% -> 38.50%             
client [47] (test)  loss: 2.5707 -> 2.3729   acc: 38.70% -> 39.96%             
client [36] (test)  loss: 2.9837 -> 2.6621   acc: 27.36% -> 32.79%             
client [20] (test)  loss: 3.3417 -> 3.4348   acc: 20.24% -> 20.76%             
client [56] (test)  loss: 3.6751 -> 3.5498   acc: 11.39% -> 13.88%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.6694 -> 3.4120   acc: 19.17% -> 21.88%              
client [60] (test)  loss: 3.1935 -> 2.9987   acc: 22.73% -> 27.45%             
client [28] (test)  loss: 3.2581 -> 3.2168   acc: 26.94% -> 25.50%             
client [25] (test)  loss: 3.5346 -> 3.4813   acc: 19.30% -> 18.09%             
client [58] (test)  loss: 3.5695 -> 3.6768   acc: 16.61% -> 17.84%             
client [44] (test)  loss: 3.3824 -> 3.1943   acc: 17.39% -> 22.54%             
client [39] (test)  loss: 3.7472 -> 3.6266   acc: 18.15% -> 18.81%             
client [29] (test)  loss: 3.2688 -> 3.0366   acc: 21.43% -> 24.49%             
client [3] (test)  loss: 3.1253 -> 3.1267   acc: 20.92% -> 23.04%              
client [84] (test)  loss: 3.3234 -> 3.3603   acc: 24.11% -> 25.35%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 3.4185 -> 3.3096   acc: 24.80% -> 26.00%             
client [84] (test)  loss: 3.4301 -> 3.6258   acc: 26.77% -> 26.24%             
client [10] (test)  loss: 3.1319 -> 3.1222   acc: 21.46% -> 21.83%             
client [36] (test)  loss: 2.5383 -> 2.5040   acc: 33.51% -> 33.88%             
client [65] (test)  loss: 3.5910 -> 3.6481   acc: 18.28% -> 16.67%             
client [81] (test)  loss: 3.5386 -> 3.3722   acc: 17.97% -> 21.71%             
client [79] (test)  loss: 3.6355 -> 3.6314   acc: 16.24% -> 17.09%             
client [42] (test)  loss: 3.2810 -> 3.3568   acc: 22.72% -> 21.29%             
client [11] (test)  loss: 3.6424 -> 3.5783   acc: 13.49% -> 13.67%             
client [96] (test)  loss: 2.9226 -> 2.7985   acc: 24.10% -> 26.80%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0921 -> 3.9275   acc: 25.44% -> 27.66%              
client [53] (test)  loss: 3.3022 -> 3.1963   acc: 27.33% -> 28.88%             
client [52] (test)  loss: 3.5609 -> 3.5138   acc: 17.55% -> 18.79%             
client [42] (test)  loss: 3.5477 -> 3.6880   acc: 22.36% -> 21.82%             
client [69] (test)  loss: 4.1904 -> 4.2232   acc: 17.55% -> 16.76%             
client [59] (test)  loss: 3.3540 -> 3.3842   acc: 20.95% -> 21.65%             
client [7] (test)  loss: 3.7765 -> 3.7794   acc: 19.21% -> 20.11%              
client [26] (test)  loss: 3.2998 -> 3.1936   acc: 23.27% -> 23.44%             
client [49] (test)  loss: 3.3325 -> 3.3092   acc: 22.20% -> 22.55%             
client [98] (test)  loss: 3.6420 -> 3.2498   acc: 23.44% -> 27.22%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.7561 -> 3.4255   acc: 23.44% -> 26.28%             
client [47] (test)  loss: 2.3883 -> 2.3414   acc: 41.41% -> 41.05%             
client [21] (test)  loss: 3.3272 -> 3.2721   acc: 25.80% -> 27.20%             
client [77] (test)  loss: 3.3851 -> 3.4988   acc: 19.42% -> 22.34%             
client [95] (test)  loss: 3.1543 -> 3.2328   acc: 35.58% -> 34.53%             
client [91] (test)  loss: 3.1263 -> 3.1315   acc: 27.24% -> 29.61%             
client [14] (test)  loss: 3.3177 -> 3.5564   acc: 27.76% -> 29.89%             
client [99] (test)  loss: 4.1350 -> 4.1605   acc: 19.02% -> 19.02%             
client [20] (test)  loss: 4.4381 -> 4.3590   acc: 19.55% -> 21.28%             
client [39] (test)  loss: 3.5732 -> 3.4923   acc: 18.81% -> 22.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.5978 -> 3.5867   acc: 17.38% -> 19.68%             
client [62] (test)  loss: 4.3215 -> 4.5676   acc: 17.09% -> 16.58%             
client [71] (test)  loss: 3.8451 -> 3.9944   acc: 14.98% -> 14.25%             
client [97] (test)  loss: 3.4503 -> 3.5673   acc: 21.18% -> 19.27%             
client [30] (test)  loss: 3.7160 -> 3.9214   acc: 20.42% -> 21.35%             
client [88] (test)  loss: 3.3812 -> 3.4756   acc: 22.70% -> 23.72%             
client [60] (test)  loss: 3.2194 -> 3.2544   acc: 32.36% -> 31.64%             
client [82] (test)  loss: 3.5861 -> 3.6340   acc: 23.21% -> 23.70%             
client [91] (test)  loss: 3.3568 -> 3.4266   acc: 28.76% -> 28.76%             
client [57] (test)  loss: 3.6987 -> 3.7455   acc: 17.45% -> 20.91%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.0728 -> 3.8968   acc: 36.59% -> 37.46%             
client [15] (test)  loss: 3.5849 -> 3.5052   acc: 24.65% -> 28.67%             
client [71] (test)  loss: 4.0058 -> 4.1663   acc: 13.53% -> 13.04%             
client [97] (test)  loss: 3.9645 -> 4.1338   acc: 20.42% -> 19.47%             
client [53] (test)  loss: 3.5950 -> 3.6155   acc: 25.58% -> 25.58%             
client [77] (test)  loss: 3.7003 -> 3.6570   acc: 20.10% -> 22.68%             
client [76] (test)  loss: 3.8012 -> 3.8349   acc: 20.00% -> 19.45%             
client [79] (test)  loss: 3.8100 -> 3.8942   acc: 16.67% -> 17.09%             
client [28] (test)  loss: 4.4286 -> 4.5835   acc: 20.80% -> 22.60%             
client [99] (test)  loss: 4.3569 -> 4.4460   acc: 19.22% -> 19.43%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.3899 -> 4.5013   acc: 19.08% -> 18.89%             
client [86] (test)  loss: 4.0493 -> 3.4871   acc: 29.56% -> 34.25%             
client [34] (test)  loss: 4.5386 -> 4.6943   acc: 18.56% -> 21.11%             
client [73] (test)  loss: 3.5547 -> 3.6296   acc: 28.30% -> 26.71%             
client [5] (test)  loss: 3.6854 -> 3.8167   acc: 21.98% -> 21.80%              
client [96] (test)  loss: 3.9724 -> 3.9110   acc: 25.36% -> 25.18%             
client [22] (test)  loss: 3.3610 -> 3.3275   acc: 25.44% -> 26.43%             
client [60] (test)  loss: 3.7334 -> 3.7901   acc: 27.27% -> 28.18%             
client [66] (test)  loss: 3.6679 -> 3.8275   acc: 17.29% -> 16.58%             
client [83] (test)  loss: 4.7645 -> 4.8849   acc: 16.13% -> 15.18%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.5985 -> 4.4840   acc: 19.82% -> 21.27%             
client [65] (test)  loss: 4.0524 -> 4.3477   acc: 18.10% -> 16.13%             
client [95] (test)  loss: 3.7894 -> 3.8533   acc: 32.63% -> 31.79%             
client [17] (test)  loss: 3.9071 -> 3.3911   acc: 26.22% -> 30.17%             
client [8] (test)  loss: 4.6982 -> 4.5006   acc: 25.28% -> 27.03%              
client [35] (test)  loss: 4.9394 -> 4.9606   acc: 24.10% -> 26.10%             
client [98] (test)  loss: 4.2113 -> 3.8143   acc: 22.12% -> 28.17%             
client [53] (test)  loss: 3.8653 -> 4.0219   acc: 25.39% -> 24.61%             
client [43] (test)  loss: 4.1041 -> 4.2123   acc: 22.20% -> 21.57%             
client [64] (test)  loss: 3.5460 -> 3.5339   acc: 32.84% -> 32.34%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.4041 -> 3.3849   acc: 27.40% -> 26.40%             
client [88] (test)  loss: 4.6388 -> 4.7268   acc: 20.82% -> 20.99%             
client [38] (test)  loss: 4.5637 -> 4.6387   acc: 18.99% -> 20.21%             
client [3] (test)  loss: 4.4136 -> 4.4160   acc: 21.08% -> 23.37%              
client [5] (test)  loss: 4.1243 -> 4.1410   acc: 21.26% -> 21.80%              
client [41] (test)  loss: 3.6944 -> 3.6985   acc: 25.09% -> 25.27%             
client [7] (test)  loss: 4.4172 -> 4.5109   acc: 17.59% -> 17.41%              
client [37] (test)  loss: 4.1666 -> 4.1153   acc: 26.14% -> 25.16%             
client [45] (test)  loss: 3.4388 -> 3.4745   acc: 25.56% -> 23.53%             
client [47] (test)  loss: 2.5293 -> 2.6644   acc: 37.25% -> 37.79%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.4827 -> 4.2818   acc: 19.31% -> 20.22%             
client [11] (test)  loss: 4.8042 -> 5.0247   acc: 12.11% -> 13.32%             
client [37] (test)  loss: 4.6912 -> 4.7148   acc: 24.51% -> 24.19%             
client [41] (test)  loss: 3.8218 -> 3.8277   acc: 25.27% -> 24.91%             
client [95] (test)  loss: 4.2443 -> 4.2888   acc: 31.79% -> 32.84%             
client [53] (test)  loss: 4.1319 -> 4.2260   acc: 23.45% -> 24.22%             
client [22] (test)  loss: 3.4972 -> 3.6409   acc: 24.65% -> 25.64%             
client [25] (test)  loss: 4.2335 -> 4.3862   acc: 19.30% -> 19.65%             
client [69] (test)  loss: 5.3399 -> 5.3327   acc: 14.10% -> 15.43%             
client [46] (test)  loss: 3.9769 -> 4.0603   acc: 16.40% -> 18.56%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.1991 -> 3.3193   acc: 35.80% -> 34.90%             
client [69] (test)  loss: 5.5137 -> 5.4547   acc: 15.43% -> 14.63%             
client [82] (test)  loss: 4.8621 -> 4.6971   acc: 20.29% -> 21.59%             
client [45] (test)  loss: 3.7809 -> 3.9592   acc: 22.52% -> 22.11%             
client [7] (test)  loss: 4.5796 -> 4.7116   acc: 16.88% -> 16.52%              
client [50] (test)  loss: 3.4456 -> 3.6398   acc: 23.66% -> 22.45%             
client [35] (test)  loss: 4.9923 -> 5.0856   acc: 24.90% -> 26.91%             
client [24] (test)  loss: 4.6254 -> 4.4856   acc: 20.55% -> 23.84%             
client [15] (test)  loss: 4.2469 -> 4.3303   acc: 23.08% -> 25.35%             
client [58] (test)  loss: 5.4617 -> 5.3697   acc: 16.61% -> 16.25%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.0754 -> 4.0759   acc: 30.85% -> 31.29%             
client [76] (test)  loss: 4.9960 -> 4.9207   acc: 20.91% -> 21.09%             
client [67] (test)  loss: 4.2727 -> 4.4478   acc: 21.16% -> 20.11%             
client [37] (test)  loss: 5.0640 -> 5.0227   acc: 24.19% -> 23.54%             
client [58] (test)  loss: 5.5041 -> 5.4619   acc: 17.49% -> 16.25%             
client [64] (test)  loss: 4.2218 -> 4.1955   acc: 32.84% -> 32.18%             
client [77] (test)  loss: 4.1989 -> 4.2480   acc: 20.62% -> 21.48%             
client [55] (test)  loss: 4.7920 -> 4.8975   acc: 18.25% -> 19.34%             
client [12] (test)  loss: 4.3090 -> 4.3762   acc: 28.44% -> 29.36%             
client [89] (test)  loss: 5.0418 -> 5.1627   acc: 21.34% -> 21.52%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.4251 -> 5.5518   acc: 23.58% -> 23.40%             
client [51] (test)  loss: 4.2758 -> 4.2110   acc: 24.00% -> 27.09%             
client [8] (test)  loss: 5.1951 -> 5.1433   acc: 25.91% -> 26.39%              
client [18] (test)  loss: 5.0028 -> 4.9893   acc: 17.71% -> 17.35%             
client [94] (test)  loss: 4.5608 -> 4.5938   acc: 24.23% -> 24.41%             
client [81] (test)  loss: 4.6996 -> 4.7178   acc: 24.91% -> 23.67%             
client [3] (test)  loss: 4.7930 -> 4.7736   acc: 21.41% -> 24.02%              
client [11] (test)  loss: 5.3580 -> 5.4631   acc: 11.25% -> 13.15%             
client [95] (test)  loss: 4.7113 -> 4.7304   acc: 33.05% -> 33.26%             
client [67] (test)  loss: 4.4957 -> 4.6166   acc: 20.28% -> 19.58%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.7317 -> 3.8546   acc: 24.60% -> 22.60%             
client [79] (test)  loss: 5.4338 -> 5.5219   acc: 14.32% -> 14.32%             
client [58] (test)  loss: 5.6506 -> 5.6085   acc: 17.84% -> 16.25%             
client [88] (test)  loss: 5.1319 -> 5.1786   acc: 20.82% -> 22.18%             
client [46] (test)  loss: 4.7021 -> 4.7442   acc: 16.22% -> 19.10%             
client [11] (test)  loss: 5.4576 -> 5.5410   acc: 10.90% -> 12.80%             
client [55] (test)  loss: 5.2587 -> 5.3498   acc: 20.62% -> 18.98%             
client [13] (test)  loss: 5.0761 -> 5.1488   acc: 26.11% -> 23.72%             
client [31] (test)  loss: 4.2960 -> 4.0801   acc: 37.46% -> 37.63%             
client [75] (test)  loss: 5.3371 -> 5.4075   acc: 24.00% -> 24.70%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.0651 -> 5.1064   acc: 20.68% -> 21.22%             
client [7] (test)  loss: 5.4528 -> 5.5797   acc: 15.62% -> 16.16%              
client [57] (test)  loss: 4.9893 -> 5.0595   acc: 18.00% -> 18.36%             
client [13] (test)  loss: 5.1681 -> 5.2673   acc: 25.09% -> 24.06%             
client [43] (test)  loss: 4.9553 -> 5.0836   acc: 23.16% -> 22.68%             
client [91] (test)  loss: 4.0379 -> 4.0325   acc: 27.92% -> 27.58%             
client [10] (test)  loss: 5.0041 -> 5.0592   acc: 17.72% -> 19.59%             
client [64] (test)  loss: 4.8304 -> 4.6433   acc: 33.00% -> 32.84%             
client [82] (test)  loss: 5.4625 -> 5.4072   acc: 21.75% -> 23.38%             
client [22] (test)  loss: 4.4266 -> 4.5298   acc: 22.68% -> 22.88%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.2059 -> 5.1522   acc: 19.55% -> 20.07%             
client [23] (test)  loss: 3.0785 -> 3.1336   acc: 29.73% -> 29.03%             
client [88] (test)  loss: 5.2085 -> 5.2606   acc: 21.50% -> 22.35%             
client [98] (test)  loss: 4.4762 -> 4.2698   acc: 28.54% -> 31.19%             
client [79] (test)  loss: 5.6593 -> 5.7344   acc: 14.32% -> 13.89%             
client [21] (test)  loss: 4.0587 -> 4.1479   acc: 24.20% -> 23.20%             
client [92] (test)  loss: 5.2212 -> 5.2623   acc: 21.63% -> 22.32%             
client [56] (test)  loss: 5.7647 -> 5.8063   acc: 13.35% -> 13.17%             
client [5] (test)  loss: 4.8356 -> 4.8265   acc: 20.54% -> 20.54%              
client [52] (test)  loss: 4.9086 -> 4.9382   acc: 20.21% -> 21.45%             
==================== LG-FedAvg TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '3.8192 -> 0.0000', 'accuracy': '23.23% -> 0.00%'},          
    200: {'loss': '4.9358 -> 0.0000', 'accuracy': '22.47% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg achieved 10.0%(14.44%) at epoch: 7                                   
LG-FedAvg achieved 20.0%(22.75%) at epoch: 28                                  
Convergence (test_after):                                                      
LG-FedAvg achieved 10.0%(15.54%) at epoch: 0                                   
LG-FedAvg achieved 20.0%(22.13%) at epoch: 13                                  
