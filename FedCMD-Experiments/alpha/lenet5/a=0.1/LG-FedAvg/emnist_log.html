==================== ALGORITHM: LG-FedAvg ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.3099 -> 0.2204   acc: 91.31% -> 93.73%             
client [81] (test)  loss: 0.6061 -> 0.2675   acc: 80.87% -> 90.48%             
client [21] (test)  loss: 19.5559 -> 0.4093   acc: 0.24% -> 89.83%             
client [68] (test)  loss: 1.0991 -> 0.6897   acc: 70.97% -> 81.80%             
client [93] (test)  loss: 0.2007 -> 0.1089   acc: 93.92% -> 96.17%             
client [31] (test)  loss: 0.7121 -> 0.3278   acc: 83.23% -> 91.10%             
client [20] (test)  loss: 0.3653 -> 0.2339   acc: 90.66% -> 94.01%             
client [59] (test)  loss: 10.1679 -> 0.6372   acc: 3.03% -> 80.16%             
client [48] (test)  loss: 1.0961 -> 0.7958   acc: 68.96% -> 76.50%             
client [34] (test)  loss: 0.5195 -> 0.3090   acc: 84.36% -> 90.50%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.8691 -> 0.4824   acc: 76.06% -> 86.87%             
client [99] (test)  loss: 0.1744 -> 0.1000   acc: 96.35% -> 97.72%             
client [67] (test)  loss: 1.5515 -> 0.9580   acc: 64.51% -> 74.68%             
client [0] (test)  loss: 0.3578 -> 0.2471   acc: 90.55% -> 93.27%              
client [76] (test)  loss: 0.5545 -> 0.3568   acc: 84.91% -> 90.75%             
client [41] (test)  loss: 0.7152 -> 0.4279   acc: 78.04% -> 85.19%             
client [62] (test)  loss: 10.9283 -> 0.3709   acc: 0.73% -> 90.97%             
client [2] (test)  loss: 15.1697 -> 0.6095   acc: 0.70% -> 84.44%              
client [14] (test)  loss: 0.4794 -> 0.3047   acc: 89.36% -> 92.05%             
client [46] (test)  loss: 0.1015 -> 0.0638   acc: 97.12% -> 98.49%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3588 -> 0.2667   acc: 89.85% -> 92.25%             
client [68] (test)  loss: 0.4879 -> 0.4368   acc: 86.60% -> 88.23%             
client [57] (test)  loss: 0.4467 -> 0.3094   acc: 89.48% -> 92.43%             
client [17] (test)  loss: 0.8132 -> 0.2080   acc: 71.73% -> 92.95%             
client [54] (test)  loss: 0.4686 -> 0.3964   acc: 87.41% -> 90.17%             
client [23] (test)  loss: 14.0186 -> 0.3022   acc: 2.10% -> 91.41%             
client [35] (test)  loss: 0.0538 -> 0.0404   acc: 98.52% -> 98.63%             
client [59] (test)  loss: 0.3943 -> 0.3409   acc: 85.67% -> 87.57%             
client [31] (test)  loss: 0.6758 -> 0.1709   acc: 80.40% -> 94.22%             
client [9] (test)  loss: 0.4225 -> 0.3031   acc: 87.83% -> 91.13%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7539 -> 0.5955   acc: 81.05% -> 84.32%             
client [33] (test)  loss: 0.1124 -> 0.1085   acc: 97.02% -> 97.20%             
client [16] (test)  loss: 0.5439 -> 0.4041   acc: 85.97% -> 88.28%             
client [44] (test)  loss: 1.3342 -> 0.8493   acc: 67.18% -> 74.31%             
client [8] (test)  loss: 0.4130 -> 0.4657   acc: 86.51% -> 86.21%              
client [31] (test)  loss: 1.1875 -> 0.1700   acc: 70.43% -> 94.19%             
client [47] (test)  loss: 0.4367 -> 0.3748   acc: 88.04% -> 90.03%             
client [36] (test)  loss: 0.7023 -> 0.3607   acc: 81.80% -> 91.40%             
client [20] (test)  loss: 0.2576 -> 0.1798   acc: 93.25% -> 95.65%             
client [56] (test)  loss: 0.0916 -> 0.0745   acc: 97.25% -> 97.80%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5142 -> 0.4666   acc: 81.71% -> 84.40%              
client [60] (test)  loss: 0.4456 -> 0.2892   acc: 88.69% -> 92.96%             
client [28] (test)  loss: 0.0087 -> 0.0076   acc: 99.87% -> 99.86%             
client [25] (test)  loss: 0.3385 -> 0.2820   acc: 91.62% -> 93.12%             
client [58] (test)  loss: 0.0255 -> 0.0241   acc: 99.48% -> 99.48%             
client [44] (test)  loss: 0.9111 -> 0.6721   acc: 72.51% -> 79.61%             
client [39] (test)  loss: 0.2743 -> 0.2366   acc: 93.32% -> 94.26%             
client [29] (test)  loss: 0.3368 -> 0.2737   acc: 90.09% -> 91.79%             
client [3] (test)  loss: 0.0536 -> 0.0267   acc: 98.31% -> 99.27%              
client [84] (test)  loss: 0.3422 -> 0.3184   acc: 91.00% -> 91.73%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2303 -> 0.1302   acc: 94.32% -> 96.77%             
client [84] (test)  loss: 0.3212 -> 0.3068   acc: 91.37% -> 91.94%             
client [10] (test)  loss: 0.8091 -> 0.4939   acc: 74.11% -> 82.62%             
client [36] (test)  loss: 0.3042 -> 0.2677   acc: 92.06% -> 93.08%             
client [65] (test)  loss: 0.4326 -> 0.4193   acc: 86.08% -> 86.57%             
client [81] (test)  loss: 0.3192 -> 0.2116   acc: 89.25% -> 92.53%             
client [79] (test)  loss: 0.4086 -> 0.3656   acc: 88.89% -> 89.94%             
client [42] (test)  loss: 0.3316 -> 0.3330   acc: 91.33% -> 91.43%             
client [11] (test)  loss: 0.2230 -> 0.1471   acc: 94.52% -> 96.52%             
client [96] (test)  loss: 0.3123 -> 0.2126   acc: 91.81% -> 94.15%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4726 -> 0.5015   acc: 86.04% -> 86.46%              
client [53] (test)  loss: 0.1519 -> 0.1100   acc: 96.17% -> 97.21%             
client [52] (test)  loss: 0.5845 -> 0.4930   acc: 83.91% -> 86.11%             
client [42] (test)  loss: 0.3453 -> 0.3404   acc: 90.75% -> 91.60%             
client [69] (test)  loss: 0.5370 -> 0.4201   acc: 87.66% -> 90.01%             
client [59] (test)  loss: 0.3327 -> 0.3340   acc: 88.45% -> 88.53%             
client [7] (test)  loss: 0.4015 -> 0.3787   acc: 89.84% -> 90.96%              
client [26] (test)  loss: 0.2501 -> 0.2248   acc: 93.17% -> 93.50%             
client [49] (test)  loss: 0.0014 -> 0.0009   acc: 99.98% -> 100.00%            
client [98] (test)  loss: 0.0945 -> 0.0935   acc: 98.09% -> 98.20%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.0959 -> 0.0943   acc: 98.18% -> 98.20%             
client [47] (test)  loss: 0.3701 -> 0.3584   acc: 90.15% -> 90.06%             
client [21] (test)  loss: 0.1532 -> 0.1106   acc: 95.99% -> 97.33%             
client [77] (test)  loss: 0.2123 -> 0.1783   acc: 94.53% -> 95.68%             
client [95] (test)  loss: 0.1865 -> 0.1584   acc: 95.45% -> 96.35%             
client [91] (test)  loss: 0.1974 -> 0.1420   acc: 95.44% -> 96.79%             
client [14] (test)  loss: 0.3243 -> 0.2950   acc: 91.88% -> 93.11%             
client [99] (test)  loss: 0.0835 -> 0.0768   acc: 98.24% -> 98.63%             
client [20] (test)  loss: 0.2150 -> 0.1935   acc: 95.05% -> 95.74%             
client [39] (test)  loss: 0.2255 -> 0.1981   acc: 93.94% -> 94.99%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5227 -> 0.4920   acc: 84.84% -> 85.78%             
client [62] (test)  loss: 0.2033 -> 0.1753   acc: 95.71% -> 96.42%             
client [71] (test)  loss: 0.0141 -> 0.0121   acc: 99.52% -> 99.66%             
client [97] (test)  loss: 0.0322 -> 0.0203   acc: 98.84% -> 99.34%             
client [30] (test)  loss: 0.2076 -> 0.2224   acc: 94.89% -> 94.51%             
client [88] (test)  loss: 0.3910 -> 0.3827   acc: 87.41% -> 87.33%             
client [60] (test)  loss: 0.2494 -> 0.2196   acc: 93.97% -> 94.50%             
client [82] (test)  loss: 0.6798 -> 0.6251   acc: 68.51% -> 70.87%             
client [91] (test)  loss: 0.2472 -> 0.1441   acc: 94.19% -> 96.69%             
client [57] (test)  loss: 0.2411 -> 0.2214   acc: 94.28% -> 94.51%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7104 -> 0.2893   acc: 83.52% -> 93.32%             
client [15] (test)  loss: 0.0529 -> 0.0472   acc: 98.84% -> 98.92%             
client [71] (test)  loss: 0.0135 -> 0.0119   acc: 99.55% -> 99.68%             
client [97] (test)  loss: 0.0211 -> 0.0191   acc: 99.32% -> 99.43%             
client [53] (test)  loss: 0.1263 -> 0.1000   acc: 97.39% -> 97.64%             
client [77] (test)  loss: 0.2292 -> 0.1814   acc: 94.68% -> 95.70%             
client [76] (test)  loss: 0.3207 -> 0.2894   acc: 91.58% -> 92.47%             
client [79] (test)  loss: 0.4211 -> 0.3851   acc: 89.04% -> 89.51%             
client [28] (test)  loss: 0.0075 -> 0.0076   acc: 99.87% -> 99.84%             
client [99] (test)  loss: 0.0848 -> 0.0786   acc: 98.28% -> 98.71%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0232 -> 0.0190   acc: 99.25% -> 99.46%             
client [86] (test)  loss: 0.5400 -> 0.5704   acc: 84.82% -> 84.86%             
client [34] (test)  loss: 0.1999 -> 0.1636   acc: 95.29% -> 96.64%             
client [73] (test)  loss: 0.3450 -> 0.3561   acc: 90.11% -> 89.90%             
client [5] (test)  loss: 0.2791 -> 0.2238   acc: 94.22% -> 95.30%              
client [96] (test)  loss: 0.4279 -> 0.2802   acc: 91.72% -> 94.77%             
client [22] (test)  loss: 0.2082 -> 0.2025   acc: 93.40% -> 93.72%             
client [60] (test)  loss: 0.2590 -> 0.2311   acc: 93.78% -> 94.82%             
client [66] (test)  loss: 0.3401 -> 0.3064   acc: 91.57% -> 92.83%             
client [83] (test)  loss: 0.2056 -> 0.1871   acc: 94.59% -> 95.01%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3325 -> 0.3138   acc: 92.21% -> 92.41%             
client [65] (test)  loss: 0.4673 -> 0.4610   acc: 85.31% -> 85.59%             
client [95] (test)  loss: 0.1952 -> 0.1771   acc: 95.97% -> 96.40%             
client [17] (test)  loss: 0.3047 -> 0.1898   acc: 90.84% -> 94.10%             
client [8] (test)  loss: 0.4652 -> 0.5099   acc: 86.21% -> 86.38%              
client [35] (test)  loss: 0.0294 -> 0.0285   acc: 99.11% -> 99.13%             
client [98] (test)  loss: 0.0988 -> 0.0986   acc: 98.30% -> 98.20%             
client [53] (test)  loss: 0.1171 -> 0.1009   acc: 97.60% -> 97.70%             
client [43] (test)  loss: 0.5715 -> 0.5433   acc: 85.61% -> 86.82%             
client [64] (test)  loss: 0.5017 -> 0.4970   acc: 86.30% -> 86.37%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1461 -> 0.1041   acc: 96.36% -> 97.43%             
client [88] (test)  loss: 0.4179 -> 0.4242   acc: 88.09% -> 88.04%             
client [38] (test)  loss: 0.4501 -> 0.4178   acc: 90.10% -> 91.15%             
client [3] (test)  loss: 0.0353 -> 0.0301   acc: 99.17% -> 99.38%              
client [5] (test)  loss: 0.2934 -> 0.2389   acc: 94.34% -> 95.27%              
client [41] (test)  loss: 0.5278 -> 0.5311   acc: 86.76% -> 87.06%             
client [7] (test)  loss: 0.4132 -> 0.3962   acc: 90.55% -> 90.86%              
client [37] (test)  loss: 0.0625 -> 0.0527   acc: 97.96% -> 98.41%             
client [45] (test)  loss: 0.4869 -> 0.4568   acc: 84.28% -> 84.74%             
client [47] (test)  loss: 0.3913 -> 0.3729   acc: 89.72% -> 90.37%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5073 -> 0.4393   acc: 84.98% -> 87.70%             
client [11] (test)  loss: 0.1818 -> 0.1586   acc: 96.23% -> 96.63%             
client [37] (test)  loss: 0.0660 -> 0.0530   acc: 98.05% -> 98.46%             
client [41] (test)  loss: 0.5343 -> 0.5303   acc: 86.97% -> 87.23%             
client [95] (test)  loss: 0.2188 -> 0.1916   acc: 95.88% -> 96.46%             
client [53] (test)  loss: 0.1146 -> 0.1021   acc: 97.68% -> 97.66%             
client [22] (test)  loss: 0.2388 -> 0.2477   acc: 92.61% -> 92.99%             
client [25] (test)  loss: 0.2593 -> 0.2334   acc: 93.52% -> 94.22%             
client [69] (test)  loss: 0.5597 -> 0.5121   acc: 89.62% -> 90.20%             
client [46] (test)  loss: 0.0451 -> 0.0435   acc: 98.79% -> 98.93%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4411 -> 0.4390   acc: 89.75% -> 90.92%             
client [69] (test)  loss: 0.6026 -> 0.5295   acc: 89.42% -> 90.24%             
client [82] (test)  loss: 0.7315 -> 0.6861   acc: 68.03% -> 69.46%             
client [45] (test)  loss: 0.5238 -> 0.4947   acc: 84.30% -> 84.72%             
client [7] (test)  loss: 0.4139 -> 0.4099   acc: 90.65% -> 90.96%              
client [50] (test)  loss: 0.2038 -> 0.1901   acc: 95.42% -> 95.72%             
client [35] (test)  loss: 0.0271 -> 0.0281   acc: 99.15% -> 99.11%             
client [24] (test)  loss: 0.3156 -> 0.3109   acc: 92.01% -> 92.38%             
client [15] (test)  loss: 0.0477 -> 0.0468   acc: 99.04% -> 99.08%             
client [58] (test)  loss: 0.0258 -> 0.0251   acc: 99.55% -> 99.53%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0550 -> 0.9587   acc: 75.37% -> 77.57%             
client [76] (test)  loss: 0.3458 -> 0.3379   acc: 92.26% -> 92.32%             
client [67] (test)  loss: 0.5267 -> 0.5179   acc: 84.23% -> 84.78%             
client [37] (test)  loss: 0.0551 -> 0.0534   acc: 98.32% -> 98.44%             
client [58] (test)  loss: 0.0257 -> 0.0252   acc: 99.55% -> 99.53%             
client [64] (test)  loss: 0.4983 -> 0.5101   acc: 87.22% -> 86.87%             
client [77] (test)  loss: 0.2220 -> 0.1981   acc: 95.30% -> 95.72%             
client [55] (test)  loss: 0.1656 -> 0.1555   acc: 96.62% -> 96.80%             
client [12] (test)  loss: 0.6410 -> 0.5866   acc: 87.54% -> 88.24%             
client [89] (test)  loss: 0.4979 -> 0.4718   acc: 86.76% -> 87.63%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4329 -> 0.4055   acc: 90.89% -> 91.10%             
client [51] (test)  loss: 0.6169 -> 0.6375   acc: 88.44% -> 88.27%             
client [8] (test)  loss: 0.6758 -> 0.6873   acc: 86.24% -> 86.46%              
client [18] (test)  loss: 0.0530 -> 0.0501   acc: 98.42% -> 98.62%             
client [94] (test)  loss: 0.0044 -> 0.0042   acc: 99.79% -> 99.79%             
client [81] (test)  loss: 0.5196 -> 0.3600   acc: 90.09% -> 91.78%             
client [3] (test)  loss: 0.0326 -> 0.0311   acc: 99.38% -> 99.39%              
client [11] (test)  loss: 0.1927 -> 0.1691   acc: 96.28% -> 96.70%             
client [95] (test)  loss: 0.2309 -> 0.2116   acc: 96.05% -> 96.40%             
client [67] (test)  loss: 0.5336 -> 0.5209   acc: 84.30% -> 84.78%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1110 -> 0.1028   acc: 97.26% -> 97.38%             
client [79] (test)  loss: 0.5426 -> 0.5519   acc: 88.85% -> 88.82%             
client [58] (test)  loss: 0.0265 -> 0.0259   acc: 99.50% -> 99.55%             
client [88] (test)  loss: 0.4914 -> 0.4898   acc: 87.16% -> 87.71%             
client [46] (test)  loss: 0.0428 -> 0.0421   acc: 98.95% -> 99.02%             
client [11] (test)  loss: 0.1903 -> 0.1717   acc: 96.34% -> 96.70%             
client [55] (test)  loss: 0.1776 -> 0.1723   acc: 96.41% -> 96.83%             
client [13] (test)  loss: 0.2225 -> 0.2049   acc: 96.00% -> 96.33%             
client [31] (test)  loss: 0.5324 -> 0.2840   acc: 88.17% -> 93.54%             
client [75] (test)  loss: 0.5452 -> 0.4983   acc: 90.38% -> 91.43%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1666 -> 0.1481   acc: 96.98% -> 97.43%             
client [7] (test)  loss: 0.4895 -> 0.4871   acc: 90.70% -> 90.52%              
client [57] (test)  loss: 0.2300 -> 0.2281   acc: 95.28% -> 95.43%             
client [13] (test)  loss: 0.2240 -> 0.2106   acc: 96.21% -> 96.35%             
client [43] (test)  loss: 0.8179 -> 0.6670   acc: 84.60% -> 86.32%             
client [91] (test)  loss: 0.2259 -> 0.1548   acc: 95.11% -> 96.74%             
client [10] (test)  loss: 0.7753 -> 0.6603   acc: 80.49% -> 84.16%             
client [64] (test)  loss: 0.5685 -> 0.5918   acc: 86.16% -> 86.30%             
client [82] (test)  loss: 0.9205 -> 1.0286   acc: 66.77% -> 66.84%             
client [22] (test)  loss: 0.3088 -> 0.2998   acc: 93.53% -> 94.50%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2076 -> 0.2073   acc: 95.67% -> 96.01%             
client [23] (test)  loss: 0.1523 -> 0.1500   acc: 95.55% -> 95.79%             
client [88] (test)  loss: 0.5366 -> 0.5123   acc: 87.13% -> 87.76%             
client [98] (test)  loss: 0.1103 -> 0.1112   acc: 98.11% -> 98.13%             
client [79] (test)  loss: 0.5920 -> 0.5875   acc: 88.33% -> 88.95%             
client [21] (test)  loss: 0.1135 -> 0.1040   acc: 97.28% -> 97.45%             
client [92] (test)  loss: 0.2017 -> 0.1509   acc: 95.95% -> 96.83%             
client [56] (test)  loss: 0.0723 -> 0.0728   acc: 98.27% -> 98.18%             
client [5] (test)  loss: 0.3206 -> 0.2960   acc: 94.88% -> 94.92%              
client [52] (test)  loss: 0.7282 -> 0.6721   acc: 86.19% -> 87.34%             
==================== LG-FedAvg TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.2615 -> 0.0000', 'accuracy': '93.02% -> 0.00%'},          
    200: {'loss': '0.3343 -> 0.0000', 'accuracy': '93.23% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg achieved 30.0%(33.59%) at epoch: 1                                   
LG-FedAvg achieved 60.0%(63.07%) at epoch: 4                                   
LG-FedAvg achieved 70.0%(73.21%) at epoch: 7                                   
LG-FedAvg achieved 80.0%(83.54%) at epoch: 18                                  
LG-FedAvg achieved 90.0%(90.24%) at epoch: 22                                  
Convergence (test_after):                                                      
LG-FedAvg achieved 90.0%(91.30%) at epoch: 0                                   
