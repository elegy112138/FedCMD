==================== ALGORITHM: LG-FedAvg ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0142 -> 0.0026   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.5728 -> 0.4063   acc: 91.18% -> 91.18%             
client [21] (test)  loss: 7.2760 -> 0.0388   acc: 5.05% -> 99.35%              
client [68] (test)  loss: 1.8187 -> 1.3329   acc: 49.67% -> 49.67%             
client [93] (test)  loss: 0.8718 -> 0.4641   acc: 73.44% -> 85.25%             
client [31] (test)  loss: 1.2087 -> 0.7689   acc: 65.14% -> 65.14%             
client [20] (test)  loss: 0.5429 -> 0.4334   acc: 86.11% -> 86.11%             
client [59] (test)  loss: 9.0260 -> 0.7010   acc: 14.39% -> 71.95%             
client [48] (test)  loss: 0.7679 -> 0.6255   acc: 82.17% -> 82.17%             
client [34] (test)  loss: 0.5278 -> 0.3351   acc: 83.33% -> 83.33%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6557 -> 0.2908   acc: 84.72% -> 92.50%             
client [99] (test)  loss: 0.0737 -> 0.0761   acc: 98.95% -> 98.95%             
client [67] (test)  loss: 1.1365 -> 0.8003   acc: 70.35% -> 80.09%             
client [0] (test)  loss: 0.0637 -> 0.0557   acc: 98.84% -> 98.84%              
client [76] (test)  loss: 0.5647 -> 0.3357   acc: 94.44% -> 94.44%             
client [41] (test)  loss: 0.3332 -> 0.2077   acc: 90.59% -> 91.53%             
client [62] (test)  loss: 12.5601 -> 0.9738   acc: 0.00% -> 63.03%             
client [2] (test)  loss: 17.1252 -> 0.2694   acc: 0.78% -> 94.96%              
client [14] (test)  loss: 0.4086 -> 0.2677   acc: 79.51% -> 88.93%             
client [46] (test)  loss: 0.3779 -> 0.2788   acc: 91.04% -> 91.62%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0830 -> 0.9217   acc: 66.00% -> 66.00%             
client [68] (test)  loss: 0.8621 -> 0.7608   acc: 81.05% -> 84.97%             
client [57] (test)  loss: 0.1424 -> 0.1045   acc: 98.61% -> 98.92%             
client [17] (test)  loss: 0.5012 -> 0.4861   acc: 91.11% -> 91.11%             
client [54] (test)  loss: 0.2869 -> 0.2605   acc: 90.58% -> 92.75%             
client [23] (test)  loss: 9.0384 -> 2.0472   acc: 13.85% -> 44.62%             
client [35] (test)  loss: 0.7177 -> 0.6042   acc: 83.98% -> 84.42%             
client [59] (test)  loss: 0.1071 -> 0.0655   acc: 99.02% -> 99.51%             
client [31] (test)  loss: 0.3284 -> 0.2798   acc: 92.66% -> 92.20%             
client [9] (test)  loss: 0.2506 -> 0.1971   acc: 95.22% -> 96.05%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.0008 -> 0.0004   acc: 100.00% -> 100.00%           
client [33] (test)  loss: 0.1171 -> 0.0734   acc: 96.22% -> 96.56%             
client [16] (test)  loss: 0.0936 -> 0.0752   acc: 98.91% -> 98.91%             
client [44] (test)  loss: 0.0382 -> 0.0025   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.3544 -> 0.3352   acc: 89.33% -> 89.89%              
client [31] (test)  loss: 0.2546 -> 0.2287   acc: 92.66% -> 93.12%             
client [47] (test)  loss: 0.0837 -> 0.0427   acc: 95.80% -> 98.88%             
client [36] (test)  loss: 2.0306 -> 1.5177   acc: 100.00% -> 100.00%           
client [20] (test)  loss: 0.3516 -> 0.3284   acc: 90.28% -> 95.83%             
client [56] (test)  loss: 0.6690 -> 0.3450   acc: 93.75% -> 93.75%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0119 -> 0.0100   acc: 99.79% -> 99.79%              
client [60] (test)  loss: 0.0035 -> 0.0015   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.3443 -> 0.2985   acc: 85.71% -> 85.71%             
client [25] (test)  loss: 0.2860 -> 0.2016   acc: 91.50% -> 94.27%             
client [58] (test)  loss: 0.2688 -> 0.2482   acc: 91.32% -> 93.00%             
client [44] (test)  loss: 0.0027 -> 0.0014   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 0.6091 -> 0.3876   acc: 88.05% -> 90.27%             
client [29] (test)  loss: 0.0817 -> 0.0602   acc: 99.03% -> 99.03%             
client [3] (test)  loss: 0.0021 -> 0.0013   acc: 100.00% -> 100.00%            
client [84] (test)  loss: 0.0064 -> 0.0052   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0279 -> 0.0255   acc: 99.35% -> 99.35%             
client [84] (test)  loss: 0.0048 -> 0.0042   acc: 100.00% -> 100.00%           
client [10] (test)  loss: 0.5452 -> 0.4971   acc: 78.67% -> 78.67%             
client [36] (test)  loss: 0.3012 -> 0.1282   acc: 100.00% -> 100.00%           
client [65] (test)  loss: 0.2795 -> 0.2517   acc: 90.40% -> 90.40%             
client [81] (test)  loss: 0.3538 -> 0.3470   acc: 91.18% -> 91.18%             
client [79] (test)  loss: 0.2000 -> 0.1848   acc: 94.26% -> 94.51%             
client [42] (test)  loss: 0.5675 -> 0.4647   acc: 83.72% -> 94.19%             
client [11] (test)  loss: 0.2741 -> 0.2114   acc: 92.51% -> 95.45%             
client [96] (test)  loss: 0.2047 -> 0.1781   acc: 95.13% -> 94.84%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3097 -> 0.2942   acc: 90.17% -> 90.45%              
client [53] (test)  loss: 0.5412 -> 0.4165   acc: 86.12% -> 90.91%             
client [52] (test)  loss: 0.3714 -> 0.2995   acc: 89.61% -> 96.10%             
client [42] (test)  loss: 0.3814 -> 0.3214   acc: 96.51% -> 97.67%             
client [69] (test)  loss: 0.1073 -> 0.0954   acc: 97.50% -> 97.50%             
client [59] (test)  loss: 0.0415 -> 0.0375   acc: 99.76% -> 99.76%             
client [7] (test)  loss: 0.0389 -> 0.0313   acc: 98.75% -> 99.17%              
client [26] (test)  loss: 0.1398 -> 0.1094   acc: 95.47% -> 96.42%             
client [49] (test)  loss: 0.1947 -> 0.1638   acc: 94.97% -> 96.65%             
client [98] (test)  loss: 0.9388 -> 0.9050   acc: 76.47% -> 79.41%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9097 -> 0.8760   acc: 76.47% -> 79.41%             
client [47] (test)  loss: 0.0352 -> 0.0171   acc: 99.16% -> 99.72%             
client [21] (test)  loss: 0.0241 -> 0.0226   acc: 99.35% -> 99.35%             
client [77] (test)  loss: 0.0009 -> 0.0006   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.0481 -> 0.0451   acc: 98.66% -> 98.66%             
client [91] (test)  loss: 0.4095 -> 0.3902   acc: 89.92% -> 89.92%             
client [14] (test)  loss: 0.1181 -> 0.1024   acc: 95.08% -> 95.49%             
client [99] (test)  loss: 0.0737 -> 0.0705   acc: 98.95% -> 98.95%             
client [20] (test)  loss: 0.2994 -> 0.2956   acc: 97.22% -> 97.22%             
client [39] (test)  loss: 0.3463 -> 0.2735   acc: 90.71% -> 90.71%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3222 -> 0.2479   acc: 94.81% -> 96.10%             
client [62] (test)  loss: 0.1378 -> 0.1390   acc: 94.96% -> 94.96%             
client [71] (test)  loss: 0.1033 -> 0.0957   acc: 96.60% -> 97.10%             
client [97] (test)  loss: 0.0716 -> 0.0538   acc: 97.59% -> 98.66%             
client [30] (test)  loss: 0.5605 -> 0.5519   acc: 81.25% -> 81.25%             
client [88] (test)  loss: 0.1063 -> 0.0852   acc: 97.81% -> 97.81%             
client [60] (test)  loss: 0.0007 -> 0.0004   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.2741 -> 0.2849   acc: 94.12% -> 95.10%             
client [91] (test)  loss: 0.3754 -> 0.3637   acc: 89.92% -> 89.92%             
client [57] (test)  loss: 0.0828 -> 0.0792   acc: 98.92% -> 98.92%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1659 -> 0.1639   acc: 94.04% -> 94.04%             
client [15] (test)  loss: 0.5447 -> 0.5123   acc: 85.71% -> 85.71%             
client [71] (test)  loss: 0.1008 -> 0.0927   acc: 96.98% -> 97.36%             
client [97] (test)  loss: 0.0388 -> 0.0327   acc: 99.20% -> 99.20%             
client [53] (test)  loss: 0.3107 -> 0.2819   acc: 91.39% -> 92.82%             
client [77] (test)  loss: 0.0007 -> 0.0006   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.3150 -> 0.3165   acc: 94.44% -> 94.44%             
client [79] (test)  loss: 0.1709 -> 0.1649   acc: 95.26% -> 95.26%             
client [28] (test)  loss: 0.1738 -> 0.1591   acc: 96.43% -> 96.43%             
client [99] (test)  loss: 0.0710 -> 0.0685   acc: 98.95% -> 98.95%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0306 -> 0.0268   acc: 99.20% -> 99.20%             
client [86] (test)  loss: 0.0341 -> 0.0285   acc: 100.00% -> 100.00%           
client [34] (test)  loss: 0.0603 -> 0.0604   acc: 99.02% -> 99.02%             
client [73] (test)  loss: 0.1450 -> 0.1365   acc: 96.62% -> 96.34%             
client [5] (test)  loss: 0.2100 -> 0.2004   acc: 93.95% -> 93.95%              
client [96] (test)  loss: 0.1076 -> 0.1043   acc: 95.13% -> 95.42%             
client [22] (test)  loss: 0.0096 -> 0.0100   acc: 99.56% -> 99.56%             
client [60] (test)  loss: 0.0004 -> 0.0002   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.9474 -> 0.9061   acc: 67.71% -> 68.75%             
client [83] (test)  loss: 0.1852 -> 0.1813   acc: 92.39% -> 92.39%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3120 -> 0.3134   acc: 94.44% -> 94.44%             
client [65] (test)  loss: 0.1955 -> 0.1815   acc: 90.96% -> 91.53%             
client [95] (test)  loss: 0.0421 -> 0.0397   acc: 98.66% -> 98.66%             
client [17] (test)  loss: 0.5334 -> 0.5344   acc: 91.11% -> 91.11%             
client [8] (test)  loss: 0.2676 -> 0.2611   acc: 90.45% -> 91.01%              
client [35] (test)  loss: 0.3663 -> 0.3538   acc: 86.58% -> 87.01%             
client [98] (test)  loss: 0.8367 -> 0.8191   acc: 79.41% -> 79.41%             
client [53] (test)  loss: 0.2724 -> 0.2600   acc: 93.30% -> 92.82%             
client [43] (test)  loss: 0.1287 -> 0.1242   acc: 94.47% -> 94.93%             
client [64] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0217 -> 0.0209   acc: 99.35% -> 99.35%             
client [88] (test)  loss: 0.0613 -> 0.0600   acc: 97.81% -> 97.53%             
client [38] (test)  loss: 0.0004 -> 0.0004   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%            
client [5] (test)  loss: 0.1938 -> 0.1835   acc: 94.42% -> 93.95%              
client [41] (test)  loss: 0.0579 -> 0.0549   acc: 98.35% -> 98.59%             
client [7] (test)  loss: 0.0246 -> 0.0214   acc: 99.17% -> 99.44%              
client [37] (test)  loss: 0.7156 -> 0.6442   acc: 81.58% -> 86.84%             
client [45] (test)  loss: 0.0275 -> 0.0225   acc: 99.18% -> 99.18%             
client [47] (test)  loss: 0.0133 -> 0.0092   acc: 100.00% -> 99.72%            
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0483 -> 0.0475   acc: 98.91% -> 98.91%             
client [11] (test)  loss: 0.1607 -> 0.1560   acc: 95.99% -> 96.26%             
client [37] (test)  loss: 0.5458 -> 0.5009   acc: 90.79% -> 90.79%             
client [41] (test)  loss: 0.0532 -> 0.0516   acc: 98.59% -> 98.59%             
client [95] (test)  loss: 0.0376 -> 0.0360   acc: 98.66% -> 98.66%             
client [53] (test)  loss: 0.2626 -> 0.2514   acc: 92.82% -> 92.82%             
client [22] (test)  loss: 0.0086 -> 0.0095   acc: 99.56% -> 99.56%             
client [25] (test)  loss: 0.1222 -> 0.1004   acc: 96.67% -> 96.86%             
client [69] (test)  loss: 0.0662 -> 0.0642   acc: 98.33% -> 98.06%             
client [46] (test)  loss: 0.1279 -> 0.1090   acc: 96.53% -> 97.11%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0062 -> 0.0058   acc: 99.72% -> 99.72%             
client [69] (test)  loss: 0.0635 -> 0.0618   acc: 98.06% -> 98.06%             
client [82] (test)  loss: 0.2927 -> 0.2994   acc: 94.12% -> 94.12%             
client [45] (test)  loss: 0.0178 -> 0.0161   acc: 99.73% -> 99.73%             
client [7] (test)  loss: 0.0220 -> 0.0197   acc: 99.44% -> 99.58%              
client [50] (test)  loss: 0.1786 -> 0.1430   acc: 92.48% -> 94.36%             
client [35] (test)  loss: 0.3490 -> 0.3415   acc: 87.01% -> 87.01%             
client [24] (test)  loss: 0.4584 -> 0.4483   acc: 88.00% -> 88.00%             
client [15] (test)  loss: 0.4422 -> 0.4284   acc: 90.48% -> 90.48%             
client [58] (test)  loss: 0.1867 -> 0.1835   acc: 94.96% -> 94.96%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2969 -> 0.2901   acc: 90.31% -> 90.70%             
client [76] (test)  loss: 0.3167 -> 0.3161   acc: 94.44% -> 94.44%             
client [67] (test)  loss: 0.2509 -> 0.2403   acc: 88.50% -> 90.71%             
client [37] (test)  loss: 0.4755 -> 0.4471   acc: 90.79% -> 90.79%             
client [58] (test)  loss: 0.1865 -> 0.1823   acc: 94.96% -> 94.96%             
client [64] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [77] (test)  loss: 0.0004 -> 0.0004   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.1605 -> 0.1017   acc: 94.22% -> 97.24%             
client [12] (test)  loss: 0.3596 -> 0.3379   acc: 92.47% -> 92.47%             
client [89] (test)  loss: 0.1501 -> 0.0900   acc: 96.09% -> 96.94%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0022 -> 0.0021   acc: 100.00% -> 100.00%           
client [51] (test)  loss: 0.0843 -> 0.0846   acc: 98.07% -> 98.07%             
client [8] (test)  loss: 0.2365 -> 0.2331   acc: 92.70% -> 92.70%              
client [18] (test)  loss: 0.3288 -> 0.3288   acc: 92.42% -> 93.18%             
client [94] (test)  loss: 0.2074 -> 0.1999   acc: 91.84% -> 92.65%             
client [81] (test)  loss: 0.2857 -> 0.2868   acc: 91.18% -> 91.18%             
client [3] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [11] (test)  loss: 0.1563 -> 0.1540   acc: 95.72% -> 95.99%             
client [95] (test)  loss: 0.0315 -> 0.0305   acc: 98.66% -> 98.66%             
client [67] (test)  loss: 0.2375 -> 0.2269   acc: 89.38% -> 91.59%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0199 -> 0.0192   acc: 99.35% -> 99.35%             
client [79] (test)  loss: 0.1600 -> 0.1683   acc: 95.26% -> 95.26%             
client [58] (test)  loss: 0.1835 -> 0.1822   acc: 94.96% -> 94.96%             
client [88] (test)  loss: 0.0554 -> 0.0546   acc: 97.81% -> 97.53%             
client [46] (test)  loss: 0.1007 -> 0.0907   acc: 97.40% -> 97.11%             
client [11] (test)  loss: 0.1560 -> 0.1541   acc: 96.26% -> 96.26%             
client [55] (test)  loss: 0.1275 -> 0.0915   acc: 96.23% -> 97.49%             
client [13] (test)  loss: 0.0629 -> 0.0662   acc: 97.76% -> 97.96%             
client [31] (test)  loss: 0.1583 -> 0.1575   acc: 94.04% -> 94.50%             
client [75] (test)  loss: 0.1323 -> 0.1280   acc: 95.51% -> 95.88%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0890 -> 0.0867   acc: 97.83% -> 97.83%             
client [7] (test)  loss: 0.0151 -> 0.0145   acc: 99.72% -> 99.58%              
client [57] (test)  loss: 0.0615 -> 0.0612   acc: 98.92% -> 98.92%             
client [13] (test)  loss: 0.0608 -> 0.0631   acc: 98.37% -> 98.37%             
client [43] (test)  loss: 0.1122 -> 0.1122   acc: 95.39% -> 95.85%             
client [91] (test)  loss: 0.3304 -> 0.3247   acc: 89.92% -> 89.92%             
client [10] (test)  loss: 0.2141 -> 0.2072   acc: 92.00% -> 92.00%             
client [64] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.3118 -> 0.3156   acc: 94.12% -> 94.12%             
client [22] (test)  loss: 0.0077 -> 0.0086   acc: 99.56% -> 99.71%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3048 -> 0.3092   acc: 97.22% -> 97.22%             
client [23] (test)  loss: 0.4675 -> 0.4281   acc: 86.15% -> 86.15%             
client [88] (test)  loss: 0.0540 -> 0.0532   acc: 97.53% -> 97.53%             
client [98] (test)  loss: 0.7369 -> 0.7243   acc: 79.41% -> 79.41%             
client [79] (test)  loss: 0.1637 -> 0.1713   acc: 95.26% -> 95.26%             
client [21] (test)  loss: 0.0189 -> 0.0184   acc: 99.35% -> 99.35%             
client [92] (test)  loss: 0.0863 -> 0.0840   acc: 97.96% -> 98.05%             
client [56] (test)  loss: 0.1288 -> 0.1236   acc: 93.75% -> 93.75%             
client [5] (test)  loss: 0.1525 -> 0.1480   acc: 94.88% -> 95.35%              
client [52] (test)  loss: 0.0927 -> 0.0894   acc: 97.40% -> 97.40%             
==================== LG-FedAvg TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.1191 -> 0.0000', 'accuracy': '96.63% -> 0.00%'},          
    200: {'loss': '0.0877 -> 0.0000', 'accuracy': '97.49% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg achieved 10.0%(18.80%) at epoch: 1                                   
LG-FedAvg achieved 20.0%(25.76%) at epoch: 2                                   
LG-FedAvg achieved 40.0%(45.91%) at epoch: 3                                   
LG-FedAvg achieved 70.0%(76.53%) at epoch: 7                                   
LG-FedAvg achieved 80.0%(86.27%) at epoch: 13                                  
LG-FedAvg achieved 90.0%(93.06%) at epoch: 24                                  
Convergence (test_after):                                                      
LG-FedAvg achieved 70.0%(75.91%) at epoch: 0                                   
LG-FedAvg achieved 80.0%(87.40%) at epoch: 1                                   
LG-FedAvg achieved 90.0%(93.11%) at epoch: 10                                  
