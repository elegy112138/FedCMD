==================== ALGORITHM: LG-FedAvg ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6357 -> 1.5452   acc: 47.47% -> 47.47%             
client [81] (test)  loss: 0.8488 -> 0.7862   acc: 82.41% -> 82.41%             
client [21] (test)  loss: 2.3847 -> 0.9158   acc: 2.47% -> 64.76%              
client [68] (test)  loss: 1.4769 -> 0.7437   acc: 71.29% -> 77.23%             
client [93] (test)  loss: 1.8344 -> 0.7234   acc: 86.75% -> 86.75%             
client [31] (test)  loss: 1.8572 -> 0.8636   acc: 84.42% -> 84.42%             
client [20] (test)  loss: 0.7288 -> 0.5004   acc: 73.19% -> 86.23%             
client [59] (test)  loss: 2.2925 -> 0.5540   acc: 81.73% -> 82.05%             
client [48] (test)  loss: 0.2710 -> 0.2421   acc: 94.20% -> 94.54%             
client [34] (test)  loss: 1.1330 -> 0.6401   acc: 56.22% -> 77.68%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.0797 -> 0.0632   acc: 97.39% -> 97.39%             
client [99] (test)  loss: 1.8432 -> 1.1168   acc: 65.74% -> 65.74%             
client [67] (test)  loss: 2.3306 -> 2.2405   acc: 27.59% -> 48.28%             
client [0] (test)  loss: 0.3453 -> 0.3008   acc: 87.45% -> 87.45%              
client [76] (test)  loss: 1.3097 -> 1.0020   acc: 58.49% -> 67.30%             
client [41] (test)  loss: 1.8551 -> 0.6041   acc: 98.31% -> 98.31%             
client [62] (test)  loss: 2.3240 -> 0.9974   acc: 59.00% -> 59.67%             
client [2] (test)  loss: 2.3621 -> 0.4108   acc: 0.63% -> 83.92%               
client [14] (test)  loss: 0.9990 -> 0.7638   acc: 79.20% -> 81.60%             
client [46] (test)  loss: 0.2672 -> 0.2360   acc: 94.26% -> 94.13%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.2941 -> 0.2444   acc: 91.33% -> 92.67%             
client [68] (test)  loss: 0.4533 -> 0.3155   acc: 89.77% -> 90.76%             
client [57] (test)  loss: 1.0763 -> 0.7239   acc: 79.79% -> 79.79%             
client [17] (test)  loss: 0.3902 -> 0.2847   acc: 87.02% -> 92.04%             
client [54] (test)  loss: 0.0483 -> 0.0321   acc: 98.75% -> 99.38%             
client [23] (test)  loss: 2.4391 -> 1.9351   acc: 0.00% -> 56.10%              
client [35] (test)  loss: 1.2762 -> 1.2381   acc: 51.79% -> 51.79%             
client [59] (test)  loss: 0.3701 -> 0.2485   acc: 90.38% -> 91.03%             
client [31] (test)  loss: 0.6215 -> 0.6229   acc: 84.42% -> 84.42%             
client [9] (test)  loss: 0.0408 -> 0.0344   acc: 99.26% -> 99.26%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2129 -> 0.1957   acc: 94.13% -> 94.13%             
client [33] (test)  loss: 0.6088 -> 0.5845   acc: 77.40% -> 79.81%             
client [16] (test)  loss: 1.2880 -> 1.3019   acc: 68.63% -> 68.63%             
client [44] (test)  loss: 0.2593 -> 0.1538   acc: 90.47% -> 91.84%             
client [8] (test)  loss: 0.7288 -> 0.7057   acc: 73.15% -> 73.15%              
client [31] (test)  loss: 0.6094 -> 0.6231   acc: 84.42% -> 84.42%             
client [47] (test)  loss: 1.0340 -> 0.8608   acc: 61.99% -> 68.42%             
client [36] (test)  loss: 1.2740 -> 0.5487   acc: 72.19% -> 91.39%             
client [20] (test)  loss: 0.4860 -> 0.2799   acc: 83.33% -> 92.03%             
client [56] (test)  loss: 1.8096 -> 1.3879   acc: 58.14% -> 58.14%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2543 -> 0.2464   acc: 92.11% -> 92.11%              
client [60] (test)  loss: 0.2823 -> 0.2049   acc: 91.95% -> 92.57%             
client [28] (test)  loss: 0.4000 -> 0.4191   acc: 90.64% -> 90.64%             
client [25] (test)  loss: 0.4609 -> 0.3880   acc: 84.55% -> 88.21%             
client [58] (test)  loss: 0.9258 -> 0.8669   acc: 66.39% -> 66.39%             
client [44] (test)  loss: 0.1665 -> 0.0979   acc: 91.63% -> 97.35%             
client [39] (test)  loss: 1.7699 -> 1.6523   acc: 35.42% -> 39.58%             
client [29] (test)  loss: 0.4883 -> 0.4006   acc: 75.62% -> 85.22%             
client [3] (test)  loss: 0.7198 -> 0.2253   acc: 63.27% -> 95.92%              
client [84] (test)  loss: 0.1370 -> 0.1353   acc: 97.26% -> 97.26%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6154 -> 0.3919   acc: 76.82% -> 87.48%             
client [84] (test)  loss: 0.1331 -> 0.1344   acc: 97.26% -> 97.26%             
client [10] (test)  loss: 0.3154 -> 0.2606   acc: 90.91% -> 93.51%             
client [36] (test)  loss: 0.3019 -> 0.2541   acc: 92.05% -> 94.04%             
client [65] (test)  loss: 0.3233 -> 0.3168   acc: 88.67% -> 89.06%             
client [81] (test)  loss: 0.6913 -> 0.6141   acc: 82.41% -> 88.89%             
client [79] (test)  loss: 0.9085 -> 0.8539   acc: 73.78% -> 73.78%             
client [42] (test)  loss: 0.3735 -> 0.3323   acc: 90.35% -> 91.51%             
client [11] (test)  loss: 0.7984 -> 0.5470   acc: 68.36% -> 81.19%             
client [96] (test)  loss: 0.3917 -> 0.3392   acc: 80.60% -> 82.27%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6727 -> 0.6471   acc: 73.83% -> 75.17%              
client [53] (test)  loss: 0.0298 -> 0.0294   acc: 99.54% -> 99.54%             
client [52] (test)  loss: 0.2469 -> 0.1983   acc: 94.84% -> 95.65%             
client [42] (test)  loss: 0.3788 -> 0.3013   acc: 93.05% -> 93.05%             
client [69] (test)  loss: 0.0146 -> 0.0123   acc: 99.60% -> 99.60%             
client [59] (test)  loss: 0.1590 -> 0.1504   acc: 94.55% -> 95.19%             
client [7] (test)  loss: 0.0616 -> 0.0485   acc: 99.05% -> 99.05%              
client [26] (test)  loss: 0.4438 -> 0.3705   acc: 90.48% -> 90.48%             
client [49] (test)  loss: 0.3132 -> 0.2184   acc: 93.18% -> 93.18%             
client [98] (test)  loss: 0.3948 -> 0.2833   acc: 89.30% -> 91.73%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3414 -> 0.2837   acc: 89.87% -> 91.73%             
client [47] (test)  loss: 0.7780 -> 0.6810   acc: 70.76% -> 81.29%             
client [21] (test)  loss: 0.4145 -> 0.3051   acc: 85.94% -> 90.73%             
client [77] (test)  loss: 1.3678 -> 1.3311   acc: 47.47% -> 48.73%             
client [95] (test)  loss: 0.2774 -> 0.1681   acc: 92.72% -> 95.07%             
client [91] (test)  loss: 0.0756 -> 0.0538   acc: 99.04% -> 99.36%             
client [14] (test)  loss: 0.3886 -> 0.3686   acc: 91.20% -> 89.60%             
client [99] (test)  loss: 0.7482 -> 0.7229   acc: 73.15% -> 76.85%             
client [20] (test)  loss: 0.2729 -> 0.2422   acc: 93.48% -> 92.75%             
client [39] (test)  loss: 1.5242 -> 1.4539   acc: 56.25% -> 56.25%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2082 -> 0.1900   acc: 95.11% -> 95.65%             
client [62] (test)  loss: 0.3710 -> 0.3609   acc: 86.00% -> 86.33%             
client [71] (test)  loss: 0.1673 -> 0.1713   acc: 94.40% -> 94.68%             
client [97] (test)  loss: 0.8499 -> 0.7906   acc: 74.29% -> 75.00%             
client [30] (test)  loss: 0.7795 -> 0.7523   acc: 72.73% -> 72.73%             
client [88] (test)  loss: 0.4139 -> 0.3640   acc: 88.14% -> 88.14%             
client [60] (test)  loss: 0.1095 -> 0.1016   acc: 97.06% -> 97.21%             
client [82] (test)  loss: 0.6968 -> 0.6355   acc: 77.37% -> 78.83%             
client [91] (test)  loss: 0.0653 -> 0.0489   acc: 98.41% -> 99.36%             
client [57] (test)  loss: 0.5333 -> 0.4941   acc: 88.30% -> 88.30%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6025 -> 0.6219   acc: 84.42% -> 84.42%             
client [15] (test)  loss: 0.4015 -> 0.3623   acc: 86.47% -> 88.78%             
client [71] (test)  loss: 0.1638 -> 0.1721   acc: 94.40% -> 94.68%             
client [97] (test)  loss: 0.7487 -> 0.7372   acc: 75.00% -> 75.00%             
client [53] (test)  loss: 0.0295 -> 0.0295   acc: 99.54% -> 99.54%             
client [77] (test)  loss: 1.3522 -> 1.3020   acc: 48.10% -> 50.63%             
client [76] (test)  loss: 0.4371 -> 0.3812   acc: 90.57% -> 89.94%             
client [79] (test)  loss: 0.7936 -> 0.7670   acc: 77.44% -> 78.05%             
client [28] (test)  loss: 0.3671 -> 0.3929   acc: 91.78% -> 92.24%             
client [99] (test)  loss: 0.7054 -> 0.6900   acc: 75.93% -> 76.85%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7532 -> 0.7328   acc: 77.14% -> 75.71%             
client [86] (test)  loss: 0.8732 -> 0.8184   acc: 68.60% -> 68.60%             
client [34] (test)  loss: 0.2183 -> 0.2150   acc: 90.56% -> 90.56%             
client [73] (test)  loss: 0.1166 -> 0.1118   acc: 97.35% -> 97.35%             
client [5] (test)  loss: 0.7094 -> 0.6854   acc: 78.89% -> 80.40%              
client [96] (test)  loss: 0.2056 -> 0.2138   acc: 92.31% -> 91.30%             
client [22] (test)  loss: 0.4108 -> 0.3609   acc: 88.41% -> 89.13%             
client [60] (test)  loss: 0.1083 -> 0.0863   acc: 96.28% -> 97.21%             
client [66] (test)  loss: 0.0093 -> 0.0059   acc: 99.73% -> 99.80%             
client [83] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2979 -> 0.2772   acc: 91.82% -> 91.82%             
client [65] (test)  loss: 0.2965 -> 0.2912   acc: 91.41% -> 91.41%             
client [95] (test)  loss: 0.1359 -> 0.1122   acc: 97.18% -> 96.24%             
client [17] (test)  loss: 0.2393 -> 0.2176   acc: 92.63% -> 94.99%             
client [8] (test)  loss: 0.6024 -> 0.5929   acc: 77.85% -> 78.52%              
client [35] (test)  loss: 0.8773 -> 0.8614   acc: 75.00% -> 75.00%             
client [98] (test)  loss: 0.3352 -> 0.2867   acc: 90.44% -> 92.15%             
client [53] (test)  loss: 0.0296 -> 0.0296   acc: 99.54% -> 99.54%             
client [43] (test)  loss: 0.9295 -> 0.8927   acc: 69.87% -> 71.18%             
client [64] (test)  loss: 0.1393 -> 0.1230   acc: 95.40% -> 96.35%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4051 -> 0.2839   acc: 87.94% -> 90.88%             
client [88] (test)  loss: 0.3112 -> 0.2878   acc: 90.40% -> 89.83%             
client [38] (test)  loss: 0.6732 -> 0.6052   acc: 79.21% -> 78.71%             
client [3] (test)  loss: 0.1242 -> 0.1069   acc: 96.94% -> 97.96%              
client [5] (test)  loss: 0.6803 -> 0.6753   acc: 80.40% -> 80.40%              
client [41] (test)  loss: 0.1920 -> 0.2043   acc: 98.31% -> 98.31%             
client [7] (test)  loss: 0.0448 -> 0.0368   acc: 98.89% -> 99.37%              
client [37] (test)  loss: 0.2157 -> 0.2114   acc: 94.22% -> 94.50%             
client [45] (test)  loss: 0.1784 -> 0.1786   acc: 93.01% -> 93.31%             
client [47] (test)  loss: 0.5982 -> 0.5738   acc: 84.80% -> 84.80%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0017 -> 0.9983   acc: 68.63% -> 68.63%             
client [11] (test)  loss: 0.5831 -> 0.4090   acc: 77.91% -> 84.78%             
client [37] (test)  loss: 0.2184 -> 0.2191   acc: 93.79% -> 94.22%             
client [41] (test)  loss: 0.2046 -> 0.2088   acc: 98.31% -> 98.31%             
client [95] (test)  loss: 0.0878 -> 0.0836   acc: 97.65% -> 97.18%             
client [53] (test)  loss: 0.0300 -> 0.0296   acc: 99.54% -> 99.54%             
client [22] (test)  loss: 0.3348 -> 0.3073   acc: 89.13% -> 89.86%             
client [25] (test)  loss: 0.2874 -> 0.2755   acc: 91.46% -> 91.87%             
client [69] (test)  loss: 0.0063 -> 0.0058   acc: 100.00% -> 100.00%           
client [46] (test)  loss: 0.1908 -> 0.1915   acc: 95.19% -> 95.06%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5591 -> 0.5914   acc: 84.21% -> 84.80%             
client [69] (test)  loss: 0.0057 -> 0.0052   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.5534 -> 0.5340   acc: 80.29% -> 81.02%             
client [45] (test)  loss: 0.1791 -> 0.1907   acc: 92.71% -> 93.31%             
client [7] (test)  loss: 0.0417 -> 0.0348   acc: 99.05% -> 99.37%              
client [50] (test)  loss: 0.5164 -> 0.5009   acc: 80.39% -> 83.01%             
client [35] (test)  loss: 0.8578 -> 0.8426   acc: 76.79% -> 76.79%             
client [24] (test)  loss: 0.1213 -> 0.1115   acc: 97.00% -> 97.00%             
client [15] (test)  loss: 0.3668 -> 0.3380   acc: 87.79% -> 87.79%             
client [58] (test)  loss: 0.4456 -> 0.4464   acc: 84.87% -> 84.87%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2018 -> 0.2064   acc: 95.22% -> 95.22%             
client [76] (test)  loss: 0.2595 -> 0.2466   acc: 91.82% -> 91.19%             
client [67] (test)  loss: 1.5699 -> 1.5608   acc: 48.28% -> 48.28%             
client [37] (test)  loss: 0.2307 -> 0.2255   acc: 93.79% -> 94.08%             
client [58] (test)  loss: 0.4369 -> 0.4305   acc: 85.71% -> 85.71%             
client [64] (test)  loss: 0.1235 -> 0.1133   acc: 96.98% -> 97.30%             
client [77] (test)  loss: 1.2512 -> 1.1946   acc: 51.90% -> 55.06%             
client [55] (test)  loss: 0.1291 -> 0.1214   acc: 96.94% -> 96.94%             
client [12] (test)  loss: 0.8396 -> 0.8110   acc: 76.47% -> 75.29%             
client [89] (test)  loss: 0.1962 -> 0.1913   acc: 96.13% -> 96.13%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1304 -> 0.1296   acc: 97.26% -> 97.26%             
client [51] (test)  loss: 0.2429 -> 0.2407   acc: 92.99% -> 92.99%             
client [8] (test)  loss: 0.5796 -> 0.5702   acc: 81.21% -> 81.21%              
client [18] (test)  loss: 0.7351 -> 0.7302   acc: 80.28% -> 82.63%             
client [94] (test)  loss: 0.5796 -> 0.5613   acc: 79.67% -> 79.67%             
client [81] (test)  loss: 0.7745 -> 0.7533   acc: 88.89% -> 88.89%             
client [3] (test)  loss: 0.1271 -> 0.0959   acc: 96.94% -> 97.96%              
client [11] (test)  loss: 0.5075 -> 0.4019   acc: 81.49% -> 86.27%             
client [95] (test)  loss: 0.0691 -> 0.0637   acc: 96.71% -> 96.71%             
client [67] (test)  loss: 1.5750 -> 1.5593   acc: 48.28% -> 48.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3562 -> 0.2848   acc: 89.34% -> 91.34%             
client [79] (test)  loss: 0.7200 -> 0.7638   acc: 81.71% -> 81.71%             
client [58] (test)  loss: 0.4045 -> 0.4087   acc: 85.71% -> 85.71%             
client [88] (test)  loss: 0.2891 -> 0.2752   acc: 89.83% -> 90.96%             
client [46] (test)  loss: 0.1879 -> 0.1919   acc: 95.06% -> 95.06%             
client [11] (test)  loss: 0.4864 -> 0.4019   acc: 83.58% -> 87.16%             
client [55] (test)  loss: 0.1256 -> 0.1190   acc: 96.94% -> 96.94%             
client [13] (test)  loss: 0.4809 -> 0.4644   acc: 87.41% -> 86.67%             
client [31] (test)  loss: 0.6487 -> 0.6429   acc: 85.71% -> 85.71%             
client [75] (test)  loss: 0.9341 -> 0.9507   acc: 77.36% -> 73.58%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2233 -> 0.1576   acc: 95.72% -> 97.22%             
client [7] (test)  loss: 0.0325 -> 0.0292   acc: 99.21% -> 99.21%              
client [57] (test)  loss: 0.4078 -> 0.4058   acc: 88.30% -> 88.30%             
client [13] (test)  loss: 0.4700 -> 0.4553   acc: 88.89% -> 86.67%             
client [43] (test)  loss: 0.8644 -> 0.8252   acc: 72.93% -> 74.24%             
client [91] (test)  loss: 0.0561 -> 0.0443   acc: 98.41% -> 99.04%             
client [10] (test)  loss: 0.1945 -> 0.1901   acc: 94.81% -> 96.10%             
client [64] (test)  loss: 0.1311 -> 0.1262   acc: 97.14% -> 97.30%             
client [82] (test)  loss: 0.5263 -> 0.5160   acc: 82.48% -> 81.75%             
client [22] (test)  loss: 0.2548 -> 0.2468   acc: 92.03% -> 92.03%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2249 -> 0.2159   acc: 94.20% -> 94.20%             
client [23] (test)  loss: 0.6487 -> 0.6061   acc: 78.05% -> 79.27%             
client [88] (test)  loss: 0.2845 -> 0.2731   acc: 91.53% -> 91.53%             
client [98] (test)  loss: 0.3090 -> 0.2930   acc: 91.58% -> 91.87%             
client [79] (test)  loss: 0.7325 -> 0.7942   acc: 81.10% -> 81.71%             
client [21] (test)  loss: 0.3502 -> 0.2970   acc: 89.95% -> 91.50%             
client [92] (test)  loss: 1.6337 -> 1.5122   acc: 57.14% -> 57.14%             
client [56] (test)  loss: 0.5008 -> 0.4902   acc: 83.72% -> 81.40%             
client [5] (test)  loss: 0.6978 -> 0.7019   acc: 82.41% -> 83.42%              
client [52] (test)  loss: 0.1830 -> 0.1683   acc: 95.65% -> 95.65%             
==================== LG-FedAvg TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.2896 -> 0.0000', 'accuracy': '91.00% -> 0.00%'},          
    200: {'loss': '0.2587 -> 0.0000', 'accuracy': '92.60% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg achieved 20.0%(25.62%) at epoch: 1                                   
LG-FedAvg achieved 40.0%(46.89%) at epoch: 3                                   
LG-FedAvg achieved 60.0%(62.31%) at epoch: 7                                   
LG-FedAvg achieved 70.0%(76.96%) at epoch: 16                                  
LG-FedAvg achieved 80.0%(85.91%) at epoch: 22                                  
LG-FedAvg achieved 90.0%(91.44%) at epoch: 52                                  
Convergence (test_after):                                                      
LG-FedAvg achieved 70.0%(76.17%) at epoch: 0                                   
LG-FedAvg achieved 80.0%(81.81%) at epoch: 1                                   
LG-FedAvg achieved 90.0%(90.93%) at epoch: 2                                   
