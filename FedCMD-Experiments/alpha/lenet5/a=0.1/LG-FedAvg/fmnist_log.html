==================== ALGORITHM: LG-FedAvg ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0135 -> 0.0030   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 1.1467 -> 0.8554   acc: 60.91% -> 73.64%             
client [21] (test)  loss: 18.0384 -> 0.7573   acc: 0.00% -> 81.16%             
client [68] (test)  loss: 0.4212 -> 0.3314   acc: 89.20% -> 89.20%             
client [93] (test)  loss: 0.9443 -> 0.3919   acc: 85.60% -> 85.60%             
client [31] (test)  loss: 1.1568 -> 0.5600   acc: 60.56% -> 85.56%             
client [20] (test)  loss: 0.1467 -> 0.1256   acc: 96.83% -> 96.83%             
client [59] (test)  loss: 21.5415 -> 1.0744   acc: 0.00% -> 66.13%             
client [48] (test)  loss: 0.1204 -> 0.1003   acc: 98.75% -> 98.75%             
client [34] (test)  loss: 1.7720 -> 0.8184   acc: 73.53% -> 73.53%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5312 -> 0.3468   acc: 83.47% -> 89.60%             
client [99] (test)  loss: 0.3383 -> 0.1885   acc: 88.64% -> 97.16%             
client [67] (test)  loss: 0.3926 -> 0.2565   acc: 86.16% -> 92.26%             
client [0] (test)  loss: 1.3310 -> 1.1478   acc: 50.47% -> 70.09%              
client [76] (test)  loss: 1.6178 -> 1.1819   acc: 63.16% -> 63.16%             
client [41] (test)  loss: 0.5110 -> 0.3725   acc: 82.64% -> 88.34%             
client [62] (test)  loss: 22.5879 -> 2.1144   acc: 0.00% -> 80.95%             
client [2] (test)  loss: 1.9260 -> 0.0040   acc: 34.52% -> 100.00%             
client [14] (test)  loss: 0.1080 -> 0.1058   acc: 96.51% -> 96.78%             
client [46] (test)  loss: 0.4161 -> 0.3856   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5626 -> 0.5012   acc: 82.90% -> 83.42%             
client [68] (test)  loss: 0.2807 -> 0.2559   acc: 89.20% -> 89.55%             
client [57] (test)  loss: 0.0932 -> 0.0770   acc: 97.18% -> 97.18%             
client [17] (test)  loss: 0.2818 -> 0.2047   acc: 91.71% -> 93.65%             
client [54] (test)  loss: 0.3601 -> 0.3196   acc: 82.38% -> 82.38%             
client [23] (test)  loss: 14.4071 -> 0.4866   acc: 11.65% -> 89.47%            
client [35] (test)  loss: 0.3724 -> 0.2883   acc: 90.91% -> 90.30%             
client [59] (test)  loss: 0.5968 -> 0.4904   acc: 82.90% -> 87.42%             
client [31] (test)  loss: 0.2495 -> 0.2208   acc: 93.33% -> 94.44%             
client [9] (test)  loss: 0.1218 -> 0.0796   acc: 93.57% -> 97.72%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3560 -> 0.2447   acc: 92.35% -> 94.12%             
client [33] (test)  loss: 0.2090 -> 0.1834   acc: 92.47% -> 92.47%             
client [16] (test)  loss: 0.2538 -> 0.1609   acc: 95.45% -> 95.80%             
client [44] (test)  loss: 1.1539 -> 0.6314   acc: 74.36% -> 75.09%             
client [8] (test)  loss: 0.0010 -> 0.0009   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.2140 -> 0.2033   acc: 93.89% -> 94.44%             
client [47] (test)  loss: 0.1094 -> 0.0660   acc: 97.43% -> 98.53%             
client [36] (test)  loss: 0.1221 -> 0.0884   acc: 97.79% -> 97.79%             
client [20] (test)  loss: 0.0765 -> 0.0684   acc: 96.83% -> 96.83%             
client [56] (test)  loss: 0.6134 -> 0.5681   acc: 80.08% -> 80.08%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2721 -> 0.2406   acc: 92.73% -> 92.73%              
client [60] (test)  loss: 0.1340 -> 0.0892   acc: 95.55% -> 97.10%             
client [28] (test)  loss: 0.1969 -> 0.1575   acc: 95.54% -> 96.43%             
client [25] (test)  loss: 0.4911 -> 0.2878   acc: 87.11% -> 93.38%             
client [58] (test)  loss: 0.2207 -> 0.1900   acc: 91.97% -> 93.80%             
client [44] (test)  loss: 0.6841 -> 0.4395   acc: 75.46% -> 88.64%             
client [39] (test)  loss: 0.9530 -> 0.6727   acc: 55.56% -> 88.89%             
client [29] (test)  loss: 0.4172 -> 0.3788   acc: 87.67% -> 89.04%             
client [3] (test)  loss: 0.3673 -> 0.2480   acc: 84.60% -> 89.86%              
client [84] (test)  loss: 0.0633 -> 0.0536   acc: 98.17% -> 99.08%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4604 -> 0.3392   acc: 84.06% -> 86.71%             
client [84] (test)  loss: 0.0518 -> 0.0489   acc: 99.08% -> 99.54%             
client [10] (test)  loss: 0.2709 -> 0.2105   acc: 90.58% -> 90.58%             
client [36] (test)  loss: 0.0693 -> 0.0621   acc: 97.79% -> 97.79%             
client [65] (test)  loss: 0.4898 -> 0.4343   acc: 89.29% -> 90.48%             
client [81] (test)  loss: 0.5092 -> 0.4613   acc: 85.45% -> 85.45%             
client [79] (test)  loss: 0.4118 -> 0.3829   acc: 84.28% -> 85.50%             
client [42] (test)  loss: 0.0361 -> 0.0395   acc: 98.75% -> 98.75%             
client [11] (test)  loss: 0.3980 -> 0.3335   acc: 85.11% -> 87.33%             
client [96] (test)  loss: 0.4319 -> 0.3752   acc: 86.52% -> 86.80%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0008 -> 0.0006   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.0563 -> 0.0525   acc: 98.89% -> 98.89%             
client [52] (test)  loss: 0.4848 -> 0.4568   acc: 82.95% -> 82.95%             
client [42] (test)  loss: 0.0367 -> 0.0385   acc: 98.81% -> 98.87%             
client [69] (test)  loss: 0.2161 -> 0.2002   acc: 92.80% -> 92.53%             
client [59] (test)  loss: 0.4039 -> 0.3684   acc: 89.68% -> 89.68%             
client [7] (test)  loss: 0.1037 -> 0.0889   acc: 96.50% -> 97.05%              
client [26] (test)  loss: 0.0144 -> 0.0126   acc: 99.76% -> 99.76%             
client [49] (test)  loss: 0.0008 -> 0.0008   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.4403 -> 0.3991   acc: 83.00% -> 84.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4091 -> 0.3750   acc: 85.00% -> 85.00%             
client [47] (test)  loss: 0.0744 -> 0.0510   acc: 98.16% -> 98.53%             
client [21] (test)  loss: 0.3014 -> 0.2972   acc: 87.68% -> 87.44%             
client [77] (test)  loss: 0.0010 -> 0.0007   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.4395 -> 0.3814   acc: 90.23% -> 90.98%             
client [91] (test)  loss: 0.6927 -> 0.6782   acc: 78.12% -> 78.12%             
client [14] (test)  loss: 0.1118 -> 0.1175   acc: 96.78% -> 96.91%             
client [99] (test)  loss: 0.1084 -> 0.1015   acc: 98.01% -> 98.30%             
client [20] (test)  loss: 0.0418 -> 0.0402   acc: 98.17% -> 98.33%             
client [39] (test)  loss: 0.4824 -> 0.4158   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4624 -> 0.4376   acc: 82.95% -> 82.95%             
client [62] (test)  loss: 0.4180 -> 0.4014   acc: 90.48% -> 92.86%             
client [71] (test)  loss: 0.0604 -> 0.0582   acc: 97.65% -> 97.65%             
client [97] (test)  loss: 0.0939 -> 0.0806   acc: 98.19% -> 98.36%             
client [30] (test)  loss: 0.1580 -> 0.1494   acc: 94.76% -> 94.38%             
client [88] (test)  loss: 0.5794 -> 0.4902   acc: 73.48% -> 79.01%             
client [60] (test)  loss: 0.0771 -> 0.0810   acc: 97.29% -> 97.29%             
client [82] (test)  loss: 0.0756 -> 0.0730   acc: 98.56% -> 98.56%             
client [91] (test)  loss: 0.6486 -> 0.6420   acc: 78.12% -> 78.12%             
client [57] (test)  loss: 0.0512 -> 0.0466   acc: 99.06% -> 99.06%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1982 -> 0.1956   acc: 92.22% -> 93.33%             
client [15] (test)  loss: 0.1990 -> 0.1914   acc: 93.21% -> 92.36%             
client [71] (test)  loss: 0.0586 -> 0.0567   acc: 97.65% -> 97.65%             
client [97] (test)  loss: 0.0809 -> 0.0758   acc: 98.52% -> 98.36%             
client [53] (test)  loss: 0.0498 -> 0.0499   acc: 98.89% -> 98.89%             
client [77] (test)  loss: 0.0009 -> 0.0006   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.6971 -> 0.6582   acc: 84.21% -> 84.21%             
client [79] (test)  loss: 0.3936 -> 0.3859   acc: 86.73% -> 87.47%             
client [28] (test)  loss: 0.1088 -> 0.0991   acc: 96.43% -> 96.43%             
client [99] (test)  loss: 0.1082 -> 0.0975   acc: 98.01% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0801 -> 0.0749   acc: 98.52% -> 98.52%             
client [86] (test)  loss: 0.4952 -> 0.4565   acc: 87.72% -> 87.72%             
client [34] (test)  loss: 0.1452 -> 0.1309   acc: 95.59% -> 94.12%             
client [73] (test)  loss: 0.0716 -> 0.0640   acc: 98.57% -> 98.57%             
client [5] (test)  loss: 0.0491 -> 0.0473   acc: 98.91% -> 98.91%              
client [96] (test)  loss: 0.3255 -> 0.2927   acc: 90.17% -> 91.85%             
client [22] (test)  loss: 0.2277 -> 0.2015   acc: 93.87% -> 92.92%             
client [60] (test)  loss: 0.0804 -> 0.0873   acc: 97.49% -> 97.29%             
client [66] (test)  loss: 0.0012 -> 0.0007   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0710 -> 0.0716   acc: 98.52% -> 98.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5788 -> 0.5567   acc: 84.21% -> 86.84%             
client [65] (test)  loss: 0.4108 -> 0.3838   acc: 90.48% -> 91.67%             
client [95] (test)  loss: 0.3470 -> 0.3059   acc: 93.23% -> 92.48%             
client [17] (test)  loss: 0.1389 -> 0.1360   acc: 94.75% -> 95.03%             
client [8] (test)  loss: 0.0005 -> 0.0004   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.2018 -> 0.1990   acc: 91.52% -> 92.73%             
client [98] (test)  loss: 0.3411 -> 0.3376   acc: 87.00% -> 85.00%             
client [53] (test)  loss: 0.0492 -> 0.0495   acc: 98.89% -> 98.89%             
client [43] (test)  loss: 0.3792 -> 0.3631   acc: 88.15% -> 88.15%             
client [64] (test)  loss: 0.2286 -> 0.2136   acc: 94.71% -> 95.00%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2612 -> 0.2560   acc: 88.89% -> 89.61%             
client [88] (test)  loss: 0.4111 -> 0.3908   acc: 83.98% -> 85.64%             
client [38] (test)  loss: 0.5336 -> 0.5012   acc: 81.21% -> 81.21%             
client [3] (test)  loss: 0.1545 -> 0.1572   acc: 95.11% -> 94.57%              
client [5] (test)  loss: 0.0473 -> 0.0465   acc: 98.91% -> 98.91%              
client [41] (test)  loss: 0.3147 -> 0.2463   acc: 91.19% -> 92.23%             
client [7] (test)  loss: 0.0810 -> 0.0729   acc: 97.61% -> 97.42%              
client [37] (test)  loss: 0.3478 -> 0.3068   acc: 90.21% -> 90.72%             
client [45] (test)  loss: 0.7759 -> 0.7404   acc: 71.79% -> 75.64%             
client [47] (test)  loss: 0.0484 -> 0.0438   acc: 98.53% -> 98.90%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0624 -> 0.0626   acc: 98.95% -> 98.95%             
client [11] (test)  loss: 0.3801 -> 0.3231   acc: 87.11% -> 88.89%             
client [37] (test)  loss: 0.2929 -> 0.2715   acc: 90.72% -> 91.24%             
client [41] (test)  loss: 0.3397 -> 0.2504   acc: 90.41% -> 92.10%             
client [95] (test)  loss: 0.2812 -> 0.2623   acc: 92.48% -> 93.23%             
client [53] (test)  loss: 0.0494 -> 0.0492   acc: 98.89% -> 98.89%             
client [22] (test)  loss: 0.1922 -> 0.1771   acc: 94.34% -> 93.87%             
client [25] (test)  loss: 0.1730 -> 0.1735   acc: 95.47% -> 95.47%             
client [69] (test)  loss: 0.1734 -> 0.1712   acc: 95.20% -> 95.20%             
client [46] (test)  loss: 0.3559 -> 0.3508   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0405 -> 0.0395   acc: 98.71% -> 99.08%             
client [69] (test)  loss: 0.1698 -> 0.1695   acc: 95.47% -> 95.20%             
client [82] (test)  loss: 0.0779 -> 0.0728   acc: 98.56% -> 98.56%             
client [45] (test)  loss: 0.6745 -> 0.6493   acc: 74.36% -> 74.36%             
client [7] (test)  loss: 0.0771 -> 0.0693   acc: 97.61% -> 97.42%              
client [50] (test)  loss: 0.0007 -> 0.0006   acc: 100.00% -> 100.00%           
client [35] (test)  loss: 0.1954 -> 0.2006   acc: 92.73% -> 92.73%             
client [24] (test)  loss: 0.6370 -> 0.6545   acc: 83.68% -> 81.87%             
client [15] (test)  loss: 0.1647 -> 0.1680   acc: 92.57% -> 91.93%             
client [58] (test)  loss: 0.1334 -> 0.1301   acc: 95.99% -> 96.35%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.0778 -> 0.0756   acc: 98.75% -> 98.75%             
client [76] (test)  loss: 0.5307 -> 0.4994   acc: 89.47% -> 89.47%             
client [67] (test)  loss: 0.1649 -> 0.1416   acc: 95.24% -> 95.83%             
client [37] (test)  loss: 0.2891 -> 0.2533   acc: 91.24% -> 92.78%             
client [58] (test)  loss: 0.1287 -> 0.1291   acc: 96.35% -> 96.35%             
client [64] (test)  loss: 0.2190 -> 0.2170   acc: 95.29% -> 95.29%             
client [77] (test)  loss: 0.0005 -> 0.0004   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.0216 -> 0.0202   acc: 99.43% -> 99.43%             
client [12] (test)  loss: 0.3693 -> 0.3693   acc: 90.78% -> 91.13%             
client [89] (test)  loss: 1.0321 -> 0.9894   acc: 71.43% -> 73.81%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0450 -> 0.0450   acc: 99.54% -> 99.54%             
client [51] (test)  loss: 0.0114 -> 0.0112   acc: 99.74% -> 99.74%             
client [8] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.0144 -> 0.0145   acc: 99.76% -> 99.76%             
client [94] (test)  loss: 0.2582 -> 0.2419   acc: 93.97% -> 93.26%             
client [81] (test)  loss: 0.2602 -> 0.2533   acc: 87.27% -> 90.00%             
client [3] (test)  loss: 0.1531 -> 0.1540   acc: 95.29% -> 94.93%              
client [11] (test)  loss: 0.3599 -> 0.3315   acc: 89.33% -> 88.89%             
client [95] (test)  loss: 0.2382 -> 0.2310   acc: 93.23% -> 93.98%             
client [67] (test)  loss: 0.1604 -> 0.1433   acc: 95.09% -> 95.83%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2151 -> 0.2168   acc: 90.82% -> 91.79%             
client [79] (test)  loss: 0.5749 -> 0.5359   acc: 86.00% -> 86.24%             
client [58] (test)  loss: 0.1261 -> 0.1284   acc: 96.17% -> 96.17%             
client [88] (test)  loss: 0.4115 -> 0.4101   acc: 85.64% -> 86.19%             
client [46] (test)  loss: 0.3665 -> 0.3448   acc: 91.19% -> 91.19%             
client [11] (test)  loss: 0.3950 -> 0.3359   acc: 86.89% -> 89.11%             
client [55] (test)  loss: 0.0194 -> 0.0186   acc: 99.43% -> 99.43%             
client [13] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [31] (test)  loss: 0.2103 -> 0.2049   acc: 91.11% -> 91.11%             
client [75] (test)  loss: 0.4024 -> 0.3282   acc: 89.10% -> 90.56%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5397 -> 0.5275   acc: 81.10% -> 81.89%             
client [7] (test)  loss: 0.0623 -> 0.0577   acc: 97.79% -> 97.61%              
client [57] (test)  loss: 0.0471 -> 0.0478   acc: 99.25% -> 99.25%             
client [13] (test)  loss: 0.0002 -> 0.0003   acc: 100.00% -> 100.00%           
client [43] (test)  loss: 0.3567 -> 0.3380   acc: 88.89% -> 89.63%             
client [91] (test)  loss: 0.5873 -> 0.5795   acc: 78.12% -> 78.12%             
client [10] (test)  loss: 0.0742 -> 0.0712   acc: 97.83% -> 97.83%             
client [64] (test)  loss: 0.2218 -> 0.2233   acc: 95.59% -> 95.59%             
client [82] (test)  loss: 0.0782 -> 0.0719   acc: 98.56% -> 98.56%             
client [22] (test)  loss: 0.1515 -> 0.1418   acc: 94.34% -> 93.87%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0283 -> 0.0282   acc: 98.83% -> 98.83%             
client [23] (test)  loss: 0.1477 -> 0.1459   acc: 95.86% -> 96.24%             
client [88] (test)  loss: 0.4072 -> 0.4135   acc: 85.64% -> 86.19%             
client [98] (test)  loss: 0.3298 -> 0.3469   acc: 90.00% -> 89.00%             
client [79] (test)  loss: 0.5875 -> 0.5661   acc: 86.73% -> 86.73%             
client [21] (test)  loss: 0.2020 -> 0.1985   acc: 92.03% -> 92.27%             
client [92] (test)  loss: 0.2717 -> 0.2466   acc: 93.84% -> 94.52%             
client [56] (test)  loss: 0.4276 -> 0.4546   acc: 89.02% -> 89.02%             
client [5] (test)  loss: 0.0459 -> 0.0465   acc: 98.91% -> 98.91%              
client [52] (test)  loss: 0.2994 -> 0.2950   acc: 86.82% -> 86.05%             
==================== LG-FedAvg TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.1593 -> 0.0000', 'accuracy': '95.05% -> 0.00%'},          
    200: {'loss': '0.1519 -> 0.0000', 'accuracy': '95.80% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg achieved 10.0%(11.19%) at epoch: 0                                   
LG-FedAvg achieved 20.0%(22.20%) at epoch: 2                                   
LG-FedAvg achieved 60.0%(61.32%) at epoch: 4                                   
LG-FedAvg achieved 70.0%(79.40%) at epoch: 7                                   
LG-FedAvg achieved 80.0%(80.55%) at epoch: 16                                  
LG-FedAvg achieved 90.0%(90.73%) at epoch: 24                                  
Convergence (test_after):                                                      
LG-FedAvg achieved 70.0%(79.84%) at epoch: 0                                   
LG-FedAvg achieved 80.0%(89.92%) at epoch: 2                                   
LG-FedAvg achieved 90.0%(93.43%) at epoch: 8                                   
