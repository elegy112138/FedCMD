==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8388 -> 0.7172   acc: 75.65% -> 75.65%             
client [81] (test)  loss: 2.2592 -> 2.1976   acc: 47.83% -> 47.83%             
client [21] (test)  loss: 2.4906 -> 2.4481   acc: 3.45% -> 3.45%               
client [68] (test)  loss: 0.4680 -> 0.3328   acc: 89.80% -> 89.80%             
client [93] (test)  loss: 2.0936 -> 1.3016   acc: 81.32% -> 81.32%             
client [31] (test)  loss: 1.7699 -> 0.7710   acc: 86.67% -> 86.67%             
client [20] (test)  loss: 0.9217 -> 0.6777   acc: 68.70% -> 71.30%             
client [59] (test)  loss: 2.3649 -> 0.5980   acc: 6.56% -> 93.44%              
client [48] (test)  loss: 0.5839 -> 0.5077   acc: 85.47% -> 85.47%             
client [34] (test)  loss: 2.0633 -> 1.4145   acc: 43.90% -> 45.53%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.3359 -> 0.2395   acc: 89.51% -> 93.09%             
client [99] (test)  loss: 0.7554 -> 0.2797   acc: 95.31% -> 95.31%             
client [67] (test)  loss: 1.9100 -> 0.4948   acc: 97.80% -> 97.80%             
client [0] (test)  loss: 2.1579 -> 1.9310   acc: 28.81% -> 33.90%              
client [76] (test)  loss: 1.8938 -> 1.5722   acc: 52.78% -> 58.33%             
client [41] (test)  loss: 1.5148 -> 0.7477   acc: 85.44% -> 85.44%             
client [62] (test)  loss: 2.4201 -> 0.5723   acc: 0.00% -> 100.00%             
client [2] (test)  loss: 2.3714 -> 1.1726   acc: 2.05% -> 78.08%               
client [14] (test)  loss: 1.2814 -> 1.1571   acc: 60.56% -> 60.56%             
client [46] (test)  loss: 1.2512 -> 1.0845   acc: 45.57% -> 62.03%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4731 -> 0.3806   acc: 91.94% -> 91.94%             
client [68] (test)  loss: 0.2548 -> 0.2378   acc: 89.80% -> 89.80%             
client [57] (test)  loss: 0.9176 -> 0.8787   acc: 72.03% -> 72.03%             
client [17] (test)  loss: 1.1201 -> 0.9992   acc: 68.09% -> 69.15%             
client [54] (test)  loss: 1.0411 -> 1.0072   acc: 69.57% -> 70.43%             
client [23] (test)  loss: 2.3968 -> 2.2624   acc: 1.85% -> 57.41%              
client [35] (test)  loss: 1.9648 -> 1.7285   acc: 53.57% -> 53.57%             
client [59] (test)  loss: 0.1695 -> 0.1470   acc: 93.44% -> 93.44%             
client [31] (test)  loss: 0.5752 -> 0.5657   acc: 86.67% -> 86.67%             
client [9] (test)  loss: 1.3028 -> 0.9244   acc: 50.00% -> 57.14%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7387 -> 0.5521   acc: 89.47% -> 91.23%             
client [33] (test)  loss: 0.9694 -> 0.9150   acc: 76.27% -> 76.27%             
client [16] (test)  loss: 1.2237 -> 1.1548   acc: 72.97% -> 72.97%             
client [44] (test)  loss: 0.7262 -> 0.5963   acc: 79.23% -> 79.23%             
client [8] (test)  loss: 0.8276 -> 0.7806   acc: 73.97% -> 76.71%              
client [31] (test)  loss: 0.5572 -> 0.5503   acc: 86.67% -> 86.67%             
client [47] (test)  loss: 0.6236 -> 0.4568   acc: 77.33% -> 84.00%             
client [36] (test)  loss: 1.1860 -> 0.8562   acc: 72.00% -> 72.00%             
client [20] (test)  loss: 0.4862 -> 0.4699   acc: 85.22% -> 85.22%             
client [56] (test)  loss: 1.8281 -> 1.1393   acc: 72.09% -> 72.09%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.5979 -> 1.2294   acc: 73.08% -> 73.08%              
client [60] (test)  loss: 1.9132 -> 1.3903   acc: 55.56% -> 64.44%             
client [28] (test)  loss: 1.9586 -> 1.8346   acc: 84.00% -> 80.00%             
client [25] (test)  loss: 1.2548 -> 1.1906   acc: 65.52% -> 65.52%             
client [58] (test)  loss: 0.3277 -> 0.2975   acc: 96.30% -> 96.30%             
client [44] (test)  loss: 0.5963 -> 0.5160   acc: 79.23% -> 79.23%             
client [39] (test)  loss: 1.4697 -> 1.2285   acc: 35.20% -> 49.60%             
client [29] (test)  loss: 1.0703 -> 0.9911   acc: 57.14% -> 57.14%             
client [3] (test)  loss: 0.2511 -> 0.2482   acc: 94.31% -> 94.31%              
client [84] (test)  loss: 1.2034 -> 1.1676   acc: 68.29% -> 68.29%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.3504 -> 2.2696   acc: 41.38% -> 41.38%             
client [84] (test)  loss: 1.1487 -> 1.1387   acc: 68.29% -> 68.29%             
client [10] (test)  loss: 0.8067 -> 0.7523   acc: 83.16% -> 83.16%             
client [36] (test)  loss: 0.6472 -> 0.5547   acc: 72.57% -> 82.86%             
client [65] (test)  loss: 0.3686 -> 0.3244   acc: 89.17% -> 89.17%             
client [81] (test)  loss: 1.7542 -> 1.6401   acc: 47.83% -> 47.83%             
client [79] (test)  loss: 0.1027 -> 0.0912   acc: 97.99% -> 97.99%             
client [42] (test)  loss: 0.5128 -> 0.4885   acc: 87.92% -> 89.81%             
client [11] (test)  loss: 0.8436 -> 0.7479   acc: 76.60% -> 76.60%             
client [96] (test)  loss: 0.4079 -> 0.3949   acc: 85.29% -> 85.29%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7035 -> 0.6751   acc: 76.71% -> 78.08%              
client [53] (test)  loss: 0.4476 -> 0.3518   acc: 94.20% -> 95.65%             
client [52] (test)  loss: 1.0181 -> 0.9299   acc: 69.23% -> 69.23%             
client [42] (test)  loss: 0.4705 -> 0.4600   acc: 90.19% -> 90.19%             
client [69] (test)  loss: 0.1466 -> 0.1444   acc: 94.88% -> 95.14%             
client [59] (test)  loss: 0.0844 -> 0.0719   acc: 97.54% -> 98.36%             
client [7] (test)  loss: 1.0616 -> 0.9633   acc: 64.37% -> 66.67%              
client [26] (test)  loss: 0.2527 -> 0.2191   acc: 94.48% -> 95.17%             
client [49] (test)  loss: 0.1481 -> 0.1379   acc: 96.40% -> 96.55%             
client [98] (test)  loss: 0.3202 -> 0.3011   acc: 93.24% -> 93.24%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3011 -> 0.2863   acc: 93.24% -> 93.24%             
client [47] (test)  loss: 0.3684 -> 0.3045   acc: 88.00% -> 93.33%             
client [21] (test)  loss: 2.1499 -> 2.0173   acc: 41.38% -> 41.38%             
client [77] (test)  loss: 0.5763 -> 0.5508   acc: 80.87% -> 83.48%             
client [95] (test)  loss: 0.5062 -> 0.5034   acc: 90.48% -> 90.48%             
client [91] (test)  loss: 1.3838 -> 1.3329   acc: 45.83% -> 52.08%             
client [14] (test)  loss: 1.0389 -> 1.0348   acc: 61.97% -> 61.97%             
client [99] (test)  loss: 0.2547 -> 0.2557   acc: 95.31% -> 95.31%             
client [20] (test)  loss: 0.4062 -> 0.3915   acc: 90.43% -> 91.30%             
client [39] (test)  loss: 0.9254 -> 0.8171   acc: 56.00% -> 60.80%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9299 -> 0.8683   acc: 69.23% -> 69.23%             
client [62] (test)  loss: 0.0026 -> 0.0024   acc: 100.00% -> 100.00%           
client [71] (test)  loss: 0.1246 -> 0.1262   acc: 98.37% -> 98.37%             
client [97] (test)  loss: 0.9649 -> 0.8896   acc: 69.18% -> 71.70%             
client [30] (test)  loss: 0.3383 -> 0.3337   acc: 92.51% -> 92.51%             
client [88] (test)  loss: 1.2032 -> 1.1492   acc: 58.33% -> 59.38%             
client [60] (test)  loss: 0.7215 -> 0.6713   acc: 82.22% -> 82.22%             
client [82] (test)  loss: 0.0374 -> 0.0392   acc: 98.85% -> 98.85%             
client [91] (test)  loss: 1.2821 -> 1.2342   acc: 55.56% -> 57.64%             
client [57] (test)  loss: 0.7745 -> 0.7331   acc: 72.88% -> 75.42%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5147 -> 0.5124   acc: 87.78% -> 87.78%             
client [15] (test)  loss: 0.5773 -> 0.5735   acc: 77.91% -> 77.91%             
client [71] (test)  loss: 0.1262 -> 0.1277   acc: 98.37% -> 98.37%             
client [97] (test)  loss: 0.7692 -> 0.7260   acc: 75.47% -> 74.84%             
client [53] (test)  loss: 0.2567 -> 0.2445   acc: 97.10% -> 97.10%             
client [77] (test)  loss: 0.5508 -> 0.5283   acc: 83.48% -> 85.22%             
client [76] (test)  loss: 0.9017 -> 0.8721   acc: 69.44% -> 69.44%             
client [79] (test)  loss: 0.0815 -> 0.0793   acc: 97.99% -> 97.99%             
client [28] (test)  loss: 1.1402 -> 1.0611   acc: 68.00% -> 68.00%             
client [99] (test)  loss: 0.2573 -> 0.2589   acc: 95.31% -> 95.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6922 -> 0.6677   acc: 75.47% -> 76.10%             
client [86] (test)  loss: 0.3330 -> 0.3285   acc: 86.78% -> 86.78%             
client [34] (test)  loss: 0.7559 -> 0.7451   acc: 77.24% -> 79.67%             
client [73] (test)  loss: 0.9242 -> 0.8730   acc: 58.73% -> 66.67%             
client [5] (test)  loss: 1.4170 -> 1.4421   acc: 71.43% -> 71.43%              
client [96] (test)  loss: 0.2995 -> 0.2921   acc: 94.12% -> 94.12%             
client [22] (test)  loss: 1.0116 -> 0.9899   acc: 62.71% -> 62.71%             
client [60] (test)  loss: 0.5744 -> 0.5555   acc: 82.22% -> 82.22%             
client [66] (test)  loss: 1.1958 -> 1.1259   acc: 51.43% -> 54.29%             
client [83] (test)  loss: 0.0021 -> 0.0019   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8095 -> 0.7914   acc: 69.44% -> 69.44%             
client [65] (test)  loss: 0.2832 -> 0.2689   acc: 89.17% -> 90.00%             
client [95] (test)  loss: 0.4941 -> 0.4908   acc: 90.48% -> 90.48%             
client [17] (test)  loss: 0.7664 -> 0.7372   acc: 72.34% -> 72.34%             
client [8] (test)  loss: 0.6299 -> 0.6203   acc: 79.45% -> 79.45%              
client [35] (test)  loss: 0.5358 -> 0.4806   acc: 78.57% -> 78.57%             
client [98] (test)  loss: 0.2642 -> 0.2558   acc: 93.24% -> 93.24%             
client [53] (test)  loss: 0.2358 -> 0.2295   acc: 97.10% -> 97.10%             
client [43] (test)  loss: 0.5827 -> 0.5964   acc: 90.00% -> 90.00%             
client [64] (test)  loss: 0.3163 -> 0.3024   acc: 94.74% -> 94.74%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.9396 -> 1.9233   acc: 41.38% -> 41.38%             
client [88] (test)  loss: 1.0242 -> 1.0140   acc: 57.29% -> 57.29%             
client [38] (test)  loss: 0.0651 -> 0.0619   acc: 99.19% -> 99.19%             
client [3] (test)  loss: 0.2455 -> 0.2447   acc: 94.31% -> 94.31%              
client [5] (test)  loss: 1.4656 -> 1.4872   acc: 71.43% -> 74.29%              
client [41] (test)  loss: 0.4015 -> 0.3805   acc: 85.44% -> 89.32%             
client [7] (test)  loss: 0.8426 -> 0.8051   acc: 67.82% -> 72.41%              
client [37] (test)  loss: 0.1841 -> 0.1814   acc: 95.22% -> 95.22%             
client [45] (test)  loss: 0.2690 -> 0.2466   acc: 91.19% -> 91.63%             
client [47] (test)  loss: 0.2179 -> 0.1910   acc: 94.67% -> 93.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9088 -> 0.9060   acc: 72.97% -> 72.97%             
client [11] (test)  loss: 0.4984 -> 0.4826   acc: 78.72% -> 78.72%             
client [37] (test)  loss: 0.1765 -> 0.1744   acc: 95.22% -> 95.22%             
client [41] (test)  loss: 0.3805 -> 0.3610   acc: 89.32% -> 91.26%             
client [95] (test)  loss: 0.4806 -> 0.4773   acc: 90.48% -> 90.48%             
client [53] (test)  loss: 0.2295 -> 0.2244   acc: 97.10% -> 97.10%             
client [22] (test)  loss: 0.9726 -> 0.9588   acc: 67.80% -> 67.80%             
client [25] (test)  loss: 1.0024 -> 0.9850   acc: 71.26% -> 71.26%             
client [69] (test)  loss: 0.1299 -> 0.1291   acc: 95.65% -> 95.65%             
client [46] (test)  loss: 0.6639 -> 0.6412   acc: 84.81% -> 84.81%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1348 -> 0.1281   acc: 93.33% -> 93.33%             
client [69] (test)  loss: 0.1299 -> 0.1294   acc: 95.40% -> 95.14%             
client [82] (test)  loss: 0.0461 -> 0.0476   acc: 98.85% -> 98.85%             
client [45] (test)  loss: 0.2180 -> 0.2092   acc: 92.07% -> 91.63%             
client [7] (test)  loss: 0.8051 -> 0.7744   acc: 72.41% -> 73.56%              
client [50] (test)  loss: 0.3740 -> 0.3605   acc: 93.33% -> 93.33%             
client [35] (test)  loss: 0.4459 -> 0.4571   acc: 78.57% -> 78.57%             
client [24] (test)  loss: 0.2151 -> 0.2117   acc: 91.94% -> 91.94%             
client [15] (test)  loss: 0.5633 -> 0.5586   acc: 79.07% -> 79.07%             
client [58] (test)  loss: 0.2871 -> 0.2885   acc: 96.30% -> 96.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3340 -> 0.3354   acc: 91.45% -> 91.45%             
client [76] (test)  loss: 0.7541 -> 0.7369   acc: 69.44% -> 83.33%             
client [67] (test)  loss: 0.2034 -> 0.2059   acc: 97.80% -> 97.80%             
client [37] (test)  loss: 0.1726 -> 0.1707   acc: 95.22% -> 95.22%             
client [58] (test)  loss: 0.2899 -> 0.2914   acc: 96.30% -> 96.30%             
client [64] (test)  loss: 0.2770 -> 0.2716   acc: 94.74% -> 94.74%             
client [77] (test)  loss: 0.4770 -> 0.4711   acc: 86.96% -> 86.09%             
client [55] (test)  loss: 0.6986 -> 0.6866   acc: 73.47% -> 73.47%             
client [12] (test)  loss: 0.0011 -> 0.0010   acc: 100.00% -> 100.00%           
client [89] (test)  loss: 0.5943 -> 0.5895   acc: 78.95% -> 78.95%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1399 -> 1.1405   acc: 68.29% -> 68.29%             
client [51] (test)  loss: 0.2722 -> 0.2744   acc: 95.24% -> 95.24%             
client [8] (test)  loss: 0.5933 -> 0.5921   acc: 80.82% -> 83.56%              
client [18] (test)  loss: 0.5716 -> 0.5689   acc: 81.75% -> 81.75%             
client [94] (test)  loss: 0.4834 -> 0.4777   acc: 85.61% -> 85.98%             
client [81] (test)  loss: 1.4223 -> 1.4309   acc: 43.48% -> 43.48%             
client [3] (test)  loss: 0.2416 -> 0.2403   acc: 94.31% -> 94.31%              
client [11] (test)  loss: 0.4513 -> 0.4451   acc: 87.23% -> 87.23%             
client [95] (test)  loss: 0.4570 -> 0.4525   acc: 90.48% -> 90.48%             
client [67] (test)  loss: 0.2059 -> 0.2083   acc: 97.80% -> 97.80%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.9322 -> 1.9333   acc: 41.38% -> 41.38%             
client [79] (test)  loss: 0.0736 -> 0.0736   acc: 97.99% -> 97.99%             
client [58] (test)  loss: 0.2959 -> 0.2973   acc: 96.30% -> 96.30%             
client [88] (test)  loss: 0.9903 -> 0.9854   acc: 56.25% -> 57.29%             
client [46] (test)  loss: 0.6026 -> 0.5943   acc: 84.81% -> 84.81%             
client [11] (test)  loss: 0.4451 -> 0.4415   acc: 87.23% -> 85.11%             
client [55] (test)  loss: 0.6374 -> 0.6276   acc: 73.47% -> 77.55%             
client [13] (test)  loss: 0.2788 -> 0.2792   acc: 91.49% -> 91.49%             
client [31] (test)  loss: 0.5085 -> 0.5072   acc: 87.78% -> 87.78%             
client [75] (test)  loss: 0.5054 -> 0.5098   acc: 86.60% -> 86.60%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7223 -> 0.7176   acc: 77.42% -> 78.23%             
client [7] (test)  loss: 0.6758 -> 0.6648   acc: 79.31% -> 80.46%              
client [57] (test)  loss: 0.5480 -> 0.5395   acc: 83.90% -> 84.75%             
client [13] (test)  loss: 0.2793 -> 0.2787   acc: 91.49% -> 91.49%             
client [43] (test)  loss: 0.6547 -> 0.6619   acc: 90.00% -> 90.00%             
client [91] (test)  loss: 1.0591 -> 1.0264   acc: 62.50% -> 63.19%             
client [10] (test)  loss: 0.5930 -> 0.5865   acc: 83.16% -> 83.16%             
client [64] (test)  loss: 0.2555 -> 0.2539   acc: 96.49% -> 96.49%             
client [82] (test)  loss: 0.0540 -> 0.0549   acc: 98.85% -> 98.85%             
client [22] (test)  loss: 0.9280 -> 0.9273   acc: 72.88% -> 74.58%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3167 -> 0.3117   acc: 94.78% -> 94.78%             
client [23] (test)  loss: 0.9164 -> 0.9001   acc: 74.07% -> 74.07%             
client [88] (test)  loss: 0.9854 -> 0.9828   acc: 57.29% -> 57.29%             
client [98] (test)  loss: 0.2170 -> 0.2142   acc: 93.24% -> 93.24%             
client [79] (test)  loss: 0.0735 -> 0.0735   acc: 97.99% -> 97.99%             
client [21] (test)  loss: 1.9305 -> 1.9216   acc: 41.38% -> 41.38%             
client [92] (test)  loss: 0.0006 -> 0.0006   acc: 100.00% -> 100.00%           
client [56] (test)  loss: 0.3661 -> 0.3680   acc: 88.37% -> 88.37%             
client [5] (test)  loss: 1.5961 -> 1.6067   acc: 74.29% -> 74.29%              
client [52] (test)  loss: 0.7767 -> 0.7821   acc: 82.05% -> 82.05%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.4231 -> 0.0000', 'accuracy': '87.01% -> 0.00%'},          
    200: {'loss': '0.3571 -> 0.0000', 'accuracy': '89.49% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(11.82%) at epoch: 0                                
Local-only-1 achieved 30.0%(32.42%) at epoch: 1                                
Local-only-1 achieved 70.0%(79.83%) at epoch: 7                                
Local-only-1 achieved 80.0%(86.96%) at epoch: 26                               
Local-only-1 achieved 90.0%(92.24%) at epoch: 69                               
Convergence (test_after):                                                      
Local-only-1 achieved 60.0%(64.43%) at epoch: 0                                
Local-only-1 achieved 70.0%(75.37%) at epoch: 1                                
Local-only-1 achieved 80.0%(83.82%) at epoch: 5                                
Local-only-1 achieved 90.0%(92.65%) at epoch: 69                               
