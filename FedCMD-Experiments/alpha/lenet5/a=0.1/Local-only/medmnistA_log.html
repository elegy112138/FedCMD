==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6142 -> 1.5362   acc: 47.47% -> 47.47%             
client [81] (test)  loss: 0.8155 -> 0.7697   acc: 82.41% -> 82.41%             
client [21] (test)  loss: 2.3864 -> 0.9233   acc: 1.70% -> 66.31%              
client [68] (test)  loss: 1.1223 -> 0.7642   acc: 71.29% -> 77.23%             
client [93] (test)  loss: 1.7792 -> 0.7397   acc: 86.75% -> 86.75%             
client [31] (test)  loss: 1.7477 -> 0.8426   acc: 84.42% -> 84.42%             
client [20] (test)  loss: 0.6737 -> 0.5034   acc: 73.19% -> 86.23%             
client [59] (test)  loss: 2.2957 -> 0.5609   acc: 80.77% -> 82.05%             
client [48] (test)  loss: 0.2738 -> 0.2527   acc: 94.20% -> 94.20%             
client [34] (test)  loss: 1.0585 -> 0.6073   acc: 64.38% -> 81.97%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.0755 -> 0.0589   acc: 97.39% -> 97.39%             
client [99] (test)  loss: 1.9019 -> 1.1470   acc: 65.74% -> 65.74%             
client [67] (test)  loss: 2.3244 -> 2.2285   acc: 44.83% -> 48.28%             
client [0] (test)  loss: 0.3235 -> 0.2744   acc: 87.45% -> 87.45%              
client [76] (test)  loss: 1.3291 -> 1.0180   acc: 53.46% -> 68.55%             
client [41] (test)  loss: 1.9068 -> 0.6510   acc: 98.31% -> 98.31%             
client [62] (test)  loss: 2.3280 -> 1.0115   acc: 59.33% -> 59.67%             
client [2] (test)  loss: 2.3642 -> 0.3626   acc: 1.27% -> 88.10%               
client [14] (test)  loss: 0.9945 -> 0.7864   acc: 69.60% -> 80.80%             
client [46] (test)  loss: 0.2463 -> 0.2253   acc: 93.86% -> 94.39%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.2900 -> 0.2581   acc: 92.33% -> 92.67%             
client [68] (test)  loss: 0.3860 -> 0.3205   acc: 89.11% -> 90.43%             
client [57] (test)  loss: 0.9973 -> 0.7569   acc: 79.79% -> 79.79%             
client [17] (test)  loss: 0.2875 -> 0.2678   acc: 91.74% -> 92.33%             
client [54] (test)  loss: 0.0360 -> 0.0313   acc: 99.17% -> 99.38%             
client [23] (test)  loss: 2.4432 -> 2.0222   acc: 0.00% -> 68.29%              
client [35] (test)  loss: 1.2812 -> 1.2448   acc: 51.79% -> 51.79%             
client [59] (test)  loss: 0.3230 -> 0.2586   acc: 88.14% -> 91.67%             
client [31] (test)  loss: 0.6524 -> 0.6530   acc: 84.42% -> 84.42%             
client [9] (test)  loss: 0.0366 -> 0.0343   acc: 99.26% -> 99.26%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2077 -> 0.1983   acc: 94.13% -> 94.13%             
client [33] (test)  loss: 0.6454 -> 0.6320   acc: 75.48% -> 75.96%             
client [16] (test)  loss: 1.2670 -> 1.2773   acc: 68.63% -> 68.63%             
client [44] (test)  loss: 0.2461 -> 0.1687   acc: 90.47% -> 91.00%             
client [8] (test)  loss: 0.7446 -> 0.7229   acc: 73.15% -> 73.15%              
client [31] (test)  loss: 0.6563 -> 0.6610   acc: 84.42% -> 84.42%             
client [47] (test)  loss: 0.9970 -> 0.9020   acc: 58.48% -> 64.33%             
client [36] (test)  loss: 1.2502 -> 0.5216   acc: 86.75% -> 91.39%             
client [20] (test)  loss: 0.3066 -> 0.2924   acc: 92.03% -> 92.03%             
client [56] (test)  loss: 1.8276 -> 1.4090   acc: 58.14% -> 58.14%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2333 -> 0.2218   acc: 92.11% -> 92.11%              
client [60] (test)  loss: 0.2508 -> 0.2113   acc: 92.11% -> 92.72%             
client [28] (test)  loss: 0.4191 -> 0.4161   acc: 90.64% -> 90.64%             
client [25] (test)  loss: 0.4779 -> 0.4199   acc: 82.11% -> 87.80%             
client [58] (test)  loss: 0.8809 -> 0.7990   acc: 73.11% -> 75.63%             
client [44] (test)  loss: 0.1687 -> 0.1060   acc: 91.00% -> 96.08%             
client [39] (test)  loss: 1.7851 -> 1.6641   acc: 35.42% -> 39.58%             
client [29] (test)  loss: 0.4252 -> 0.4032   acc: 82.51% -> 83.99%             
client [3] (test)  loss: 0.3086 -> 0.2551   acc: 93.88% -> 93.88%              
client [84] (test)  loss: 0.1364 -> 0.1346   acc: 97.26% -> 97.26%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5140 -> 0.4124   acc: 80.53% -> 84.85%             
client [84] (test)  loss: 0.1333 -> 0.1323   acc: 97.26% -> 97.26%             
client [10] (test)  loss: 0.3032 -> 0.2613   acc: 92.21% -> 92.21%             
client [36] (test)  loss: 0.3071 -> 0.2687   acc: 92.72% -> 92.72%             
client [65] (test)  loss: 0.2907 -> 0.2711   acc: 91.02% -> 92.19%             
client [81] (test)  loss: 0.6044 -> 0.6023   acc: 88.89% -> 88.89%             
client [79] (test)  loss: 0.9133 -> 0.8860   acc: 73.78% -> 73.78%             
client [42] (test)  loss: 0.4525 -> 0.4009   acc: 88.03% -> 91.12%             
client [11] (test)  loss: 0.5902 -> 0.5416   acc: 78.51% -> 81.49%             
client [96] (test)  loss: 0.3188 -> 0.2913   acc: 84.95% -> 86.96%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6823 -> 0.6635   acc: 73.83% -> 75.17%              
client [53] (test)  loss: 0.0283 -> 0.0282   acc: 99.54% -> 99.54%             
client [52] (test)  loss: 0.2210 -> 0.2069   acc: 95.65% -> 95.92%             
client [42] (test)  loss: 0.3714 -> 0.3579   acc: 92.28% -> 93.05%             
client [69] (test)  loss: 0.0095 -> 0.0078   acc: 100.00% -> 100.00%           
client [59] (test)  loss: 0.1673 -> 0.1560   acc: 94.55% -> 95.19%             
client [7] (test)  loss: 0.0440 -> 0.0382   acc: 98.89% -> 99.05%              
client [26] (test)  loss: 0.4149 -> 0.4001   acc: 90.48% -> 90.48%             
client [49] (test)  loss: 0.2398 -> 0.2227   acc: 93.18% -> 93.18%             
client [98] (test)  loss: 0.2769 -> 0.2767   acc: 91.58% -> 91.73%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2767 -> 0.2777   acc: 91.73% -> 91.87%             
client [47] (test)  loss: 0.8177 -> 0.7418   acc: 67.25% -> 76.61%             
client [21] (test)  loss: 0.3544 -> 0.3226   acc: 87.94% -> 89.03%             
client [77] (test)  loss: 1.3605 -> 1.3360   acc: 48.10% -> 48.73%             
client [95] (test)  loss: 0.1743 -> 0.1564   acc: 94.84% -> 95.77%             
client [91] (test)  loss: 0.0519 -> 0.0487   acc: 99.68% -> 99.68%             
client [14] (test)  loss: 0.3774 -> 0.3540   acc: 92.80% -> 91.20%             
client [99] (test)  loss: 0.7512 -> 0.7294   acc: 72.22% -> 75.00%             
client [20] (test)  loss: 0.2626 -> 0.2578   acc: 92.75% -> 92.75%             
client [39] (test)  loss: 1.5358 -> 1.4464   acc: 52.08% -> 54.17%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2069 -> 0.1970   acc: 95.92% -> 95.65%             
client [62] (test)  loss: 0.3809 -> 0.3740   acc: 83.33% -> 84.00%             
client [71] (test)  loss: 0.1819 -> 0.1819   acc: 93.00% -> 93.28%             
client [97] (test)  loss: 0.8542 -> 0.7941   acc: 73.57% -> 73.57%             
client [30] (test)  loss: 0.7887 -> 0.7711   acc: 72.73% -> 72.73%             
client [88] (test)  loss: 0.4645 -> 0.4057   acc: 85.88% -> 87.57%             
client [60] (test)  loss: 0.1201 -> 0.1076   acc: 96.59% -> 96.90%             
client [82] (test)  loss: 0.6871 -> 0.6581   acc: 75.18% -> 75.91%             
client [91] (test)  loss: 0.0466 -> 0.0451   acc: 99.68% -> 99.68%             
client [57] (test)  loss: 0.5495 -> 0.5171   acc: 88.30% -> 88.30%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6979 -> 0.7028   acc: 84.42% -> 84.42%             
client [15] (test)  loss: 0.3670 -> 0.3527   acc: 86.14% -> 87.46%             
client [71] (test)  loss: 0.1819 -> 0.1826   acc: 93.28% -> 93.28%             
client [97] (test)  loss: 0.7344 -> 0.7237   acc: 76.43% -> 76.43%             
client [53] (test)  loss: 0.0284 -> 0.0284   acc: 99.54% -> 99.54%             
client [77] (test)  loss: 1.3360 -> 1.3100   acc: 48.73% -> 50.00%             
client [76] (test)  loss: 0.5087 -> 0.4643   acc: 84.28% -> 86.16%             
client [79] (test)  loss: 0.8232 -> 0.7912   acc: 73.78% -> 76.83%             
client [28] (test)  loss: 0.3968 -> 0.3930   acc: 92.01% -> 92.47%             
client [99] (test)  loss: 0.7127 -> 0.7026   acc: 75.93% -> 77.78%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7185 -> 0.7166   acc: 76.43% -> 75.00%             
client [86] (test)  loss: 0.8489 -> 0.8075   acc: 66.94% -> 69.42%             
client [34] (test)  loss: 0.2361 -> 0.2326   acc: 90.56% -> 90.56%             
client [73] (test)  loss: 0.1134 -> 0.1104   acc: 96.90% -> 96.90%             
client [5] (test)  loss: 0.6964 -> 0.6902   acc: 78.89% -> 78.89%              
client [96] (test)  loss: 0.2249 -> 0.2251   acc: 91.97% -> 92.31%             
client [22] (test)  loss: 0.4420 -> 0.3901   acc: 88.41% -> 89.13%             
client [60] (test)  loss: 0.0883 -> 0.0856   acc: 97.37% -> 97.68%             
client [66] (test)  loss: 0.0053 -> 0.0047   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3629 -> 0.3394   acc: 88.68% -> 89.31%             
client [65] (test)  loss: 0.2563 -> 0.2515   acc: 91.99% -> 92.38%             
client [95] (test)  loss: 0.1192 -> 0.1090   acc: 95.54% -> 96.24%             
client [17] (test)  loss: 0.2243 -> 0.2201   acc: 94.69% -> 94.69%             
client [8] (test)  loss: 0.6220 -> 0.6130   acc: 75.84% -> 76.51%              
client [35] (test)  loss: 0.8758 -> 0.8645   acc: 75.00% -> 75.00%             
client [98] (test)  loss: 0.2825 -> 0.2854   acc: 91.87% -> 91.87%             
client [53] (test)  loss: 0.0285 -> 0.0286   acc: 99.54% -> 99.54%             
client [43] (test)  loss: 0.9633 -> 0.9607   acc: 67.69% -> 68.12%             
client [64] (test)  loss: 0.1467 -> 0.1365   acc: 94.92% -> 95.24%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3056 -> 0.2993   acc: 89.80% -> 90.11%             
client [88] (test)  loss: 0.2928 -> 0.2869   acc: 89.83% -> 89.83%             
client [38] (test)  loss: 0.6799 -> 0.6612   acc: 77.23% -> 77.23%             
client [3] (test)  loss: 0.1452 -> 0.1416   acc: 95.92% -> 95.92%              
client [5] (test)  loss: 0.6849 -> 0.6796   acc: 78.89% -> 78.89%              
client [41] (test)  loss: 0.2138 -> 0.2158   acc: 98.31% -> 98.31%             
client [7] (test)  loss: 0.0315 -> 0.0294   acc: 99.53% -> 99.53%              
client [37] (test)  loss: 0.2229 -> 0.2267   acc: 93.94% -> 93.94%             
client [45] (test)  loss: 0.1772 -> 0.1756   acc: 93.01% -> 93.01%             
client [47] (test)  loss: 0.6446 -> 0.6210   acc: 81.87% -> 83.04%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.0140 -> 1.0046   acc: 68.63% -> 68.63%             
client [11] (test)  loss: 0.4147 -> 0.4100   acc: 85.37% -> 86.57%             
client [37] (test)  loss: 0.2316 -> 0.2378   acc: 94.22% -> 94.22%             
client [41] (test)  loss: 0.2158 -> 0.2178   acc: 98.31% -> 98.31%             
client [95] (test)  loss: 0.0883 -> 0.0830   acc: 97.89% -> 97.89%             
client [53] (test)  loss: 0.0286 -> 0.0287   acc: 99.54% -> 99.54%             
client [22] (test)  loss: 0.3534 -> 0.3287   acc: 89.86% -> 90.58%             
client [25] (test)  loss: 0.2736 -> 0.2588   acc: 92.28% -> 92.68%             
client [69] (test)  loss: 0.0029 -> 0.0027   acc: 100.00% -> 100.00%           
client [46] (test)  loss: 0.1902 -> 0.1892   acc: 95.06% -> 95.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6052 -> 0.6109   acc: 85.38% -> 85.38%             
client [69] (test)  loss: 0.0026 -> 0.0024   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.5872 -> 0.5752   acc: 78.83% -> 80.29%             
client [45] (test)  loss: 0.1806 -> 0.1854   acc: 93.01% -> 93.01%             
client [7] (test)  loss: 0.0294 -> 0.0278   acc: 99.53% -> 99.53%              
client [50] (test)  loss: 0.4985 -> 0.4962   acc: 83.01% -> 83.01%             
client [35] (test)  loss: 0.8467 -> 0.8392   acc: 75.00% -> 76.79%             
client [24] (test)  loss: 0.1186 -> 0.1185   acc: 96.67% -> 96.67%             
client [15] (test)  loss: 0.3349 -> 0.3350   acc: 90.10% -> 90.10%             
client [58] (test)  loss: 0.4637 -> 0.4565   acc: 84.03% -> 84.03%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2041 -> 0.2045   acc: 95.56% -> 95.56%             
client [76] (test)  loss: 0.3084 -> 0.2977   acc: 89.94% -> 89.94%             
client [67] (test)  loss: 1.4995 -> 1.4938   acc: 48.28% -> 48.28%             
client [37] (test)  loss: 0.2430 -> 0.2498   acc: 94.08% -> 93.94%             
client [58] (test)  loss: 0.4512 -> 0.4465   acc: 84.03% -> 84.03%             
client [64] (test)  loss: 0.1211 -> 0.1203   acc: 96.19% -> 96.51%             
client [77] (test)  loss: 1.2089 -> 1.1919   acc: 55.06% -> 55.70%             
client [55] (test)  loss: 0.1168 -> 0.1156   acc: 96.94% -> 96.94%             
client [12] (test)  loss: 0.8604 -> 0.8448   acc: 74.12% -> 75.29%             
client [89] (test)  loss: 0.2056 -> 0.2072   acc: 96.13% -> 96.13%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1268 -> 0.1266   acc: 97.26% -> 97.26%             
client [51] (test)  loss: 0.2805 -> 0.2842   acc: 91.72% -> 91.72%             
client [8] (test)  loss: 0.5924 -> 0.5929   acc: 79.19% -> 79.19%              
client [18] (test)  loss: 0.7615 -> 0.7628   acc: 80.28% -> 80.28%             
client [94] (test)  loss: 0.5358 -> 0.5300   acc: 77.24% -> 77.24%             
client [81] (test)  loss: 0.6618 -> 0.6673   acc: 88.89% -> 88.89%             
client [3] (test)  loss: 0.1311 -> 0.1287   acc: 96.94% -> 96.94%              
client [11] (test)  loss: 0.4053 -> 0.4060   acc: 87.46% -> 87.46%             
client [95] (test)  loss: 0.0642 -> 0.0624   acc: 97.89% -> 97.89%             
client [67] (test)  loss: 1.4938 -> 1.4893   acc: 48.28% -> 48.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2993 -> 0.3022   acc: 89.80% -> 90.26%             
client [79] (test)  loss: 0.7318 -> 0.7407   acc: 81.71% -> 81.10%             
client [58] (test)  loss: 0.4378 -> 0.4360   acc: 85.71% -> 85.71%             
client [88] (test)  loss: 0.2753 -> 0.2721   acc: 90.96% -> 91.53%             
client [46] (test)  loss: 0.1914 -> 0.1933   acc: 95.06% -> 95.06%             
client [11] (test)  loss: 0.4060 -> 0.4063   acc: 87.46% -> 87.46%             
client [55] (test)  loss: 0.1100 -> 0.1092   acc: 96.94% -> 96.94%             
client [13] (test)  loss: 0.4748 -> 0.4720   acc: 84.44% -> 85.19%             
client [31] (test)  loss: 0.7163 -> 0.7202   acc: 84.42% -> 84.42%             
client [75] (test)  loss: 0.9801 -> 0.9549   acc: 66.04% -> 69.81%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1612 -> 0.1668   acc: 96.79% -> 96.79%             
client [7] (test)  loss: 0.0224 -> 0.0217   acc: 99.37% -> 99.37%              
client [57] (test)  loss: 0.4183 -> 0.4122   acc: 88.30% -> 88.30%             
client [13] (test)  loss: 0.4691 -> 0.4673   acc: 85.19% -> 86.67%             
client [43] (test)  loss: 1.0256 -> 0.9574   acc: 72.05% -> 73.36%             
client [91] (test)  loss: 0.0419 -> 0.0413   acc: 99.04% -> 99.04%             
client [10] (test)  loss: 0.1900 -> 0.1906   acc: 96.10% -> 96.10%             
client [64] (test)  loss: 0.1281 -> 0.1299   acc: 96.98% -> 96.98%             
client [82] (test)  loss: 0.5743 -> 0.5784   acc: 82.48% -> 83.21%             
client [22] (test)  loss: 0.2708 -> 0.2649   acc: 91.30% -> 91.30%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2393 -> 0.2369   acc: 94.20% -> 94.20%             
client [23] (test)  loss: 0.5816 -> 0.5688   acc: 79.27% -> 79.27%             
client [88] (test)  loss: 0.2721 -> 0.2705   acc: 91.53% -> 91.53%             
client [98] (test)  loss: 0.3055 -> 0.3080   acc: 92.30% -> 92.30%             
client [79] (test)  loss: 0.7627 -> 0.7735   acc: 80.49% -> 81.10%             
client [21] (test)  loss: 0.3046 -> 0.3111   acc: 90.42% -> 90.57%             
client [92] (test)  loss: 1.4637 -> 1.4160   acc: 61.90% -> 66.67%             
client [56] (test)  loss: 0.5815 -> 0.5716   acc: 79.07% -> 79.07%             
client [5] (test)  loss: 0.6593 -> 0.6603   acc: 80.40% -> 80.90%              
client [52] (test)  loss: 0.1625 -> 0.1620   acc: 96.20% -> 96.20%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.2688 -> 0.0000', 'accuracy': '91.48% -> 0.00%'},          
    200: {'loss': '0.2443 -> 0.0000', 'accuracy': '93.10% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 20.0%(25.62%) at epoch: 1                                
Local-only-1 achieved 40.0%(46.77%) at epoch: 3                                
Local-only-1 achieved 60.0%(62.49%) at epoch: 7                                
Local-only-1 achieved 70.0%(71.60%) at epoch: 11                               
Local-only-1 achieved 80.0%(87.00%) at epoch: 22                               
Local-only-1 achieved 90.0%(90.76%) at epoch: 36                               
Convergence (test_after):                                                      
Local-only-1 achieved 70.0%(76.17%) at epoch: 0                                
Local-only-1 achieved 80.0%(81.91%) at epoch: 1                                
Local-only-1 achieved 90.0%(91.59%) at epoch: 2                                
