==================== ALGORITHM: FedBN ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.7896 -> 2.3535   acc: 0.00% -> 31.97%              
client [81] (test)  loss: 4.5227 -> 2.8210   acc: 0.00% -> 27.22%              
client [21] (test)  loss: 48.3197 -> 2.5580   acc: 0.29% -> 27.38%             
client [68] (test)  loss: 4.5480 -> 2.2959   acc: 4.15% -> 35.14%              
client [93] (test)  loss: 4.8215 -> 3.1282   acc: 1.02% -> 13.95%              
client [31] (test)  loss: 4.6067 -> 2.6004   acc: 0.64% -> 22.51%              
client [20] (test)  loss: 4.2490 -> 1.6382   acc: 5.92% -> 48.68%              
client [59] (test)  loss: 42.6981 -> 2.3256   acc: 0.32% -> 39.68%             
client [48] (test)  loss: 4.4526 -> 3.0950   acc: 3.59% -> 19.28%              
client [34] (test)  loss: 4.3721 -> 2.9033   acc: 5.96% -> 10.93%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.3088 -> 1.7058   acc: 1.70% -> 55.81%              
client [99] (test)  loss: 4.9167 -> 3.1582   acc: 0.32% -> 21.66%              
client [67] (test)  loss: 4.4276 -> 2.1971   acc: 0.31% -> 36.05%              
client [0] (test)  loss: 4.3765 -> 2.9255   acc: 2.25% -> 22.52%               
client [76] (test)  loss: 4.9855 -> 2.4775   acc: 0.00% -> 37.21%              
client [41] (test)  loss: 4.8002 -> 2.8586   acc: 0.33% -> 19.00%              
client [62] (test)  loss: 125.2262 -> 2.5950   acc: 0.00% -> 27.21%            
client [2] (test)  loss: 109.2285 -> 2.9595   acc: 3.08% -> 25.00%             
client [14] (test)  loss: 4.9275 -> 3.0582   acc: 0.00% -> 24.12%              
client [46] (test)  loss: 5.0404 -> 2.5159   acc: 1.20% -> 36.80%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1378 -> 2.8378   acc: 5.70% -> 27.00%              
client [68] (test)  loss: 4.7291 -> 2.1153   acc: 1.92% -> 37.70%              
client [57] (test)  loss: 5.0739 -> 2.5583   acc: 2.31% -> 32.01%              
client [17] (test)  loss: 7.2943 -> 2.3957   acc: 0.00% -> 30.16%              
client [54] (test)  loss: 4.4479 -> 2.8283   acc: 3.26% -> 22.28%              
client [23] (test)  loss: 187.3858 -> 2.6136   acc: 2.73% -> 25.00%            
client [35] (test)  loss: 5.2934 -> 1.9794   acc: 0.00% -> 41.67%              
client [59] (test)  loss: 4.9195 -> 1.9609   acc: 5.48% -> 44.84%              
client [31] (test)  loss: 3.7004 -> 2.5278   acc: 16.72% -> 32.80%             
client [9] (test)  loss: 4.6547 -> 2.6302   acc: 3.32% -> 17.82%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.4006 -> 2.5739   acc: 0.56% -> 33.89%              
client [33] (test)  loss: 4.5547 -> 2.6367   acc: 2.61% -> 41.79%              
client [16] (test)  loss: 4.3763 -> 3.9786   acc: 11.55% -> 8.45%              
client [44] (test)  loss: 4.8116 -> 3.1467   acc: 0.65% -> 13.73%              
client [8] (test)  loss: 4.3713 -> 2.2881   acc: 6.09% -> 38.78%               
client [31] (test)  loss: 4.2812 -> 2.3255   acc: 2.25% -> 36.33%              
client [47] (test)  loss: 4.2656 -> 2.5720   acc: 4.14% -> 30.45%              
client [36] (test)  loss: 4.4710 -> 2.9162   acc: 1.39% -> 18.06%              
client [20] (test)  loss: 4.4740 -> 1.6802   acc: 7.89% -> 46.38%              
client [56] (test)  loss: 4.3205 -> 3.0412   acc: 4.46% -> 23.76%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.6320 -> 1.9153   acc: 5.73% -> 45.22%               
client [60] (test)  loss: 4.7370 -> 2.8616   acc: 2.56% -> 28.21%              
client [28] (test)  loss: 5.5394 -> 2.5077   acc: 1.39% -> 33.45%              
client [25] (test)  loss: 4.9577 -> 2.1070   acc: 0.42% -> 45.99%              
client [58] (test)  loss: 4.6777 -> 2.7027   acc: 1.58% -> 23.10%              
client [44] (test)  loss: 6.2559 -> 2.8415   acc: 0.98% -> 16.99%              
client [39] (test)  loss: 4.2565 -> 2.7059   acc: 9.06% -> 22.98%              
client [29] (test)  loss: 4.9562 -> 2.3175   acc: 4.86% -> 37.14%              
client [3] (test)  loss: 4.3004 -> 2.2447   acc: 9.48% -> 33.64%               
client [84] (test)  loss: 4.4691 -> 2.4401   acc: 1.86% -> 40.37%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 6.6114 -> 2.2860   acc: 2.59% -> 30.55%              
client [84] (test)  loss: 4.1560 -> 2.3696   acc: 5.28% -> 40.68%              
client [10] (test)  loss: 3.9456 -> 2.6605   acc: 8.33% -> 32.94%              
client [36] (test)  loss: 4.9194 -> 2.7026   acc: 1.04% -> 23.96%              
client [65] (test)  loss: 4.2821 -> 3.3844   acc: 6.48% -> 21.05%              
client [81] (test)  loss: 4.0756 -> 2.3433   acc: 11.39% -> 37.97%             
client [79] (test)  loss: 3.8544 -> 1.6825   acc: 21.47% -> 51.41%             
client [42] (test)  loss: 4.6182 -> 2.3391   acc: 3.91% -> 38.76%              
client [11] (test)  loss: 4.4408 -> 2.3270   acc: 3.37% -> 35.28%              
client [96] (test)  loss: 7.2414 -> 2.0671   acc: 0.31% -> 43.34%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.2552 -> 2.3422   acc: 8.33% -> 40.06%               
client [53] (test)  loss: 4.6895 -> 2.2688   acc: 3.89% -> 37.72%              
client [52] (test)  loss: 4.6399 -> 2.8809   acc: 2.33% -> 36.54%              
client [42] (test)  loss: 4.3785 -> 2.4496   acc: 3.26% -> 37.13%              
client [69] (test)  loss: 3.5938 -> 1.6550   acc: 15.58% -> 57.22%             
client [59] (test)  loss: 4.7167 -> 1.8310   acc: 4.19% -> 50.32%              
client [7] (test)  loss: 5.1537 -> 2.0850   acc: 0.32% -> 38.19%               
client [26] (test)  loss: 4.0565 -> 2.5878   acc: 5.77% -> 27.69%              
client [49] (test)  loss: 3.7817 -> 2.3532   acc: 9.48% -> 41.67%              
client [98] (test)  loss: 4.5156 -> 2.8494   acc: 4.69% -> 27.50%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.0810 -> 2.7038   acc: 4.69% -> 28.75%              
client [47] (test)  loss: 4.7694 -> 2.4938   acc: 4.51% -> 32.33%              
client [21] (test)  loss: 4.7491 -> 2.0756   acc: 5.76% -> 40.35%              
client [77] (test)  loss: 4.0955 -> 1.9860   acc: 9.09% -> 45.45%              
client [95] (test)  loss: 4.6162 -> 2.1573   acc: 7.59% -> 45.21%              
client [91] (test)  loss: 3.8749 -> 2.1184   acc: 8.04% -> 39.55%              
client [14] (test)  loss: 3.6356 -> 2.2772   acc: 13.53% -> 42.94%             
client [99] (test)  loss: 4.4451 -> 3.8001   acc: 4.46% -> 23.89%              
client [20] (test)  loss: 4.4177 -> 2.0758   acc: 1.64% -> 38.16%              
client [39] (test)  loss: 4.7012 -> 2.5262   acc: 7.12% -> 29.13%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.9306 -> 2.7842   acc: 5.98% -> 39.20%              
client [62] (test)  loss: 3.8574 -> 2.2501   acc: 12.79% -> 38.03%             
client [71] (test)  loss: 4.0166 -> 2.6779   acc: 13.31% -> 30.52%             
client [97] (test)  loss: 4.0067 -> 2.5539   acc: 8.62% -> 30.17%              
client [30] (test)  loss: 3.7551 -> 2.4588   acc: 15.51% -> 30.70%             
client [88] (test)  loss: 4.2126 -> 2.1511   acc: 4.97% -> 41.39%              
client [60] (test)  loss: 4.2454 -> 2.4752   acc: 3.21% -> 35.26%              
client [82] (test)  loss: 4.4736 -> 2.3330   acc: 5.19% -> 38.06%              
client [91] (test)  loss: 3.7241 -> 2.1352   acc: 9.65% -> 41.48%              
client [57] (test)  loss: 3.4757 -> 1.9844   acc: 23.10% -> 51.16%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.5235 -> 2.0607   acc: 20.26% -> 38.91%             
client [15] (test)  loss: 4.4139 -> 2.3204   acc: 5.06% -> 34.81%              
client [71] (test)  loss: 4.8501 -> 2.6895   acc: 5.19% -> 31.49%              
client [97] (test)  loss: 3.7403 -> 2.4577   acc: 12.93% -> 34.05%             
client [53] (test)  loss: 4.1443 -> 2.1620   acc: 11.68% -> 44.61%             
client [77] (test)  loss: 3.9063 -> 2.0699   acc: 8.46% -> 44.20%              
client [76] (test)  loss: 4.1190 -> 2.3530   acc: 9.30% -> 39.20%              
client [79] (test)  loss: 3.6777 -> 1.4942   acc: 8.76% -> 54.80%              
client [28] (test)  loss: 4.6736 -> 2.2755   acc: 2.09% -> 40.77%              
client [99] (test)  loss: 4.3213 -> 3.7784   acc: 7.96% -> 24.84%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.6891 -> 2.4458   acc: 19.40% -> 35.34%             
client [86] (test)  loss: 5.8697 -> 2.1888   acc: 6.57% -> 39.10%              
client [34] (test)  loss: 3.9294 -> 2.2497   acc: 5.96% -> 35.43%              
client [73] (test)  loss: 3.6958 -> 2.2499   acc: 13.67% -> 37.33%             
client [5] (test)  loss: 3.8569 -> 1.9937   acc: 14.06% -> 42.17%              
client [96] (test)  loss: 4.1770 -> 1.8420   acc: 7.74% -> 47.99%              
client [22] (test)  loss: 4.1584 -> 2.4000   acc: 4.67% -> 34.27%              
client [60] (test)  loss: 3.8879 -> 2.4681   acc: 5.13% -> 35.26%              
client [66] (test)  loss: 4.2382 -> 2.0699   acc: 4.21% -> 45.31%              
client [83] (test)  loss: 5.6477 -> 1.9055   acc: 5.63% -> 44.04%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.8400 -> 2.2955   acc: 13.95% -> 38.21%             
client [65] (test)  loss: 4.0896 -> 2.6197   acc: 8.10% -> 34.01%              
client [95] (test)  loss: 3.8263 -> 2.3404   acc: 10.56% -> 41.58%             
client [17] (test)  loss: 4.3821 -> 2.4208   acc: 8.25% -> 31.11%              
client [8] (test)  loss: 4.4412 -> 2.2997   acc: 8.01% -> 44.87%               
client [35] (test)  loss: 5.0091 -> 1.7753   acc: 2.67% -> 49.00%              
client [98] (test)  loss: 4.3576 -> 2.7944   acc: 10.31% -> 30.00%             
client [53] (test)  loss: 3.3125 -> 2.1974   acc: 23.05% -> 44.61%             
client [43] (test)  loss: 6.1825 -> 2.3181   acc: 3.03% -> 38.48%              
client [64] (test)  loss: 4.1017 -> 2.3719   acc: 7.28% -> 43.98%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.7814 -> 1.9446   acc: 12.39% -> 44.67%             
client [88] (test)  loss: 4.5061 -> 2.0290   acc: 5.30% -> 44.04%              
client [38] (test)  loss: 4.9611 -> 2.2780   acc: 7.65% -> 45.33%              
client [3] (test)  loss: 4.6827 -> 1.9081   acc: 11.62% -> 46.48%              
client [5] (test)  loss: 4.1174 -> 2.0371   acc: 10.22% -> 42.49%              
client [41] (test)  loss: 4.4162 -> 2.1990   acc: 5.67% -> 35.33%              
client [7] (test)  loss: 4.7423 -> 2.0274   acc: 3.24% -> 43.37%               
client [37] (test)  loss: 4.6531 -> 2.2591   acc: 9.65% -> 38.91%              
client [45] (test)  loss: 5.0105 -> 2.1744   acc: 3.00% -> 40.00%              
client [47] (test)  loss: 5.1858 -> 2.3198   acc: 3.01% -> 36.84%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.8506 -> 2.1982   acc: 4.23% -> 39.72%              
client [11] (test)  loss: 3.3876 -> 2.1353   acc: 16.56% -> 46.32%             
client [37] (test)  loss: 4.8167 -> 2.3351   acc: 6.43% -> 39.23%              
client [41] (test)  loss: 4.1678 -> 2.1725   acc: 5.00% -> 37.33%              
client [95] (test)  loss: 4.3383 -> 1.9866   acc: 10.89% -> 50.17%             
client [53] (test)  loss: 3.7985 -> 2.1261   acc: 15.57% -> 45.81%             
client [22] (test)  loss: 3.7856 -> 2.1510   acc: 14.33% -> 42.68%             
client [25] (test)  loss: 4.5718 -> 2.1777   acc: 8.02% -> 44.73%              
client [69] (test)  loss: 4.0886 -> 1.2272   acc: 19.26% -> 67.42%             
client [46] (test)  loss: 3.5989 -> 1.8140   acc: 11.20% -> 54.40%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.2572 -> 2.2750   acc: 13.53% -> 39.10%             
client [69] (test)  loss: 3.6053 -> 1.1983   acc: 22.66% -> 70.54%             
client [82] (test)  loss: 4.8767 -> 2.2218   acc: 6.23% -> 42.91%              
client [45] (test)  loss: 4.0225 -> 2.1841   acc: 7.67% -> 43.67%              
client [7] (test)  loss: 4.3366 -> 2.1348   acc: 4.85% -> 44.01%               
client [50] (test)  loss: 4.9212 -> 1.8368   acc: 2.51% -> 50.54%              
client [35] (test)  loss: 4.3273 -> 1.8146   acc: 7.67% -> 48.67%              
client [24] (test)  loss: 4.3709 -> 2.1175   acc: 13.31% -> 43.35%             
client [15] (test)  loss: 4.6176 -> 2.2923   acc: 7.28% -> 36.71%              
client [58] (test)  loss: 3.8333 -> 2.4292   acc: 9.18% -> 33.54%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.8438 -> 2.4151   acc: 17.32% -> 39.22%             
client [76] (test)  loss: 3.3797 -> 2.3427   acc: 15.61% -> 39.87%             
client [67] (test)  loss: 4.4038 -> 1.7355   acc: 13.48% -> 47.34%             
client [37] (test)  loss: 3.9065 -> 2.4197   acc: 12.22% -> 37.94%             
client [58] (test)  loss: 3.5092 -> 2.2697   acc: 17.09% -> 35.44%             
client [64] (test)  loss: 4.7131 -> 2.2100   acc: 6.44% -> 47.90%              
client [77] (test)  loss: 3.3334 -> 2.0549   acc: 23.20% -> 44.20%             
client [55] (test)  loss: 2.8015 -> 2.2513   acc: 31.99% -> 41.93%             
client [12] (test)  loss: 4.2501 -> 1.8854   acc: 9.54% -> 53.95%              
client [89] (test)  loss: 3.5240 -> 2.3702   acc: 18.35% -> 39.45%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.3545 -> 2.2420   acc: 25.16% -> 44.10%             
client [51] (test)  loss: 4.9072 -> 2.2365   acc: 3.92% -> 39.54%              
client [8] (test)  loss: 3.7103 -> 2.0531   acc: 15.71% -> 49.36%              
client [18] (test)  loss: 4.7751 -> 1.6327   acc: 10.16% -> 58.59%             
client [94] (test)  loss: 4.0216 -> 2.0790   acc: 9.62% -> 44.55%              
client [81] (test)  loss: 3.7418 -> 2.1484   acc: 15.19% -> 47.15%             
client [3] (test)  loss: 3.8383 -> 1.8607   acc: 16.51% -> 48.93%              
client [11] (test)  loss: 3.6777 -> 2.0907   acc: 15.95% -> 47.55%             
client [95] (test)  loss: 4.1983 -> 2.0289   acc: 10.23% -> 45.87%             
client [67] (test)  loss: 3.7897 -> 1.7450   acc: 11.60% -> 50.47%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.2960 -> 2.0146   acc: 7.49% -> 44.96%              
client [79] (test)  loss: 3.5528 -> 1.4946   acc: 18.93% -> 57.06%             
client [58] (test)  loss: 3.3437 -> 2.2905   acc: 19.30% -> 35.13%             
client [88] (test)  loss: 4.3026 -> 2.0583   acc: 10.60% -> 46.69%             
client [46] (test)  loss: 3.6477 -> 1.7652   acc: 17.60% -> 55.20%             
client [11] (test)  loss: 3.4342 -> 2.0957   acc: 19.63% -> 47.24%             
client [55] (test)  loss: 3.0216 -> 1.7542   acc: 31.68% -> 51.86%             
client [13] (test)  loss: 3.6750 -> 1.8971   acc: 16.72% -> 47.11%             
client [31] (test)  loss: 3.8332 -> 2.0258   acc: 19.29% -> 42.44%             
client [75] (test)  loss: 4.0701 -> 1.7596   acc: 12.29% -> 52.82%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.4596 -> 2.1586   acc: 11.40% -> 43.32%             
client [7] (test)  loss: 4.8996 -> 2.0517   acc: 5.50% -> 43.69%               
client [57] (test)  loss: 3.1773 -> 2.0129   acc: 31.68% -> 47.52%             
client [13] (test)  loss: 4.9644 -> 1.9531   acc: 5.78% -> 45.59%              
client [43] (test)  loss: 5.9753 -> 2.1825   acc: 4.24% -> 40.00%              
client [91] (test)  loss: 4.1447 -> 1.7858   acc: 13.83% -> 52.09%             
client [10] (test)  loss: 4.3586 -> 2.2346   acc: 6.75% -> 40.48%              
client [64] (test)  loss: 3.6265 -> 2.2742   acc: 18.49% -> 47.06%             
client [82] (test)  loss: 4.2017 -> 2.3077   acc: 6.92% -> 41.87%              
client [22] (test)  loss: 3.8329 -> 2.1850   acc: 14.02% -> 43.30%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.4324 -> 1.2145   acc: 4.61% -> 66.45%              
client [23] (test)  loss: 4.8339 -> 2.3970   acc: 8.59% -> 38.67%              
client [88] (test)  loss: 4.0726 -> 2.0071   acc: 13.58% -> 47.68%             
client [98] (test)  loss: 3.7346 -> 2.5204   acc: 17.19% -> 38.44%             
client [79] (test)  loss: 2.9549 -> 1.5033   acc: 28.53% -> 59.60%             
client [21] (test)  loss: 4.7089 -> 2.1119   acc: 5.76% -> 43.23%              
client [92] (test)  loss: 3.6053 -> 2.3352   acc: 19.67% -> 41.42%             
client [56] (test)  loss: 3.8995 -> 1.9564   acc: 21.78% -> 51.49%             
client [5] (test)  loss: 4.4338 -> 1.8952   acc: 11.18% -> 47.92%              
client [52] (test)  loss: 3.4782 -> 2.2401   acc: 25.58% -> 50.83%             
==================== FedBN TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '4.2411 -> 0.0000', 'accuracy': '8.49% -> 0.00%'},           
    200: {'loss': '4.2206 -> 0.0000', 'accuracy': '12.69% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN achieved 10.0%(10.70%) at epoch: 89                                      
Convergence (test_after):                                                      
FedBN achieved 10.0%(18.39%) at epoch: 0                                       
FedBN achieved 20.0%(26.58%) at epoch: 1                                       
FedBN achieved 30.0%(34.16%) at epoch: 14                                      
FedBN achieved 40.0%(40.95%) at epoch: 40                                      
FedBN achieved 50.0%(50.47%) at epoch: 190                                     
