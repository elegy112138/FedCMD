==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2865 -> 3.9758   acc: 0.86% -> 7.39%               
client [81] (test)  loss: 5.1866 -> 3.5265   acc: 2.85% -> 11.39%              
client [21] (test)  loss: 5.3466 -> 3.4473   acc: 1.40% -> 22.20%              
client [68] (test)  loss: 5.6212 -> 3.8441   acc: 0.33% -> 10.24%              
client [93] (test)  loss: 5.4425 -> 3.4666   acc: 1.10% -> 19.67%              
client [31] (test)  loss: 5.7656 -> 3.0758   acc: 0.52% -> 25.44%              
client [20] (test)  loss: 4.9920 -> 4.6289   acc: 6.40% -> 3.81%               
client [59] (test)  loss: 5.2618 -> 3.6180   acc: 0.53% -> 11.09%              
client [48] (test)  loss: 5.2710 -> 3.5227   acc: 1.75% -> 30.85%              
client [34] (test)  loss: 5.0791 -> 3.5442   acc: 2.78% -> 17.87%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.0819 -> 3.7388   acc: 0.27% -> 9.84%               
client [99] (test)  loss: 5.2054 -> 4.2990   acc: 1.84% -> 9.20%               
client [67] (test)  loss: 5.1349 -> 3.1469   acc: 1.06% -> 20.81%              
client [0] (test)  loss: 5.0476 -> 3.5207   acc: 7.17% -> 14.34%               
client [76] (test)  loss: 5.1924 -> 3.7450   acc: 1.27% -> 12.55%              
client [41] (test)  loss: 5.0611 -> 3.2198   acc: 1.60% -> 18.51%              
client [62] (test)  loss: 5.3099 -> 4.2398   acc: 1.37% -> 8.21%               
client [2] (test)  loss: 5.2737 -> 3.2374   acc: 0.00% -> 16.96%               
client [14] (test)  loss: 4.9817 -> 2.8382   acc: 1.60% -> 24.73%              
client [46] (test)  loss: 4.8897 -> 3.7216   acc: 2.88% -> 9.37%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.6284 -> 3.2946   acc: 3.29% -> 17.53%              
client [68] (test)  loss: 5.2359 -> 3.7053   acc: 2.11% -> 17.89%              
client [57] (test)  loss: 4.7547 -> 3.6770   acc: 7.82% -> 18.55%              
client [17] (test)  loss: 5.6141 -> 2.9120   acc: 1.26% -> 23.06%              
client [54] (test)  loss: 5.0073 -> 3.3592   acc: 3.09% -> 15.59%              
client [23] (test)  loss: 5.2067 -> 3.0363   acc: 1.59% -> 24.60%              
client [35] (test)  loss: 5.2148 -> 3.2887   acc: 4.02% -> 12.85%              
client [59] (test)  loss: 4.9736 -> 3.3913   acc: 1.76% -> 17.08%              
client [31] (test)  loss: 4.6816 -> 2.7062   acc: 1.74% -> 36.59%              
client [9] (test)  loss: 4.6910 -> 5.5860   acc: 7.45% -> 8.91%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.2651 -> 3.1304   acc: 2.48% -> 25.74%              
client [33] (test)  loss: 4.6938 -> 3.1143   acc: 5.45% -> 24.77%              
client [16] (test)  loss: 4.8321 -> 3.5943   acc: 3.10% -> 13.66%              
client [44] (test)  loss: 8.2236 -> 2.9970   acc: 1.29% -> 24.32%              
client [8] (test)  loss: 5.0064 -> 2.8504   acc: 2.23% -> 29.57%               
client [31] (test)  loss: 5.0233 -> 2.5569   acc: 3.66% -> 38.33%              
client [47] (test)  loss: 5.4281 -> 2.4084   acc: 2.53% -> 43.94%              
client [36] (test)  loss: 4.4694 -> 2.5782   acc: 10.87% -> 37.50%             
client [20] (test)  loss: 4.9234 -> 3.1980   acc: 5.88% -> 19.55%              
client [56] (test)  loss: 5.0177 -> 3.2138   acc: 2.49% -> 19.75%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.4094 -> 4.6881   acc: 1.08% -> 19.17%               
client [60] (test)  loss: 5.3349 -> 2.8291   acc: 3.45% -> 29.64%              
client [28] (test)  loss: 4.8275 -> 2.9650   acc: 8.68% -> 29.11%              
client [25] (test)  loss: 5.9418 -> 3.1347   acc: 5.04% -> 22.96%              
client [58] (test)  loss: 4.9221 -> 3.0082   acc: 3.18% -> 23.32%              
client [44] (test)  loss: 4.6412 -> 2.9220   acc: 8.21% -> 26.25%              
client [39] (test)  loss: 5.3074 -> 3.4159   acc: 3.30% -> 17.49%              
client [29] (test)  loss: 5.2028 -> 3.1540   acc: 11.22% -> 20.07%             
client [3] (test)  loss: 4.6558 -> 3.0207   acc: 7.84% -> 21.41%               
client [84] (test)  loss: 4.8027 -> 3.0678   acc: 5.67% -> 27.66%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.5638 -> 3.1332   acc: 2.20% -> 25.40%              
client [84] (test)  loss: 4.4268 -> 3.0079   acc: 7.62% -> 29.08%              
client [10] (test)  loss: 5.0536 -> 2.9283   acc: 3.92% -> 24.07%              
client [36] (test)  loss: 4.2573 -> 2.4439   acc: 8.88% -> 38.59%              
client [65] (test)  loss: 4.5037 -> 3.3089   acc: 7.35% -> 17.38%              
client [81] (test)  loss: 5.3001 -> 2.9491   acc: 5.34% -> 22.24%              
client [79] (test)  loss: 5.0507 -> 3.2985   acc: 3.21% -> 17.31%              
client [42] (test)  loss: 4.6973 -> 2.9855   acc: 4.83% -> 26.83%              
client [11] (test)  loss: 4.7831 -> 3.5983   acc: 4.84% -> 15.57%              
client [96] (test)  loss: 4.9351 -> 2.5884   acc: 4.14% -> 29.32%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.2299 -> 2.7324   acc: 3.50% -> 33.07%               
client [53] (test)  loss: 4.7953 -> 2.7907   acc: 6.59% -> 34.69%              
client [52] (test)  loss: 4.3747 -> 3.5192   acc: 14.36% -> 21.45%             
client [42] (test)  loss: 4.2840 -> 2.9590   acc: 10.38% -> 28.62%             
client [69] (test)  loss: 4.8250 -> 3.4956   acc: 5.59% -> 15.69%              
client [59] (test)  loss: 4.4474 -> 3.0430   acc: 6.34% -> 25.53%              
client [7] (test)  loss: 5.5580 -> 3.6725   acc: 4.49% -> 15.80%               
client [26] (test)  loss: 4.6611 -> 2.8714   acc: 9.27% -> 30.19%              
client [49] (test)  loss: 4.2569 -> 3.1803   acc: 10.31% -> 26.40%             
client [98] (test)  loss: 4.7726 -> 2.7667   acc: 5.48% -> 31.57%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.5126 -> 2.7210   acc: 10.78% -> 34.03%             
client [47] (test)  loss: 5.3103 -> 2.2755   acc: 4.88% -> 45.39%              
client [21] (test)  loss: 5.1049 -> 3.0774   acc: 4.40% -> 27.40%              
client [77] (test)  loss: 4.5757 -> 2.7309   acc: 4.30% -> 28.69%              
client [95] (test)  loss: 4.3180 -> 2.5981   acc: 15.16% -> 42.95%             
client [91] (test)  loss: 4.5001 -> 2.7085   acc: 11.17% -> 31.98%             
client [14] (test)  loss: 4.1595 -> 2.6420   acc: 9.25% -> 36.30%              
client [99] (test)  loss: 4.8366 -> 3.6475   acc: 5.73% -> 21.47%              
client [20] (test)  loss: 4.7361 -> 3.0737   acc: 7.09% -> 24.22%              
client [39] (test)  loss: 6.1013 -> 3.2046   acc: 3.30% -> 23.10%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.3611 -> 3.2980   acc: 15.78% -> 25.53%             
client [62] (test)  loss: 4.4603 -> 3.1782   acc: 8.38% -> 23.25%              
client [71] (test)  loss: 4.2430 -> 3.2271   acc: 15.22% -> 24.15%             
client [97] (test)  loss: 4.7332 -> 2.9003   acc: 7.44% -> 25.57%              
client [30] (test)  loss: 3.9270 -> 3.1557   acc: 17.17% -> 24.59%             
client [88] (test)  loss: 4.6991 -> 3.1453   acc: 10.24% -> 26.45%             
client [60] (test)  loss: 5.0609 -> 2.7035   acc: 4.73% -> 36.00%              
client [82] (test)  loss: 4.7123 -> 2.7813   acc: 8.28% -> 33.93%              
client [91] (test)  loss: 4.4066 -> 2.6655   acc: 13.03% -> 33.84%             
client [57] (test)  loss: 4.1714 -> 3.1751   acc: 15.09% -> 26.91%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.2102 -> 2.5620   acc: 11.32% -> 43.90%             
client [15] (test)  loss: 4.2105 -> 2.8738   acc: 12.24% -> 29.37%             
client [71] (test)  loss: 4.7056 -> 3.2451   acc: 7.00% -> 23.91%              
client [97] (test)  loss: 4.6550 -> 2.8810   acc: 5.92% -> 28.44%              
client [53] (test)  loss: 4.9635 -> 2.7664   acc: 5.43% -> 37.21%              
client [77] (test)  loss: 4.5012 -> 2.7268   acc: 10.82% -> 31.27%             
client [76] (test)  loss: 4.4264 -> 2.7260   acc: 8.91% -> 33.82%              
client [79] (test)  loss: 5.1144 -> 3.3014   acc: 4.49% -> 17.09%              
client [28] (test)  loss: 4.6580 -> 2.6750   acc: 7.78% -> 34.18%              
client [99] (test)  loss: 5.1349 -> 3.5669   acc: 5.32% -> 23.72%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.5011 -> 2.9573   acc: 7.06% -> 29.58%              
client [86] (test)  loss: 4.3370 -> 2.7364   acc: 10.18% -> 36.19%             
client [34] (test)  loss: 4.6417 -> 3.3014   acc: 9.28% -> 24.59%              
client [73] (test)  loss: 4.4978 -> 2.7957   acc: 11.76% -> 33.23%             
client [5] (test)  loss: 4.4670 -> 2.7900   acc: 6.85% -> 29.55%               
client [96] (test)  loss: 4.2548 -> 2.4224   acc: 12.77% -> 35.97%             
client [22] (test)  loss: 4.6902 -> 2.9002   acc: 9.27% -> 33.93%              
client [60] (test)  loss: 4.6977 -> 2.5593   acc: 6.55% -> 38.55%              
client [66] (test)  loss: 4.8245 -> 3.2221   acc: 6.06% -> 23.53%              
client [83] (test)  loss: 4.5125 -> 3.4749   acc: 11.95% -> 20.11%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.4445 -> 2.8433   acc: 10.73% -> 33.45%             
client [65] (test)  loss: 4.2283 -> 3.3336   acc: 13.08% -> 25.99%             
client [95] (test)  loss: 5.3321 -> 2.7309   acc: 8.00% -> 40.63%              
client [17] (test)  loss: 4.5579 -> 2.6117   acc: 15.32% -> 36.33%             
client [8] (test)  loss: 5.1279 -> 2.6081   acc: 5.72% -> 38.63%               
client [35] (test)  loss: 5.1807 -> 2.8750   acc: 7.23% -> 33.73%              
client [98] (test)  loss: 4.9777 -> 2.7540   acc: 7.56% -> 38.19%              
client [53] (test)  loss: 4.4138 -> 2.8386   acc: 11.82% -> 36.24%             
client [43] (test)  loss: 4.4686 -> 2.9197   acc: 10.70% -> 33.39%             
client [64] (test)  loss: 5.0746 -> 3.2138   acc: 5.61% -> 33.33%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.2203 -> 3.2106   acc: 5.40% -> 30.60%              
client [88] (test)  loss: 4.7988 -> 3.2600   acc: 11.77% -> 27.99%             
client [38] (test)  loss: 4.6498 -> 3.1480   acc: 10.45% -> 27.00%             
client [3] (test)  loss: 4.5788 -> 2.9496   acc: 6.70% -> 31.21%               
client [5] (test)  loss: 4.8810 -> 2.8454   acc: 6.13% -> 30.99%               
client [41] (test)  loss: 4.6700 -> 3.0410   acc: 5.87% -> 29.36%              
client [7] (test)  loss: 5.3546 -> 3.5947   acc: 7.36% -> 23.34%               
client [37] (test)  loss: 5.0169 -> 2.8839   acc: 6.33% -> 27.76%              
client [45] (test)  loss: 5.1514 -> 3.0261   acc: 7.30% -> 27.99%              
client [47] (test)  loss: 5.9905 -> 2.5154   acc: 2.71% -> 45.93%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.8590 -> 3.0924   acc: 9.47% -> 26.78%              
client [11] (test)  loss: 4.9330 -> 3.2840   acc: 8.13% -> 27.68%              
client [37] (test)  loss: 4.9270 -> 3.1964   acc: 6.98% -> 29.87%              
client [41] (test)  loss: 4.9462 -> 3.1793   acc: 5.16% -> 27.22%              
client [95] (test)  loss: 5.3648 -> 2.8475   acc: 7.79% -> 41.89%              
client [53] (test)  loss: 5.2065 -> 2.9612   acc: 7.17% -> 36.82%              
client [22] (test)  loss: 4.5352 -> 2.9873   acc: 12.23% -> 33.33%             
client [25] (test)  loss: 4.9886 -> 3.2861   acc: 8.87% -> 28.52%              
client [69] (test)  loss: 4.9406 -> 3.6344   acc: 7.98% -> 23.94%              
client [46] (test)  loss: 4.1867 -> 3.0598   acc: 13.87% -> 30.45%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.3757 -> 2.2691   acc: 13.20% -> 46.84%             
client [69] (test)  loss: 5.0013 -> 3.7067   acc: 8.78% -> 23.67%              
client [82] (test)  loss: 4.6705 -> 3.0071   acc: 8.12% -> 33.77%              
client [45] (test)  loss: 4.7613 -> 3.2652   acc: 11.76% -> 26.77%             
client [7] (test)  loss: 5.2494 -> 3.4707   acc: 7.18% -> 25.67%               
client [50] (test)  loss: 4.7195 -> 2.9938   acc: 11.57% -> 32.82%             
client [35] (test)  loss: 4.9211 -> 3.0277   acc: 7.43% -> 30.92%              
client [24] (test)  loss: 4.7996 -> 2.8464   acc: 7.40% -> 40.00%              
client [15] (test)  loss: 4.4026 -> 2.9709   acc: 13.11% -> 31.12%             
client [58] (test)  loss: 5.2654 -> 3.2906   acc: 7.60% -> 29.15%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.8789 -> 2.5443   acc: 8.53% -> 42.23%              
client [76] (test)  loss: 4.8967 -> 3.1511   acc: 10.73% -> 30.00%             
client [67] (test)  loss: 4.7479 -> 3.1849   acc: 10.23% -> 30.51%             
client [37] (test)  loss: 5.3694 -> 3.3831   acc: 4.87% -> 28.41%              
client [58] (test)  loss: 4.9526 -> 3.4626   acc: 8.83% -> 28.62%              
client [64] (test)  loss: 4.6388 -> 3.1441   acc: 7.10% -> 36.80%              
client [77] (test)  loss: 4.4946 -> 2.9921   acc: 12.03% -> 29.55%             
client [55] (test)  loss: 5.0998 -> 3.2341   acc: 10.40% -> 29.74%             
client [12] (test)  loss: 5.4733 -> 2.7411   acc: 4.74% -> 38.99%              
client [89] (test)  loss: 4.5512 -> 3.1107   acc: 13.02% -> 32.19%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.6966 -> 4.0171   acc: 11.88% -> 27.84%             
client [51] (test)  loss: 5.4168 -> 2.7572   acc: 10.18% -> 37.45%             
client [8] (test)  loss: 5.2479 -> 2.8769   acc: 5.72% -> 40.22%               
client [18] (test)  loss: 4.6868 -> 3.4562   acc: 8.77% -> 28.80%              
client [94] (test)  loss: 4.9465 -> 2.9771   acc: 9.65% -> 38.07%              
client [81] (test)  loss: 5.0116 -> 2.9810   acc: 9.61% -> 33.27%              
client [3] (test)  loss: 4.5584 -> 2.9959   acc: 10.29% -> 31.70%              
client [11] (test)  loss: 4.9264 -> 3.6054   acc: 8.48% -> 25.61%              
client [95] (test)  loss: 5.1277 -> 2.8895   acc: 11.16% -> 41.89%             
client [67] (test)  loss: 4.9516 -> 3.2516   acc: 6.70% -> 32.80%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.4918 -> 3.3427   acc: 6.40% -> 31.20%              
client [79] (test)  loss: 5.4102 -> 3.7839   acc: 6.62% -> 22.44%              
client [58] (test)  loss: 5.2109 -> 3.6125   acc: 7.24% -> 27.21%              
client [88] (test)  loss: 4.9911 -> 3.7997   acc: 10.75% -> 28.50%             
client [46] (test)  loss: 4.7777 -> 3.2516   acc: 11.89% -> 31.35%             
client [11] (test)  loss: 4.9293 -> 3.8350   acc: 7.96% -> 25.43%              
client [55] (test)  loss: 4.6340 -> 3.4195   acc: 15.69% -> 31.57%             
client [13] (test)  loss: 4.8353 -> 3.4376   acc: 11.95% -> 37.37%             
client [31] (test)  loss: 4.7572 -> 3.2541   acc: 8.54% -> 40.94%              
client [75] (test)  loss: 4.9395 -> 3.1326   acc: 9.57% -> 34.43%              
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.5512 -> 3.3850   acc: 12.77% -> 34.89%             
client [7] (test)  loss: 5.4357 -> 3.4674   acc: 7.00% -> 28.55%               
client [57] (test)  loss: 4.5134 -> 3.5440   acc: 13.82% -> 28.18%             
client [13] (test)  loss: 5.0991 -> 3.5220   acc: 11.60% -> 37.03%             
client [43] (test)  loss: 4.8474 -> 3.3012   acc: 9.58% -> 33.87%              
client [91] (test)  loss: 4.6030 -> 3.2129   acc: 15.23% -> 34.69%             
client [10] (test)  loss: 4.8223 -> 3.1413   acc: 14.74% -> 32.46%             
client [64] (test)  loss: 4.2585 -> 3.0984   acc: 11.72% -> 41.42%             
client [82] (test)  loss: 4.7130 -> 3.2195   acc: 14.29% -> 34.74%             
client [22] (test)  loss: 4.9637 -> 3.2541   acc: 13.61% -> 32.74%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.2056 -> 3.5586   acc: 10.21% -> 25.43%             
client [23] (test)  loss: 4.8808 -> 2.9325   acc: 10.97% -> 38.58%             
client [88] (test)  loss: 5.4250 -> 4.1125   acc: 11.95% -> 26.62%             
client [98] (test)  loss: 4.9951 -> 2.9702   acc: 11.72% -> 40.08%             
client [79] (test)  loss: 5.4832 -> 4.0384   acc: 8.97% -> 22.22%              
client [21] (test)  loss: 5.5100 -> 3.4996   acc: 5.60% -> 29.80%              
client [92] (test)  loss: 5.1253 -> 3.1233   acc: 9.00% -> 32.87%              
client [56] (test)  loss: 5.2679 -> 4.0440   acc: 9.96% -> 25.80%              
client [5] (test)  loss: 5.0053 -> 3.3106   acc: 9.73% -> 32.07%               
client [52] (test)  loss: 5.1368 -> 3.6016   acc: 12.77% -> 32.98%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '4.6547 -> 0.0000', 'accuracy': '8.56% -> 0.00%'},           
    200: {'loss': '5.3090 -> 0.0000', 'accuracy': '9.47% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(11.29%) at epoch: 89                                    
Convergence (test_after):                                                      
FedProx achieved 10.0%(16.35%) at epoch: 0                                     
FedProx achieved 20.0%(23.32%) at epoch: 23                                    
FedProx achieved 30.0%(30.79%) at epoch: 74                                    
