==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7666 -> 0.0131   acc: 85.07% -> 100.00%            
client [81] (test)  loss: 1.6075 -> 0.4502   acc: 18.18% -> 83.64%             
client [21] (test)  loss: 37.9729 -> 0.3974   acc: 26.33% -> 86.47%            
client [68] (test)  loss: 0.7394 -> 0.1830   acc: 94.08% -> 94.77%             
client [93] (test)  loss: 2.7237 -> 0.1887   acc: 7.20% -> 96.80%              
client [31] (test)  loss: 1.9180 -> 0.3116   acc: 9.44% -> 93.89%              
client [20] (test)  loss: 1.5070 -> 0.0939   acc: 28.50% -> 96.83%             
client [59] (test)  loss: 15.8350 -> 0.4616   acc: 26.77% -> 86.13%            
client [48] (test)  loss: 1.7663 -> 0.1028   acc: 3.12% -> 98.75%              
client [34] (test)  loss: 1.2205 -> 0.2958   acc: 79.41% -> 91.18%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4237 -> 0.2227   acc: 44.80% -> 94.40%             
client [99] (test)  loss: 2.4791 -> 0.0926   acc: 9.94% -> 98.30%              
client [67] (test)  loss: 2.5730 -> 0.1795   acc: 9.08% -> 94.49%              
client [0] (test)  loss: 0.9533 -> 0.5826   acc: 73.83% -> 81.31%              
client [76] (test)  loss: 1.0186 -> 0.3403   acc: 78.95% -> 94.74%             
client [41] (test)  loss: 0.9896 -> 0.3478   acc: 71.50% -> 88.47%             
client [62] (test)  loss: 48.6612 -> 0.5609   acc: 35.71% -> 92.86%            
client [2] (test)  loss: 8.0478 -> 0.0064   acc: 63.29% -> 100.00%             
client [14] (test)  loss: 2.6957 -> 0.1118   acc: 5.37% -> 96.78%              
client [46] (test)  loss: 2.9923 -> 0.3172   acc: 7.05% -> 91.19%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0624 -> 0.4678   acc: 57.25% -> 81.87%             
client [68] (test)  loss: 0.6374 -> 0.1165   acc: 79.44% -> 96.52%             
client [57] (test)  loss: 0.6211 -> 0.0289   acc: 89.66% -> 99.25%             
client [17] (test)  loss: 1.3339 -> 0.1879   acc: 33.98% -> 94.75%             
client [54] (test)  loss: 0.5211 -> 0.2183   acc: 77.72% -> 91.19%             
client [23] (test)  loss: 9.9269 -> 0.1289   acc: 70.30% -> 96.24%             
client [35] (test)  loss: 1.1904 -> 0.1882   acc: 46.06% -> 93.94%             
client [59] (test)  loss: 1.0280 -> 0.3412   acc: 44.19% -> 88.39%             
client [31] (test)  loss: 1.0020 -> 0.1900   acc: 52.22% -> 95.00%             
client [9] (test)  loss: 0.6310 -> 0.0472   acc: 78.84% -> 98.34%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7395 -> 0.2020   acc: 80.88% -> 93.82%             
client [33] (test)  loss: 0.3908 -> 0.0847   acc: 84.70% -> 96.80%             
client [16] (test)  loss: 0.9344 -> 0.0533   acc: 48.95% -> 98.95%             
client [44] (test)  loss: 1.0124 -> 0.1399   acc: 66.30% -> 95.24%             
client [8] (test)  loss: 0.8157 -> 0.0054   acc: 72.97% -> 100.00%             
client [31] (test)  loss: 0.8171 -> 0.1732   acc: 75.56% -> 95.00%             
client [47] (test)  loss: 0.5094 -> 0.0250   acc: 80.33% -> 99.45%             
client [36] (test)  loss: 0.1920 -> 0.0104   acc: 95.95% -> 99.75%             
client [20] (test)  loss: 0.9636 -> 0.0255   acc: 63.83% -> 98.83%             
client [56] (test)  loss: 0.8018 -> 0.3029   acc: 77.64% -> 89.84%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6075 -> 0.1042   acc: 80.28% -> 97.23%              
client [60] (test)  loss: 1.7826 -> 0.0930   acc: 33.27% -> 97.10%             
client [28] (test)  loss: 0.3804 -> 0.0603   acc: 91.96% -> 97.32%             
client [25] (test)  loss: 1.2481 -> 0.1162   acc: 53.66% -> 96.17%             
client [58] (test)  loss: 1.3314 -> 0.0978   acc: 56.93% -> 97.08%             
client [44] (test)  loss: 1.1044 -> 0.1419   acc: 57.14% -> 95.60%             
client [39] (test)  loss: 0.3647 -> 0.1080   acc: 94.44% -> 94.44%             
client [29] (test)  loss: 1.7195 -> 0.2815   acc: 36.07% -> 90.41%             
client [3] (test)  loss: 0.4326 -> 0.1793   acc: 84.06% -> 93.48%              
client [84] (test)  loss: 1.5791 -> 0.0221   acc: 36.70% -> 99.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7392 -> 0.2601   acc: 70.29% -> 90.34%             
client [84] (test)  loss: 1.1284 -> 0.0232   acc: 49.54% -> 99.54%             
client [10] (test)  loss: 0.4297 -> 0.0636   acc: 90.58% -> 96.38%             
client [36] (test)  loss: 0.1079 -> 0.0082   acc: 97.79% -> 99.63%             
client [65] (test)  loss: 1.5456 -> 0.2019   acc: 27.38% -> 96.43%             
client [81] (test)  loss: 0.6161 -> 0.1405   acc: 82.73% -> 94.55%             
client [79] (test)  loss: 0.9766 -> 0.3555   acc: 61.43% -> 86.73%             
client [42] (test)  loss: 0.9071 -> 0.0384   acc: 64.90% -> 98.99%             
client [11] (test)  loss: 0.7858 -> 0.3580   acc: 72.22% -> 86.00%             
client [96] (test)  loss: 0.5852 -> 0.2743   acc: 79.78% -> 90.17%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3680 -> 0.0044   acc: 89.41% -> 100.00%             
client [53] (test)  loss: 0.3706 -> 0.0348   acc: 87.56% -> 99.29%             
client [52] (test)  loss: 0.9295 -> 0.2508   acc: 55.81% -> 87.60%             
client [42] (test)  loss: 0.2536 -> 0.0355   acc: 93.99% -> 98.93%             
client [69] (test)  loss: 0.5618 -> 0.1631   acc: 83.73% -> 94.93%             
client [59] (test)  loss: 0.5507 -> 0.2984   acc: 83.23% -> 89.68%             
client [7] (test)  loss: 0.5694 -> 0.0533   acc: 79.74% -> 97.97%              
client [26] (test)  loss: 0.5063 -> 0.0127   acc: 85.65% -> 99.84%             
client [49] (test)  loss: 1.1362 -> 0.0083   acc: 59.45% -> 99.79%             
client [98] (test)  loss: 0.6967 -> 1.0057   acc: 80.00% -> 61.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8131 -> 0.4080   acc: 62.00% -> 86.00%             
client [47] (test)  loss: 0.6314 -> 0.0269   acc: 74.82% -> 99.08%             
client [21] (test)  loss: 0.5494 -> 0.2156   acc: 80.19% -> 91.55%             
client [77] (test)  loss: 0.2515 -> 0.0277   acc: 91.83% -> 99.72%             
client [95] (test)  loss: 0.5966 -> 0.1389   acc: 77.44% -> 94.74%             
client [91] (test)  loss: 0.9125 -> 0.0883   acc: 59.38% -> 96.88%             
client [14] (test)  loss: 0.2089 -> 0.0960   acc: 94.63% -> 97.58%             
client [99] (test)  loss: 0.1665 -> 0.0737   acc: 96.02% -> 98.86%             
client [20] (test)  loss: 1.9987 -> 0.0128   acc: 18.00% -> 99.50%             
client [39] (test)  loss: 0.2272 -> 0.0866   acc: 97.22% -> 97.22%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8624 -> 0.2512   acc: 67.44% -> 89.15%             
client [62] (test)  loss: 0.8669 -> 0.2467   acc: 66.67% -> 92.86%             
client [71] (test)  loss: 0.2223 -> 0.0440   acc: 92.04% -> 98.19%             
client [97] (test)  loss: 0.2136 -> 0.0572   acc: 93.92% -> 98.52%             
client [30] (test)  loss: 0.2267 -> 0.1199   acc: 93.63% -> 97.00%             
client [88] (test)  loss: 1.2953 -> 0.5066   acc: 49.72% -> 77.90%             
client [60] (test)  loss: 1.3112 -> 0.0789   acc: 48.74% -> 97.68%             
client [82] (test)  loss: 1.7343 -> 0.0244   acc: 36.70% -> 99.68%             
client [91] (test)  loss: 0.7317 -> 0.0252   acc: 59.38% -> 100.00%            
client [57] (test)  loss: 1.3577 -> 0.0259   acc: 49.25% -> 99.44%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7554 -> 0.1461   acc: 75.00% -> 92.22%             
client [15] (test)  loss: 0.5899 -> 0.2020   acc: 73.46% -> 91.93%             
client [71] (test)  loss: 0.3202 -> 0.0427   acc: 90.60% -> 98.19%             
client [97] (test)  loss: 0.4460 -> 0.0546   acc: 85.71% -> 98.85%             
client [53] (test)  loss: 0.3139 -> 0.0356   acc: 89.48% -> 99.19%             
client [77] (test)  loss: 0.0606 -> 0.0180   acc: 98.59% -> 99.44%             
client [76] (test)  loss: 0.3152 -> 0.1488   acc: 84.21% -> 94.74%             
client [79] (test)  loss: 0.8759 -> 0.3286   acc: 61.43% -> 86.98%             
client [28] (test)  loss: 0.3674 -> 0.0395   acc: 85.71% -> 99.11%             
client [99] (test)  loss: 0.8977 -> 0.0752   acc: 62.22% -> 98.01%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4845 -> 0.0525   acc: 82.43% -> 98.69%             
client [86] (test)  loss: 0.3026 -> 0.0996   acc: 96.49% -> 98.25%             
client [34] (test)  loss: 0.1311 -> 0.0627   acc: 98.53% -> 97.06%             
client [73] (test)  loss: 0.8785 -> 0.0352   acc: 67.14% -> 99.29%             
client [5] (test)  loss: 0.5390 -> 0.0451   acc: 77.95% -> 98.91%              
client [96] (test)  loss: 0.5736 -> 0.2216   acc: 81.18% -> 94.10%             
client [22] (test)  loss: 0.8091 -> 0.0857   acc: 67.92% -> 97.64%             
client [60] (test)  loss: 0.8457 -> 0.0802   acc: 67.70% -> 97.68%             
client [66] (test)  loss: 0.9384 -> 0.0111   acc: 73.26% -> 99.73%             
client [83] (test)  loss: 0.5080 -> 0.0427   acc: 80.97% -> 98.73%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1940 -> 0.1515   acc: 97.37% -> 94.74%             
client [65] (test)  loss: 0.8417 -> 0.1940   acc: 60.71% -> 95.24%             
client [95] (test)  loss: 0.2094 -> 0.1076   acc: 93.23% -> 96.24%             
client [17] (test)  loss: 0.4783 -> 0.1121   acc: 88.95% -> 96.13%             
client [8] (test)  loss: 0.6683 -> 0.0044   acc: 81.08% -> 100.00%             
client [35] (test)  loss: 0.5243 -> 0.1752   acc: 81.82% -> 95.15%             
client [98] (test)  loss: 0.5791 -> 0.2744   acc: 79.00% -> 88.00%             
client [53] (test)  loss: 0.1785 -> 0.0316   acc: 94.74% -> 99.39%             
client [43] (test)  loss: 0.9049 -> 0.1293   acc: 68.15% -> 96.30%             
client [64] (test)  loss: 0.3468 -> 0.1249   acc: 90.59% -> 96.76%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4848 -> 0.1685   acc: 82.85% -> 92.75%             
client [88] (test)  loss: 0.7949 -> 0.3719   acc: 70.17% -> 85.08%             
client [38] (test)  loss: 0.9398 -> 0.3928   acc: 63.64% -> 86.67%             
client [3] (test)  loss: 0.6991 -> 0.1684   acc: 74.46% -> 94.02%              
client [5] (test)  loss: 0.7773 -> 0.0497   acc: 71.40% -> 98.91%              
client [41] (test)  loss: 0.4203 -> 0.1825   acc: 87.05% -> 93.01%             
client [7] (test)  loss: 0.6756 -> 0.0425   acc: 76.43% -> 97.79%              
client [37] (test)  loss: 0.5224 -> 0.1049   acc: 79.38% -> 95.88%             
client [45] (test)  loss: 0.4207 -> 0.3081   acc: 80.77% -> 87.18%             
client [47] (test)  loss: 0.8198 -> 0.0214   acc: 69.67% -> 99.08%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.9118 -> 0.0353   acc: 40.56% -> 98.60%             
client [11] (test)  loss: 2.5550 -> 0.2685   acc: 15.33% -> 91.11%             
client [37] (test)  loss: 2.8376 -> 0.1019   acc: 9.79% -> 95.88%              
client [41] (test)  loss: 1.1675 -> 0.1777   acc: 59.72% -> 93.65%             
client [95] (test)  loss: 0.5642 -> 0.1283   acc: 81.95% -> 95.49%             
client [53] (test)  loss: 0.3241 -> 0.0360   acc: 88.27% -> 99.09%             
client [22] (test)  loss: 1.7462 -> 0.0831   acc: 30.19% -> 97.64%             
client [25] (test)  loss: 0.7514 -> 0.0784   acc: 74.91% -> 96.86%             
client [69] (test)  loss: 0.7107 -> 0.1492   acc: 76.80% -> 93.60%             
client [46] (test)  loss: 0.3109 -> 0.2762   acc: 91.19% -> 90.75%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4571 -> 0.0232   acc: 80.88% -> 99.08%             
client [69] (test)  loss: 1.0135 -> 0.1440   acc: 68.80% -> 93.60%             
client [82] (test)  loss: 0.6955 -> 0.0228   acc: 71.31% -> 99.68%             
client [45] (test)  loss: 0.4356 -> 0.2676   acc: 85.90% -> 87.18%             
client [7] (test)  loss: 0.4824 -> 0.0425   acc: 81.22% -> 98.34%              
client [50] (test)  loss: 1.0328 -> 0.0073   acc: 51.35% -> 99.78%             
client [35] (test)  loss: 0.6659 -> 0.1719   acc: 70.91% -> 95.15%             
client [24] (test)  loss: 0.8092 -> 0.4288   acc: 68.91% -> 85.23%             
client [15] (test)  loss: 0.8404 -> 0.2006   acc: 64.12% -> 92.14%             
client [58] (test)  loss: 0.3797 -> 0.0642   acc: 86.68% -> 97.63%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2367 -> 0.0610   acc: 95.00% -> 97.50%             
client [76] (test)  loss: 0.2896 -> 0.1677   acc: 89.47% -> 94.74%             
client [67] (test)  loss: 1.7163 -> 0.1363   acc: 38.84% -> 95.68%             
client [37] (test)  loss: 0.2640 -> 0.1102   acc: 91.75% -> 95.88%             
client [58] (test)  loss: 0.2289 -> 0.0699   acc: 93.25% -> 97.26%             
client [64] (test)  loss: 0.2660 -> 0.1272   acc: 92.35% -> 96.47%             
client [77] (test)  loss: 0.0970 -> 0.0226   acc: 98.03% -> 99.15%             
client [55] (test)  loss: 0.1525 -> 0.0127   acc: 95.79% -> 99.71%             
client [12] (test)  loss: 2.1567 -> 0.2904   acc: 25.09% -> 90.61%             
client [89] (test)  loss: 1.2225 -> 0.7804   acc: 61.90% -> 85.71%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4271 -> 0.0217   acc: 83.03% -> 99.54%             
client [51] (test)  loss: 0.5449 -> 0.0183   acc: 81.03% -> 99.49%             
client [8] (test)  loss: 0.6152 -> 0.0054   acc: 80.86% -> 100.00%             
client [18] (test)  loss: 0.1608 -> 0.0069   acc: 94.66% -> 99.76%             
client [94] (test)  loss: 0.3959 -> 0.1499   acc: 89.01% -> 96.10%             
client [81] (test)  loss: 0.6082 -> 0.0549   acc: 80.00% -> 99.09%             
client [3] (test)  loss: 0.4352 -> 0.1508   acc: 84.60% -> 94.93%              
client [11] (test)  loss: 1.0459 -> 0.2619   acc: 63.11% -> 91.11%             
client [95] (test)  loss: 0.3844 -> 0.1139   acc: 90.23% -> 96.24%             
client [67] (test)  loss: 1.2587 -> 0.1372   acc: 48.21% -> 96.58%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6884 -> 0.1591   acc: 73.91% -> 93.48%             
client [79] (test)  loss: 0.8518 -> 0.3951   acc: 64.13% -> 86.49%             
client [58] (test)  loss: 0.1677 -> 0.0687   acc: 95.26% -> 97.26%             
client [88] (test)  loss: 0.8799 -> 0.3590   acc: 67.96% -> 85.08%             
client [46] (test)  loss: 1.8393 -> 0.2784   acc: 31.72% -> 90.75%             
client [11] (test)  loss: 0.8719 -> 0.2655   acc: 67.56% -> 90.67%             
client [55] (test)  loss: 0.0751 -> 0.0111   acc: 98.28% -> 99.71%             
client [13] (test)  loss: 0.3997 -> 0.0040   acc: 89.62% -> 100.00%            
client [31] (test)  loss: 0.4812 -> 0.1179   acc: 83.33% -> 95.00%             
client [75] (test)  loss: 0.7761 -> 0.2361   acc: 72.40% -> 91.28%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4780 -> 0.2457   acc: 83.46% -> 89.76%             
client [7] (test)  loss: 0.3685 -> 0.0398   acc: 87.48% -> 98.34%              
client [57] (test)  loss: 0.6321 -> 0.0227   acc: 72.74% -> 99.62%             
client [13] (test)  loss: 0.7280 -> 0.0046   acc: 69.40% -> 100.00%            
client [43] (test)  loss: 0.9628 -> 0.1203   acc: 62.22% -> 95.56%             
client [91] (test)  loss: 0.4549 -> 0.0319   acc: 81.25% -> 100.00%            
client [10] (test)  loss: 0.1274 -> 0.0464   acc: 96.38% -> 97.83%             
client [64] (test)  loss: 0.4176 -> 0.1326   acc: 84.12% -> 96.18%             
client [82] (test)  loss: 0.6125 -> 0.0217   acc: 74.04% -> 99.68%             
client [22] (test)  loss: 0.8484 -> 0.1000   acc: 66.04% -> 96.70%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6391 -> 0.0108   acc: 73.50% -> 99.67%             
client [23] (test)  loss: 0.6843 -> 0.0796   acc: 70.68% -> 98.50%             
client [88] (test)  loss: 0.7203 -> 0.3552   acc: 70.17% -> 85.08%             
client [98] (test)  loss: 0.6977 -> 0.2696   acc: 78.00% -> 88.00%             
client [79] (test)  loss: 0.9438 -> 0.3528   acc: 61.18% -> 87.71%             
client [21] (test)  loss: 0.2600 -> 0.1547   acc: 89.37% -> 93.48%             
client [92] (test)  loss: 0.1947 -> 0.1159   acc: 95.55% -> 95.21%             
client [56] (test)  loss: 1.4963 -> 0.2987   acc: 36.99% -> 91.06%             
client [5] (test)  loss: 0.7221 -> 0.0501   acc: 73.36% -> 98.91%              
client [52] (test)  loss: 0.4058 -> 0.2265   acc: 86.05% -> 90.70%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.6918 -> 0.0000', 'accuracy': '73.93% -> 0.00%'},          
    200: {'loss': '0.6459 -> 0.0000', 'accuracy': '75.97% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(11.19%) at epoch: 0                                     
FedProx achieved 30.0%(33.11%) at epoch: 4                                     
FedProx achieved 50.0%(51.92%) at epoch: 11                                    
FedProx achieved 70.0%(74.96%) at epoch: 13                                    
FedProx achieved 80.0%(80.34%) at epoch: 51                                    
FedProx achieved 90.0%(90.27%) at epoch: 176                                   
Convergence (test_after):                                                      
FedProx achieved 70.0%(77.45%) at epoch: 0                                     
FedProx achieved 90.0%(91.14%) at epoch: 2                                     
