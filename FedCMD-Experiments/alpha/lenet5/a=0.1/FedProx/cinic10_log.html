==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.3768 -> 1.1342   acc: 74.11% -> 63.12%             
client [81] (test)  loss: 2.2567 -> 0.2055   acc: 2.84% -> 94.61%              
client [21] (test)  loss: 37.0921 -> 1.8122   acc: 34.90% -> 40.54%            
client [68] (test)  loss: 2.6817 -> 0.5764   acc: 18.16% -> 78.09%             
client [93] (test)  loss: 2.7480 -> 0.6796   acc: 8.92% -> 72.98%              
client [31] (test)  loss: 3.2226 -> 3.0047   acc: 0.00% -> 40.74%              
client [20] (test)  loss: 1.4327 -> 0.9156   acc: 36.47% -> 70.35%             
client [59] (test)  loss: 55.0879 -> 1.2878   acc: 1.47% -> 47.70%             
client [48] (test)  loss: 2.8169 -> 1.5615   acc: 0.00% -> 59.26%              
client [34] (test)  loss: 2.3370 -> 0.0481   acc: 25.21% -> 99.18%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.4481 -> 1.4478   acc: 3.45% -> 50.57%              
client [99] (test)  loss: 3.0702 -> 0.3111   acc: 0.23% -> 89.75%              
client [67] (test)  loss: 1.8810 -> 0.7200   acc: 21.78% -> 73.53%             
client [0] (test)  loss: 2.3065 -> 0.5156   acc: 5.43% -> 83.05%               
client [76] (test)  loss: 2.0502 -> 1.1945   acc: 30.93% -> 57.82%             
client [41] (test)  loss: 2.1857 -> 1.7730   acc: 30.36% -> 29.55%             
client [62] (test)  loss: 56.9652 -> 0.5295   acc: 0.05% -> 81.36%             
client [2] (test)  loss: 50.3583 -> 1.0187   acc: 0.00% -> 86.67%              
client [14] (test)  loss: 2.0856 -> 2.1730   acc: 16.15% -> 34.67%             
client [46] (test)  loss: 1.6978 -> 0.0182   acc: 49.02% -> 99.78%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.5195 -> 0.7579   acc: 43.69% -> 58.56%             
client [68] (test)  loss: 3.4027 -> 0.5461   acc: 6.45% -> 79.01%              
client [57] (test)  loss: 2.0628 -> 0.6715   acc: 50.00% -> 85.00%             
client [17] (test)  loss: 2.9827 -> 0.5647   acc: 1.76% -> 84.74%              
client [54] (test)  loss: 2.4116 -> 1.1502   acc: 16.65% -> 19.12%             
client [23] (test)  loss: 47.8860 -> 0.0947   acc: 20.72% -> 97.57%            
client [35] (test)  loss: 1.8926 -> 0.8393   acc: 36.79% -> 70.32%             
client [59] (test)  loss: 2.1130 -> 1.1559   acc: 33.71% -> 55.23%             
client [31] (test)  loss: 2.7873 -> 1.1135   acc: 0.00% -> 65.43%              
client [9] (test)  loss: 1.8871 -> 0.3708   acc: 31.30% -> 84.48%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.8903 -> 0.9700   acc: 30.73% -> 65.49%             
client [33] (test)  loss: 2.9624 -> 0.0066   acc: 8.36% -> 100.00%             
client [16] (test)  loss: 3.2752 -> 0.8586   acc: 3.25% -> 64.23%              
client [44] (test)  loss: 2.3744 -> 0.9320   acc: 16.56% -> 71.49%             
client [8] (test)  loss: 3.2587 -> 0.2956   acc: 5.09% -> 89.82%               
client [31] (test)  loss: 2.8304 -> 0.8582   acc: 0.00% -> 74.07%              
client [47] (test)  loss: 2.5830 -> 1.2746   acc: 15.08% -> 46.56%             
client [36] (test)  loss: 2.7951 -> 0.7232   acc: 11.61% -> 73.23%             
client [20] (test)  loss: 1.9441 -> 0.3583   acc: 32.30% -> 88.56%             
client [56] (test)  loss: 1.9565 -> 0.8482   acc: 26.43% -> 60.82%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.2720 -> 0.4193   acc: 0.66% -> 87.38%               
client [60] (test)  loss: 2.1785 -> 0.8639   acc: 16.99% -> 68.88%             
client [28] (test)  loss: 3.7366 -> 0.0089   acc: 0.00% -> 100.00%             
client [25] (test)  loss: 2.4559 -> 0.8292   acc: 7.72% -> 73.24%              
client [58] (test)  loss: 1.6168 -> 1.3534   acc: 32.61% -> 53.14%             
client [44] (test)  loss: 1.6300 -> 0.6965   acc: 40.67% -> 76.62%             
client [39] (test)  loss: 3.5220 -> 0.4290   acc: 5.28% -> 85.18%              
client [29] (test)  loss: 2.6765 -> 0.0315   acc: 1.15% -> 99.78%              
client [3] (test)  loss: 2.0181 -> 1.0307   acc: 12.17% -> 58.57%              
client [84] (test)  loss: 2.2788 -> 0.5073   acc: 7.86% -> 85.97%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.9225 -> 0.5087   acc: 23.76% -> 86.44%             
client [84] (test)  loss: 2.4843 -> 0.5314   acc: 6.05% -> 85.85%              
client [10] (test)  loss: 2.4277 -> 0.5768   acc: 10.44% -> 79.67%             
client [36] (test)  loss: 2.9471 -> 1.1566   acc: 9.84% -> 61.61%              
client [65] (test)  loss: 2.4418 -> 0.0081   acc: 19.68% -> 100.00%            
client [81] (test)  loss: 2.8196 -> 0.1224   acc: 3.58% -> 95.98%              
client [79] (test)  loss: 3.6420 -> 0.7282   acc: 6.53% -> 77.05%              
client [42] (test)  loss: 3.7333 -> 1.7547   acc: 20.64% -> 51.60%             
client [11] (test)  loss: 3.2740 -> 0.3408   acc: 0.00% -> 87.23%              
client [96] (test)  loss: 3.5787 -> 0.7714   acc: 12.65% -> 75.43%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.6348 -> 0.2459   acc: 10.06% -> 91.03%              
client [53] (test)  loss: 1.6285 -> 0.2738   acc: 53.86% -> 92.51%             
client [52] (test)  loss: 2.0456 -> 1.4711   acc: 22.54% -> 51.29%             
client [42] (test)  loss: 2.7138 -> 1.4513   acc: 19.57% -> 58.01%             
client [69] (test)  loss: 1.7984 -> 1.2478   acc: 28.74% -> 57.47%             
client [59] (test)  loss: 2.4316 -> 1.1262   acc: 15.59% -> 58.56%             
client [7] (test)  loss: 1.4415 -> 0.0059   acc: 56.41% -> 100.00%             
client [26] (test)  loss: 2.3971 -> 0.6041   acc: 17.02% -> 76.75%             
client [49] (test)  loss: 1.4920 -> 2.1674   acc: 48.53% -> 46.75%             
client [98] (test)  loss: 2.4771 -> 0.5988   acc: 25.38% -> 71.45%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.9779 -> 0.6046   acc: 5.46% -> 70.81%              
client [47] (test)  loss: 2.7207 -> 1.3299   acc: 12.86% -> 51.22%             
client [21] (test)  loss: 2.1591 -> 0.6274   acc: 21.74% -> 78.39%             
client [77] (test)  loss: 1.1682 -> 0.8616   acc: 58.20% -> 74.11%             
client [95] (test)  loss: 2.1051 -> 0.2821   acc: 8.81% -> 92.96%              
client [91] (test)  loss: 1.7203 -> 1.0282   acc: 44.13% -> 63.05%             
client [14] (test)  loss: 1.2735 -> 1.3829   acc: 55.38% -> 51.63%             
client [99] (test)  loss: 2.9781 -> 0.2772   acc: 5.24% -> 89.60%              
client [20] (test)  loss: 2.1548 -> 0.3334   acc: 26.38% -> 89.18%             
client [39] (test)  loss: 2.2616 -> 0.4318   acc: 16.50% -> 84.31%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.7150 -> 1.7440   acc: 23.30% -> 44.50%             
client [62] (test)  loss: 1.8660 -> 0.4562   acc: 36.91% -> 85.04%             
client [71] (test)  loss: 1.9316 -> 1.3090   acc: 40.19% -> 44.75%             
client [97] (test)  loss: 2.8749 -> 0.8090   acc: 5.81% -> 75.48%              
client [30] (test)  loss: 1.2534 -> 1.4335   acc: 69.58% -> 53.48%             
client [88] (test)  loss: 1.8011 -> 0.5137   acc: 27.67% -> 81.71%             
client [60] (test)  loss: 2.3906 -> 0.7949   acc: 18.19% -> 70.42%             
client [82] (test)  loss: 2.2775 -> 0.8524   acc: 32.02% -> 67.12%             
client [91] (test)  loss: 1.2364 -> 0.8628   acc: 59.87% -> 67.54%             
client [57] (test)  loss: 1.0467 -> 0.6274   acc: 75.00% -> 85.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.0000 -> 0.7104   acc: 24.69% -> 79.01%             
client [15] (test)  loss: 0.9123 -> 0.4540   acc: 72.87% -> 87.77%             
client [71] (test)  loss: 1.8155 -> 1.2682   acc: 30.55% -> 45.40%             
client [97] (test)  loss: 3.5475 -> 0.8422   acc: 3.55% -> 73.23%              
client [53] (test)  loss: 2.5439 -> 0.2657   acc: 4.07% -> 92.81%              
client [77] (test)  loss: 1.8483 -> 0.8415   acc: 29.53% -> 75.18%             
client [76] (test)  loss: 3.0295 -> 1.1097   acc: 4.31% -> 57.82%              
client [79] (test)  loss: 1.1643 -> 0.6249   acc: 60.63% -> 81.34%             
client [28] (test)  loss: 2.5958 -> 0.0093   acc: 14.54% -> 100.00%            
client [99] (test)  loss: 2.5172 -> 0.2791   acc: 29.04% -> 89.45%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.1361 -> 0.7908   acc: 3.55% -> 76.45%              
client [86] (test)  loss: 4.3672 -> 0.4253   acc: 2.00% -> 88.00%              
client [34] (test)  loss: 1.6116 -> 0.0454   acc: 41.91% -> 99.32%             
client [73] (test)  loss: 1.6764 -> 0.3120   acc: 41.43% -> 90.60%             
client [5] (test)  loss: 3.9640 -> 0.6366   acc: 2.90% -> 78.61%               
client [96] (test)  loss: 4.1573 -> 0.8284   acc: 11.79% -> 75.17%             
client [22] (test)  loss: 1.5792 -> 0.7539   acc: 46.26% -> 78.14%             
client [60] (test)  loss: 2.1048 -> 0.7430   acc: 23.46% -> 71.91%             
client [66] (test)  loss: 1.8988 -> 1.0884   acc: 36.92% -> 54.44%             
client [83] (test)  loss: 2.1772 -> 0.0077   acc: 14.85% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.6083 -> 1.1297   acc: 40.77% -> 59.30%             
client [65] (test)  loss: 2.2917 -> 0.0077   acc: 32.62% -> 100.00%            
client [95] (test)  loss: 2.3275 -> 0.2804   acc: 12.95% -> 93.02%             
client [17] (test)  loss: 3.6892 -> 0.5230   acc: 4.12% -> 85.18%              
client [8] (test)  loss: 3.5101 -> 0.1738   acc: 2.91% -> 93.82%               
client [35] (test)  loss: 2.2438 -> 0.7679   acc: 18.54% -> 73.10%             
client [98] (test)  loss: 3.8803 -> 0.5849   acc: 4.95% -> 74.24%              
client [53] (test)  loss: 1.7919 -> 0.2532   acc: 45.72% -> 92.75%             
client [43] (test)  loss: 2.8416 -> 0.5945   acc: 8.14% -> 79.66%              
client [64] (test)  loss: 1.9762 -> 1.0778   acc: 33.88% -> 64.86%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.2208 -> 0.5015   acc: 24.16% -> 85.77%             
client [88] (test)  loss: 1.3695 -> 0.5072   acc: 56.92% -> 81.24%             
client [38] (test)  loss: 1.5935 -> 0.1872   acc: 39.57% -> 95.35%             
client [3] (test)  loss: 1.6634 -> 0.8152   acc: 33.22% -> 65.78%              
client [5] (test)  loss: 2.3335 -> 0.5475   acc: 9.90% -> 82.44%               
client [41] (test)  loss: 2.2259 -> 1.7638   acc: 24.19% -> 41.72%             
client [7] (test)  loss: 3.5994 -> 0.0077   acc: 12.79% -> 100.00%             
client [37] (test)  loss: 2.7282 -> 0.2871   acc: 21.34% -> 89.12%             
client [45] (test)  loss: 3.0653 -> 0.6299   acc: 5.59% -> 75.70%              
client [47] (test)  loss: 2.0376 -> 1.0969   acc: 33.48% -> 60.09%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.6445 -> 0.7680   acc: 13.82% -> 71.54%             
client [11] (test)  loss: 3.2297 -> 0.1604   acc: 1.33% -> 95.01%              
client [37] (test)  loss: 1.1822 -> 0.2932   acc: 66.11% -> 89.12%             
client [41] (test)  loss: 3.3588 -> 1.3198   acc: 7.63% -> 51.46%              
client [95] (test)  loss: 2.4109 -> 0.2768   acc: 10.53% -> 92.79%             
client [53] (test)  loss: 1.7590 -> 0.2507   acc: 37.27% -> 92.93%             
client [22] (test)  loss: 1.1348 -> 0.7887   acc: 64.60% -> 77.43%             
client [25] (test)  loss: 2.0200 -> 0.8430   acc: 18.14% -> 78.58%             
client [69] (test)  loss: 1.9232 -> 1.2742   acc: 24.14% -> 62.07%             
client [46] (test)  loss: 1.4011 -> 0.0181   acc: 59.09% -> 99.71%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.7395 -> 1.1261   acc: 33.70% -> 60.31%             
client [69] (test)  loss: 2.3839 -> 1.2773   acc: 19.54% -> 60.92%             
client [82] (test)  loss: 1.7130 -> 0.8844   acc: 46.68% -> 65.05%             
client [45] (test)  loss: 3.5186 -> 0.6751   acc: 2.51% -> 75.70%              
client [7] (test)  loss: 3.2811 -> 0.0079   acc: 14.19% -> 100.00%             
client [50] (test)  loss: 2.7773 -> 0.9729   acc: 30.00% -> 62.00%             
client [35] (test)  loss: 1.9633 -> 0.7704   acc: 34.29% -> 73.20%             
client [24] (test)  loss: 2.1308 -> 0.6842   acc: 42.79% -> 64.86%             
client [15] (test)  loss: 1.2910 -> 0.4054   acc: 52.93% -> 89.63%             
client [58] (test)  loss: 1.7600 -> 1.1305   acc: 34.78% -> 58.40%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.1076 -> 0.8925   acc: 7.41% -> 66.67%              
client [76] (test)  loss: 1.9368 -> 1.2003   acc: 37.13% -> 56.87%             
client [67] (test)  loss: 2.5726 -> 0.4008   acc: 11.34% -> 86.47%             
client [37] (test)  loss: 1.9387 -> 0.2814   acc: 46.03% -> 89.96%             
client [58] (test)  loss: 3.0458 -> 1.0876   acc: 3.64% -> 60.03%              
client [64] (test)  loss: 2.2089 -> 0.9221   acc: 17.76% -> 71.91%             
client [77] (test)  loss: 2.2900 -> 0.7786   acc: 16.26% -> 77.46%             
client [55] (test)  loss: 2.9222 -> 0.3856   acc: 8.21% -> 87.77%              
client [12] (test)  loss: 1.1050 -> 0.8909   acc: 73.11% -> 75.46%             
client [89] (test)  loss: 2.8870 -> 1.0101   acc: 23.05% -> 59.05%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.9281 -> 0.4437   acc: 5.32% -> 86.70%              
client [51] (test)  loss: 2.5032 -> 0.1158   acc: 5.84% -> 96.72%              
client [8] (test)  loss: 3.2298 -> 0.1715   acc: 1.82% -> 94.42%               
client [18] (test)  loss: 3.5543 -> 0.0950   acc: 2.09% -> 97.65%              
client [94] (test)  loss: 3.9915 -> 1.2626   acc: 10.68% -> 58.74%             
client [81] (test)  loss: 4.1423 -> 0.1187   acc: 5.34% -> 96.27%              
client [3] (test)  loss: 2.4068 -> 0.7557   acc: 35.46% -> 67.61%              
client [11] (test)  loss: 3.3691 -> 0.1558   acc: 2.26% -> 94.94%              
client [95] (test)  loss: 3.1976 -> 0.2733   acc: 5.74% -> 92.84%              
client [67] (test)  loss: 1.7553 -> 0.4074   acc: 34.12% -> 86.51%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.3052 -> 0.4858   acc: 28.59% -> 86.98%             
client [79] (test)  loss: 3.9877 -> 0.6246   acc: 10.63% -> 80.22%             
client [58] (test)  loss: 1.2829 -> 1.2988   acc: 48.33% -> 55.54%             
client [88] (test)  loss: 0.8751 -> 0.5731   acc: 65.55% -> 80.04%             
client [46] (test)  loss: 1.1239 -> 0.0174   acc: 69.30% -> 99.71%             
client [11] (test)  loss: 5.2899 -> 0.1474   acc: 0.20% -> 95.41%              
client [55] (test)  loss: 1.8514 -> 0.3686   acc: 33.71% -> 88.06%             
client [13] (test)  loss: 5.7382 -> 0.2484   acc: 18.73% -> 91.96%             
client [31] (test)  loss: 3.9829 -> 0.7421   acc: 6.17% -> 77.78%              
client [75] (test)  loss: 1.5806 -> 1.1261   acc: 42.08% -> 60.56%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.8460 -> 0.6522   acc: 18.66% -> 75.84%             
client [7] (test)  loss: 3.5851 -> 0.0074   acc: 10.90% -> 99.97%              
client [57] (test)  loss: 1.9769 -> 0.4432   acc: 45.00% -> 90.00%             
client [13] (test)  loss: 4.4297 -> 0.2484   acc: 17.98% -> 91.74%             
client [43] (test)  loss: 2.5759 -> 0.4869   acc: 25.05% -> 83.08%             
client [91] (test)  loss: 1.4130 -> 0.8015   acc: 49.92% -> 71.29%             
client [10] (test)  loss: 2.8137 -> 0.5504   acc: 25.18% -> 81.51%             
client [64] (test)  loss: 1.7562 -> 0.8294   acc: 42.82% -> 74.31%             
client [82] (test)  loss: 2.1294 -> 0.8463   acc: 34.95% -> 68.12%             
client [22] (test)  loss: 1.9089 -> 0.6444   acc: 39.92% -> 82.23%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.7949 -> 0.3767   acc: 26.38% -> 88.73%             
client [23] (test)  loss: 2.7200 -> 0.0875   acc: 16.95% -> 97.99%             
client [88] (test)  loss: 1.5983 -> 0.6963   acc: 52.92% -> 75.95%             
client [98] (test)  loss: 3.9638 -> 0.6156   acc: 12.94% -> 74.11%             
client [79] (test)  loss: 2.2965 -> 0.6646   acc: 25.19% -> 78.73%             
client [21] (test)  loss: 1.5149 -> 0.4826   acc: 59.06% -> 87.52%             
client [92] (test)  loss: 1.3701 -> 0.3765   acc: 59.61% -> 90.09%             
client [56] (test)  loss: 2.0867 -> 1.7304   acc: 44.71% -> 42.69%             
client [5] (test)  loss: 1.8835 -> 0.4919   acc: 20.92% -> 83.37%              
client [52] (test)  loss: 3.7611 -> 1.7678   acc: 15.12% -> 44.88%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '2.2269 -> 0.0000', 'accuracy': '26.74% -> 0.00%'},          
    200: {'loss': '2.7119 -> 0.0000', 'accuracy': '24.46% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(18.77%) at epoch: 2                                     
FedProx achieved 20.0%(23.35%) at epoch: 4                                     
FedProx achieved 30.0%(32.51%) at epoch: 22                                    
FedProx achieved 40.0%(42.30%) at epoch: 45                                    
Convergence (test_after):                                                      
FedProx achieved 70.0%(78.81%) at epoch: 0                                     
FedProx achieved 80.0%(83.68%) at epoch: 5                                     
FedProx achieved 90.0%(94.53%) at epoch: 40                                    
