==================== ALGORITHM: FedProx ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0999 -> 0.3754   acc: 5.08% -> 83.61%              
client [81] (test)  loss: 2.3861 -> 0.4953   acc: 3.96% -> 91.09%              
client [21] (test)  loss: 25.2878 -> 1.1267   acc: 0.00% -> 63.04%             
client [68] (test)  loss: 1.7565 -> 0.2855   acc: 5.88% -> 93.14%              
client [93] (test)  loss: 2.9265 -> 1.0297   acc: 3.11% -> 56.94%              
client [31] (test)  loss: 1.8909 -> 1.2339   acc: 56.10% -> 40.24%             
client [20] (test)  loss: 2.2684 -> 1.0176   acc: 0.95% -> 69.58%              
client [59] (test)  loss: 30.1356 -> 1.0128   acc: 1.08% -> 67.87%             
client [48] (test)  loss: 2.9272 -> 1.4567   acc: 12.37% -> 42.27%             
client [34] (test)  loss: 2.3452 -> 1.4828   acc: 16.33% -> 38.78%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.4098 -> 0.9268   acc: 2.26% -> 63.28%              
client [99] (test)  loss: 2.6939 -> 0.2307   acc: 0.57% -> 95.26%              
client [67] (test)  loss: 2.5429 -> 0.9566   acc: 9.22% -> 55.34%              
client [0] (test)  loss: 2.0731 -> 0.6700   acc: 12.85% -> 79.25%              
client [76] (test)  loss: 3.8358 -> 0.0463   acc: 0.18% -> 99.28%              
client [41] (test)  loss: 3.4878 -> 0.2896   acc: 0.99% -> 89.11%              
client [62] (test)  loss: 44.5676 -> 1.1058   acc: 14.80% -> 67.20%            
client [2] (test)  loss: 7.3509 -> 0.0093   acc: 65.14% -> 99.96%              
client [14] (test)  loss: 1.8429 -> 0.5007   acc: 8.99% -> 86.96%              
client [46] (test)  loss: 4.2295 -> 0.9800   acc: 2.50% -> 68.33%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.8669 -> 0.2958   acc: 25.10% -> 88.32%             
client [68] (test)  loss: 2.1662 -> 0.1581   acc: 30.39% -> 93.14%             
client [57] (test)  loss: 2.2704 -> 0.4105   acc: 25.79% -> 84.91%             
client [17] (test)  loss: 2.8513 -> 0.1766   acc: 19.46% -> 94.94%             
client [54] (test)  loss: 2.4857 -> 0.2825   acc: 5.67% -> 94.03%              
client [23] (test)  loss: 78.6916 -> 0.4845   acc: 9.92% -> 82.06%             
client [35] (test)  loss: 0.1974 -> 0.0180   acc: 98.18% -> 99.55%             
client [59] (test)  loss: 2.8279 -> 0.6684   acc: 6.50% -> 79.06%              
client [31] (test)  loss: 0.7277 -> 0.5455   acc: 75.61% -> 78.05%             
client [9] (test)  loss: 1.6131 -> 0.7484   acc: 41.08% -> 73.57%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.8835 -> 0.5444   acc: 32.93% -> 80.97%             
client [33] (test)  loss: 1.0517 -> 0.0585   acc: 61.69% -> 98.31%             
client [16] (test)  loss: 1.5523 -> 0.1789   acc: 50.81% -> 94.05%             
client [44] (test)  loss: 2.1679 -> 0.6101   acc: 49.17% -> 78.10%             
client [8] (test)  loss: 3.1461 -> 0.3426   acc: 5.77% -> 86.54%               
client [31] (test)  loss: 0.9726 -> 0.4109   acc: 62.20% -> 86.59%             
client [47] (test)  loss: 0.4122 -> 0.0084   acc: 88.38% -> 99.84%             
client [36] (test)  loss: 1.1933 -> 0.8479   acc: 66.67% -> 83.33%             
client [20] (test)  loss: 1.8838 -> 0.5440   acc: 16.54% -> 80.99%             
client [56] (test)  loss: 2.0695 -> 0.0274   acc: 37.33% -> 99.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.1359 -> 0.0535   acc: 10.37% -> 98.78%              
client [60] (test)  loss: 2.7894 -> 0.0097   acc: 5.66% -> 100.00%             
client [28] (test)  loss: 0.6187 -> 0.2003   acc: 81.89% -> 93.36%             
client [25] (test)  loss: 1.7159 -> 0.0712   acc: 55.46% -> 98.32%             
client [58] (test)  loss: 1.6667 -> 0.3139   acc: 41.34% -> 88.71%             
client [44] (test)  loss: 1.7515 -> 0.6309   acc: 37.60% -> 79.34%             
client [39] (test)  loss: 2.8806 -> 0.3203   acc: 19.12% -> 88.24%             
client [29] (test)  loss: 1.2693 -> 0.0877   acc: 60.19% -> 97.47%             
client [3] (test)  loss: 1.9420 -> 0.3892   acc: 33.27% -> 86.16%              
client [84] (test)  loss: 1.5073 -> 1.1823   acc: 44.68% -> 62.93%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.5666 -> 0.8095   acc: 35.87% -> 69.57%             
client [84] (test)  loss: 1.2996 -> 1.3418   acc: 55.32% -> 58.37%             
client [10] (test)  loss: 0.4488 -> 0.0715   acc: 86.23% -> 97.56%             
client [36] (test)  loss: 0.9341 -> 0.5196   acc: 79.17% -> 87.50%             
client [65] (test)  loss: 0.3301 -> 0.0164   acc: 90.25% -> 99.52%             
client [81] (test)  loss: 2.2632 -> 0.2068   acc: 13.86% -> 93.07%             
client [79] (test)  loss: 2.4314 -> 0.1761   acc: 27.58% -> 94.54%             
client [42] (test)  loss: 1.3428 -> 0.5250   acc: 46.10% -> 79.32%             
client [11] (test)  loss: 0.9372 -> 0.5240   acc: 72.32% -> 85.31%             
client [96] (test)  loss: 1.0358 -> 0.1881   acc: 67.88% -> 94.16%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.2234 -> 0.2061   acc: 50.00% -> 92.31%              
client [53] (test)  loss: 0.7597 -> 0.1651   acc: 74.75% -> 95.56%             
client [52] (test)  loss: 1.0700 -> 0.1514   acc: 68.76% -> 95.18%             
client [42] (test)  loss: 1.1123 -> 0.4737   acc: 58.98% -> 82.03%             
client [69] (test)  loss: 1.0389 -> 0.4720   acc: 64.69% -> 84.75%             
client [59] (test)  loss: 1.7362 -> 0.4994   acc: 35.38% -> 83.21%             
client [7] (test)  loss: 0.7211 -> 0.0167   acc: 79.84% -> 99.36%              
client [26] (test)  loss: 0.6190 -> 0.1463   acc: 81.54% -> 95.69%             
client [49] (test)  loss: 1.3699 -> 0.1545   acc: 55.11% -> 96.01%             
client [98] (test)  loss: 0.8731 -> 0.2409   acc: 73.84% -> 93.02%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8781 -> 0.2437   acc: 73.64% -> 93.41%             
client [47] (test)  loss: 0.7618 -> 0.0136   acc: 75.63% -> 99.76%             
client [21] (test)  loss: 0.9852 -> 0.5413   acc: 65.22% -> 80.43%             
client [77] (test)  loss: 1.6080 -> 0.1930   acc: 44.10% -> 93.77%             
client [95] (test)  loss: 1.4623 -> 0.3274   acc: 53.85% -> 90.50%             
client [91] (test)  loss: 1.0605 -> 0.4497   acc: 64.23% -> 86.95%             
client [14] (test)  loss: 0.7933 -> 0.2294   acc: 76.23% -> 95.65%             
client [99] (test)  loss: 1.4275 -> 0.0832   acc: 50.43% -> 97.56%             
client [20] (test)  loss: 1.5242 -> 0.5042   acc: 48.86% -> 81.94%             
client [39] (test)  loss: 1.9306 -> 0.2871   acc: 43.38% -> 88.97%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1671 -> 0.1846   acc: 66.44% -> 93.98%             
client [62] (test)  loss: 0.8643 -> 0.4185   acc: 72.40% -> 87.20%             
client [71] (test)  loss: 0.6001 -> 0.5409   acc: 77.22% -> 80.18%             
client [97] (test)  loss: 0.4158 -> 0.0026   acc: 88.26% -> 99.89%             
client [30] (test)  loss: 0.8456 -> 0.0979   acc: 72.09% -> 98.45%             
client [88] (test)  loss: 0.6634 -> 0.0528   acc: 75.17% -> 98.63%             
client [60] (test)  loss: 1.6195 -> 0.0059   acc: 52.83% -> 100.00%            
client [82] (test)  loss: 1.9350 -> 0.7409   acc: 43.90% -> 80.49%             
client [91] (test)  loss: 0.5343 -> 0.4529   acc: 84.33% -> 87.21%             
client [57] (test)  loss: 0.8745 -> 0.3647   acc: 69.25% -> 87.77%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2447 -> 0.3473   acc: 56.10% -> 91.46%             
client [15] (test)  loss: 1.8533 -> 0.1732   acc: 42.02% -> 93.80%             
client [71] (test)  loss: 1.1460 -> 0.4658   acc: 61.28% -> 82.69%             
client [97] (test)  loss: 0.4024 -> 0.0031   acc: 86.91% -> 99.89%             
client [53] (test)  loss: 0.5243 -> 0.1536   acc: 83.84% -> 95.96%             
client [77] (test)  loss: 1.2109 -> 0.1910   acc: 58.85% -> 94.10%             
client [76] (test)  loss: 1.7901 -> 0.0346   acc: 43.42% -> 99.46%             
client [79] (test)  loss: 2.4120 -> 0.1529   acc: 32.67% -> 95.32%             
client [28] (test)  loss: 1.3217 -> 0.1837   acc: 57.14% -> 93.76%             
client [99] (test)  loss: 1.6519 -> 0.0757   acc: 48.42% -> 97.99%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.4652 -> 0.0048   acc: 57.11% -> 99.89%             
client [86] (test)  loss: 0.8088 -> 0.2787   acc: 76.07% -> 89.67%             
client [34] (test)  loss: 1.0914 -> 0.9170   acc: 65.31% -> 73.47%             
client [73] (test)  loss: 1.1756 -> 0.0343   acc: 66.18% -> 99.26%             
client [5] (test)  loss: 1.6476 -> 0.2392   acc: 45.57% -> 91.77%              
client [96] (test)  loss: 1.8577 -> 0.2345   acc: 37.23% -> 95.62%             
client [22] (test)  loss: 1.0748 -> 0.4116   acc: 58.11% -> 91.89%             
client [60] (test)  loss: 1.7987 -> 0.0032   acc: 45.28% -> 100.00%            
client [66] (test)  loss: 1.2919 -> 0.3578   acc: 59.04% -> 90.44%             
client [83] (test)  loss: 1.4773 -> 0.3658   acc: 55.00% -> 87.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.3035 -> 0.0391   acc: 54.95% -> 99.46%             
client [65] (test)  loss: 0.6954 -> 0.0200   acc: 79.89% -> 99.45%             
client [95] (test)  loss: 1.0149 -> 0.3455   acc: 70.59% -> 92.31%             
client [17] (test)  loss: 1.2197 -> 0.1103   acc: 64.20% -> 97.28%             
client [8] (test)  loss: 0.6753 -> 0.1298   acc: 73.08% -> 96.15%              
client [35] (test)  loss: 0.6075 -> 0.0146   acc: 78.82% -> 99.55%             
client [98] (test)  loss: 0.8929 -> 0.2431   acc: 74.03% -> 93.41%             
client [53] (test)  loss: 0.9642 -> 0.1527   acc: 68.28% -> 96.16%             
client [43] (test)  loss: 0.5514 -> 0.1358   acc: 84.25% -> 95.05%             
client [64] (test)  loss: 0.9493 -> 0.3968   acc: 71.60% -> 87.61%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.0459 -> 0.4834   acc: 66.30% -> 82.61%             
client [88] (test)  loss: 1.7400 -> 0.0595   acc: 45.13% -> 98.63%             
client [38] (test)  loss: 0.2414 -> 0.0050   acc: 92.63% -> 99.86%             
client [3] (test)  loss: 0.9762 -> 0.2806   acc: 70.75% -> 93.17%              
client [5] (test)  loss: 1.5182 -> 0.2441   acc: 51.27% -> 91.77%              
client [41] (test)  loss: 0.2233 -> 0.1097   acc: 93.07% -> 96.24%             
client [7] (test)  loss: 0.8386 -> 0.0278   acc: 77.28% -> 99.36%              
client [37] (test)  loss: 1.7096 -> 0.0193   acc: 41.83% -> 99.40%             
client [45] (test)  loss: 1.0565 -> 0.0706   acc: 61.02% -> 97.46%             
client [47] (test)  loss: 0.3478 -> 0.0194   acc: 89.27% -> 99.68%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8271 -> 0.1698   acc: 76.76% -> 95.14%             
client [11] (test)  loss: 1.9750 -> 0.4790   acc: 42.37% -> 88.14%             
client [37] (test)  loss: 1.0447 -> 0.0186   acc: 66.23% -> 99.40%             
client [41] (test)  loss: 0.2578 -> 0.1097   acc: 92.67% -> 96.04%             
client [95] (test)  loss: 1.5999 -> 0.3074   acc: 52.04% -> 91.40%             
client [53] (test)  loss: 0.5749 -> 0.1428   acc: 82.83% -> 96.16%             
client [22] (test)  loss: 0.7669 -> 0.4303   acc: 71.62% -> 87.84%             
client [25] (test)  loss: 1.8537 -> 0.0718   acc: 44.54% -> 98.32%             
client [69] (test)  loss: 0.7380 -> 0.4151   acc: 76.84% -> 86.16%             
client [46] (test)  loss: 1.3534 -> 0.4330   acc: 58.33% -> 82.50%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4819 -> 0.0205   acc: 85.79% -> 99.68%             
client [69] (test)  loss: 0.8923 -> 0.3637   acc: 71.75% -> 88.42%             
client [82] (test)  loss: 0.7937 -> 0.6656   acc: 75.61% -> 82.93%             
client [45] (test)  loss: 0.7889 -> 0.0532   acc: 73.31% -> 97.88%             
client [7] (test)  loss: 0.4603 -> 0.0282   acc: 88.64% -> 99.36%              
client [50] (test)  loss: 1.6606 -> 0.1636   acc: 49.02% -> 92.16%             
client [35] (test)  loss: 0.8578 -> 0.0137   acc: 72.09% -> 99.55%             
client [24] (test)  loss: 1.4343 -> 0.2937   acc: 49.93% -> 93.69%             
client [15] (test)  loss: 0.8761 -> 0.1868   acc: 72.89% -> 93.94%             
client [58] (test)  loss: 0.6673 -> 0.2598   acc: 82.19% -> 93.00%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7462 -> 0.6811   acc: 72.16% -> 79.38%             
client [76] (test)  loss: 1.1827 -> 0.0381   acc: 60.18% -> 98.74%             
client [67] (test)  loss: 1.3361 -> 0.3394   acc: 55.83% -> 89.32%             
client [37] (test)  loss: 2.6258 -> 0.0195   acc: 31.85% -> 99.40%             
client [58] (test)  loss: 0.9723 -> 0.2690   acc: 64.55% -> 93.16%             
client [64] (test)  loss: 1.5000 -> 0.3783   acc: 55.59% -> 89.43%             
client [77] (test)  loss: 0.6282 -> 0.1573   acc: 82.79% -> 95.74%             
client [55] (test)  loss: 0.5435 -> 0.0235   acc: 80.72% -> 99.42%             
client [12] (test)  loss: 0.3867 -> 0.0587   acc: 90.62% -> 96.88%             
client [89] (test)  loss: 0.5572 -> 0.0932   acc: 83.57% -> 97.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5671 -> 0.6237   acc: 83.65% -> 82.13%             
client [51] (test)  loss: 1.1204 -> 0.3195   acc: 71.25% -> 94.18%             
client [8] (test)  loss: 0.4661 -> 0.1324   acc: 78.85% -> 96.15%              
client [18] (test)  loss: 0.8734 -> 0.2676   acc: 72.57% -> 91.15%             
client [94] (test)  loss: 0.9498 -> 0.1328   acc: 73.87% -> 96.93%             
client [81] (test)  loss: 1.5684 -> 0.2121   acc: 50.50% -> 92.08%             
client [3] (test)  loss: 0.7239 -> 0.2714   acc: 78.63% -> 93.35%              
client [11] (test)  loss: 0.6477 -> 0.4518   acc: 83.62% -> 89.83%             
client [95] (test)  loss: 0.8118 -> 0.3279   acc: 82.35% -> 92.31%             
client [67] (test)  loss: 1.5862 -> 0.3399   acc: 51.13% -> 88.51%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.5349 -> 0.4126   acc: 50.00% -> 88.04%             
client [79] (test)  loss: 2.1562 -> 0.1355   acc: 42.99% -> 96.52%             
client [58] (test)  loss: 1.2673 -> 0.2846   acc: 64.86% -> 92.85%             
client [88] (test)  loss: 1.5701 -> 0.0689   acc: 51.58% -> 98.63%             
client [46] (test)  loss: 1.6953 -> 0.4418   acc: 53.33% -> 84.17%             
client [11] (test)  loss: 1.6805 -> 0.4713   acc: 52.54% -> 87.01%             
client [55] (test)  loss: 1.3060 -> 0.0334   acc: 59.71% -> 99.28%             
client [13] (test)  loss: 1.0326 -> 0.1682   acc: 72.66% -> 95.24%             
client [31] (test)  loss: 1.1407 -> 0.5106   acc: 67.07% -> 91.46%             
client [75] (test)  loss: 1.3625 -> 0.3572   acc: 65.65% -> 90.03%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7074 -> 0.1545   acc: 73.05% -> 93.62%             
client [7] (test)  loss: 0.7151 -> 0.0374   acc: 80.80% -> 99.36%              
client [57] (test)  loss: 0.7181 -> 0.3239   acc: 77.46% -> 89.49%             
client [13] (test)  loss: 0.6758 -> 0.1512   acc: 78.31% -> 96.30%             
client [43] (test)  loss: 0.4670 -> 0.1095   acc: 84.80% -> 96.34%             
client [91] (test)  loss: 0.8858 -> 0.3885   acc: 71.28% -> 90.34%             
client [10] (test)  loss: 0.3947 -> 0.0750   acc: 89.53% -> 97.99%             
client [64] (test)  loss: 0.9241 -> 0.3783   acc: 75.23% -> 90.03%             
client [82] (test)  loss: 1.4401 -> 0.7314   acc: 68.29% -> 80.49%             
client [22] (test)  loss: 0.3272 -> 0.4182   acc: 87.84% -> 86.49%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1587 -> 0.3486   acc: 63.88% -> 90.49%             
client [23] (test)  loss: 1.5463 -> 0.1883   acc: 54.20% -> 93.13%             
client [88] (test)  loss: 2.1829 -> 0.0682   acc: 37.59% -> 98.49%             
client [98] (test)  loss: 0.9464 -> 0.2557   acc: 74.03% -> 94.38%             
client [79] (test)  loss: 0.4653 -> 0.1352   acc: 85.79% -> 96.64%             
client [21] (test)  loss: 0.8132 -> 0.4650   acc: 76.09% -> 88.04%             
client [92] (test)  loss: 0.7801 -> 0.2628   acc: 73.45% -> 91.49%             
client [56] (test)  loss: 1.0591 -> 0.0162   acc: 70.10% -> 99.81%             
client [5] (test)  loss: 1.2537 -> 0.2306   acc: 65.19% -> 94.30%              
client [52] (test)  loss: 0.9030 -> 0.2190   acc: 75.47% -> 93.29%             
==================== FedProx TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '1.1862 -> 0.0000', 'accuracy': '63.19% -> 0.00%'},          
    200: {'loss': '1.0042 -> 0.0000', 'accuracy': '70.89% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx achieved 10.0%(10.14%) at epoch: 0                                     
FedProx achieved 20.0%(24.84%) at epoch: 5                                     
FedProx achieved 40.0%(41.32%) at epoch: 11                                    
FedProx achieved 60.0%(62.64%) at epoch: 18                                    
FedProx achieved 70.0%(71.58%) at epoch: 72                                    
Convergence (test_after):                                                      
FedProx achieved 80.0%(82.82%) at epoch: 0                                     
FedProx achieved 90.0%(90.89%) at epoch: 16                                    
