==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7032 -> 1.5569   acc: 47.47% -> 47.47%             
client [81] (test)  loss: 0.7969 -> 0.7380   acc: 82.41% -> 82.41%             
client [21] (test)  loss: 2.4014 -> 1.0419   acc: 3.55% -> 64.76%              
client [68] (test)  loss: 1.3741 -> 1.0607   acc: 71.62% -> 70.96%             
client [93] (test)  loss: 1.2072 -> 0.7306   acc: 86.75% -> 86.75%             
client [31] (test)  loss: 1.8220 -> 0.8344   acc: 84.42% -> 84.42%             
client [20] (test)  loss: 0.7866 -> 0.6884   acc: 73.19% -> 73.19%             
client [59] (test)  loss: 2.2509 -> 0.5546   acc: 24.04% -> 82.05%             
client [48] (test)  loss: 0.5635 -> 0.4576   acc: 79.86% -> 93.17%             
client [34] (test)  loss: 1.1125 -> 0.9144   acc: 56.22% -> 58.80%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.1614 -> 0.0748   acc: 97.39% -> 97.39%             
client [99] (test)  loss: 1.1788 -> 0.9052   acc: 65.74% -> 65.74%             
client [67] (test)  loss: 2.1308 -> 1.9368   acc: 48.28% -> 48.28%             
client [0] (test)  loss: 0.3327 -> 0.2258   acc: 87.45% -> 87.45%              
client [76] (test)  loss: 1.2056 -> 1.0650   acc: 52.20% -> 51.57%             
client [41] (test)  loss: 0.9607 -> 0.3058   acc: 98.31% -> 98.31%             
client [62] (test)  loss: 2.2412 -> 0.9317   acc: 40.00% -> 59.67%             
client [2] (test)  loss: 2.2914 -> 0.3632   acc: 7.34% -> 87.97%               
client [14] (test)  loss: 1.1770 -> 1.0818   acc: 68.00% -> 73.60%             
client [46] (test)  loss: 0.5549 -> 0.4665   acc: 79.17% -> 82.64%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5342 -> 0.3739   acc: 85.00% -> 91.00%             
client [68] (test)  loss: 0.8802 -> 0.7952   acc: 68.98% -> 76.57%             
client [57] (test)  loss: 0.7264 -> 0.6302   acc: 79.79% -> 87.23%             
client [17] (test)  loss: 0.4410 -> 0.3670   acc: 87.02% -> 87.02%             
client [54] (test)  loss: 0.1446 -> 0.1344   acc: 95.01% -> 96.05%             
client [23] (test)  loss: 2.4950 -> 1.3840   acc: 8.54% -> 73.17%              
client [35] (test)  loss: 1.2712 -> 1.1625   acc: 51.79% -> 66.07%             
client [59] (test)  loss: 0.4579 -> 0.3795   acc: 82.37% -> 86.86%             
client [31] (test)  loss: 0.6326 -> 0.6159   acc: 84.42% -> 84.42%             
client [9] (test)  loss: 0.0405 -> 0.0361   acc: 99.26% -> 99.26%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2321 -> 0.2175   acc: 94.13% -> 94.13%             
client [33] (test)  loss: 0.9224 -> 0.8045   acc: 60.58% -> 66.83%             
client [16] (test)  loss: 1.0422 -> 1.0149   acc: 68.63% -> 68.63%             
client [44] (test)  loss: 0.4764 -> 0.1962   acc: 90.47% -> 90.47%             
client [8] (test)  loss: 0.8323 -> 0.7926   acc: 73.15% -> 73.15%              
client [31] (test)  loss: 0.6154 -> 0.5987   acc: 84.42% -> 84.42%             
client [47] (test)  loss: 1.0103 -> 0.9420   acc: 64.91% -> 66.08%             
client [36] (test)  loss: 0.7764 -> 0.4064   acc: 88.08% -> 89.40%             
client [20] (test)  loss: 0.3951 -> 0.3546   acc: 87.68% -> 90.58%             
client [56] (test)  loss: 1.3465 -> 1.0060   acc: 55.81% -> 55.81%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2100 -> 0.1972   acc: 96.49% -> 97.37%              
client [60] (test)  loss: 0.3798 -> 0.2732   acc: 89.32% -> 91.64%             
client [28] (test)  loss: 0.4105 -> 0.3849   acc: 90.64% -> 90.64%             
client [25] (test)  loss: 0.5194 -> 0.4310   acc: 82.11% -> 84.96%             
client [58] (test)  loss: 0.9896 -> 0.9363   acc: 61.34% -> 65.55%             
client [44] (test)  loss: 0.1957 -> 0.1453   acc: 90.47% -> 93.43%             
client [39] (test)  loss: 1.1984 -> 1.1167   acc: 56.25% -> 56.25%             
client [29] (test)  loss: 0.7798 -> 0.5695   acc: 70.20% -> 70.69%             
client [3] (test)  loss: 0.4213 -> 0.3274   acc: 88.78% -> 95.92%              
client [84] (test)  loss: 0.1078 -> 0.0980   acc: 97.26% -> 97.26%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8632 -> 0.6579   acc: 64.76% -> 75.12%             
client [84] (test)  loss: 0.0898 -> 0.0801   acc: 97.26% -> 97.26%             
client [10] (test)  loss: 0.3515 -> 0.3560   acc: 88.31% -> 84.42%             
client [36] (test)  loss: 0.4041 -> 0.3418   acc: 86.09% -> 89.40%             
client [65] (test)  loss: 0.3962 -> 0.3726   acc: 85.55% -> 88.87%             
client [81] (test)  loss: 0.6305 -> 0.5676   acc: 87.96% -> 87.96%             
client [79] (test)  loss: 0.8153 -> 0.7730   acc: 76.83% -> 77.44%             
client [42] (test)  loss: 0.5557 -> 0.4702   acc: 81.08% -> 84.94%             
client [11] (test)  loss: 0.6743 -> 0.6212   acc: 71.94% -> 72.84%             
client [96] (test)  loss: 0.4513 -> 0.4387   acc: 85.62% -> 85.95%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7046 -> 0.6717   acc: 73.15% -> 75.17%              
client [53] (test)  loss: 0.0458 -> 0.0414   acc: 99.54% -> 99.54%             
client [52] (test)  loss: 0.3204 -> 0.2999   acc: 92.93% -> 93.48%             
client [42] (test)  loss: 0.5188 -> 0.4163   acc: 83.40% -> 88.42%             
client [69] (test)  loss: 0.0369 -> 0.0287   acc: 98.80% -> 99.20%             
client [59] (test)  loss: 0.3239 -> 0.2865   acc: 85.90% -> 88.78%             
client [7] (test)  loss: 0.1451 -> 0.0866   acc: 92.72% -> 98.73%              
client [26] (test)  loss: 0.3226 -> 0.3067   acc: 90.48% -> 90.48%             
client [49] (test)  loss: 0.2359 -> 0.1668   acc: 92.61% -> 94.89%             
client [98] (test)  loss: 0.4999 -> 0.4441   acc: 83.45% -> 81.74%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4640 -> 0.4028   acc: 85.59% -> 83.59%             
client [47] (test)  loss: 0.8743 -> 0.7689   acc: 67.84% -> 73.10%             
client [21] (test)  loss: 0.7353 -> 0.5419   acc: 72.64% -> 80.99%             
client [77] (test)  loss: 1.3055 -> 1.2997   acc: 47.47% -> 47.47%             
client [95] (test)  loss: 0.3370 -> 0.2279   acc: 90.61% -> 90.38%             
client [91] (test)  loss: 0.3493 -> 0.1154   acc: 87.58% -> 97.45%             
client [14] (test)  loss: 0.5509 -> 0.5046   acc: 91.20% -> 89.60%             
client [99] (test)  loss: 0.8275 -> 0.8159   acc: 72.22% -> 73.15%             
client [20] (test)  loss: 0.2705 -> 0.2523   acc: 92.75% -> 92.75%             
client [39] (test)  loss: 0.9910 -> 1.0235   acc: 56.25% -> 56.25%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2945 -> 0.2740   acc: 92.66% -> 92.66%             
client [62] (test)  loss: 0.6419 -> 0.6317   acc: 69.33% -> 72.00%             
client [71] (test)  loss: 0.1840 -> 0.1600   acc: 92.16% -> 94.12%             
client [97] (test)  loss: 0.9472 -> 0.8954   acc: 67.14% -> 72.14%             
client [30] (test)  loss: 0.6837 -> 0.6612   acc: 73.86% -> 72.73%             
client [88] (test)  loss: 0.4959 -> 0.4618   acc: 87.01% -> 88.14%             
client [60] (test)  loss: 0.1978 -> 0.1538   acc: 94.89% -> 95.98%             
client [82] (test)  loss: 0.6604 -> 0.6186   acc: 75.18% -> 77.37%             
client [91] (test)  loss: 0.2110 -> 0.0958   acc: 92.36% -> 97.77%             
client [57] (test)  loss: 0.4064 -> 0.3775   acc: 88.30% -> 88.30%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6119 -> 0.6334   acc: 84.42% -> 84.42%             
client [15] (test)  loss: 0.5065 -> 0.4890   acc: 82.84% -> 84.16%             
client [71] (test)  loss: 0.1508 -> 0.1505   acc: 94.96% -> 94.12%             
client [97] (test)  loss: 0.8826 -> 0.8392   acc: 70.71% -> 73.57%             
client [53] (test)  loss: 0.0416 -> 0.0382   acc: 99.54% -> 99.54%             
client [77] (test)  loss: 1.2499 -> 1.2597   acc: 47.47% -> 47.47%             
client [76] (test)  loss: 0.5370 -> 0.4844   acc: 83.02% -> 84.28%             
client [79] (test)  loss: 0.6600 -> 0.6403   acc: 81.71% -> 79.88%             
client [28] (test)  loss: 0.3342 -> 0.3269   acc: 90.64% -> 90.64%             
client [99] (test)  loss: 0.8237 -> 0.7977   acc: 73.15% -> 75.00%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.8333 -> 0.7969   acc: 74.29% -> 75.71%             
client [86] (test)  loss: 0.8652 -> 0.8610   acc: 69.42% -> 69.42%             
client [34] (test)  loss: 0.2868 -> 0.2769   acc: 93.13% -> 92.70%             
client [73] (test)  loss: 0.2932 -> 0.1097   acc: 87.61% -> 97.35%             
client [5] (test)  loss: 0.8100 -> 0.6352   acc: 72.86% -> 79.90%              
client [96] (test)  loss: 0.2835 -> 0.2784   acc: 90.30% -> 87.96%             
client [22] (test)  loss: 0.4620 -> 0.3509   acc: 84.78% -> 91.30%             
client [60] (test)  loss: 0.3915 -> 0.1183   acc: 88.85% -> 97.52%             
client [66] (test)  loss: 0.0216 -> 0.0054   acc: 99.80% -> 99.86%             
client [83] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4194 -> 0.3962   acc: 87.42% -> 86.79%             
client [65] (test)  loss: 0.3024 -> 0.2619   acc: 90.82% -> 91.99%             
client [95] (test)  loss: 0.1905 -> 0.1455   acc: 92.72% -> 95.07%             
client [17] (test)  loss: 0.2420 -> 0.2389   acc: 93.81% -> 93.51%             
client [8] (test)  loss: 0.6008 -> 0.5706   acc: 76.51% -> 79.87%              
client [35] (test)  loss: 0.7578 -> 0.7174   acc: 76.79% -> 76.79%             
client [98] (test)  loss: 0.3482 -> 0.2973   acc: 89.59% -> 90.58%             
client [53] (test)  loss: 0.0384 -> 0.0351   acc: 99.54% -> 99.54%             
client [43] (test)  loss: 1.0689 -> 0.9326   acc: 57.21% -> 66.81%             
client [64] (test)  loss: 0.1803 -> 0.1626   acc: 94.13% -> 94.29%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5041 -> 0.4513   acc: 80.53% -> 83.00%             
client [88] (test)  loss: 0.2906 -> 0.2769   acc: 90.96% -> 92.09%             
client [38] (test)  loss: 0.5702 -> 0.5415   acc: 79.70% -> 81.68%             
client [3] (test)  loss: 0.1206 -> 0.1107   acc: 96.94% -> 96.94%              
client [5] (test)  loss: 0.6164 -> 0.6100   acc: 80.90% -> 80.40%              
client [41] (test)  loss: 0.1001 -> 0.1052   acc: 98.31% -> 98.31%             
client [7] (test)  loss: 0.3671 -> 0.0475   acc: 85.92% -> 98.89%              
client [37] (test)  loss: 0.2345 -> 0.4244   acc: 94.78% -> 84.63%             
client [45] (test)  loss: 0.2933 -> 0.2768   acc: 87.84% -> 90.27%             
client [47] (test)  loss: 0.6832 -> 0.6386   acc: 81.87% -> 84.80%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8828 -> 0.8328   acc: 68.63% -> 68.63%             
client [11] (test)  loss: 0.3725 -> 0.3828   acc: 86.27% -> 87.76%             
client [37] (test)  loss: 0.2141 -> 0.4341   acc: 94.08% -> 85.33%             
client [41] (test)  loss: 0.1187 -> 0.1189   acc: 98.31% -> 98.31%             
client [95] (test)  loss: 0.1579 -> 0.1143   acc: 95.31% -> 96.71%             
client [53] (test)  loss: 0.0354 -> 0.0342   acc: 99.54% -> 99.54%             
client [22] (test)  loss: 0.3478 -> 0.3095   acc: 89.13% -> 91.30%             
client [25] (test)  loss: 0.1777 -> 0.1789   acc: 94.72% -> 95.53%             
client [69] (test)  loss: 0.0692 -> 0.0290   acc: 97.99% -> 98.39%             
client [46] (test)  loss: 0.2241 -> 0.2346   acc: 93.72% -> 93.06%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6215 -> 0.5968   acc: 85.96% -> 85.96%             
client [69] (test)  loss: 0.0337 -> 0.0230   acc: 98.39% -> 99.00%             
client [82] (test)  loss: 0.5422 -> 0.5600   acc: 83.21% -> 77.37%             
client [45] (test)  loss: 0.2657 -> 0.2498   acc: 89.67% -> 91.49%             
client [7] (test)  loss: 0.1645 -> 0.0423   acc: 93.67% -> 98.89%              
client [50] (test)  loss: 0.4694 -> 0.4318   acc: 83.01% -> 83.01%             
client [35] (test)  loss: 0.6935 -> 0.6535   acc: 76.79% -> 78.57%             
client [24] (test)  loss: 0.1526 -> 0.1229   acc: 96.33% -> 97.33%             
client [15] (test)  loss: 0.3827 -> 0.4180   acc: 85.48% -> 85.81%             
client [58] (test)  loss: 0.3783 -> 0.3662   acc: 84.87% -> 86.55%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2241 -> 0.1870   acc: 92.83% -> 94.88%             
client [76] (test)  loss: 0.3160 -> 0.3104   acc: 89.31% -> 89.31%             
client [67] (test)  loss: 0.6513 -> 0.6393   acc: 82.76% -> 82.76%             
client [37] (test)  loss: 0.2107 -> 0.3823   acc: 95.49% -> 87.02%             
client [58] (test)  loss: 0.3706 -> 0.3485   acc: 84.87% -> 88.24%             
client [64] (test)  loss: 0.1470 -> 0.1333   acc: 94.60% -> 95.08%             
client [77] (test)  loss: 1.1307 -> 1.1407   acc: 49.37% -> 49.37%             
client [55] (test)  loss: 0.0648 -> 0.0542   acc: 97.13% -> 97.51%             
client [12] (test)  loss: 0.6911 -> 0.6347   acc: 77.65% -> 78.82%             
client [89] (test)  loss: 0.1656 -> 0.1559   acc: 95.94% -> 95.94%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0232 -> 0.0215   acc: 100.00% -> 100.00%           
client [51] (test)  loss: 0.2568 -> 0.2292   acc: 91.08% -> 91.72%             
client [8] (test)  loss: 0.4964 -> 0.4894   acc: 83.89% -> 83.22%              
client [18] (test)  loss: 0.6087 -> 0.6378   acc: 85.92% -> 81.22%             
client [94] (test)  loss: 0.4725 -> 0.4640   acc: 82.93% -> 82.93%             
client [81] (test)  loss: 0.2697 -> 0.2936   acc: 89.81% -> 89.81%             
client [3] (test)  loss: 0.0950 -> 0.0915   acc: 96.94% -> 95.92%              
client [11] (test)  loss: 0.3252 -> 0.3339   acc: 87.76% -> 88.06%             
client [95] (test)  loss: 0.1074 -> 0.0944   acc: 97.42% -> 97.18%             
client [67] (test)  loss: 0.6149 -> 0.5932   acc: 82.76% -> 82.76%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3877 -> 0.4148   acc: 86.71% -> 83.77%             
client [79] (test)  loss: 0.5289 -> 0.5553   acc: 84.15% -> 81.71%             
client [58] (test)  loss: 0.3334 -> 0.3135   acc: 85.71% -> 88.24%             
client [88] (test)  loss: 0.2372 -> 0.2153   acc: 92.66% -> 92.66%             
client [46] (test)  loss: 0.2056 -> 0.2271   acc: 94.53% -> 93.72%             
client [11] (test)  loss: 0.3097 -> 0.3221   acc: 88.36% -> 88.66%             
client [55] (test)  loss: 0.0453 -> 0.0437   acc: 98.09% -> 98.09%             
client [13] (test)  loss: 0.4855 -> 0.4890   acc: 81.48% -> 83.70%             
client [31] (test)  loss: 0.6730 -> 0.6501   acc: 84.42% -> 84.42%             
client [75] (test)  loss: 0.4894 -> 0.5565   acc: 86.79% -> 79.25%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2270 -> 0.2274   acc: 94.43% -> 93.15%             
client [7] (test)  loss: 0.0708 -> 0.0306   acc: 97.78% -> 99.05%              
client [57] (test)  loss: 0.2266 -> 0.2223   acc: 91.49% -> 90.43%             
client [13] (test)  loss: 0.4678 -> 0.4795   acc: 84.44% -> 84.44%             
client [43] (test)  loss: 0.8415 -> 0.7618   acc: 66.81% -> 72.05%             
client [91] (test)  loss: 0.0669 -> 0.0522   acc: 98.41% -> 99.68%             
client [10] (test)  loss: 0.1552 -> 0.1978   acc: 97.40% -> 92.21%             
client [64] (test)  loss: 0.1222 -> 0.1153   acc: 96.35% -> 96.35%             
client [82] (test)  loss: 0.4581 -> 0.5052   acc: 86.86% -> 81.02%             
client [22] (test)  loss: 0.2421 -> 0.2815   acc: 92.03% -> 90.58%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1825 -> 0.1798   acc: 94.20% -> 94.93%             
client [23] (test)  loss: 0.6437 -> 0.5649   acc: 71.95% -> 75.61%             
client [88] (test)  loss: 0.2072 -> 0.1957   acc: 92.66% -> 93.22%             
client [98] (test)  loss: 0.1985 -> 0.1973   acc: 93.72% -> 93.30%             
client [79] (test)  loss: 0.5257 -> 0.5263   acc: 84.76% -> 82.93%             
client [21] (test)  loss: 0.3320 -> 0.3878   acc: 89.49% -> 85.63%             
client [92] (test)  loss: 0.7738 -> 0.7814   acc: 76.19% -> 71.43%             
client [56] (test)  loss: 0.5422 -> 0.4767   acc: 81.40% -> 81.40%             
client [5] (test)  loss: 0.5806 -> 0.5368   acc: 78.39% -> 80.40%              
client [52] (test)  loss: 0.1760 -> 0.1792   acc: 92.66% -> 92.66%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3161 -> 0.0000', 'accuracy': '89.51% -> 0.00%'},          
    200: {'loss': '0.2132 -> 0.0000', 'accuracy': '92.89% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 20.0%(23.85%) at epoch: 1                                      
FedRep achieved 40.0%(46.98%) at epoch: 3                                      
FedRep achieved 50.0%(56.65%) at epoch: 7                                      
FedRep achieved 60.0%(64.04%) at epoch: 11                                     
FedRep achieved 70.0%(73.55%) at epoch: 16                                     
FedRep achieved 80.0%(86.98%) at epoch: 24                                     
FedRep achieved 90.0%(90.17%) at epoch: 36                                     
Convergence (test_after):                                                      
FedRep achieved 60.0%(69.44%) at epoch: 0                                      
FedRep achieved 70.0%(76.96%) at epoch: 1                                      
FedRep achieved 80.0%(89.45%) at epoch: 2                                      
FedRep achieved 90.0%(91.09%) at epoch: 29                                     
