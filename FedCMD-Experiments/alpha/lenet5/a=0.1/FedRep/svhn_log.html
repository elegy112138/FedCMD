==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5661 -> 0.5445   acc: 74.92% -> 74.92%             
client [81] (test)  loss: 0.5178 -> 0.5408   acc: 91.09% -> 91.09%             
client [21] (test)  loss: 64.9480 -> 1.4427   acc: 10.87% -> 48.91%            
client [68] (test)  loss: 0.5741 -> 0.5151   acc: 93.14% -> 93.14%             
client [93] (test)  loss: 1.1745 -> 1.1239   acc: 49.48% -> 49.28%             
client [31] (test)  loss: 2.1418 -> 1.3148   acc: 53.66% -> 41.46%             
client [20] (test)  loss: 1.0808 -> 1.0135   acc: 69.58% -> 69.58%             
client [59] (test)  loss: 89.1327 -> 1.0903   acc: 6.32% -> 63.18%             
client [48] (test)  loss: 1.5392 -> 1.5409   acc: 38.14% -> 38.14%             
client [34] (test)  loss: 2.0237 -> 1.7449   acc: 44.90% -> 36.73%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6331 -> 1.3495   acc: 43.79% -> 43.79%             
client [99] (test)  loss: 0.2566 -> 0.2650   acc: 95.40% -> 95.40%             
client [67] (test)  loss: 1.0310 -> 1.0251   acc: 55.34% -> 56.96%             
client [0] (test)  loss: 1.2333 -> 1.2081   acc: 52.57% -> 52.57%              
client [76] (test)  loss: 0.0560 -> 0.0550   acc: 99.28% -> 99.28%             
client [41] (test)  loss: 0.5118 -> 0.4673   acc: 87.72% -> 87.72%             
client [62] (test)  loss: 9.6935 -> 1.3705   acc: 9.20% -> 51.40%              
client [2] (test)  loss: 1.9063 -> 0.0052   acc: 48.20% -> 99.96%              
client [14] (test)  loss: 0.6131 -> 0.6402   acc: 86.96% -> 86.96%             
client [46] (test)  loss: 1.2786 -> 1.2506   acc: 63.33% -> 63.33%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5417 -> 0.5385   acc: 84.43% -> 84.43%             
client [68] (test)  loss: 0.3772 -> 0.3529   acc: 93.14% -> 93.14%             
client [57] (test)  loss: 0.8289 -> 0.7608   acc: 68.00% -> 69.91%             
client [17] (test)  loss: 0.3837 -> 0.3489   acc: 91.83% -> 91.83%             
client [54] (test)  loss: 0.4028 -> 0.4018   acc: 91.94% -> 91.94%             
client [23] (test)  loss: 29.0939 -> 0.8554   acc: 3.44% -> 73.66%             
client [35] (test)  loss: 0.0427 -> 0.0619   acc: 99.62% -> 99.62%             
client [59] (test)  loss: 1.0763 -> 1.0452   acc: 63.18% -> 63.18%             
client [31] (test)  loss: 0.9883 -> 0.9715   acc: 41.46% -> 48.78%             
client [9] (test)  loss: 1.4068 -> 1.4561   acc: 35.35% -> 41.08%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1625 -> 1.0787   acc: 56.19% -> 62.24%             
client [33] (test)  loss: 0.1255 -> 0.1187   acc: 97.12% -> 97.12%             
client [16] (test)  loss: 0.6327 -> 0.3966   acc: 61.08% -> 85.41%             
client [44] (test)  loss: 1.4840 -> 1.0672   acc: 50.41% -> 58.68%             
client [8] (test)  loss: 0.7141 -> 0.7108   acc: 80.77% -> 80.77%              
client [31] (test)  loss: 0.9402 -> 0.9027   acc: 60.98% -> 63.41%             
client [47] (test)  loss: 0.0000 -> 0.0003   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 1.8491 -> 1.5212   acc: 45.83% -> 50.00%             
client [20] (test)  loss: 1.0298 -> 0.9488   acc: 69.58% -> 69.58%             
client [56] (test)  loss: 0.0346 -> 0.0333   acc: 99.63% -> 99.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0024 -> 0.0038   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.0663 -> 0.0565   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.7075 -> 0.5433   acc: 71.63% -> 76.86%             
client [25] (test)  loss: 0.1027 -> 0.1681   acc: 98.32% -> 98.32%             
client [58] (test)  loss: 0.4777 -> 0.4486   acc: 81.72% -> 84.42%             
client [44] (test)  loss: 1.0455 -> 1.0088   acc: 60.33% -> 69.83%             
client [39] (test)  loss: 0.8423 -> 0.8117   acc: 67.65% -> 68.38%             
client [29] (test)  loss: 0.3168 -> 0.2222   acc: 93.21% -> 93.21%             
client [3] (test)  loss: 0.7634 -> 0.7308   acc: 75.13% -> 72.85%              
client [84] (test)  loss: 1.4916 -> 2.2900   acc: 43.92% -> 25.48%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.1378 -> 0.9524   acc: 55.43% -> 64.13%             
client [84] (test)  loss: 1.4155 -> 2.0778   acc: 51.52% -> 36.12%             
client [10] (test)  loss: 0.1748 -> 0.1372   acc: 94.26% -> 94.26%             
client [36] (test)  loss: 0.9826 -> 0.8545   acc: 75.00% -> 75.00%             
client [65] (test)  loss: 0.0202 -> 0.0204   acc: 99.66% -> 99.66%             
client [81] (test)  loss: 0.4307 -> 0.4084   acc: 91.09% -> 91.09%             
client [79] (test)  loss: 0.2313 -> 0.2143   acc: 92.21% -> 92.75%             
client [42] (test)  loss: 0.7353 -> 0.8502   acc: 78.31% -> 59.32%             
client [11] (test)  loss: 1.0572 -> 1.0219   acc: 67.23% -> 68.93%             
client [96] (test)  loss: 0.2840 -> 0.2411   acc: 95.62% -> 95.62%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6461 -> 0.6463   acc: 80.77% -> 80.77%              
client [53] (test)  loss: 0.2808 -> 0.3686   acc: 93.33% -> 88.08%             
client [52] (test)  loss: 0.3455 -> 0.2222   acc: 89.16% -> 91.39%             
client [42] (test)  loss: 0.6710 -> 0.7442   acc: 80.00% -> 70.85%             
client [69] (test)  loss: 0.9644 -> 1.8643   acc: 62.71% -> 43.79%             
client [59] (test)  loss: 0.8724 -> 0.8871   acc: 71.48% -> 70.04%             
client [7] (test)  loss: 0.0403 -> 0.0304   acc: 99.04% -> 99.04%              
client [26] (test)  loss: 0.2793 -> 0.2827   acc: 93.23% -> 93.23%             
client [49] (test)  loss: 0.4137 -> 0.3586   acc: 87.70% -> 88.02%             
client [98] (test)  loss: 0.5399 -> 0.5785   acc: 86.43% -> 85.66%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4753 -> 0.4651   acc: 86.82% -> 87.02%             
client [47] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%           
client [21] (test)  loss: 0.9145 -> 0.8404   acc: 67.39% -> 71.74%             
client [77] (test)  loss: 0.3125 -> 0.3466   acc: 86.89% -> 84.92%             
client [95] (test)  loss: 0.3931 -> 0.3800   acc: 88.24% -> 86.88%             
client [91] (test)  loss: 0.7917 -> 0.8051   acc: 77.02% -> 77.81%             
client [14] (test)  loss: 0.5657 -> 0.5516   acc: 86.96% -> 86.96%             
client [99] (test)  loss: 0.1973 -> 0.1866   acc: 95.55% -> 95.40%             
client [20] (test)  loss: 0.8522 -> 0.8142   acc: 71.10% -> 71.10%             
client [39] (test)  loss: 0.7346 -> 0.7033   acc: 75.00% -> 75.74%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2103 -> 0.1926   acc: 92.17% -> 92.77%             
client [62] (test)  loss: 0.6814 -> 0.7967   acc: 79.00% -> 75.00%             
client [71] (test)  loss: 0.6734 -> 0.6665   acc: 73.35% -> 74.72%             
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 0.1824 -> 0.1772   acc: 95.35% -> 94.57%             
client [88] (test)  loss: 0.0629 -> 0.0618   acc: 97.53% -> 97.94%             
client [60] (test)  loss: 0.0059 -> 0.0074   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.7507 -> 0.7419   acc: 70.73% -> 70.73%             
client [91] (test)  loss: 0.6952 -> 0.7767   acc: 81.20% -> 77.55%             
client [57] (test)  loss: 0.4821 -> 0.4479   acc: 82.90% -> 84.34%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5826 -> 0.6075   acc: 86.59% -> 84.15%             
client [15] (test)  loss: 0.2482 -> 0.3733   acc: 92.13% -> 85.23%             
client [71] (test)  loss: 0.6322 -> 0.6421   acc: 74.03% -> 76.77%             
client [97] (test)  loss: 0.0001 -> 0.0000   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.2290 -> 0.4297   acc: 94.95% -> 85.25%             
client [77] (test)  loss: 0.3377 -> 0.3255   acc: 84.10% -> 86.07%             
client [76] (test)  loss: 0.0568 -> 0.0426   acc: 99.28% -> 99.28%             
client [79] (test)  loss: 0.1903 -> 0.2221   acc: 94.12% -> 92.99%             
client [28] (test)  loss: 0.2928 -> 0.2756   acc: 90.54% -> 90.74%             
client [99] (test)  loss: 0.1719 -> 0.1731   acc: 95.40% -> 95.26%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 0.3974 -> 0.3722   acc: 86.15% -> 87.66%             
client [34] (test)  loss: 1.1089 -> 1.0985   acc: 67.35% -> 69.39%             
client [73] (test)  loss: 0.0296 -> 0.0279   acc: 99.56% -> 99.56%             
client [5] (test)  loss: 0.4235 -> 0.4034   acc: 84.18% -> 84.81%              
client [96] (test)  loss: 0.2255 -> 0.2202   acc: 95.62% -> 95.62%             
client [22] (test)  loss: 0.7379 -> 0.7359   acc: 78.38% -> 79.73%             
client [60] (test)  loss: 0.0056 -> 0.0051   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.5816 -> 0.5622   acc: 81.91% -> 83.96%             
client [83] (test)  loss: 0.5934 -> 0.6132   acc: 80.00% -> 77.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0417 -> 0.0412   acc: 99.28% -> 99.28%             
client [65] (test)  loss: 0.0167 -> 0.0164   acc: 99.66% -> 99.66%             
client [95] (test)  loss: 0.3462 -> 0.3693   acc: 84.62% -> 85.97%             
client [17] (test)  loss: 0.2871 -> 0.2495   acc: 91.83% -> 91.83%             
client [8] (test)  loss: 0.5807 -> 0.5294   acc: 80.77% -> 80.77%              
client [35] (test)  loss: 0.0545 -> 0.0571   acc: 99.62% -> 99.62%             
client [98] (test)  loss: 0.3737 -> 0.3759   acc: 87.60% -> 88.57%             
client [53] (test)  loss: 0.2356 -> 0.3089   acc: 94.55% -> 90.91%             
client [43] (test)  loss: 0.1822 -> 0.1597   acc: 92.86% -> 93.77%             
client [64] (test)  loss: 0.6396 -> 0.6321   acc: 79.46% -> 80.06%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8248 -> 0.7707   acc: 75.00% -> 75.00%             
client [88] (test)  loss: 0.0484 -> 0.0443   acc: 98.63% -> 98.63%             
client [38] (test)  loss: 0.0007 -> 0.0002   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.4360 -> 0.4214   acc: 84.94% -> 85.81%              
client [5] (test)  loss: 0.3723 -> 0.3652   acc: 85.44% -> 87.34%              
client [41] (test)  loss: 0.2174 -> 0.1966   acc: 91.88% -> 92.48%             
client [7] (test)  loss: 0.0241 -> 0.0202   acc: 99.04% -> 99.36%              
client [37] (test)  loss: 0.0230 -> 0.0215   acc: 99.64% -> 99.64%             
client [45] (test)  loss: 0.2591 -> 0.2236   acc: 93.64% -> 93.64%             
client [47] (test)  loss: 0.0003 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1414 -> 0.1898   acc: 95.68% -> 92.97%             
client [11] (test)  loss: 0.6592 -> 0.6490   acc: 80.23% -> 79.10%             
client [37] (test)  loss: 0.0211 -> 0.0205   acc: 99.64% -> 99.64%             
client [41] (test)  loss: 0.2130 -> 0.1935   acc: 92.67% -> 92.87%             
client [95] (test)  loss: 0.2720 -> 0.4128   acc: 90.50% -> 85.07%             
client [53] (test)  loss: 0.2519 -> 0.2386   acc: 92.73% -> 93.94%             
client [22] (test)  loss: 0.7177 -> 0.6926   acc: 78.38% -> 81.08%             
client [25] (test)  loss: 0.1199 -> 0.1253   acc: 98.32% -> 98.32%             
client [69] (test)  loss: 0.5533 -> 1.5989   acc: 82.77% -> 52.54%             
client [46] (test)  loss: 0.9019 -> 0.8853   acc: 72.50% -> 74.17%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [69] (test)  loss: 0.5435 -> 1.4202   acc: 82.20% -> 55.08%             
client [82] (test)  loss: 0.6772 -> 0.6132   acc: 70.73% -> 73.17%             
client [45] (test)  loss: 0.2035 -> 0.1920   acc: 93.64% -> 94.07%             
client [7] (test)  loss: 0.0188 -> 0.0192   acc: 99.20% -> 99.36%              
client [50] (test)  loss: 0.5142 -> 0.5007   acc: 81.37% -> 81.37%             
client [35] (test)  loss: 0.0532 -> 0.0561   acc: 99.62% -> 99.62%             
client [24] (test)  loss: 0.2150 -> 0.2704   acc: 93.15% -> 89.40%             
client [15] (test)  loss: 0.1905 -> 0.2442   acc: 93.31% -> 92.75%             
client [58] (test)  loss: 0.3146 -> 0.3684   acc: 87.76% -> 86.01%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.9977 -> 0.9492   acc: 58.76% -> 59.79%             
client [76] (test)  loss: 0.0421 -> 0.0389   acc: 99.28% -> 99.28%             
client [67] (test)  loss: 0.3827 -> 0.6362   acc: 86.73% -> 73.30%             
client [37] (test)  loss: 0.0231 -> 0.0196   acc: 99.64% -> 99.64%             
client [58] (test)  loss: 0.3110 -> 0.3277   acc: 88.55% -> 87.44%             
client [64] (test)  loss: 0.5491 -> 0.5070   acc: 82.18% -> 83.69%             
client [77] (test)  loss: 0.2080 -> 0.1900   acc: 93.11% -> 92.13%             
client [55] (test)  loss: 0.0397 -> 0.0364   acc: 98.99% -> 98.99%             
client [12] (test)  loss: 0.4460 -> 0.4386   acc: 93.75% -> 93.75%             
client [89] (test)  loss: 0.1089 -> 0.1429   acc: 97.17% -> 96.47%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.8298 -> 1.9211   acc: 72.24% -> 51.33%             
client [51] (test)  loss: 0.3210 -> 0.3146   acc: 90.12% -> 91.36%             
client [8] (test)  loss: 0.4161 -> 0.4130   acc: 84.62% -> 86.54%              
client [18] (test)  loss: 0.3440 -> 0.3512   acc: 87.46% -> 87.61%             
client [94] (test)  loss: 0.1073 -> 0.1031   acc: 95.91% -> 96.20%             
client [81] (test)  loss: 0.2865 -> 0.2899   acc: 91.09% -> 91.09%             
client [3] (test)  loss: 0.3093 -> 0.3398   acc: 91.07% -> 89.49%              
client [11] (test)  loss: 0.5845 -> 0.5973   acc: 82.49% -> 80.79%             
client [95] (test)  loss: 0.2480 -> 0.3525   acc: 92.31% -> 86.88%             
client [67] (test)  loss: 0.3861 -> 0.6275   acc: 86.08% -> 74.60%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.8859 -> 0.7530   acc: 67.39% -> 72.83%             
client [79] (test)  loss: 0.1642 -> 0.2000   acc: 95.38% -> 93.76%             
client [58] (test)  loss: 0.2824 -> 0.3036   acc: 90.30% -> 87.92%             
client [88] (test)  loss: 0.0354 -> 0.0391   acc: 98.77% -> 98.90%             
client [46] (test)  loss: 0.8156 -> 0.8313   acc: 77.50% -> 75.83%             
client [11] (test)  loss: 0.5597 -> 0.5801   acc: 84.18% -> 81.36%             
client [55] (test)  loss: 0.0326 -> 0.0314   acc: 98.99% -> 98.99%             
client [13] (test)  loss: 0.1921 -> 0.1869   acc: 93.83% -> 93.47%             
client [31] (test)  loss: 0.5265 -> 0.5107   acc: 89.02% -> 87.80%             
client [75] (test)  loss: 0.4287 -> 0.5122   acc: 87.53% -> 83.38%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2585 -> 0.2958   acc: 89.89% -> 89.01%             
client [7] (test)  loss: 0.0120 -> 0.0139   acc: 99.52% -> 99.68%              
client [57] (test)  loss: 0.3272 -> 0.3428   acc: 88.06% -> 87.68%             
client [13] (test)  loss: 0.1823 -> 0.1766   acc: 93.47% -> 94.18%             
client [43] (test)  loss: 0.1314 -> 0.1278   acc: 95.05% -> 93.77%             
client [91] (test)  loss: 0.5184 -> 0.4904   acc: 84.33% -> 85.64%             
client [10] (test)  loss: 0.0619 -> 0.0969   acc: 98.13% -> 96.27%             
client [64] (test)  loss: 0.4883 -> 0.4599   acc: 84.59% -> 84.89%             
client [82] (test)  loss: 0.6571 -> 0.6233   acc: 68.29% -> 73.17%             
client [22] (test)  loss: 0.5961 -> 0.5975   acc: 79.73% -> 77.03%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5846 -> 0.5399   acc: 79.85% -> 79.47%             
client [23] (test)  loss: 0.3652 -> 0.3829   acc: 86.64% -> 86.26%             
client [88] (test)  loss: 0.0373 -> 0.0397   acc: 99.18% -> 99.04%             
client [98] (test)  loss: 0.2834 -> 0.3082   acc: 91.47% -> 91.09%             
client [79] (test)  loss: 0.1892 -> 0.1741   acc: 94.12% -> 94.84%             
client [21] (test)  loss: 0.8139 -> 0.6996   acc: 69.57% -> 72.83%             
client [92] (test)  loss: 0.4011 -> 0.4054   acc: 86.34% -> 86.86%             
client [56] (test)  loss: 0.0217 -> 0.0199   acc: 99.63% -> 99.63%             
client [5] (test)  loss: 0.3371 -> 0.2977   acc: 89.24% -> 89.24%              
client [52] (test)  loss: 0.1538 -> 0.1568   acc: 94.75% -> 94.66%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.3050 -> 0.0000', 'accuracy': '89.69% -> 0.00%'},          
    200: {'loss': '0.2249 -> 0.0000', 'accuracy': '92.59% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(10.14%) at epoch: 0                                      
FedRep achieved 20.0%(27.25%) at epoch: 1                                      
FedRep achieved 30.0%(36.18%) at epoch: 3                                      
FedRep achieved 60.0%(65.19%) at epoch: 4                                      
FedRep achieved 80.0%(80.74%) at epoch: 7                                      
FedRep achieved 90.0%(91.25%) at epoch: 46                                     
Convergence (test_after):                                                      
FedRep achieved 80.0%(81.86%) at epoch: 0                                      
FedRep achieved 90.0%(90.92%) at epoch: 7                                      
