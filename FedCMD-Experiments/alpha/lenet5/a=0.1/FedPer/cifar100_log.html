==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.8059 -> 2.7046   acc: 38.56% -> 30.72%             
client [81] (test)  loss: 3.2076 -> 2.7345   acc: 21.84% -> 29.43%             
client [21] (test)  loss: 48.4910 -> 2.5475   acc: 15.27% -> 29.39%            
client [68] (test)  loss: 2.4372 -> 2.2064   acc: 31.95% -> 36.74%             
client [93] (test)  loss: 3.0616 -> 3.0731   acc: 15.31% -> 18.37%             
client [31] (test)  loss: 3.9661 -> 2.6560   acc: 18.01% -> 22.19%             
client [20] (test)  loss: 1.7403 -> 1.5699   acc: 34.54% -> 51.64%             
client [59] (test)  loss: 78.8985 -> 2.4252   acc: 0.00% -> 39.35%             
client [48] (test)  loss: 3.2859 -> 2.9976   acc: 14.71% -> 21.90%             
client [34] (test)  loss: 3.0363 -> 2.8269   acc: 15.56% -> 13.58%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.2837 -> 1.7074   acc: 38.53% -> 57.79%             
client [99] (test)  loss: 3.3844 -> 3.2418   acc: 15.61% -> 19.11%             
client [67] (test)  loss: 2.5577 -> 2.2036   acc: 28.53% -> 37.93%             
client [0] (test)  loss: 2.9308 -> 2.6966   acc: 20.27% -> 29.73%              
client [76] (test)  loss: 2.8225 -> 2.5234   acc: 24.58% -> 36.54%             
client [41] (test)  loss: 2.9631 -> 2.7963   acc: 20.67% -> 21.67%             
client [62] (test)  loss: 92.2917 -> 2.6833   acc: 0.00% -> 28.52%             
client [2] (test)  loss: 84.7195 -> 2.9749   acc: 3.08% -> 24.62%              
client [14] (test)  loss: 2.9465 -> 2.9324   acc: 27.06% -> 29.41%             
client [46] (test)  loss: 2.5547 -> 2.3418   acc: 35.60% -> 41.20%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.6164 -> 2.6186   acc: 27.00% -> 27.76%             
client [68] (test)  loss: 2.2432 -> 1.9471   acc: 34.82% -> 45.69%             
client [57] (test)  loss: 3.0007 -> 2.3740   acc: 21.12% -> 38.61%             
client [17] (test)  loss: 3.4781 -> 2.4010   acc: 9.21% -> 32.06%              
client [54] (test)  loss: 2.5224 -> 2.6592   acc: 34.78% -> 27.72%             
client [23] (test)  loss: 161.6704 -> 2.7829   acc: 2.73% -> 23.83%            
client [35] (test)  loss: 3.2153 -> 1.9397   acc: 20.33% -> 47.33%             
client [59] (test)  loss: 2.2879 -> 1.9888   acc: 32.90% -> 43.55%             
client [31] (test)  loss: 2.2819 -> 2.3826   acc: 36.33% -> 31.19%             
client [9] (test)  loss: 2.8310 -> 2.5595   acc: 27.79% -> 26.59%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.8929 -> 2.3595   acc: 32.49% -> 40.34%             
client [33] (test)  loss: 2.9599 -> 2.5932   acc: 33.58% -> 34.70%             
client [16] (test)  loss: 2.7472 -> 2.5654   acc: 25.07% -> 27.32%             
client [44] (test)  loss: 3.2997 -> 2.6566   acc: 14.38% -> 17.97%             
client [8] (test)  loss: 2.6814 -> 2.3034   acc: 31.09% -> 40.06%              
client [31] (test)  loss: 2.4328 -> 2.2634   acc: 33.76% -> 33.76%             
client [47] (test)  loss: 2.6480 -> 2.4717   acc: 29.70% -> 33.83%             
client [36] (test)  loss: 3.2792 -> 2.9153   acc: 13.54% -> 19.79%             
client [20] (test)  loss: 1.6185 -> 1.4169   acc: 52.96% -> 57.89%             
client [56] (test)  loss: 2.7831 -> 2.7771   acc: 25.25% -> 29.70%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.2950 -> 1.9278   acc: 38.54% -> 45.86%              
client [60] (test)  loss: 2.8652 -> 2.7367   acc: 23.72% -> 30.77%             
client [28] (test)  loss: 3.3297 -> 2.4566   acc: 20.91% -> 37.63%             
client [25] (test)  loss: 3.4948 -> 2.1220   acc: 24.89% -> 46.41%             
client [58] (test)  loss: 2.6464 -> 2.5118   acc: 25.95% -> 28.48%             
client [44] (test)  loss: 2.8726 -> 2.6575   acc: 13.40% -> 21.24%             
client [39] (test)  loss: 2.7899 -> 2.4810   acc: 22.33% -> 28.80%             
client [29] (test)  loss: 2.9824 -> 2.4526   acc: 21.43% -> 34.29%             
client [3] (test)  loss: 2.6632 -> 2.2357   acc: 24.46% -> 37.61%              
client [84] (test)  loss: 2.5523 -> 2.3674   acc: 33.23% -> 39.75%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.8285 -> 2.1383   acc: 31.99% -> 36.31%             
client [84] (test)  loss: 2.6084 -> 2.3646   acc: 32.30% -> 39.44%             
client [10] (test)  loss: 2.7108 -> 2.4942   acc: 33.33% -> 42.46%             
client [36] (test)  loss: 3.5080 -> 2.8256   acc: 15.97% -> 23.26%             
client [65] (test)  loss: 2.6977 -> 2.7427   acc: 30.36% -> 31.98%             
client [81] (test)  loss: 3.0412 -> 2.4542   acc: 29.43% -> 37.03%             
client [79] (test)  loss: 1.9542 -> 1.7316   acc: 45.48% -> 53.67%             
client [42] (test)  loss: 2.6440 -> 2.6366   acc: 27.04% -> 37.13%             
client [11] (test)  loss: 2.7011 -> 2.3941   acc: 25.15% -> 39.57%             
client [96] (test)  loss: 2.1552 -> 2.0867   acc: 39.01% -> 40.87%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.0378 -> 2.1311   acc: 42.63% -> 46.15%              
client [53] (test)  loss: 2.4412 -> 2.4549   acc: 39.22% -> 36.23%             
client [52] (test)  loss: 2.9559 -> 2.9832   acc: 39.53% -> 41.53%             
client [42] (test)  loss: 2.7870 -> 2.4829   acc: 30.29% -> 41.69%             
client [69] (test)  loss: 2.0142 -> 1.5847   acc: 61.76% -> 61.47%             
client [59] (test)  loss: 2.1903 -> 1.8578   acc: 45.81% -> 48.71%             
client [7] (test)  loss: 2.9962 -> 2.2049   acc: 22.33% -> 38.51%              
client [26] (test)  loss: 2.6764 -> 2.5504   acc: 25.77% -> 31.92%             
client [49] (test)  loss: 2.6437 -> 2.6759   acc: 42.53% -> 36.78%             
client [98] (test)  loss: 2.7799 -> 2.9690   acc: 29.06% -> 29.06%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.6414 -> 2.9770   acc: 33.75% -> 31.56%             
client [47] (test)  loss: 2.8042 -> 2.3477   acc: 25.56% -> 39.10%             
client [21] (test)  loss: 2.4309 -> 2.1836   acc: 34.87% -> 39.77%             
client [77] (test)  loss: 3.1340 -> 1.8146   acc: 37.30% -> 52.04%             
client [95] (test)  loss: 3.0532 -> 2.2476   acc: 31.35% -> 45.21%             
client [91] (test)  loss: 2.2296 -> 2.0457   acc: 37.94% -> 42.12%             
client [14] (test)  loss: 2.6177 -> 2.3405   acc: 36.47% -> 38.24%             
client [99] (test)  loss: 3.4267 -> 3.1964   acc: 26.11% -> 32.48%             
client [20] (test)  loss: 1.4028 -> 2.4141   acc: 58.55% -> 35.53%             
client [39] (test)  loss: 2.5501 -> 2.7906   acc: 35.92% -> 19.09%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.9035 -> 2.7376   acc: 42.19% -> 41.86%             
client [62] (test)  loss: 2.6026 -> 2.5801   acc: 34.43% -> 33.44%             
client [71] (test)  loss: 3.0191 -> 3.0890   acc: 25.32% -> 25.32%             
client [97] (test)  loss: 2.7870 -> 2.6734   acc: 28.02% -> 29.31%             
client [30] (test)  loss: 2.8360 -> 2.4422   acc: 24.37% -> 33.86%             
client [88] (test)  loss: 2.3042 -> 2.2205   acc: 38.41% -> 41.72%             
client [60] (test)  loss: 3.4225 -> 2.9133   acc: 25.00% -> 34.62%             
client [82] (test)  loss: 2.5985 -> 2.3763   acc: 35.99% -> 39.45%             
client [91] (test)  loss: 2.5102 -> 2.1018   acc: 36.33% -> 40.51%             
client [57] (test)  loss: 2.8744 -> 2.2808   acc: 32.34% -> 46.20%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.5139 -> 2.3170   acc: 33.12% -> 42.12%             
client [15] (test)  loss: 2.7522 -> 2.4731   acc: 33.86% -> 36.08%             
client [71] (test)  loss: 3.1540 -> 3.1380   acc: 27.60% -> 25.65%             
client [97] (test)  loss: 2.9881 -> 2.6803   acc: 21.55% -> 32.33%             
client [53] (test)  loss: 2.7051 -> 2.2997   acc: 31.14% -> 43.11%             
client [77] (test)  loss: 2.4151 -> 1.8618   acc: 43.26% -> 50.78%             
client [76] (test)  loss: 2.6129 -> 2.3791   acc: 39.87% -> 37.54%             
client [79] (test)  loss: 1.8281 -> 1.6634   acc: 54.24% -> 54.80%             
client [28] (test)  loss: 3.2878 -> 2.3576   acc: 32.40% -> 39.72%             
client [99] (test)  loss: 4.0803 -> 3.2455   acc: 20.38% -> 33.76%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.8672 -> 2.7262   acc: 26.29% -> 32.33%             
client [86] (test)  loss: 3.3564 -> 2.3787   acc: 26.57% -> 41.19%             
client [34] (test)  loss: 3.1079 -> 2.4869   acc: 29.47% -> 35.43%             
client [73] (test)  loss: 2.4990 -> 2.4761   acc: 36.33% -> 38.67%             
client [5] (test)  loss: 2.3814 -> 2.4241   acc: 39.30% -> 39.62%              
client [96] (test)  loss: 2.1486 -> 2.1022   acc: 42.41% -> 41.80%             
client [22] (test)  loss: 2.9811 -> 2.5249   acc: 28.66% -> 33.64%             
client [60] (test)  loss: 3.0461 -> 3.0417   acc: 32.05% -> 34.62%             
client [66] (test)  loss: 2.5108 -> 2.2482   acc: 35.60% -> 44.98%             
client [83] (test)  loss: 2.1155 -> 1.9200   acc: 45.70% -> 51.99%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 2.4146 -> 2.4140   acc: 42.19% -> 37.21%             
client [65] (test)  loss: 3.4266 -> 2.7444   acc: 27.13% -> 34.82%             
client [95] (test)  loss: 2.9696 -> 2.2659   acc: 37.29% -> 45.54%             
client [17] (test)  loss: 2.8709 -> 2.6847   acc: 28.57% -> 26.67%             
client [8] (test)  loss: 2.7713 -> 2.1571   acc: 45.51% -> 49.04%              
client [35] (test)  loss: 3.4515 -> 1.9444   acc: 31.33% -> 46.00%             
client [98] (test)  loss: 2.8416 -> 2.9099   acc: 29.38% -> 33.75%             
client [53] (test)  loss: 2.3323 -> 2.3506   acc: 43.11% -> 41.32%             
client [43] (test)  loss: 2.9400 -> 2.3706   acc: 33.03% -> 45.45%             
client [64] (test)  loss: 2.3550 -> 2.1637   acc: 47.62% -> 50.42%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.7388 -> 2.2760   acc: 31.41% -> 37.75%             
client [88] (test)  loss: 2.7507 -> 2.3575   acc: 37.75% -> 46.69%             
client [38] (test)  loss: 2.6047 -> 2.4549   acc: 46.74% -> 40.51%             
client [3] (test)  loss: 3.5403 -> 2.2767   acc: 31.19% -> 44.04%              
client [5] (test)  loss: 2.5656 -> 2.4145   acc: 38.98% -> 42.49%              
client [41] (test)  loss: 2.9170 -> 2.5197   acc: 32.33% -> 36.67%             
client [7] (test)  loss: 3.5984 -> 2.0211   acc: 26.54% -> 44.34%              
client [37] (test)  loss: 2.7247 -> 2.6808   acc: 34.41% -> 33.12%             
client [45] (test)  loss: 2.5068 -> 2.0351   acc: 35.67% -> 42.00%             
client [47] (test)  loss: 3.1545 -> 2.4152   acc: 29.32% -> 40.98%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.6486 -> 2.5467   acc: 35.49% -> 38.31%             
client [11] (test)  loss: 2.7861 -> 2.4103   acc: 37.42% -> 48.47%             
client [37] (test)  loss: 2.9242 -> 2.7752   acc: 34.41% -> 32.15%             
client [41] (test)  loss: 2.8369 -> 2.5396   acc: 36.67% -> 38.33%             
client [95] (test)  loss: 4.3027 -> 2.3938   acc: 27.72% -> 47.52%             
client [53] (test)  loss: 2.5324 -> 2.3594   acc: 40.72% -> 43.11%             
client [22] (test)  loss: 3.0463 -> 2.6609   acc: 31.15% -> 37.07%             
client [25] (test)  loss: 2.1543 -> 2.2191   acc: 47.68% -> 43.88%             
client [69] (test)  loss: 2.3684 -> 1.4793   acc: 58.07% -> 66.01%             
client [46] (test)  loss: 2.5065 -> 2.0817   acc: 47.60% -> 49.60%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.6826 -> 2.5939   acc: 34.21% -> 40.23%             
client [69] (test)  loss: 2.6488 -> 1.4822   acc: 56.09% -> 68.27%             
client [82] (test)  loss: 2.8093 -> 2.4793   acc: 36.33% -> 42.56%             
client [45] (test)  loss: 2.4322 -> 2.3204   acc: 35.67% -> 44.00%             
client [7] (test)  loss: 3.2430 -> 1.9978   acc: 28.80% -> 49.51%              
client [50] (test)  loss: 3.2547 -> 2.3472   acc: 30.47% -> 48.03%             
client [35] (test)  loss: 3.0209 -> 2.2314   acc: 37.00% -> 42.67%             
client [24] (test)  loss: 3.0230 -> 2.6362   acc: 38.02% -> 42.97%             
client [15] (test)  loss: 2.9764 -> 2.6715   acc: 30.38% -> 37.03%             
client [58] (test)  loss: 2.7087 -> 2.7519   acc: 29.43% -> 35.76%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.1509 -> 3.1349   acc: 31.70% -> 33.33%             
client [76] (test)  loss: 2.6011 -> 2.6727   acc: 38.87% -> 39.20%             
client [67] (test)  loss: 2.1568 -> 1.8968   acc: 42.95% -> 50.47%             
client [37] (test)  loss: 3.0344 -> 2.8956   acc: 36.66% -> 35.05%             
client [58] (test)  loss: 2.7221 -> 2.8439   acc: 33.23% -> 36.71%             
client [64] (test)  loss: 2.9187 -> 2.2617   acc: 35.57% -> 48.46%             
client [77] (test)  loss: 3.2728 -> 2.2678   acc: 41.38% -> 47.02%             
client [55] (test)  loss: 2.6513 -> 2.1440   acc: 46.89% -> 51.55%             
client [12] (test)  loss: 2.3376 -> 2.3712   acc: 43.75% -> 44.41%             
client [89] (test)  loss: 3.7529 -> 3.2116   acc: 30.89% -> 36.09%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.2586 -> 2.8604   acc: 38.82% -> 43.79%             
client [51] (test)  loss: 4.0758 -> 3.2425   acc: 21.90% -> 33.99%             
client [8] (test)  loss: 3.0605 -> 2.5740   acc: 44.55% -> 47.12%              
client [18] (test)  loss: 3.0789 -> 2.3360   acc: 28.39% -> 54.43%             
client [94] (test)  loss: 2.6345 -> 2.6672   acc: 44.55% -> 40.71%             
client [81] (test)  loss: 3.1506 -> 2.6482   acc: 47.15% -> 48.73%             
client [3] (test)  loss: 2.6254 -> 2.6299   acc: 47.40% -> 48.32%              
client [11] (test)  loss: 3.3209 -> 2.7214   acc: 37.73% -> 46.01%             
client [95] (test)  loss: 4.6409 -> 2.7288   acc: 28.05% -> 48.18%             
client [67] (test)  loss: 2.2799 -> 1.9853   acc: 41.69% -> 50.47%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.8644 -> 2.4148   acc: 29.11% -> 42.07%             
client [79] (test)  loss: 2.0153 -> 2.0781   acc: 57.63% -> 60.73%             
client [58] (test)  loss: 2.9823 -> 2.9145   acc: 31.33% -> 35.13%             
client [88] (test)  loss: 2.8682 -> 2.5820   acc: 44.70% -> 46.03%             
client [46] (test)  loss: 2.5377 -> 2.2391   acc: 43.60% -> 52.00%             
client [11] (test)  loss: 3.1784 -> 2.8233   acc: 36.81% -> 47.55%             
client [55] (test)  loss: 2.4804 -> 2.4213   acc: 46.27% -> 47.52%             
client [13] (test)  loss: 2.5357 -> 2.6731   acc: 42.25% -> 39.21%             
client [31] (test)  loss: 3.9971 -> 2.6061   acc: 34.41% -> 42.44%             
client [75] (test)  loss: 2.7157 -> 2.1357   acc: 42.86% -> 60.13%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.0814 -> 2.8986   acc: 37.46% -> 40.39%             
client [7] (test)  loss: 3.0545 -> 2.3189   acc: 36.25% -> 45.63%              
client [57] (test)  loss: 4.4731 -> 2.7871   acc: 24.75% -> 51.49%             
client [13] (test)  loss: 3.3207 -> 2.7438   acc: 36.17% -> 38.60%             
client [43] (test)  loss: 3.3938 -> 2.8382   acc: 36.36% -> 44.55%             
client [91] (test)  loss: 2.9442 -> 2.3128   acc: 45.02% -> 46.62%             
client [10] (test)  loss: 3.8030 -> 3.0135   acc: 38.89% -> 41.27%             
client [64] (test)  loss: 3.0590 -> 2.5954   acc: 37.25% -> 47.34%             
client [82] (test)  loss: 3.5816 -> 2.7248   acc: 38.75% -> 45.67%             
client [22] (test)  loss: 3.5049 -> 2.7429   acc: 35.83% -> 41.74%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.1485 -> 1.4196   acc: 57.57% -> 63.82%             
client [23] (test)  loss: 3.1283 -> 3.1025   acc: 35.16% -> 38.28%             
client [88] (test)  loss: 3.0279 -> 2.6588   acc: 47.35% -> 48.68%             
client [98] (test)  loss: 3.1546 -> 3.2602   acc: 37.19% -> 38.44%             
client [79] (test)  loss: 2.4767 -> 2.2625   acc: 55.65% -> 61.30%             
client [21] (test)  loss: 3.5459 -> 2.4429   acc: 33.14% -> 44.09%             
client [92] (test)  loss: 3.4669 -> 3.6173   acc: 31.80% -> 34.31%             
client [56] (test)  loss: 4.6421 -> 3.2492   acc: 37.62% -> 46.53%             
client [5] (test)  loss: 3.3524 -> 2.8439   acc: 42.49% -> 43.13%              
client [52] (test)  loss: 3.4448 -> 3.0831   acc: 41.53% -> 48.84%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '2.7985 -> 0.0000', 'accuracy': '33.89% -> 0.00%'},          
    200: {'loss': '3.4136 -> 0.0000', 'accuracy': '37.88% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(10.59%) at epoch: 3                                      
FedPer achieved 20.0%(20.60%) at epoch: 9                                      
FedPer achieved 30.0%(35.67%) at epoch: 40                                     
FedPer achieved 40.0%(46.03%) at epoch: 104                                    
Convergence (test_after):                                                      
FedPer achieved 10.0%(18.39%) at epoch: 0                                      
FedPer achieved 20.0%(27.00%) at epoch: 1                                      
FedPer achieved 30.0%(30.89%) at epoch: 6                                      
FedPer achieved 40.0%(43.78%) at epoch: 40                                     
