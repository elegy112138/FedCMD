==================== ALGORITHM: FedPer ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.4997 -> 0.2845   acc: 79.51% -> 86.72%             
client [81] (test)  loss: 0.4842 -> 0.4544   acc: 91.09% -> 91.09%             
client [21] (test)  loss: 43.6547 -> 1.1004   acc: 3.26% -> 68.48%             
client [68] (test)  loss: 0.4075 -> 0.2702   acc: 93.14% -> 93.14%             
client [93] (test)  loss: 1.0613 -> 0.9744   acc: 56.52% -> 59.21%             
client [31] (test)  loss: 1.3181 -> 0.9097   acc: 58.54% -> 56.10%             
client [20] (test)  loss: 1.0203 -> 0.8976   acc: 69.58% -> 70.53%             
client [59] (test)  loss: 60.1888 -> 1.0111   acc: 0.18% -> 59.57%             
client [48] (test)  loss: 1.4938 -> 1.3712   acc: 39.18% -> 45.36%             
client [34] (test)  loss: 1.6579 -> 1.5993   acc: 61.22% -> 38.78%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.1471 -> 0.7818   acc: 67.51% -> 71.47%             
client [99] (test)  loss: 0.2064 -> 0.2139   acc: 95.55% -> 94.97%             
client [67] (test)  loss: 0.7416 -> 0.8786   acc: 64.56% -> 61.49%             
client [0] (test)  loss: 0.7211 -> 0.5372   acc: 72.92% -> 80.83%              
client [76] (test)  loss: 0.0495 -> 0.0434   acc: 99.28% -> 99.28%             
client [41] (test)  loss: 0.3608 -> 0.2445   acc: 88.51% -> 91.29%             
client [62] (test)  loss: 48.2569 -> 0.8800   acc: 19.20% -> 74.60%            
client [2] (test)  loss: 0.4419 -> 0.0038   acc: 98.24% -> 99.96%              
client [14] (test)  loss: 0.5742 -> 0.4606   acc: 86.96% -> 86.96%             
client [46] (test)  loss: 1.2198 -> 1.0151   acc: 63.33% -> 70.00%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.2733 -> 0.2529   acc: 92.21% -> 91.41%             
client [68] (test)  loss: 0.1558 -> 0.1390   acc: 95.10% -> 96.08%             
client [57] (test)  loss: 0.4058 -> 0.3526   acc: 84.72% -> 87.20%             
client [17] (test)  loss: 0.2356 -> 0.1986   acc: 94.16% -> 94.94%             
client [54] (test)  loss: 0.2982 -> 0.2793   acc: 93.43% -> 93.43%             
client [23] (test)  loss: 45.0852 -> 0.4176   acc: 14.50% -> 82.82%            
client [35] (test)  loss: 0.0351 -> 0.0344   acc: 99.62% -> 99.62%             
client [59] (test)  loss: 0.7213 -> 0.6018   acc: 72.56% -> 80.51%             
client [31] (test)  loss: 0.5226 -> 0.5012   acc: 87.80% -> 86.59%             
client [9] (test)  loss: 0.7172 -> 0.7040   acc: 75.80% -> 72.61%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5331 -> 0.4855   acc: 80.97% -> 83.69%             
client [33] (test)  loss: 0.0446 -> 0.0419   acc: 98.64% -> 98.64%             
client [16] (test)  loss: 0.1603 -> 0.1430   acc: 94.59% -> 95.68%             
client [44] (test)  loss: 1.2245 -> 0.5603   acc: 76.45% -> 79.75%             
client [8] (test)  loss: 0.4317 -> 0.3751   acc: 84.62% -> 86.54%              
client [31] (test)  loss: 0.5128 -> 0.4307   acc: 82.93% -> 89.02%             
client [47] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 1.0770 -> 0.8590   acc: 87.50% -> 87.50%             
client [20] (test)  loss: 0.6389 -> 0.5239   acc: 76.05% -> 82.13%             
client [56] (test)  loss: 0.0258 -> 0.0213   acc: 99.63% -> 99.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0044 -> 0.0104   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.0718 -> 0.0290   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.2416 -> 0.2139   acc: 91.75% -> 93.16%             
client [25] (test)  loss: 0.0711 -> 0.0868   acc: 99.16% -> 99.16%             
client [58] (test)  loss: 0.3160 -> 0.2801   acc: 89.51% -> 91.89%             
client [44] (test)  loss: 0.6602 -> 0.5321   acc: 76.03% -> 79.75%             
client [39] (test)  loss: 0.3911 -> 0.3852   acc: 90.44% -> 88.97%             
client [29] (test)  loss: 0.1200 -> 0.0894   acc: 95.58% -> 97.79%             
client [3] (test)  loss: 0.3168 -> 0.3261   acc: 89.32% -> 88.27%              
client [84] (test)  loss: 0.7466 -> 1.0886   acc: 76.24% -> 66.92%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6277 -> 0.6398   acc: 75.00% -> 75.00%             
client [84] (test)  loss: 0.6994 -> 0.9628   acc: 77.19% -> 69.58%             
client [10] (test)  loss: 0.0926 -> 0.0610   acc: 96.99% -> 97.56%             
client [36] (test)  loss: 0.5126 -> 0.4162   acc: 87.50% -> 87.50%             
client [65] (test)  loss: 0.0138 -> 0.0118   acc: 99.66% -> 99.66%             
client [81] (test)  loss: 0.2303 -> 0.2335   acc: 92.08% -> 92.08%             
client [79] (test)  loss: 0.1846 -> 0.1497   acc: 94.36% -> 95.86%             
client [42] (test)  loss: 0.4909 -> 0.4565   acc: 84.75% -> 85.76%             
client [11] (test)  loss: 0.5668 -> 0.4942   acc: 85.88% -> 84.75%             
client [96] (test)  loss: 0.1882 -> 0.1620   acc: 95.62% -> 95.62%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2308 -> 0.2260   acc: 92.31% -> 94.23%              
client [53] (test)  loss: 0.1716 -> 0.1813   acc: 95.15% -> 95.35%             
client [52] (test)  loss: 0.2133 -> 0.1293   acc: 93.46% -> 95.35%             
client [42] (test)  loss: 0.4384 -> 0.4288   acc: 87.12% -> 86.78%             
client [69] (test)  loss: 0.8935 -> 0.4846   acc: 68.93% -> 83.33%             
client [59] (test)  loss: 0.5840 -> 0.4829   acc: 78.70% -> 84.48%             
client [7] (test)  loss: 0.0070 -> 0.0089   acc: 99.52% -> 99.52%              
client [26] (test)  loss: 0.1168 -> 0.1429   acc: 95.08% -> 95.38%             
client [49] (test)  loss: 0.1380 -> 0.1488   acc: 96.65% -> 96.49%             
client [98] (test)  loss: 0.2525 -> 0.2421   acc: 92.44% -> 94.19%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2387 -> 0.2449   acc: 93.22% -> 93.99%             
client [47] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [21] (test)  loss: 0.4842 -> 0.5251   acc: 82.61% -> 78.26%             
client [77] (test)  loss: 0.1551 -> 0.1641   acc: 94.59% -> 95.74%             
client [95] (test)  loss: 0.2825 -> 0.3270   acc: 90.95% -> 91.86%             
client [91] (test)  loss: 0.5179 -> 0.4092   acc: 82.51% -> 87.21%             
client [14] (test)  loss: 0.2476 -> 0.2466   acc: 93.33% -> 93.62%             
client [99] (test)  loss: 0.1305 -> 0.1089   acc: 96.70% -> 97.13%             
client [20] (test)  loss: 0.5245 -> 0.4007   acc: 81.37% -> 86.50%             
client [39] (test)  loss: 0.3587 -> 0.3470   acc: 90.44% -> 89.71%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1929 -> 0.1901   acc: 94.75% -> 94.58%             
client [62] (test)  loss: 0.3845 -> 0.3507   acc: 88.80% -> 90.60%             
client [71] (test)  loss: 0.4904 -> 0.3827   acc: 80.64% -> 87.24%             
client [97] (test)  loss: 0.0001 -> 0.0000   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 0.0881 -> 0.1014   acc: 96.12% -> 96.90%             
client [88] (test)  loss: 0.0517 -> 0.0480   acc: 97.94% -> 98.35%             
client [60] (test)  loss: 0.0048 -> 0.0039   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.7579 -> 0.7104   acc: 75.61% -> 78.05%             
client [91] (test)  loss: 0.4186 -> 0.4101   acc: 87.47% -> 87.99%             
client [57] (test)  loss: 0.4093 -> 0.3208   acc: 85.77% -> 88.83%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4402 -> 0.4433   acc: 89.02% -> 91.46%             
client [15] (test)  loss: 0.1873 -> 0.1685   acc: 94.29% -> 95.12%             
client [71] (test)  loss: 0.4595 -> 0.3649   acc: 83.14% -> 87.47%             
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.1489 -> 0.1777   acc: 95.56% -> 94.95%             
client [77] (test)  loss: 0.1837 -> 0.1632   acc: 94.10% -> 95.08%             
client [76] (test)  loss: 0.0347 -> 0.0305   acc: 99.46% -> 99.64%             
client [79] (test)  loss: 0.1885 -> 0.1404   acc: 93.82% -> 96.10%             
client [28] (test)  loss: 0.2208 -> 0.1873   acc: 91.55% -> 94.37%             
client [99] (test)  loss: 0.1392 -> 0.1067   acc: 96.26% -> 97.13%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0001 -> 0.0000   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 0.3023 -> 0.2177   acc: 89.42% -> 92.95%             
client [34] (test)  loss: 0.5986 -> 0.8653   acc: 79.59% -> 77.55%             
client [73] (test)  loss: 0.0257 -> 0.0263   acc: 99.41% -> 99.56%             
client [5] (test)  loss: 0.2400 -> 0.1988   acc: 93.67% -> 96.20%              
client [96] (test)  loss: 0.2298 -> 0.1846   acc: 95.62% -> 94.89%             
client [22] (test)  loss: 0.3976 -> 0.3488   acc: 86.49% -> 90.54%             
client [60] (test)  loss: 0.0045 -> 0.0029   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.3802 -> 0.3358   acc: 86.01% -> 89.76%             
client [83] (test)  loss: 0.1011 -> 0.1295   acc: 95.00% -> 95.00%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0335 -> 0.0328   acc: 99.64% -> 99.64%             
client [65] (test)  loss: 0.0110 -> 0.0094   acc: 99.73% -> 99.73%             
client [95] (test)  loss: 0.2897 -> 0.2922   acc: 92.76% -> 92.76%             
client [17] (test)  loss: 0.2147 -> 0.1874   acc: 96.50% -> 96.50%             
client [8] (test)  loss: 0.2289 -> 0.1934   acc: 94.23% -> 94.23%              
client [35] (test)  loss: 0.0354 -> 0.0314   acc: 99.62% -> 99.62%             
client [98] (test)  loss: 0.2564 -> 0.2512   acc: 93.99% -> 94.96%             
client [53] (test)  loss: 0.1674 -> 0.1811   acc: 94.95% -> 95.35%             
client [43] (test)  loss: 0.1572 -> 0.1315   acc: 94.69% -> 95.60%             
client [64] (test)  loss: 0.3587 -> 0.3741   acc: 88.82% -> 88.82%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5370 -> 0.5274   acc: 88.04% -> 82.61%             
client [88] (test)  loss: 0.0621 -> 0.0514   acc: 98.22% -> 98.49%             
client [38] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.2520 -> 0.2607   acc: 92.82% -> 93.17%              
client [5] (test)  loss: 0.1913 -> 0.1955   acc: 96.20% -> 94.94%              
client [41] (test)  loss: 0.1111 -> 0.0984   acc: 96.04% -> 96.44%             
client [7] (test)  loss: 0.0075 -> 0.0094   acc: 99.68% -> 99.68%              
client [37] (test)  loss: 0.0145 -> 0.0132   acc: 99.76% -> 99.88%             
client [45] (test)  loss: 0.0656 -> 0.0655   acc: 98.31% -> 97.46%             
client [47] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1101 -> 0.1420   acc: 96.76% -> 95.68%             
client [11] (test)  loss: 0.4857 -> 0.4293   acc: 84.18% -> 86.44%             
client [37] (test)  loss: 0.0128 -> 0.0129   acc: 99.76% -> 99.88%             
client [41] (test)  loss: 0.1251 -> 0.1040   acc: 95.45% -> 96.44%             
client [95] (test)  loss: 0.3066 -> 0.3462   acc: 90.50% -> 90.95%             
client [53] (test)  loss: 0.1528 -> 0.1777   acc: 95.76% -> 95.35%             
client [22] (test)  loss: 0.3869 -> 0.3436   acc: 89.19% -> 91.89%             
client [25] (test)  loss: 0.0591 -> 0.0560   acc: 99.16% -> 99.16%             
client [69] (test)  loss: 0.4460 -> 0.3950   acc: 84.75% -> 88.14%             
client [46] (test)  loss: 0.5268 -> 0.4625   acc: 82.50% -> 85.83%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0002 -> 0.0001   acc: 100.00% -> 100.00%           
client [69] (test)  loss: 0.3940 -> 0.3740   acc: 86.16% -> 88.42%             
client [82] (test)  loss: 0.7431 -> 0.7169   acc: 78.05% -> 82.93%             
client [45] (test)  loss: 0.0623 -> 0.0602   acc: 97.88% -> 98.31%             
client [7] (test)  loss: 0.0060 -> 0.0100   acc: 99.68% -> 99.52%              
client [50] (test)  loss: 0.3578 -> 0.2524   acc: 86.27% -> 91.18%             
client [35] (test)  loss: 0.0336 -> 0.0345   acc: 99.55% -> 99.55%             
client [24] (test)  loss: 0.2884 -> 0.2300   acc: 89.13% -> 95.44%             
client [15] (test)  loss: 0.1960 -> 0.1654   acc: 93.73% -> 95.96%             
client [58] (test)  loss: 0.3476 -> 0.3088   acc: 91.10% -> 94.28%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6180 -> 0.6397   acc: 78.35% -> 77.32%             
client [76] (test)  loss: 0.0366 -> 0.0326   acc: 99.64% -> 99.46%             
client [67] (test)  loss: 0.3440 -> 0.2667   acc: 89.00% -> 91.75%             
client [37] (test)  loss: 0.0156 -> 0.0131   acc: 99.64% -> 99.88%             
client [58] (test)  loss: 0.3038 -> 0.3071   acc: 92.21% -> 93.96%             
client [64] (test)  loss: 0.3469 -> 0.3785   acc: 90.63% -> 90.03%             
client [77] (test)  loss: 0.1786 -> 0.1635   acc: 96.07% -> 96.23%             
client [55] (test)  loss: 0.0220 -> 0.0220   acc: 99.13% -> 99.28%             
client [12] (test)  loss: 0.2427 -> 0.2247   acc: 93.75% -> 93.75%             
client [89] (test)  loss: 0.0965 -> 0.1072   acc: 97.88% -> 97.53%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6379 -> 0.7235   acc: 79.85% -> 81.94%             
client [51] (test)  loss: 0.6133 -> 0.2916   acc: 86.24% -> 94.71%             
client [8] (test)  loss: 0.2266 -> 0.1723   acc: 92.31% -> 94.23%              
client [18] (test)  loss: 0.3540 -> 0.2811   acc: 87.76% -> 92.18%             
client [94] (test)  loss: 0.1250 -> 0.1322   acc: 96.93% -> 97.08%             
client [81] (test)  loss: 0.1974 -> 0.1921   acc: 94.06% -> 92.08%             
client [3] (test)  loss: 0.2662 -> 0.2502   acc: 92.82% -> 93.52%              
client [11] (test)  loss: 0.4185 -> 0.4305   acc: 87.01% -> 87.57%             
client [95] (test)  loss: 0.3385 -> 0.3456   acc: 91.86% -> 92.76%             
client [67] (test)  loss: 0.4045 -> 0.2692   acc: 86.57% -> 92.39%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4987 -> 0.5140   acc: 88.04% -> 84.78%             
client [79] (test)  loss: 0.2217 -> 0.1781   acc: 93.23% -> 96.28%             
client [58] (test)  loss: 0.3160 -> 0.3293   acc: 92.05% -> 93.64%             
client [88] (test)  loss: 0.0453 -> 0.0520   acc: 98.90% -> 98.49%             
client [46] (test)  loss: 0.4543 -> 0.4590   acc: 83.33% -> 84.17%             
client [11] (test)  loss: 0.4733 -> 0.4375   acc: 85.88% -> 87.01%             
client [55] (test)  loss: 0.0202 -> 0.0256   acc: 99.13% -> 99.28%             
client [13] (test)  loss: 0.1838 -> 0.1670   acc: 94.36% -> 95.41%             
client [31] (test)  loss: 0.5200 -> 0.4468   acc: 89.02% -> 89.02%             
client [75] (test)  loss: 0.2892 -> 0.3678   acc: 90.58% -> 89.20%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2803 -> 0.1807   acc: 89.54% -> 92.38%             
client [7] (test)  loss: 0.0069 -> 0.0097   acc: 99.68% -> 99.68%              
client [57] (test)  loss: 0.4012 -> 0.3779   acc: 87.87% -> 87.77%             
client [13] (test)  loss: 0.1608 -> 0.1732   acc: 95.24% -> 95.06%             
client [43] (test)  loss: 0.1246 -> 0.1262   acc: 95.97% -> 95.97%             
client [91] (test)  loss: 0.4050 -> 0.3783   acc: 87.73% -> 90.60%             
client [10] (test)  loss: 0.0960 -> 0.0579   acc: 97.27% -> 98.13%             
client [64] (test)  loss: 0.3599 -> 0.3834   acc: 91.24% -> 90.63%             
client [82] (test)  loss: 0.9366 -> 0.8439   acc: 78.05% -> 78.05%             
client [22] (test)  loss: 0.3751 -> 0.3017   acc: 87.84% -> 90.54%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4143 -> 0.3499   acc: 87.26% -> 89.73%             
client [23] (test)  loss: 0.2642 -> 0.1951   acc: 91.98% -> 93.51%             
client [88] (test)  loss: 0.0720 -> 0.0555   acc: 97.53% -> 98.63%             
client [98] (test)  loss: 0.2793 -> 0.2696   acc: 93.99% -> 94.77%             
client [79] (test)  loss: 0.1752 -> 0.1825   acc: 95.56% -> 96.28%             
client [21] (test)  loss: 0.4757 -> 0.5380   acc: 89.13% -> 83.70%             
client [92] (test)  loss: 0.3088 -> 0.2947   acc: 89.95% -> 90.21%             
client [56] (test)  loss: 0.0181 -> 0.0109   acc: 99.63% -> 99.81%             
client [5] (test)  loss: 0.1925 -> 0.2072   acc: 95.57% -> 95.57%              
client [52] (test)  loss: 0.1880 -> 0.1560   acc: 95.44% -> 96.04%             
==================== FedPer TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.2006 -> 0.0000', 'accuracy': '93.42% -> 0.00%'},          
    200: {'loss': '0.2024 -> 0.0000', 'accuracy': '94.38% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer achieved 10.0%(10.14%) at epoch: 0                                      
FedPer achieved 20.0%(26.61%) at epoch: 1                                      
FedPer achieved 30.0%(36.21%) at epoch: 3                                      
FedPer achieved 60.0%(68.22%) at epoch: 4                                      
FedPer achieved 80.0%(82.43%) at epoch: 7                                      
FedPer achieved 90.0%(90.41%) at epoch: 18                                     
Convergence (test_after):                                                      
FedPer achieved 80.0%(83.44%) at epoch: 0                                      
FedPer achieved 90.0%(92.89%) at epoch: 7                                      
