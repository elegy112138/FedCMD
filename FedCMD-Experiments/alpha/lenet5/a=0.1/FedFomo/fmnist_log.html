==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0085 -> 0.0047   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 1.0929 -> 0.8154   acc: 60.91% -> 76.36%             
client [21] (test)  loss: 22.4023 -> 0.7897   acc: 0.00% -> 81.88%             
client [68] (test)  loss: 0.4040 -> 0.3443   acc: 89.20% -> 89.20%             
client [93] (test)  loss: 1.0531 -> 0.3802   acc: 85.60% -> 85.60%             
client [31] (test)  loss: 1.2269 -> 0.6304   acc: 60.56% -> 77.22%             
client [20] (test)  loss: 0.1452 -> 0.1231   acc: 96.83% -> 96.83%             
client [59] (test)  loss: 26.1926 -> 1.1971   acc: 0.00% -> 57.74%             
client [48] (test)  loss: 0.1010 -> 0.0986   acc: 98.75% -> 98.75%             
client [34] (test)  loss: 0.7891 -> 0.7870   acc: 73.53% -> 73.53%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4644 -> 0.3817   acc: 84.80% -> 86.13%             
client [99] (test)  loss: 0.4592 -> 0.2884   acc: 88.64% -> 90.62%             
client [67] (test)  loss: 0.4026 -> 0.3096   acc: 86.16% -> 89.58%             
client [0] (test)  loss: 1.4667 -> 1.1116   acc: 66.36% -> 68.22%              
client [76] (test)  loss: 1.3259 -> 1.2188   acc: 63.16% -> 63.16%             
client [41] (test)  loss: 0.4942 -> 0.4023   acc: 82.64% -> 87.56%             
client [62] (test)  loss: 30.6680 -> 2.1542   acc: 0.00% -> 90.48%             
client [2] (test)  loss: 2.5546 -> 0.0060   acc: 25.43% -> 100.00%             
client [14] (test)  loss: 0.1151 -> 0.1088   acc: 96.64% -> 96.64%             
client [46] (test)  loss: 0.4211 -> 0.4044   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6521 -> 0.5751   acc: 81.61% -> 83.42%             
client [68] (test)  loss: 0.2799 -> 0.2646   acc: 91.29% -> 91.29%             
client [57] (test)  loss: 0.1005 -> 0.0852   acc: 97.18% -> 97.18%             
client [17] (test)  loss: 0.3201 -> 0.2550   acc: 87.85% -> 91.71%             
client [54] (test)  loss: 0.3627 -> 0.3309   acc: 82.90% -> 82.90%             
client [23] (test)  loss: 21.6153 -> 0.6412   acc: 12.78% -> 69.55%            
client [35] (test)  loss: 0.4749 -> 0.3933   acc: 82.42% -> 87.88%             
client [59] (test)  loss: 0.6643 -> 0.5569   acc: 75.48% -> 84.19%             
client [31] (test)  loss: 0.2503 -> 0.2321   acc: 93.89% -> 93.89%             
client [9] (test)  loss: 0.0621 -> 0.0517   acc: 98.13% -> 98.13%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3899 -> 0.3143   acc: 87.35% -> 92.94%             
client [33] (test)  loss: 0.2280 -> 0.2134   acc: 92.47% -> 92.24%             
client [16] (test)  loss: 0.2873 -> 0.2157   acc: 91.96% -> 95.80%             
client [44] (test)  loss: 1.2721 -> 0.7525   acc: 72.89% -> 73.63%             
client [8] (test)  loss: 0.0013 -> 0.0012   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.2207 -> 0.2129   acc: 93.89% -> 93.89%             
client [47] (test)  loss: 0.1058 -> 0.0786   acc: 97.98% -> 98.16%             
client [36] (test)  loss: 0.0229 -> 0.0169   acc: 99.39% -> 99.63%             
client [20] (test)  loss: 0.0786 -> 0.0713   acc: 96.83% -> 96.83%             
client [56] (test)  loss: 0.3952 -> 0.3658   acc: 90.24% -> 89.02%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.2745 -> 0.2571   acc: 92.73% -> 93.08%              
client [60] (test)  loss: 0.1682 -> 0.1112   acc: 93.23% -> 96.52%             
client [28] (test)  loss: 0.2613 -> 0.2197   acc: 94.64% -> 94.64%             
client [25] (test)  loss: 0.4257 -> 0.3350   acc: 86.06% -> 91.99%             
client [58] (test)  loss: 0.2288 -> 0.2176   acc: 91.79% -> 91.97%             
client [44] (test)  loss: 0.7525 -> 0.5410   acc: 73.63% -> 84.98%             
client [39] (test)  loss: 0.9923 -> 0.7681   acc: 94.44% -> 94.44%             
client [29] (test)  loss: 0.4292 -> 0.4038   acc: 87.67% -> 88.58%             
client [3] (test)  loss: 0.3207 -> 0.2942   acc: 88.22% -> 89.13%              
client [84] (test)  loss: 0.0585 -> 0.0547   acc: 98.62% -> 98.62%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3852 -> 0.3510   acc: 86.23% -> 86.71%             
client [84] (test)  loss: 0.0523 -> 0.0507   acc: 98.62% -> 99.08%             
client [10] (test)  loss: 0.1709 -> 0.1588   acc: 94.93% -> 94.20%             
client [36] (test)  loss: 0.0153 -> 0.0147   acc: 99.63% -> 99.63%             
client [65] (test)  loss: 0.3062 -> 0.3015   acc: 92.86% -> 92.86%             
client [81] (test)  loss: 0.4854 -> 0.4466   acc: 84.55% -> 84.55%             
client [79] (test)  loss: 0.4620 -> 0.4377   acc: 80.10% -> 82.80%             
client [42] (test)  loss: 0.0481 -> 0.0469   acc: 98.81% -> 98.81%             
client [11] (test)  loss: 0.4292 -> 0.3929   acc: 84.89% -> 86.22%             
client [96] (test)  loss: 0.4200 -> 0.3958   acc: 86.52% -> 86.52%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0009 -> 0.0008   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.0593 -> 0.0565   acc: 98.89% -> 98.99%             
client [52] (test)  loss: 0.4526 -> 0.4326   acc: 83.72% -> 83.72%             
client [42] (test)  loss: 0.0459 -> 0.0453   acc: 98.87% -> 98.93%             
client [69] (test)  loss: 0.2162 -> 0.2076   acc: 92.53% -> 92.80%             
client [59] (test)  loss: 0.4320 -> 0.4127   acc: 87.10% -> 87.42%             
client [7] (test)  loss: 0.1260 -> 0.1209   acc: 95.95% -> 95.95%              
client [26] (test)  loss: 0.0195 -> 0.0162   acc: 99.68% -> 99.68%             
client [49] (test)  loss: 0.0008 -> 0.0006   acc: 100.00% -> 100.00%           
client [98] (test)  loss: 0.4718 -> 0.4463   acc: 83.00% -> 83.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4463 -> 0.4237   acc: 83.00% -> 83.00%             
client [47] (test)  loss: 0.0698 -> 0.0657   acc: 98.16% -> 98.16%             
client [21] (test)  loss: 0.3321 -> 0.3122   acc: 87.68% -> 88.16%             
client [77] (test)  loss: 0.0011 -> 0.0010   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.3078 -> 0.2889   acc: 90.23% -> 90.98%             
client [91] (test)  loss: 0.1413 -> 0.1244   acc: 100.00% -> 100.00%           
client [14] (test)  loss: 0.1161 -> 0.1181   acc: 96.78% -> 96.78%             
client [99] (test)  loss: 0.1138 -> 0.1095   acc: 98.30% -> 98.30%             
client [20] (test)  loss: 0.0500 -> 0.0467   acc: 98.17% -> 98.17%             
client [39] (test)  loss: 0.4951 -> 0.4322   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4326 -> 0.4189   acc: 83.72% -> 83.72%             
client [62] (test)  loss: 0.3473 -> 0.3405   acc: 92.86% -> 92.86%             
client [71] (test)  loss: 0.0652 -> 0.0629   acc: 97.65% -> 97.65%             
client [97] (test)  loss: 0.0793 -> 0.0761   acc: 98.36% -> 98.36%             
client [30] (test)  loss: 0.1813 -> 0.1735   acc: 93.26% -> 93.63%             
client [88] (test)  loss: 0.5748 -> 0.5354   acc: 74.59% -> 75.69%             
client [60] (test)  loss: 0.0881 -> 0.0909   acc: 97.29% -> 96.91%             
client [82] (test)  loss: 0.0686 -> 0.0677   acc: 98.56% -> 98.56%             
client [91] (test)  loss: 0.0373 -> 0.0476   acc: 100.00% -> 100.00%           
client [57] (test)  loss: 0.0553 -> 0.0495   acc: 98.68% -> 99.06%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2073 -> 0.2094   acc: 91.11% -> 90.56%             
client [15] (test)  loss: 0.2184 -> 0.2094   acc: 91.08% -> 91.08%             
client [71] (test)  loss: 0.0629 -> 0.0613   acc: 97.65% -> 98.01%             
client [97] (test)  loss: 0.0734 -> 0.0729   acc: 98.52% -> 98.52%             
client [53] (test)  loss: 0.0532 -> 0.0528   acc: 98.99% -> 98.99%             
client [77] (test)  loss: 0.0010 -> 0.0009   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.5988 -> 0.5804   acc: 86.84% -> 86.84%             
client [79] (test)  loss: 0.3980 -> 0.3900   acc: 85.26% -> 86.00%             
client [28] (test)  loss: 0.2367 -> 0.1363   acc: 93.75% -> 95.54%             
client [99] (test)  loss: 0.1065 -> 0.1040   acc: 98.30% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0725 -> 0.0724   acc: 98.52% -> 98.52%             
client [86] (test)  loss: 0.7821 -> 0.5105   acc: 91.23% -> 91.23%             
client [34] (test)  loss: 0.0711 -> 0.0787   acc: 98.53% -> 98.53%             
client [73] (test)  loss: 0.0822 -> 0.0772   acc: 98.21% -> 98.57%             
client [5] (test)  loss: 0.0497 -> 0.0487   acc: 98.91% -> 98.91%              
client [96] (test)  loss: 0.2984 -> 0.2951   acc: 90.73% -> 90.45%             
client [22] (test)  loss: 0.2412 -> 0.2247   acc: 92.92% -> 93.40%             
client [60] (test)  loss: 0.0980 -> 0.1004   acc: 96.91% -> 96.91%             
client [66] (test)  loss: 0.0010 -> 0.0009   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0703 -> 0.0696   acc: 98.31% -> 98.31%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5401 -> 0.5293   acc: 86.84% -> 86.84%             
client [65] (test)  loss: 0.2969 -> 0.2960   acc: 92.86% -> 92.86%             
client [95] (test)  loss: 0.2506 -> 0.2425   acc: 92.48% -> 91.73%             
client [17] (test)  loss: 0.1557 -> 0.1475   acc: 95.58% -> 95.86%             
client [8] (test)  loss: 0.0006 -> 0.0006   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.2208 -> 0.2195   acc: 90.30% -> 90.30%             
client [98] (test)  loss: 0.3266 -> 0.3303   acc: 86.00% -> 84.00%             
client [53] (test)  loss: 0.0524 -> 0.0522   acc: 98.99% -> 98.99%             
client [43] (test)  loss: 0.4123 -> 0.4126   acc: 88.15% -> 89.63%             
client [64] (test)  loss: 0.2299 -> 0.2270   acc: 94.41% -> 94.41%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2914 -> 0.2729   acc: 88.16% -> 89.37%             
client [88] (test)  loss: 0.4203 -> 0.4206   acc: 83.43% -> 83.43%             
client [38] (test)  loss: 0.5440 -> 0.5335   acc: 81.21% -> 81.21%             
client [3] (test)  loss: 0.1980 -> 0.1964   acc: 94.02% -> 94.02%              
client [5] (test)  loss: 0.0478 -> 0.0472   acc: 98.91% -> 98.91%              
client [41] (test)  loss: 0.2677 -> 0.2671   acc: 91.19% -> 91.19%             
client [7] (test)  loss: 0.1121 -> 0.1086   acc: 96.13% -> 96.32%              
client [37] (test)  loss: 0.3640 -> 0.3489   acc: 89.69% -> 89.69%             
client [45] (test)  loss: 0.4959 -> 0.4933   acc: 75.64% -> 76.92%             
client [47] (test)  loss: 0.0614 -> 0.0599   acc: 98.16% -> 98.16%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0788 -> 0.0747   acc: 98.25% -> 98.25%             
client [11] (test)  loss: 0.3422 -> 0.3466   acc: 88.89% -> 88.44%             
client [37] (test)  loss: 0.3242 -> 0.3133   acc: 90.72% -> 90.72%             
client [41] (test)  loss: 0.2671 -> 0.2684   acc: 91.19% -> 91.45%             
client [95] (test)  loss: 0.2258 -> 0.2222   acc: 93.23% -> 92.48%             
client [53] (test)  loss: 0.0522 -> 0.0520   acc: 98.99% -> 98.99%             
client [22] (test)  loss: 0.2108 -> 0.1987   acc: 93.40% -> 93.87%             
client [25] (test)  loss: 0.2110 -> 0.2049   acc: 93.38% -> 93.38%             
client [69] (test)  loss: 0.1662 -> 0.1637   acc: 95.20% -> 94.67%             
client [46] (test)  loss: 0.3702 -> 0.3683   acc: 91.19% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0563 -> 0.0557   acc: 98.16% -> 98.16%             
client [69] (test)  loss: 0.1618 -> 0.1600   acc: 94.93% -> 95.20%             
client [82] (test)  loss: 0.3069 -> 0.0996   acc: 98.56% -> 98.56%             
client [45] (test)  loss: 0.4882 -> 0.4866   acc: 78.21% -> 78.21%             
client [7] (test)  loss: 0.1086 -> 0.1054   acc: 96.32% -> 96.87%              
client [50] (test)  loss: 0.0008 -> 0.0007   acc: 100.00% -> 100.00%           
client [35] (test)  loss: 0.2184 -> 0.2182   acc: 90.30% -> 89.70%             
client [24] (test)  loss: 0.6257 -> 0.6419   acc: 83.42% -> 83.42%             
client [15] (test)  loss: 0.1943 -> 0.1940   acc: 91.51% -> 91.51%             
client [58] (test)  loss: 0.1485 -> 0.1475   acc: 96.53% -> 96.35%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1188 -> 0.0912   acc: 98.75% -> 98.75%             
client [76] (test)  loss: 0.5109 -> 0.5019   acc: 86.84% -> 86.84%             
client [67] (test)  loss: 0.1594 -> 0.1620   acc: 95.39% -> 95.39%             
client [37] (test)  loss: 0.3033 -> 0.2945   acc: 90.72% -> 90.72%             
client [58] (test)  loss: 0.1467 -> 0.1461   acc: 96.35% -> 96.35%             
client [64] (test)  loss: 0.2236 -> 0.2235   acc: 94.41% -> 94.41%             
client [77] (test)  loss: 0.0037 -> 0.0034   acc: 99.72% -> 99.72%             
client [55] (test)  loss: 0.0353 -> 0.0348   acc: 98.76% -> 98.76%             
client [12] (test)  loss: 0.3159 -> 0.3240   acc: 91.47% -> 91.47%             
client [89] (test)  loss: 1.1119 -> 1.1139   acc: 73.81% -> 73.81%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0455 -> 0.0455   acc: 99.08% -> 99.08%             
client [51] (test)  loss: 0.0205 -> 0.0204   acc: 99.49% -> 99.49%             
client [8] (test)  loss: 0.0004 -> 0.0004   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.0183 -> 0.0184   acc: 99.76% -> 99.76%             
client [94] (test)  loss: 0.3200 -> 0.3206   acc: 91.49% -> 91.49%             
client [81] (test)  loss: 0.2442 -> 0.2374   acc: 90.91% -> 91.82%             
client [3] (test)  loss: 0.1926 -> 0.1923   acc: 94.75% -> 94.93%              
client [11] (test)  loss: 0.3615 -> 0.3689   acc: 88.89% -> 88.89%             
client [95] (test)  loss: 0.2101 -> 0.2090   acc: 92.48% -> 92.48%             
client [67] (test)  loss: 0.1620 -> 0.1648   acc: 95.39% -> 95.39%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2476 -> 0.2390   acc: 89.61% -> 89.86%             
client [79] (test)  loss: 0.5130 -> 0.5211   acc: 85.26% -> 85.26%             
client [58] (test)  loss: 0.1455 -> 0.1454   acc: 96.53% -> 96.53%             
client [88] (test)  loss: 0.4339 -> 0.4395   acc: 85.08% -> 85.08%             
client [46] (test)  loss: 0.3645 -> 0.3640   acc: 91.19% -> 91.19%             
client [11] (test)  loss: 0.3689 -> 0.3748   acc: 88.89% -> 88.89%             
client [55] (test)  loss: 0.0266 -> 0.0210   acc: 99.52% -> 99.52%             
client [13] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [31] (test)  loss: 0.2198 -> 0.2235   acc: 90.00% -> 90.00%             
client [75] (test)  loss: 0.4049 -> 0.4130   acc: 86.20% -> 86.20%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4986 -> 0.4955   acc: 82.68% -> 82.68%             
client [7] (test)  loss: 0.0943 -> 0.0930   acc: 97.24% -> 97.42%              
client [57] (test)  loss: 0.0451 -> 0.0454   acc: 99.25% -> 99.25%             
client [13] (test)  loss: 0.0003 -> 0.0003   acc: 100.00% -> 100.00%           
client [43] (test)  loss: 0.4208 -> 0.4221   acc: 89.63% -> 89.63%             
client [91] (test)  loss: 1.0035 -> 0.8715   acc: 78.12% -> 78.12%             
client [10] (test)  loss: 0.0836 -> 0.0806   acc: 95.65% -> 95.65%             
client [64] (test)  loss: 0.2260 -> 0.2266   acc: 95.00% -> 95.00%             
client [82] (test)  loss: 0.2380 -> 0.0970   acc: 98.56% -> 98.40%             
client [22] (test)  loss: 0.1659 -> 0.1626   acc: 94.81% -> 94.81%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0363 -> 0.0359   acc: 98.33% -> 98.33%             
client [23] (test)  loss: 0.1598 -> 0.1582   acc: 95.11% -> 95.11%             
client [88] (test)  loss: 0.4395 -> 0.4471   acc: 85.08% -> 85.08%             
client [98] (test)  loss: 0.4149 -> 0.4214   acc: 85.00% -> 85.00%             
client [79] (test)  loss: 0.5377 -> 0.5449   acc: 85.26% -> 85.26%             
client [21] (test)  loss: 0.2307 -> 0.2265   acc: 90.34% -> 90.58%             
client [92] (test)  loss: 0.2715 -> 0.2698   acc: 92.47% -> 92.47%             
client [56] (test)  loss: 0.4878 -> 0.4961   acc: 86.59% -> 86.59%             
client [5] (test)  loss: 0.0448 -> 0.0448   acc: 98.91% -> 98.91%              
client [52] (test)  loss: 0.3171 -> 0.3105   acc: 86.82% -> 86.82%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1626 -> 0.0000', 'accuracy': '94.71% -> 0.00%'},          
    200: {'loss': '0.1563 -> 0.0000', 'accuracy': '95.48% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(11.19%) at epoch: 0                                     
FedFomo achieved 20.0%(28.29%) at epoch: 1                                     
FedFomo achieved 30.0%(36.50%) at epoch: 2                                     
FedFomo achieved 60.0%(65.27%) at epoch: 4                                     
FedFomo achieved 70.0%(79.44%) at epoch: 7                                     
FedFomo achieved 80.0%(82.29%) at epoch: 18                                    
FedFomo achieved 90.0%(90.04%) at epoch: 24                                    
Convergence (test_after):                                                      
FedFomo achieved 70.0%(77.18%) at epoch: 0                                     
FedFomo achieved 80.0%(87.90%) at epoch: 2                                     
FedFomo achieved 90.0%(93.12%) at epoch: 8                                     
