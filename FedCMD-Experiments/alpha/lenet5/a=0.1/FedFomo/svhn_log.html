==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.4721 -> 0.3582   acc: 75.90% -> 84.75%             
client [81] (test)  loss: 0.6958 -> 0.5403   acc: 91.09% -> 91.09%             
client [21] (test)  loss: 32.8040 -> 2.1489   acc: 2.17% -> 48.91%             
client [68] (test)  loss: 0.9586 -> 0.5191   acc: 93.14% -> 93.14%             
client [93] (test)  loss: 1.3264 -> 1.1223   acc: 49.69% -> 49.28%             
client [31] (test)  loss: 1.7970 -> 1.4207   acc: 53.66% -> 53.66%             
client [20] (test)  loss: 1.0256 -> 0.9975   acc: 69.58% -> 69.58%             
client [59] (test)  loss: 43.2009 -> 1.1636   acc: 1.99% -> 63.18%             
client [48] (test)  loss: 1.8037 -> 1.6442   acc: 38.14% -> 38.14%             
client [34] (test)  loss: 2.0527 -> 1.9108   acc: 36.73% -> 36.73%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.3949 -> 1.3405   acc: 44.92% -> 55.08%             
client [99] (test)  loss: 0.3126 -> 0.2515   acc: 95.40% -> 95.40%             
client [67] (test)  loss: 1.0422 -> 0.9557   acc: 55.02% -> 57.12%             
client [0] (test)  loss: 1.1992 -> 1.1400   acc: 52.57% -> 53.95%              
client [76] (test)  loss: 0.0604 -> 0.0587   acc: 99.28% -> 99.28%             
client [41] (test)  loss: 0.5087 -> 0.4621   acc: 87.72% -> 87.72%             
client [62] (test)  loss: 6.6323 -> 1.4895   acc: 20.80% -> 51.40%             
client [2] (test)  loss: 0.0533 -> 0.0044   acc: 99.96% -> 99.96%              
client [14] (test)  loss: 0.6331 -> 0.6181   acc: 86.96% -> 86.96%             
client [46] (test)  loss: 1.3043 -> 1.2506   acc: 63.33% -> 63.33%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5252 -> 0.5144   acc: 84.43% -> 84.43%             
client [68] (test)  loss: 0.5280 -> 0.5248   acc: 93.14% -> 93.14%             
client [57] (test)  loss: 0.6549 -> 0.4878   acc: 80.80% -> 83.76%             
client [17] (test)  loss: 0.3734 -> 0.3591   acc: 91.83% -> 91.83%             
client [54] (test)  loss: 0.4097 -> 0.4078   acc: 91.94% -> 91.94%             
client [23] (test)  loss: 19.7033 -> 1.2161   acc: 1.91% -> 73.66%             
client [35] (test)  loss: 0.0370 -> 0.0382   acc: 99.62% -> 99.62%             
client [59] (test)  loss: 1.0494 -> 0.9939   acc: 63.18% -> 63.36%             
client [31] (test)  loss: 0.9782 -> 0.9736   acc: 58.54% -> 56.10%             
client [9] (test)  loss: 1.5347 -> 1.4631   acc: 37.26% -> 38.85%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1825 -> 1.1685   acc: 51.66% -> 54.38%             
client [33] (test)  loss: 0.1059 -> 0.1033   acc: 97.12% -> 97.12%             
client [16] (test)  loss: 0.7402 -> 0.6874   acc: 58.38% -> 59.46%             
client [44] (test)  loss: 1.7603 -> 1.2493   acc: 50.41% -> 50.41%             
client [8] (test)  loss: 0.9608 -> 0.9361   acc: 80.77% -> 80.77%              
client [31] (test)  loss: 0.9695 -> 0.9665   acc: 54.88% -> 53.66%             
client [47] (test)  loss: 0.0008 -> 0.0006   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 1.0686 -> 0.8385   acc: 70.83% -> 75.00%             
client [20] (test)  loss: 0.8614 -> 0.8051   acc: 70.72% -> 73.38%             
client [56] (test)  loss: 0.0367 -> 0.0367   acc: 99.63% -> 99.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0397 -> 0.0175   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.3441 -> 0.1075   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.3980 -> 0.4320   acc: 88.33% -> 87.12%             
client [25] (test)  loss: 0.1871 -> 0.1496   acc: 98.32% -> 98.32%             
client [58] (test)  loss: 0.4883 -> 0.7047   acc: 85.53% -> 82.19%             
client [44] (test)  loss: 1.2493 -> 1.1524   acc: 50.41% -> 50.41%             
client [39] (test)  loss: 0.9127 -> 0.8747   acc: 56.62% -> 57.35%             
client [29] (test)  loss: 0.2472 -> 0.2341   acc: 93.21% -> 93.21%             
client [3] (test)  loss: 0.6999 -> 0.5618   acc: 72.50% -> 79.16%              
client [84] (test)  loss: 1.7399 -> 1.9244   acc: 39.73% -> 38.78%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2818 -> 1.1055   acc: 48.91% -> 48.91%             
client [84] (test)  loss: 1.8693 -> 1.6652   acc: 35.55% -> 46.01%             
client [10] (test)  loss: 0.1736 -> 0.1637   acc: 94.26% -> 94.26%             
client [36] (test)  loss: 0.7872 -> 0.7758   acc: 75.00% -> 75.00%             
client [65] (test)  loss: 0.0253 -> 0.0243   acc: 99.66% -> 99.66%             
client [81] (test)  loss: 0.5009 -> 0.4980   acc: 91.09% -> 91.09%             
client [79] (test)  loss: 0.2107 -> 0.2043   acc: 93.53% -> 94.06%             
client [42] (test)  loss: 1.0058 -> 0.9889   acc: 60.00% -> 63.39%             
client [11] (test)  loss: 1.3508 -> 1.3054   acc: 49.72% -> 50.85%             
client [96] (test)  loss: 0.2686 -> 0.2694   acc: 95.62% -> 95.62%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9228 -> 0.9331   acc: 80.77% -> 80.77%              
client [53] (test)  loss: 0.4475 -> 0.3978   acc: 85.66% -> 88.28%             
client [52] (test)  loss: 0.1671 -> 0.1662   acc: 94.49% -> 95.09%             
client [42] (test)  loss: 0.9584 -> 0.8914   acc: 65.08% -> 66.10%             
client [69] (test)  loss: 0.9010 -> 1.0243   acc: 71.19% -> 62.15%             
client [59] (test)  loss: 0.8641 -> 0.8375   acc: 69.86% -> 70.40%             
client [7] (test)  loss: 0.0566 -> 0.0488   acc: 99.04% -> 99.04%              
client [26] (test)  loss: 0.3177 -> 0.3137   acc: 92.92% -> 92.92%             
client [49] (test)  loss: 0.4827 -> 0.4744   acc: 87.70% -> 87.70%             
client [98] (test)  loss: 0.4970 -> 0.4433   acc: 88.57% -> 89.34%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4433 -> 0.3928   acc: 89.34% -> 89.73%             
client [47] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [21] (test)  loss: 1.0569 -> 1.0334   acc: 48.91% -> 48.91%             
client [77] (test)  loss: 0.1891 -> 0.1921   acc: 92.62% -> 93.11%             
client [95] (test)  loss: 0.3512 -> 0.3475   acc: 87.33% -> 87.78%             
client [91] (test)  loss: 1.0174 -> 0.9648   acc: 64.49% -> 70.50%             
client [14] (test)  loss: 0.6413 -> 0.6531   acc: 86.96% -> 86.96%             
client [99] (test)  loss: 0.2289 -> 0.2270   acc: 95.40% -> 95.40%             
client [20] (test)  loss: 0.7910 -> 0.7587   acc: 74.33% -> 76.05%             
client [39] (test)  loss: 0.8362 -> 0.8097   acc: 72.06% -> 71.32%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1662 -> 0.1722   acc: 95.09% -> 94.75%             
client [62] (test)  loss: 0.8389 -> 0.8222   acc: 74.60% -> 75.20%             
client [71] (test)  loss: 0.6389 -> 0.5564   acc: 78.59% -> 80.87%             
client [97] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 0.3847 -> 0.3798   acc: 92.25% -> 92.25%             
client [88] (test)  loss: 0.1035 -> 0.1017   acc: 97.26% -> 97.26%             
client [60] (test)  loss: 0.0035 -> 0.0098   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 1.5319 -> 1.5007   acc: 51.22% -> 51.22%             
client [91] (test)  loss: 0.9489 -> 0.9235   acc: 72.58% -> 72.58%             
client [57] (test)  loss: 0.4375 -> 0.4607   acc: 84.62% -> 84.34%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.8663 -> 0.8457   acc: 67.07% -> 70.73%             
client [15] (test)  loss: 0.2467 -> 0.2508   acc: 92.47% -> 92.89%             
client [71] (test)  loss: 0.5564 -> 0.5344   acc: 80.87% -> 80.41%             
client [97] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.3185 -> 0.3218   acc: 90.91% -> 91.11%             
client [77] (test)  loss: 0.1921 -> 0.1950   acc: 93.11% -> 93.28%             
client [76] (test)  loss: 0.0567 -> 0.0568   acc: 99.28% -> 99.28%             
client [79] (test)  loss: 0.2052 -> 0.2044   acc: 94.48% -> 94.54%             
client [28] (test)  loss: 0.3697 -> 0.3932   acc: 88.73% -> 87.93%             
client [99] (test)  loss: 0.2250 -> 0.2218   acc: 95.40% -> 95.40%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 0.4427 -> 0.4391   acc: 85.39% -> 85.39%             
client [34] (test)  loss: 1.8420 -> 1.6599   acc: 42.86% -> 46.94%             
client [73] (test)  loss: 0.0320 -> 0.0323   acc: 99.56% -> 99.56%             
client [5] (test)  loss: 0.8448 -> 0.8234   acc: 73.42% -> 73.42%              
client [96] (test)  loss: 0.2821 -> 0.2610   acc: 95.62% -> 95.62%             
client [22] (test)  loss: 1.1791 -> 1.1741   acc: 48.65% -> 51.35%             
client [60] (test)  loss: 0.0126 -> 0.0112   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.9682 -> 0.8591   acc: 68.94% -> 72.01%             
client [83] (test)  loss: 1.3195 -> 1.2672   acc: 62.50% -> 60.00%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0574 -> 0.0578   acc: 99.28% -> 99.28%             
client [65] (test)  loss: 0.0238 -> 0.0231   acc: 99.66% -> 99.66%             
client [95] (test)  loss: 0.3497 -> 0.3612   acc: 89.14% -> 90.50%             
client [17] (test)  loss: 0.3604 -> 0.3602   acc: 91.83% -> 91.83%             
client [8] (test)  loss: 0.9739 -> 0.8156   acc: 73.08% -> 80.77%              
client [35] (test)  loss: 0.0236 -> 0.0240   acc: 99.62% -> 99.62%             
client [98] (test)  loss: 0.4043 -> 0.4003   acc: 88.57% -> 88.95%             
client [53] (test)  loss: 0.3061 -> 0.3024   acc: 91.52% -> 92.73%             
client [43] (test)  loss: 0.1564 -> 0.1612   acc: 94.51% -> 95.05%             
client [64] (test)  loss: 0.6286 -> 0.5969   acc: 82.48% -> 82.78%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.0436 -> 1.0414   acc: 48.91% -> 51.09%             
client [88] (test)  loss: 0.0856 -> 0.0829   acc: 97.53% -> 97.81%             
client [38] (test)  loss: 0.0006 -> 0.0005   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.4420 -> 0.4218   acc: 86.34% -> 87.57%              
client [5] (test)  loss: 0.7816 -> 0.8125   acc: 74.05% -> 74.05%              
client [41] (test)  loss: 0.3626 -> 0.3495   acc: 88.91% -> 89.11%             
client [7] (test)  loss: 0.0415 -> 0.0392   acc: 99.04% -> 99.04%              
client [37] (test)  loss: 0.0281 -> 0.0281   acc: 99.64% -> 99.64%             
client [45] (test)  loss: 0.3589 -> 0.3595   acc: 93.64% -> 93.64%             
client [47] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2632 -> 0.2547   acc: 88.65% -> 89.73%             
client [11] (test)  loss: 1.0825 -> 0.9775   acc: 66.67% -> 69.49%             
client [37] (test)  loss: 0.0277 -> 0.0275   acc: 99.64% -> 99.64%             
client [41] (test)  loss: 0.3495 -> 0.3343   acc: 89.11% -> 89.70%             
client [95] (test)  loss: 0.3870 -> 0.3926   acc: 89.59% -> 89.59%             
client [53] (test)  loss: 0.3024 -> 0.3000   acc: 92.73% -> 93.54%             
client [22] (test)  loss: 1.1542 -> 1.1344   acc: 51.35% -> 51.35%             
client [25] (test)  loss: 0.0954 -> 0.0930   acc: 98.32% -> 98.32%             
client [69] (test)  loss: 0.8133 -> 0.7966   acc: 75.14% -> 74.29%             
client [46] (test)  loss: 1.2500 -> 1.2735   acc: 63.33% -> 63.33%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [69] (test)  loss: 0.8335 -> 0.9123   acc: 72.88% -> 68.64%             
client [82] (test)  loss: 1.3899 -> 1.5664   acc: 51.22% -> 51.22%             
client [45] (test)  loss: 0.3629 -> 0.3658   acc: 93.64% -> 93.64%             
client [7] (test)  loss: 0.1424 -> 0.0557   acc: 99.04% -> 98.88%              
client [50] (test)  loss: 1.0740 -> 1.0586   acc: 64.71% -> 64.71%             
client [35] (test)  loss: 0.0249 -> 0.0235   acc: 99.62% -> 99.62%             
client [24] (test)  loss: 0.3737 -> 0.3834   acc: 90.47% -> 90.34%             
client [15] (test)  loss: 0.2546 -> 0.2594   acc: 93.87% -> 93.87%             
client [58] (test)  loss: 0.3946 -> 0.5845   acc: 91.57% -> 89.98%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.4480 -> 1.3169   acc: 57.73% -> 60.82%             
client [76] (test)  loss: 0.0586 -> 0.0591   acc: 99.28% -> 99.28%             
client [67] (test)  loss: 0.4979 -> 0.5100   acc: 84.79% -> 84.79%             
client [37] (test)  loss: 0.0275 -> 0.0275   acc: 99.64% -> 99.64%             
client [58] (test)  loss: 0.4159 -> 0.4491   acc: 91.89% -> 91.89%             
client [64] (test)  loss: 0.5813 -> 0.6294   acc: 83.69% -> 80.66%             
client [77] (test)  loss: 0.2109 -> 0.2139   acc: 93.11% -> 93.11%             
client [55] (test)  loss: 0.0530 -> 0.0526   acc: 98.99% -> 98.99%             
client [12] (test)  loss: 0.4471 -> 0.4467   acc: 93.75% -> 93.75%             
client [89] (test)  loss: 0.2236 -> 0.2266   acc: 93.11% -> 93.29%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.3378 -> 1.3687   acc: 70.15% -> 69.58%             
client [51] (test)  loss: 0.4476 -> 0.4602   acc: 89.07% -> 89.24%             
client [8] (test)  loss: 0.6465 -> 0.6311   acc: 82.69% -> 82.69%              
client [18] (test)  loss: 0.5802 -> 0.5825   acc: 86.14% -> 86.43%             
client [94] (test)  loss: 0.1544 -> 0.1530   acc: 94.74% -> 95.04%             
client [81] (test)  loss: 0.4798 -> 0.5008   acc: 90.10% -> 90.10%             
client [3] (test)  loss: 0.4031 -> 0.4031   acc: 88.62% -> 88.62%              
client [11] (test)  loss: 0.9675 -> 0.9090   acc: 69.49% -> 70.62%             
client [95] (test)  loss: 0.4287 -> 0.4260   acc: 89.59% -> 89.59%             
client [67] (test)  loss: 0.5100 -> 0.5160   acc: 84.79% -> 85.76%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1172 -> 1.0880   acc: 51.09% -> 53.26%             
client [79] (test)  loss: 0.2972 -> 0.3029   acc: 95.44% -> 95.32%             
client [58] (test)  loss: 0.4349 -> 0.5199   acc: 91.73% -> 91.10%             
client [88] (test)  loss: 0.0828 -> 0.0836   acc: 97.94% -> 98.08%             
client [46] (test)  loss: 1.2754 -> 1.2808   acc: 65.00% -> 65.00%             
client [11] (test)  loss: 0.9090 -> 0.8922   acc: 70.62% -> 72.88%             
client [55] (test)  loss: 0.0536 -> 0.0542   acc: 98.99% -> 98.99%             
client [13] (test)  loss: 0.3234 -> 0.3382   acc: 92.77% -> 92.59%             
client [31] (test)  loss: 0.8140 -> 0.7965   acc: 69.51% -> 73.17%             
client [75] (test)  loss: 0.5948 -> 0.5770   acc: 82.27% -> 82.55%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4016 -> 0.4076   acc: 88.30% -> 88.83%             
client [7] (test)  loss: 0.1795 -> 0.1305   acc: 98.88% -> 98.40%              
client [57] (test)  loss: 0.6306 -> 0.6275   acc: 84.81% -> 85.77%             
client [13] (test)  loss: 0.3443 -> 0.3514   acc: 92.77% -> 92.77%             
client [43] (test)  loss: 0.2164 -> 0.2229   acc: 94.32% -> 94.87%             
client [91] (test)  loss: 0.8628 -> 0.8472   acc: 74.41% -> 75.46%             
client [10] (test)  loss: 0.1056 -> 0.1070   acc: 96.70% -> 96.70%             
client [64] (test)  loss: 0.7905 -> 0.7616   acc: 77.95% -> 80.06%             
client [82] (test)  loss: 1.5065 -> 1.3146   acc: 51.22% -> 51.22%             
client [22] (test)  loss: 1.1189 -> 1.0760   acc: 54.05% -> 54.05%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0587 -> 1.0080   acc: 72.62% -> 74.14%             
client [23] (test)  loss: 0.6553 -> 0.6374   acc: 77.48% -> 78.63%             
client [88] (test)  loss: 0.0836 -> 0.0875   acc: 98.08% -> 98.08%             
client [98] (test)  loss: 0.4318 -> 0.4455   acc: 90.12% -> 90.12%             
client [79] (test)  loss: 0.3315 -> 0.3301   acc: 95.32% -> 95.44%             
client [21] (test)  loss: 0.9683 -> 1.1969   acc: 57.61% -> 51.09%             
client [92] (test)  loss: 0.7753 -> 0.8000   acc: 77.58% -> 77.32%             
client [56] (test)  loss: 0.0481 -> 0.0500   acc: 99.63% -> 99.63%             
client [5] (test)  loss: 0.7531 -> 0.6843   acc: 77.22% -> 77.85%              
client [52] (test)  loss: 0.2105 -> 0.2114   acc: 94.49% -> 94.58%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.3597 -> 0.0000', 'accuracy': '88.55% -> 0.00%'},          
    200: {'loss': '0.3679 -> 0.0000', 'accuracy': '90.49% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 10.0%(10.14%) at epoch: 0                                     
FedFomo achieved 20.0%(27.89%) at epoch: 1                                     
FedFomo achieved 40.0%(45.76%) at epoch: 3                                     
FedFomo achieved 60.0%(67.67%) at epoch: 4                                     
FedFomo achieved 80.0%(82.08%) at epoch: 7                                     
FedFomo achieved 90.0%(90.88%) at epoch: 46                                    
Convergence (test_after):                                                      
FedFomo achieved 80.0%(83.35%) at epoch: 0                                     
FedFomo achieved 90.0%(90.92%) at epoch: 7                                     
