==================== ALGORITHM: FedFomo ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.0055 -> 0.0031   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 1.3768 -> 0.7536   acc: 91.18% -> 91.18%             
client [21] (test)  loss: 5.4115 -> 0.0434   acc: 19.43% -> 99.35%             
client [68] (test)  loss: 1.9616 -> 1.4898   acc: 49.67% -> 49.67%             
client [93] (test)  loss: 0.9750 -> 0.5796   acc: 62.95% -> 80.00%             
client [31] (test)  loss: 1.0864 -> 0.8343   acc: 65.14% -> 65.14%             
client [20] (test)  loss: 0.4974 -> 0.4352   acc: 86.11% -> 86.11%             
client [59] (test)  loss: 13.4744 -> 0.9036   acc: 7.07% -> 70.49%             
client [48] (test)  loss: 0.9341 -> 0.7462   acc: 77.91% -> 79.07%             
client [34] (test)  loss: 0.6074 -> 0.4277   acc: 83.33% -> 83.33%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5472 -> 0.3890   acc: 81.11% -> 89.44%             
client [99] (test)  loss: 0.0735 -> 0.0735   acc: 98.95% -> 98.95%             
client [67] (test)  loss: 1.3402 -> 1.0981   acc: 52.21% -> 75.22%             
client [0] (test)  loss: 0.0726 -> 0.0650   acc: 98.84% -> 98.84%              
client [76] (test)  loss: 0.7231 -> 0.4607   acc: 94.44% -> 94.44%             
client [41] (test)  loss: 0.3488 -> 0.2804   acc: 90.59% -> 90.59%             
client [62] (test)  loss: 19.1792 -> 1.2150   acc: 2.80% -> 55.18%             
client [2] (test)  loss: 39.7876 -> 0.3323   acc: 1.16% -> 94.96%              
client [14] (test)  loss: 0.4616 -> 0.3505   acc: 79.10% -> 84.43%             
client [46] (test)  loss: 0.4741 -> 0.3908   acc: 85.26% -> 88.44%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0069 -> 0.8378   acc: 68.00% -> 68.00%             
client [68] (test)  loss: 1.1165 -> 1.0098   acc: 59.48% -> 67.97%             
client [57] (test)  loss: 0.2001 -> 0.1428   acc: 96.91% -> 98.46%             
client [17] (test)  loss: 0.4829 -> 0.4934   acc: 91.11% -> 91.11%             
client [54] (test)  loss: 0.3416 -> 0.3169   acc: 87.68% -> 88.41%             
client [23] (test)  loss: 14.8730 -> 2.0219   acc: 12.31% -> 43.08%            
client [35] (test)  loss: 0.8558 -> 0.7420   acc: 77.92% -> 83.12%             
client [59] (test)  loss: 0.2436 -> 0.1457   acc: 94.63% -> 97.80%             
client [31] (test)  loss: 0.4348 -> 0.3863   acc: 90.37% -> 91.74%             
client [9] (test)  loss: 0.3133 -> 0.2530   acc: 92.31% -> 95.43%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.0007 -> 0.0005   acc: 100.00% -> 100.00%           
client [33] (test)  loss: 0.0933 -> 0.0854   acc: 97.94% -> 97.59%             
client [16] (test)  loss: 0.1514 -> 0.1260   acc: 97.27% -> 98.09%             
client [44] (test)  loss: 0.0088 -> 0.0032   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.4365 -> 0.4089   acc: 88.20% -> 88.20%              
client [31] (test)  loss: 0.3465 -> 0.3151   acc: 92.20% -> 92.20%             
client [47] (test)  loss: 0.0119 -> 0.0087   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 0.0017 -> 0.0049   acc: 100.00% -> 100.00%           
client [20] (test)  loss: 0.3522 -> 0.3434   acc: 86.11% -> 86.11%             
client [56] (test)  loss: 0.1776 -> 0.1410   acc: 93.75% -> 93.75%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0057 -> 0.0051   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.0036 -> 0.0020   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.2797 -> 0.2388   acc: 86.90% -> 86.90%             
client [25] (test)  loss: 0.3792 -> 0.3081   acc: 89.09% -> 90.02%             
client [58] (test)  loss: 0.3038 -> 0.2865   acc: 89.92% -> 90.20%             
client [44] (test)  loss: 0.0032 -> 0.0019   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 0.6968 -> 0.5297   acc: 83.63% -> 87.61%             
client [29] (test)  loss: 0.0931 -> 0.0801   acc: 98.31% -> 98.79%             
client [3] (test)  loss: 0.0022 -> 0.0017   acc: 100.00% -> 100.00%            
client [84] (test)  loss: 0.0072 -> 0.0063   acc: 99.79% -> 99.79%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.0332 -> 0.0302   acc: 99.35% -> 99.35%             
client [84] (test)  loss: 0.0057 -> 0.0052   acc: 99.79% -> 99.79%             
client [10] (test)  loss: 0.5489 -> 0.5270   acc: 78.67% -> 78.67%             
client [36] (test)  loss: 0.0027 -> 0.0018   acc: 100.00% -> 100.00%           
client [65] (test)  loss: 0.1432 -> 0.1322   acc: 97.74% -> 97.74%             
client [81] (test)  loss: 0.2176 -> 0.2037   acc: 97.06% -> 97.06%             
client [79] (test)  loss: 0.2170 -> 0.1994   acc: 94.26% -> 94.51%             
client [42] (test)  loss: 0.7909 -> 0.7059   acc: 69.77% -> 73.26%             
client [11] (test)  loss: 0.2912 -> 0.2500   acc: 94.12% -> 94.12%             
client [96] (test)  loss: 0.2428 -> 0.2170   acc: 95.42% -> 95.42%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3731 -> 0.3602   acc: 88.76% -> 89.33%              
client [53] (test)  loss: 0.7376 -> 0.6028   acc: 76.08% -> 82.78%             
client [52] (test)  loss: 0.3944 -> 0.3458   acc: 85.71% -> 85.71%             
client [42] (test)  loss: 0.6347 -> 0.5734   acc: 73.26% -> 75.58%             
client [69] (test)  loss: 0.1294 -> 0.1200   acc: 96.67% -> 96.94%             
client [59] (test)  loss: 0.0673 -> 0.0598   acc: 99.02% -> 99.27%             
client [7] (test)  loss: 0.0599 -> 0.0503   acc: 98.47% -> 98.61%              
client [26] (test)  loss: 0.1635 -> 0.1386   acc: 94.99% -> 95.70%             
client [49] (test)  loss: 0.1795 -> 0.1775   acc: 96.37% -> 96.09%             
client [98] (test)  loss: 1.0035 -> 0.9937   acc: 79.41% -> 79.41%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.2462 -> 0.8967   acc: 29.41% -> 76.47%             
client [47] (test)  loss: 0.0071 -> 0.0062   acc: 100.00% -> 100.00%           
client [21] (test)  loss: 0.0280 -> 0.0262   acc: 99.35% -> 99.35%             
client [77] (test)  loss: 0.0008 -> 0.0007   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.0625 -> 0.0601   acc: 98.33% -> 98.33%             
client [91] (test)  loss: 0.5389 -> 0.5170   acc: 87.39% -> 87.39%             
client [14] (test)  loss: 0.1515 -> 0.1407   acc: 95.08% -> 95.49%             
client [99] (test)  loss: 0.0548 -> 0.0514   acc: 99.08% -> 99.08%             
client [20] (test)  loss: 0.2460 -> 0.2458   acc: 97.22% -> 97.22%             
client [39] (test)  loss: 0.3837 -> 0.3476   acc: 91.15% -> 91.15%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3458 -> 0.3101   acc: 85.71% -> 85.71%             
client [62] (test)  loss: 0.2018 -> 0.1964   acc: 94.40% -> 94.96%             
client [71] (test)  loss: 0.1170 -> 0.1126   acc: 96.60% -> 96.47%             
client [97] (test)  loss: 0.0665 -> 0.0479   acc: 98.39% -> 98.39%             
client [30] (test)  loss: 0.1566 -> 0.1537   acc: 95.31% -> 95.31%             
client [88] (test)  loss: 0.1745 -> 0.1505   acc: 93.97% -> 95.07%             
client [60] (test)  loss: 0.0006 -> 0.0005   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.2992 -> 0.2992   acc: 95.10% -> 95.10%             
client [91] (test)  loss: 0.4987 -> 0.4833   acc: 87.39% -> 88.24%             
client [57] (test)  loss: 0.1261 -> 0.1263   acc: 98.77% -> 98.92%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2060 -> 0.2034   acc: 92.20% -> 92.20%             
client [15] (test)  loss: 0.4809 -> 0.3066   acc: 85.71% -> 90.48%             
client [71] (test)  loss: 0.1126 -> 0.1089   acc: 96.47% -> 96.47%             
client [97] (test)  loss: 0.0323 -> 0.0281   acc: 98.93% -> 99.20%             
client [53] (test)  loss: 0.3698 -> 0.3294   acc: 92.82% -> 93.30%             
client [77] (test)  loss: 0.0007 -> 0.0006   acc: 100.00% -> 100.00%           
client [76] (test)  loss: 0.2468 -> 0.2514   acc: 94.44% -> 94.44%             
client [79] (test)  loss: 0.1790 -> 0.1732   acc: 95.26% -> 95.01%             
client [28] (test)  loss: 0.1233 -> 0.1267   acc: 97.62% -> 97.62%             
client [99] (test)  loss: 0.0491 -> 0.0475   acc: 99.08% -> 99.08%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0251 -> 0.0229   acc: 99.20% -> 99.20%             
client [86] (test)  loss: 0.0319 -> 0.0296   acc: 100.00% -> 100.00%           
client [34] (test)  loss: 0.0660 -> 0.0651   acc: 99.51% -> 99.51%             
client [73] (test)  loss: 0.2026 -> 0.1965   acc: 96.06% -> 96.06%             
client [5] (test)  loss: 0.2840 -> 0.2675   acc: 91.16% -> 92.09%              
client [96] (test)  loss: 0.1366 -> 0.1324   acc: 95.70% -> 95.70%             
client [22] (test)  loss: 0.0156 -> 0.0144   acc: 99.56% -> 99.56%             
client [60] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 0.7556 -> 0.7275   acc: 79.17% -> 81.25%             
client [83] (test)  loss: 0.2316 -> 0.2228   acc: 91.88% -> 92.39%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4114 -> 0.4010   acc: 94.44% -> 94.44%             
client [65] (test)  loss: 0.1167 -> 0.1117   acc: 98.31% -> 98.31%             
client [95] (test)  loss: 0.0547 -> 0.0534   acc: 98.33% -> 98.33%             
client [17] (test)  loss: 0.7199 -> 0.6798   acc: 91.11% -> 91.11%             
client [8] (test)  loss: 0.3321 -> 0.3247   acc: 89.89% -> 90.17%              
client [35] (test)  loss: 0.4023 -> 0.3955   acc: 87.01% -> 87.01%             
client [98] (test)  loss: 0.6117 -> 0.5912   acc: 79.41% -> 79.41%             
client [53] (test)  loss: 0.3009 -> 0.2810   acc: 93.78% -> 93.78%             
client [43] (test)  loss: 0.1823 -> 0.1727   acc: 93.55% -> 94.93%             
client [64] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.0247 -> 0.0234   acc: 99.35% -> 99.35%             
client [88] (test)  loss: 0.0985 -> 0.0952   acc: 96.44% -> 97.26%             
client [38] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [3] (test)  loss: 0.0004 -> 0.0004   acc: 100.00% -> 100.00%            
client [5] (test)  loss: 0.2540 -> 0.2424   acc: 93.02% -> 93.02%              
client [41] (test)  loss: 0.0951 -> 0.0912   acc: 96.00% -> 96.00%             
client [7] (test)  loss: 0.0378 -> 0.0336   acc: 99.03% -> 99.03%              
client [37] (test)  loss: 0.6401 -> 0.6174   acc: 80.26% -> 81.58%             
client [45] (test)  loss: 0.0407 -> 0.0370   acc: 98.35% -> 98.35%             
client [47] (test)  loss: 0.0051 -> 0.0047   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.0994 -> 0.0993   acc: 98.63% -> 98.63%             
client [11] (test)  loss: 0.1793 -> 0.1776   acc: 95.72% -> 95.72%             
client [37] (test)  loss: 0.5824 -> 0.5687   acc: 82.89% -> 85.53%             
client [41] (test)  loss: 0.0912 -> 0.0878   acc: 96.00% -> 96.47%             
client [95] (test)  loss: 0.0498 -> 0.0488   acc: 98.33% -> 98.33%             
client [53] (test)  loss: 0.2810 -> 0.2664   acc: 93.78% -> 93.78%             
client [22] (test)  loss: 0.0135 -> 0.0128   acc: 99.56% -> 99.71%             
client [25] (test)  loss: 0.1584 -> 0.1502   acc: 95.01% -> 95.19%             
client [69] (test)  loss: 0.0774 -> 0.0746   acc: 97.50% -> 97.78%             
client [46] (test)  loss: 0.2087 -> 0.1937   acc: 93.06% -> 93.35%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0038 -> 0.0036   acc: 100.00% -> 100.00%           
client [69] (test)  loss: 0.0722 -> 0.0700   acc: 97.78% -> 98.06%             
client [82] (test)  loss: 0.3011 -> 0.3018   acc: 95.10% -> 95.10%             
client [45] (test)  loss: 0.0319 -> 0.0301   acc: 98.35% -> 98.35%             
client [7] (test)  loss: 0.0336 -> 0.0304   acc: 99.03% -> 99.03%              
client [50] (test)  loss: 0.2132 -> 0.1957   acc: 89.10% -> 90.98%             
client [35] (test)  loss: 0.3842 -> 0.3793   acc: 87.01% -> 87.01%             
client [24] (test)  loss: 0.4499 -> 0.4425   acc: 90.00% -> 90.00%             
client [15] (test)  loss: 0.1752 -> 0.1026   acc: 95.24% -> 95.24%             
client [58] (test)  loss: 0.2023 -> 0.2005   acc: 94.40% -> 94.68%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3444 -> 0.3388   acc: 89.92% -> 89.92%             
client [76] (test)  loss: 0.3946 -> 0.3943   acc: 94.44% -> 94.44%             
client [67] (test)  loss: 0.3308 -> 0.3138   acc: 88.94% -> 89.38%             
client [37] (test)  loss: 0.5580 -> 0.5498   acc: 86.84% -> 86.84%             
client [58] (test)  loss: 0.1990 -> 0.1977   acc: 94.68% -> 94.68%             
client [64] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [77] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [55] (test)  loss: 0.1694 -> 0.1636   acc: 94.47% -> 94.47%             
client [12] (test)  loss: 0.3833 -> 0.3649   acc: 92.47% -> 92.47%             
client [89] (test)  loss: 0.1171 -> 0.1174   acc: 96.58% -> 96.58%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0027 -> 0.0027   acc: 100.00% -> 100.00%           
client [51] (test)  loss: 0.1063 -> 0.1056   acc: 96.92% -> 96.92%             
client [8] (test)  loss: 0.2961 -> 0.2930   acc: 90.45% -> 90.45%              
client [18] (test)  loss: 0.3182 -> 0.3192   acc: 93.18% -> 93.18%             
client [94] (test)  loss: 0.2690 -> 0.2617   acc: 92.24% -> 92.65%             
client [81] (test)  loss: 0.1677 -> 0.1669   acc: 97.06% -> 97.06%             
client [3] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [11] (test)  loss: 0.1747 -> 0.1743   acc: 95.72% -> 95.72%             
client [95] (test)  loss: 0.0436 -> 0.0428   acc: 98.33% -> 98.49%             
client [67] (test)  loss: 0.3138 -> 0.2992   acc: 89.38% -> 89.38%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0215 -> 0.0208   acc: 99.35% -> 99.35%             
client [79] (test)  loss: 0.1584 -> 0.1585   acc: 95.26% -> 95.26%             
client [58] (test)  loss: 0.1951 -> 0.1945   acc: 94.68% -> 94.96%             
client [88] (test)  loss: 0.0886 -> 0.0871   acc: 96.99% -> 96.99%             
client [46] (test)  loss: 0.1606 -> 0.1530   acc: 95.09% -> 95.66%             
client [11] (test)  loss: 0.1743 -> 0.1741   acc: 95.72% -> 95.72%             
client [55] (test)  loss: 0.1477 -> 0.1468   acc: 94.97% -> 95.23%             
client [13] (test)  loss: 0.1162 -> 0.1149   acc: 96.12% -> 96.12%             
client [31] (test)  loss: 0.1971 -> 0.1955   acc: 92.20% -> 92.20%             
client [75] (test)  loss: 0.2109 -> 0.2047   acc: 93.63% -> 93.63%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0872 -> 0.0866   acc: 97.64% -> 97.64%             
client [7] (test)  loss: 0.0215 -> 0.0206   acc: 99.31% -> 99.31%              
client [57] (test)  loss: 0.1142 -> 0.1146   acc: 98.92% -> 98.92%             
client [13] (test)  loss: 0.1138 -> 0.1127   acc: 96.12% -> 96.12%             
client [43] (test)  loss: 0.1480 -> 0.1466   acc: 95.39% -> 95.39%             
client [91] (test)  loss: 0.4399 -> 0.4317   acc: 89.08% -> 89.08%             
client [10] (test)  loss: 0.1628 -> 0.1606   acc: 94.67% -> 94.67%             
client [64] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [82] (test)  loss: 0.3069 -> 0.3077   acc: 95.10% -> 95.10%             
client [22] (test)  loss: 0.0109 -> 0.0107   acc: 99.71% -> 99.71%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2464 -> 0.2468   acc: 97.22% -> 97.22%             
client [23] (test)  loss: 0.6843 -> 0.3259   acc: 86.15% -> 87.69%             
client [88] (test)  loss: 0.0871 -> 0.0858   acc: 96.99% -> 96.71%             
client [98] (test)  loss: 0.5354 -> 0.5329   acc: 85.29% -> 85.29%             
client [79] (test)  loss: 0.1591 -> 0.1597   acc: 95.26% -> 95.26%             
client [21] (test)  loss: 0.0201 -> 0.0196   acc: 99.35% -> 99.35%             
client [92] (test)  loss: 0.0998 -> 0.1001   acc: 97.87% -> 97.87%             
client [56] (test)  loss: 0.0557 -> 0.0554   acc: 98.44% -> 98.44%             
client [5] (test)  loss: 0.1944 -> 0.1905   acc: 93.49% -> 93.49%              
client [52] (test)  loss: 0.1523 -> 0.1477   acc: 96.10% -> 96.10%             
==================== FedFomo TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '0.1358 -> 0.0000', 'accuracy': '96.13% -> 0.00%'},          
    200: {'loss': '0.1040 -> 0.0000', 'accuracy': '97.15% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo achieved 30.0%(31.83%) at epoch: 1                                     
FedFomo achieved 40.0%(43.89%) at epoch: 3                                     
FedFomo achieved 50.0%(51.23%) at epoch: 6                                     
FedFomo achieved 70.0%(75.43%) at epoch: 7                                     
FedFomo achieved 80.0%(85.15%) at epoch: 13                                    
FedFomo achieved 90.0%(92.26%) at epoch: 24                                    
Convergence (test_after):                                                      
FedFomo achieved 70.0%(75.76%) at epoch: 0                                     
FedFomo achieved 80.0%(85.98%) at epoch: 1                                     
FedFomo achieved 90.0%(91.26%) at epoch: 10                                    
