==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7276 -> 0.5795   acc: 77.90% -> 81.91%             
client [81] (test)  loss: 1.1510 -> 0.9103   acc: 71.27% -> 75.69%             
client [21] (test)  loss: 29.5112 -> 1.8542   acc: 0.20% -> 54.00%             
client [68] (test)  loss: 1.6212 -> 0.9518   acc: 61.91% -> 74.35%             
client [93] (test)  loss: 2.0035 -> 1.2914   acc: 51.71% -> 66.13%             
client [31] (test)  loss: 1.6306 -> 1.0996   acc: 59.98% -> 69.60%             
client [20] (test)  loss: 0.9588 -> 0.7264   acc: 73.81% -> 79.32%             
client [59] (test)  loss: 24.9952 -> 1.2778   acc: 0.32% -> 68.74%             
client [48] (test)  loss: 1.0206 -> 0.9199   acc: 71.64% -> 72.72%             
client [34] (test)  loss: 1.7292 -> 1.0602   acc: 58.12% -> 71.05%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6119 -> 0.4897   acc: 83.82% -> 86.48%             
client [99] (test)  loss: 1.8355 -> 1.2048   acc: 54.62% -> 67.33%             
client [67] (test)  loss: 1.1393 -> 0.6832   acc: 71.08% -> 81.08%             
client [0] (test)  loss: 1.1633 -> 0.9385   acc: 68.42% -> 72.39%              
client [76] (test)  loss: 1.1533 -> 0.9591   acc: 68.30% -> 71.69%             
client [41] (test)  loss: 1.8543 -> 1.2276   acc: 52.59% -> 62.38%             
client [62] (test)  loss: 27.0020 -> 1.6705   acc: 1.24% -> 62.08%             
client [2] (test)  loss: 30.1756 -> 2.0623   acc: 1.29% -> 53.84%              
client [14] (test)  loss: 0.9703 -> 0.8590   acc: 69.81% -> 72.65%             
client [46] (test)  loss: 0.9286 -> 0.8200   acc: 76.79% -> 78.61%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8782 -> 0.7823   acc: 71.40% -> 74.22%             
client [68] (test)  loss: 0.6185 -> 0.6014   acc: 82.05% -> 82.48%             
client [57] (test)  loss: 0.7852 -> 0.6020   acc: 78.14% -> 82.03%             
client [17] (test)  loss: 0.7269 -> 0.6733   acc: 79.24% -> 79.98%             
client [54] (test)  loss: 0.4771 -> 0.4674   acc: 84.70% -> 85.14%             
client [23] (test)  loss: 28.0320 -> 2.1839   acc: 0.73% -> 52.45%             
client [35] (test)  loss: 0.9774 -> 0.9096   acc: 72.11% -> 73.58%             
client [59] (test)  loss: 0.6121 -> 0.5317   acc: 83.17% -> 84.76%             
client [31] (test)  loss: 0.7515 -> 0.7568   acc: 77.66% -> 78.07%             
client [9] (test)  loss: 1.1306 -> 1.0366   acc: 67.69% -> 70.31%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7982 -> 0.7367   acc: 76.08% -> 77.71%             
client [33] (test)  loss: 0.7860 -> 0.8137   acc: 76.93% -> 76.77%             
client [16] (test)  loss: 1.0781 -> 0.9211   acc: 70.11% -> 73.40%             
client [44] (test)  loss: 2.1554 -> 1.4045   acc: 45.88% -> 60.04%             
client [8] (test)  loss: 0.6749 -> 0.6799   acc: 79.79% -> 80.13%              
client [31] (test)  loss: 0.7689 -> 0.7899   acc: 78.22% -> 77.88%             
client [47] (test)  loss: 0.5033 -> 0.4469   acc: 84.59% -> 85.57%             
client [36] (test)  loss: 0.9091 -> 0.5722   acc: 75.12% -> 83.71%             
client [20] (test)  loss: 0.6037 -> 0.6001   acc: 82.48% -> 82.53%             
client [56] (test)  loss: 0.9395 -> 0.7390   acc: 72.08% -> 76.79%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7359 -> 0.6840   acc: 78.72% -> 80.09%              
client [60] (test)  loss: 0.7228 -> 0.5898   acc: 78.00% -> 80.91%             
client [28] (test)  loss: 0.5099 -> 0.5082   acc: 85.92% -> 85.92%             
client [25] (test)  loss: 0.5348 -> 0.4629   acc: 85.17% -> 86.73%             
client [58] (test)  loss: 0.5401 -> 0.5462   acc: 84.93% -> 85.12%             
client [44] (test)  loss: 1.4045 -> 1.1353   acc: 60.04% -> 64.73%             
client [39] (test)  loss: 0.8810 -> 0.7775   acc: 73.43% -> 75.35%             
client [29] (test)  loss: 0.6846 -> 0.6786   acc: 80.37% -> 80.98%             
client [3] (test)  loss: 0.6240 -> 0.5820   acc: 81.14% -> 82.42%              
client [84] (test)  loss: 0.8544 -> 0.8458   acc: 76.61% -> 76.67%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8951 -> 0.8127   acc: 72.90% -> 74.74%             
client [84] (test)  loss: 0.8481 -> 0.8542   acc: 76.90% -> 76.93%             
client [10] (test)  loss: 0.6661 -> 0.6595   acc: 80.87% -> 81.13%             
client [36] (test)  loss: 0.3423 -> 0.3071   acc: 90.15% -> 90.78%             
client [65] (test)  loss: 0.4780 -> 0.4749   acc: 86.26% -> 86.53%             
client [81] (test)  loss: 0.7212 -> 0.7224   acc: 80.02% -> 80.39%             
client [79] (test)  loss: 0.4289 -> 0.4070   acc: 86.79% -> 87.31%             
client [42] (test)  loss: 0.6653 -> 0.6674   acc: 81.18% -> 81.35%             
client [11] (test)  loss: 0.6311 -> 0.6151   acc: 82.56% -> 83.05%             
client [96] (test)  loss: 0.5100 -> 0.4957   acc: 84.31% -> 84.38%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7207 -> 0.7371   acc: 80.15% -> 80.44%              
client [53] (test)  loss: 0.3786 -> 0.3609   acc: 88.52% -> 88.81%             
client [52] (test)  loss: 0.7207 -> 0.7138   acc: 78.47% -> 78.65%             
client [42] (test)  loss: 0.6762 -> 0.6965   acc: 81.35% -> 80.91%             
client [69] (test)  loss: 0.3734 -> 0.3839   acc: 89.72% -> 89.79%             
client [59] (test)  loss: 0.5132 -> 0.5206   acc: 85.50% -> 85.35%             
client [7] (test)  loss: 0.7998 -> 0.7952   acc: 73.05% -> 73.76%              
client [26] (test)  loss: 0.5049 -> 0.4737   acc: 84.73% -> 85.69%             
client [49] (test)  loss: 0.6484 -> 0.6230   acc: 80.87% -> 81.50%             
client [98] (test)  loss: 0.6962 -> 0.7051   acc: 77.61% -> 77.69%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7051 -> 0.7303   acc: 77.69% -> 77.31%             
client [47] (test)  loss: 0.4171 -> 0.4005   acc: 86.38% -> 86.82%             
client [21] (test)  loss: 0.7719 -> 0.7420   acc: 75.23% -> 76.14%             
client [77] (test)  loss: 0.4390 -> 0.4222   acc: 85.54% -> 86.23%             
client [95] (test)  loss: 0.6237 -> 0.6331   acc: 82.24% -> 82.29%             
client [91] (test)  loss: 0.8966 -> 0.9224   acc: 73.95% -> 73.64%             
client [14] (test)  loss: 0.7815 -> 0.7953   acc: 76.56% -> 76.53%             
client [99] (test)  loss: 0.8075 -> 0.8038   acc: 76.33% -> 76.67%             
client [20] (test)  loss: 0.6884 -> 0.7181   acc: 81.80% -> 81.48%             
client [39] (test)  loss: 0.7163 -> 0.7109   acc: 77.63% -> 77.58%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7138 -> 0.7175   acc: 78.65% -> 78.57%             
client [62] (test)  loss: 0.7220 -> 0.7476   acc: 79.64% -> 79.33%             
client [71] (test)  loss: 0.9206 -> 0.9282   acc: 73.03% -> 73.35%             
client [97] (test)  loss: 0.4468 -> 0.4568   acc: 87.10% -> 86.88%             
client [30] (test)  loss: 0.4794 -> 0.4922   acc: 86.53% -> 86.61%             
client [88] (test)  loss: 0.6079 -> 0.6048   acc: 82.65% -> 82.67%             
client [60] (test)  loss: 0.4946 -> 0.5135   acc: 82.84% -> 82.46%             
client [82] (test)  loss: 0.5854 -> 0.5904   acc: 81.37% -> 81.66%             
client [91] (test)  loss: 0.9517 -> 0.9862   acc: 73.69% -> 73.58%             
client [57] (test)  loss: 0.4751 -> 0.4661   acc: 84.71% -> 84.98%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2133 -> 1.2555   acc: 75.75% -> 75.90%             
client [15] (test)  loss: 0.6589 -> 0.6601   acc: 76.47% -> 76.52%             
client [71] (test)  loss: 0.9282 -> 0.9739   acc: 73.35% -> 72.91%             
client [97] (test)  loss: 0.4897 -> 0.5164   acc: 86.09% -> 85.73%             
client [53] (test)  loss: 0.3612 -> 0.3710   acc: 89.66% -> 89.68%             
client [77] (test)  loss: 0.4222 -> 0.4088   acc: 86.23% -> 86.86%             
client [76] (test)  loss: 0.8151 -> 0.8201   acc: 77.18% -> 77.84%             
client [79] (test)  loss: 0.3995 -> 0.4054   acc: 87.90% -> 88.04%             
client [28] (test)  loss: 0.6100 -> 0.6296   acc: 85.82% -> 86.01%             
client [99] (test)  loss: 0.8020 -> 0.8188   acc: 77.31% -> 77.09%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5427 -> 0.5712   acc: 85.47% -> 85.21%             
client [86] (test)  loss: 0.5346 -> 0.5490   acc: 86.32% -> 86.22%             
client [34] (test)  loss: 0.7978 -> 0.8228   acc: 77.61% -> 77.87%             
client [73] (test)  loss: 0.8240 -> 0.8525   acc: 77.71% -> 77.12%             
client [5] (test)  loss: 0.7687 -> 0.7973   acc: 80.71% -> 80.49%              
client [96] (test)  loss: 0.5888 -> 0.6129   acc: 85.03% -> 84.77%             
client [22] (test)  loss: 0.7274 -> 0.7453   acc: 79.29% -> 79.09%             
client [60] (test)  loss: 0.5685 -> 0.5885   acc: 82.79% -> 83.03%             
client [66] (test)  loss: 0.5139 -> 0.5163   acc: 82.81% -> 82.89%             
client [83] (test)  loss: 0.6733 -> 0.6889   acc: 80.11% -> 79.91%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8757 -> 0.9042   acc: 77.94% -> 77.94%             
client [65] (test)  loss: 0.4889 -> 0.5056   acc: 86.94% -> 86.70%             
client [95] (test)  loss: 0.6819 -> 0.7071   acc: 81.83% -> 81.61%             
client [17] (test)  loss: 0.6312 -> 0.6416   acc: 82.61% -> 82.71%             
client [8] (test)  loss: 0.8143 -> 0.8475   acc: 80.37% -> 80.27%              
client [35] (test)  loss: 1.1676 -> 1.2168   acc: 73.41% -> 73.39%             
client [98] (test)  loss: 0.7989 -> 0.8384   acc: 77.02% -> 76.62%             
client [53] (test)  loss: 0.3846 -> 0.3939   acc: 89.63% -> 89.63%             
client [43] (test)  loss: 0.7549 -> 0.7668   acc: 80.03% -> 80.34%             
client [64] (test)  loss: 0.7288 -> 0.7595   acc: 79.30% -> 78.68%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7339 -> 0.7385   acc: 76.85% -> 76.80%             
client [88] (test)  loss: 0.6792 -> 0.6954   acc: 82.86% -> 82.91%             
client [38] (test)  loss: 0.8179 -> 0.8558   acc: 77.63% -> 77.27%             
client [3] (test)  loss: 0.6979 -> 0.7257   acc: 82.17% -> 82.15%              
client [5] (test)  loss: 0.8236 -> 0.8539   acc: 80.49% -> 80.28%              
client [41] (test)  loss: 0.9043 -> 0.9286   acc: 71.68% -> 71.66%             
client [7] (test)  loss: 0.8104 -> 0.8315   acc: 74.67% -> 75.16%              
client [37] (test)  loss: 1.0871 -> 1.1028   acc: 68.68% -> 68.85%             
client [45] (test)  loss: 0.6838 -> 0.6844   acc: 79.76% -> 80.23%             
client [47] (test)  loss: 0.3898 -> 0.3925   acc: 87.74% -> 87.99%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9495 -> 0.9920   acc: 74.62% -> 74.16%             
client [11] (test)  loss: 0.7107 -> 0.7417   acc: 83.14% -> 83.05%             
client [37] (test)  loss: 1.1790 -> 1.2230   acc: 68.40% -> 68.11%             
client [41] (test)  loss: 0.9286 -> 0.9618   acc: 71.66% -> 71.39%             
client [95] (test)  loss: 0.7767 -> 0.8060   acc: 81.36% -> 81.46%             
client [53] (test)  loss: 0.3939 -> 0.3997   acc: 89.63% -> 90.00%             
client [22] (test)  loss: 0.7695 -> 0.7995   acc: 78.92% -> 78.97%             
client [25] (test)  loss: 0.4133 -> 0.4210   acc: 89.01% -> 89.15%             
client [69] (test)  loss: 0.5123 -> 0.5311   acc: 88.60% -> 88.45%             
client [46] (test)  loss: 0.8102 -> 0.8295   acc: 80.78% -> 80.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4370 -> 0.4629   acc: 87.72% -> 87.70%             
client [69] (test)  loss: 0.5477 -> 0.5692   acc: 88.67% -> 88.82%             
client [82] (test)  loss: 0.6531 -> 0.6728   acc: 82.00% -> 81.83%             
client [45] (test)  loss: 0.7091 -> 0.7273   acc: 80.11% -> 79.99%             
client [7] (test)  loss: 0.8315 -> 0.8614   acc: 75.16% -> 75.14%              
client [50] (test)  loss: 0.6842 -> 0.6800   acc: 81.77% -> 82.21%             
client [35] (test)  loss: 1.3058 -> 1.3524   acc: 73.44% -> 73.25%             
client [24] (test)  loss: 0.8699 -> 0.9034   acc: 78.03% -> 77.63%             
client [15] (test)  loss: 0.7140 -> 0.7358   acc: 76.59% -> 76.56%             
client [58] (test)  loss: 0.8403 -> 0.8553   acc: 84.20% -> 84.34%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.1684 -> 1.2394   acc: 75.74% -> 75.64%             
client [76] (test)  loss: 0.9713 -> 1.0054   acc: 77.86% -> 77.55%             
client [67] (test)  loss: 0.4886 -> 0.5033   acc: 87.68% -> 87.60%             
client [37] (test)  loss: 1.2730 -> 1.3318   acc: 67.91% -> 67.79%             
client [58] (test)  loss: 0.8739 -> 0.8952   acc: 84.25% -> 84.51%             
client [64] (test)  loss: 0.8430 -> 0.8755   acc: 77.84% -> 77.59%             
client [77] (test)  loss: 0.4297 -> 0.4392   acc: 87.16% -> 87.23%             
client [55] (test)  loss: 0.7066 -> 0.7420   acc: 81.99% -> 81.79%             
client [12] (test)  loss: 0.9260 -> 0.9653   acc: 78.17% -> 78.39%             
client [89] (test)  loss: 0.9983 -> 1.0277   acc: 80.93% -> 80.90%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.4708 -> 1.5082   acc: 75.50% -> 75.63%             
client [51] (test)  loss: 1.1904 -> 1.2553   acc: 70.10% -> 69.49%             
client [8] (test)  loss: 1.0401 -> 1.0623   acc: 80.88% -> 80.78%              
client [18] (test)  loss: 0.7974 -> 0.8380   acc: 78.74% -> 77.96%             
client [94] (test)  loss: 0.5221 -> 0.5620   acc: 86.90% -> 86.63%             
client [81] (test)  loss: 1.1157 -> 1.1607   acc: 78.61% -> 78.41%             
client [3] (test)  loss: 0.8495 -> 0.8699   acc: 82.22% -> 82.10%              
client [11] (test)  loss: 0.8289 -> 0.8558   acc: 81.86% -> 81.84%             
client [95] (test)  loss: 0.9897 -> 1.0394   acc: 80.55% -> 80.18%             
client [67] (test)  loss: 0.5033 -> 0.5176   acc: 87.60% -> 88.07%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7621 -> 0.7802   acc: 77.17% -> 77.29%             
client [79] (test)  loss: 0.5249 -> 0.5369   acc: 88.12% -> 87.99%             
client [58] (test)  loss: 0.9480 -> 0.9632   acc: 84.61% -> 84.78%             
client [88] (test)  loss: 0.7568 -> 0.7809   acc: 82.46% -> 82.14%             
client [46] (test)  loss: 0.8886 -> 0.9167   acc: 80.62% -> 80.27%             
client [11] (test)  loss: 0.8558 -> 0.8873   acc: 81.84% -> 81.89%             
client [55] (test)  loss: 0.9198 -> 0.9450   acc: 81.59% -> 81.53%             
client [13] (test)  loss: 0.9903 -> 1.0225   acc: 80.40% -> 80.05%             
client [31] (test)  loss: 1.4024 -> 1.4435   acc: 75.82% -> 75.78%             
client [75] (test)  loss: 0.9531 -> 0.9880   acc: 80.17% -> 80.14%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.0198 -> 1.0494   acc: 79.07% -> 79.00%             
client [7] (test)  loss: 1.0329 -> 1.0852   acc: 75.11% -> 74.89%              
client [57] (test)  loss: 0.5996 -> 0.6250   acc: 84.73% -> 84.71%             
client [13] (test)  loss: 1.0531 -> 1.0827   acc: 80.12% -> 80.05%             
client [43] (test)  loss: 0.9015 -> 0.9286   acc: 81.27% -> 81.36%             
client [91] (test)  loss: 1.1511 -> 1.2061   acc: 73.90% -> 73.58%             
client [10] (test)  loss: 1.0464 -> 1.0785   acc: 79.18% -> 79.05%             
client [64] (test)  loss: 1.0409 -> 1.0814   acc: 77.64% -> 77.66%             
client [82] (test)  loss: 0.8072 -> 0.8315   acc: 81.71% -> 81.64%             
client [22] (test)  loss: 0.9881 -> 1.0223   acc: 78.18% -> 78.26%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9187 -> 0.9310   acc: 81.97% -> 81.85%             
client [23] (test)  loss: 0.9677 -> 1.0098   acc: 74.24% -> 74.09%             
client [88] (test)  loss: 0.7809 -> 0.8060   acc: 82.14% -> 81.90%             
client [98] (test)  loss: 1.1226 -> 1.1742   acc: 75.70% -> 75.58%             
client [79] (test)  loss: 0.5633 -> 0.5746   acc: 87.85% -> 87.80%             
client [21] (test)  loss: 0.8030 -> 0.8273   acc: 77.22% -> 77.51%             
client [92] (test)  loss: 1.0231 -> 1.0698   acc: 78.07% -> 77.67%             
client [56] (test)  loss: 1.0346 -> 1.0783   acc: 79.72% -> 79.89%             
client [5] (test)  loss: 1.0965 -> 1.1248   acc: 79.80% -> 79.66%              
client [52] (test)  loss: 1.1097 -> 1.1454   acc: 77.29% -> 77.06%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.7006 -> 0.0000', 'accuracy': '80.39% -> 0.00%'},          
    200: {'loss': '0.9693 -> 0.0000', 'accuracy': '79.83% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(14.23%) at epoch: 1                                
Local-only-1 achieved 20.0%(22.81%) at epoch: 2                                
Local-only-1 achieved 30.0%(38.83%) at epoch: 4                                
Local-only-1 achieved 50.0%(53.42%) at epoch: 7                                
Local-only-1 achieved 60.0%(64.25%) at epoch: 16                               
Local-only-1 achieved 70.0%(73.08%) at epoch: 28                               
Local-only-1 achieved 80.0%(81.40%) at epoch: 54                               
Convergence (test_after):                                                      
Local-only-1 achieved 60.0%(62.28%) at epoch: 0                                
Local-only-1 achieved 70.0%(71.38%) at epoch: 9                                
Local-only-1 achieved 80.0%(80.58%) at epoch: 41                               
