==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0193 -> 1.8285   acc: 37.90% -> 41.13%             
client [81] (test)  loss: 1.9934 -> 1.7686   acc: 38.52% -> 44.26%             
client [21] (test)  loss: 2.3632 -> 2.0743   acc: 2.52% -> 34.45%              
client [68] (test)  loss: 2.1247 -> 1.8700   acc: 30.30% -> 30.30%             
client [93] (test)  loss: 1.4951 -> 0.9637   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.3688 -> 2.2455   acc: 11.54% -> 25.64%             
client [20] (test)  loss: 1.9893 -> 1.8275   acc: 45.32% -> 46.04%             
client [59] (test)  loss: 2.3857 -> 2.1847   acc: 18.11% -> 36.22%             
client [48] (test)  loss: 2.2391 -> 2.1683   acc: 25.45% -> 23.64%             
client [34] (test)  loss: 2.1568 -> 1.9077   acc: 34.51% -> 34.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9076 -> 1.8255   acc: 28.57% -> 30.36%             
client [99] (test)  loss: 2.3087 -> 2.1678   acc: 27.27% -> 26.14%             
client [67] (test)  loss: 2.3038 -> 2.1305   acc: 22.22% -> 28.57%             
client [0] (test)  loss: 1.6345 -> 1.4525   acc: 42.20% -> 45.09%              
client [76] (test)  loss: 1.9047 -> 1.7538   acc: 36.71% -> 41.77%             
client [41] (test)  loss: 2.2473 -> 2.0073   acc: 37.70% -> 31.97%             
client [62] (test)  loss: 2.4064 -> 2.2843   acc: 2.82% -> 40.85%              
client [2] (test)  loss: 2.3734 -> 1.5027   acc: 4.14% -> 63.45%               
client [14] (test)  loss: 1.7809 -> 1.6663   acc: 43.31% -> 44.88%             
client [46] (test)  loss: 1.7241 -> 1.6607   acc: 52.99% -> 52.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.9807 -> 1.8025   acc: 39.29% -> 41.07%             
client [68] (test)  loss: 1.4965 -> 1.3844   acc: 43.43% -> 45.45%             
client [57] (test)  loss: 1.8754 -> 1.7713   acc: 39.18% -> 39.18%             
client [17] (test)  loss: 1.8110 -> 1.7140   acc: 41.35% -> 51.92%             
client [54] (test)  loss: 1.9123 -> 1.8930   acc: 40.54% -> 41.89%             
client [23] (test)  loss: 2.3678 -> 2.3080   acc: 14.86% -> 31.08%             
client [35] (test)  loss: 1.9257 -> 1.8606   acc: 40.48% -> 40.48%             
client [59] (test)  loss: 1.6987 -> 1.6051   acc: 36.22% -> 36.22%             
client [31] (test)  loss: 1.7866 -> 1.7459   acc: 51.28% -> 51.28%             
client [9] (test)  loss: 1.9027 -> 1.8235   acc: 15.46% -> 40.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.8020 -> 1.6864   acc: 37.60% -> 37.60%             
client [33] (test)  loss: 1.3212 -> 1.2906   acc: 57.94% -> 57.94%             
client [16] (test)  loss: 2.0038 -> 1.9103   acc: 30.56% -> 34.72%             
client [44] (test)  loss: 2.1808 -> 1.9171   acc: 42.96% -> 40.74%             
client [8] (test)  loss: 0.8647 -> 0.8246   acc: 65.28% -> 67.36%              
client [31] (test)  loss: 1.7186 -> 1.6940   acc: 52.56% -> 56.41%             
client [47] (test)  loss: 1.4568 -> 1.2630   acc: 57.98% -> 65.55%             
client [36] (test)  loss: 2.2896 -> 2.1128   acc: 35.90% -> 35.90%             
client [20] (test)  loss: 1.4375 -> 1.3737   acc: 51.08% -> 53.96%             
client [56] (test)  loss: 1.9759 -> 1.7903   acc: 44.44% -> 44.44%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.9957 -> 1.9129   acc: 30.17% -> 30.17%              
client [60] (test)  loss: 2.0928 -> 2.0016   acc: 22.37% -> 22.37%             
client [28] (test)  loss: 1.4279 -> 1.3745   acc: 54.84% -> 54.03%             
client [25] (test)  loss: 1.9699 -> 1.8817   acc: 36.36% -> 36.36%             
client [58] (test)  loss: 1.1371 -> 1.0785   acc: 60.62% -> 65.62%             
client [44] (test)  loss: 1.9171 -> 1.7443   acc: 40.74% -> 42.22%             
client [39] (test)  loss: 0.8435 -> 0.8118   acc: 76.43% -> 76.43%             
client [29] (test)  loss: 1.3330 -> 1.2594   acc: 51.26% -> 60.50%             
client [3] (test)  loss: 2.0296 -> 1.9810   acc: 27.97% -> 29.66%              
client [84] (test)  loss: 0.5609 -> 0.5203   acc: 82.82% -> 85.89%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.6027 -> 1.4897   acc: 44.54% -> 49.58%             
client [84] (test)  loss: 0.4888 -> 0.4637   acc: 87.12% -> 87.73%             
client [10] (test)  loss: 2.2668 -> 2.2303   acc: 30.77% -> 28.21%             
client [36] (test)  loss: 1.8650 -> 1.8017   acc: 35.90% -> 35.90%             
client [65] (test)  loss: 1.7362 -> 1.7116   acc: 37.29% -> 38.14%             
client [81] (test)  loss: 1.5188 -> 1.4604   acc: 49.18% -> 49.18%             
client [79] (test)  loss: 1.7402 -> 1.6307   acc: 41.03% -> 41.03%             
client [42] (test)  loss: 1.8659 -> 1.8098   acc: 39.84% -> 39.06%             
client [11] (test)  loss: 1.6237 -> 1.5941   acc: 45.45% -> 46.21%             
client [96] (test)  loss: 1.7166 -> 1.6435   acc: 42.02% -> 42.02%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7429 -> 0.7041   acc: 78.47% -> 79.17%              
client [53] (test)  loss: 1.5850 -> 1.5191   acc: 41.18% -> 42.02%             
client [52] (test)  loss: 1.1621 -> 1.1089   acc: 66.67% -> 68.99%             
client [42] (test)  loss: 1.7563 -> 1.7065   acc: 39.84% -> 43.75%             
client [69] (test)  loss: 1.4319 -> 1.4018   acc: 49.11% -> 51.79%             
client [59] (test)  loss: 1.4147 -> 1.3574   acc: 47.24% -> 49.61%             
client [7] (test)  loss: 1.6550 -> 1.6003   acc: 40.00% -> 42.96%              
client [26] (test)  loss: 1.8754 -> 1.7851   acc: 35.38% -> 41.54%             
client [49] (test)  loss: 1.7005 -> 1.6050   acc: 44.12% -> 48.53%             
client [98] (test)  loss: 1.5450 -> 1.4934   acc: 43.86% -> 50.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4934 -> 1.4450   acc: 50.00% -> 51.75%             
client [47] (test)  loss: 1.1458 -> 1.0765   acc: 66.39% -> 67.23%             
client [21] (test)  loss: 1.3927 -> 1.3172   acc: 50.42% -> 50.42%             
client [77] (test)  loss: 1.4100 -> 1.3868   acc: 50.00% -> 50.81%             
client [95] (test)  loss: 1.1260 -> 1.0936   acc: 69.27% -> 72.07%             
client [91] (test)  loss: 1.9598 -> 1.9084   acc: 34.92% -> 34.92%             
client [14] (test)  loss: 1.2932 -> 1.2264   acc: 45.67% -> 55.12%             
client [99] (test)  loss: 1.9097 -> 1.8866   acc: 29.55% -> 31.82%             
client [20] (test)  loss: 1.1921 -> 1.1590   acc: 64.03% -> 64.03%             
client [39] (test)  loss: 0.7640 -> 0.7434   acc: 76.43% -> 76.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1089 -> 1.0668   acc: 68.99% -> 69.77%             
client [62] (test)  loss: 1.2831 -> 1.2519   acc: 64.79% -> 71.83%             
client [71] (test)  loss: 1.4747 -> 1.4212   acc: 49.62% -> 53.44%             
client [97] (test)  loss: 1.0055 -> 0.9521   acc: 62.42% -> 63.76%             
client [30] (test)  loss: 1.3292 -> 1.2777   acc: 59.84% -> 62.20%             
client [88] (test)  loss: 1.5839 -> 1.5386   acc: 41.91% -> 43.38%             
client [60] (test)  loss: 1.8064 -> 1.7746   acc: 35.53% -> 38.16%             
client [82] (test)  loss: 1.2522 -> 1.1937   acc: 56.56% -> 58.20%             
client [91] (test)  loss: 1.8583 -> 1.8105   acc: 34.92% -> 34.92%             
client [57] (test)  loss: 1.5522 -> 1.4680   acc: 45.03% -> 51.46%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5875 -> 1.5837   acc: 60.26% -> 60.26%             
client [15] (test)  loss: 0.7974 -> 0.7373   acc: 77.86% -> 77.86%             
client [71] (test)  loss: 1.4212 -> 1.3745   acc: 53.44% -> 54.20%             
client [97] (test)  loss: 0.8558 -> 0.8081   acc: 64.43% -> 67.79%             
client [53] (test)  loss: 1.3326 -> 1.2781   acc: 47.90% -> 52.10%             
client [77] (test)  loss: 1.3868 -> 1.3645   acc: 50.81% -> 51.61%             
client [76] (test)  loss: 1.4353 -> 1.3970   acc: 54.43% -> 55.70%             
client [79] (test)  loss: 1.4948 -> 1.4441   acc: 57.26% -> 63.25%             
client [28] (test)  loss: 1.1229 -> 1.0909   acc: 66.13% -> 65.32%             
client [99] (test)  loss: 1.8647 -> 1.8451   acc: 30.68% -> 29.55%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7609 -> 0.7170   acc: 70.47% -> 71.14%             
client [86] (test)  loss: 0.7205 -> 0.6863   acc: 80.49% -> 80.49%             
client [34] (test)  loss: 1.2508 -> 1.2145   acc: 56.34% -> 57.75%             
client [73] (test)  loss: 1.7613 -> 1.7218   acc: 41.60% -> 43.20%             
client [5] (test)  loss: 1.6220 -> 1.5877   acc: 50.48% -> 49.52%              
client [96] (test)  loss: 1.3395 -> 1.3137   acc: 57.98% -> 58.82%             
client [22] (test)  loss: 1.8810 -> 1.8404   acc: 37.38% -> 40.19%             
client [60] (test)  loss: 1.7003 -> 1.6831   acc: 39.47% -> 42.11%             
client [66] (test)  loss: 1.4489 -> 1.3734   acc: 40.32% -> 48.39%             
client [83] (test)  loss: 1.5821 -> 1.5346   acc: 50.44% -> 52.21%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.3011 -> 1.2734   acc: 59.49% -> 59.49%             
client [65] (test)  loss: 1.6650 -> 1.6376   acc: 39.83% -> 42.37%             
client [95] (test)  loss: 1.0296 -> 1.0174   acc: 75.98% -> 77.65%             
client [17] (test)  loss: 1.5417 -> 1.5340   acc: 56.73% -> 55.77%             
client [8] (test)  loss: 0.6258 -> 0.6124   acc: 80.56% -> 80.56%              
client [35] (test)  loss: 1.3229 -> 1.2752   acc: 51.19% -> 55.95%             
client [98] (test)  loss: 1.3617 -> 1.3266   acc: 55.26% -> 55.26%             
client [53] (test)  loss: 1.2256 -> 1.1738   acc: 54.62% -> 58.82%             
client [43] (test)  loss: 0.5602 -> 0.5434   acc: 82.78% -> 82.78%             
client [64] (test)  loss: 1.2494 -> 1.1923   acc: 56.00% -> 60.00%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.2576 -> 1.2090   acc: 50.42% -> 52.10%             
client [88] (test)  loss: 1.2687 -> 1.2200   acc: 56.62% -> 55.88%             
client [38] (test)  loss: 1.6301 -> 1.5850   acc: 45.24% -> 47.62%             
client [3] (test)  loss: 1.6210 -> 1.5884   acc: 45.76% -> 45.76%              
client [5] (test)  loss: 1.5640 -> 1.5469   acc: 49.52% -> 52.38%              
client [41] (test)  loss: 1.1767 -> 1.1448   acc: 66.39% -> 65.57%             
client [7] (test)  loss: 1.5019 -> 1.4605   acc: 43.70% -> 46.67%              
client [37] (test)  loss: 1.1201 -> 1.0775   acc: 62.26% -> 63.68%             
client [45] (test)  loss: 1.7966 -> 1.7397   acc: 38.38% -> 38.38%             
client [47] (test)  loss: 1.0015 -> 0.9781   acc: 68.07% -> 68.07%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.3353 -> 1.3028   acc: 59.72% -> 65.28%             
client [11] (test)  loss: 1.4365 -> 1.4123   acc: 57.58% -> 58.33%             
client [37] (test)  loss: 1.0027 -> 0.9808   acc: 68.87% -> 70.28%             
client [41] (test)  loss: 1.1448 -> 1.1190   acc: 65.57% -> 65.57%             
client [95] (test)  loss: 1.0014 -> 1.0026   acc: 77.65% -> 77.65%             
client [53] (test)  loss: 1.1738 -> 1.1288   acc: 58.82% -> 59.66%             
client [22] (test)  loss: 1.8050 -> 1.7736   acc: 40.19% -> 41.12%             
client [25] (test)  loss: 1.5609 -> 1.5127   acc: 59.50% -> 60.33%             
client [69] (test)  loss: 1.2462 -> 1.2338   acc: 54.46% -> 57.14%             
client [46] (test)  loss: 1.4138 -> 1.3866   acc: 57.26% -> 58.12%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9165 -> 0.9077   acc: 70.59% -> 71.43%             
client [69] (test)  loss: 1.2211 -> 1.2119   acc: 56.25% -> 57.14%             
client [82] (test)  loss: 1.0047 -> 0.9673   acc: 63.11% -> 65.57%             
client [45] (test)  loss: 1.6280 -> 1.5723   acc: 44.44% -> 54.55%             
client [7] (test)  loss: 1.4605 -> 1.4216   acc: 46.67% -> 48.89%              
client [50] (test)  loss: 0.8309 -> 0.7745   acc: 73.33% -> 78.52%             
client [35] (test)  loss: 1.1960 -> 1.1646   acc: 59.52% -> 64.29%             
client [24] (test)  loss: 1.3755 -> 1.3495   acc: 60.71% -> 60.71%             
client [15] (test)  loss: 0.6501 -> 0.6427   acc: 78.63% -> 77.86%             
client [58] (test)  loss: 0.7338 -> 0.7241   acc: 76.88% -> 76.88%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.5248 -> 1.5077   acc: 50.91% -> 54.55%             
client [76] (test)  loss: 1.2238 -> 1.2023   acc: 62.03% -> 63.29%             
client [67] (test)  loss: 1.5197 -> 1.4791   acc: 50.79% -> 52.38%             
client [37] (test)  loss: 0.9585 -> 0.9519   acc: 71.70% -> 72.17%             
client [58] (test)  loss: 0.7151 -> 0.7091   acc: 76.88% -> 76.88%             
client [64] (test)  loss: 1.0570 -> 1.0210   acc: 65.60% -> 67.20%             
client [77] (test)  loss: 1.2626 -> 1.2358   acc: 59.68% -> 60.48%             
client [55] (test)  loss: 1.3354 -> 1.3221   acc: 54.76% -> 54.76%             
client [12] (test)  loss: 1.8484 -> 1.8435   acc: 48.57% -> 50.71%             
client [89] (test)  loss: 1.1624 -> 1.1695   acc: 64.49% -> 63.04%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3410 -> 0.3378   acc: 90.18% -> 90.80%             
client [51] (test)  loss: 0.6318 -> 0.6207   acc: 72.90% -> 72.90%             
client [8] (test)  loss: 0.5827 -> 0.5813   acc: 81.25% -> 81.94%              
client [18] (test)  loss: 1.9458 -> 1.9166   acc: 31.96% -> 32.99%             
client [94] (test)  loss: 0.6883 -> 0.6736   acc: 76.67% -> 77.50%             
client [81] (test)  loss: 1.1080 -> 1.1052   acc: 63.11% -> 63.93%             
client [3] (test)  loss: 1.4726 -> 1.4465   acc: 52.54% -> 50.85%              
client [11] (test)  loss: 1.3694 -> 1.3645   acc: 59.85% -> 59.85%             
client [95] (test)  loss: 1.0377 -> 1.0436   acc: 78.77% -> 78.77%             
client [67] (test)  loss: 1.4791 -> 1.4431   acc: 52.38% -> 53.17%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1250 -> 1.0865   acc: 61.34% -> 69.75%             
client [79] (test)  loss: 1.1927 -> 1.1798   acc: 69.23% -> 68.38%             
client [58] (test)  loss: 0.6908 -> 0.6862   acc: 77.50% -> 77.50%             
client [88] (test)  loss: 1.0943 -> 1.0630   acc: 61.76% -> 63.97%             
client [46] (test)  loss: 1.3198 -> 1.3021   acc: 63.25% -> 62.39%             
client [11] (test)  loss: 1.3645 -> 1.3614   acc: 59.85% -> 59.85%             
client [55] (test)  loss: 1.2652 -> 1.2524   acc: 58.73% -> 59.52%             
client [13] (test)  loss: 1.7379 -> 1.7270   acc: 45.12% -> 43.90%             
client [31] (test)  loss: 1.5624 -> 1.5574   acc: 57.69% -> 57.69%             
client [75] (test)  loss: 1.2196 -> 1.1903   acc: 63.87% -> 63.87%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.9006 -> 0.8922   acc: 75.63% -> 77.31%             
client [7] (test)  loss: 1.2856 -> 1.2680   acc: 60.74% -> 61.48%              
client [57] (test)  loss: 1.0343 -> 1.0184   acc: 69.59% -> 70.18%             
client [13] (test)  loss: 1.7177 -> 1.7069   acc: 42.68% -> 42.68%             
client [43] (test)  loss: 0.5124 -> 0.5149   acc: 82.30% -> 83.25%             
client [91] (test)  loss: 1.6660 -> 1.6399   acc: 34.92% -> 34.92%             
client [10] (test)  loss: 1.9202 -> 1.8896   acc: 38.46% -> 38.46%             
client [64] (test)  loss: 0.8893 -> 0.8702   acc: 69.60% -> 71.20%             
client [82] (test)  loss: 0.8145 -> 0.7996   acc: 72.95% -> 73.77%             
client [22] (test)  loss: 1.6313 -> 1.6053   acc: 50.47% -> 49.53%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0478 -> 1.0435   acc: 67.63% -> 67.63%             
client [23] (test)  loss: 1.4851 -> 1.4423   acc: 51.35% -> 52.70%             
client [88] (test)  loss: 1.0630 -> 1.0407   acc: 63.97% -> 63.97%             
client [98] (test)  loss: 1.1430 -> 1.1294   acc: 66.67% -> 68.42%             
client [79] (test)  loss: 1.1561 -> 1.1449   acc: 71.79% -> 71.79%             
client [21] (test)  loss: 1.0491 -> 1.0127   acc: 71.43% -> 70.59%             
client [92] (test)  loss: 1.0921 -> 1.0797   acc: 63.08% -> 63.85%             
client [56] (test)  loss: 0.9296 -> 0.9199   acc: 67.52% -> 66.67%             
client [5] (test)  loss: 1.6012 -> 1.6255   acc: 48.57% -> 47.62%              
client [52] (test)  loss: 0.9409 -> 0.9428   acc: 75.19% -> 75.97%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '1.3029 -> 0.0000', 'accuracy': '57.09% -> 0.00%'},          
    200: {'loss': '1.0673 -> 0.0000', 'accuracy': '67.07% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(12.38%) at epoch: 0                                
Local-only-1 achieved 30.0%(31.69%) at epoch: 4                                
Local-only-1 achieved 40.0%(40.26%) at epoch: 18                               
Local-only-1 achieved 50.0%(52.59%) at epoch: 35                               
Local-only-1 achieved 60.0%(64.72%) at epoch: 82                               
Local-only-1 achieved 70.0%(70.97%) at epoch: 142                              
Convergence (test_after):                                                      
Local-only-1 achieved 30.0%(34.47%) at epoch: 0                                
Local-only-1 achieved 40.0%(41.82%) at epoch: 3                                
Local-only-1 achieved 50.0%(54.30%) at epoch: 20                               
Local-only-1 achieved 60.0%(61.64%) at epoch: 72                               
Local-only-1 achieved 70.0%(72.26%) at epoch: 142                              
