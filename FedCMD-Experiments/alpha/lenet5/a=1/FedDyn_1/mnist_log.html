==================== ALGORITHM: FedDyn_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5229 -> 0.3077   acc: 86.18% -> 91.33%             
client [81] (test)  loss: 0.5114 -> 0.3439   acc: 83.06% -> 87.60%             
client [21] (test)  loss: 28.0191 -> 0.3292   acc: 71.86% -> 88.97%            
client [68] (test)  loss: 0.3268 -> 0.1674   acc: 94.02% -> 95.73%             
client [93] (test)  loss: 0.5399 -> 0.2578   acc: 87.07% -> 94.63%             
client [31] (test)  loss: 0.9280 -> 0.4422   acc: 58.77% -> 82.14%             
client [20] (test)  loss: 0.5394 -> 0.2345   acc: 85.35% -> 94.27%             
client [59] (test)  loss: 18.5470 -> 0.2637   acc: 78.20% -> 92.64%            
client [48] (test)  loss: 0.4636 -> 0.3283   acc: 88.85% -> 91.55%             
client [34] (test)  loss: 0.5680 -> 0.3588   acc: 82.49% -> 90.40%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.7425 -> 0.1878   acc: 78.13% -> 93.88%             
client [99] (test)  loss: 0.5583 -> 0.2337   acc: 80.98% -> 92.20%             
client [67] (test)  loss: 0.3918 -> 0.2326   acc: 87.26% -> 95.37%             
client [0] (test)  loss: 0.1535 -> 0.1155   acc: 96.53% -> 96.00%              
client [76] (test)  loss: 0.1106 -> 0.0578   acc: 97.20% -> 98.13%             
client [41] (test)  loss: 0.5968 -> 0.2003   acc: 77.17% -> 93.15%             
client [62] (test)  loss: 7.1651 -> 0.1540   acc: 94.69% -> 96.09%             
client [2] (test)  loss: 13.9946 -> 0.1702   acc: 87.00% -> 94.95%             
client [14] (test)  loss: 0.2808 -> 0.2601   acc: 91.71% -> 91.71%             
client [46] (test)  loss: 0.3529 -> 0.2209   acc: 89.90% -> 93.60%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.1508 -> 0.1588   acc: 96.50% -> 96.11%             
client [68] (test)  loss: 0.1355 -> 0.0773   acc: 95.44% -> 98.29%             
client [57] (test)  loss: 0.1720 -> 0.1255   acc: 95.80% -> 96.06%             
client [17] (test)  loss: 0.1760 -> 0.0842   acc: 94.06% -> 97.62%             
client [54] (test)  loss: 0.1298 -> 0.1221   acc: 96.10% -> 95.54%             
client [23] (test)  loss: 9.4982 -> 0.1231   acc: 92.72% -> 96.92%             
client [35] (test)  loss: 0.1340 -> 0.1104   acc: 96.72% -> 96.99%             
client [59] (test)  loss: 0.1212 -> 0.0961   acc: 97.00% -> 97.55%             
client [31] (test)  loss: 0.1999 -> 0.1828   acc: 93.83% -> 93.51%             
client [9] (test)  loss: 0.1654 -> 0.1641   acc: 96.55% -> 96.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1266 -> 0.0215   acc: 96.07% -> 99.48%             
client [33] (test)  loss: 0.1425 -> 0.1007   acc: 94.41% -> 97.04%             
client [16] (test)  loss: 0.1795 -> 0.0986   acc: 95.04% -> 97.77%             
client [44] (test)  loss: 1.0769 -> 0.1394   acc: 69.03% -> 95.87%             
client [8] (test)  loss: 0.2532 -> 0.1359   acc: 91.84% -> 96.17%              
client [31] (test)  loss: 0.3400 -> 0.1533   acc: 89.61% -> 93.83%             
client [47] (test)  loss: 0.1459 -> 0.0852   acc: 95.25% -> 96.91%             
client [36] (test)  loss: 0.1675 -> 0.0798   acc: 94.16% -> 98.54%             
client [20] (test)  loss: 0.1478 -> 0.0687   acc: 94.69% -> 97.45%             
client [56] (test)  loss: 0.1372 -> 0.1303   acc: 97.75% -> 97.46%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1470 -> 0.1395   acc: 95.57% -> 95.81%              
client [60] (test)  loss: 0.2342 -> 0.0724   acc: 92.67% -> 97.31%             
client [28] (test)  loss: 0.1123 -> 0.1208   acc: 96.90% -> 96.55%             
client [25] (test)  loss: 0.3974 -> 0.1057   acc: 88.95% -> 96.96%             
client [58] (test)  loss: 0.1709 -> 0.0481   acc: 94.74% -> 98.34%             
client [44] (test)  loss: 0.1271 -> 0.1306   acc: 95.87% -> 96.76%             
client [39] (test)  loss: 0.0868 -> 0.0691   acc: 97.84% -> 97.12%             
client [29] (test)  loss: 0.0768 -> 0.0693   acc: 97.50% -> 98.33%             
client [3] (test)  loss: 0.1020 -> 0.0896   acc: 96.98% -> 97.21%              
client [84] (test)  loss: 0.2610 -> 0.1260   acc: 91.75% -> 95.10%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.1572 -> 0.0843   acc: 94.68% -> 96.96%             
client [84] (test)  loss: 0.2862 -> 0.1138   acc: 91.49% -> 95.62%             
client [10] (test)  loss: 0.1176 -> 0.0581   acc: 96.54% -> 97.87%             
client [36] (test)  loss: 0.1121 -> 0.0598   acc: 96.11% -> 99.03%             
client [65] (test)  loss: 0.1451 -> 0.1052   acc: 95.11% -> 96.74%             
client [81] (test)  loss: 0.1339 -> 0.0419   acc: 94.21% -> 99.59%             
client [79] (test)  loss: 0.1194 -> 0.0666   acc: 96.70% -> 97.92%             
client [42] (test)  loss: 0.0974 -> 0.0661   acc: 96.28% -> 97.93%             
client [11] (test)  loss: 0.1066 -> 0.0522   acc: 96.34% -> 98.87%             
client [96] (test)  loss: 0.0942 -> 0.0856   acc: 96.98% -> 97.99%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1774 -> 0.1178   acc: 94.90% -> 96.43%              
client [53] (test)  loss: 0.2107 -> 0.1404   acc: 93.50% -> 95.12%             
client [52] (test)  loss: 0.1254 -> 0.1035   acc: 95.73% -> 96.44%             
client [42] (test)  loss: 0.0991 -> 0.0643   acc: 97.11% -> 97.52%             
client [69] (test)  loss: 0.1355 -> 0.1087   acc: 95.34% -> 95.34%             
client [59] (test)  loss: 0.0616 -> 0.0606   acc: 98.37% -> 98.37%             
client [7] (test)  loss: 0.9670 -> 0.0422   acc: 75.78% -> 98.70%              
client [26] (test)  loss: 0.5416 -> 0.0743   acc: 82.82% -> 98.02%             
client [49] (test)  loss: 0.1027 -> 0.0578   acc: 97.73% -> 97.73%             
client [98] (test)  loss: 0.1982 -> 0.1380   acc: 94.01% -> 94.76%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1765 -> 0.1332   acc: 94.38% -> 95.51%             
client [47] (test)  loss: 0.0699 -> 0.0564   acc: 97.62% -> 97.62%             
client [21] (test)  loss: 0.1057 -> 0.0687   acc: 96.20% -> 96.96%             
client [77] (test)  loss: 0.1305 -> 0.0596   acc: 95.39% -> 97.56%             
client [95] (test)  loss: 0.1288 -> 0.0431   acc: 96.66% -> 98.46%             
client [91] (test)  loss: 0.0805 -> 0.0330   acc: 97.35% -> 99.12%             
client [14] (test)  loss: 0.1871 -> 0.2150   acc: 93.37% -> 93.92%             
client [99] (test)  loss: 0.4209 -> 0.0900   acc: 87.07% -> 96.10%             
client [20] (test)  loss: 0.1872 -> 0.0487   acc: 94.69% -> 98.30%             
client [39] (test)  loss: 0.1243 -> 0.0612   acc: 95.44% -> 97.84%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1124 -> 0.0926   acc: 96.09% -> 96.80%             
client [62] (test)  loss: 0.1381 -> 0.1150   acc: 96.93% -> 97.77%             
client [71] (test)  loss: 0.1512 -> 0.0867   acc: 96.46% -> 97.28%             
client [97] (test)  loss: 0.1913 -> 0.0369   acc: 94.06% -> 99.38%             
client [30] (test)  loss: 0.0908 -> 0.0504   acc: 97.71% -> 99.31%             
client [88] (test)  loss: 0.0878 -> 0.0330   acc: 97.44% -> 98.93%             
client [60] (test)  loss: 0.1605 -> 0.0525   acc: 94.13% -> 97.56%             
client [82] (test)  loss: 0.1791 -> 0.1228   acc: 95.51% -> 97.96%             
client [91] (test)  loss: 0.0467 -> 0.0291   acc: 98.67% -> 99.12%             
client [57] (test)  loss: 0.1328 -> 0.0691   acc: 96.33% -> 97.90%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.1857 -> 0.1196   acc: 94.16% -> 96.10%             
client [15] (test)  loss: 0.1418 -> 0.0732   acc: 95.16% -> 97.78%             
client [71] (test)  loss: 0.1443 -> 0.0867   acc: 96.46% -> 98.09%             
client [97] (test)  loss: 0.1767 -> 0.0357   acc: 95.31% -> 99.06%             
client [53] (test)  loss: 0.2449 -> 0.1449   acc: 93.50% -> 94.72%             
client [77] (test)  loss: 0.0930 -> 0.0567   acc: 96.21% -> 97.29%             
client [76] (test)  loss: 0.0108 -> 0.0050   acc: 100.00% -> 100.00%           
client [79] (test)  loss: 0.1580 -> 0.0642   acc: 95.31% -> 97.74%             
client [28] (test)  loss: 0.1076 -> 0.0869   acc: 97.24% -> 97.93%             
client [99] (test)  loss: 0.4208 -> 0.0759   acc: 86.83% -> 97.56%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1574 -> 0.0328   acc: 95.62% -> 99.69%             
client [86] (test)  loss: 0.1117 -> 0.0739   acc: 97.10% -> 97.10%             
client [34] (test)  loss: 0.0824 -> 0.0629   acc: 97.46% -> 97.74%             
client [73] (test)  loss: 0.0591 -> 0.0535   acc: 98.66% -> 98.40%             
client [5] (test)  loss: 0.1905 -> 0.0995   acc: 94.67% -> 96.45%              
client [96] (test)  loss: 0.1002 -> 0.0844   acc: 96.73% -> 97.74%             
client [22] (test)  loss: 0.0796 -> 0.0554   acc: 98.02% -> 98.87%             
client [60] (test)  loss: 0.1450 -> 0.0506   acc: 94.87% -> 97.80%             
client [66] (test)  loss: 0.1302 -> 0.0430   acc: 94.69% -> 98.09%             
client [83] (test)  loss: 0.2366 -> 0.1051   acc: 92.84% -> 97.44%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.0287 -> 0.0047   acc: 99.07% -> 100.00%            
client [65] (test)  loss: 0.1148 -> 0.0861   acc: 96.47% -> 97.55%             
client [95] (test)  loss: 0.0713 -> 0.0389   acc: 97.94% -> 98.71%             
client [17] (test)  loss: 0.1022 -> 0.0868   acc: 97.15% -> 97.62%             
client [8] (test)  loss: 0.1383 -> 0.1137   acc: 95.66% -> 96.94%              
client [35] (test)  loss: 0.0721 -> 0.0637   acc: 98.09% -> 98.36%             
client [98] (test)  loss: 0.1729 -> 0.1143   acc: 94.38% -> 96.63%             
client [53] (test)  loss: 0.1614 -> 0.1413   acc: 95.12% -> 95.12%             
client [43] (test)  loss: 0.0935 -> 0.0785   acc: 96.96% -> 97.34%             
client [64] (test)  loss: 0.0839 -> 0.0190   acc: 97.91% -> 99.48%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1725 -> 0.0467   acc: 93.16% -> 98.48%             
client [88] (test)  loss: 0.1422 -> 0.0307   acc: 95.95% -> 99.15%             
client [38] (test)  loss: 0.2231 -> 0.0796   acc: 92.70% -> 97.73%             
client [3] (test)  loss: 0.0695 -> 0.0643   acc: 97.44% -> 97.91%              
client [5] (test)  loss: 0.2800 -> 0.0980   acc: 93.15% -> 96.95%              
client [41] (test)  loss: 0.1615 -> 0.0779   acc: 94.52% -> 97.72%             
client [7] (test)  loss: 0.2015 -> 0.0328   acc: 94.53% -> 98.44%              
client [37] (test)  loss: 0.0689 -> 0.0444   acc: 98.09% -> 98.91%             
client [45] (test)  loss: 0.1843 -> 0.0564   acc: 96.11% -> 98.45%             
client [47] (test)  loss: 0.1340 -> 0.0503   acc: 95.25% -> 98.10%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1141 -> 0.0785   acc: 96.77% -> 97.77%             
client [11] (test)  loss: 0.0740 -> 0.0349   acc: 98.31% -> 99.44%             
client [37] (test)  loss: 0.0442 -> 0.0393   acc: 98.63% -> 98.63%             
client [41] (test)  loss: 0.1042 -> 0.0757   acc: 97.49% -> 97.72%             
client [95] (test)  loss: 0.0650 -> 0.0392   acc: 97.94% -> 98.46%             
client [53] (test)  loss: 0.1987 -> 0.1449   acc: 94.31% -> 95.53%             
client [22] (test)  loss: 0.0839 -> 0.0527   acc: 98.31% -> 99.15%             
client [25] (test)  loss: 0.1307 -> 0.0856   acc: 96.41% -> 97.51%             
client [69] (test)  loss: 0.1051 -> 0.0982   acc: 96.50% -> 97.08%             
client [46] (test)  loss: 0.1167 -> 0.1040   acc: 95.96% -> 96.30%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0635 -> 0.0459   acc: 97.39% -> 98.57%             
client [69] (test)  loss: 0.1225 -> 0.0973   acc: 96.50% -> 97.38%             
client [82] (test)  loss: 0.1480 -> 0.1237   acc: 96.73% -> 97.96%             
client [45] (test)  loss: 0.1118 -> 0.0506   acc: 96.89% -> 97.93%             
client [7] (test)  loss: 0.3752 -> 0.0315   acc: 90.62% -> 98.70%              
client [50] (test)  loss: 0.0531 -> 0.0106   acc: 98.36% -> 99.45%             
client [35] (test)  loss: 0.0866 -> 0.0548   acc: 98.09% -> 98.36%             
client [24] (test)  loss: 0.1667 -> 0.0871   acc: 93.77% -> 96.89%             
client [15] (test)  loss: 0.1399 -> 0.0688   acc: 95.36% -> 98.39%             
client [58] (test)  loss: 0.0948 -> 0.0307   acc: 96.95% -> 98.89%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1217 -> 0.0828   acc: 95.95% -> 98.31%             
client [76] (test)  loss: 0.0063 -> 0.0021   acc: 100.00% -> 100.00%           
client [67] (test)  loss: 0.1155 -> 0.1094   acc: 96.91% -> 96.91%             
client [37] (test)  loss: 0.0458 -> 0.0401   acc: 98.63% -> 98.63%             
client [58] (test)  loss: 0.0882 -> 0.0303   acc: 96.68% -> 98.61%             
client [64] (test)  loss: 0.0718 -> 0.0182   acc: 98.69% -> 99.48%             
client [77] (test)  loss: 0.0695 -> 0.0495   acc: 97.02% -> 97.56%             
client [55] (test)  loss: 0.1000 -> 0.0551   acc: 96.86% -> 98.04%             
client [12] (test)  loss: 0.1001 -> 0.0562   acc: 96.98% -> 97.98%             
client [89] (test)  loss: 0.1527 -> 0.0770   acc: 97.24% -> 98.03%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1523 -> 0.0789   acc: 96.13% -> 97.94%             
client [51] (test)  loss: 0.1139 -> 0.0786   acc: 96.16% -> 97.81%             
client [8] (test)  loss: 0.1532 -> 0.1112   acc: 96.17% -> 96.68%              
client [18] (test)  loss: 0.0649 -> 0.0478   acc: 99.27% -> 98.54%             
client [94] (test)  loss: 0.0736 -> 0.0300   acc: 97.08% -> 98.78%             
client [81] (test)  loss: 0.0604 -> 0.0325   acc: 97.52% -> 98.35%             
client [3] (test)  loss: 0.0464 -> 0.0608   acc: 98.37% -> 97.44%              
client [11] (test)  loss: 0.0722 -> 0.0358   acc: 98.03% -> 99.15%             
client [95] (test)  loss: 0.0639 -> 0.0374   acc: 97.94% -> 98.71%             
client [67] (test)  loss: 0.1185 -> 0.1071   acc: 97.68% -> 96.91%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.0936 -> 0.0538   acc: 96.58% -> 98.48%             
client [79] (test)  loss: 0.0953 -> 0.0666   acc: 97.22% -> 98.26%             
client [58] (test)  loss: 0.0590 -> 0.0283   acc: 97.78% -> 98.89%             
client [88] (test)  loss: 0.0601 -> 0.0270   acc: 97.65% -> 99.15%             
client [46] (test)  loss: 0.1165 -> 0.1005   acc: 94.61% -> 95.62%             
client [11] (test)  loss: 0.0756 -> 0.0349   acc: 97.46% -> 99.15%             
client [55] (test)  loss: 0.1069 -> 0.0616   acc: 96.86% -> 97.65%             
client [13] (test)  loss: 0.0841 -> 0.0798   acc: 97.33% -> 98.09%             
client [31] (test)  loss: 0.1094 -> 0.1114   acc: 97.40% -> 96.10%             
client [75] (test)  loss: 0.1315 -> 0.0462   acc: 96.03% -> 99.15%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0791 -> 0.0396   acc: 97.87% -> 98.67%             
client [7] (test)  loss: 0.3540 -> 0.0306   acc: 90.36% -> 98.96%              
client [57] (test)  loss: 0.1021 -> 0.0558   acc: 96.33% -> 98.43%             
client [13] (test)  loss: 0.0738 -> 0.0791   acc: 98.09% -> 97.71%             
client [43] (test)  loss: 0.1082 -> 0.0814   acc: 96.58% -> 98.10%             
client [91] (test)  loss: 0.0492 -> 0.0319   acc: 99.12% -> 99.56%             
client [10] (test)  loss: 0.0746 -> 0.0362   acc: 97.61% -> 98.94%             
client [64] (test)  loss: 0.0381 -> 0.0170   acc: 99.21% -> 99.48%             
client [82] (test)  loss: 0.1683 -> 0.1264   acc: 96.33% -> 97.96%             
client [22] (test)  loss: 0.0895 -> 0.0551   acc: 97.74% -> 98.87%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.0873 -> 0.0401   acc: 97.88% -> 99.15%             
client [23] (test)  loss: 0.1047 -> 0.0698   acc: 97.20% -> 98.60%             
client [88] (test)  loss: 0.0609 -> 0.0258   acc: 97.87% -> 99.36%             
client [98] (test)  loss: 0.1401 -> 0.1061   acc: 96.25% -> 95.88%             
client [79] (test)  loss: 0.0873 -> 0.0669   acc: 97.40% -> 98.26%             
client [21] (test)  loss: 0.1107 -> 0.0578   acc: 95.44% -> 98.10%             
client [92] (test)  loss: 0.1298 -> 0.1043   acc: 96.51% -> 97.32%             
client [56] (test)  loss: 0.1472 -> 0.1091   acc: 96.62% -> 98.03%             
client [5] (test)  loss: 0.1404 -> 0.0884   acc: 95.94% -> 96.45%              
client [52] (test)  loss: 0.0901 -> 0.0829   acc: 96.44% -> 97.15%             
==================== FedDyn_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.1447 -> 0.0000', 'accuracy': '95.56% -> 0.00%'},          
    200: {'loss': '0.1078 -> 0.0000', 'accuracy': '96.93% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn_1 achieved 10.0%(12.68%) at epoch: 0                                    
FedDyn_1 achieved 20.0%(29.26%) at epoch: 1                                    
FedDyn_1 achieved 40.0%(42.35%) at epoch: 3                                    
FedDyn_1 achieved 50.0%(55.81%) at epoch: 4                                    
FedDyn_1 achieved 60.0%(63.91%) at epoch: 6                                    
FedDyn_1 achieved 80.0%(83.51%) at epoch: 7                                    
FedDyn_1 achieved 90.0%(90.29%) at epoch: 16                                   
Convergence (test_after):                                                      
FedDyn_1 achieved 40.0%(40.85%) at epoch: 0                                    
FedDyn_1 achieved 50.0%(59.11%) at epoch: 1                                    
FedDyn_1 achieved 60.0%(69.49%) at epoch: 2                                    
FedDyn_1 achieved 70.0%(76.15%) at epoch: 3                                    
FedDyn_1 achieved 80.0%(80.53%) at epoch: 4                                    
FedDyn_1 achieved 90.0%(91.37%) at epoch: 9                                    
