==================== ALGORITHM: FedDyn_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0995 -> 1.0582   acc: 19.58% -> 65.27%             
client [81] (test)  loss: 1.9112 -> 1.3308   acc: 30.97% -> 59.73%             
client [21] (test)  loss: 2.2035 -> 0.8100   acc: 28.04% -> 73.52%             
client [68] (test)  loss: 1.4173 -> 0.8690   acc: 56.83% -> 74.10%             
client [93] (test)  loss: 0.7020 -> 0.4206   acc: 81.69% -> 86.34%             
client [31] (test)  loss: 1.9925 -> 1.3268   acc: 21.59% -> 51.10%             
client [20] (test)  loss: 0.9748 -> 0.5819   acc: 74.18% -> 81.70%             
client [59] (test)  loss: 2.1122 -> 0.8942   acc: 39.74% -> 71.19%             
client [48] (test)  loss: 1.3089 -> 0.9406   acc: 50.68% -> 65.20%             
client [34] (test)  loss: 1.3247 -> 0.6868   acc: 53.76% -> 74.19%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2466 -> 0.5603   acc: 54.85% -> 81.94%             
client [99] (test)  loss: 1.1238 -> 0.7092   acc: 61.72% -> 80.00%             
client [67] (test)  loss: 1.1158 -> 0.6772   acc: 58.69% -> 79.15%             
client [0] (test)  loss: 0.8112 -> 0.4715   acc: 75.74% -> 85.25%              
client [76] (test)  loss: 0.9407 -> 0.6785   acc: 64.31% -> 77.11%             
client [41] (test)  loss: 1.4901 -> 0.7605   acc: 38.00% -> 76.00%             
client [62] (test)  loss: 3.0094 -> 0.5003   acc: 4.29% -> 83.71%              
client [2] (test)  loss: 2.1350 -> 0.5627   acc: 14.37% -> 79.04%              
client [14] (test)  loss: 0.6622 -> 0.3527   acc: 77.58% -> 87.88%             
client [46] (test)  loss: 0.6700 -> 0.5853   acc: 76.07% -> 80.34%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0325 -> 0.5827   acc: 62.94% -> 78.93%             
client [68] (test)  loss: 0.6745 -> 0.5822   acc: 79.14% -> 79.50%             
client [57] (test)  loss: 0.8799 -> 0.6551   acc: 65.31% -> 80.61%             
client [17] (test)  loss: 0.9660 -> 0.6759   acc: 64.38% -> 77.40%             
client [54] (test)  loss: 0.5489 -> 0.4321   acc: 84.79% -> 85.17%             
client [23] (test)  loss: 2.3111 -> 0.3958   acc: 24.17% -> 85.83%             
client [35] (test)  loss: 0.7439 -> 0.5068   acc: 72.69% -> 87.27%             
client [59] (test)  loss: 0.5899 -> 0.3470   acc: 80.13% -> 90.40%             
client [31] (test)  loss: 0.7167 -> 0.6700   acc: 76.21% -> 77.09%             
client [9] (test)  loss: 0.7326 -> 0.5713   acc: 74.34% -> 78.47%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6514 -> 0.4224   acc: 79.75% -> 84.81%             
client [33] (test)  loss: 0.5534 -> 0.3023   acc: 81.17% -> 89.94%             
client [16] (test)  loss: 0.9607 -> 0.3453   acc: 70.63% -> 89.22%             
client [44] (test)  loss: 2.6830 -> 0.4560   acc: 32.01% -> 82.44%             
client [8] (test)  loss: 0.8748 -> 0.2576   acc: 71.48% -> 91.80%              
client [31] (test)  loss: 0.6451 -> 0.5804   acc: 77.97% -> 79.74%             
client [47] (test)  loss: 0.8218 -> 0.3129   acc: 70.48% -> 87.95%             
client [36] (test)  loss: 0.8867 -> 0.5009   acc: 67.76% -> 82.24%             
client [20] (test)  loss: 0.4622 -> 0.2886   acc: 83.66% -> 89.87%             
client [56] (test)  loss: 0.4873 -> 0.2013   acc: 83.74% -> 93.87%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3824 -> 0.2138   acc: 88.27% -> 94.14%              
client [60] (test)  loss: 1.0386 -> 0.1883   acc: 70.06% -> 93.83%             
client [28] (test)  loss: 1.0995 -> 0.7025   acc: 66.27% -> 76.59%             
client [25] (test)  loss: 1.2336 -> 0.3404   acc: 60.06% -> 89.46%             
client [58] (test)  loss: 0.9554 -> 0.3052   acc: 68.77% -> 89.92%             
client [44] (test)  loss: 0.6520 -> 0.4237   acc: 76.77% -> 84.99%             
client [39] (test)  loss: 0.6281 -> 0.3117   acc: 79.94% -> 91.28%             
client [29] (test)  loss: 1.1077 -> 0.4293   acc: 63.52% -> 86.27%             
client [3] (test)  loss: 0.4479 -> 0.2755   acc: 83.66% -> 89.54%              
client [84] (test)  loss: 0.9749 -> 0.4557   acc: 63.70% -> 82.56%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4423 -> 0.3168   acc: 83.49% -> 90.03%             
client [84] (test)  loss: 0.6638 -> 0.4106   acc: 75.09% -> 85.77%             
client [10] (test)  loss: 0.5593 -> 0.3050   acc: 79.69% -> 90.62%             
client [36] (test)  loss: 0.7958 -> 0.3842   acc: 73.36% -> 84.54%             
client [65] (test)  loss: 0.3642 -> 0.3535   acc: 85.58% -> 88.78%             
client [81] (test)  loss: 0.6025 -> 0.5011   acc: 81.42% -> 83.63%             
client [79] (test)  loss: 0.5130 -> 0.4812   acc: 83.64% -> 85.00%             
client [42] (test)  loss: 0.7702 -> 0.5943   acc: 72.97% -> 78.68%             
client [11] (test)  loss: 1.0791 -> 0.5369   acc: 60.92% -> 84.03%             
client [96] (test)  loss: 0.5939 -> 0.5195   acc: 82.62% -> 86.52%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.9297 -> 0.1876   acc: 46.23% -> 94.75%              
client [53] (test)  loss: 0.6721 -> 0.4524   acc: 75.29% -> 82.75%             
client [52] (test)  loss: 1.9320 -> 0.2984   acc: 53.35% -> 92.33%             
client [42] (test)  loss: 0.8393 -> 0.5752   acc: 73.27% -> 79.88%             
client [69] (test)  loss: 0.3452 -> 0.2762   acc: 87.63% -> 89.97%             
client [59] (test)  loss: 0.4139 -> 0.2134   acc: 88.08% -> 93.05%             
client [7] (test)  loss: 0.8681 -> 0.1898   acc: 73.20% -> 93.95%              
client [26] (test)  loss: 0.6938 -> 0.1766   acc: 81.89% -> 94.39%             
client [49] (test)  loss: 0.3372 -> 0.1427   acc: 89.61% -> 96.10%             
client [98] (test)  loss: 0.7328 -> 0.3776   acc: 76.44% -> 91.10%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8285 -> 0.3564   acc: 75.39% -> 90.58%             
client [47] (test)  loss: 0.7919 -> 0.2204   acc: 70.18% -> 92.47%             
client [21] (test)  loss: 0.4914 -> 0.2899   acc: 83.18% -> 89.10%             
client [77] (test)  loss: 0.7490 -> 0.4750   acc: 76.76% -> 84.33%             
client [95] (test)  loss: 0.5588 -> 0.3764   acc: 81.93% -> 85.94%             
client [91] (test)  loss: 0.5707 -> 0.3437   acc: 81.82% -> 86.10%             
client [14] (test)  loss: 0.3218 -> 0.1702   acc: 89.70% -> 93.64%             
client [99] (test)  loss: 0.6454 -> 0.4150   acc: 81.72% -> 86.21%             
client [20] (test)  loss: 0.4438 -> 0.2153   acc: 84.31% -> 92.48%             
client [39] (test)  loss: 0.6129 -> 0.2538   acc: 81.98% -> 93.60%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8626 -> 0.2905   acc: 76.04% -> 93.29%             
client [62] (test)  loss: 0.5212 -> 0.2671   acc: 81.43% -> 88.86%             
client [71] (test)  loss: 0.6016 -> 0.2939   acc: 80.00% -> 88.80%             
client [97] (test)  loss: 0.3814 -> 0.1918   acc: 87.60% -> 94.34%             
client [30] (test)  loss: 0.2239 -> 0.0941   acc: 91.77% -> 96.84%             
client [88] (test)  loss: 0.5694 -> 0.1351   acc: 81.41% -> 95.83%             
client [60] (test)  loss: 0.3984 -> 0.1693   acc: 88.27% -> 94.44%             
client [82] (test)  loss: 0.7865 -> 0.3680   acc: 72.49% -> 88.67%             
client [91] (test)  loss: 0.7524 -> 0.3145   acc: 75.40% -> 87.17%             
client [57] (test)  loss: 0.3340 -> 0.2973   acc: 87.76% -> 89.80%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5627 -> 0.4088   acc: 83.26% -> 88.55%             
client [15] (test)  loss: 0.1954 -> 0.0805   acc: 94.06% -> 96.88%             
client [71] (test)  loss: 0.4303 -> 0.2938   acc: 83.20% -> 89.60%             
client [97] (test)  loss: 0.3005 -> 0.1940   acc: 89.76% -> 94.34%             
client [53] (test)  loss: 0.7936 -> 0.4099   acc: 74.90% -> 86.27%             
client [77] (test)  loss: 0.7465 -> 0.4392   acc: 77.55% -> 86.42%             
client [76] (test)  loss: 0.8066 -> 0.3072   acc: 73.84% -> 88.28%             
client [79] (test)  loss: 0.5163 -> 0.4120   acc: 83.18% -> 88.18%             
client [28] (test)  loss: 0.7808 -> 0.5381   acc: 78.17% -> 87.70%             
client [99] (test)  loss: 0.7499 -> 0.3911   acc: 74.83% -> 87.93%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3066 -> 0.1982   acc: 89.49% -> 93.53%             
client [86] (test)  loss: 0.4207 -> 0.2549   acc: 83.59% -> 90.77%             
client [34] (test)  loss: 0.4198 -> 0.2606   acc: 87.90% -> 93.55%             
client [73] (test)  loss: 0.2163 -> 0.1460   acc: 93.12% -> 95.14%             
client [5] (test)  loss: 0.9741 -> 0.2434   acc: 77.47% -> 91.48%              
client [96] (test)  loss: 0.7520 -> 0.4775   acc: 79.08% -> 86.17%             
client [22] (test)  loss: 0.3664 -> 0.1853   acc: 87.78% -> 93.33%             
client [60] (test)  loss: 0.7220 -> 0.1608   acc: 78.09% -> 95.06%             
client [66] (test)  loss: 0.4002 -> 0.3869   acc: 85.51% -> 89.13%             
client [83] (test)  loss: 0.5084 -> 0.3222   acc: 81.28% -> 88.92%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8277 -> 0.2946   acc: 74.66% -> 88.28%             
client [65] (test)  loss: 0.4325 -> 0.2950   acc: 86.22% -> 91.99%             
client [95] (test)  loss: 0.5636 -> 0.3445   acc: 84.74% -> 88.35%             
client [17] (test)  loss: 0.8698 -> 0.4572   acc: 77.40% -> 84.25%             
client [8] (test)  loss: 0.5792 -> 0.1521   acc: 80.00% -> 95.41%              
client [35] (test)  loss: 0.4132 -> 0.2224   acc: 87.27% -> 93.06%             
client [98] (test)  loss: 0.6493 -> 0.3535   acc: 80.63% -> 89.53%             
client [53] (test)  loss: 0.4774 -> 0.4048   acc: 84.31% -> 85.88%             
client [43] (test)  loss: 0.8072 -> 0.3507   acc: 78.87% -> 87.71%             
client [64] (test)  loss: 0.7434 -> 0.2208   acc: 82.28% -> 91.14%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4507 -> 0.2685   acc: 85.05% -> 92.52%             
client [88] (test)  loss: 0.2251 -> 0.1150   acc: 93.59% -> 96.15%             
client [38] (test)  loss: 0.6755 -> 0.3544   acc: 79.82% -> 91.10%             
client [3] (test)  loss: 0.2548 -> 0.1831   acc: 90.20% -> 94.44%              
client [5] (test)  loss: 1.2839 -> 0.2442   acc: 71.43% -> 91.21%              
client [41] (test)  loss: 0.6582 -> 0.3267   acc: 79.60% -> 89.20%             
client [7] (test)  loss: 0.7985 -> 0.1458   acc: 79.25% -> 95.10%              
client [37] (test)  loss: 0.2593 -> 0.2619   acc: 91.33% -> 89.67%             
client [45] (test)  loss: 1.1573 -> 0.4348   acc: 70.66% -> 84.86%             
client [47] (test)  loss: 0.4560 -> 0.1752   acc: 82.83% -> 93.67%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2751 -> 0.2366   acc: 91.82% -> 91.82%             
client [11] (test)  loss: 0.8853 -> 0.4678   acc: 75.63% -> 84.87%             
client [37] (test)  loss: 0.1892 -> 0.2518   acc: 91.67% -> 90.00%             
client [41] (test)  loss: 0.9165 -> 0.3161   acc: 75.20% -> 88.80%             
client [95] (test)  loss: 0.4986 -> 0.3102   acc: 84.34% -> 90.76%             
client [53] (test)  loss: 0.5297 -> 0.3989   acc: 84.31% -> 87.06%             
client [22] (test)  loss: 0.3664 -> 0.1637   acc: 88.33% -> 96.11%             
client [25] (test)  loss: 0.5280 -> 0.2042   acc: 84.35% -> 92.33%             
client [69] (test)  loss: 0.3714 -> 0.2696   acc: 89.63% -> 92.31%             
client [46] (test)  loss: 0.2252 -> 0.2090   acc: 91.03% -> 91.88%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3046 -> 0.1763   acc: 90.66% -> 94.28%             
client [69] (test)  loss: 0.4006 -> 0.2996   acc: 87.63% -> 90.97%             
client [82] (test)  loss: 0.6948 -> 0.3822   acc: 79.29% -> 88.03%             
client [45] (test)  loss: 0.6670 -> 0.4252   acc: 78.23% -> 85.17%             
client [7] (test)  loss: 0.3325 -> 0.1394   acc: 89.34% -> 95.10%              
client [50] (test)  loss: 0.4444 -> 0.1692   acc: 86.50% -> 94.53%             
client [35] (test)  loss: 0.2554 -> 0.1939   acc: 92.59% -> 95.37%             
client [24] (test)  loss: 1.0621 -> 0.3589   acc: 69.04% -> 87.82%             
client [15] (test)  loss: 0.1443 -> 0.0675   acc: 94.38% -> 97.50%             
client [58] (test)  loss: 1.1218 -> 0.2370   acc: 67.76% -> 91.94%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4631 -> 0.3478   acc: 84.46% -> 89.53%             
client [76] (test)  loss: 0.6668 -> 0.2632   acc: 80.11% -> 90.46%             
client [67] (test)  loss: 0.3729 -> 0.3378   acc: 89.96% -> 91.12%             
client [37] (test)  loss: 0.2873 -> 0.2377   acc: 89.00% -> 91.33%             
client [58] (test)  loss: 0.7935 -> 0.2240   acc: 76.32% -> 92.19%             
client [64] (test)  loss: 0.4304 -> 0.2458   acc: 87.97% -> 91.77%             
client [77] (test)  loss: 0.4827 -> 0.3945   acc: 84.60% -> 88.25%             
client [55] (test)  loss: 0.2946 -> 0.1418   acc: 91.57% -> 95.18%             
client [12] (test)  loss: 0.3201 -> 0.3318   acc: 92.13% -> 87.01%             
client [89] (test)  loss: 0.2302 -> 0.1727   acc: 93.08% -> 93.95%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7483 -> 0.3327   acc: 78.65% -> 89.68%             
client [51] (test)  loss: 0.4698 -> 0.3895   acc: 85.90% -> 88.89%             
client [8] (test)  loss: 0.2337 -> 0.1545   acc: 92.79% -> 95.08%              
client [18] (test)  loss: 0.1221 -> 0.0998   acc: 96.37% -> 97.03%             
client [94] (test)  loss: 0.3383 -> 0.1920   acc: 87.50% -> 94.92%             
client [81] (test)  loss: 0.4691 -> 0.4803   acc: 85.40% -> 85.84%             
client [3] (test)  loss: 0.2397 -> 0.1600   acc: 93.14% -> 94.77%              
client [11] (test)  loss: 0.9988 -> 0.4685   acc: 70.59% -> 84.03%             
client [95] (test)  loss: 0.5045 -> 0.3085   acc: 84.74% -> 90.36%             
client [67] (test)  loss: 0.3754 -> 0.3272   acc: 88.42% -> 92.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3202 -> 0.2180   acc: 91.59% -> 93.46%             
client [79] (test)  loss: 0.4706 -> 0.4082   acc: 87.73% -> 86.82%             
client [58] (test)  loss: 0.5079 -> 0.2392   acc: 83.88% -> 91.18%             
client [88] (test)  loss: 0.1902 -> 0.1167   acc: 93.59% -> 96.15%             
client [46] (test)  loss: 0.2081 -> 0.1890   acc: 92.31% -> 91.88%             
client [11] (test)  loss: 0.8753 -> 0.4630   acc: 76.05% -> 86.13%             
client [55] (test)  loss: 0.2969 -> 0.1318   acc: 92.17% -> 96.99%             
client [13] (test)  loss: 0.3378 -> 0.2207   acc: 90.45% -> 94.38%             
client [31] (test)  loss: 0.6553 -> 0.3536   acc: 81.94% -> 88.99%             
client [75] (test)  loss: 0.3555 -> 0.2652   acc: 87.83% -> 91.53%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1814 -> 0.1260   acc: 94.48% -> 96.01%             
client [7] (test)  loss: 0.3062 -> 0.1325   acc: 90.49% -> 96.25%              
client [57] (test)  loss: 0.2427 -> 0.2549   acc: 92.35% -> 91.33%             
client [13] (test)  loss: 0.2902 -> 0.2190   acc: 91.85% -> 94.10%             
client [43] (test)  loss: 0.5597 -> 0.3493   acc: 84.28% -> 88.70%             
client [91] (test)  loss: 0.3589 -> 0.2525   acc: 88.24% -> 90.91%             
client [10] (test)  loss: 0.2641 -> 0.2372   acc: 91.02% -> 91.41%             
client [64] (test)  loss: 0.3548 -> 0.2094   acc: 87.34% -> 94.94%             
client [82] (test)  loss: 0.4452 -> 0.3025   acc: 84.47% -> 89.97%             
client [22] (test)  loss: 0.3280 -> 0.1644   acc: 89.44% -> 95.00%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3594 -> 0.1638   acc: 87.58% -> 93.46%             
client [23] (test)  loss: 0.5617 -> 0.1544   acc: 84.17% -> 94.17%             
client [88] (test)  loss: 0.1179 -> 0.1201   acc: 95.51% -> 95.83%             
client [98] (test)  loss: 0.6783 -> 0.4060   acc: 84.29% -> 89.53%             
client [79] (test)  loss: 0.4223 -> 0.4045   acc: 88.18% -> 88.18%             
client [21] (test)  loss: 0.4268 -> 0.2375   acc: 88.79% -> 92.83%             
client [92] (test)  loss: 0.6553 -> 0.4766   acc: 77.65% -> 83.71%             
client [56] (test)  loss: 0.1698 -> 0.1477   acc: 94.79% -> 96.32%             
client [5] (test)  loss: 0.7687 -> 0.2438   acc: 81.59% -> 92.86%              
client [52] (test)  loss: 0.4902 -> 0.2848   acc: 85.94% -> 92.65%             
==================== FedDyn_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.5205 -> 0.0000', 'accuracy': '83.61% -> 0.00%'},          
    200: {'loss': '0.4306 -> 0.0000', 'accuracy': '87.54% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn_1 achieved 10.0%(15.55%) at epoch: 0                                    
FedDyn_1 achieved 20.0%(22.28%) at epoch: 1                                    
FedDyn_1 achieved 40.0%(46.22%) at epoch: 7                                    
FedDyn_1 achieved 50.0%(52.39%) at epoch: 16                                   
FedDyn_1 achieved 60.0%(61.07%) at epoch: 20                                   
FedDyn_1 achieved 70.0%(74.78%) at epoch: 27                                   
FedDyn_1 achieved 80.0%(80.01%) at epoch: 44                                   
FedDyn_1 achieved 90.0%(90.16%) at epoch: 148                                  
Convergence (test_after):                                                      
FedDyn_1 achieved 30.0%(38.48%) at epoch: 0                                    
FedDyn_1 achieved 40.0%(43.74%) at epoch: 1                                    
FedDyn_1 achieved 50.0%(57.77%) at epoch: 3                                    
FedDyn_1 achieved 60.0%(67.34%) at epoch: 5                                    
FedDyn_1 achieved 70.0%(71.76%) at epoch: 8                                    
FedDyn_1 achieved 80.0%(80.21%) at epoch: 15                                   
FedDyn_1 achieved 90.0%(90.92%) at epoch: 45                                   
