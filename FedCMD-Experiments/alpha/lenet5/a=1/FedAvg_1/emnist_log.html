==================== ALGORITHM: FedAvg_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5680 -> 0.3860   acc: 80.33% -> 87.38%             
client [81] (test)  loss: 0.8902 -> 0.5687   acc: 76.97% -> 82.83%             
client [21] (test)  loss: 159.2276 -> 0.5796   acc: 45.27% -> 80.63%           
client [68] (test)  loss: 0.8594 -> 0.4498   acc: 74.58% -> 85.43%             
client [93] (test)  loss: 1.0326 -> 0.6507   acc: 72.57% -> 79.14%             
client [31] (test)  loss: 1.9246 -> 0.5432   acc: 55.58% -> 82.71%             
client [20] (test)  loss: 0.5579 -> 0.4404   acc: 81.97% -> 85.64%             
client [59] (test)  loss: 57.3320 -> 0.3205   acc: 68.72% -> 89.60%            
client [48] (test)  loss: 0.9266 -> 0.6651   acc: 74.61% -> 76.20%             
client [34] (test)  loss: 1.0791 -> 0.5714   acc: 67.18% -> 81.37%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4034 -> 0.1980   acc: 74.49% -> 93.67%             
client [99] (test)  loss: 0.7926 -> 0.5292   acc: 78.17% -> 82.59%             
client [67] (test)  loss: 0.4728 -> 0.2546   acc: 83.94% -> 92.20%             
client [0] (test)  loss: 0.8816 -> 0.5238   acc: 75.17% -> 80.90%              
client [76] (test)  loss: 0.8360 -> 0.4722   acc: 77.89% -> 84.21%             
client [41] (test)  loss: 1.0464 -> 0.5864   acc: 72.26% -> 76.72%             
client [62] (test)  loss: 343.3022 -> 0.4144   acc: 32.83% -> 86.08%           
client [2] (test)  loss: 336.1884 -> 0.4786   acc: 36.24% -> 84.80%            
client [14] (test)  loss: 0.7930 -> 0.5107   acc: 78.01% -> 82.37%             
client [46] (test)  loss: 1.4573 -> 0.4852   acc: 62.66% -> 85.26%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5024 -> 0.4297   acc: 81.66% -> 83.47%             
client [68] (test)  loss: 0.5496 -> 0.3693   acc: 82.42% -> 87.69%             
client [57] (test)  loss: 0.4195 -> 0.2299   acc: 86.55% -> 91.67%             
client [17] (test)  loss: 0.4602 -> 0.3277   acc: 86.17% -> 89.15%             
client [54] (test)  loss: 0.4300 -> 0.2782   acc: 85.19% -> 90.14%             
client [23] (test)  loss: 342.3258 -> 0.5513   acc: 37.47% -> 81.97%           
client [35] (test)  loss: 0.7922 -> 0.5347   acc: 75.69% -> 82.12%             
client [59] (test)  loss: 0.3779 -> 0.2504   acc: 88.22% -> 91.81%             
client [31] (test)  loss: 0.5230 -> 0.4483   acc: 82.20% -> 84.91%             
client [9] (test)  loss: 0.8569 -> 0.5089   acc: 73.16% -> 80.66%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7474 -> 0.3978   acc: 75.71% -> 85.97%             
client [33] (test)  loss: 0.8013 -> 0.4854   acc: 74.42% -> 83.42%             
client [16] (test)  loss: 0.8345 -> 0.5024   acc: 71.25% -> 83.46%             
client [44] (test)  loss: 2.1639 -> 0.5775   acc: 63.59% -> 76.01%             
client [8] (test)  loss: 0.4271 -> 0.3620   acc: 86.93% -> 87.77%              
client [31] (test)  loss: 0.6240 -> 0.4284   acc: 80.59% -> 85.30%             
client [47] (test)  loss: 0.4887 -> 0.2142   acc: 83.33% -> 91.94%             
client [36] (test)  loss: 0.4634 -> 0.1532   acc: 84.54% -> 94.98%             
client [20] (test)  loss: 0.4395 -> 0.3330   acc: 86.09% -> 88.54%             
client [56] (test)  loss: 0.4669 -> 0.3141   acc: 84.31% -> 88.40%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6029 -> 0.3453   acc: 80.51% -> 87.47%              
client [60] (test)  loss: 0.3778 -> 0.2420   acc: 87.91% -> 91.04%             
client [28] (test)  loss: 0.4036 -> 0.2538   acc: 86.52% -> 92.51%             
client [25] (test)  loss: 0.2915 -> 0.1597   acc: 90.99% -> 95.07%             
client [58] (test)  loss: 0.3964 -> 0.2593   acc: 88.00% -> 91.89%             
client [44] (test)  loss: 0.7825 -> 0.5644   acc: 74.45% -> 76.53%             
client [39] (test)  loss: 0.6353 -> 0.4126   acc: 76.71% -> 85.53%             
client [29] (test)  loss: 0.6860 -> 0.4284   acc: 78.22% -> 86.93%             
client [3] (test)  loss: 0.3849 -> 0.2902   acc: 86.79% -> 89.14%              
client [84] (test)  loss: 0.6691 -> 0.4847   acc: 79.07% -> 84.18%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9949 -> 0.4388   acc: 73.49% -> 84.87%             
client [84] (test)  loss: 0.9678 -> 0.4770   acc: 73.17% -> 84.05%             
client [10] (test)  loss: 0.9629 -> 0.3766   acc: 72.34% -> 87.95%             
client [36] (test)  loss: 0.3799 -> 0.1423   acc: 87.44% -> 95.15%             
client [65] (test)  loss: 0.3013 -> 0.2268   acc: 90.38% -> 92.96%             
client [81] (test)  loss: 0.9262 -> 0.4201   acc: 78.13% -> 87.13%             
client [79] (test)  loss: 0.2181 -> 0.1840   acc: 93.32% -> 93.81%             
client [42] (test)  loss: 0.8961 -> 0.3523   acc: 72.09% -> 88.74%             
client [11] (test)  loss: 0.5061 -> 0.3232   acc: 86.16% -> 89.95%             
client [96] (test)  loss: 0.3180 -> 0.2599   acc: 89.21% -> 90.50%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3924 -> 0.3426   acc: 87.70% -> 88.57%              
client [53] (test)  loss: 0.2459 -> 0.1601   acc: 92.79% -> 94.90%             
client [52] (test)  loss: 0.9535 -> 0.4200   acc: 69.43% -> 85.69%             
client [42] (test)  loss: 0.5974 -> 0.3453   acc: 77.04% -> 88.98%             
client [69] (test)  loss: 0.2647 -> 0.1729   acc: 91.69% -> 94.18%             
client [59] (test)  loss: 0.3024 -> 0.2240   acc: 90.48% -> 92.91%             
client [7] (test)  loss: 0.6688 -> 0.4782   acc: 76.12% -> 82.08%              
client [26] (test)  loss: 0.2674 -> 0.2033   acc: 91.36% -> 93.08%             
client [49] (test)  loss: 0.4304 -> 0.3460   acc: 86.37% -> 88.10%             
client [98] (test)  loss: 0.4554 -> 0.3952   acc: 84.48% -> 85.40%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5498 -> 0.3915   acc: 82.65% -> 85.61%             
client [47] (test)  loss: 0.2988 -> 0.2049   acc: 89.09% -> 92.46%             
client [21] (test)  loss: 0.6093 -> 0.4266   acc: 80.95% -> 85.31%             
client [77] (test)  loss: 0.3049 -> 0.2171   acc: 89.59% -> 90.82%             
client [95] (test)  loss: 0.4491 -> 0.3155   acc: 86.25% -> 89.19%             
client [91] (test)  loss: 1.2574 -> 0.5047   acc: 68.37% -> 83.02%             
client [14] (test)  loss: 0.6985 -> 0.4315   acc: 79.20% -> 85.08%             
client [99] (test)  loss: 0.6741 -> 0.4544   acc: 79.61% -> 84.52%             
client [20] (test)  loss: 0.4195 -> 0.3091   acc: 86.45% -> 89.69%             
client [39] (test)  loss: 0.7727 -> 0.3942   acc: 75.83% -> 85.73%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9268 -> 0.4184   acc: 71.30% -> 85.84%             
client [62] (test)  loss: 0.6544 -> 0.3495   acc: 81.30% -> 88.35%             
client [71] (test)  loss: 0.6687 -> 0.4655   acc: 80.47% -> 83.97%             
client [97] (test)  loss: 0.2640 -> 0.1908   acc: 92.14% -> 94.07%             
client [30] (test)  loss: 0.3283 -> 0.2214   acc: 89.15% -> 92.46%             
client [88] (test)  loss: 0.4135 -> 0.3056   acc: 86.83% -> 89.83%             
client [60] (test)  loss: 0.3188 -> 0.2259   acc: 89.85% -> 91.47%             
client [82] (test)  loss: 0.3936 -> 0.2919   acc: 85.62% -> 88.71%             
client [91] (test)  loss: 1.0633 -> 0.5044   acc: 68.16% -> 82.73%             
client [57] (test)  loss: 0.3702 -> 0.1984   acc: 87.27% -> 92.37%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4813 -> 0.4055   acc: 82.47% -> 86.42%             
client [15] (test)  loss: 0.4420 -> 0.3944   acc: 83.55% -> 84.68%             
client [71] (test)  loss: 0.6986 -> 0.4564   acc: 76.46% -> 84.17%             
client [97] (test)  loss: 0.2992 -> 0.1896   acc: 89.01% -> 93.88%             
client [53] (test)  loss: 0.3733 -> 0.1617   acc: 83.88% -> 94.93%             
client [77] (test)  loss: 0.3181 -> 0.2077   acc: 88.41% -> 91.43%             
client [76] (test)  loss: 0.6337 -> 0.3752   acc: 77.48% -> 86.82%             
client [79] (test)  loss: 0.3652 -> 0.1691   acc: 86.82% -> 94.35%             
client [28] (test)  loss: 0.5668 -> 0.2323   acc: 78.53% -> 93.24%             
client [99] (test)  loss: 0.5953 -> 0.4429   acc: 78.31% -> 84.91%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2646 -> 0.1868   acc: 91.78% -> 94.03%             
client [86] (test)  loss: 0.2425 -> 0.1880   acc: 93.40% -> 94.07%             
client [34] (test)  loss: 0.8111 -> 0.4222   acc: 72.79% -> 85.00%             
client [73] (test)  loss: 0.6862 -> 0.4295   acc: 77.08% -> 85.26%             
client [5] (test)  loss: 0.6846 -> 0.3580   acc: 82.19% -> 87.94%              
client [96] (test)  loss: 0.2928 -> 0.2393   acc: 90.43% -> 91.06%             
client [22] (test)  loss: 0.8526 -> 0.3868   acc: 73.13% -> 87.78%             
client [60] (test)  loss: 0.3222 -> 0.2264   acc: 90.13% -> 91.35%             
client [66] (test)  loss: 0.3709 -> 0.2661   acc: 87.38% -> 89.86%             
client [83] (test)  loss: 0.4465 -> 0.3451   acc: 84.93% -> 87.68%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6587 -> 0.3777   acc: 82.29% -> 86.79%             
client [65] (test)  loss: 0.2621 -> 0.2103   acc: 91.89% -> 93.42%             
client [95] (test)  loss: 0.3922 -> 0.3047   acc: 88.51% -> 90.05%             
client [17] (test)  loss: 0.4473 -> 0.2782   acc: 88.59% -> 91.39%             
client [8] (test)  loss: 0.3725 -> 0.3232   acc: 88.96% -> 89.61%              
client [35] (test)  loss: 0.8739 -> 0.4825   acc: 75.20% -> 83.61%             
client [98] (test)  loss: 0.5390 -> 0.3801   acc: 84.48% -> 85.97%             
client [53] (test)  loss: 0.2064 -> 0.1605   acc: 93.61% -> 95.07%             
client [43] (test)  loss: 0.4536 -> 0.3210   acc: 86.21% -> 89.23%             
client [64] (test)  loss: 0.7632 -> 0.3625   acc: 77.89% -> 87.13%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6126 -> 0.4140   acc: 82.20% -> 85.97%             
client [88] (test)  loss: 0.4493 -> 0.3031   acc: 86.42% -> 89.62%             
client [38] (test)  loss: 0.6619 -> 0.3768   acc: 81.87% -> 85.82%             
client [3] (test)  loss: 0.3812 -> 0.2621   acc: 86.82% -> 89.90%              
client [5] (test)  loss: 0.7034 -> 0.3549   acc: 81.81% -> 88.26%              
client [41] (test)  loss: 0.7893 -> 0.5104   acc: 76.53% -> 81.52%             
client [7] (test)  loss: 0.7019 -> 0.4606   acc: 76.63% -> 82.84%              
client [37] (test)  loss: 1.0329 -> 0.5781   acc: 73.44% -> 79.43%             
client [45] (test)  loss: 0.4429 -> 0.3566   acc: 85.28% -> 87.46%             
client [47] (test)  loss: 0.2905 -> 0.2016   acc: 88.65% -> 92.70%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8855 -> 0.4520   acc: 70.40% -> 84.67%             
client [11] (test)  loss: 0.3960 -> 0.3038   acc: 88.00% -> 90.53%             
client [37] (test)  loss: 0.7711 -> 0.5819   acc: 73.87% -> 78.88%             
client [41] (test)  loss: 0.6015 -> 0.5133   acc: 78.00% -> 81.42%             
client [95] (test)  loss: 0.4726 -> 0.2966   acc: 85.54% -> 90.20%             
client [53] (test)  loss: 0.3778 -> 0.1590   acc: 87.11% -> 95.07%             
client [22] (test)  loss: 0.7101 -> 0.3828   acc: 74.92% -> 87.78%             
client [25] (test)  loss: 0.3011 -> 0.1374   acc: 90.16% -> 95.86%             
client [69] (test)  loss: 0.3463 -> 0.1723   acc: 87.97% -> 94.62%             
client [46] (test)  loss: 0.7049 -> 0.3794   acc: 74.02% -> 88.77%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3212 -> 0.2023   acc: 87.92% -> 92.77%             
client [69] (test)  loss: 0.3641 -> 0.1720   acc: 88.23% -> 94.49%             
client [82] (test)  loss: 0.3874 -> 0.2865   acc: 85.60% -> 89.07%             
client [45] (test)  loss: 0.4006 -> 0.3609   acc: 86.16% -> 87.41%             
client [7] (test)  loss: 0.5802 -> 0.4516   acc: 77.74% -> 82.94%              
client [50] (test)  loss: 0.3489 -> 0.2893   acc: 89.51% -> 90.43%             
client [35] (test)  loss: 0.8123 -> 0.4828   acc: 76.21% -> 83.88%             
client [24] (test)  loss: 0.5027 -> 0.3880   acc: 82.42% -> 85.69%             
client [15] (test)  loss: 0.5253 -> 0.3896   acc: 80.87% -> 85.22%             
client [58] (test)  loss: 0.3670 -> 0.2425   acc: 86.95% -> 92.79%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5667 -> 0.4560   acc: 82.51% -> 84.68%             
client [76] (test)  loss: 0.6751 -> 0.3710   acc: 81.12% -> 87.38%             
client [67] (test)  loss: 0.3626 -> 0.2176   acc: 89.00% -> 93.94%             
client [37] (test)  loss: 0.8347 -> 0.5844   acc: 73.32% -> 79.60%             
client [58] (test)  loss: 0.3331 -> 0.2402   acc: 88.82% -> 92.67%             
client [64] (test)  loss: 0.5858 -> 0.3574   acc: 79.82% -> 87.41%             
client [77] (test)  loss: 0.3319 -> 0.1885   acc: 88.53% -> 92.09%             
client [55] (test)  loss: 0.4459 -> 0.2655   acc: 85.32% -> 90.58%             
client [12] (test)  loss: 0.5473 -> 0.3912   acc: 82.38% -> 87.16%             
client [89] (test)  loss: 0.5165 -> 0.3240   acc: 85.04% -> 89.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7469 -> 0.4731   acc: 74.97% -> 84.60%             
client [51] (test)  loss: 0.7068 -> 0.4906   acc: 74.39% -> 82.61%             
client [8] (test)  loss: 0.4169 -> 0.3247   acc: 86.71% -> 89.85%              
client [18] (test)  loss: 0.5552 -> 0.3776   acc: 79.83% -> 88.03%             
client [94] (test)  loss: 0.2877 -> 0.1647   acc: 90.70% -> 94.39%             
client [81] (test)  loss: 0.5692 -> 0.4054   acc: 82.28% -> 87.68%             
client [3] (test)  loss: 0.3263 -> 0.2702   acc: 88.48% -> 89.83%              
client [11] (test)  loss: 0.3884 -> 0.3056   acc: 87.78% -> 90.44%             
client [95] (test)  loss: 0.4465 -> 0.2962   acc: 86.37% -> 90.45%             
client [67] (test)  loss: 0.3944 -> 0.2138   acc: 88.48% -> 93.99%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5881 -> 0.4160   acc: 81.71% -> 86.07%             
client [79] (test)  loss: 0.2435 -> 0.1729   acc: 93.25% -> 94.75%             
client [58] (test)  loss: 0.3634 -> 0.2431   acc: 88.12% -> 92.55%             
client [88] (test)  loss: 0.4153 -> 0.3012   acc: 87.55% -> 89.74%             
client [46] (test)  loss: 0.8397 -> 0.3807   acc: 68.12% -> 88.84%             
client [11] (test)  loss: 0.3822 -> 0.3074   acc: 88.43% -> 90.44%             
client [55] (test)  loss: 0.3877 -> 0.2649   acc: 86.79% -> 90.23%             
client [13] (test)  loss: 0.6340 -> 0.3275   acc: 74.81% -> 89.51%             
client [31] (test)  loss: 0.5072 -> 0.4032   acc: 83.83% -> 86.74%             
client [75] (test)  loss: 0.4112 -> 0.3193   acc: 86.03% -> 89.08%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6080 -> 0.3653   acc: 83.80% -> 88.56%             
client [7] (test)  loss: 0.6731 -> 0.4550   acc: 76.44% -> 83.24%              
client [57] (test)  loss: 0.3191 -> 0.1931   acc: 88.41% -> 92.73%             
client [13] (test)  loss: 0.8074 -> 0.3278   acc: 72.07% -> 89.51%             
client [43] (test)  loss: 0.5241 -> 0.3298   acc: 84.57% -> 89.28%             
client [91] (test)  loss: 1.0669 -> 0.5107   acc: 68.45% -> 83.07%             
client [10] (test)  loss: 0.6448 -> 0.3700   acc: 79.28% -> 88.18%             
client [64] (test)  loss: 0.7277 -> 0.3659   acc: 78.58% -> 87.38%             
client [82] (test)  loss: 0.4329 -> 0.2906   acc: 85.16% -> 89.19%             
client [22] (test)  loss: 0.8860 -> 0.3880   acc: 73.06% -> 87.41%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.4695 -> 0.3192   acc: 85.69% -> 90.25%             
client [23] (test)  loss: 0.7499 -> 0.5164   acc: 79.69% -> 83.27%             
client [88] (test)  loss: 0.4506 -> 0.3091   acc: 86.88% -> 89.52%             
client [98] (test)  loss: 0.4720 -> 0.3796   acc: 84.50% -> 86.70%             
client [79] (test)  loss: 0.2431 -> 0.1757   acc: 93.69% -> 94.60%             
client [21] (test)  loss: 0.5495 -> 0.4231   acc: 82.52% -> 86.10%             
client [92] (test)  loss: 0.5992 -> 0.4165   acc: 82.86% -> 86.46%             
client [56] (test)  loss: 0.4213 -> 0.2890   acc: 85.91% -> 89.44%             
client [5] (test)  loss: 0.6907 -> 0.3617   acc: 81.17% -> 88.07%              
client [52] (test)  loss: 0.8769 -> 0.4133   acc: 71.27% -> 86.20%             
==================== FedAvg_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.4980 -> 0.0000', 'accuracy': '82.22% -> 0.00%'},          
    200: {'loss': '0.5251 -> 0.0000', 'accuracy': '83.35% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_1 achieved 30.0%(33.08%) at epoch: 1                                    
FedAvg_1 achieved 50.0%(50.92%) at epoch: 2                                    
FedAvg_1 achieved 60.0%(63.89%) at epoch: 4                                    
FedAvg_1 achieved 70.0%(72.21%) at epoch: 13                                   
FedAvg_1 achieved 80.0%(83.56%) at epoch: 30                                   
Convergence (test_after):                                                      
FedAvg_1 achieved 60.0%(62.28%) at epoch: 0                                    
FedAvg_1 achieved 70.0%(74.14%) at epoch: 1                                    
FedAvg_1 achieved 80.0%(80.20%) at epoch: 2                                    
FedAvg_1 achieved 90.0%(90.12%) at epoch: 60                                   
