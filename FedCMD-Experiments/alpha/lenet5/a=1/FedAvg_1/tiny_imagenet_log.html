==================== ALGORITHM: FedAvg_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1718 -> 4.9633   acc: 2.16% -> 4.68%               
client [81] (test)  loss: 5.1909 -> 4.9449   acc: 2.40% -> 4.24%               
client [21] (test)  loss: 5.2412 -> 4.9151   acc: 1.45% -> 3.99%               
client [68] (test)  loss: 5.1030 -> 4.8145   acc: 1.99% -> 6.69%               
client [93] (test)  loss: 5.0923 -> 5.1192   acc: 2.36% -> 3.09%               
client [31] (test)  loss: 5.1535 -> 5.0036   acc: 2.70% -> 4.86%               
client [20] (test)  loss: 5.2346 -> 4.8394   acc: 2.08% -> 8.51%               
client [59] (test)  loss: 5.2568 -> 4.8631   acc: 2.55% -> 2.73%               
client [48] (test)  loss: 5.1554 -> 4.8805   acc: 2.33% -> 3.58%               
client [34] (test)  loss: 5.1196 -> 5.0939   acc: 1.64% -> 2.00%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.2768 -> 4.5681   acc: 2.04% -> 7.96%               
client [99] (test)  loss: 5.6473 -> 4.9931   acc: 2.71% -> 3.97%               
client [67] (test)  loss: 4.8739 -> 4.5743   acc: 5.78% -> 9.33%               
client [0] (test)  loss: 4.7058 -> 4.7200   acc: 5.62% -> 7.61%                
client [76] (test)  loss: 4.7578 -> 4.4581   acc: 5.44% -> 7.08%               
client [41] (test)  loss: 5.3793 -> 4.7039   acc: 1.63% -> 3.62%               
client [62] (test)  loss: 5.1556 -> 4.7873   acc: 1.44% -> 5.92%               
client [2] (test)  loss: 5.1856 -> 5.1147   acc: 2.88% -> 3.65%                
client [14] (test)  loss: 4.6847 -> 4.8346   acc: 7.40% -> 6.68%               
client [46] (test)  loss: 5.0801 -> 4.6706   acc: 3.81% -> 5.08%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7402 -> 4.3247   acc: 8.73% -> 13.37%              
client [68] (test)  loss: 4.5837 -> 4.5033   acc: 7.41% -> 10.13%              
client [57] (test)  loss: 4.5558 -> 4.5326   acc: 7.08% -> 11.62%              
client [17] (test)  loss: 6.4907 -> 4.5828   acc: 3.78% -> 8.83%               
client [54] (test)  loss: 4.5596 -> 4.4921   acc: 6.90% -> 9.26%               
client [23] (test)  loss: 5.1085 -> 4.7542   acc: 1.99% -> 5.97%               
client [35] (test)  loss: 4.6887 -> 4.3981   acc: 6.35% -> 10.71%              
client [59] (test)  loss: 4.5240 -> 4.4090   acc: 5.64% -> 10.36%              
client [31] (test)  loss: 4.5330 -> 4.7598   acc: 6.67% -> 7.57%               
client [9] (test)  loss: 4.7048 -> 4.6382   acc: 7.05% -> 7.05%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6398 -> 4.4857   acc: 7.99% -> 11.15%              
client [33] (test)  loss: 4.4347 -> 4.4886   acc: 8.70% -> 8.70%               
client [16] (test)  loss: 4.3869 -> 4.3655   acc: 9.87% -> 10.77%              
client [44] (test)  loss: 11.5102 -> 4.4563   acc: 2.84% -> 11.19%             
client [8] (test)  loss: 4.6377 -> 4.5805   acc: 6.32% -> 9.39%                
client [31] (test)  loss: 4.5747 -> 4.7505   acc: 5.59% -> 7.39%               
client [47] (test)  loss: 4.8148 -> 4.5091   acc: 7.40% -> 9.03%               
client [36] (test)  loss: 4.5748 -> 4.3084   acc: 7.09% -> 11.64%              
client [20] (test)  loss: 4.7247 -> 4.2982   acc: 7.56% -> 13.04%              
client [56] (test)  loss: 4.6424 -> 4.4034   acc: 10.83% -> 11.01%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4951 -> 4.3925   acc: 9.07% -> 8.89%                
client [60] (test)  loss: 5.3829 -> 4.3536   acc: 8.81% -> 14.03%              
client [28] (test)  loss: 5.3055 -> 4.7178   acc: 10.53% -> 8.17%              
client [25] (test)  loss: 5.9727 -> 4.3280   acc: 7.03% -> 12.43%              
client [58] (test)  loss: 4.5863 -> 4.4923   acc: 10.09% -> 11.71%             
client [44] (test)  loss: 4.3594 -> 4.4244   acc: 11.37% -> 11.19%             
client [39] (test)  loss: 4.3040 -> 4.2986   acc: 12.18% -> 12.36%             
client [29] (test)  loss: 5.3280 -> 4.2792   acc: 6.65% -> 12.96%              
client [3] (test)  loss: 4.8772 -> 4.3455   acc: 6.08% -> 14.31%               
client [84] (test)  loss: 4.4597 -> 4.2754   acc: 13.04% -> 13.95%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.3186 -> 4.3976   acc: 8.17% -> 13.97%              
client [84] (test)  loss: 4.3613 -> 4.4098   acc: 12.86% -> 14.67%             
client [10] (test)  loss: 5.2285 -> 4.4440   acc: 10.61% -> 15.65%             
client [36] (test)  loss: 4.5073 -> 4.3622   acc: 8.00% -> 14.91%              
client [65] (test)  loss: 4.3773 -> 4.6993   acc: 12.16% -> 10.34%             
client [81] (test)  loss: 4.8628 -> 4.3624   acc: 9.41% -> 11.81%              
client [79] (test)  loss: 4.5089 -> 4.6605   acc: 10.48% -> 7.28%              
client [42] (test)  loss: 4.6382 -> 4.6383   acc: 10.57% -> 13.96%             
client [11] (test)  loss: 4.8045 -> 4.3923   acc: 8.09% -> 10.25%              
client [96] (test)  loss: 4.7686 -> 4.1847   acc: 9.73% -> 13.69%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.6550 -> 4.9272   acc: 11.19% -> 11.19%              
client [53] (test)  loss: 4.8006 -> 4.8492   acc: 7.58% -> 10.05%              
client [52] (test)  loss: 4.6664 -> 4.6979   acc: 11.78% -> 12.86%             
client [42] (test)  loss: 4.5895 -> 4.8259   acc: 11.32% -> 13.77%             
client [69] (test)  loss: 4.5230 -> 4.5939   acc: 10.74% -> 12.78%             
client [59] (test)  loss: 4.5245 -> 4.5032   acc: 9.09% -> 12.55%              
client [7] (test)  loss: 5.7626 -> 4.5897   acc: 7.07% -> 12.14%               
client [26] (test)  loss: 4.5921 -> 4.4177   acc: 10.25% -> 12.95%             
client [49] (test)  loss: 4.4885 -> 4.7682   acc: 10.65% -> 11.73%             
client [98] (test)  loss: 4.4134 -> 4.6105   acc: 10.55% -> 12.18%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.6022 -> 4.7695   acc: 11.09% -> 11.27%             
client [47] (test)  loss: 5.6232 -> 4.6950   acc: 10.11% -> 13.36%             
client [21] (test)  loss: 4.5106 -> 4.7568   acc: 10.89% -> 11.07%             
client [77] (test)  loss: 4.5380 -> 4.8359   acc: 10.07% -> 10.61%             
client [95] (test)  loss: 4.7148 -> 4.8417   acc: 11.63% -> 12.20%             
client [91] (test)  loss: 4.9540 -> 5.0931   acc: 10.91% -> 10.55%             
client [14] (test)  loss: 4.5793 -> 4.8964   acc: 9.57% -> 11.55%              
client [99] (test)  loss: 4.5810 -> 5.0723   acc: 11.19% -> 11.01%             
client [20] (test)  loss: 4.7914 -> 4.4799   acc: 10.40% -> 19.66%             
client [39] (test)  loss: 4.6493 -> 4.5253   acc: 12.73% -> 13.09%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.0443 -> 5.0189   acc: 10.51% -> 13.59%             
client [62] (test)  loss: 4.8311 -> 5.1342   acc: 10.95% -> 10.59%             
client [71] (test)  loss: 4.7868 -> 5.0079   acc: 12.01% -> 11.83%             
client [97] (test)  loss: 4.8937 -> 4.9699   acc: 12.00% -> 11.09%             
client [30] (test)  loss: 4.5281 -> 5.1693   acc: 12.14% -> 10.51%             
client [88] (test)  loss: 4.9334 -> 4.8524   acc: 10.31% -> 13.02%             
client [60] (test)  loss: 5.1139 -> 4.8488   acc: 10.25% -> 13.67%             
client [82] (test)  loss: 4.7051 -> 4.6965   acc: 12.86% -> 16.25%             
client [91] (test)  loss: 5.0497 -> 5.3748   acc: 9.09% -> 11.09%              
client [57] (test)  loss: 4.6019 -> 4.7878   acc: 11.80% -> 14.16%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.4141 -> 5.3507   acc: 9.37% -> 14.05%              
client [15] (test)  loss: 5.0284 -> 5.0976   acc: 9.16% -> 9.34%               
client [71] (test)  loss: 4.9267 -> 5.0640   acc: 11.65% -> 11.11%             
client [97] (test)  loss: 4.7663 -> 5.1377   acc: 14.36% -> 10.73%             
client [53] (test)  loss: 5.3993 -> 5.3759   acc: 7.41% -> 9.88%               
client [77] (test)  loss: 4.9013 -> 4.9293   acc: 12.41% -> 12.77%             
client [76] (test)  loss: 4.7371 -> 4.9566   acc: 13.07% -> 14.88%             
client [79] (test)  loss: 5.0101 -> 5.0603   acc: 10.83% -> 10.48%             
client [28] (test)  loss: 4.8649 -> 5.3198   acc: 10.53% -> 10.89%             
client [99] (test)  loss: 5.1270 -> 5.3091   acc: 12.09% -> 12.45%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.8798 -> 5.2319   acc: 14.18% -> 10.91%             
client [86] (test)  loss: 4.7799 -> 5.1862   acc: 9.80% -> 10.89%              
client [34] (test)  loss: 5.1433 -> 5.2084   acc: 8.36% -> 11.27%              
client [73] (test)  loss: 5.0115 -> 5.2282   acc: 10.57% -> 11.99%             
client [5] (test)  loss: 5.1235 -> 5.3392   acc: 8.54% -> 8.19%                
client [96] (test)  loss: 4.6811 -> 4.7888   acc: 13.15% -> 15.32%             
client [22] (test)  loss: 4.8242 -> 4.8557   acc: 11.21% -> 14.10%             
client [60] (test)  loss: 5.2414 -> 5.1880   acc: 9.89% -> 14.03%              
client [66] (test)  loss: 5.2108 -> 5.1556   acc: 10.47% -> 14.08%             
client [83] (test)  loss: 5.4304 -> 5.3768   acc: 12.12% -> 13.20%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.1714 -> 5.1793   acc: 13.43% -> 17.06%             
client [65] (test)  loss: 4.9882 -> 5.4731   acc: 12.34% -> 10.89%             
client [95] (test)  loss: 5.3490 -> 5.4048   acc: 10.13% -> 12.38%             
client [17] (test)  loss: 5.7247 -> 5.2273   acc: 11.35% -> 11.89%             
client [8] (test)  loss: 5.4259 -> 5.3558   acc: 11.37% -> 11.55%              
client [35] (test)  loss: 5.1982 -> 5.2424   acc: 10.89% -> 14.16%             
client [98] (test)  loss: 5.0238 -> 5.4353   acc: 10.18% -> 12.36%             
client [53] (test)  loss: 5.2084 -> 5.5607   acc: 8.82% -> 9.88%               
client [43] (test)  loss: 5.2172 -> 5.1110   acc: 10.87% -> 9.96%              
client [64] (test)  loss: 5.3289 -> 5.4253   acc: 10.04% -> 12.83%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.4700 -> 5.2007   acc: 10.16% -> 15.06%             
client [88] (test)  loss: 5.4004 -> 5.3904   acc: 9.76% -> 13.02%              
client [38] (test)  loss: 5.4718 -> 5.4642   acc: 9.44% -> 10.19%              
client [3] (test)  loss: 5.6567 -> 5.5164   acc: 7.69% -> 13.06%               
client [5] (test)  loss: 5.4696 -> 5.5069   acc: 9.07% -> 8.90%                
client [41] (test)  loss: 5.2230 -> 5.4737   acc: 9.60% -> 10.33%              
client [7] (test)  loss: 5.2505 -> 5.1251   acc: 10.69% -> 12.86%              
client [37] (test)  loss: 5.3160 -> 5.3726   acc: 10.27% -> 11.71%             
client [45] (test)  loss: 5.3351 -> 5.0623   acc: 12.91% -> 13.09%             
client [47] (test)  loss: 5.8875 -> 5.2588   acc: 11.37% -> 14.62%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.4644 -> 5.4538   acc: 10.41% -> 14.36%             
client [11] (test)  loss: 5.2625 -> 5.1193   acc: 9.35% -> 16.19%              
client [37] (test)  loss: 5.2628 -> 5.4079   acc: 11.17% -> 12.43%             
client [41] (test)  loss: 5.3050 -> 5.5416   acc: 7.43% -> 11.23%              
client [95] (test)  loss: 5.4545 -> 5.5785   acc: 10.88% -> 12.76%             
client [53] (test)  loss: 5.8518 -> 5.5996   acc: 8.64% -> 11.29%              
client [22] (test)  loss: 5.1512 -> 5.1913   acc: 12.30% -> 14.10%             
client [25] (test)  loss: 5.2593 -> 5.3729   acc: 12.61% -> 11.71%             
client [69] (test)  loss: 5.6805 -> 5.5136   acc: 8.89% -> 12.22%              
client [46] (test)  loss: 5.4680 -> 5.3777   acc: 12.16% -> 12.70%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.2532 -> 5.4340   acc: 12.09% -> 14.26%             
client [69] (test)  loss: 5.6607 -> 5.6066   acc: 8.89% -> 12.04%              
client [82] (test)  loss: 5.2558 -> 5.2841   acc: 12.86% -> 17.68%             
client [45] (test)  loss: 5.1143 -> 5.2271   acc: 12.73% -> 11.45%             
client [7] (test)  loss: 5.4529 -> 5.1290   acc: 11.78% -> 12.86%              
client [50] (test)  loss: 5.4169 -> 5.6165   acc: 11.96% -> 13.95%             
client [35] (test)  loss: 5.2193 -> 5.4347   acc: 11.62% -> 14.34%             
client [24] (test)  loss: 5.8343 -> 5.1821   acc: 8.73% -> 16.22%              
client [15] (test)  loss: 5.5649 -> 5.3641   acc: 9.52% -> 12.03%              
client [58] (test)  loss: 5.3949 -> 5.7221   acc: 11.71% -> 14.05%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.3731 -> 5.4065   acc: 11.65% -> 13.98%             
client [76] (test)  loss: 5.4870 -> 5.4934   acc: 13.61% -> 17.60%             
client [67] (test)  loss: 5.4658 -> 5.3607   acc: 11.57% -> 15.30%             
client [37] (test)  loss: 5.8003 -> 5.5635   acc: 11.17% -> 12.97%             
client [58] (test)  loss: 5.7130 -> 5.8484   acc: 10.81% -> 13.15%             
client [64] (test)  loss: 5.6346 -> 5.7809   acc: 10.22% -> 12.08%             
client [77] (test)  loss: 5.4777 -> 5.3310   acc: 9.89% -> 13.67%              
client [55] (test)  loss: 5.8250 -> 5.6076   acc: 11.09% -> 13.95%             
client [12] (test)  loss: 5.9212 -> 5.8808   acc: 7.17% -> 9.68%               
client [89] (test)  loss: 5.5074 -> 5.3173   acc: 12.37% -> 15.41%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.5587 -> 5.6704   acc: 12.86% -> 14.49%             
client [51] (test)  loss: 5.3926 -> 5.5515   acc: 14.23% -> 16.94%             
client [8] (test)  loss: 5.6273 -> 5.9707   acc: 11.37% -> 13.72%              
client [18] (test)  loss: 5.1726 -> 5.5610   acc: 13.06% -> 12.88%             
client [94] (test)  loss: 5.8418 -> 5.8806   acc: 6.51% -> 11.75%              
client [81] (test)  loss: 5.8178 -> 5.7783   acc: 9.41% -> 8.67%               
client [3] (test)  loss: 6.1557 -> 5.8531   acc: 7.33% -> 12.16%               
client [11] (test)  loss: 5.6410 -> 5.4033   acc: 8.99% -> 17.63%              
client [95] (test)  loss: 5.9324 -> 5.8958   acc: 10.32% -> 13.51%             
client [67] (test)  loss: 5.7220 -> 5.4414   acc: 10.82% -> 13.81%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.9798 -> 5.4742   acc: 10.89% -> 15.06%             
client [79] (test)  loss: 5.5754 -> 5.7031   acc: 9.77% -> 12.08%              
client [58] (test)  loss: 5.8422 -> 6.0479   acc: 10.63% -> 12.43%             
client [88] (test)  loss: 6.0726 -> 5.7044   acc: 9.04% -> 13.02%              
client [46] (test)  loss: 6.0482 -> 5.5670   acc: 12.34% -> 12.70%             
client [11] (test)  loss: 5.7543 -> 5.4157   acc: 9.53% -> 16.37%              
client [55] (test)  loss: 5.7595 -> 5.8844   acc: 11.81% -> 13.60%             
client [13] (test)  loss: 6.0073 -> 5.7647   acc: 10.69% -> 14.13%             
client [31] (test)  loss: 6.4613 -> 6.0980   acc: 8.47% -> 13.87%              
client [75] (test)  loss: 5.7232 -> 5.6536   acc: 10.47% -> 17.15%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.8843 -> 5.9784   acc: 9.43% -> 10.25%              
client [7] (test)  loss: 5.5653 -> 5.4674   acc: 11.59% -> 14.67%              
client [57] (test)  loss: 5.5640 -> 5.7603   acc: 11.25% -> 14.88%             
client [13] (test)  loss: 6.1233 -> 5.7710   acc: 9.78% -> 14.86%              
client [43] (test)  loss: 5.6309 -> 5.6953   acc: 10.14% -> 11.41%             
client [91] (test)  loss: 6.4947 -> 6.2251   acc: 7.09% -> 10.18%              
client [10] (test)  loss: 6.0370 -> 5.9490   acc: 11.69% -> 13.67%             
client [64] (test)  loss: 5.7702 -> 6.0371   acc: 10.59% -> 12.27%             
client [82] (test)  loss: 5.7549 -> 5.6685   acc: 12.32% -> 18.04%             
client [22] (test)  loss: 5.5964 -> 5.5183   acc: 11.75% -> 12.84%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.9264 -> 5.5748   acc: 10.96% -> 17.77%             
client [23] (test)  loss: 6.3337 -> 6.2965   acc: 8.50% -> 6.87%               
client [88] (test)  loss: 6.2595 -> 5.7941   acc: 8.50% -> 13.02%              
client [98] (test)  loss: 5.7004 -> 6.1263   acc: 10.55% -> 11.45%             
client [79] (test)  loss: 5.6262 -> 5.8415   acc: 11.37% -> 11.19%             
client [21] (test)  loss: 5.8524 -> 5.6111   acc: 11.62% -> 14.52%             
client [92] (test)  loss: 6.0447 -> 5.7390   acc: 9.29% -> 15.89%              
client [56] (test)  loss: 5.9127 -> 5.5626   acc: 13.00% -> 16.43%             
client [5] (test)  loss: 6.0664 -> 6.0365   acc: 9.61% -> 9.25%                
client [52] (test)  loss: 6.2321 -> 6.2746   acc: 10.69% -> 13.41%             
==================== FedAvg_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '4.9853 -> 0.0000', 'accuracy': '11.11% -> 0.00%'},          
    200: {'loss': '6.0453 -> 0.0000', 'accuracy': '10.20% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_1 achieved 10.0%(10.30%) at epoch: 54                                   
Convergence (test_after):                                                      
FedAvg_1 achieved 10.0%(10.28%) at epoch: 34                                   
