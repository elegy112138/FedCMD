==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7403 -> 0.6545   acc: 70.00% -> 77.14%             
client [81] (test)  loss: 0.8259 -> 0.7495   acc: 66.11% -> 68.07%             
client [21] (test)  loss: 23.1452 -> 0.6632   acc: 37.50% -> 83.06%            
client [68] (test)  loss: 0.9642 -> 0.8133   acc: 70.25% -> 73.42%             
client [93] (test)  loss: 0.7108 -> 0.6212   acc: 77.78% -> 80.63%             
client [31] (test)  loss: 1.1307 -> 0.6837   acc: 65.01% -> 74.75%             
client [20] (test)  loss: 0.7933 -> 0.7384   acc: 75.16% -> 75.48%             
client [59] (test)  loss: 24.0774 -> 0.4283   acc: 26.29% -> 88.00%            
client [48] (test)  loss: 0.3237 -> 0.3017   acc: 87.93% -> 87.93%             
client [34] (test)  loss: 0.5400 -> 0.4524   acc: 82.61% -> 84.78%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5021 -> 0.3275   acc: 82.08% -> 89.35%             
client [99] (test)  loss: 0.4474 -> 0.3674   acc: 86.72% -> 88.70%             
client [67] (test)  loss: 0.4173 -> 0.3925   acc: 89.67% -> 89.42%             
client [0] (test)  loss: 0.5529 -> 0.5154   acc: 79.79% -> 81.38%              
client [76] (test)  loss: 0.3571 -> 0.3030   acc: 88.65% -> 89.08%             
client [41] (test)  loss: 0.6692 -> 0.6284   acc: 77.12% -> 76.01%             
client [62] (test)  loss: 41.4891 -> 0.5710   acc: 31.80% -> 82.26%            
client [2] (test)  loss: 37.9301 -> 0.5578   acc: 24.01% -> 78.55%             
client [14] (test)  loss: 0.4421 -> 0.4038   acc: 85.89% -> 86.15%             
client [46] (test)  loss: 0.3987 -> 0.3727   acc: 85.13% -> 85.42%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3812 -> 0.4186   acc: 86.40% -> 86.65%             
client [68] (test)  loss: 0.6161 -> 0.5061   acc: 74.05% -> 79.75%             
client [57] (test)  loss: 0.3972 -> 0.3528   acc: 89.17% -> 89.17%             
client [17] (test)  loss: 0.2668 -> 0.2396   acc: 90.31% -> 91.62%             
client [54] (test)  loss: 0.2570 -> 0.2573   acc: 91.17% -> 91.41%             
client [23] (test)  loss: 40.3760 -> 0.2452   acc: 4.67% -> 92.14%             
client [35] (test)  loss: 0.3675 -> 0.3552   acc: 86.57% -> 86.38%             
client [59] (test)  loss: 0.2329 -> 0.2415   acc: 92.00% -> 91.43%             
client [31] (test)  loss: 0.5217 -> 0.5269   acc: 77.73% -> 77.93%             
client [9] (test)  loss: 0.4337 -> 0.4245   acc: 83.63% -> 82.62%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.4409 -> 0.4374   acc: 84.99% -> 84.70%             
client [33] (test)  loss: 0.3950 -> 0.3790   acc: 85.14% -> 85.41%             
client [16] (test)  loss: 0.1821 -> 0.1898   acc: 94.50% -> 93.72%             
client [44] (test)  loss: 0.7577 -> 0.3182   acc: 76.65% -> 89.21%             
client [8] (test)  loss: 0.3904 -> 0.3963   acc: 84.19% -> 84.52%              
client [31] (test)  loss: 0.5132 -> 0.5032   acc: 78.93% -> 79.52%             
client [47] (test)  loss: 0.5218 -> 0.5016   acc: 80.15% -> 80.90%             
client [36] (test)  loss: 0.4942 -> 0.4534   acc: 80.06% -> 81.60%             
client [20] (test)  loss: 0.5644 -> 0.5834   acc: 80.25% -> 78.98%             
client [56] (test)  loss: 0.4520 -> 0.4524   acc: 84.38% -> 83.44%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6425 -> 0.5559   acc: 75.26% -> 76.03%              
client [60] (test)  loss: 0.2184 -> 0.2008   acc: 93.56% -> 94.80%             
client [28] (test)  loss: 0.6264 -> 0.5949   acc: 80.18% -> 81.57%             
client [25] (test)  loss: 0.3809 -> 0.3970   acc: 87.07% -> 86.02%             
client [58] (test)  loss: 0.2282 -> 0.2201   acc: 93.19% -> 91.36%             
client [44] (test)  loss: 0.3317 -> 0.2910   acc: 87.67% -> 88.99%             
client [39] (test)  loss: 0.3669 -> 0.3832   acc: 88.28% -> 84.20%             
client [29] (test)  loss: 0.6047 -> 0.5108   acc: 77.54% -> 84.13%             
client [3] (test)  loss: 0.3726 -> 0.3289   acc: 85.95% -> 89.53%              
client [84] (test)  loss: 0.3904 -> 0.3532   acc: 85.80% -> 86.96%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3357 -> 0.3323   acc: 88.33% -> 89.17%             
client [84] (test)  loss: 0.3337 -> 0.3485   acc: 88.99% -> 86.09%             
client [10] (test)  loss: 0.3703 -> 0.3010   acc: 86.11% -> 90.56%             
client [36] (test)  loss: 0.4427 -> 0.3948   acc: 83.13% -> 84.66%             
client [65] (test)  loss: 0.3658 -> 0.3419   acc: 87.28% -> 87.95%             
client [81] (test)  loss: 0.5191 -> 0.5108   acc: 80.11% -> 79.27%             
client [79] (test)  loss: 0.4882 -> 0.4708   acc: 79.28% -> 79.83%             
client [42] (test)  loss: 0.4508 -> 0.4150   acc: 86.05% -> 86.98%             
client [11] (test)  loss: 0.4473 -> 0.3925   acc: 87.32% -> 88.41%             
client [96] (test)  loss: 0.2116 -> 0.2454   acc: 93.35% -> 92.24%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3476 -> 0.3986   acc: 87.42% -> 85.48%              
client [53] (test)  loss: 0.1644 -> 0.1629   acc: 94.96% -> 94.30%             
client [52] (test)  loss: 0.4727 -> 0.4541   acc: 83.10% -> 81.99%             
client [42] (test)  loss: 0.4178 -> 0.3972   acc: 86.51% -> 86.51%             
client [69] (test)  loss: 0.2571 -> 0.2936   acc: 91.17% -> 90.39%             
client [59] (test)  loss: 0.2050 -> 0.2054   acc: 92.86% -> 92.57%             
client [7] (test)  loss: 0.4398 -> 0.4517   acc: 84.44% -> 84.44%              
client [26] (test)  loss: 0.3021 -> 0.2960   acc: 90.88% -> 89.82%             
client [49] (test)  loss: 0.4726 -> 0.4429   acc: 83.05% -> 83.29%             
client [98] (test)  loss: 0.4095 -> 0.5025   acc: 86.11% -> 80.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4277 -> 0.4599   acc: 86.11% -> 83.33%             
client [47] (test)  loss: 0.4624 -> 0.4382   acc: 83.15% -> 83.15%             
client [21] (test)  loss: 0.3386 -> 0.3192   acc: 90.00% -> 89.17%             
client [77] (test)  loss: 0.3028 -> 0.3361   acc: 88.21% -> 87.14%             
client [95] (test)  loss: 0.2924 -> 0.3156   acc: 89.86% -> 88.17%             
client [91] (test)  loss: 0.4630 -> 0.4084   acc: 82.89% -> 83.68%             
client [14] (test)  loss: 0.3152 -> 0.3034   acc: 88.66% -> 88.41%             
client [99] (test)  loss: 0.3188 -> 0.2650   acc: 88.98% -> 90.11%             
client [20] (test)  loss: 0.5616 -> 0.5048   acc: 82.17% -> 81.85%             
client [39] (test)  loss: 0.3384 -> 0.3411   acc: 87.47% -> 86.65%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5209 -> 0.4502   acc: 83.10% -> 83.93%             
client [62] (test)  loss: 0.4542 -> 0.4980   acc: 84.10% -> 84.10%             
client [71] (test)  loss: 0.3065 -> 0.2847   acc: 90.68% -> 89.83%             
client [97] (test)  loss: 0.4573 -> 0.4021   acc: 82.84% -> 86.19%             
client [30] (test)  loss: 0.3465 -> 0.3261   acc: 88.51% -> 90.20%             
client [88] (test)  loss: 0.3821 -> 0.4161   acc: 84.57% -> 84.02%             
client [60] (test)  loss: 0.1800 -> 0.1928   acc: 95.30% -> 95.05%             
client [82] (test)  loss: 0.3468 -> 0.3019   acc: 89.30% -> 90.30%             
client [91] (test)  loss: 0.5091 -> 0.4094   acc: 81.32% -> 83.95%             
client [57] (test)  loss: 0.3811 -> 0.3102   acc: 85.56% -> 90.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5123 -> 0.5729   acc: 82.50% -> 78.93%             
client [15] (test)  loss: 0.3200 -> 0.3623   acc: 90.58% -> 89.20%             
client [71] (test)  loss: 0.3179 -> 0.2965   acc: 89.55% -> 90.11%             
client [97] (test)  loss: 0.4539 -> 0.4232   acc: 84.33% -> 86.57%             
client [53] (test)  loss: 0.1690 -> 0.1682   acc: 94.74% -> 95.18%             
client [77] (test)  loss: 0.3009 -> 0.3315   acc: 90.00% -> 87.14%             
client [76] (test)  loss: 0.2641 -> 0.2931   acc: 92.08% -> 90.36%             
client [79] (test)  loss: 0.4674 -> 0.4494   acc: 83.98% -> 81.22%             
client [28] (test)  loss: 0.5915 -> 0.5535   acc: 85.25% -> 80.18%             
client [99] (test)  loss: 0.3628 -> 0.2402   acc: 85.31% -> 91.53%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4668 -> 0.4364   acc: 82.84% -> 85.82%             
client [86] (test)  loss: 0.1487 -> 0.1543   acc: 94.88% -> 94.88%             
client [34] (test)  loss: 0.3469 -> 0.3690   acc: 87.50% -> 88.86%             
client [73] (test)  loss: 0.3592 -> 0.3298   acc: 88.66% -> 89.85%             
client [5] (test)  loss: 0.4491 -> 0.4013   acc: 84.67% -> 86.21%              
client [96] (test)  loss: 0.2583 -> 0.2677   acc: 91.69% -> 91.69%             
client [22] (test)  loss: 0.5210 -> 0.4199   acc: 81.94% -> 85.48%             
client [60] (test)  loss: 0.1733 -> 0.2080   acc: 93.56% -> 93.81%             
client [66] (test)  loss: 0.4736 -> 0.5067   acc: 83.33% -> 83.33%             
client [83] (test)  loss: 0.3350 -> 0.2256   acc: 89.95% -> 94.07%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2868 -> 0.2984   acc: 91.43% -> 91.01%             
client [65] (test)  loss: 0.3799 -> 0.3300   acc: 88.17% -> 89.73%             
client [95] (test)  loss: 0.2551 -> 0.3011   acc: 91.27% -> 89.30%             
client [17] (test)  loss: 0.2487 -> 0.2478   acc: 92.93% -> 92.67%             
client [8] (test)  loss: 0.3712 -> 0.4163   acc: 86.45% -> 84.84%              
client [35] (test)  loss: 0.3320 -> 0.3716   acc: 89.55% -> 90.49%             
client [98] (test)  loss: 0.4857 -> 0.4330   acc: 84.44% -> 86.39%             
client [53] (test)  loss: 0.1726 -> 0.1731   acc: 94.96% -> 94.52%             
client [43] (test)  loss: 0.1742 -> 0.1731   acc: 96.24% -> 94.62%             
client [64] (test)  loss: 0.4321 -> 0.4257   acc: 86.69% -> 86.40%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3582 -> 0.3086   acc: 89.17% -> 90.56%             
client [88] (test)  loss: 0.4131 -> 0.4395   acc: 84.30% -> 83.47%             
client [38] (test)  loss: 0.3727 -> 0.3360   acc: 88.05% -> 90.57%             
client [3] (test)  loss: 0.3530 -> 0.3066   acc: 89.26% -> 90.08%              
client [5] (test)  loss: 0.4185 -> 0.3971   acc: 87.36% -> 86.21%              
client [41] (test)  loss: 0.4692 -> 0.5039   acc: 80.81% -> 80.07%             
client [7] (test)  loss: 0.4094 -> 0.4464   acc: 86.94% -> 85.00%              
client [37] (test)  loss: 0.3443 -> 0.2960   acc: 89.39% -> 90.50%             
client [45] (test)  loss: 0.2819 -> 0.2593   acc: 90.31% -> 89.53%             
client [47] (test)  loss: 0.3684 -> 0.4104   acc: 88.01% -> 85.77%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1717 -> 0.1951   acc: 94.50% -> 94.24%             
client [11] (test)  loss: 0.3967 -> 0.3782   acc: 87.32% -> 86.59%             
client [37] (test)  loss: 0.3117 -> 0.3049   acc: 90.22% -> 90.22%             
client [41] (test)  loss: 0.5130 -> 0.4958   acc: 79.70% -> 81.18%             
client [95] (test)  loss: 0.2842 -> 0.3104   acc: 90.42% -> 89.58%             
client [53] (test)  loss: 0.1689 -> 0.1647   acc: 94.74% -> 94.52%             
client [22] (test)  loss: 0.5190 -> 0.4317   acc: 84.52% -> 86.13%             
client [25] (test)  loss: 0.4039 -> 0.4881   acc: 89.18% -> 86.28%             
client [69] (test)  loss: 0.2918 -> 0.2981   acc: 90.65% -> 91.17%             
client [46] (test)  loss: 0.2530 -> 0.2954   acc: 91.84% -> 90.09%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4398 -> 0.4340   acc: 83.15% -> 86.14%             
client [69] (test)  loss: 0.3028 -> 0.3154   acc: 91.17% -> 90.65%             
client [82] (test)  loss: 0.3300 -> 0.3177   acc: 91.04% -> 90.55%             
client [45] (test)  loss: 0.2681 -> 0.2560   acc: 90.31% -> 90.05%             
client [7] (test)  loss: 0.4298 -> 0.4610   acc: 85.56% -> 84.72%              
client [50] (test)  loss: 0.4602 -> 0.4951   acc: 83.47% -> 81.51%             
client [35] (test)  loss: 0.3544 -> 0.3867   acc: 88.06% -> 90.49%             
client [24] (test)  loss: 0.2782 -> 0.2706   acc: 90.68% -> 91.44%             
client [15] (test)  loss: 0.3558 -> 0.3743   acc: 89.20% -> 89.47%             
client [58] (test)  loss: 0.3222 -> 0.2301   acc: 89.27% -> 92.41%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2516 -> 0.2356   acc: 92.65% -> 92.13%             
client [76] (test)  loss: 0.3218 -> 0.3077   acc: 91.22% -> 91.43%             
client [67] (test)  loss: 0.3134 -> 0.3563   acc: 92.44% -> 92.19%             
client [37] (test)  loss: 0.3388 -> 0.3069   acc: 89.66% -> 91.06%             
client [58] (test)  loss: 0.2484 -> 0.2431   acc: 92.15% -> 92.67%             
client [64] (test)  loss: 0.4543 -> 0.4514   acc: 86.97% -> 86.12%             
client [77] (test)  loss: 0.3105 -> 0.3466   acc: 87.14% -> 86.43%             
client [55] (test)  loss: 0.4854 -> 0.4845   acc: 86.69% -> 88.06%             
client [12] (test)  loss: 0.5514 -> 0.4809   acc: 79.09% -> 81.82%             
client [89] (test)  loss: 0.5339 -> 0.4130   acc: 87.14% -> 90.35%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3215 -> 0.3656   acc: 89.86% -> 89.28%             
client [51] (test)  loss: 0.5171 -> 0.4537   acc: 84.68% -> 87.09%             
client [8] (test)  loss: 0.3908 -> 0.4081   acc: 85.48% -> 85.81%              
client [18] (test)  loss: 0.3483 -> 0.3008   acc: 91.49% -> 92.71%             
client [94] (test)  loss: 0.6629 -> 0.5688   acc: 82.02% -> 84.30%             
client [81] (test)  loss: 0.4561 -> 0.5754   acc: 83.75% -> 81.23%             
client [3] (test)  loss: 0.4007 -> 0.3313   acc: 86.78% -> 90.08%              
client [11] (test)  loss: 0.4756 -> 0.3901   acc: 87.68% -> 87.32%             
client [95] (test)  loss: 0.2940 -> 0.3307   acc: 90.99% -> 89.30%             
client [67] (test)  loss: 0.3180 -> 0.3678   acc: 92.44% -> 92.95%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3655 -> 0.3117   acc: 89.72% -> 92.50%             
client [79] (test)  loss: 0.3923 -> 0.4489   acc: 84.53% -> 85.64%             
client [58] (test)  loss: 0.2476 -> 0.2502   acc: 92.67% -> 92.41%             
client [88] (test)  loss: 0.4348 -> 0.4527   acc: 83.75% -> 85.12%             
client [46] (test)  loss: 0.2907 -> 0.3200   acc: 91.55% -> 88.34%             
client [11] (test)  loss: 0.4793 -> 0.3905   acc: 86.59% -> 88.04%             
client [55] (test)  loss: 0.5083 -> 0.5231   acc: 87.08% -> 87.48%             
client [13] (test)  loss: 0.3166 -> 0.3022   acc: 91.60% -> 90.81%             
client [31] (test)  loss: 0.5686 -> 0.6455   acc: 81.11% -> 78.53%             
client [75] (test)  loss: 0.2160 -> 0.2702   acc: 90.80% -> 91.41%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1898 -> 0.1923   acc: 93.45% -> 93.79%             
client [7] (test)  loss: 0.4748 -> 0.4743   acc: 86.11% -> 85.00%              
client [57] (test)  loss: 0.4572 -> 0.3393   acc: 85.92% -> 90.61%             
client [13] (test)  loss: 0.3359 -> 0.3034   acc: 89.24% -> 91.60%             
client [43] (test)  loss: 0.2376 -> 0.2222   acc: 94.09% -> 94.62%             
client [91] (test)  loss: 0.6074 -> 0.4163   acc: 83.68% -> 87.89%             
client [10] (test)  loss: 0.3577 -> 0.3639   acc: 88.89% -> 90.56%             
client [64] (test)  loss: 0.5001 -> 0.5035   acc: 85.55% -> 84.70%             
client [82] (test)  loss: 0.3450 -> 0.3377   acc: 90.80% -> 91.04%             
client [22] (test)  loss: 0.5234 -> 0.4840   acc: 85.81% -> 86.45%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5125 -> 0.5424   acc: 85.67% -> 84.08%             
client [23] (test)  loss: 0.3166 -> 0.2954   acc: 91.51% -> 94.06%             
client [88] (test)  loss: 0.4100 -> 0.4561   acc: 86.78% -> 84.57%             
client [98] (test)  loss: 0.4618 -> 0.4614   acc: 85.28% -> 86.39%             
client [79] (test)  loss: 0.4314 -> 0.4682   acc: 83.15% -> 85.91%             
client [21] (test)  loss: 0.3512 -> 0.3237   acc: 91.39% -> 90.83%             
client [92] (test)  loss: 0.5810 -> 0.5009   acc: 84.64% -> 83.29%             
client [56] (test)  loss: 0.4804 -> 0.4592   acc: 89.69% -> 88.44%             
client [5] (test)  loss: 0.4047 -> 0.3902   acc: 88.12% -> 90.04%              
client [52] (test)  loss: 0.4796 -> 0.5191   acc: 85.32% -> 84.49%             
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.3773 -> 0.0000', 'accuracy': '87.47% -> 0.00%'},          
    200: {'loss': '0.4231 -> 0.0000', 'accuracy': '87.65% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_1 achieved 20.0%(20.94%) at epoch: 1                                    
FedPer_1 achieved 40.0%(47.04%) at epoch: 3                                    
FedPer_1 achieved 50.0%(54.09%) at epoch: 5                                    
FedPer_1 achieved 70.0%(72.24%) at epoch: 7                                    
FedPer_1 achieved 80.0%(81.81%) at epoch: 22                                   
FedPer_1 achieved 90.0%(90.09%) at epoch: 119                                  
Convergence (test_after):                                                      
FedPer_1 achieved 50.0%(53.09%) at epoch: 0                                    
FedPer_1 achieved 60.0%(68.55%) at epoch: 2                                    
FedPer_1 achieved 70.0%(71.18%) at epoch: 3                                    
FedPer_1 achieved 80.0%(81.60%) at epoch: 12                                   
FedPer_1 achieved 90.0%(90.38%) at epoch: 56                                   
