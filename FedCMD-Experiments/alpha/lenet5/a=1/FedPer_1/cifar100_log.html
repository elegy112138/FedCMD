==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5299 -> 4.3566   acc: 0.66% -> 5.59%               
client [81] (test)  loss: 4.4735 -> 4.3362   acc: 4.98% -> 6.98%               
client [21] (test)  loss: 57.0190 -> 4.5019   acc: 0.33% -> 2.33%              
client [68] (test)  loss: 4.5609 -> 4.3678   acc: 1.99% -> 5.63%               
client [93] (test)  loss: 4.5234 -> 4.3880   acc: 1.62% -> 7.47%               
client [31] (test)  loss: 4.6333 -> 4.4535   acc: 1.39% -> 5.57%               
client [20] (test)  loss: 4.5093 -> 4.3585   acc: 2.08% -> 5.90%               
client [59] (test)  loss: 50.9999 -> 4.3002   acc: 4.56% -> 5.78%              
client [48] (test)  loss: 4.4284 -> 4.3653   acc: 4.95% -> 5.61%               
client [34] (test)  loss: 4.4558 -> 4.2264   acc: 3.30% -> 10.21%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.4234 -> 4.0147   acc: 6.93% -> 9.90%               
client [99] (test)  loss: 4.3646 -> 4.2980   acc: 7.89% -> 5.99%               
client [67] (test)  loss: 4.2590 -> 4.1298   acc: 5.65% -> 9.63%               
client [0] (test)  loss: 4.2449 -> 4.1595   acc: 8.31% -> 8.64%                
client [76] (test)  loss: 4.4648 -> 4.2335   acc: 5.73% -> 4.30%               
client [41] (test)  loss: 4.4065 -> 4.1353   acc: 2.28% -> 7.49%               
client [62] (test)  loss: 125.5838 -> 4.1578   acc: 1.81% -> 9.42%             
client [2] (test)  loss: 125.1410 -> 4.1034   acc: 1.29% -> 6.15%              
client [14] (test)  loss: 4.2849 -> 4.2702   acc: 7.77% -> 7.77%               
client [46] (test)  loss: 4.4379 -> 4.1408   acc: 3.90% -> 8.44%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1695 -> 4.2484   acc: 4.39% -> 5.41%               
client [68] (test)  loss: 4.3478 -> 4.0263   acc: 8.61% -> 15.23%              
client [57] (test)  loss: 4.1901 -> 4.3104   acc: 5.88% -> 5.88%               
client [17] (test)  loss: 4.5213 -> 4.1847   acc: 4.52% -> 6.13%               
client [54] (test)  loss: 4.0320 -> 3.9619   acc: 15.00% -> 16.43%             
client [23] (test)  loss: 315.4561 -> 3.9832   acc: 0.33% -> 11.33%            
client [35] (test)  loss: 4.1514 -> 4.1387   acc: 8.52% -> 6.89%               
client [59] (test)  loss: 3.9549 -> 3.9821   acc: 10.64% -> 11.25%             
client [31] (test)  loss: 4.1283 -> 4.1226   acc: 7.67% -> 9.41%               
client [9] (test)  loss: 4.1738 -> 4.0304   acc: 6.62% -> 10.93%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.7478 -> 4.0472   acc: 3.30% -> 7.92%               
client [33] (test)  loss: 4.1666 -> 4.1133   acc: 10.10% -> 10.10%             
client [16] (test)  loss: 4.1658 -> 4.3397   acc: 6.62% -> 6.27%               
client [44] (test)  loss: 4.9246 -> 4.1062   acc: 0.66% -> 8.85%               
client [8] (test)  loss: 4.3874 -> 4.2484   acc: 7.09% -> 7.77%                
client [31] (test)  loss: 3.9837 -> 3.9802   acc: 11.15% -> 10.80%             
client [47] (test)  loss: 4.5156 -> 4.1376   acc: 8.20% -> 9.84%               
client [36] (test)  loss: 4.1113 -> 4.0406   acc: 9.63% -> 9.63%               
client [20] (test)  loss: 4.0645 -> 3.9293   acc: 5.90% -> 10.07%              
client [56] (test)  loss: 4.6189 -> 4.3511   acc: 4.81% -> 3.78%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0321 -> 5.8326   acc: 11.84% -> 3.62%               
client [60] (test)  loss: 5.0704 -> 4.1306   acc: 6.82% -> 8.77%               
client [28] (test)  loss: 4.1430 -> 3.8918   acc: 8.61% -> 10.93%              
client [25] (test)  loss: 4.6289 -> 4.2555   acc: 7.93% -> 11.03%              
client [58] (test)  loss: 4.2330 -> 4.0707   acc: 14.84% -> 14.84%             
client [44] (test)  loss: 4.2371 -> 4.1365   acc: 8.52% -> 10.16%              
client [39] (test)  loss: 3.9641 -> 3.8389   acc: 16.00% -> 14.67%             
client [29] (test)  loss: 4.5240 -> 4.1395   acc: 12.58% -> 12.91%             
client [3] (test)  loss: 3.8191 -> 4.1455   acc: 9.48% -> 10.78%               
client [84] (test)  loss: 4.0918 -> 4.4561   acc: 9.80% -> 5.88%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.8447 -> 4.6996   acc: 8.31% -> 3.99%               
client [84] (test)  loss: 4.0228 -> 4.5285   acc: 10.13% -> 5.88%              
client [10] (test)  loss: 4.5807 -> 4.3983   acc: 5.28% -> 6.60%               
client [36] (test)  loss: 3.9822 -> 4.1448   acc: 10.63% -> 11.30%             
client [65] (test)  loss: 4.2129 -> 4.3305   acc: 5.94% -> 6.93%               
client [81] (test)  loss: 4.0027 -> 3.9911   acc: 10.96% -> 10.30%             
client [79] (test)  loss: 4.0429 -> 4.0178   acc: 9.84% -> 13.11%              
client [42] (test)  loss: 3.9391 -> 4.0812   acc: 9.27% -> 13.91%              
client [11] (test)  loss: 4.1623 -> 4.3358   acc: 7.05% -> 7.38%               
client [96] (test)  loss: 4.6590 -> 3.9680   acc: 8.00% -> 8.73%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.0427 -> 4.6564   acc: 6.08% -> 6.76%                
client [53] (test)  loss: 4.3507 -> 3.8853   acc: 7.49% -> 12.38%              
client [52] (test)  loss: 4.4620 -> 4.1787   acc: 12.66% -> 15.58%             
client [42] (test)  loss: 4.0427 -> 4.3268   acc: 10.26% -> 13.91%             
client [69] (test)  loss: 4.5964 -> 4.1635   acc: 10.89% -> 14.19%             
client [59] (test)  loss: 4.0248 -> 3.8835   acc: 9.73% -> 11.25%              
client [7] (test)  loss: 5.8452 -> 4.0896   acc: 7.52% -> 12.42%               
client [26] (test)  loss: 4.4153 -> 3.9205   acc: 12.91% -> 13.91%             
client [49] (test)  loss: 4.0276 -> 4.0772   acc: 12.79% -> 14.43%             
client [98] (test)  loss: 4.1350 -> 4.7250   acc: 11.65% -> 10.03%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.7789 -> 4.9622   acc: 9.71% -> 9.39%               
client [47] (test)  loss: 5.0611 -> 4.3588   acc: 9.18% -> 8.52%               
client [21] (test)  loss: 4.4640 -> 4.4894   acc: 7.31% -> 7.97%               
client [77] (test)  loss: 4.5038 -> 4.5782   acc: 9.54% -> 8.55%               
client [95] (test)  loss: 5.1054 -> 4.4824   acc: 9.12% -> 12.84%              
client [91] (test)  loss: 3.7799 -> 4.0126   acc: 22.04% -> 19.74%             
client [14] (test)  loss: 4.7534 -> 5.5888   acc: 12.37% -> 4.59%              
client [99] (test)  loss: 4.5123 -> 3.9979   acc: 5.99% -> 12.62%              
client [20] (test)  loss: 4.1459 -> 4.0795   acc: 13.19% -> 13.89%             
client [39] (test)  loss: 4.2067 -> 4.2341   acc: 13.00% -> 8.33%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.1079 -> 4.1929   acc: 12.34% -> 17.21%             
client [62] (test)  loss: 4.6210 -> 4.2286   acc: 11.96% -> 14.13%             
client [71] (test)  loss: 4.0137 -> 5.2280   acc: 13.20% -> 7.92%              
client [97] (test)  loss: 5.0371 -> 4.1990   acc: 6.95% -> 8.94%               
client [30] (test)  loss: 4.2079 -> 4.3068   acc: 13.86% -> 14.52%             
client [88] (test)  loss: 4.3709 -> 4.4539   acc: 15.28% -> 12.96%             
client [60] (test)  loss: 4.5279 -> 4.5256   acc: 11.36% -> 13.96%             
client [82] (test)  loss: 4.4233 -> 4.2397   acc: 11.92% -> 14.24%             
client [91] (test)  loss: 3.8382 -> 4.0047   acc: 22.04% -> 21.05%             
client [57] (test)  loss: 4.0422 -> 3.9650   acc: 13.40% -> 15.69%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.0002 -> 4.9934   acc: 14.29% -> 12.89%             
client [15] (test)  loss: 5.1780 -> 4.4025   acc: 9.87% -> 12.50%              
client [71] (test)  loss: 4.4977 -> 5.5895   acc: 11.55% -> 6.93%              
client [97] (test)  loss: 4.9212 -> 4.3764   acc: 8.94% -> 10.93%              
client [53] (test)  loss: 5.4594 -> 4.6174   acc: 11.07% -> 13.68%             
client [77] (test)  loss: 4.7509 -> 4.6517   acc: 10.53% -> 10.86%             
client [76] (test)  loss: 4.8847 -> 4.6847   acc: 9.68% -> 10.75%              
client [79] (test)  loss: 4.7875 -> 4.9009   acc: 10.16% -> 9.18%              
client [28] (test)  loss: 4.6834 -> 4.3004   acc: 13.58% -> 13.91%             
client [99] (test)  loss: 4.5893 -> 4.2105   acc: 11.36% -> 11.99%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 5.1197 -> 4.6353   acc: 9.60% -> 10.60%              
client [86] (test)  loss: 4.6084 -> 4.7466   acc: 12.04% -> 9.70%              
client [34] (test)  loss: 4.9156 -> 4.7244   acc: 10.81% -> 14.71%             
client [73] (test)  loss: 4.7051 -> 4.4484   acc: 14.10% -> 12.46%             
client [5] (test)  loss: 4.7719 -> 4.6049   acc: 13.49% -> 12.83%              
client [96] (test)  loss: 5.3394 -> 4.6052   acc: 8.36% -> 11.64%              
client [22] (test)  loss: 4.7977 -> 5.0016   acc: 10.10% -> 13.03%             
client [60] (test)  loss: 4.9560 -> 4.7790   acc: 11.69% -> 13.31%             
client [66] (test)  loss: 4.9630 -> 4.2926   acc: 13.87% -> 16.13%             
client [83] (test)  loss: 5.8732 -> 4.6175   acc: 14.52% -> 16.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.6119 -> 5.2906   acc: 10.04% -> 11.11%             
client [65] (test)  loss: 5.0473 -> 4.9908   acc: 6.93% -> 7.59%               
client [95] (test)  loss: 5.5060 -> 5.2571   acc: 10.81% -> 13.51%             
client [17] (test)  loss: 5.2307 -> 4.2823   acc: 13.23% -> 14.52%             
client [8] (test)  loss: 6.4376 -> 5.1560   acc: 3.72% -> 9.80%                
client [35] (test)  loss: 4.7483 -> 5.3606   acc: 12.46% -> 11.80%             
client [98] (test)  loss: 5.1346 -> 5.8079   acc: 12.94% -> 8.74%              
client [53] (test)  loss: 4.8641 -> 4.7147   acc: 15.64% -> 16.61%             
client [43] (test)  loss: 5.1909 -> 4.5404   acc: 15.84% -> 16.50%             
client [64] (test)  loss: 5.3107 -> 4.5970   acc: 7.92% -> 10.23%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.1230 -> 4.6038   acc: 10.30% -> 13.29%             
client [88] (test)  loss: 5.0455 -> 6.0187   acc: 16.28% -> 12.62%             
client [38] (test)  loss: 5.6534 -> 5.1608   acc: 9.54% -> 12.50%              
client [3] (test)  loss: 6.0304 -> 4.6503   acc: 7.52% -> 16.34%               
client [5] (test)  loss: 4.9488 -> 5.2461   acc: 15.13% -> 12.50%              
client [41] (test)  loss: 5.0661 -> 5.0603   acc: 16.94% -> 18.57%             
client [7] (test)  loss: 5.5713 -> 4.6208   acc: 13.73% -> 12.75%              
client [37] (test)  loss: 5.9864 -> 5.0874   acc: 14.24% -> 16.23%             
client [45] (test)  loss: 4.7663 -> 3.8835   acc: 17.88% -> 20.53%             
client [47] (test)  loss: 5.5519 -> 5.4640   acc: 15.74% -> 11.15%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.3592 -> 5.5392   acc: 9.76% -> 11.15%              
client [11] (test)  loss: 5.4662 -> 5.6806   acc: 13.09% -> 14.77%             
client [37] (test)  loss: 6.3623 -> 5.7253   acc: 14.24% -> 15.23%             
client [41] (test)  loss: 5.3639 -> 5.3715   acc: 17.26% -> 18.24%             
client [95] (test)  loss: 5.7651 -> 5.9651   acc: 11.82% -> 12.50%             
client [53] (test)  loss: 6.1516 -> 5.0946   acc: 14.66% -> 18.24%             
client [22] (test)  loss: 5.1850 -> 5.1987   acc: 12.70% -> 14.98%             
client [25] (test)  loss: 5.5112 -> 5.3242   acc: 6.90% -> 12.76%              
client [69] (test)  loss: 7.5062 -> 5.5297   acc: 11.22% -> 16.83%             
client [46] (test)  loss: 4.2188 -> 4.5365   acc: 20.78% -> 20.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.4603 -> 5.5593   acc: 15.08% -> 10.49%             
client [69] (test)  loss: 7.8904 -> 5.9312   acc: 13.20% -> 18.81%             
client [82] (test)  loss: 5.4646 -> 5.1648   acc: 14.24% -> 14.24%             
client [45] (test)  loss: 4.6097 -> 4.4687   acc: 19.54% -> 20.86%             
client [7] (test)  loss: 5.8442 -> 5.0176   acc: 13.40% -> 14.05%              
client [50] (test)  loss: 4.9772 -> 4.5359   acc: 16.10% -> 16.10%             
client [35] (test)  loss: 5.3504 -> 6.1115   acc: 11.48% -> 12.46%             
client [24] (test)  loss: 5.9240 -> 6.6204   acc: 14.53% -> 13.18%             
client [15] (test)  loss: 7.8469 -> 5.5744   acc: 7.24% -> 12.17%              
client [58] (test)  loss: 7.1706 -> 5.9033   acc: 14.84% -> 19.14%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 7.7215 -> 6.6322   acc: 9.90% -> 12.54%              
client [76] (test)  loss: 7.1170 -> 6.6342   acc: 10.39% -> 9.68%              
client [67] (test)  loss: 6.4880 -> 5.7807   acc: 8.64% -> 14.62%              
client [37] (test)  loss: 8.2249 -> 6.5775   acc: 15.23% -> 14.24%             
client [58] (test)  loss: 7.4846 -> 6.3729   acc: 18.36% -> 19.92%             
client [64] (test)  loss: 6.5628 -> 5.8916   acc: 9.90% -> 10.23%              
client [77] (test)  loss: 7.6266 -> 5.7511   acc: 11.18% -> 15.79%             
client [55] (test)  loss: 6.7936 -> 6.5751   acc: 17.05% -> 10.49%             
client [12] (test)  loss: 6.2566 -> 6.2266   acc: 11.55% -> 12.21%             
client [89] (test)  loss: 7.3782 -> 6.7916   acc: 11.94% -> 13.55%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 8.1848 -> 7.4294   acc: 7.52% -> 9.48%               
client [51] (test)  loss: 7.4298 -> 6.7702   acc: 10.93% -> 14.24%             
client [8] (test)  loss: 7.5151 -> 7.3215   acc: 7.43% -> 5.41%                
client [18] (test)  loss: 5.9282 -> 5.7533   acc: 16.67% -> 18.63%             
client [94] (test)  loss: 7.5808 -> 6.0310   acc: 12.93% -> 15.31%             
client [81] (test)  loss: 6.3624 -> 6.1559   acc: 12.62% -> 14.95%             
client [3] (test)  loss: 7.1863 -> 6.0020   acc: 9.15% -> 17.32%               
client [11] (test)  loss: 6.4688 -> 6.9733   acc: 15.44% -> 13.76%             
client [95] (test)  loss: 7.6088 -> 7.7805   acc: 8.45% -> 11.49%              
client [67] (test)  loss: 6.2501 -> 6.2383   acc: 9.63% -> 15.28%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 7.1798 -> 6.3585   acc: 10.96% -> 11.96%             
client [79] (test)  loss: 8.9768 -> 6.7062   acc: 8.52% -> 16.72%              
client [58] (test)  loss: 9.6823 -> 7.4687   acc: 14.84% -> 19.92%             
client [88] (test)  loss: 7.1235 -> 7.4257   acc: 13.95% -> 14.62%             
client [46] (test)  loss: 6.2476 -> 5.7281   acc: 19.81% -> 20.45%             
client [11] (test)  loss: 7.5220 -> 7.2706   acc: 13.76% -> 12.08%             
client [55] (test)  loss: 7.6091 -> 7.0996   acc: 12.79% -> 14.75%             
client [13] (test)  loss: 10.8072 -> 7.3383   acc: 6.49% -> 13.96%             
client [31] (test)  loss: 8.6389 -> 7.1324   acc: 12.54% -> 11.15%             
client [75] (test)  loss: 7.6994 -> 7.1118   acc: 16.12% -> 16.12%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 8.4086 -> 7.9894   acc: 13.67% -> 15.67%             
client [7] (test)  loss: 8.0231 -> 6.6808   acc: 10.46% -> 16.34%              
client [57] (test)  loss: 6.7831 -> 7.1599   acc: 16.67% -> 13.73%             
client [13] (test)  loss: 9.7274 -> 7.9265   acc: 7.14% -> 14.61%              
client [43] (test)  loss: 8.9025 -> 6.9637   acc: 15.18% -> 21.12%             
client [91] (test)  loss: 8.6124 -> 5.6168   acc: 17.11% -> 23.36%             
client [10] (test)  loss: 8.0733 -> 7.6851   acc: 11.55% -> 13.20%             
client [64] (test)  loss: 7.4559 -> 7.5701   acc: 13.53% -> 14.19%             
client [82] (test)  loss: 7.5652 -> 6.9240   acc: 13.58% -> 15.56%             
client [22] (test)  loss: 6.9216 -> 7.4123   acc: 12.38% -> 12.38%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 8.0971 -> 6.5073   acc: 12.85% -> 14.93%             
client [23] (test)  loss: 8.5548 -> 6.5540   acc: 9.67% -> 14.67%              
client [88] (test)  loss: 8.0532 -> 8.3006   acc: 16.61% -> 14.29%             
client [98] (test)  loss: 8.3220 -> 7.9812   acc: 16.83% -> 16.50%             
client [79] (test)  loss: 8.9313 -> 7.8921   acc: 10.16% -> 16.07%             
client [21] (test)  loss: 7.3964 -> 7.0630   acc: 10.30% -> 13.95%             
client [92] (test)  loss: 7.2312 -> 7.3582   acc: 15.62% -> 18.12%             
client [56] (test)  loss: 9.7288 -> 8.3579   acc: 12.71% -> 14.78%             
client [5] (test)  loss: 8.4653 -> 7.3140   acc: 15.46% -> 14.47%              
client [52] (test)  loss: 9.9167 -> 7.8168   acc: 8.77% -> 14.29%              
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '4.8027 -> 0.0000', 'accuracy': '11.80% -> 0.00%'},          
    200: {'loss': '8.6142 -> 0.0000', 'accuracy': '12.97% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_1 achieved 10.0%(10.57%) at epoch: 49                                   
Convergence (test_after):                                                      
FedPer_1 achieved 10.0%(10.47%) at epoch: 32                                   
