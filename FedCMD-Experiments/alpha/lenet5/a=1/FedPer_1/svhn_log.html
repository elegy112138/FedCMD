==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.3314 -> 0.7665   acc: 58.85% -> 71.57%             
client [81] (test)  loss: 1.5419 -> 1.3844   acc: 45.03% -> 48.97%             
client [21] (test)  loss: 16.5209 -> 0.8828   acc: 63.80% -> 67.92%            
client [68] (test)  loss: 1.3270 -> 1.6577   acc: 53.86% -> 41.19%             
client [93] (test)  loss: 0.6682 -> 0.5703   acc: 79.61% -> 79.61%             
client [31] (test)  loss: 2.0006 -> 1.0036   acc: 27.96% -> 67.06%             
client [20] (test)  loss: 1.6657 -> 1.5548   acc: 42.79% -> 52.70%             
client [59] (test)  loss: 55.4058 -> 1.5516   acc: 25.26% -> 45.36%            
client [48] (test)  loss: 0.9730 -> 1.4021   acc: 63.73% -> 56.67%             
client [34] (test)  loss: 1.7502 -> 2.2103   acc: 44.49% -> 23.02%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.5108 -> 0.9658   acc: 51.67% -> 64.81%             
client [99] (test)  loss: 0.4363 -> 0.5066   acc: 90.14% -> 85.69%             
client [67] (test)  loss: 0.8410 -> 0.8863   acc: 76.88% -> 72.19%             
client [0] (test)  loss: 0.8759 -> 0.7746   acc: 72.43% -> 76.70%              
client [76] (test)  loss: 0.8325 -> 0.8860   acc: 74.92% -> 71.62%             
client [41] (test)  loss: 0.8076 -> 1.0498   acc: 71.76% -> 66.67%             
client [62] (test)  loss: 40.2944 -> 1.0563   acc: 66.54% -> 67.48%            
client [2] (test)  loss: 21.2621 -> 0.6183   acc: 75.05% -> 81.53%             
client [14] (test)  loss: 0.9138 -> 1.3128   acc: 70.18% -> 60.15%             
client [46] (test)  loss: 0.6567 -> 0.5911   acc: 79.18% -> 81.60%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8128 -> 0.6080   acc: 75.52% -> 84.62%             
client [68] (test)  loss: 0.7720 -> 0.7834   acc: 73.86% -> 75.05%             
client [57] (test)  loss: 0.9756 -> 0.7959   acc: 70.27% -> 76.28%             
client [17] (test)  loss: 0.7097 -> 0.7028   acc: 76.71% -> 77.80%             
client [54] (test)  loss: 0.4974 -> 0.8487   acc: 85.09% -> 74.38%             
client [23] (test)  loss: 101.9865 -> 0.6747   acc: 44.54% -> 75.86%           
client [35] (test)  loss: 0.5083 -> 0.5075   acc: 83.47% -> 82.07%             
client [59] (test)  loss: 1.0483 -> 0.7870   acc: 64.95% -> 75.00%             
client [31] (test)  loss: 0.5350 -> 0.5203   acc: 83.18% -> 84.12%             
client [9] (test)  loss: 0.4316 -> 0.5771   acc: 86.02% -> 80.12%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7654 -> 0.7545   acc: 77.08% -> 78.59%             
client [33] (test)  loss: 0.2890 -> 0.3818   acc: 92.90% -> 91.59%             
client [16] (test)  loss: 0.3445 -> 0.3521   acc: 88.87% -> 91.47%             
client [44] (test)  loss: 1.3226 -> 0.3917   acc: 75.83% -> 88.50%             
client [8] (test)  loss: 0.9023 -> 0.7831   acc: 70.38% -> 76.78%              
client [31] (test)  loss: 0.5079 -> 0.4658   acc: 85.78% -> 86.02%             
client [47] (test)  loss: 0.6532 -> 0.4634   acc: 79.46% -> 86.37%             
client [36] (test)  loss: 0.6016 -> 0.6286   acc: 80.90% -> 79.85%             
client [20] (test)  loss: 1.0948 -> 0.8505   acc: 67.12% -> 73.87%             
client [56] (test)  loss: 0.3515 -> 0.2947   acc: 89.04% -> 90.96%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6366 -> 0.7638   acc: 80.42% -> 75.96%              
client [60] (test)  loss: 0.7028 -> 0.6500   acc: 79.76% -> 79.16%             
client [28] (test)  loss: 0.6553 -> 0.5836   acc: 81.03% -> 81.03%             
client [25] (test)  loss: 0.7210 -> 0.6567   acc: 76.00% -> 79.82%             
client [58] (test)  loss: 0.7861 -> 0.8535   acc: 76.04% -> 72.97%             
client [44] (test)  loss: 0.3430 -> 0.3743   acc: 89.67% -> 88.67%             
client [39] (test)  loss: 0.5525 -> 0.5640   acc: 83.24% -> 82.26%             
client [29] (test)  loss: 0.7692 -> 0.6340   acc: 77.31% -> 80.34%             
client [3] (test)  loss: 0.5324 -> 0.5614   acc: 84.60% -> 85.09%              
client [84] (test)  loss: 0.5302 -> 0.5707   acc: 81.90% -> 80.09%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5808 -> 0.4217   acc: 83.15% -> 86.56%             
client [84] (test)  loss: 0.5309 -> 0.5329   acc: 83.03% -> 82.81%             
client [10] (test)  loss: 0.7075 -> 0.6263   acc: 82.05% -> 82.50%             
client [36] (test)  loss: 0.4412 -> 0.7197   acc: 85.11% -> 77.44%             
client [65] (test)  loss: 0.3542 -> 0.3986   acc: 90.76% -> 88.69%             
client [81] (test)  loss: 0.7192 -> 0.7109   acc: 81.24% -> 79.74%             
client [79] (test)  loss: 0.1403 -> 0.1452   acc: 96.14% -> 95.40%             
client [42] (test)  loss: 0.3625 -> 0.3564   acc: 88.42% -> 89.02%             
client [11] (test)  loss: 0.1878 -> 0.1721   acc: 94.37% -> 94.76%             
client [96] (test)  loss: 0.5957 -> 0.5628   acc: 82.27% -> 84.76%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8189 -> 0.6560   acc: 76.54% -> 82.70%              
client [53] (test)  loss: 0.5045 -> 0.4965   acc: 83.92% -> 82.16%             
client [52] (test)  loss: 0.5790 -> 0.6033   acc: 83.71% -> 82.58%             
client [42] (test)  loss: 0.3556 -> 0.3422   acc: 88.72% -> 89.77%             
client [69] (test)  loss: 0.5735 -> 0.6186   acc: 80.74% -> 79.07%             
client [59] (test)  loss: 0.7227 -> 0.6977   acc: 77.58% -> 79.64%             
client [7] (test)  loss: 0.8509 -> 0.6830   acc: 77.22% -> 79.00%              
client [26] (test)  loss: 0.3130 -> 0.3241   acc: 90.41% -> 89.10%             
client [49] (test)  loss: 0.6112 -> 0.6816   acc: 81.19% -> 80.45%             
client [98] (test)  loss: 0.6070 -> 0.6228   acc: 81.89% -> 84.51%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5964 -> 0.6377   acc: 82.90% -> 84.71%             
client [47] (test)  loss: 0.4813 -> 0.3951   acc: 86.95% -> 87.72%             
client [21] (test)  loss: 0.4416 -> 0.4036   acc: 86.38% -> 87.81%             
client [77] (test)  loss: 0.2684 -> 0.3461   acc: 90.66% -> 89.66%             
client [95] (test)  loss: 0.3893 -> 0.4226   acc: 90.18% -> 90.37%             
client [91] (test)  loss: 0.7558 -> 0.6641   acc: 80.42% -> 81.98%             
client [14] (test)  loss: 0.6017 -> 0.6065   acc: 82.96% -> 81.95%             
client [99] (test)  loss: 0.2720 -> 0.3062   acc: 93.23% -> 92.84%             
client [20] (test)  loss: 0.8760 -> 0.8828   acc: 77.03% -> 76.58%             
client [39] (test)  loss: 0.5146 -> 0.5080   acc: 85.96% -> 84.80%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5797 -> 0.6090   acc: 84.64% -> 83.15%             
client [62] (test)  loss: 0.4584 -> 0.5424   acc: 88.16% -> 85.34%             
client [71] (test)  loss: 0.5820 -> 0.5577   acc: 81.91% -> 81.74%             
client [97] (test)  loss: 0.6362 -> 0.6282   acc: 82.84% -> 82.84%             
client [30] (test)  loss: 0.5399 -> 0.6674   acc: 87.05% -> 84.38%             
client [88] (test)  loss: 0.6027 -> 0.4784   acc: 83.16% -> 86.53%             
client [60] (test)  loss: 0.5776 -> 0.5755   acc: 82.36% -> 82.36%             
client [82] (test)  loss: 0.5936 -> 0.6677   acc: 82.55% -> 82.03%             
client [91] (test)  loss: 0.8314 -> 0.6632   acc: 79.37% -> 82.51%             
client [57] (test)  loss: 0.6342 -> 0.5827   acc: 80.78% -> 81.98%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5958 -> 0.4517   acc: 83.65% -> 88.39%             
client [15] (test)  loss: 0.5051 -> 0.5431   acc: 84.73% -> 83.66%             
client [71] (test)  loss: 0.7161 -> 0.5554   acc: 77.30% -> 82.94%             
client [97] (test)  loss: 0.6549 -> 0.6548   acc: 82.17% -> 83.07%             
client [53] (test)  loss: 0.6208 -> 0.5078   acc: 79.24% -> 82.75%             
client [77] (test)  loss: 0.3030 -> 0.3221   acc: 90.46% -> 90.06%             
client [76] (test)  loss: 0.5833 -> 0.5607   acc: 82.18% -> 83.83%             
client [79] (test)  loss: 0.1972 -> 0.1546   acc: 94.49% -> 95.40%             
client [28] (test)  loss: 0.6112 -> 0.5528   acc: 81.19% -> 85.21%             
client [99] (test)  loss: 0.2933 -> 0.2993   acc: 93.04% -> 93.04%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6092 -> 0.6435   acc: 82.62% -> 82.84%             
client [86] (test)  loss: 0.6290 -> 0.6392   acc: 83.53% -> 82.36%             
client [34] (test)  loss: 0.7831 -> 0.6961   acc: 79.30% -> 80.27%             
client [73] (test)  loss: 0.3845 -> 0.3922   acc: 87.77% -> 87.62%             
client [5] (test)  loss: 0.5572 -> 0.4991   acc: 81.17% -> 82.91%              
client [96] (test)  loss: 0.5968 -> 0.5458   acc: 80.61% -> 86.70%             
client [22] (test)  loss: 0.5058 -> 0.5419   acc: 86.67% -> 86.85%             
client [60] (test)  loss: 0.6552 -> 0.6002   acc: 81.16% -> 83.77%             
client [66] (test)  loss: 0.0335 -> 0.0278   acc: 99.03% -> 99.03%             
client [83] (test)  loss: 0.5442 -> 0.5123   acc: 86.52% -> 86.96%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5665 -> 0.6093   acc: 84.16% -> 83.17%             
client [65] (test)  loss: 0.3869 -> 0.3833   acc: 90.13% -> 90.92%             
client [95] (test)  loss: 0.3869 -> 0.4098   acc: 90.96% -> 90.37%             
client [17] (test)  loss: 0.5692 -> 0.5650   acc: 82.85% -> 83.21%             
client [8] (test)  loss: 0.7255 -> 0.6147   acc: 82.23% -> 84.83%              
client [35] (test)  loss: 0.4678 -> 0.4537   acc: 87.85% -> 88.65%             
client [98] (test)  loss: 0.5872 -> 0.6295   acc: 83.10% -> 84.71%             
client [53] (test)  loss: 0.5563 -> 0.5126   acc: 81.58% -> 83.04%             
client [43] (test)  loss: 0.5494 -> 0.5995   acc: 82.99% -> 84.35%             
client [64] (test)  loss: 0.6489 -> 0.7305   acc: 83.88% -> 81.61%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4038 -> 0.3912   acc: 87.81% -> 88.53%             
client [88] (test)  loss: 0.5327 -> 0.5041   acc: 86.32% -> 86.95%             
client [38] (test)  loss: 0.4629 -> 0.4993   acc: 85.56% -> 85.71%             
client [3] (test)  loss: 0.6156 -> 0.5615   acc: 85.74% -> 86.87%              
client [5] (test)  loss: 0.5614 -> 0.5233   acc: 81.36% -> 83.50%              
client [41] (test)  loss: 0.7161 -> 0.8185   acc: 80.78% -> 79.61%             
client [7] (test)  loss: 0.7575 -> 0.6593   acc: 79.54% -> 79.72%              
client [37] (test)  loss: 0.7021 -> 0.6850   acc: 83.76% -> 85.74%             
client [45] (test)  loss: 0.6290 -> 0.5233   acc: 83.56% -> 85.62%             
client [47] (test)  loss: 0.4233 -> 0.3822   acc: 89.25% -> 88.48%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3581 -> 0.3351   acc: 88.87% -> 90.91%             
client [11] (test)  loss: 0.1636 -> 0.1629   acc: 96.31% -> 95.53%             
client [37] (test)  loss: 0.6654 -> 0.6910   acc: 84.95% -> 86.34%             
client [41] (test)  loss: 0.7250 -> 0.8134   acc: 79.02% -> 80.20%             
client [95] (test)  loss: 0.4190 -> 0.3982   acc: 90.77% -> 91.75%             
client [53] (test)  loss: 0.5625 -> 0.5396   acc: 83.33% -> 83.04%             
client [22] (test)  loss: 0.5380 -> 0.5505   acc: 86.13% -> 87.39%             
client [25] (test)  loss: 0.5215 -> 0.5717   acc: 84.91% -> 84.55%             
client [69] (test)  loss: 0.6276 -> 0.5528   acc: 82.59% -> 85.00%             
client [46] (test)  loss: 0.5828 -> 0.4918   acc: 86.43% -> 89.41%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4621 -> 0.4008   acc: 86.95% -> 88.48%             
client [69] (test)  loss: 0.6078 -> 0.5637   acc: 82.96% -> 84.63%             
client [82] (test)  loss: 0.6094 -> 0.7126   acc: 84.11% -> 84.11%             
client [45] (test)  loss: 0.5291 -> 0.5305   acc: 86.30% -> 86.47%             
client [7] (test)  loss: 0.6460 -> 0.6647   acc: 81.14% -> 79.72%              
client [50] (test)  loss: 0.4797 -> 0.5135   acc: 85.26% -> 85.26%             
client [35] (test)  loss: 0.4337 -> 0.4976   acc: 89.44% -> 88.05%             
client [24] (test)  loss: 0.6009 -> 0.3701   acc: 81.12% -> 88.11%             
client [15] (test)  loss: 0.4872 -> 0.5320   acc: 86.02% -> 83.23%             
client [58] (test)  loss: 0.8822 -> 0.7906   acc: 77.66% -> 78.20%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4356 -> 0.4722   acc: 87.65% -> 86.86%             
client [76] (test)  loss: 0.5300 -> 0.5938   acc: 84.82% -> 82.84%             
client [67] (test)  loss: 0.5884 -> 0.5788   acc: 85.31% -> 85.00%             
client [37] (test)  loss: 0.7526 -> 0.6803   acc: 84.36% -> 86.14%             
client [58] (test)  loss: 0.8767 -> 0.7874   acc: 77.12% -> 79.28%             
client [64] (test)  loss: 0.7143 -> 0.7834   acc: 81.36% -> 80.60%             
client [77] (test)  loss: 0.3235 -> 0.2974   acc: 89.66% -> 91.25%             
client [55] (test)  loss: 0.5457 -> 0.4943   acc: 87.84% -> 89.44%             
client [12] (test)  loss: 0.5204 -> 0.5723   acc: 83.71% -> 86.80%             
client [89] (test)  loss: 0.4621 -> 0.4388   acc: 87.25% -> 86.23%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5177 -> 0.5281   acc: 84.16% -> 85.07%             
client [51] (test)  loss: 0.6202 -> 0.6883   acc: 85.71% -> 84.49%             
client [8] (test)  loss: 0.7023 -> 0.6670   acc: 84.83% -> 86.02%              
client [18] (test)  loss: 0.6849 -> 0.6647   acc: 79.83% -> 83.15%             
client [94] (test)  loss: 0.5695 -> 0.5672   acc: 86.31% -> 86.31%             
client [81] (test)  loss: 0.7193 -> 0.6764   acc: 82.36% -> 82.18%             
client [3] (test)  loss: 0.7403 -> 0.5991   acc: 82.98% -> 86.39%              
client [11] (test)  loss: 0.1706 -> 0.1628   acc: 96.31% -> 95.92%             
client [95] (test)  loss: 0.4837 -> 0.4315   acc: 90.18% -> 90.96%             
client [67] (test)  loss: 0.5670 -> 0.5624   acc: 85.62% -> 86.56%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4032 -> 0.3986   acc: 88.53% -> 88.89%             
client [79] (test)  loss: 0.1624 -> 0.1516   acc: 96.51% -> 95.77%             
client [58] (test)  loss: 0.8742 -> 0.8331   acc: 79.10% -> 79.10%             
client [88] (test)  loss: 0.5582 -> 0.5333   acc: 85.26% -> 86.74%             
client [46] (test)  loss: 0.7100 -> 0.5035   acc: 86.06% -> 89.22%             
client [11] (test)  loss: 0.1808 -> 0.1560   acc: 94.76% -> 95.73%             
client [55] (test)  loss: 0.5041 -> 0.5137   acc: 87.52% -> 88.64%             
client [13] (test)  loss: 0.1522 -> 0.1179   acc: 95.75% -> 96.69%             
client [31] (test)  loss: 0.5844 -> 0.4369   acc: 85.31% -> 88.63%             
client [75] (test)  loss: 0.4033 -> 0.4964   acc: 87.55% -> 84.34%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4000 -> 0.3749   acc: 89.90% -> 90.10%             
client [7] (test)  loss: 0.6491 -> 0.6370   acc: 81.49% -> 81.85%              
client [57] (test)  loss: 0.6089 -> 0.6461   acc: 84.08% -> 83.18%             
client [13] (test)  loss: 0.1170 -> 0.1211   acc: 97.48% -> 96.69%             
client [43] (test)  loss: 0.5690 -> 0.5907   acc: 84.01% -> 84.01%             
client [91] (test)  loss: 0.7504 -> 0.6028   acc: 81.46% -> 83.81%             
client [10] (test)  loss: 0.6843 -> 0.6582   acc: 83.18% -> 84.32%             
client [64] (test)  loss: 0.7215 -> 0.8051   acc: 83.88% -> 82.37%             
client [82] (test)  loss: 0.6665 -> 0.7455   acc: 85.16% -> 85.42%             
client [22] (test)  loss: 0.5880 -> 0.5759   acc: 85.77% -> 87.39%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8216 -> 0.8205   acc: 77.48% -> 81.08%             
client [23] (test)  loss: 0.5734 -> 0.5031   acc: 84.50% -> 85.81%             
client [88] (test)  loss: 0.5281 -> 0.5519   acc: 87.58% -> 87.16%             
client [98] (test)  loss: 0.5834 -> 0.6459   acc: 86.12% -> 85.71%             
client [79] (test)  loss: 0.1517 -> 0.1475   acc: 96.32% -> 95.59%             
client [21] (test)  loss: 0.4276 -> 0.4135   acc: 87.28% -> 89.07%             
client [92] (test)  loss: 0.6501 -> 0.6677   acc: 83.88% -> 83.66%             
client [56] (test)  loss: 0.3333 -> 0.3429   acc: 91.15% -> 91.35%             
client [5] (test)  loss: 0.6945 -> 0.5689   acc: 80.00% -> 85.05%              
client [52] (test)  loss: 0.5129 -> 0.7028   acc: 87.83% -> 83.90%             
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.5094 -> 0.0000', 'accuracy': '85.29% -> 0.00%'},          
    200: {'loss': '0.5128 -> 0.0000', 'accuracy': '86.76% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_1 achieved 10.0%(11.52%) at epoch: 0                                    
FedPer_1 achieved 20.0%(25.29%) at epoch: 3                                    
FedPer_1 achieved 30.0%(39.39%) at epoch: 4                                    
FedPer_1 achieved 40.0%(43.17%) at epoch: 7                                    
FedPer_1 achieved 50.0%(52.19%) at epoch: 9                                    
FedPer_1 achieved 60.0%(63.47%) at epoch: 13                                   
FedPer_1 achieved 70.0%(72.58%) at epoch: 19                                   
FedPer_1 achieved 80.0%(81.18%) at epoch: 28                                   
FedPer_1 achieved 90.0%(90.45%) at epoch: 114                                  
Convergence (test_after):                                                      
FedPer_1 achieved 30.0%(37.20%) at epoch: 0                                    
FedPer_1 achieved 40.0%(48.17%) at epoch: 4                                    
FedPer_1 achieved 50.0%(55.76%) at epoch: 8                                    
FedPer_1 achieved 60.0%(64.69%) at epoch: 12                                   
FedPer_1 achieved 70.0%(70.15%) at epoch: 13                                   
FedPer_1 achieved 80.0%(83.27%) at epoch: 28                                   
FedPer_1 achieved 90.0%(90.45%) at epoch: 114                                  
