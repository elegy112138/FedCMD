==================== ALGORITHM: FedPer_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.0663 -> 5.0207   acc: 2.52% -> 4.50%               
client [81] (test)  loss: 5.1601 -> 5.0582   acc: 2.77% -> 4.06%               
client [21] (test)  loss: 5.2639 -> 4.9132   acc: 0.73% -> 4.90%               
client [68] (test)  loss: 4.9852 -> 4.8472   acc: 3.25% -> 6.15%               
client [93] (test)  loss: 5.0648 -> 5.0381   acc: 3.45% -> 2.90%               
client [31] (test)  loss: 5.2718 -> 5.0622   acc: 1.98% -> 4.32%               
client [20] (test)  loss: 4.9393 -> 4.8997   acc: 7.94% -> 9.07%               
client [59] (test)  loss: 5.2813 -> 4.9504   acc: 2.91% -> 2.55%               
client [48] (test)  loss: 5.0197 -> 4.9510   acc: 2.69% -> 3.94%               
client [34] (test)  loss: 5.0437 -> 5.0843   acc: 2.73% -> 2.91%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.6625 -> 4.8029   acc: 2.04% -> 6.11%               
client [99] (test)  loss: 5.2756 -> 5.0092   acc: 4.51% -> 3.97%               
client [67] (test)  loss: 4.9943 -> 4.8851   acc: 4.10% -> 6.53%               
client [0] (test)  loss: 4.8106 -> 4.8253   acc: 6.52% -> 7.25%                
client [76] (test)  loss: 4.7651 -> 4.6589   acc: 7.26% -> 8.35%               
client [41] (test)  loss: 5.2868 -> 4.9628   acc: 1.09% -> 2.54%               
client [62] (test)  loss: 5.2771 -> 4.9423   acc: 1.26% -> 5.03%               
client [2] (test)  loss: 5.3833 -> 4.8597   acc: 0.96% -> 6.91%                
client [14] (test)  loss: 4.8943 -> 4.9997   acc: 4.87% -> 7.22%               
client [46] (test)  loss: 4.9139 -> 4.7674   acc: 4.54% -> 5.63%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.6782 -> 4.8183   acc: 9.45% -> 10.70%              
client [68] (test)  loss: 4.9108 -> 4.8869   acc: 8.68% -> 9.22%               
client [57] (test)  loss: 5.2247 -> 4.9722   acc: 4.72% -> 9.44%               
client [17] (test)  loss: 6.3053 -> 4.8255   acc: 4.68% -> 5.77%               
client [54] (test)  loss: 4.7628 -> 4.9028   acc: 6.90% -> 8.53%               
client [23] (test)  loss: 5.4119 -> 4.9327   acc: 1.63% -> 5.42%               
client [35] (test)  loss: 4.8761 -> 4.8067   acc: 6.72% -> 7.26%               
client [59] (test)  loss: 4.8480 -> 4.8329   acc: 4.73% -> 5.27%               
client [31] (test)  loss: 5.0050 -> 5.3266   acc: 5.95% -> 5.05%               
client [9] (test)  loss: 5.1930 -> 5.2193   acc: 5.79% -> 7.05%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.3654 -> 5.1850   acc: 9.67% -> 7.99%               
client [33] (test)  loss: 5.2394 -> 6.6894   acc: 7.07% -> 4.53%               
client [16] (test)  loss: 5.1796 -> 5.1349   acc: 6.82% -> 8.80%               
client [44] (test)  loss: 18.1021 -> 4.9531   acc: 1.60% -> 4.44%              
client [8] (test)  loss: 5.3299 -> 5.5541   acc: 7.58% -> 6.14%                
client [31] (test)  loss: 5.4166 -> 5.7495   acc: 5.59% -> 5.77%               
client [47] (test)  loss: 5.9606 -> 5.0880   acc: 6.68% -> 6.32%               
client [36] (test)  loss: 5.1354 -> 4.7425   acc: 7.82% -> 10.73%              
client [20] (test)  loss: 5.0604 -> 5.1245   acc: 11.15% -> 10.02%             
client [56] (test)  loss: 5.3970 -> 4.9166   acc: 7.58% -> 8.12%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.2649 -> 5.1428   acc: 6.17% -> 6.35%                
client [60] (test)  loss: 6.8428 -> 4.9584   acc: 8.81% -> 9.35%               
client [28] (test)  loss: 7.5536 -> 5.1311   acc: 6.53% -> 8.71%               
client [25] (test)  loss: 8.8503 -> 5.0286   acc: 4.32% -> 9.19%               
client [58] (test)  loss: 5.8842 -> 5.4464   acc: 7.57% -> 6.85%               
client [44] (test)  loss: 5.8645 -> 5.1784   acc: 7.28% -> 7.99%               
client [39] (test)  loss: 5.6011 -> 5.1687   acc: 8.18% -> 9.27%               
client [29] (test)  loss: 6.4865 -> 5.1332   acc: 8.58% -> 9.28%               
client [3] (test)  loss: 5.7094 -> 4.9399   acc: 5.19% -> 9.48%                
client [84] (test)  loss: 5.5439 -> 5.5031   acc: 10.14% -> 7.97%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 7.6602 -> 5.1174   acc: 7.80% -> 8.17%               
client [84] (test)  loss: 5.8781 -> 6.0828   acc: 9.24% -> 9.60%               
client [10] (test)  loss: 7.6436 -> 5.4670   acc: 7.19% -> 8.63%               
client [36] (test)  loss: 5.2187 -> 5.4847   acc: 8.18% -> 9.82%               
client [65] (test)  loss: 5.7517 -> 6.5748   acc: 6.17% -> 5.63%               
client [81] (test)  loss: 6.2509 -> 5.5443   acc: 7.56% -> 8.49%               
client [79] (test)  loss: 5.6841 -> 5.8414   acc: 7.10% -> 7.82%               
client [42] (test)  loss: 5.8302 -> 6.5673   acc: 7.74% -> 6.42%               
client [11] (test)  loss: 6.1680 -> 5.1970   acc: 7.55% -> 8.09%               
client [96] (test)  loss: 6.2065 -> 5.2974   acc: 10.45% -> 9.91%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 7.2941 -> 6.6651   acc: 8.12% -> 7.76%                
client [53] (test)  loss: 6.2040 -> 5.8334   acc: 7.41% -> 7.76%               
client [52] (test)  loss: 7.2176 -> 6.5215   acc: 8.88% -> 8.70%               
client [42] (test)  loss: 6.5715 -> 7.4126   acc: 8.68% -> 7.74%               
client [69] (test)  loss: 6.1975 -> 6.5295   acc: 8.89% -> 10.37%              
client [59] (test)  loss: 6.2218 -> 6.3849   acc: 5.45% -> 6.55%               
client [7] (test)  loss: 10.2589 -> 6.3165   acc: 6.70% -> 7.97%               
client [26] (test)  loss: 6.5403 -> 5.8261   acc: 7.37% -> 8.63%               
client [49] (test)  loss: 6.2024 -> 6.4954   acc: 8.12% -> 7.04%               
client [98] (test)  loss: 5.9312 -> 6.7410   acc: 8.55% -> 8.18%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 7.1758 -> 7.5174   acc: 8.18% -> 8.00%               
client [47] (test)  loss: 9.6484 -> 6.2258   acc: 8.30% -> 9.21%               
client [21] (test)  loss: 6.6240 -> 6.3006   acc: 8.89% -> 10.16%              
client [77] (test)  loss: 7.2187 -> 7.1907   acc: 7.73% -> 7.55%               
client [95] (test)  loss: 7.3953 -> 7.6007   acc: 7.32% -> 8.07%               
client [91] (test)  loss: 8.1316 -> 7.6443   acc: 8.00% -> 7.64%               
client [14] (test)  loss: 6.8971 -> 7.3862   acc: 8.30% -> 8.30%               
client [99] (test)  loss: 7.2520 -> 7.5489   acc: 6.68% -> 6.86%               
client [20] (test)  loss: 7.9695 -> 7.4552   acc: 8.70% -> 10.96%              
client [39] (test)  loss: 8.1014 -> 7.0997   acc: 9.09% -> 7.64%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 8.9875 -> 7.6763   acc: 8.70% -> 7.61%               
client [62] (test)  loss: 8.0505 -> 8.0551   acc: 4.67% -> 5.92%               
client [71] (test)  loss: 7.5062 -> 7.9372   acc: 7.35% -> 8.24%               
client [97] (test)  loss: 7.9143 -> 6.8454   acc: 6.91% -> 5.27%               
client [30] (test)  loss: 7.6494 -> 8.4728   acc: 7.07% -> 6.70%               
client [88] (test)  loss: 6.9944 -> 6.8912   acc: 9.58% -> 9.76%               
client [60] (test)  loss: 7.9488 -> 7.7394   acc: 9.35% -> 9.89%               
client [82] (test)  loss: 7.1120 -> 6.9482   acc: 11.61% -> 11.61%             
client [91] (test)  loss: 8.6609 -> 8.7934   acc: 7.45% -> 7.09%               
client [57] (test)  loss: 7.0979 -> 7.3649   acc: 9.80% -> 8.71%               
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 10.7086 -> 10.7295   acc: 7.75% -> 6.67%             
client [15] (test)  loss: 8.0740 -> 8.1770   acc: 6.46% -> 7.00%               
client [71] (test)  loss: 9.0114 -> 8.6822   acc: 5.91% -> 7.71%               
client [97] (test)  loss: 8.8428 -> 8.3307   acc: 5.27% -> 5.45%               
client [53] (test)  loss: 9.0874 -> 8.0942   acc: 6.00% -> 7.58%               
client [77] (test)  loss: 9.4077 -> 8.2568   acc: 6.47% -> 8.99%               
client [76] (test)  loss: 8.1544 -> 7.8156   acc: 11.25% -> 10.16%             
client [79] (test)  loss: 9.4332 -> 8.4973   acc: 6.39% -> 6.75%               
client [28] (test)  loss: 9.1091 -> 8.7656   acc: 6.90% -> 7.26%               
client [99] (test)  loss: 10.0039 -> 9.1991   acc: 6.86% -> 7.58%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 9.6440 -> 9.1429   acc: 4.91% -> 5.64%               
client [86] (test)  loss: 8.3420 -> 8.8780   acc: 8.17% -> 9.26%               
client [34] (test)  loss: 8.9400 -> 9.5981   acc: 6.18% -> 5.45%               
client [73] (test)  loss: 8.7695 -> 8.9161   acc: 7.72% -> 7.72%               
client [5] (test)  loss: 8.4678 -> 9.0005   acc: 6.23% -> 6.23%                
client [96] (test)  loss: 8.4112 -> 8.9488   acc: 11.35% -> 9.37%              
client [22] (test)  loss: 7.9318 -> 8.4912   acc: 6.51% -> 7.96%               
client [60] (test)  loss: 9.2763 -> 9.4647   acc: 9.89% -> 10.07%              
client [66] (test)  loss: 10.1628 -> 9.0095   acc: 8.66% -> 9.21%              
client [83] (test)  loss: 10.8716 -> 9.1958   acc: 8.50% -> 7.96%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 10.4832 -> 9.1238   acc: 10.89% -> 10.16%            
client [65] (test)  loss: 10.1428 -> 9.7951   acc: 6.72% -> 7.26%              
client [95] (test)  loss: 11.5776 -> 10.5299   acc: 7.32% -> 7.13%             
client [17] (test)  loss: 11.4394 -> 8.4944   acc: 7.03% -> 7.75%              
client [8] (test)  loss: 11.7591 -> 10.0546   acc: 7.94% -> 7.76%              
client [35] (test)  loss: 11.2269 -> 10.1671   acc: 7.99% -> 10.16%            
client [98] (test)  loss: 9.3852 -> 9.6653   acc: 7.09% -> 8.55%               
client [53] (test)  loss: 9.3640 -> 9.1477   acc: 7.41% -> 8.29%               
client [43] (test)  loss: 10.0745 -> 9.4604   acc: 6.34% -> 7.43%              
client [64] (test)  loss: 9.9436 -> 9.5470   acc: 10.78% -> 9.85%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 10.5204 -> 8.9148   acc: 7.99% -> 8.89%              
client [88] (test)  loss: 10.5363 -> 10.2195   acc: 9.22% -> 8.68%             
client [38] (test)  loss: 10.8360 -> 10.9472   acc: 6.11% -> 7.59%             
client [3] (test)  loss: 11.1731 -> 10.1908   acc: 8.94% -> 11.99%             
client [5] (test)  loss: 10.3604 -> 10.1758   acc: 6.76% -> 6.23%              
client [41] (test)  loss: 11.1303 -> 9.9800   acc: 5.07% -> 5.62%              
client [7] (test)  loss: 11.2241 -> 9.7708   acc: 6.88% -> 9.06%               
client [37] (test)  loss: 10.2053 -> 9.3625   acc: 6.85% -> 7.21%              
client [45] (test)  loss: 10.6370 -> 8.6232   acc: 7.64% -> 8.91%              
client [47] (test)  loss: 11.8072 -> 9.3711   acc: 7.76% -> 7.76%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 12.4962 -> 11.5587   acc: 7.00% -> 8.44%             
client [11] (test)  loss: 10.4001 -> 9.8917   acc: 7.91% -> 8.81%              
client [37] (test)  loss: 10.3358 -> 10.3692   acc: 8.47% -> 7.03%             
client [41] (test)  loss: 11.6138 -> 10.5075   acc: 4.35% -> 5.80%             
client [95] (test)  loss: 12.6554 -> 12.0331   acc: 7.13% -> 6.94%             
client [53] (test)  loss: 11.5006 -> 10.0356   acc: 6.17% -> 8.29%             
client [22] (test)  loss: 9.8513 -> 9.9860   acc: 6.51% -> 7.96%               
client [25] (test)  loss: 9.6145 -> 10.0014   acc: 7.39% -> 8.47%              
client [69] (test)  loss: 12.0607 -> 11.9208   acc: 6.67% -> 7.96%             
client [46] (test)  loss: 10.2741 -> 9.5525   acc: 7.80% -> 7.80%              
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 11.0100 -> 11.7035   acc: 7.94% -> 8.66%             
client [69] (test)  loss: 12.7114 -> 12.6051   acc: 6.85% -> 7.59%             
client [82] (test)  loss: 10.6579 -> 10.4988   acc: 11.07% -> 12.14%           
client [45] (test)  loss: 10.5292 -> 10.3288   acc: 8.00% -> 9.09%             
client [7] (test)  loss: 11.4558 -> 10.7241   acc: 8.33% -> 10.51%             
client [50] (test)  loss: 11.2013 -> 10.6281   acc: 6.70% -> 5.43%             
client [35] (test)  loss: 12.6187 -> 12.1017   acc: 8.53% -> 8.35%             
client [24] (test)  loss: 12.6721 -> 11.4953   acc: 9.27% -> 8.20%             
client [15] (test)  loss: 11.5316 -> 11.4618   acc: 5.57% -> 6.10%             
client [58] (test)  loss: 11.9965 -> 12.5309   acc: 8.83% -> 8.29%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 11.9414 -> 11.4713   acc: 9.50% -> 9.50%             
client [76] (test)  loss: 12.0395 -> 11.3328   acc: 10.34% -> 10.53%           
client [67] (test)  loss: 11.5311 -> 11.6542   acc: 5.97% -> 7.28%             
client [37] (test)  loss: 12.0689 -> 11.5161   acc: 7.39% -> 7.21%             
client [58] (test)  loss: 12.6311 -> 13.1494   acc: 9.01% -> 8.29%             
client [64] (test)  loss: 11.9428 -> 11.8656   acc: 9.29% -> 9.11%             
client [77] (test)  loss: 11.4033 -> 11.6276   acc: 7.91% -> 8.09%             
client [55] (test)  loss: 13.8166 -> 12.3480   acc: 5.37% -> 6.44%             
client [12] (test)  loss: 12.8039 -> 12.1259   acc: 7.71% -> 9.14%             
client [89] (test)  loss: 12.4221 -> 12.3387   acc: 9.86% -> 9.86%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 13.8345 -> 13.3123   acc: 9.78% -> 11.05%            
client [51] (test)  loss: 13.1791 -> 12.9846   acc: 8.29% -> 6.67%             
client [8] (test)  loss: 14.1029 -> 13.4401   acc: 9.21% -> 8.30%              
client [18] (test)  loss: 12.4055 -> 11.7867   acc: 8.77% -> 9.12%             
client [94] (test)  loss: 13.5295 -> 12.8744   acc: 6.69% -> 7.78%             
client [81] (test)  loss: 12.9310 -> 13.0072   acc: 6.27% -> 7.56%             
client [3] (test)  loss: 12.9772 -> 12.8467   acc: 8.59% -> 9.84%              
client [11] (test)  loss: 11.8359 -> 11.6033   acc: 8.45% -> 7.37%             
client [95] (test)  loss: 14.1157 -> 13.8102   acc: 7.88% -> 7.50%             
client [67] (test)  loss: 12.6049 -> 12.1902   acc: 5.41% -> 6.34%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 12.9190 -> 11.3754   acc: 7.80% -> 9.62%             
client [79] (test)  loss: 13.6425 -> 13.9086   acc: 5.86% -> 5.86%             
client [58] (test)  loss: 13.3154 -> 13.9217   acc: 9.19% -> 8.11%             
client [88] (test)  loss: 13.3376 -> 12.8059   acc: 9.58% -> 9.04%             
client [46] (test)  loss: 13.2658 -> 11.7682   acc: 8.17% -> 8.17%             
client [11] (test)  loss: 12.3440 -> 12.1045   acc: 7.19% -> 7.55%             
client [55] (test)  loss: 13.6823 -> 13.7059   acc: 6.44% -> 5.55%             
client [13] (test)  loss: 13.6971 -> 13.3147   acc: 10.33% -> 9.24%            
client [31] (test)  loss: 16.2406 -> 15.6556   acc: 7.03% -> 7.21%             
client [75] (test)  loss: 13.0960 -> 12.7220   acc: 11.55% -> 11.19%           
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 14.2664 -> 14.6617   acc: 7.38% -> 7.79%             
client [7] (test)  loss: 13.3756 -> 13.3537   acc: 10.14% -> 9.06%             
client [57] (test)  loss: 13.4570 -> 13.3401   acc: 7.99% -> 8.17%             
client [13] (test)  loss: 13.8555 -> 13.7452   acc: 10.51% -> 9.42%            
client [43] (test)  loss: 12.7974 -> 13.2487   acc: 6.16% -> 6.88%             
client [91] (test)  loss: 15.1267 -> 14.1080   acc: 5.45% -> 6.73%             
client [10] (test)  loss: 14.6046 -> 13.9282   acc: 9.53% -> 9.53%             
client [64] (test)  loss: 13.3097 -> 13.7207   acc: 8.55% -> 7.81%             
client [82] (test)  loss: 12.5002 -> 12.7076   acc: 10.54% -> 11.79%           
client [22] (test)  loss: 12.5349 -> 12.8594   acc: 6.33% -> 6.33%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 14.7288 -> 14.2240   acc: 8.70% -> 9.83%             
client [23] (test)  loss: 14.9622 -> 13.8923   acc: 5.61% -> 5.61%             
client [88] (test)  loss: 14.1284 -> 13.5877   acc: 9.04% -> 9.22%             
client [98] (test)  loss: 13.9343 -> 14.0938   acc: 9.27% -> 7.45%             
client [79] (test)  loss: 14.4754 -> 14.8526   acc: 5.68% -> 5.86%             
client [21] (test)  loss: 13.0654 -> 12.1792   acc: 8.53% -> 9.44%             
client [92] (test)  loss: 14.6691 -> 13.8821   acc: 10.54% -> 10.54%           
client [56] (test)  loss: 13.3971 -> 13.4770   acc: 8.30% -> 8.66%             
client [5] (test)  loss: 14.0091 -> 13.6721   acc: 4.98% -> 5.69%              
client [52] (test)  loss: 14.9754 -> 14.9497   acc: 7.43% -> 7.25%             
==================== FedPer_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '8.9423 -> 0.0000', 'accuracy': '7.78% -> 0.00%'},           
    200: {'loss': '14.3443 -> 0.0000', 'accuracy': '7.72% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Convergence (test_after):                                                      
