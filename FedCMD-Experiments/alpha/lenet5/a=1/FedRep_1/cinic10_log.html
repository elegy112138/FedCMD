==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0469 -> 2.2253   acc: 35.41% -> 35.99%             
client [81] (test)  loss: 2.0439 -> 1.7789   acc: 28.83% -> 33.48%             
client [21] (test)  loss: 16.1644 -> 1.6495   acc: 10.81% -> 37.20%            
client [68] (test)  loss: 3.0402 -> 1.6580   acc: 25.23% -> 44.76%             
client [93] (test)  loss: 2.1926 -> 1.6011   acc: 16.87% -> 41.92%             
client [31] (test)  loss: 3.2311 -> 1.5038   acc: 30.19% -> 38.51%             
client [20] (test)  loss: 1.9012 -> 2.9219   acc: 35.03% -> 33.14%             
client [59] (test)  loss: 20.2374 -> 1.6951   acc: 8.84% -> 37.58%             
client [48] (test)  loss: 1.5291 -> 1.5811   acc: 39.97% -> 37.24%             
client [34] (test)  loss: 1.8370 -> 2.2414   acc: 31.04% -> 29.43%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.0851 -> 1.9805   acc: 12.11% -> 34.33%             
client [99] (test)  loss: 3.2825 -> 1.1060   acc: 53.88% -> 64.81%             
client [67] (test)  loss: 2.1129 -> 2.6116   acc: 27.55% -> 19.97%             
client [0] (test)  loss: 1.5033 -> 2.1556   acc: 53.80% -> 33.23%              
client [76] (test)  loss: 2.9761 -> 2.2120   acc: 39.05% -> 40.90%             
client [41] (test)  loss: 1.7662 -> 1.6205   acc: 39.54% -> 42.29%             
client [62] (test)  loss: 81.3575 -> 1.7305   acc: 12.22% -> 35.66%            
client [2] (test)  loss: 76.0945 -> 3.2006   acc: 5.55% -> 27.33%              
client [14] (test)  loss: 0.9625 -> 0.8619   acc: 61.89% -> 64.23%             
client [46] (test)  loss: 1.7609 -> 1.4992   acc: 30.29% -> 44.60%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3617 -> 1.4434   acc: 53.23% -> 53.44%             
client [68] (test)  loss: 1.4971 -> 1.7319   acc: 54.01% -> 48.01%             
client [57] (test)  loss: 1.4234 -> 1.2382   acc: 38.63% -> 46.73%             
client [17] (test)  loss: 1.2882 -> 1.6078   acc: 50.37% -> 38.58%             
client [54] (test)  loss: 1.0012 -> 1.8717   acc: 60.68% -> 39.46%             
client [23] (test)  loss: 45.6254 -> 1.4711   acc: 20.44% -> 46.12%            
client [35] (test)  loss: 1.5704 -> 1.4006   acc: 42.57% -> 46.81%             
client [59] (test)  loss: 1.2848 -> 1.4987   acc: 57.87% -> 48.63%             
client [31] (test)  loss: 1.2914 -> 1.3424   acc: 47.88% -> 46.98%             
client [9] (test)  loss: 1.4015 -> 1.3682   acc: 43.20% -> 42.87%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.6093 -> 1.4974   acc: 44.82% -> 45.20%             
client [33] (test)  loss: 1.3886 -> 2.2796   acc: 48.87% -> 35.36%             
client [16] (test)  loss: 1.1811 -> 1.7551   acc: 57.37% -> 40.23%             
client [44] (test)  loss: 4.3209 -> 1.2434   acc: 34.16% -> 47.36%             
client [8] (test)  loss: 1.1400 -> 2.3252   acc: 62.34% -> 51.27%              
client [31] (test)  loss: 1.4943 -> 1.2634   acc: 40.60% -> 51.21%             
client [47] (test)  loss: 1.2906 -> 1.4884   acc: 57.44% -> 50.15%             
client [36] (test)  loss: 1.2832 -> 1.2609   acc: 50.64% -> 50.92%             
client [20] (test)  loss: 1.6523 -> 2.9550   acc: 44.00% -> 33.43%             
client [56] (test)  loss: 1.5607 -> 1.8824   acc: 40.56% -> 34.51%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.3342 -> 1.4202   acc: 53.24% -> 50.66%              
client [60] (test)  loss: 1.6986 -> 1.8097   acc: 42.16% -> 41.57%             
client [28] (test)  loss: 1.3947 -> 1.6219   acc: 53.08% -> 46.76%             
client [25] (test)  loss: 1.4686 -> 1.5808   acc: 45.24% -> 40.21%             
client [58] (test)  loss: 1.3817 -> 1.8894   acc: 50.20% -> 39.15%             
client [44] (test)  loss: 1.1862 -> 1.2985   acc: 46.73% -> 46.15%             
client [39] (test)  loss: 1.3392 -> 1.2971   acc: 51.83% -> 53.16%             
client [29] (test)  loss: 1.5793 -> 1.5590   acc: 44.70% -> 43.22%             
client [3] (test)  loss: 1.5578 -> 3.1885   acc: 42.18% -> 8.85%               
client [84] (test)  loss: 1.2978 -> 3.5394   acc: 56.54% -> 35.45%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2583 -> 1.8014   acc: 53.08% -> 34.00%             
client [84] (test)  loss: 1.2135 -> 3.2397   acc: 59.95% -> 46.29%             
client [10] (test)  loss: 1.1359 -> 1.3436   acc: 61.55% -> 54.74%             
client [36] (test)  loss: 1.2170 -> 1.3285   acc: 51.27% -> 50.21%             
client [65] (test)  loss: 1.5304 -> 1.3838   acc: 40.63% -> 47.99%             
client [81] (test)  loss: 1.5517 -> 2.7937   acc: 42.85% -> 19.32%             
client [79] (test)  loss: 1.3170 -> 1.3034   acc: 51.84% -> 50.95%             
client [42] (test)  loss: 1.4623 -> 1.4105   acc: 46.53% -> 48.84%             
client [11] (test)  loss: 1.5121 -> 2.2006   acc: 46.17% -> 27.04%             
client [96] (test)  loss: 1.3401 -> 2.4751   acc: 50.16% -> 25.67%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.0781 -> 1.9631   acc: 65.13% -> 53.42%              
client [53] (test)  loss: 1.3053 -> 1.4464   acc: 49.38% -> 43.08%             
client [52] (test)  loss: 1.1897 -> 2.4381   acc: 56.41% -> 38.97%             
client [42] (test)  loss: 1.4162 -> 1.3813   acc: 49.59% -> 50.78%             
client [69] (test)  loss: 1.3544 -> 1.6087   acc: 53.13% -> 48.22%             
client [59] (test)  loss: 1.1721 -> 1.4072   acc: 60.99% -> 51.24%             
client [7] (test)  loss: 1.1024 -> 1.5923   acc: 66.49% -> 49.66%              
client [26] (test)  loss: 0.9974 -> 1.5754   acc: 66.10% -> 45.00%             
client [49] (test)  loss: 1.4812 -> 1.4718   acc: 43.96% -> 44.73%             
client [98] (test)  loss: 1.5164 -> 1.4308   acc: 40.17% -> 44.94%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4459 -> 1.4246   acc: 42.78% -> 45.46%             
client [47] (test)  loss: 1.4185 -> 1.2898   acc: 55.51% -> 55.51%             
client [21] (test)  loss: 1.2238 -> 1.6292   acc: 52.90% -> 39.98%             
client [77] (test)  loss: 1.2697 -> 2.0011   acc: 56.32% -> 41.93%             
client [95] (test)  loss: 1.3899 -> 1.5710   acc: 48.23% -> 39.05%             
client [91] (test)  loss: 1.2769 -> 1.7510   acc: 47.46% -> 23.59%             
client [14] (test)  loss: 0.7638 -> 0.9063   acc: 69.92% -> 65.19%             
client [99] (test)  loss: 1.0112 -> 1.0193   acc: 66.60% -> 65.22%             
client [20] (test)  loss: 1.3611 -> 5.4765   acc: 50.61% -> 16.53%             
client [39] (test)  loss: 1.2619 -> 1.2666   acc: 53.02% -> 54.35%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1517 -> 2.4566   acc: 59.19% -> 40.15%             
client [62] (test)  loss: 1.1642 -> 1.4371   acc: 55.40% -> 44.54%             
client [71] (test)  loss: 1.2937 -> 1.4418   acc: 51.10% -> 46.57%             
client [97] (test)  loss: 1.3804 -> 1.5263   acc: 52.76% -> 43.78%             
client [30] (test)  loss: 1.2469 -> 2.0614   acc: 52.14% -> 30.31%             
client [88] (test)  loss: 1.1838 -> 1.2082   acc: 55.56% -> 57.11%             
client [60] (test)  loss: 1.5275 -> 1.9054   acc: 46.83% -> 42.06%             
client [82] (test)  loss: 1.4810 -> 1.5902   acc: 43.70% -> 41.64%             
client [91] (test)  loss: 1.2901 -> 1.8434   acc: 48.02% -> 21.61%             
client [57] (test)  loss: 0.9804 -> 1.0211   acc: 57.78% -> 58.48%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.1200 -> 1.1904   acc: 58.50% -> 54.20%             
client [15] (test)  loss: 0.9110 -> 2.3174   acc: 68.65% -> 28.67%             
client [71] (test)  loss: 1.2868 -> 1.3646   acc: 53.19% -> 48.59%             
client [97] (test)  loss: 1.3583 -> 1.7039   acc: 52.42% -> 39.06%             
client [53] (test)  loss: 1.2436 -> 1.9100   acc: 51.85% -> 29.00%             
client [77] (test)  loss: 1.2553 -> 1.9053   acc: 53.70% -> 42.61%             
client [76] (test)  loss: 0.9026 -> 1.5779   acc: 68.93% -> 49.73%             
client [79] (test)  loss: 1.2565 -> 1.3125   acc: 53.45% -> 51.17%             
client [28] (test)  loss: 1.4094 -> 1.5731   acc: 54.96% -> 51.37%             
client [99] (test)  loss: 0.9926 -> 1.0588   acc: 67.42% -> 64.12%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.3645 -> 1.6089   acc: 54.84% -> 43.09%             
client [86] (test)  loss: 1.1497 -> 1.2376   acc: 55.39% -> 51.13%             
client [34] (test)  loss: 1.1394 -> 1.1695   acc: 59.90% -> 58.93%             
client [73] (test)  loss: 1.3852 -> 1.9262   acc: 50.28% -> 31.26%             
client [5] (test)  loss: 1.1358 -> 1.1498   acc: 60.97% -> 61.56%              
client [96] (test)  loss: 1.4572 -> 4.8363   acc: 46.73% -> 20.44%             
client [22] (test)  loss: 1.1099 -> 1.3502   acc: 61.46% -> 56.56%             
client [60] (test)  loss: 1.3659 -> 1.9625   acc: 52.48% -> 43.15%             
client [66] (test)  loss: 1.0053 -> 1.0195   acc: 66.14% -> 66.81%             
client [83] (test)  loss: 1.1773 -> 1.0125   acc: 61.78% -> 66.51%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.8580 -> 1.1818   acc: 70.22% -> 57.51%             
client [65] (test)  loss: 1.4975 -> 1.2919   acc: 44.07% -> 53.54%             
client [95] (test)  loss: 1.3039 -> 1.3783   acc: 50.51% -> 47.22%             
client [17] (test)  loss: 1.1465 -> 1.1075   acc: 57.47% -> 59.59%             
client [8] (test)  loss: 1.1953 -> 1.4187   acc: 63.14% -> 60.03%              
client [35] (test)  loss: 1.2410 -> 1.2496   acc: 55.35% -> 54.89%             
client [98] (test)  loss: 1.4631 -> 1.3807   acc: 42.19% -> 46.11%             
client [53] (test)  loss: 1.3303 -> 1.7916   acc: 48.69% -> 34.15%             
client [43] (test)  loss: 0.7706 -> 0.6789   acc: 74.00% -> 77.56%             
client [64] (test)  loss: 1.2891 -> 1.3675   acc: 55.13% -> 48.09%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.1151 -> 1.2908   acc: 59.48% -> 49.94%             
client [88] (test)  loss: 1.2871 -> 1.1583   acc: 56.89% -> 57.78%             
client [38] (test)  loss: 1.1295 -> 1.7545   acc: 59.68% -> 47.57%             
client [3] (test)  loss: 1.4897 -> 2.0959   acc: 45.10% -> 27.02%              
client [5] (test)  loss: 1.1289 -> 1.1349   acc: 61.03% -> 61.92%              
client [41] (test)  loss: 1.4221 -> 2.2425   acc: 50.83% -> 33.53%             
client [7] (test)  loss: 1.0944 -> 1.5497   acc: 64.18% -> 49.25%              
client [37] (test)  loss: 1.0999 -> 1.3125   acc: 59.96% -> 52.61%             
client [45] (test)  loss: 1.4004 -> 1.3644   acc: 46.54% -> 49.56%             
client [47] (test)  loss: 1.0695 -> 1.2178   acc: 64.66% -> 56.92%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.1983 -> 1.1951   acc: 56.04% -> 53.57%             
client [11] (test)  loss: 1.4882 -> 2.1571   acc: 49.65% -> 35.30%             
client [37] (test)  loss: 1.1389 -> 1.2925   acc: 60.25% -> 53.42%             
client [41] (test)  loss: 1.5713 -> 2.2129   acc: 48.08% -> 34.61%             
client [95] (test)  loss: 1.3061 -> 1.3741   acc: 51.52% -> 47.85%             
client [53] (test)  loss: 1.1776 -> 1.5211   acc: 55.85% -> 42.62%             
client [22] (test)  loss: 1.0521 -> 1.2869   acc: 62.61% -> 58.93%             
client [25] (test)  loss: 1.3650 -> 1.3531   acc: 49.03% -> 50.69%             
client [69] (test)  loss: 1.3846 -> 1.5904   acc: 51.64% -> 49.36%             
client [46] (test)  loss: 1.2023 -> 1.1677   acc: 53.07% -> 55.99%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.1621 -> 1.1897   acc: 60.12% -> 57.51%             
client [69] (test)  loss: 1.3194 -> 1.5944   acc: 55.06% -> 49.22%             
client [82] (test)  loss: 1.2952 -> 1.4741   acc: 53.41% -> 45.75%             
client [45] (test)  loss: 1.3527 -> 1.2940   acc: 52.27% -> 53.46%             
client [7] (test)  loss: 1.0908 -> 1.4197   acc: 64.45% -> 52.65%              
client [50] (test)  loss: 1.4764 -> 1.4820   acc: 44.46% -> 43.93%             
client [35] (test)  loss: 1.2541 -> 1.2512   acc: 56.04% -> 54.27%             
client [24] (test)  loss: 1.0868 -> 1.4526   acc: 63.99% -> 54.81%             
client [15] (test)  loss: 0.8949 -> 1.4418   acc: 70.61% -> 51.59%             
client [58] (test)  loss: 1.2013 -> 1.2968   acc: 57.79% -> 53.16%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0486 -> 1.0527   acc: 58.19% -> 57.98%             
client [76] (test)  loss: 0.9605 -> 0.9707   acc: 65.79% -> 65.29%             
client [67] (test)  loss: 1.4689 -> 2.6561   acc: 47.60% -> 22.97%             
client [37] (test)  loss: 1.2244 -> 1.3765   acc: 58.78% -> 51.73%             
client [58] (test)  loss: 1.2427 -> 1.2673   acc: 55.92% -> 54.24%             
client [64] (test)  loss: 1.4035 -> 1.2761   acc: 50.67% -> 53.19%             
client [77] (test)  loss: 1.2634 -> 1.5491   acc: 55.16% -> 48.64%             
client [55] (test)  loss: 1.7127 -> 1.5611   acc: 41.37% -> 42.91%             
client [12] (test)  loss: 1.3308 -> 1.1016   acc: 56.30% -> 62.67%             
client [89] (test)  loss: 1.3377 -> 1.4560   acc: 53.54% -> 49.90%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1157 -> 1.2698   acc: 61.43% -> 62.13%             
client [51] (test)  loss: 1.1499 -> 1.8498   acc: 58.80% -> 36.14%             
client [8] (test)  loss: 1.1207 -> 1.2767   acc: 65.45% -> 63.14%              
client [18] (test)  loss: 0.9574 -> 1.3049   acc: 67.84% -> 55.34%             
client [94] (test)  loss: 0.9287 -> 1.0272   acc: 67.27% -> 62.65%             
client [81] (test)  loss: 1.1943 -> 2.1147   acc: 58.33% -> 31.56%             
client [3] (test)  loss: 1.3185 -> 1.9955   acc: 51.04% -> 30.89%              
client [11] (test)  loss: 1.3042 -> 1.9831   acc: 53.91% -> 40.43%             
client [95] (test)  loss: 1.2884 -> 1.4206   acc: 51.90% -> 46.46%             
client [67] (test)  loss: 1.3155 -> 2.7898   acc: 52.10% -> 20.35%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1130 -> 1.1107   acc: 60.08% -> 56.46%             
client [79] (test)  loss: 1.3109 -> 1.4166   acc: 50.66% -> 47.28%             
client [58] (test)  loss: 1.3022 -> 1.2714   acc: 54.64% -> 54.24%             
client [88] (test)  loss: 1.2820 -> 1.1125   acc: 56.00% -> 60.67%             
client [46] (test)  loss: 1.2320 -> 1.1655   acc: 52.04% -> 56.20%             
client [11] (test)  loss: 1.5491 -> 1.9020   acc: 48.35% -> 41.91%             
client [55] (test)  loss: 1.6456 -> 1.5234   acc: 40.97% -> 43.79%             
client [13] (test)  loss: 1.2396 -> 1.2755   acc: 57.54% -> 57.15%             
client [31] (test)  loss: 1.2959 -> 1.0725   acc: 51.70% -> 61.14%             
client [75] (test)  loss: 0.6340 -> 0.4792   acc: 78.82% -> 85.09%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.4288 -> 1.4104   acc: 49.58% -> 49.92%             
client [7] (test)  loss: 0.9583 -> 1.2889   acc: 68.11% -> 57.12%              
client [57] (test)  loss: 0.9208 -> 1.0020   acc: 61.86% -> 58.27%             
client [13] (test)  loss: 1.1872 -> 1.2788   acc: 60.59% -> 56.76%             
client [43] (test)  loss: 0.6548 -> 0.6389   acc: 78.65% -> 79.30%             
client [91] (test)  loss: 1.2506 -> 1.3540   acc: 48.66% -> 41.24%             
client [10] (test)  loss: 1.0844 -> 1.0168   acc: 62.50% -> 65.26%             
client [64] (test)  loss: 1.2271 -> 1.2370   acc: 56.95% -> 54.64%             
client [82] (test)  loss: 1.4995 -> 1.6226   acc: 46.22% -> 43.98%             
client [22] (test)  loss: 1.0293 -> 1.1842   acc: 63.90% -> 60.09%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.3201 -> 1.7039   acc: 53.45% -> 44.95%             
client [23] (test)  loss: 1.2656 -> 1.4361   acc: 54.96% -> 51.53%             
client [88] (test)  loss: 1.1564 -> 1.0772   acc: 58.22% -> 63.33%             
client [98] (test)  loss: 1.3628 -> 1.3936   acc: 49.12% -> 47.03%             
client [79] (test)  loss: 1.2134 -> 1.6021   acc: 54.63% -> 40.16%             
client [21] (test)  loss: 1.1498 -> 1.0521   acc: 55.50% -> 61.17%             
client [92] (test)  loss: 1.5641 -> 1.4859   acc: 39.72% -> 42.43%             
client [56] (test)  loss: 1.5933 -> 1.6363   acc: 40.11% -> 38.66%             
client [5] (test)  loss: 1.0904 -> 1.1459   acc: 61.80% -> 60.31%              
client [52] (test)  loss: 1.0208 -> 1.7246   acc: 63.74% -> 49.30%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '1.2211 -> 0.0000', 'accuracy': '56.07% -> 0.00%'},          
    200: {'loss': '1.1686 -> 0.0000', 'accuracy': '57.90% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(10.65%) at epoch: 0                                    
FedRep_1 achieved 20.0%(20.44%) at epoch: 3                                    
FedRep_1 achieved 30.0%(33.10%) at epoch: 7                                    
FedRep_1 achieved 40.0%(41.51%) at epoch: 24                                   
FedRep_1 achieved 50.0%(50.28%) at epoch: 28                                   
FedRep_1 achieved 60.0%(60.33%) at epoch: 82                                   
Convergence (test_after):                                                      
FedRep_1 achieved 30.0%(33.42%) at epoch: 0                                    
FedRep_1 achieved 40.0%(46.36%) at epoch: 3                                    
FedRep_1 achieved 50.0%(52.69%) at epoch: 46                                   
