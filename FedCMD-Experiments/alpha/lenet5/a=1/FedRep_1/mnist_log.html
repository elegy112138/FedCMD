==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.8507 -> 1.6826   acc: 20.05% -> 48.24%             
client [81] (test)  loss: 1.7701 -> 1.6641   acc: 45.87% -> 54.13%             
client [21] (test)  loss: 48.8390 -> 1.6151   acc: 17.49% -> 46.77%            
client [68] (test)  loss: 1.5623 -> 1.3022   acc: 64.67% -> 75.21%             
client [93] (test)  loss: 1.7140 -> 1.5380   acc: 47.07% -> 48.54%             
client [31] (test)  loss: 1.8076 -> 1.5168   acc: 51.62% -> 47.08%             
client [20] (test)  loss: 1.4395 -> 1.2295   acc: 64.97% -> 66.45%             
client [59] (test)  loss: 39.6673 -> 1.4699   acc: 11.72% -> 54.77%            
client [48] (test)  loss: 1.6238 -> 1.4580   acc: 39.53% -> 49.32%             
client [34] (test)  loss: 1.7958 -> 1.6956   acc: 29.66% -> 39.83%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5184 -> 1.0484   acc: 37.90% -> 72.89%             
client [99] (test)  loss: 1.3968 -> 1.1248   acc: 47.32% -> 70.24%             
client [67] (test)  loss: 1.5921 -> 1.4350   acc: 58.30% -> 66.41%             
client [0] (test)  loss: 1.0136 -> 0.8721   acc: 72.00% -> 72.53%              
client [76] (test)  loss: 0.6755 -> 0.6282   acc: 88.79% -> 87.85%             
client [41] (test)  loss: 1.3552 -> 1.1327   acc: 50.46% -> 62.33%             
client [62] (test)  loss: 64.6136 -> 0.9092   acc: 26.26% -> 77.37%            
client [2] (test)  loss: 76.4973 -> 1.2058   acc: 22.38% -> 58.84%             
client [14] (test)  loss: 1.3046 -> 1.2079   acc: 63.54% -> 70.17%             
client [46] (test)  loss: 1.2804 -> 1.1181   acc: 55.89% -> 63.97%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9300 -> 0.8382   acc: 78.99% -> 79.38%             
client [68] (test)  loss: 0.4083 -> 0.3509   acc: 87.75% -> 93.45%             
client [57] (test)  loss: 0.7777 -> 0.6624   acc: 74.54% -> 81.63%             
client [17] (test)  loss: 0.8508 -> 0.6050   acc: 65.32% -> 85.27%             
client [54] (test)  loss: 0.6153 -> 0.5667   acc: 81.06% -> 81.89%             
client [23] (test)  loss: 35.1520 -> 0.7233   acc: 63.59% -> 77.31%            
client [35] (test)  loss: 0.7867 -> 0.6832   acc: 76.23% -> 80.05%             
client [59] (test)  loss: 0.6139 -> 0.5399   acc: 81.20% -> 82.83%             
client [31] (test)  loss: 0.8306 -> 0.7797   acc: 69.48% -> 69.16%             
client [9] (test)  loss: 0.8994 -> 0.8366   acc: 71.98% -> 73.71%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1821 -> 0.1581   acc: 96.34% -> 97.12%             
client [33] (test)  loss: 0.6053 -> 0.5631   acc: 83.55% -> 85.20%             
client [16] (test)  loss: 0.3689 -> 0.3287   acc: 89.08% -> 90.32%             
client [44] (test)  loss: 1.3467 -> 0.7094   acc: 47.79% -> 79.65%             
client [8] (test)  loss: 0.4926 -> 0.4676   acc: 86.99% -> 87.50%              
client [31] (test)  loss: 0.6542 -> 0.6062   acc: 74.68% -> 76.62%             
client [47] (test)  loss: 0.5037 -> 0.3874   acc: 80.29% -> 86.70%             
client [36] (test)  loss: 0.5813 -> 0.4941   acc: 86.13% -> 89.29%             
client [20] (test)  loss: 0.4043 -> 0.3492   acc: 86.84% -> 89.60%             
client [56] (test)  loss: 0.5239 -> 0.4495   acc: 86.76% -> 90.14%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5625 -> 0.5041   acc: 85.96% -> 87.68%              
client [60] (test)  loss: 0.3817 -> 0.2954   acc: 88.26% -> 93.15%             
client [28] (test)  loss: 0.8053 -> 0.5854   acc: 76.55% -> 82.41%             
client [25] (test)  loss: 0.6281 -> 0.4543   acc: 79.56% -> 87.02%             
client [58] (test)  loss: 0.2537 -> 0.2221   acc: 91.97% -> 92.52%             
client [44] (test)  loss: 0.6203 -> 0.5119   acc: 80.53% -> 85.55%             
client [39] (test)  loss: 0.4666 -> 0.4141   acc: 89.21% -> 88.97%             
client [29] (test)  loss: 0.5672 -> 0.3460   acc: 85.83% -> 89.58%             
client [3] (test)  loss: 0.4120 -> 0.3454   acc: 89.07% -> 91.16%              
client [84] (test)  loss: 0.4715 -> 0.4443   acc: 84.02% -> 85.31%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.5360 -> 0.4062   acc: 84.79% -> 86.69%             
client [84] (test)  loss: 0.3842 -> 0.3711   acc: 87.11% -> 87.37%             
client [10] (test)  loss: 0.3909 -> 0.3191   acc: 88.56% -> 91.76%             
client [36] (test)  loss: 0.3064 -> 0.2892   acc: 92.21% -> 91.97%             
client [65] (test)  loss: 0.3709 -> 0.3643   acc: 89.40% -> 89.95%             
client [81] (test)  loss: 0.4144 -> 0.3718   acc: 87.60% -> 89.67%             
client [79] (test)  loss: 0.2502 -> 0.2221   acc: 94.10% -> 94.79%             
client [42] (test)  loss: 0.3306 -> 0.3174   acc: 92.15% -> 92.56%             
client [11] (test)  loss: 0.3155 -> 0.2857   acc: 90.70% -> 91.27%             
client [96] (test)  loss: 0.2758 -> 0.2191   acc: 90.45% -> 93.72%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3526 -> 0.3283   acc: 89.80% -> 91.07%              
client [53] (test)  loss: 0.3860 -> 0.3415   acc: 89.84% -> 90.24%             
client [52] (test)  loss: 0.3502 -> 0.3352   acc: 91.10% -> 91.46%             
client [42] (test)  loss: 0.2812 -> 0.2696   acc: 92.98% -> 92.56%             
client [69] (test)  loss: 0.2943 -> 0.2941   acc: 91.55% -> 91.25%             
client [59] (test)  loss: 0.2101 -> 0.1971   acc: 94.01% -> 94.55%             
client [7] (test)  loss: 0.3509 -> 0.2910   acc: 90.36% -> 92.97%              
client [26] (test)  loss: 0.2332 -> 0.2107   acc: 92.73% -> 93.17%             
client [49] (test)  loss: 0.2200 -> 0.2089   acc: 94.33% -> 95.18%             
client [98] (test)  loss: 0.3570 -> 0.3459   acc: 91.39% -> 91.39%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.3261 -> 0.3183   acc: 91.39% -> 91.39%             
client [47] (test)  loss: 0.2351 -> 0.1873   acc: 91.21% -> 93.11%             
client [21] (test)  loss: 0.3371 -> 0.3268   acc: 88.21% -> 89.35%             
client [77] (test)  loss: 0.2262 -> 0.2150   acc: 93.22% -> 93.22%             
client [95] (test)  loss: 0.1439 -> 0.1348   acc: 96.14% -> 96.14%             
client [91] (test)  loss: 0.2709 -> 0.2626   acc: 93.36% -> 94.25%             
client [14] (test)  loss: 0.3570 -> 0.3439   acc: 90.06% -> 88.95%             
client [99] (test)  loss: 0.3192 -> 0.3049   acc: 90.49% -> 90.49%             
client [20] (test)  loss: 0.1711 -> 0.1507   acc: 95.33% -> 95.75%             
client [39] (test)  loss: 0.2405 -> 0.2220   acc: 94.72% -> 95.92%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.2855 -> 0.2795   acc: 92.17% -> 91.81%             
client [62] (test)  loss: 0.1703 -> 0.1689   acc: 95.81% -> 95.53%             
client [71] (test)  loss: 0.1514 -> 0.1475   acc: 97.00% -> 96.46%             
client [97] (test)  loss: 0.1825 -> 0.1661   acc: 93.75% -> 95.31%             
client [30] (test)  loss: 0.1768 -> 0.1663   acc: 96.57% -> 96.57%             
client [88] (test)  loss: 0.1246 -> 0.1172   acc: 95.95% -> 96.59%             
client [60] (test)  loss: 0.1442 -> 0.1423   acc: 95.60% -> 96.09%             
client [82] (test)  loss: 0.2633 -> 0.2531   acc: 90.20% -> 91.02%             
client [91] (test)  loss: 0.2296 -> 0.2277   acc: 94.69% -> 94.69%             
client [57] (test)  loss: 0.1912 -> 0.1905   acc: 95.01% -> 95.80%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2912 -> 0.2720   acc: 91.56% -> 91.88%             
client [15] (test)  loss: 0.2185 -> 0.2088   acc: 93.15% -> 94.15%             
client [71] (test)  loss: 0.1421 -> 0.1387   acc: 96.73% -> 96.46%             
client [97] (test)  loss: 0.1468 -> 0.1420   acc: 95.62% -> 95.94%             
client [53] (test)  loss: 0.2507 -> 0.2343   acc: 92.28% -> 92.68%             
client [77] (test)  loss: 0.1834 -> 0.1813   acc: 94.58% -> 93.50%             
client [76] (test)  loss: 0.2151 -> 0.2153   acc: 94.39% -> 95.33%             
client [79] (test)  loss: 0.1425 -> 0.1342   acc: 95.66% -> 96.18%             
client [28] (test)  loss: 0.3117 -> 0.3021   acc: 90.34% -> 91.72%             
client [99] (test)  loss: 0.2586 -> 0.2557   acc: 92.44% -> 92.68%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1311 -> 0.1284   acc: 96.25% -> 96.25%             
client [86] (test)  loss: 0.2219 -> 0.2190   acc: 95.65% -> 96.01%             
client [34] (test)  loss: 0.1865 -> 0.1857   acc: 95.20% -> 95.76%             
client [73] (test)  loss: 0.0941 -> 0.0924   acc: 97.86% -> 98.13%             
client [5] (test)  loss: 0.2586 -> 0.2562   acc: 92.39% -> 92.64%              
client [96] (test)  loss: 0.1197 -> 0.1152   acc: 95.98% -> 96.73%             
client [22] (test)  loss: 0.1186 -> 0.1154   acc: 97.18% -> 97.18%             
client [60] (test)  loss: 0.1209 -> 0.1203   acc: 96.33% -> 96.33%             
client [66] (test)  loss: 0.1496 -> 0.1453   acc: 95.75% -> 95.75%             
client [83] (test)  loss: 0.1666 -> 0.1709   acc: 95.65% -> 95.40%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2092 -> 0.2089   acc: 95.33% -> 95.33%             
client [65] (test)  loss: 0.2629 -> 0.2729   acc: 92.39% -> 92.12%             
client [95] (test)  loss: 0.0869 -> 0.0843   acc: 97.94% -> 98.46%             
client [17] (test)  loss: 0.1417 -> 0.1390   acc: 96.20% -> 95.49%             
client [8] (test)  loss: 0.2738 -> 0.2547   acc: 91.84% -> 92.60%              
client [35] (test)  loss: 0.1567 -> 0.1583   acc: 94.54% -> 94.26%             
client [98] (test)  loss: 0.2621 -> 0.2553   acc: 92.88% -> 92.88%             
client [53] (test)  loss: 0.2102 -> 0.2017   acc: 93.09% -> 93.90%             
client [43] (test)  loss: 0.2503 -> 0.2505   acc: 92.40% -> 92.78%             
client [64] (test)  loss: 0.0474 -> 0.0395   acc: 99.21% -> 99.21%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2547 -> 0.2542   acc: 93.54% -> 92.78%             
client [88] (test)  loss: 0.0916 -> 0.0872   acc: 97.01% -> 97.23%             
client [38] (test)  loss: 0.1568 -> 0.1513   acc: 94.96% -> 95.97%             
client [3] (test)  loss: 0.1454 -> 0.1402   acc: 96.05% -> 96.28%              
client [5] (test)  loss: 0.2323 -> 0.2375   acc: 93.91% -> 92.64%              
client [41] (test)  loss: 0.1966 -> 0.1975   acc: 93.61% -> 93.61%             
client [7] (test)  loss: 0.1846 -> 0.1569   acc: 94.27% -> 95.05%              
client [37] (test)  loss: 0.0894 -> 0.0879   acc: 97.27% -> 97.27%             
client [45] (test)  loss: 0.1368 -> 0.1264   acc: 95.60% -> 95.85%             
client [47] (test)  loss: 0.1291 -> 0.1298   acc: 95.72% -> 95.72%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.1230 -> 0.1192   acc: 96.03% -> 96.28%             
client [11] (test)  loss: 0.0947 -> 0.0958   acc: 96.62% -> 96.62%             
client [37] (test)  loss: 0.0830 -> 0.0826   acc: 97.27% -> 97.54%             
client [41] (test)  loss: 0.1908 -> 0.1877   acc: 92.92% -> 93.61%             
client [95] (test)  loss: 0.0723 -> 0.0741   acc: 98.71% -> 98.46%             
client [53] (test)  loss: 0.2019 -> 0.1866   acc: 93.09% -> 94.31%             
client [22] (test)  loss: 0.0969 -> 0.0964   acc: 97.74% -> 97.46%             
client [25] (test)  loss: 0.1637 -> 0.1654   acc: 95.30% -> 95.03%             
client [69] (test)  loss: 0.1952 -> 0.1980   acc: 94.17% -> 94.17%             
client [46] (test)  loss: 0.2186 -> 0.2136   acc: 94.28% -> 94.28%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1193 -> 0.1196   acc: 96.67% -> 95.72%             
client [69] (test)  loss: 0.1939 -> 0.1950   acc: 94.46% -> 94.46%             
client [82] (test)  loss: 0.1770 -> 0.1739   acc: 95.10% -> 95.51%             
client [45] (test)  loss: 0.1081 -> 0.1046   acc: 96.37% -> 96.89%             
client [7] (test)  loss: 0.1500 -> 0.1340   acc: 95.05% -> 95.31%              
client [50] (test)  loss: 0.0385 -> 0.0378   acc: 99.18% -> 99.18%             
client [35] (test)  loss: 0.1363 -> 0.1362   acc: 95.36% -> 95.36%             
client [24] (test)  loss: 0.1977 -> 0.2086   acc: 94.55% -> 94.16%             
client [15] (test)  loss: 0.1566 -> 0.1489   acc: 95.56% -> 95.36%             
client [58] (test)  loss: 0.0839 -> 0.0810   acc: 97.23% -> 97.23%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1748 -> 0.1708   acc: 94.93% -> 94.59%             
client [76] (test)  loss: 0.2013 -> 0.2007   acc: 96.26% -> 96.26%             
client [67] (test)  loss: 0.2179 -> 0.2162   acc: 94.98% -> 94.59%             
client [37] (test)  loss: 0.0773 -> 0.0766   acc: 97.27% -> 97.54%             
client [58] (test)  loss: 0.0806 -> 0.0776   acc: 97.23% -> 97.51%             
client [64] (test)  loss: 0.0342 -> 0.0302   acc: 99.48% -> 99.48%             
client [77] (test)  loss: 0.1363 -> 0.1348   acc: 94.85% -> 94.85%             
client [55] (test)  loss: 0.1414 -> 0.1414   acc: 95.29% -> 94.51%             
client [12] (test)  loss: 0.1380 -> 0.1402   acc: 96.22% -> 95.47%             
client [89] (test)  loss: 0.1485 -> 0.1492   acc: 96.06% -> 96.06%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1776 -> 0.1849   acc: 94.07% -> 93.81%             
client [51] (test)  loss: 0.1890 -> 0.1797   acc: 93.78% -> 93.97%             
client [8] (test)  loss: 0.2377 -> 0.2169   acc: 93.88% -> 94.13%              
client [18] (test)  loss: 0.1851 -> 0.1965   acc: 93.43% -> 94.16%             
client [94] (test)  loss: 0.0768 -> 0.0732   acc: 97.08% -> 97.08%             
client [81] (test)  loss: 0.1981 -> 0.1920   acc: 94.21% -> 94.63%             
client [3] (test)  loss: 0.1272 -> 0.1242   acc: 96.51% -> 96.51%              
client [11] (test)  loss: 0.0857 -> 0.0835   acc: 96.90% -> 96.90%             
client [95] (test)  loss: 0.0620 -> 0.0653   acc: 98.71% -> 98.71%             
client [67] (test)  loss: 0.2141 -> 0.2099   acc: 94.98% -> 95.37%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2217 -> 0.2218   acc: 95.06% -> 94.30%             
client [79] (test)  loss: 0.0911 -> 0.0945   acc: 96.18% -> 96.18%             
client [58] (test)  loss: 0.0730 -> 0.0704   acc: 97.51% -> 97.51%             
client [88] (test)  loss: 0.0710 -> 0.0699   acc: 97.87% -> 97.65%             
client [46] (test)  loss: 0.1878 -> 0.1893   acc: 94.61% -> 93.94%             
client [11] (test)  loss: 0.0795 -> 0.0804   acc: 97.18% -> 96.90%             
client [55] (test)  loss: 0.1298 -> 0.1275   acc: 95.29% -> 94.90%             
client [13] (test)  loss: 0.2005 -> 0.1992   acc: 94.27% -> 94.66%             
client [31] (test)  loss: 0.2275 -> 0.2113   acc: 93.51% -> 93.51%             
client [75] (test)  loss: 0.0722 -> 0.0765   acc: 97.73% -> 97.45%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.0974 -> 0.1023   acc: 97.07% -> 96.81%             
client [7] (test)  loss: 0.1094 -> 0.1043   acc: 95.57% -> 96.09%              
client [57] (test)  loss: 0.1297 -> 0.1417   acc: 96.06% -> 95.80%             
client [13] (test)  loss: 0.1984 -> 0.1967   acc: 94.27% -> 94.27%             
client [43] (test)  loss: 0.2054 -> 0.2075   acc: 94.30% -> 94.68%             
client [91] (test)  loss: 0.1111 -> 0.1120   acc: 96.90% -> 96.90%             
client [10] (test)  loss: 0.0923 -> 0.0923   acc: 97.34% -> 97.34%             
client [64] (test)  loss: 0.0293 -> 0.0259   acc: 99.48% -> 99.48%             
client [82] (test)  loss: 0.1543 -> 0.1554   acc: 96.33% -> 95.92%             
client [22] (test)  loss: 0.0791 -> 0.0790   acc: 98.02% -> 98.02%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1054 -> 0.0952   acc: 96.82% -> 97.45%             
client [23] (test)  loss: 0.1301 -> 0.1319   acc: 96.36% -> 96.08%             
client [88] (test)  loss: 0.0718 -> 0.0674   acc: 98.08% -> 98.08%             
client [98] (test)  loss: 0.1981 -> 0.1957   acc: 94.01% -> 94.38%             
client [79] (test)  loss: 0.0893 -> 0.0916   acc: 96.35% -> 96.35%             
client [21] (test)  loss: 0.2148 -> 0.2140   acc: 94.30% -> 94.30%             
client [92] (test)  loss: 0.1068 -> 0.1036   acc: 97.32% -> 97.59%             
client [56] (test)  loss: 0.1363 -> 0.1388   acc: 97.75% -> 97.18%             
client [5] (test)  loss: 0.1967 -> 0.2001   acc: 92.89% -> 93.65%              
client [52] (test)  loss: 0.1755 -> 0.1797   acc: 93.24% -> 93.59%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '0.1937 -> 0.0000', 'accuracy': '94.46% -> 0.00%'},          
    200: {'loss': '0.1262 -> 0.0000', 'accuracy': '96.23% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(12.68%) at epoch: 0                                    
FedRep_1 achieved 20.0%(20.66%) at epoch: 1                                    
FedRep_1 achieved 40.0%(41.93%) at epoch: 7                                    
FedRep_1 achieved 50.0%(57.81%) at epoch: 16                                   
FedRep_1 achieved 60.0%(60.42%) at epoch: 18                                   
FedRep_1 achieved 70.0%(75.98%) at epoch: 28                                   
FedRep_1 achieved 80.0%(81.22%) at epoch: 30                                   
FedRep_1 achieved 90.0%(91.26%) at epoch: 56                                   
Convergence (test_after):                                                      
FedRep_1 achieved 30.0%(32.32%) at epoch: 0                                    
FedRep_1 achieved 40.0%(43.75%) at epoch: 3                                    
FedRep_1 achieved 50.0%(50.47%) at epoch: 7                                    
FedRep_1 achieved 60.0%(63.87%) at epoch: 12                                   
FedRep_1 achieved 70.0%(70.90%) at epoch: 17                                   
FedRep_1 achieved 80.0%(80.63%) at epoch: 27                                   
FedRep_1 achieved 90.0%(90.90%) at epoch: 44                                   
