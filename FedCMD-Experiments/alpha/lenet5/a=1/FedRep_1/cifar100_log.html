==================== ALGORITHM: FedRep_1 ====================                  
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5911 -> 4.5769   acc: 1.32% -> 1.97%               
client [81] (test)  loss: 4.5869 -> 4.5715   acc: 3.99% -> 4.65%               
client [21] (test)  loss: 33.6306 -> 4.6175   acc: 0.33% -> 1.66%              
client [68] (test)  loss: 4.6099 -> 4.5896   acc: 1.66% -> 1.32%               
client [93] (test)  loss: 4.5999 -> 4.5809   acc: 1.62% -> 1.95%               
client [31] (test)  loss: 4.5945 -> 4.5800   acc: 1.05% -> 3.14%               
client [20] (test)  loss: 4.5915 -> 4.5762   acc: 1.39% -> 2.08%               
client [59] (test)  loss: 30.0501 -> 4.5625   acc: 1.82% -> 4.86%              
client [48] (test)  loss: 4.5716 -> 4.5560   acc: 2.31% -> 2.31%               
client [34] (test)  loss: 4.5866 -> 4.5561   acc: 0.30% -> 1.20%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.5580 -> 4.5126   acc: 0.00% -> 0.66%               
client [99] (test)  loss: 4.5950 -> 4.5588   acc: 0.95% -> 1.89%               
client [67] (test)  loss: 4.5477 -> 4.5076   acc: 5.32% -> 5.32%               
client [0] (test)  loss: 4.5202 -> 4.4733   acc: 5.98% -> 5.98%                
client [76] (test)  loss: 4.5718 -> 4.5366   acc: 1.08% -> 6.09%               
client [41] (test)  loss: 4.5786 -> 4.5388   acc: 0.33% -> 0.98%               
client [62] (test)  loss: 37.3806 -> 4.5608   acc: 0.72% -> 1.09%              
client [2] (test)  loss: 37.6204 -> 4.5751   acc: 0.65% -> 3.88%               
client [14] (test)  loss: 4.5737 -> 4.5559   acc: 1.41% -> 2.12%               
client [46] (test)  loss: 4.5376 -> 4.4851   acc: 3.25% -> 3.90%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.5086 -> 4.4690   acc: 3.38% -> 3.04%               
client [68] (test)  loss: 4.5161 -> 4.4405   acc: 1.32% -> 1.66%               
client [57] (test)  loss: 4.4154 -> 4.3592   acc: 7.19% -> 7.19%               
client [17] (test)  loss: 4.5960 -> 4.5293   acc: 1.29% -> 1.29%               
client [54] (test)  loss: 4.2386 -> 4.1819   acc: 15.00% -> 15.00%             
client [23] (test)  loss: 62.9806 -> 4.4552   acc: 0.00% -> 2.67%              
client [35] (test)  loss: 4.5315 -> 4.4718   acc: 0.33% -> 5.25%               
client [59] (test)  loss: 4.3677 -> 4.2804   acc: 4.56% -> 5.78%               
client [31] (test)  loss: 4.4416 -> 4.4224   acc: 5.23% -> 5.23%               
client [9] (test)  loss: 4.4825 -> 4.4416   acc: 3.64% -> 2.98%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.5047 -> 4.4430   acc: 1.65% -> 4.62%               
client [33] (test)  loss: 4.4112 -> 4.3880   acc: 4.23% -> 5.86%               
client [16] (test)  loss: 4.4358 -> 4.4064   acc: 4.88% -> 4.88%               
client [44] (test)  loss: 4.6279 -> 4.4020   acc: 0.33% -> 3.93%               
client [8] (test)  loss: 4.4756 -> 4.4465   acc: 1.35% -> 2.70%                
client [31] (test)  loss: 4.4226 -> 4.3785   acc: 5.23% -> 5.23%               
client [47] (test)  loss: 4.4886 -> 4.3854   acc: 3.61% -> 6.23%               
client [36] (test)  loss: 4.4292 -> 4.2706   acc: 4.32% -> 8.31%               
client [20] (test)  loss: 4.3778 -> 4.3232   acc: 6.25% -> 6.60%               
client [56] (test)  loss: 4.5404 -> 4.5261   acc: 4.81% -> 1.72%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.2374 -> 4.2671   acc: 2.30% -> 2.30%                
client [60] (test)  loss: 4.4683 -> 4.3796   acc: 3.25% -> 6.17%               
client [28] (test)  loss: 4.4574 -> 4.3098   acc: 1.99% -> 2.65%               
client [25] (test)  loss: 4.4256 -> 4.2841   acc: 2.41% -> 7.59%               
client [58] (test)  loss: 4.3835 -> 4.3807   acc: 5.08% -> 7.42%               
client [44] (test)  loss: 4.4059 -> 4.3243   acc: 3.93% -> 8.52%               
client [39] (test)  loss: 4.3811 -> 4.3286   acc: 6.33% -> 7.33%               
client [29] (test)  loss: 4.3567 -> 4.2042   acc: 4.64% -> 7.28%               
client [3] (test)  loss: 4.3109 -> 4.1943   acc: 6.21% -> 6.21%                
client [84] (test)  loss: 4.3644 -> 4.3486   acc: 5.88% -> 3.92%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.5474 -> 4.3702   acc: 1.99% -> 4.98%               
client [84] (test)  loss: 4.2939 -> 4.3263   acc: 5.23% -> 3.59%               
client [10] (test)  loss: 4.4176 -> 4.4025   acc: 5.61% -> 7.59%               
client [36] (test)  loss: 4.1536 -> 4.1378   acc: 9.97% -> 9.97%               
client [65] (test)  loss: 4.3771 -> 4.3821   acc: 4.95% -> 5.61%               
client [81] (test)  loss: 4.3026 -> 4.2330   acc: 5.32% -> 6.31%               
client [79] (test)  loss: 4.2710 -> 4.3193   acc: 5.90% -> 5.90%               
client [42] (test)  loss: 4.1340 -> 4.1591   acc: 6.62% -> 6.29%               
client [11] (test)  loss: 4.4574 -> 4.4000   acc: 3.02% -> 2.68%               
client [96] (test)  loss: 4.3143 -> 4.2055   acc: 8.00% -> 8.00%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.4913 -> 4.4902   acc: 2.70% -> 3.04%                
client [53] (test)  loss: 4.2390 -> 4.1927   acc: 7.49% -> 8.47%               
client [52] (test)  loss: 4.2312 -> 4.2421   acc: 7.79% -> 7.79%               
client [42] (test)  loss: 4.1079 -> 4.1481   acc: 6.62% -> 6.29%               
client [69] (test)  loss: 4.0824 -> 4.0912   acc: 7.92% -> 6.60%               
client [59] (test)  loss: 4.0698 -> 4.0683   acc: 12.46% -> 11.85%             
client [7] (test)  loss: 4.4454 -> 4.3833   acc: 2.61% -> 3.92%                
client [26] (test)  loss: 4.2401 -> 4.2374   acc: 4.30% -> 4.30%               
client [49] (test)  loss: 4.2763 -> 4.2711   acc: 7.54% -> 7.21%               
client [98] (test)  loss: 4.2768 -> 4.2504   acc: 7.12% -> 8.09%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.2592 -> 4.2250   acc: 7.77% -> 8.41%               
client [47] (test)  loss: 4.4484 -> 4.2911   acc: 7.54% -> 8.52%               
client [21] (test)  loss: 4.2929 -> 4.2545   acc: 5.32% -> 4.98%               
client [77] (test)  loss: 4.2965 -> 4.2846   acc: 3.95% -> 7.24%               
client [95] (test)  loss: 4.3137 -> 4.3390   acc: 8.78% -> 8.45%               
client [91] (test)  loss: 3.9038 -> 3.8286   acc: 11.51% -> 11.51%             
client [14] (test)  loss: 4.3481 -> 4.3403   acc: 6.36% -> 7.42%               
client [99] (test)  loss: 4.1571 -> 4.3340   acc: 9.46% -> 5.99%               
client [20] (test)  loss: 4.2017 -> 4.1415   acc: 5.56% -> 6.60%               
client [39] (test)  loss: 4.2168 -> 4.1366   acc: 7.67% -> 8.00%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.2339 -> 4.1979   acc: 8.12% -> 7.14%               
client [62] (test)  loss: 4.1942 -> 4.2525   acc: 9.42% -> 11.23%              
client [71] (test)  loss: 4.0727 -> 4.0916   acc: 6.60% -> 6.60%               
client [97] (test)  loss: 4.1368 -> 4.1826   acc: 10.60% -> 7.95%              
client [30] (test)  loss: 4.0225 -> 4.0293   acc: 4.62% -> 2.64%               
client [88] (test)  loss: 4.2885 -> 4.2772   acc: 8.31% -> 5.65%               
client [60] (test)  loss: 4.3269 -> 4.3151   acc: 8.44% -> 7.79%               
client [82] (test)  loss: 4.2644 -> 4.2596   acc: 2.65% -> 2.98%               
client [91] (test)  loss: 3.8477 -> 3.7879   acc: 14.47% -> 12.50%             
client [57] (test)  loss: 4.1868 -> 4.1391   acc: 10.46% -> 10.46%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.1327 -> 4.3937   acc: 7.32% -> 5.57%               
client [15] (test)  loss: 4.1195 -> 4.1716   acc: 8.22% -> 7.57%               
client [71] (test)  loss: 4.0464 -> 4.1026   acc: 8.25% -> 7.26%               
client [97] (test)  loss: 4.0717 -> 4.1015   acc: 10.26% -> 8.61%              
client [53] (test)  loss: 4.1648 -> 4.1586   acc: 9.77% -> 10.75%              
client [77] (test)  loss: 4.2365 -> 4.2719   acc: 4.93% -> 6.91%               
client [76] (test)  loss: 4.2496 -> 4.2479   acc: 7.17% -> 7.53%               
client [79] (test)  loss: 4.2496 -> 4.4886   acc: 8.20% -> 8.20%               
client [28] (test)  loss: 4.0659 -> 4.0492   acc: 6.29% -> 6.62%               
client [99] (test)  loss: 4.1566 -> 4.3963   acc: 9.15% -> 6.62%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.1174 -> 4.2210   acc: 9.60% -> 7.62%               
client [86] (test)  loss: 4.2889 -> 4.3630   acc: 5.35% -> 5.02%               
client [34] (test)  loss: 4.2074 -> 4.2510   acc: 11.11% -> 11.41%             
client [73] (test)  loss: 4.0514 -> 3.9871   acc: 9.51% -> 11.15%              
client [5] (test)  loss: 4.1811 -> 4.3104   acc: 4.93% -> 6.25%                
client [96] (test)  loss: 4.2777 -> 4.6179   acc: 5.82% -> 1.82%               
client [22] (test)  loss: 4.0961 -> 4.2948   acc: 8.79% -> 8.79%               
client [60] (test)  loss: 4.3088 -> 4.3830   acc: 7.47% -> 5.19%               
client [66] (test)  loss: 4.1631 -> 4.2325   acc: 8.39% -> 8.71%               
client [83] (test)  loss: 4.1972 -> 4.0763   acc: 10.89% -> 11.88%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.3223 -> 4.2654   acc: 7.89% -> 8.24%               
client [65] (test)  loss: 4.3388 -> 4.2256   acc: 5.61% -> 6.27%               
client [95] (test)  loss: 4.5838 -> 4.3411   acc: 9.12% -> 9.12%               
client [17] (test)  loss: 4.6374 -> 4.3897   acc: 6.45% -> 6.77%               
client [8] (test)  loss: 4.6793 -> 4.3915   acc: 4.73% -> 6.08%                
client [35] (test)  loss: 4.2825 -> 4.2439   acc: 7.87% -> 7.87%               
client [98] (test)  loss: 4.1577 -> 4.1581   acc: 11.33% -> 10.68%             
client [53] (test)  loss: 4.1269 -> 4.1600   acc: 11.07% -> 12.70%             
client [43] (test)  loss: 4.1924 -> 4.2451   acc: 9.24% -> 6.27%               
client [64] (test)  loss: 4.2116 -> 4.2320   acc: 6.60% -> 7.59%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.3864 -> 4.2290   acc: 4.98% -> 4.98%               
client [88] (test)  loss: 4.3122 -> 4.5148   acc: 8.97% -> 6.64%               
client [38] (test)  loss: 4.3303 -> 4.4241   acc: 9.21% -> 10.53%              
client [3] (test)  loss: 4.1353 -> 3.9798   acc: 10.78% -> 9.80%               
client [5] (test)  loss: 4.2293 -> 4.2064   acc: 6.91% -> 6.58%                
client [41] (test)  loss: 4.0776 -> 4.1847   acc: 10.42% -> 7.82%              
client [7] (test)  loss: 4.3625 -> 4.2691   acc: 7.19% -> 7.52%                
client [37] (test)  loss: 4.4430 -> 4.4306   acc: 5.96% -> 5.63%               
client [45] (test)  loss: 4.3834 -> 4.0339   acc: 8.61% -> 12.25%              
client [47] (test)  loss: 4.4948 -> 4.2250   acc: 10.49% -> 9.51%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.3887 -> 4.3868   acc: 5.57% -> 5.57%               
client [11] (test)  loss: 4.3431 -> 4.3641   acc: 5.37% -> 6.04%               
client [37] (test)  loss: 4.3863 -> 4.4602   acc: 5.96% -> 8.28%               
client [41] (test)  loss: 4.0719 -> 4.2022   acc: 10.10% -> 7.82%              
client [95] (test)  loss: 4.5398 -> 4.3846   acc: 8.78% -> 10.47%              
client [53] (test)  loss: 4.1600 -> 4.2132   acc: 9.45% -> 12.05%              
client [22] (test)  loss: 4.0549 -> 4.1311   acc: 10.10% -> 11.07%             
client [25] (test)  loss: 4.0902 -> 4.4612   acc: 9.31% -> 8.62%               
client [69] (test)  loss: 3.9717 -> 4.0785   acc: 12.21% -> 11.55%             
client [46] (test)  loss: 4.0095 -> 3.9747   acc: 11.36% -> 12.01%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.0569 -> 4.0303   acc: 10.16% -> 11.15%             
client [69] (test)  loss: 3.9530 -> 4.0955   acc: 10.89% -> 12.21%             
client [82] (test)  loss: 4.2820 -> 4.4016   acc: 6.29% -> 6.29%               
client [45] (test)  loss: 3.9919 -> 4.0011   acc: 11.26% -> 11.92%             
client [7] (test)  loss: 4.2981 -> 4.2789   acc: 7.84% -> 7.84%                
client [50] (test)  loss: 4.0255 -> 4.0785   acc: 10.11% -> 8.24%              
client [35] (test)  loss: 4.2822 -> 4.2610   acc: 8.20% -> 9.51%               
client [24] (test)  loss: 4.3460 -> 4.4643   acc: 5.74% -> 5.41%               
client [15] (test)  loss: 4.0971 -> 4.2444   acc: 7.57% -> 7.24%               
client [58] (test)  loss: 4.2711 -> 4.5537   acc: 12.50% -> 12.50%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.4379 -> 4.5863   acc: 8.58% -> 6.60%               
client [76] (test)  loss: 4.3855 -> 4.3289   acc: 7.89% -> 11.11%              
client [67] (test)  loss: 4.0306 -> 4.0973   acc: 10.63% -> 11.30%             
client [37] (test)  loss: 4.6489 -> 4.4205   acc: 9.27% -> 8.94%               
client [58] (test)  loss: 4.3360 -> 4.6778   acc: 14.84% -> 12.50%             
client [64] (test)  loss: 4.2781 -> 4.5842   acc: 6.27% -> 4.62%               
client [77] (test)  loss: 4.3696 -> 4.3247   acc: 7.57% -> 5.59%               
client [55] (test)  loss: 4.2136 -> 4.1838   acc: 13.11% -> 12.46%             
client [12] (test)  loss: 4.4167 -> 4.3895   acc: 6.27% -> 7.92%               
client [89] (test)  loss: 4.4496 -> 4.4209   acc: 9.03% -> 10.32%              
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.2361 -> 5.0331   acc: 7.19% -> 3.92%               
client [51] (test)  loss: 4.5032 -> 4.4527   acc: 11.92% -> 10.93%             
client [8] (test)  loss: 4.5609 -> 4.3794   acc: 6.76% -> 8.78%                
client [18] (test)  loss: 3.7820 -> 4.3166   acc: 15.03% -> 12.75%             
client [94] (test)  loss: 4.2589 -> 4.3087   acc: 5.44% -> 8.16%               
client [81] (test)  loss: 4.1192 -> 4.1840   acc: 9.30% -> 7.31%               
client [3] (test)  loss: 4.1023 -> 4.1482   acc: 10.78% -> 10.46%              
client [11] (test)  loss: 4.4115 -> 4.4242   acc: 7.05% -> 6.04%               
client [95] (test)  loss: 4.7674 -> 4.4753   acc: 8.78% -> 9.12%               
client [67] (test)  loss: 4.0628 -> 4.1555   acc: 11.30% -> 11.30%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.4404 -> 4.2658   acc: 7.31% -> 6.64%               
client [79] (test)  loss: 4.2337 -> 4.2455   acc: 14.10% -> 9.18%              
client [58] (test)  loss: 4.3763 -> 4.7840   acc: 15.23% -> 12.50%             
client [88] (test)  loss: 4.5377 -> 4.8194   acc: 10.96% -> 5.98%              
client [46] (test)  loss: 4.1500 -> 3.9593   acc: 12.01% -> 12.66%             
client [11] (test)  loss: 4.4874 -> 4.5402   acc: 5.37% -> 6.38%               
client [55] (test)  loss: 4.1916 -> 4.1750   acc: 13.44% -> 16.07%             
client [13] (test)  loss: 4.4732 -> 4.5531   acc: 11.69% -> 8.77%              
client [31] (test)  loss: 4.2229 -> 4.1136   acc: 11.15% -> 10.45%             
client [75] (test)  loss: 4.2367 -> 4.3366   acc: 10.53% -> 12.17%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.4577 -> 4.3471   acc: 16.00% -> 18.67%             
client [7] (test)  loss: 4.3134 -> 4.3092   acc: 12.09% -> 11.11%              
client [57] (test)  loss: 4.1013 -> 4.4804   acc: 8.50% -> 6.54%               
client [13] (test)  loss: 4.5310 -> 4.6322   acc: 10.71% -> 7.14%              
client [43] (test)  loss: 4.2301 -> 4.2635   acc: 11.88% -> 11.22%             
client [91] (test)  loss: 4.1155 -> 3.7382   acc: 14.80% -> 16.45%             
client [10] (test)  loss: 4.4372 -> 4.4467   acc: 9.24% -> 7.26%               
client [64] (test)  loss: 4.3000 -> 4.6775   acc: 5.94% -> 5.61%               
client [82] (test)  loss: 4.4178 -> 4.3474   acc: 8.28% -> 8.28%               
client [22] (test)  loss: 4.1379 -> 4.3225   acc: 11.40% -> 12.05%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.0860 -> 4.1137   acc: 7.99% -> 9.03%               
client [23] (test)  loss: 4.1024 -> 4.0909   acc: 9.67% -> 9.67%               
client [88] (test)  loss: 4.6793 -> 4.9677   acc: 10.96% -> 5.32%              
client [98] (test)  loss: 4.1920 -> 4.4316   acc: 12.62% -> 13.27%             
client [79] (test)  loss: 4.2258 -> 4.2950   acc: 13.44% -> 9.84%              
client [21] (test)  loss: 4.3315 -> 4.2923   acc: 7.64% -> 7.97%               
client [92] (test)  loss: 4.1589 -> 4.1233   acc: 12.19% -> 14.06%             
client [56] (test)  loss: 4.9530 -> 4.5441   acc: 5.50% -> 4.12%               
client [5] (test)  loss: 4.2780 -> 4.3805   acc: 11.84% -> 9.87%               
client [52] (test)  loss: 4.3275 -> 4.2641   acc: 11.36% -> 12.66%             
==================== FedRep_1 TEST RESULTS: ====================               
{                                                                              
    100: {'loss': '4.1997 -> 0.0000', 'accuracy': '8.06% -> 0.00%'},           
    200: {'loss': '4.3293 -> 0.0000', 'accuracy': '10.77% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_1 achieved 10.0%(10.32%) at epoch: 147                                  
Convergence (test_after):                                                      
FedRep_1 achieved 10.0%(10.42%) at epoch: 147                                  
