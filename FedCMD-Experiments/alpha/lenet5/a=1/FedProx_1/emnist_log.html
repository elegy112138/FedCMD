==================== ALGORITHM: FedProx_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'mu': 1.0,                                                                 
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.1899 -> 0.9464   acc: 65.04% -> 74.32%             
client [81] (test)  loss: 1.6303 -> 1.2286   acc: 64.08% -> 67.17%             
client [21] (test)  loss: 50.9773 -> 1.1418   acc: 49.58% -> 68.91%            
client [68] (test)  loss: 1.5948 -> 1.0233   acc: 60.42% -> 71.52%             
client [93] (test)  loss: 1.7581 -> 1.4037   acc: 56.10% -> 61.28%             
client [31] (test)  loss: 1.8957 -> 1.1471   acc: 49.35% -> 66.72%             
client [20] (test)  loss: 1.3467 -> 0.9866   acc: 65.73% -> 72.05%             
client [59] (test)  loss: 41.3501 -> 0.9015   acc: 57.16% -> 75.81%            
client [48] (test)  loss: 1.5493 -> 1.2945   acc: 61.52% -> 62.94%             
client [34] (test)  loss: 1.8164 -> 1.1929   acc: 51.06% -> 68.95%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6530 -> 0.6515   acc: 79.85% -> 79.59%             
client [99] (test)  loss: 1.6901 -> 0.8314   acc: 54.62% -> 74.47%             
client [67] (test)  loss: 0.9245 -> 0.4240   acc: 71.15% -> 87.19%             
client [0] (test)  loss: 1.0813 -> 0.9598   acc: 69.63% -> 68.62%              
client [76] (test)  loss: 1.1768 -> 0.8715   acc: 68.04% -> 72.44%             
client [41] (test)  loss: 1.5293 -> 0.8684   acc: 58.36% -> 68.77%             
client [62] (test)  loss: 56.4523 -> 0.7313   acc: 60.79% -> 77.81%            
client [2] (test)  loss: 63.5453 -> 0.8749   acc: 57.39% -> 74.36%             
client [14] (test)  loss: 1.1619 -> 0.9185   acc: 65.62% -> 71.19%             
client [46] (test)  loss: 1.7172 -> 0.7885   acc: 52.35% -> 78.35%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6591 -> 0.6572   acc: 77.18% -> 76.65%             
client [68] (test)  loss: 0.9395 -> 0.5447   acc: 71.89% -> 83.22%             
client [57] (test)  loss: 1.0726 -> 0.4513   acc: 68.45% -> 85.53%             
client [17] (test)  loss: 2.7868 -> 0.5845   acc: 38.12% -> 81.46%             
client [54] (test)  loss: 0.7412 -> 0.4424   acc: 78.13% -> 85.65%             
client [23] (test)  loss: 77.5118 -> 0.7870   acc: 53.55% -> 75.79%            
client [35] (test)  loss: 1.0355 -> 0.8465   acc: 68.04% -> 74.42%             
client [59] (test)  loss: 0.6887 -> 0.5490   acc: 79.27% -> 83.64%             
client [31] (test)  loss: 0.7411 -> 0.6765   acc: 76.92% -> 78.36%             
client [9] (test)  loss: 1.0646 -> 0.7732   acc: 69.17% -> 74.58%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8840 -> 0.9567   acc: 71.52% -> 71.34%             
client [33] (test)  loss: 0.9632 -> 0.6808   acc: 69.88% -> 78.26%             
client [16] (test)  loss: 1.0288 -> 0.8732   acc: 65.69% -> 73.09%             
client [44] (test)  loss: 3.1910 -> 0.7507   acc: 38.07% -> 71.98%             
client [8] (test)  loss: 0.6094 -> 0.5460   acc: 82.01% -> 82.01%              
client [31] (test)  loss: 0.7351 -> 0.6089   acc: 76.53% -> 80.15%             
client [47] (test)  loss: 0.6182 -> 0.2993   acc: 81.40% -> 89.26%             
client [36] (test)  loss: 0.5490 -> 0.5789   acc: 81.59% -> 85.12%             
client [20] (test)  loss: 0.7054 -> 0.5094   acc: 78.64% -> 84.08%             
client [56] (test)  loss: 0.6706 -> 0.4850   acc: 77.91% -> 83.56%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7319 -> 0.4877   acc: 76.33% -> 83.78%              
client [60] (test)  loss: 0.8752 -> 0.3548   acc: 74.11% -> 87.53%             
client [28] (test)  loss: 0.6373 -> 0.3803   acc: 80.48% -> 88.91%             
client [25] (test)  loss: 0.7874 -> 0.3265   acc: 74.32% -> 89.99%             
client [58] (test)  loss: 0.5626 -> 0.4439   acc: 83.61% -> 86.41%             
client [44] (test)  loss: 0.8751 -> 0.7057   acc: 71.62% -> 73.17%             
client [39] (test)  loss: 0.7919 -> 0.5862   acc: 72.43% -> 80.48%             
client [29] (test)  loss: 1.0086 -> 1.2791   acc: 69.46% -> 68.38%             
client [3] (test)  loss: 0.4644 -> 0.3772   acc: 84.35% -> 87.14%              
client [84] (test)  loss: 0.8306 -> 0.6508   acc: 74.74% -> 80.77%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9377 -> 0.6152   acc: 72.05% -> 78.91%             
client [84] (test)  loss: 1.0158 -> 0.6246   acc: 69.55% -> 81.40%             
client [10] (test)  loss: 1.1373 -> 0.5280   acc: 65.86% -> 83.77%             
client [36] (test)  loss: 0.4250 -> 0.4865   acc: 84.44% -> 87.10%             
client [65] (test)  loss: 0.4014 -> 0.3163   acc: 87.60% -> 90.48%             
client [81] (test)  loss: 0.8833 -> 0.5519   acc: 75.94% -> 83.06%             
client [79] (test)  loss: 0.2923 -> 0.2845   acc: 91.16% -> 90.38%             
client [42] (test)  loss: 0.8578 -> 0.5428   acc: 71.09% -> 84.33%             
client [11] (test)  loss: 0.6341 -> 0.4318   acc: 81.65% -> 86.98%             
client [96] (test)  loss: 0.7135 -> 0.3712   acc: 77.65% -> 87.60%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4877 -> 0.4760   acc: 85.00% -> 83.82%              
client [53] (test)  loss: 0.3448 -> 0.2328   acc: 90.90% -> 92.47%             
client [52] (test)  loss: 0.9341 -> 0.5432   acc: 67.36% -> 82.36%             
client [42] (test)  loss: 0.6472 -> 0.5065   acc: 75.74% -> 85.53%             
client [69] (test)  loss: 0.3740 -> 0.2382   acc: 88.48% -> 92.59%             
client [59] (test)  loss: 0.4236 -> 0.3492   acc: 87.56% -> 89.06%             
client [7] (test)  loss: 0.9113 -> 0.6428   acc: 67.40% -> 77.27%              
client [26] (test)  loss: 0.4132 -> 0.3286   acc: 87.72% -> 89.47%             
client [49] (test)  loss: 0.5275 -> 0.4416   acc: 83.33% -> 85.40%             
client [98] (test)  loss: 0.5745 -> 0.5139   acc: 82.09% -> 81.59%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6129 -> 0.4903   acc: 80.41% -> 82.73%             
client [47] (test)  loss: 0.3813 -> 0.2548   acc: 86.77% -> 90.38%             
client [21] (test)  loss: 0.6636 -> 0.5765   acc: 78.57% -> 80.01%             
client [77] (test)  loss: 0.3290 -> 0.3691   acc: 88.88% -> 88.66%             
client [95] (test)  loss: 0.4997 -> 0.4297   acc: 85.56% -> 86.57%             
client [91] (test)  loss: 1.1541 -> 0.6902   acc: 64.96% -> 77.07%             
client [14] (test)  loss: 0.6214 -> 0.5462   acc: 80.37% -> 81.57%             
client [99] (test)  loss: 0.6841 -> 0.5500   acc: 78.07% -> 82.35%             
client [20] (test)  loss: 0.5369 -> 0.4074   acc: 82.83% -> 86.35%             
client [39] (test)  loss: 0.8292 -> 0.5044   acc: 73.23% -> 82.71%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8458 -> 0.5121   acc: 70.05% -> 83.08%             
client [62] (test)  loss: 0.6059 -> 0.4300   acc: 80.60% -> 86.28%             
client [71] (test)  loss: 0.6974 -> 0.6434   acc: 77.16% -> 77.80%             
client [97] (test)  loss: 0.3804 -> 0.3243   acc: 89.27% -> 89.80%             
client [30] (test)  loss: 0.4002 -> 0.2955   acc: 87.39% -> 90.50%             
client [88] (test)  loss: 0.4535 -> 0.3785   acc: 86.45% -> 87.67%             
client [60] (test)  loss: 0.3977 -> 0.2969   acc: 88.37% -> 89.39%             
client [82] (test)  loss: 0.5094 -> 0.4035   acc: 82.90% -> 85.67%             
client [91] (test)  loss: 0.9700 -> 0.6633   acc: 65.78% -> 77.99%             
client [57] (test)  loss: 0.3936 -> 0.2903   acc: 87.44% -> 90.36%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5722 -> 0.4723   acc: 80.29% -> 83.98%             
client [15] (test)  loss: 0.5382 -> 0.4868   acc: 81.01% -> 79.45%             
client [71] (test)  loss: 0.7131 -> 0.6222   acc: 74.98% -> 78.92%             
client [97] (test)  loss: 0.3692 -> 0.3068   acc: 87.96% -> 90.18%             
client [53] (test)  loss: 0.4482 -> 0.2163   acc: 84.49% -> 93.06%             
client [77] (test)  loss: 0.3803 -> 0.3478   acc: 87.50% -> 89.15%             
client [76] (test)  loss: 0.6658 -> 0.4856   acc: 76.60% -> 83.60%             
client [79] (test)  loss: 0.3918 -> 0.2310   acc: 87.92% -> 92.46%             
client [28] (test)  loss: 0.5020 -> 0.3013   acc: 82.66% -> 91.14%             
client [99] (test)  loss: 0.6393 -> 0.5250   acc: 77.82% -> 82.69%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3248 -> 0.2939   acc: 90.80% -> 90.56%             
client [86] (test)  loss: 0.3076 -> 0.2505   acc: 92.08% -> 92.35%             
client [34] (test)  loss: 0.7556 -> 0.5146   acc: 71.07% -> 82.45%             
client [73] (test)  loss: 0.7381 -> 0.5123   acc: 73.75% -> 82.05%             
client [5] (test)  loss: 0.7475 -> 0.4753   acc: 79.98% -> 84.44%              
client [96] (test)  loss: 0.4168 -> 0.3143   acc: 87.04% -> 89.61%             
client [22] (test)  loss: 0.9097 -> 0.4444   acc: 69.99% -> 86.58%             
client [60] (test)  loss: 0.4013 -> 0.2788   acc: 87.44% -> 89.96%             
client [66] (test)  loss: 0.4356 -> 0.3202   acc: 84.75% -> 87.77%             
client [83] (test)  loss: 0.4738 -> 0.5304   acc: 84.61% -> 81.74%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6030 -> 0.4619   acc: 82.00% -> 84.43%             
client [65] (test)  loss: 0.3361 -> 0.2510   acc: 89.74% -> 92.33%             
client [95] (test)  loss: 0.4819 -> 0.3932   acc: 85.34% -> 87.60%             
client [17] (test)  loss: 0.4757 -> 0.4025   acc: 86.39% -> 87.59%             
client [8] (test)  loss: 0.4321 -> 0.4304   acc: 86.42% -> 85.05%              
client [35] (test)  loss: 0.8261 -> 0.6034   acc: 72.44% -> 80.28%             
client [98] (test)  loss: 0.5459 -> 0.4656   acc: 82.84% -> 83.06%             
client [53] (test)  loss: 0.2933 -> 0.2067   acc: 92.60% -> 93.37%             
client [43] (test)  loss: 0.5421 -> 0.5023   acc: 82.77% -> 83.72%             
client [64] (test)  loss: 0.7406 -> 0.6356   acc: 74.67% -> 79.60%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5832 -> 0.5190   acc: 80.92% -> 81.98%             
client [88] (test)  loss: 0.4553 -> 0.3536   acc: 85.72% -> 88.10%             
client [38] (test)  loss: 0.5926 -> 0.4389   acc: 81.30% -> 83.98%             
client [3] (test)  loss: 0.4203 -> 0.3045   acc: 85.25% -> 88.65%              
client [5] (test)  loss: 0.6963 -> 0.4592   acc: 80.92% -> 85.01%              
client [41] (test)  loss: 0.7642 -> 0.5678   acc: 74.83% -> 76.84%             
client [7] (test)  loss: 0.6927 -> 0.5857   acc: 76.56% -> 78.55%              
client [37] (test)  loss: 0.8968 -> 0.8629   acc: 71.72% -> 73.07%             
client [45] (test)  loss: 0.4629 -> 0.4039   acc: 84.20% -> 86.16%             
client [47] (test)  loss: 0.3762 -> 0.2330   acc: 86.21% -> 91.41%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8311 -> 0.5750   acc: 69.38% -> 81.78%             
client [11] (test)  loss: 0.4638 -> 0.3538   acc: 85.22% -> 89.33%             
client [37] (test)  loss: 0.7464 -> 0.8069   acc: 72.23% -> 74.67%             
client [41] (test)  loss: 0.6406 -> 0.5582   acc: 76.11% -> 77.03%             
client [95] (test)  loss: 0.5103 -> 0.3768   acc: 84.92% -> 88.24%             
client [53] (test)  loss: 0.4288 -> 0.2112   acc: 86.67% -> 93.25%             
client [22] (test)  loss: 0.7504 -> 0.4247   acc: 73.10% -> 87.34%             
client [25] (test)  loss: 0.3763 -> 0.2054   acc: 88.05% -> 93.80%             
client [69] (test)  loss: 0.3854 -> 0.2015   acc: 87.67% -> 93.54%             
client [46] (test)  loss: 0.6624 -> 0.4693   acc: 73.15% -> 85.63%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3555 -> 0.2293   acc: 87.82% -> 91.28%             
client [69] (test)  loss: 0.3637 -> 0.1958   acc: 88.11% -> 93.74%             
client [82] (test)  loss: 0.4427 -> 0.3548   acc: 84.75% -> 87.49%             
client [45] (test)  loss: 0.4313 -> 0.3925   acc: 85.11% -> 86.06%             
client [7] (test)  loss: 0.5877 -> 0.5691   acc: 77.15% -> 78.55%              
client [50] (test)  loss: 0.3967 -> 0.3773   acc: 87.53% -> 87.72%             
client [35] (test)  loss: 0.7162 -> 0.5732   acc: 75.31% -> 80.82%             
client [24] (test)  loss: 0.5045 -> 0.4194   acc: 82.23% -> 84.33%             
client [15] (test)  loss: 0.5235 -> 0.4685   acc: 80.50% -> 80.30%             
client [58] (test)  loss: 0.4462 -> 0.2890   acc: 85.15% -> 90.92%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5977 -> 0.5993   acc: 80.50% -> 74.56%             
client [76] (test)  loss: 0.5949 -> 0.4434   acc: 80.98% -> 84.92%             
client [67] (test)  loss: 0.4427 -> 0.2295   acc: 86.85% -> 93.33%             
client [37] (test)  loss: 0.7426 -> 0.8115   acc: 72.78% -> 74.24%             
client [58] (test)  loss: 0.4251 -> 0.2853   acc: 86.88% -> 91.21%             
client [64] (test)  loss: 0.5443 -> 0.5319   acc: 79.03% -> 82.62%             
client [77] (test)  loss: 0.3850 -> 0.3141   acc: 87.26% -> 89.84%             
client [55] (test)  loss: 0.4289 -> 0.2933   acc: 85.90% -> 89.34%             
client [12] (test)  loss: 0.5523 -> 0.4582   acc: 80.90% -> 84.74%             
client [89] (test)  loss: 0.4846 -> 0.3455   acc: 84.89% -> 88.15%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6462 -> 0.5088   acc: 77.33% -> 83.44%             
client [51] (test)  loss: 0.7343 -> 0.5331   acc: 71.97% -> 80.86%             
client [8] (test)  loss: 0.4490 -> 0.4160   acc: 85.34% -> 85.48%              
client [18] (test)  loss: 0.5538 -> 0.6183   acc: 79.49% -> 81.05%             
client [94] (test)  loss: 0.3695 -> 0.1988   acc: 87.68% -> 93.27%             
client [81] (test)  loss: 0.5729 -> 0.4365   acc: 80.24% -> 87.00%             
client [3] (test)  loss: 0.3600 -> 0.2941   acc: 86.99% -> 88.92%              
client [11] (test)  loss: 0.4536 -> 0.3399   acc: 84.79% -> 89.93%             
client [95] (test)  loss: 0.5054 -> 0.3595   acc: 84.45% -> 88.43%             
client [67] (test)  loss: 0.4471 -> 0.2277   acc: 87.43% -> 93.33%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5587 -> 0.4838   acc: 80.28% -> 83.03%             
client [79] (test)  loss: 0.2771 -> 0.2039   acc: 92.71% -> 93.44%             
client [58] (test)  loss: 0.4591 -> 0.2805   acc: 85.24% -> 91.14%             
client [88] (test)  loss: 0.4233 -> 0.3287   acc: 86.97% -> 88.90%             
client [46] (test)  loss: 0.7320 -> 0.4455   acc: 68.38% -> 86.13%             
client [11] (test)  loss: 0.4195 -> 0.3380   acc: 86.86% -> 89.81%             
client [55] (test)  loss: 0.3923 -> 0.2856   acc: 86.26% -> 89.65%             
client [13] (test)  loss: 0.6533 -> 0.3728   acc: 73.38% -> 87.56%             
client [31] (test)  loss: 0.5305 -> 0.4325   acc: 82.52% -> 85.25%             
client [75] (test)  loss: 0.4828 -> 0.3825   acc: 82.98% -> 86.83%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5606 -> 0.3693   acc: 82.59% -> 87.85%             
client [7] (test)  loss: 0.6283 -> 0.5414   acc: 75.26% -> 78.96%              
client [57] (test)  loss: 0.3522 -> 0.2383   acc: 87.29% -> 91.71%             
client [13] (test)  loss: 0.6894 -> 0.3694   acc: 72.91% -> 87.63%             
client [43] (test)  loss: 0.4593 -> 0.4138   acc: 85.48% -> 86.14%             
client [91] (test)  loss: 0.9376 -> 0.5885   acc: 66.75% -> 80.58%             
client [10] (test)  loss: 0.6423 -> 0.3928   acc: 77.76% -> 87.15%             
client [64] (test)  loss: 0.6161 -> 0.4525   acc: 78.46% -> 84.71%             
client [82] (test)  loss: 0.4424 -> 0.3406   acc: 84.48% -> 87.52%             
client [22] (test)  loss: 0.8424 -> 0.4041   acc: 70.92% -> 87.68%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5070 -> 0.3363   acc: 84.25% -> 88.73%             
client [23] (test)  loss: 0.6946 -> 0.5169   acc: 77.89% -> 83.07%             
client [88] (test)  loss: 0.4329 -> 0.3261   acc: 86.54% -> 88.85%             
client [98] (test)  loss: 0.4886 -> 0.4192   acc: 84.55% -> 84.74%             
client [79] (test)  loss: 0.2566 -> 0.1959   acc: 93.08% -> 93.59%             
client [21] (test)  loss: 0.5621 -> 0.4795   acc: 80.46% -> 83.20%             
client [92] (test)  loss: 0.5542 -> 0.4133   acc: 82.58% -> 86.32%             
client [56] (test)  loss: 0.4671 -> 0.3223   acc: 83.66% -> 88.47%             
client [5] (test)  loss: 0.7085 -> 0.4345   acc: 79.55% -> 85.65%              
client [52] (test)  loss: 0.7541 -> 0.4503   acc: 71.71% -> 84.23%             
==================== FedProx_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.5601 -> 0.0000', 'accuracy': '80.83% -> 0.00%'},          
    200: {'loss': '0.5199 -> 0.0000', 'accuracy': '82.08% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedProx_1 achieved 10.0%(17.56%) at epoch: 1                                   
FedProx_1 achieved 20.0%(27.86%) at epoch: 2                                   
FedProx_1 achieved 30.0%(34.19%) at epoch: 3                                   
FedProx_1 achieved 40.0%(44.04%) at epoch: 4                                   
FedProx_1 achieved 50.0%(51.68%) at epoch: 7                                   
FedProx_1 achieved 60.0%(60.22%) at epoch: 11                                  
FedProx_1 achieved 70.0%(71.92%) at epoch: 28                                  
FedProx_1 achieved 80.0%(80.95%) at epoch: 57                                  
Convergence (test_after):                                                      
FedProx_1 achieved 30.0%(35.19%) at epoch: 0                                   
FedProx_1 achieved 40.0%(48.33%) at epoch: 1                                   
FedProx_1 achieved 50.0%(58.12%) at epoch: 2                                   
FedProx_1 achieved 60.0%(63.33%) at epoch: 6                                   
FedProx_1 achieved 70.0%(70.50%) at epoch: 8                                   
FedProx_1 achieved 80.0%(80.87%) at epoch: 27                                  
