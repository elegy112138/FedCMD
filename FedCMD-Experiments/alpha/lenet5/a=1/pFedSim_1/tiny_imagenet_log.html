==================== ALGORITHM: pFedSim_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1718 -> 4.9633   acc: 2.16% -> 4.68%               
client [81] (test)  loss: 5.1909 -> 4.9449   acc: 2.40% -> 4.24%               
client [21] (test)  loss: 5.2412 -> 4.9151   acc: 1.45% -> 3.99%               
client [68] (test)  loss: 5.1030 -> 4.8145   acc: 1.99% -> 6.69%               
client [93] (test)  loss: 5.0923 -> 5.1192   acc: 2.36% -> 3.09%               
client [31] (test)  loss: 5.1535 -> 5.0036   acc: 2.70% -> 4.86%               
client [20] (test)  loss: 5.2346 -> 4.8394   acc: 2.08% -> 8.51%               
client [59] (test)  loss: 5.2568 -> 4.8631   acc: 2.55% -> 2.73%               
client [48] (test)  loss: 5.1554 -> 4.8805   acc: 2.33% -> 3.58%               
client [34] (test)  loss: 5.1196 -> 5.0939   acc: 1.64% -> 2.00%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.2768 -> 4.5681   acc: 2.04% -> 7.96%               
client [99] (test)  loss: 5.6473 -> 4.9931   acc: 2.71% -> 3.97%               
client [67] (test)  loss: 4.8739 -> 4.5743   acc: 5.78% -> 9.33%               
client [0] (test)  loss: 4.7058 -> 4.7200   acc: 5.62% -> 7.61%                
client [76] (test)  loss: 4.7578 -> 4.4581   acc: 5.44% -> 7.08%               
client [41] (test)  loss: 5.3793 -> 4.7039   acc: 1.63% -> 3.62%               
client [62] (test)  loss: 5.1556 -> 4.7873   acc: 1.44% -> 5.92%               
client [2] (test)  loss: 5.1856 -> 5.1147   acc: 2.88% -> 3.65%                
client [14] (test)  loss: 4.6847 -> 4.8346   acc: 7.40% -> 6.68%               
client [46] (test)  loss: 5.0801 -> 4.6706   acc: 3.81% -> 5.08%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7402 -> 4.3247   acc: 8.73% -> 13.37%              
client [68] (test)  loss: 4.5837 -> 4.5033   acc: 7.41% -> 10.13%              
client [57] (test)  loss: 4.5558 -> 4.5326   acc: 7.08% -> 11.62%              
client [17] (test)  loss: 6.4907 -> 4.5828   acc: 3.78% -> 8.83%               
client [54] (test)  loss: 4.5596 -> 4.4921   acc: 6.90% -> 9.26%               
client [23] (test)  loss: 5.1085 -> 4.7542   acc: 1.99% -> 5.97%               
client [35] (test)  loss: 4.6887 -> 4.3981   acc: 6.35% -> 10.71%              
client [59] (test)  loss: 4.5240 -> 4.4090   acc: 5.64% -> 10.36%              
client [31] (test)  loss: 4.5330 -> 4.7598   acc: 6.67% -> 7.57%               
client [9] (test)  loss: 4.7048 -> 4.6382   acc: 7.05% -> 7.05%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6398 -> 4.4857   acc: 7.99% -> 11.15%              
client [33] (test)  loss: 4.4347 -> 4.4886   acc: 8.70% -> 8.70%               
client [16] (test)  loss: 4.3869 -> 4.3655   acc: 9.87% -> 10.77%              
client [44] (test)  loss: 11.5102 -> 4.4563   acc: 2.84% -> 11.19%             
client [8] (test)  loss: 4.6377 -> 4.5805   acc: 6.32% -> 9.39%                
client [31] (test)  loss: 4.5747 -> 4.7505   acc: 5.59% -> 7.39%               
client [47] (test)  loss: 4.8148 -> 4.5091   acc: 7.40% -> 9.03%               
client [36] (test)  loss: 4.5748 -> 4.3084   acc: 7.09% -> 11.64%              
client [20] (test)  loss: 4.7247 -> 4.2982   acc: 7.56% -> 13.04%              
client [56] (test)  loss: 4.6424 -> 4.4034   acc: 10.83% -> 11.01%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4951 -> 4.3925   acc: 9.07% -> 8.89%                
client [60] (test)  loss: 5.3829 -> 4.3536   acc: 8.81% -> 14.03%              
client [28] (test)  loss: 5.3055 -> 4.7178   acc: 10.53% -> 8.17%              
client [25] (test)  loss: 5.9727 -> 4.3280   acc: 7.03% -> 12.43%              
client [58] (test)  loss: 4.5863 -> 4.4923   acc: 10.09% -> 11.71%             
client [44] (test)  loss: 4.3594 -> 4.4244   acc: 11.37% -> 11.19%             
client [39] (test)  loss: 4.3040 -> 4.2986   acc: 12.18% -> 12.36%             
client [29] (test)  loss: 5.3280 -> 4.2792   acc: 6.65% -> 12.96%              
client [3] (test)  loss: 4.8772 -> 4.3455   acc: 6.08% -> 14.31%               
client [84] (test)  loss: 4.4597 -> 4.2754   acc: 13.04% -> 13.95%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.3186 -> 4.3976   acc: 8.17% -> 13.97%              
client [84] (test)  loss: 4.3613 -> 4.4098   acc: 12.86% -> 14.67%             
client [10] (test)  loss: 5.2285 -> 4.4440   acc: 10.61% -> 15.65%             
client [36] (test)  loss: 4.5073 -> 4.3622   acc: 8.00% -> 14.91%              
client [65] (test)  loss: 4.3773 -> 4.6993   acc: 12.16% -> 10.34%             
client [81] (test)  loss: 4.8628 -> 4.3624   acc: 9.41% -> 11.81%              
client [79] (test)  loss: 4.5089 -> 4.6605   acc: 10.48% -> 7.28%              
client [42] (test)  loss: 4.6382 -> 4.6383   acc: 10.57% -> 13.96%             
client [11] (test)  loss: 4.8045 -> 4.3923   acc: 8.09% -> 10.25%              
client [96] (test)  loss: 4.7686 -> 4.1847   acc: 9.73% -> 13.69%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.6550 -> 4.9272   acc: 11.19% -> 11.19%              
client [53] (test)  loss: 4.8006 -> 4.8492   acc: 7.58% -> 10.05%              
client [52] (test)  loss: 4.6664 -> 4.6979   acc: 11.78% -> 12.86%             
client [42] (test)  loss: 4.5895 -> 4.8259   acc: 11.32% -> 13.77%             
client [69] (test)  loss: 4.5230 -> 4.5939   acc: 10.74% -> 12.78%             
client [59] (test)  loss: 4.5245 -> 4.5032   acc: 9.09% -> 12.55%              
client [7] (test)  loss: 5.7626 -> 4.5897   acc: 7.07% -> 12.14%               
client [26] (test)  loss: 4.5921 -> 4.4177   acc: 10.25% -> 12.95%             
client [49] (test)  loss: 4.4885 -> 4.7682   acc: 10.65% -> 11.73%             
client [98] (test)  loss: 4.4134 -> 4.6105   acc: 10.55% -> 12.18%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.6022 -> 4.7695   acc: 11.09% -> 11.27%             
client [47] (test)  loss: 5.6232 -> 4.6950   acc: 10.11% -> 13.36%             
client [21] (test)  loss: 4.5106 -> 4.7568   acc: 10.89% -> 11.07%             
client [77] (test)  loss: 4.5380 -> 4.8359   acc: 10.07% -> 10.61%             
client [95] (test)  loss: 4.7148 -> 4.8417   acc: 11.63% -> 12.20%             
client [91] (test)  loss: 4.9540 -> 5.0931   acc: 10.91% -> 10.55%             
client [14] (test)  loss: 4.5793 -> 4.8964   acc: 9.57% -> 11.55%              
client [99] (test)  loss: 4.5810 -> 5.0723   acc: 11.19% -> 11.01%             
client [20] (test)  loss: 4.7914 -> 4.4799   acc: 10.40% -> 19.66%             
client [39] (test)  loss: 4.6493 -> 4.5253   acc: 12.73% -> 13.09%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.0443 -> 5.0189   acc: 10.51% -> 13.59%             
client [62] (test)  loss: 4.8311 -> 5.1342   acc: 10.95% -> 10.59%             
client [71] (test)  loss: 4.7868 -> 5.0079   acc: 12.01% -> 11.83%             
client [97] (test)  loss: 4.8937 -> 4.9699   acc: 12.00% -> 11.09%             
client [30] (test)  loss: 4.5281 -> 5.1693   acc: 12.14% -> 10.51%             
client [88] (test)  loss: 4.9334 -> 4.8524   acc: 10.31% -> 13.02%             
client [60] (test)  loss: 5.1139 -> 4.8488   acc: 10.25% -> 13.67%             
client [82] (test)  loss: 4.7051 -> 4.6965   acc: 12.86% -> 16.25%             
client [91] (test)  loss: 5.0497 -> 5.3748   acc: 9.09% -> 11.09%              
client [57] (test)  loss: 4.6019 -> 4.7878   acc: 11.80% -> 14.16%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.4141 -> 5.3507   acc: 9.37% -> 14.05%              
client [15] (test)  loss: 5.0284 -> 5.0976   acc: 9.16% -> 9.34%               
client [71] (test)  loss: 4.9267 -> 5.0640   acc: 11.65% -> 11.11%             
client [97] (test)  loss: 4.7663 -> 5.1377   acc: 14.36% -> 10.73%             
client [53] (test)  loss: 5.3993 -> 5.3759   acc: 7.41% -> 9.88%               
client [77] (test)  loss: 4.9013 -> 4.9293   acc: 12.41% -> 12.77%             
client [76] (test)  loss: 4.7371 -> 4.9566   acc: 13.07% -> 14.88%             
client [79] (test)  loss: 5.0101 -> 5.0603   acc: 10.83% -> 10.48%             
client [28] (test)  loss: 4.8649 -> 5.3198   acc: 10.53% -> 10.89%             
client [99] (test)  loss: 5.1270 -> 5.3091   acc: 12.09% -> 12.45%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 4.6326 -> 5.2984   acc: 16.00% -> 11.64%             
client [86] (test)  loss: 4.5425 -> 5.2406   acc: 15.43% -> 10.89%             
client [34] (test)  loss: 4.9373 -> 5.3916   acc: 13.27% -> 12.18%             
client [73] (test)  loss: 4.7555 -> 5.3028   acc: 13.21% -> 9.96%              
client [5] (test)  loss: 4.7976 -> 5.3879   acc: 8.90% -> 9.07%                
client [96] (test)  loss: 4.5541 -> 4.7311   acc: 13.87% -> 14.77%             
client [22] (test)  loss: 4.4179 -> 4.9105   acc: 14.29% -> 16.46%             
client [60] (test)  loss: 4.7617 -> 5.2025   acc: 13.85% -> 14.21%             
client [66] (test)  loss: 4.9325 -> 5.2828   acc: 16.06% -> 13.72%             
client [83] (test)  loss: 5.2272 -> 5.2707   acc: 11.57% -> 14.47%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 4.7658 -> 5.3012   acc: 16.70% -> 14.70%             
client [65] (test)  loss: 4.8991 -> 5.6395   acc: 12.70% -> 9.80%              
client [95] (test)  loss: 4.9889 -> 5.3959   acc: 14.07% -> 12.95%             
client [17] (test)  loss: 5.1490 -> 5.1472   acc: 8.65% -> 10.81%              
client [8] (test)  loss: 4.8808 -> 5.1660   acc: 11.91% -> 12.64%              
client [35] (test)  loss: 4.6017 -> 5.1921   acc: 16.15% -> 14.88%             
client [98] (test)  loss: 4.6633 -> 5.4362   acc: 14.36% -> 12.18%             
client [53] (test)  loss: 4.9768 -> 5.5832   acc: 10.93% -> 9.35%              
client [43] (test)  loss: 4.7501 -> 5.0187   acc: 12.14% -> 9.96%              
client [64] (test)  loss: 4.9287 -> 5.5154   acc: 13.38% -> 12.27%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 4.8257 -> 5.3002   acc: 16.15% -> 13.97%             
client [88] (test)  loss: 5.2483 -> 5.4156   acc: 12.48% -> 13.38%             
client [38] (test)  loss: 5.1670 -> 5.5815   acc: 13.52% -> 11.85%             
client [3] (test)  loss: 5.0458 -> 5.3803   acc: 15.38% -> 12.88%              
client [5] (test)  loss: 5.2115 -> 5.6006   acc: 9.96% -> 8.72%                
client [41] (test)  loss: 5.2281 -> 5.5495   acc: 12.86% -> 9.60%              
client [7] (test)  loss: 4.6488 -> 5.1731   acc: 16.85% -> 13.59%              
client [37] (test)  loss: 4.8123 -> 5.2557   acc: 13.87% -> 13.33%             
client [45] (test)  loss: 4.7668 -> 4.8891   acc: 12.55% -> 13.64%             
client [47] (test)  loss: 5.2492 -> 4.9951   acc: 7.76% -> 14.26%              
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 5.0889 -> 5.5976   acc: 16.52% -> 15.08%             
client [11] (test)  loss: 5.0355 -> 5.3372   acc: 15.29% -> 14.93%             
client [37] (test)  loss: 5.1320 -> 5.4758   acc: 14.05% -> 14.05%             
client [41] (test)  loss: 5.4110 -> 5.6639   acc: 11.23% -> 10.14%             
client [95] (test)  loss: 5.4713 -> 5.7835   acc: 12.95% -> 12.76%             
client [53] (test)  loss: 5.1851 -> 5.6998   acc: 9.35% -> 9.88%               
client [22] (test)  loss: 4.7527 -> 5.1889   acc: 14.47% -> 15.01%             
client [25] (test)  loss: 4.9515 -> 5.4277   acc: 13.69% -> 11.89%             
client [69] (test)  loss: 5.5757 -> 5.7976   acc: 10.19% -> 12.41%             
client [46] (test)  loss: 5.1592 -> 5.4157   acc: 13.43% -> 11.62%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 5.4980 -> 5.6300   acc: 14.80% -> 15.52%             
client [69] (test)  loss: 5.7576 -> 5.9460   acc: 10.19% -> 12.41%             
client [82] (test)  loss: 4.8084 -> 5.2166   acc: 18.04% -> 16.61%             
client [45] (test)  loss: 4.9203 -> 5.3617   acc: 15.64% -> 13.09%             
client [7] (test)  loss: 4.8947 -> 5.3488   acc: 15.94% -> 12.50%              
client [50] (test)  loss: 5.2973 -> 5.8755   acc: 13.95% -> 11.96%             
client [35] (test)  loss: 5.0298 -> 5.4832   acc: 17.24% -> 13.61%             
client [24] (test)  loss: 4.8310 -> 5.3300   acc: 14.97% -> 16.40%             
client [15] (test)  loss: 5.4326 -> 5.5846   acc: 10.41% -> 10.95%             
client [58] (test)  loss: 5.5277 -> 5.9544   acc: 15.68% -> 13.33%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 5.0745 -> 5.6043   acc: 18.28% -> 15.41%             
client [76] (test)  loss: 5.2160 -> 5.5331   acc: 15.79% -> 15.97%             
client [67] (test)  loss: 5.1985 -> 5.4785   acc: 14.93% -> 15.30%             
client [37] (test)  loss: 5.4418 -> 5.6982   acc: 13.69% -> 13.69%             
client [58] (test)  loss: 5.7394 -> 6.1235   acc: 14.23% -> 12.79%             
client [64] (test)  loss: 5.5074 -> 6.0566   acc: 12.27% -> 12.08%             
client [77] (test)  loss: 5.0285 -> 5.5001   acc: 13.49% -> 12.77%             
client [55] (test)  loss: 5.0543 -> 5.5793   acc: 14.67% -> 11.99%             
client [12] (test)  loss: 5.8882 -> 6.1175   acc: 9.32% -> 9.68%               
client [89] (test)  loss: 5.1218 -> 5.4636   acc: 15.59% -> 15.41%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 5.7002 -> 6.0405   acc: 16.12% -> 17.21%             
client [51] (test)  loss: 5.3043 -> 5.5693   acc: 17.12% -> 16.22%             
client [8] (test)  loss: 5.4841 -> 5.9758   acc: 13.54% -> 11.91%              
client [18] (test)  loss: 5.8116 -> 5.9901   acc: 11.81% -> 12.16%             
client [94] (test)  loss: 5.4606 -> 5.9044   acc: 11.21% -> 12.12%             
client [81] (test)  loss: 5.7521 -> 6.0806   acc: 10.52% -> 9.23%              
client [3] (test)  loss: 5.5477 -> 5.8531   acc: 14.85% -> 13.06%              
client [11] (test)  loss: 5.4611 -> 5.6751   acc: 14.21% -> 14.39%             
client [95] (test)  loss: 6.1435 -> 6.4279   acc: 12.57% -> 11.07%             
client [67] (test)  loss: 5.3436 -> 5.6081   acc: 13.99% -> 14.93%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 5.2963 -> 5.6513   acc: 15.97% -> 14.52%             
client [79] (test)  loss: 5.6611 -> 6.2247   acc: 11.55% -> 10.48%             
client [58] (test)  loss: 6.0814 -> 6.4011   acc: 13.15% -> 13.15%             
client [88] (test)  loss: 5.8479 -> 5.8559   acc: 11.57% -> 12.12%             
client [46] (test)  loss: 6.0480 -> 5.9237   acc: 12.16% -> 10.89%             
client [11] (test)  loss: 5.5901 -> 5.7571   acc: 13.67% -> 15.29%             
client [55] (test)  loss: 5.6073 -> 6.1489   acc: 14.49% -> 11.63%             
client [13] (test)  loss: 5.5527 -> 5.8394   acc: 15.76% -> 15.94%             
client [31] (test)  loss: 5.5494 -> 5.8904   acc: 14.59% -> 14.41%             
client [75] (test)  loss: 5.8330 -> 6.0979   acc: 16.25% -> 14.44%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 5.9255 -> 6.3723   acc: 11.07% -> 9.63%              
client [7] (test)  loss: 5.5053 -> 6.0631   acc: 13.77% -> 12.68%              
client [57] (test)  loss: 5.6774 -> 5.9477   acc: 14.34% -> 13.97%             
client [13] (test)  loss: 5.7223 -> 6.0224   acc: 14.49% -> 15.40%             
client [43] (test)  loss: 5.5917 -> 6.0000   acc: 10.33% -> 10.33%             
client [91] (test)  loss: 5.9651 -> 6.2883   acc: 12.36% -> 12.00%             
client [10] (test)  loss: 5.8184 -> 6.1810   acc: 14.39% -> 14.03%             
client [64] (test)  loss: 6.0896 -> 6.6226   acc: 11.90% -> 11.90%             
client [82] (test)  loss: 5.4945 -> 5.7947   acc: 15.89% -> 16.07%             
client [22] (test)  loss: 5.4097 -> 5.8285   acc: 13.92% -> 14.29%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 5.4310 -> 5.8399   acc: 16.07% -> 18.53%             
client [23] (test)  loss: 6.2608 -> 6.4851   acc: 8.50% -> 8.86%               
client [88] (test)  loss: 6.0310 -> 5.9958   acc: 11.03% -> 12.48%             
client [98] (test)  loss: 5.6996 -> 6.3202   acc: 13.45% -> 13.09%             
client [79] (test)  loss: 5.9435 -> 6.4736   acc: 11.19% -> 10.66%             
client [21] (test)  loss: 5.5766 -> 5.9042   acc: 15.25% -> 13.97%             
client [92] (test)  loss: 5.5049 -> 6.0270   acc: 15.36% -> 14.64%             
client [56] (test)  loss: 6.2529 -> 6.0012   acc: 12.82% -> 15.16%             
client [5] (test)  loss: 6.1993 -> 6.3714   acc: 7.65% -> 7.83%                
client [52] (test)  loss: 6.4174 -> 6.9052   acc: 10.87% -> 11.59%             
==================== pFedSim_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '4.9853 -> 0.0000', 'accuracy': '11.11% -> 0.00%'},          
    200: {'loss': '6.1166 -> 0.0000', 'accuracy': '12.63% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_1 achieved 10.0%(10.30%) at epoch: 54                                  
Convergence (test_after):                                                      
pFedSim_1 achieved 10.0%(10.28%) at epoch: 34                                  
