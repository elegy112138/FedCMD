==================== ALGORITHM: pFedSim_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.1382 -> 1.0395   acc: 21.67% -> 65.54%             
client [81] (test)  loss: 1.8893 -> 1.3070   acc: 31.42% -> 60.18%             
client [21] (test)  loss: 2.2100 -> 0.7916   acc: 27.10% -> 73.52%             
client [68] (test)  loss: 1.4555 -> 0.8510   acc: 56.47% -> 74.46%             
client [93] (test)  loss: 0.6848 -> 0.4092   acc: 82.56% -> 88.08%             
client [31] (test)  loss: 1.9896 -> 1.2902   acc: 26.43% -> 51.10%             
client [20] (test)  loss: 0.9791 -> 0.5681   acc: 72.55% -> 83.01%             
client [59] (test)  loss: 2.1157 -> 0.8683   acc: 36.42% -> 71.52%             
client [48] (test)  loss: 1.2748 -> 0.9196   acc: 53.72% -> 65.88%             
client [34] (test)  loss: 1.2503 -> 0.6755   acc: 56.45% -> 73.66%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2200 -> 0.5519   acc: 56.86% -> 82.61%             
client [99] (test)  loss: 1.1018 -> 0.7025   acc: 60.69% -> 80.00%             
client [67] (test)  loss: 1.1607 -> 0.6694   acc: 52.90% -> 80.31%             
client [0] (test)  loss: 0.8062 -> 0.4666   acc: 75.08% -> 85.25%              
client [76] (test)  loss: 0.9743 -> 0.6688   acc: 60.22% -> 77.66%             
client [41] (test)  loss: 1.5814 -> 0.7685   acc: 37.20% -> 74.80%             
client [62] (test)  loss: 3.0339 -> 0.4934   acc: 4.29% -> 84.00%              
client [2] (test)  loss: 2.1305 -> 0.5539   acc: 14.37% -> 79.04%              
client [14] (test)  loss: 0.6908 -> 0.3470   acc: 74.55% -> 87.88%             
client [46] (test)  loss: 0.6653 -> 0.5793   acc: 75.21% -> 81.20%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0370 -> 0.5791   acc: 60.91% -> 79.44%             
client [68] (test)  loss: 0.6580 -> 0.5793   acc: 78.42% -> 80.58%             
client [57] (test)  loss: 0.9448 -> 0.6418   acc: 60.71% -> 79.59%             
client [17] (test)  loss: 0.9046 -> 0.6527   acc: 66.44% -> 78.08%             
client [54] (test)  loss: 0.5268 -> 0.4331   acc: 85.17% -> 85.17%             
client [23] (test)  loss: 2.3674 -> 0.3861   acc: 23.89% -> 86.39%             
client [35] (test)  loss: 0.7554 -> 0.4929   acc: 71.76% -> 87.73%             
client [59] (test)  loss: 0.6142 -> 0.3439   acc: 79.47% -> 90.40%             
client [31] (test)  loss: 0.7167 -> 0.6817   acc: 74.45% -> 77.09%             
client [9] (test)  loss: 0.7190 -> 0.5610   acc: 74.04% -> 78.47%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6686 -> 0.4018   acc: 79.75% -> 86.71%             
client [33] (test)  loss: 0.5302 -> 0.2957   acc: 82.47% -> 89.29%             
client [16] (test)  loss: 0.9277 -> 0.3398   acc: 72.12% -> 88.48%             
client [44] (test)  loss: 2.6118 -> 0.4456   acc: 33.99% -> 83.29%             
client [8] (test)  loss: 0.8942 -> 0.2574   acc: 71.48% -> 91.48%              
client [31] (test)  loss: 0.6499 -> 0.5931   acc: 77.09% -> 77.97%             
client [47] (test)  loss: 0.7720 -> 0.3082   acc: 73.80% -> 88.55%             
client [36] (test)  loss: 0.8736 -> 0.4872   acc: 70.07% -> 81.91%             
client [20] (test)  loss: 0.4500 -> 0.2868   acc: 84.64% -> 90.20%             
client [56] (test)  loss: 0.4781 -> 0.1996   acc: 84.05% -> 93.87%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3902 -> 0.2080   acc: 87.30% -> 94.14%              
client [60] (test)  loss: 1.0043 -> 0.1814   acc: 70.06% -> 93.52%             
client [28] (test)  loss: 1.1219 -> 0.7247   acc: 66.67% -> 78.17%             
client [25] (test)  loss: 1.2787 -> 0.3388   acc: 59.42% -> 89.78%             
client [58] (test)  loss: 0.8838 -> 0.3004   acc: 71.28% -> 90.43%             
client [44] (test)  loss: 0.6824 -> 0.4071   acc: 74.79% -> 85.27%             
client [39] (test)  loss: 0.6846 -> 0.2990   acc: 78.20% -> 91.28%             
client [29] (test)  loss: 1.1325 -> 0.4260   acc: 62.66% -> 85.84%             
client [3] (test)  loss: 0.4627 -> 0.2765   acc: 82.35% -> 89.87%              
client [84] (test)  loss: 1.0200 -> 0.4524   acc: 62.28% -> 82.56%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4674 -> 0.3125   acc: 82.87% -> 89.72%             
client [84] (test)  loss: 0.6576 -> 0.4046   acc: 75.44% -> 85.05%             
client [10] (test)  loss: 0.5010 -> 0.2995   acc: 83.20% -> 90.23%             
client [36] (test)  loss: 0.7817 -> 0.3771   acc: 75.00% -> 84.87%             
client [65] (test)  loss: 0.3539 -> 0.3395   acc: 87.18% -> 89.42%             
client [81] (test)  loss: 0.6082 -> 0.4972   acc: 80.09% -> 83.19%             
client [79] (test)  loss: 0.5969 -> 0.4944   acc: 79.55% -> 85.00%             
client [42] (test)  loss: 0.7810 -> 0.5836   acc: 71.77% -> 77.78%             
client [11] (test)  loss: 1.0253 -> 0.5271   acc: 64.29% -> 83.19%             
client [96] (test)  loss: 0.6493 -> 0.5137   acc: 81.56% -> 87.94%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7534 -> 0.1857   acc: 73.11% -> 95.08%              
client [53] (test)  loss: 0.6812 -> 0.4541   acc: 74.90% -> 83.53%             
client [52] (test)  loss: 1.1161 -> 0.2877   acc: 66.45% -> 92.65%             
client [42] (test)  loss: 0.8757 -> 0.5587   acc: 72.37% -> 79.88%             
client [69] (test)  loss: 0.3377 -> 0.2592   acc: 88.29% -> 89.63%             
client [59] (test)  loss: 0.3883 -> 0.2059   acc: 87.42% -> 92.72%             
client [7] (test)  loss: 0.6015 -> 0.1861   acc: 80.40% -> 93.37%              
client [26] (test)  loss: 0.6938 -> 0.1620   acc: 82.40% -> 95.66%             
client [49] (test)  loss: 0.3180 -> 0.1400   acc: 90.26% -> 96.10%             
client [98] (test)  loss: 0.6292 -> 0.3912   acc: 78.01% -> 89.53%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7152 -> 0.3649   acc: 77.49% -> 90.58%             
client [47] (test)  loss: 0.5171 -> 0.2205   acc: 80.42% -> 93.07%             
client [21] (test)  loss: 0.4839 -> 0.2885   acc: 83.18% -> 89.72%             
client [77] (test)  loss: 0.7218 -> 0.4399   acc: 76.76% -> 85.64%             
client [95] (test)  loss: 0.5484 -> 0.3752   acc: 82.73% -> 87.15%             
client [91] (test)  loss: 0.6002 -> 0.3116   acc: 80.21% -> 87.70%             
client [14] (test)  loss: 0.2920 -> 0.1684   acc: 90.30% -> 94.55%             
client [99] (test)  loss: 0.6893 -> 0.4279   acc: 79.31% -> 87.59%             
client [20] (test)  loss: 0.3401 -> 0.2110   acc: 88.24% -> 91.18%             
client [39] (test)  loss: 0.5747 -> 0.2576   acc: 82.85% -> 93.60%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6516 -> 0.2864   acc: 80.51% -> 93.61%             
client [62] (test)  loss: 0.8125 -> 0.2611   acc: 74.86% -> 90.29%             
client [71] (test)  loss: 0.6701 -> 0.2913   acc: 76.80% -> 90.40%             
client [97] (test)  loss: 0.3448 -> 0.1947   acc: 87.60% -> 94.61%             
client [30] (test)  loss: 2.4298 -> 0.1023   acc: 40.19% -> 97.15%             
client [88] (test)  loss: 0.5189 -> 0.1230   acc: 83.33% -> 95.51%             
client [60] (test)  loss: 0.3467 -> 0.1604   acc: 89.20% -> 95.37%             
client [82] (test)  loss: 0.8751 -> 0.3538   acc: 69.58% -> 89.64%             
client [91] (test)  loss: 0.6568 -> 0.2835   acc: 81.82% -> 87.70%             
client [57] (test)  loss: 0.4701 -> 0.3438   acc: 83.16% -> 88.27%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7189 -> 0.4114   acc: 77.97% -> 86.34%             
client [15] (test)  loss: 0.2277 -> 0.0773   acc: 92.81% -> 96.88%             
client [71] (test)  loss: 0.5076 -> 0.2995   acc: 80.80% -> 92.00%             
client [97] (test)  loss: 0.3523 -> 0.1911   acc: 88.14% -> 94.34%             
client [53] (test)  loss: 0.8119 -> 0.4153   acc: 76.08% -> 85.49%             
client [77] (test)  loss: 0.8580 -> 0.4116   acc: 74.93% -> 86.68%             
client [76] (test)  loss: 1.1461 -> 0.3123   acc: 67.30% -> 89.10%             
client [79] (test)  loss: 0.5695 -> 0.4003   acc: 81.36% -> 88.18%             
client [28] (test)  loss: 0.7796 -> 0.5368   acc: 77.78% -> 84.92%             
client [99] (test)  loss: 0.8162 -> 0.4233   acc: 76.90% -> 86.90%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.2518 -> 0.1873   acc: 91.11% -> 94.34%             
client [86] (test)  loss: 0.3047 -> 0.2583   acc: 91.28% -> 89.74%             
client [34] (test)  loss: 0.2911 -> 0.2384   acc: 91.67% -> 93.55%             
client [73] (test)  loss: 0.1967 -> 0.1457   acc: 93.12% -> 95.55%             
client [5] (test)  loss: 0.4828 -> 0.2430   acc: 85.44% -> 90.93%              
client [96] (test)  loss: 0.7424 -> 0.4537   acc: 77.66% -> 86.17%             
client [22] (test)  loss: 0.3011 -> 0.1859   acc: 89.44% -> 93.89%             
client [60] (test)  loss: 0.4317 -> 0.1558   acc: 86.73% -> 95.68%             
client [66] (test)  loss: 0.3504 -> 0.3983   acc: 89.49% -> 88.77%             
client [83] (test)  loss: 0.3828 -> 0.3037   acc: 87.44% -> 89.41%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.5325 -> 0.3025   acc: 83.65% -> 88.83%             
client [65] (test)  loss: 0.3015 -> 0.2979   acc: 91.03% -> 91.35%             
client [95] (test)  loss: 0.4935 -> 0.3289   acc: 85.14% -> 89.16%             
client [17] (test)  loss: 0.8739 -> 0.5215   acc: 73.97% -> 82.88%             
client [8] (test)  loss: 0.2745 -> 0.1511   acc: 91.48% -> 95.41%              
client [35] (test)  loss: 0.2487 -> 0.2094   acc: 92.82% -> 95.14%             
client [98] (test)  loss: 0.4426 -> 0.3623   acc: 85.86% -> 90.05%             
client [53] (test)  loss: 0.4518 -> 0.4164   acc: 84.31% -> 84.71%             
client [43] (test)  loss: 0.6990 -> 0.3427   acc: 76.66% -> 88.21%             
client [64] (test)  loss: 0.3853 -> 0.2343   acc: 89.24% -> 90.51%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.2664 -> 0.2688   acc: 92.83% -> 92.21%             
client [88] (test)  loss: 0.1274 -> 0.1167   acc: 95.83% -> 95.83%             
client [38] (test)  loss: 0.5613 -> 0.3226   acc: 82.49% -> 91.99%             
client [3] (test)  loss: 0.2318 -> 0.1807   acc: 91.83% -> 94.12%              
client [5] (test)  loss: 0.3995 -> 0.2411   acc: 88.19% -> 91.21%              
client [41] (test)  loss: 0.7378 -> 0.3729   acc: 78.80% -> 89.60%             
client [7] (test)  loss: 0.2942 -> 0.1615   acc: 90.49% -> 94.81%              
client [37] (test)  loss: 0.2168 -> 0.2769   acc: 90.33% -> 90.00%             
client [45] (test)  loss: 0.6905 -> 0.4123   acc: 75.08% -> 85.17%             
client [47] (test)  loss: 0.4239 -> 0.2020   acc: 87.35% -> 93.37%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.3574 -> 0.2301   acc: 87.36% -> 92.57%             
client [11] (test)  loss: 0.9374 -> 0.4668   acc: 70.17% -> 86.55%             
client [37] (test)  loss: 0.2439 -> 0.2860   acc: 90.00% -> 89.33%             
client [41] (test)  loss: 0.7630 -> 0.3678   acc: 76.80% -> 89.20%             
client [95] (test)  loss: 0.3805 -> 0.3417   acc: 88.35% -> 89.16%             
client [53] (test)  loss: 0.5232 -> 0.4185   acc: 81.96% -> 85.10%             
client [22] (test)  loss: 0.2878 -> 0.1821   acc: 91.11% -> 94.44%             
client [25] (test)  loss: 0.3108 -> 0.2342   acc: 88.18% -> 90.73%             
client [69] (test)  loss: 0.2570 -> 0.2521   acc: 91.97% -> 91.30%             
client [46] (test)  loss: 0.2593 -> 0.2155   acc: 91.45% -> 92.31%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2252 -> 0.1953   acc: 93.98% -> 93.07%             
client [69] (test)  loss: 0.2532 -> 0.2538   acc: 91.97% -> 91.30%             
client [82] (test)  loss: 0.5503 -> 0.3597   acc: 78.64% -> 88.35%             
client [45] (test)  loss: 0.5581 -> 0.4351   acc: 80.76% -> 84.86%             
client [7] (test)  loss: 0.2664 -> 0.1619   acc: 92.22% -> 94.81%              
client [50] (test)  loss: 0.2653 -> 0.1919   acc: 91.24% -> 94.53%             
client [35] (test)  loss: 0.2185 -> 0.2123   acc: 93.52% -> 94.44%             
client [24] (test)  loss: 0.4809 -> 0.3641   acc: 81.22% -> 88.07%             
client [15] (test)  loss: 0.0978 -> 0.0716   acc: 96.88% -> 97.19%             
client [58] (test)  loss: 0.3789 -> 0.2585   acc: 85.89% -> 91.69%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.3657 -> 0.3779   acc: 86.82% -> 87.84%             
client [76] (test)  loss: 0.4579 -> 0.2953   acc: 85.83% -> 88.83%             
client [67] (test)  loss: 0.3364 -> 0.3644   acc: 91.12% -> 91.12%             
client [37] (test)  loss: 0.2410 -> 0.2867   acc: 91.33% -> 89.33%             
client [58] (test)  loss: 0.3668 -> 0.2582   acc: 86.65% -> 91.69%             
client [64] (test)  loss: 0.4027 -> 0.2160   acc: 87.34% -> 90.51%             
client [77] (test)  loss: 0.4452 -> 0.4265   acc: 85.38% -> 86.16%             
client [55] (test)  loss: 0.2568 -> 0.2081   acc: 92.77% -> 92.77%             
client [12] (test)  loss: 0.2954 -> 0.3720   acc: 90.55% -> 87.01%             
client [89] (test)  loss: 0.2242 -> 0.1967   acc: 92.22% -> 93.37%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.3889 -> 0.3741   acc: 85.05% -> 87.19%             
client [51] (test)  loss: 0.4035 -> 0.3973   acc: 87.18% -> 87.18%             
client [8] (test)  loss: 0.1510 -> 0.1442   acc: 95.08% -> 95.41%              
client [18] (test)  loss: 0.1239 -> 0.0893   acc: 96.70% -> 97.03%             
client [94] (test)  loss: 0.2782 -> 0.2017   acc: 90.62% -> 93.36%             
client [81] (test)  loss: 0.5533 -> 0.5094   acc: 84.96% -> 86.73%             
client [3] (test)  loss: 0.2194 -> 0.1815   acc: 92.81% -> 94.12%              
client [11] (test)  loss: 1.0031 -> 0.4736   acc: 69.75% -> 85.71%             
client [95] (test)  loss: 0.3880 -> 0.3539   acc: 88.35% -> 89.56%             
client [67] (test)  loss: 0.3547 -> 0.3615   acc: 90.73% -> 91.51%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.2869 -> 0.2699   acc: 91.59% -> 92.21%             
client [79] (test)  loss: 0.4486 -> 0.3860   acc: 85.91% -> 88.18%             
client [58] (test)  loss: 0.3630 -> 0.2616   acc: 86.65% -> 92.19%             
client [88] (test)  loss: 0.1325 -> 0.1133   acc: 94.87% -> 96.47%             
client [46] (test)  loss: 0.3427 -> 0.2202   acc: 87.61% -> 91.88%             
client [11] (test)  loss: 1.0092 -> 0.4765   acc: 69.33% -> 86.13%             
client [55] (test)  loss: 0.2553 -> 0.2135   acc: 92.77% -> 91.57%             
client [13] (test)  loss: 0.2349 -> 0.2673   acc: 93.82% -> 92.70%             
client [31] (test)  loss: 0.5427 -> 0.3954   acc: 84.14% -> 87.22%             
client [75] (test)  loss: 0.2829 -> 0.3388   acc: 91.01% -> 89.42%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.1447 -> 0.1512   acc: 95.09% -> 95.71%             
client [7] (test)  loss: 0.2506 -> 0.1684   acc: 93.66% -> 95.39%              
client [57] (test)  loss: 0.2929 -> 0.3163   acc: 90.31% -> 90.82%             
client [13] (test)  loss: 0.2308 -> 0.2691   acc: 94.10% -> 92.70%             
client [43] (test)  loss: 0.5301 -> 0.3406   acc: 84.28% -> 88.21%             
client [91] (test)  loss: 0.3931 -> 0.2609   acc: 87.70% -> 88.24%             
client [10] (test)  loss: 0.2583 -> 0.2243   acc: 91.41% -> 92.19%             
client [64] (test)  loss: 0.4040 -> 0.2104   acc: 87.97% -> 91.77%             
client [82] (test)  loss: 0.4360 -> 0.3707   acc: 84.47% -> 89.32%             
client [22] (test)  loss: 0.3019 -> 0.1784   acc: 91.11% -> 95.00%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.4835 -> 0.2188   acc: 86.27% -> 91.50%             
client [23] (test)  loss: 0.3247 -> 0.2018   acc: 88.33% -> 93.06%             
client [88] (test)  loss: 0.1328 -> 0.1123   acc: 94.87% -> 96.47%             
client [98] (test)  loss: 0.4789 -> 0.3781   acc: 85.34% -> 88.48%             
client [79] (test)  loss: 0.4567 -> 0.3880   acc: 85.45% -> 88.18%             
client [21] (test)  loss: 0.2916 -> 0.2756   acc: 91.90% -> 92.21%             
client [92] (test)  loss: 0.5476 -> 0.5441   acc: 82.20% -> 82.95%             
client [56] (test)  loss: 0.1530 -> 0.1512   acc: 95.09% -> 95.40%             
client [5] (test)  loss: 0.3347 -> 0.2362   acc: 89.29% -> 90.66%              
client [52] (test)  loss: 0.5896 -> 0.2952   acc: 86.58% -> 93.61%             
==================== pFedSim_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.5779 -> 0.0000', 'accuracy': '82.00% -> 0.00%'},          
    200: {'loss': '0.2882 -> 0.0000', 'accuracy': '90.95% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_1 achieved 10.0%(15.55%) at epoch: 0                                   
pFedSim_1 achieved 20.0%(20.87%) at epoch: 1                                   
pFedSim_1 achieved 40.0%(46.72%) at epoch: 7                                   
pFedSim_1 achieved 50.0%(52.95%) at epoch: 16                                  
pFedSim_1 achieved 60.0%(62.16%) at epoch: 20                                  
pFedSim_1 achieved 70.0%(70.13%) at epoch: 22                                  
pFedSim_1 achieved 80.0%(80.19%) at epoch: 44                                  
pFedSim_1 achieved 90.0%(90.78%) at epoch: 140                                 
Convergence (test_after):                                                      
pFedSim_1 achieved 30.0%(38.48%) at epoch: 0                                   
pFedSim_1 achieved 40.0%(43.70%) at epoch: 1                                   
pFedSim_1 achieved 50.0%(59.10%) at epoch: 3                                   
pFedSim_1 achieved 60.0%(67.98%) at epoch: 5                                   
pFedSim_1 achieved 70.0%(72.26%) at epoch: 8                                   
pFedSim_1 achieved 80.0%(80.38%) at epoch: 15                                  
pFedSim_1 achieved 90.0%(90.92%) at epoch: 45                                  
