==================== ALGORITHM: pFedSim_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8582 -> 0.5774   acc: 68.93% -> 79.29%             
client [81] (test)  loss: 1.0280 -> 0.7011   acc: 57.42% -> 71.15%             
client [21] (test)  loss: 19.3982 -> 0.5490   acc: 38.33% -> 85.28%            
client [68] (test)  loss: 0.8880 -> 0.6810   acc: 70.25% -> 77.22%             
client [93] (test)  loss: 1.0785 -> 0.5596   acc: 56.19% -> 81.59%             
client [31] (test)  loss: 1.1548 -> 0.6426   acc: 50.10% -> 75.94%             
client [20] (test)  loss: 0.8363 -> 0.6819   acc: 69.11% -> 75.80%             
client [59] (test)  loss: 20.8691 -> 0.3561   acc: 35.14% -> 89.14%            
client [48] (test)  loss: 0.5567 -> 0.2938   acc: 84.78% -> 87.93%             
client [34] (test)  loss: 0.6249 -> 0.4206   acc: 76.90% -> 85.60%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.6892 -> 0.2955   acc: 75.58% -> 89.09%             
client [99] (test)  loss: 0.5149 -> 0.3218   acc: 81.64% -> 88.98%             
client [67] (test)  loss: 0.5832 -> 0.3351   acc: 83.38% -> 90.18%             
client [0] (test)  loss: 0.5515 -> 0.4789   acc: 81.91% -> 82.71%              
client [76] (test)  loss: 0.5733 -> 0.2684   acc: 80.51% -> 91.01%             
client [41] (test)  loss: 0.7498 -> 0.5749   acc: 69.74% -> 79.70%             
client [62] (test)  loss: 20.3003 -> 0.5012   acc: 50.15% -> 83.79%            
client [2] (test)  loss: 26.1106 -> 0.4886   acc: 40.79% -> 81.59%             
client [14] (test)  loss: 0.6858 -> 0.3728   acc: 73.55% -> 87.66%             
client [46] (test)  loss: 0.6024 -> 0.3304   acc: 77.84% -> 86.59%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4675 -> 0.3821   acc: 82.62% -> 86.40%             
client [68] (test)  loss: 0.4970 -> 0.4451   acc: 81.65% -> 82.91%             
client [57] (test)  loss: 0.5186 -> 0.3152   acc: 83.03% -> 90.25%             
client [17] (test)  loss: 0.4905 -> 0.2461   acc: 83.51% -> 92.15%             
client [54] (test)  loss: 0.3834 -> 0.2379   acc: 88.07% -> 92.12%             
client [23] (test)  loss: 25.6630 -> 0.2597   acc: 42.68% -> 92.14%            
client [35] (test)  loss: 0.5273 -> 0.3275   acc: 78.92% -> 89.18%             
client [59] (test)  loss: 0.3894 -> 0.2322   acc: 87.71% -> 91.43%             
client [31] (test)  loss: 0.5893 -> 0.5119   acc: 75.94% -> 79.52%             
client [9] (test)  loss: 0.5099 -> 0.3781   acc: 81.11% -> 85.64%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7132 -> 0.4113   acc: 73.65% -> 86.12%             
client [33] (test)  loss: 0.4339 -> 0.3350   acc: 83.24% -> 86.76%             
client [16] (test)  loss: 0.3099 -> 0.1611   acc: 90.31% -> 93.98%             
client [44] (test)  loss: 1.0162 -> 0.2877   acc: 66.96% -> 90.75%             
client [8] (test)  loss: 0.3843 -> 0.3679   acc: 88.39% -> 84.84%              
client [31] (test)  loss: 0.6758 -> 0.4958   acc: 73.56% -> 80.72%             
client [47] (test)  loss: 0.6373 -> 0.4223   acc: 73.41% -> 85.39%             
client [36] (test)  loss: 0.4820 -> 0.3900   acc: 80.98% -> 86.20%             
client [20] (test)  loss: 0.5430 -> 0.5183   acc: 81.53% -> 81.85%             
client [56] (test)  loss: 0.4671 -> 0.4806   acc: 83.75% -> 84.06%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7859 -> 0.5487   acc: 73.71% -> 76.55%              
client [60] (test)  loss: 0.4074 -> 0.2029   acc: 86.63% -> 94.80%             
client [28] (test)  loss: 0.6647 -> 0.5898   acc: 80.18% -> 81.11%             
client [25] (test)  loss: 0.6449 -> 0.4151   acc: 77.31% -> 86.28%             
client [58] (test)  loss: 0.3368 -> 0.2061   acc: 89.27% -> 92.93%             
client [44] (test)  loss: 0.4112 -> 0.2573   acc: 83.48% -> 91.63%             
client [39] (test)  loss: 0.6402 -> 0.3628   acc: 76.84% -> 86.10%             
client [29] (test)  loss: 0.8175 -> 0.4898   acc: 69.76% -> 83.83%             
client [3] (test)  loss: 0.5377 -> 0.3551   acc: 80.44% -> 88.15%              
client [84] (test)  loss: 0.6348 -> 0.3308   acc: 77.39% -> 87.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4565 -> 0.3204   acc: 85.56% -> 88.61%             
client [84] (test)  loss: 0.5691 -> 0.3330   acc: 81.16% -> 88.99%             
client [10] (test)  loss: 0.5244 -> 0.3032   acc: 83.61% -> 91.11%             
client [36] (test)  loss: 0.4967 -> 0.3600   acc: 80.98% -> 85.89%             
client [65] (test)  loss: 0.2960 -> 0.2913   acc: 89.51% -> 89.73%             
client [81] (test)  loss: 0.4869 -> 0.5009   acc: 79.55% -> 80.67%             
client [79] (test)  loss: 0.7242 -> 0.5115   acc: 75.97% -> 79.56%             
client [42] (test)  loss: 0.8563 -> 0.3715   acc: 65.58% -> 88.37%             
client [11] (test)  loss: 0.4500 -> 0.4105   acc: 84.06% -> 86.96%             
client [96] (test)  loss: 0.4008 -> 0.2734   acc: 84.76% -> 90.30%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3809 -> 0.3598   acc: 87.10% -> 87.10%              
client [53] (test)  loss: 0.3976 -> 0.1712   acc: 85.75% -> 95.18%             
client [52] (test)  loss: 0.6396 -> 0.4239   acc: 77.01% -> 85.87%             
client [42] (test)  loss: 0.5712 -> 0.3638   acc: 79.07% -> 88.84%             
client [69] (test)  loss: 0.3642 -> 0.2632   acc: 85.97% -> 90.65%             
client [59] (test)  loss: 0.4170 -> 0.1995   acc: 86.00% -> 94.57%             
client [7] (test)  loss: 0.4218 -> 0.4209   acc: 86.67% -> 86.11%              
client [26] (test)  loss: 0.2396 -> 0.2517   acc: 91.58% -> 91.23%             
client [49] (test)  loss: 0.4520 -> 0.4667   acc: 82.82% -> 83.53%             
client [98] (test)  loss: 0.4765 -> 0.4264   acc: 83.61% -> 84.44%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5206 -> 0.4144   acc: 81.39% -> 85.83%             
client [47] (test)  loss: 0.6895 -> 0.4302   acc: 75.28% -> 86.89%             
client [21] (test)  loss: 0.3976 -> 0.3331   acc: 86.39% -> 89.44%             
client [77] (test)  loss: 0.4004 -> 0.3092   acc: 84.64% -> 87.50%             
client [95] (test)  loss: 0.4927 -> 0.2916   acc: 84.23% -> 89.01%             
client [91] (test)  loss: 0.5505 -> 0.3905   acc: 80.00% -> 85.79%             
client [14] (test)  loss: 0.4020 -> 0.2917   acc: 86.65% -> 89.17%             
client [99] (test)  loss: 0.3479 -> 0.2381   acc: 87.85% -> 92.94%             
client [20] (test)  loss: 0.5344 -> 0.4761   acc: 81.85% -> 83.44%             
client [39] (test)  loss: 0.7527 -> 0.3546   acc: 71.39% -> 87.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6578 -> 0.4580   acc: 77.29% -> 83.66%             
client [62] (test)  loss: 0.4260 -> 0.4058   acc: 88.69% -> 87.16%             
client [71] (test)  loss: 0.3426 -> 0.2373   acc: 89.55% -> 92.09%             
client [97] (test)  loss: 0.5450 -> 0.3702   acc: 79.85% -> 86.57%             
client [30] (test)  loss: 0.3810 -> 0.2698   acc: 84.12% -> 91.89%             
client [88] (test)  loss: 0.6264 -> 0.4512   acc: 78.24% -> 82.09%             
client [60] (test)  loss: 0.3219 -> 0.2291   acc: 92.08% -> 94.55%             
client [82] (test)  loss: 0.3758 -> 0.2858   acc: 88.06% -> 90.55%             
client [91] (test)  loss: 0.5502 -> 0.3919   acc: 80.00% -> 86.58%             
client [57] (test)  loss: 0.3664 -> 0.3366   acc: 89.53% -> 91.70%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7180 -> 0.5305   acc: 76.94% -> 80.32%             
client [15] (test)  loss: 0.3619 -> 0.3265   acc: 88.64% -> 88.92%             
client [71] (test)  loss: 0.4146 -> 0.2511   acc: 87.57% -> 92.09%             
client [97] (test)  loss: 0.5552 -> 0.3710   acc: 82.46% -> 86.57%             
client [53] (test)  loss: 0.4468 -> 0.1788   acc: 83.33% -> 95.39%             
client [77] (test)  loss: 0.3613 -> 0.3106   acc: 87.14% -> 86.79%             
client [76] (test)  loss: 0.4511 -> 0.2748   acc: 84.15% -> 91.43%             
client [79] (test)  loss: 0.7846 -> 0.4559   acc: 76.24% -> 83.15%             
client [28] (test)  loss: 0.6566 -> 0.6272   acc: 83.41% -> 81.11%             
client [99] (test)  loss: 0.3272 -> 0.2428   acc: 88.70% -> 92.66%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.4975 -> 0.3692   acc: 80.97% -> 87.69%             
client [86] (test)  loss: 0.1763 -> 0.1481   acc: 93.49% -> 94.42%             
client [34] (test)  loss: 0.4708 -> 0.3951   acc: 83.97% -> 88.04%             
client [73] (test)  loss: 0.3468 -> 0.2867   acc: 86.57% -> 91.04%             
client [5] (test)  loss: 0.4784 -> 0.3958   acc: 82.76% -> 86.97%              
client [96] (test)  loss: 0.2625 -> 0.2513   acc: 90.58% -> 91.69%             
client [22] (test)  loss: 0.3934 -> 0.4440   acc: 87.10% -> 87.10%             
client [60] (test)  loss: 0.3448 -> 0.2411   acc: 89.60% -> 94.31%             
client [66] (test)  loss: 0.5568 -> 0.4621   acc: 81.48% -> 86.30%             
client [83] (test)  loss: 0.4284 -> 0.2387   acc: 87.89% -> 92.78%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.2916 -> 0.2700   acc: 90.79% -> 92.08%             
client [65] (test)  loss: 0.2837 -> 0.3047   acc: 91.74% -> 90.62%             
client [95] (test)  loss: 0.3688 -> 0.2749   acc: 88.45% -> 90.14%             
client [17] (test)  loss: 0.5021 -> 0.2638   acc: 83.51% -> 93.19%             
client [8] (test)  loss: 0.3370 -> 0.3652   acc: 88.71% -> 87.10%              
client [35] (test)  loss: 0.3911 -> 0.3608   acc: 87.69% -> 89.37%             
client [98] (test)  loss: 0.3825 -> 0.4531   acc: 86.67% -> 83.89%             
client [53] (test)  loss: 0.2841 -> 0.1812   acc: 90.13% -> 94.96%             
client [43] (test)  loss: 0.2367 -> 0.1688   acc: 93.55% -> 96.24%             
client [64] (test)  loss: 0.6434 -> 0.4478   acc: 82.44% -> 86.97%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.3345 -> 0.3465   acc: 90.56% -> 91.11%             
client [88] (test)  loss: 0.5433 -> 0.4781   acc: 81.82% -> 81.54%             
client [38] (test)  loss: 0.3757 -> 0.3265   acc: 88.05% -> 91.51%             
client [3] (test)  loss: 0.4482 -> 0.3367   acc: 85.67% -> 89.81%              
client [5] (test)  loss: 0.4217 -> 0.3873   acc: 86.21% -> 88.12%              
client [41] (test)  loss: 0.4942 -> 0.4827   acc: 82.66% -> 83.39%             
client [7] (test)  loss: 0.3752 -> 0.4244   acc: 86.67% -> 87.50%              
client [37] (test)  loss: 0.3591 -> 0.2609   acc: 88.83% -> 91.90%             
client [45] (test)  loss: 0.6984 -> 0.2706   acc: 78.27% -> 89.53%             
client [47] (test)  loss: 0.5874 -> 0.4410   acc: 80.90% -> 85.39%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.2228 -> 0.1881   acc: 92.67% -> 93.98%             
client [11] (test)  loss: 0.3590 -> 0.3889   acc: 87.68% -> 86.23%             
client [37] (test)  loss: 0.3408 -> 0.2601   acc: 89.66% -> 91.62%             
client [41] (test)  loss: 0.4448 -> 0.4759   acc: 83.76% -> 83.76%             
client [95] (test)  loss: 0.3107 -> 0.2772   acc: 90.70% -> 89.86%             
client [53] (test)  loss: 0.2543 -> 0.1815   acc: 90.57% -> 95.39%             
client [22] (test)  loss: 0.3969 -> 0.4291   acc: 86.77% -> 87.42%             
client [25] (test)  loss: 0.4934 -> 0.4301   acc: 87.07% -> 86.54%             
client [69] (test)  loss: 0.2493 -> 0.2806   acc: 91.95% -> 90.91%             
client [46] (test)  loss: 0.3361 -> 0.3086   acc: 89.21% -> 90.67%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.4306 -> 0.4620   acc: 85.02% -> 85.39%             
client [69] (test)  loss: 0.2453 -> 0.2796   acc: 91.69% -> 91.43%             
client [82] (test)  loss: 0.2398 -> 0.2816   acc: 92.04% -> 90.80%             
client [45] (test)  loss: 0.3209 -> 0.2675   acc: 89.53% -> 90.31%             
client [7] (test)  loss: 0.3742 -> 0.4307   acc: 87.50% -> 87.50%              
client [50] (test)  loss: 0.5767 -> 0.5235   acc: 81.51% -> 82.63%             
client [35] (test)  loss: 0.3473 -> 0.3690   acc: 88.43% -> 88.81%             
client [24] (test)  loss: 0.3147 -> 0.2777   acc: 87.91% -> 91.94%             
client [15] (test)  loss: 0.3513 -> 0.3164   acc: 88.64% -> 89.47%             
client [58] (test)  loss: 0.3366 -> 0.2095   acc: 89.27% -> 91.62%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.2842 -> 0.2217   acc: 89.76% -> 92.65%             
client [76] (test)  loss: 0.2573 -> 0.2693   acc: 91.65% -> 92.29%             
client [67] (test)  loss: 0.2763 -> 0.3240   acc: 92.70% -> 92.95%             
client [37] (test)  loss: 0.3256 -> 0.2547   acc: 90.22% -> 91.90%             
client [58] (test)  loss: 0.3318 -> 0.2102   acc: 90.05% -> 91.62%             
client [64] (test)  loss: 0.5655 -> 0.4339   acc: 84.14% -> 85.55%             
client [77] (test)  loss: 0.3072 -> 0.3192   acc: 88.21% -> 86.79%             
client [55] (test)  loss: 0.4678 -> 0.4816   acc: 85.13% -> 87.08%             
client [12] (test)  loss: 0.5132 -> 0.4401   acc: 83.64% -> 80.45%             
client [89] (test)  loss: 0.4788 -> 0.3622   acc: 88.10% -> 90.03%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.3490 -> 0.3293   acc: 89.86% -> 88.99%             
client [51] (test)  loss: 0.3785 -> 0.3266   acc: 85.59% -> 87.99%             
client [8] (test)  loss: 0.3039 -> 0.3672   acc: 90.00% -> 88.39%              
client [18] (test)  loss: 0.2856 -> 0.2822   acc: 92.10% -> 93.01%             
client [94] (test)  loss: 0.4415 -> 0.5211   acc: 84.71% -> 84.92%             
client [81] (test)  loss: 0.5726 -> 0.4982   acc: 79.27% -> 80.39%             
client [3] (test)  loss: 0.3146 -> 0.3336   acc: 88.98% -> 89.81%              
client [11] (test)  loss: 0.3652 -> 0.3901   acc: 88.77% -> 86.59%             
client [95] (test)  loss: 0.2860 -> 0.2868   acc: 91.27% -> 89.58%             
client [67] (test)  loss: 0.2742 -> 0.3260   acc: 92.44% -> 92.70%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.3603 -> 0.3493   acc: 89.72% -> 90.83%             
client [79] (test)  loss: 0.4929 -> 0.4548   acc: 81.77% -> 82.60%             
client [58] (test)  loss: 0.3507 -> 0.2087   acc: 90.05% -> 92.15%             
client [88] (test)  loss: 0.5529 -> 0.4864   acc: 82.64% -> 82.64%             
client [46] (test)  loss: 0.2936 -> 0.3144   acc: 90.67% -> 90.38%             
client [11] (test)  loss: 0.3706 -> 0.3966   acc: 88.77% -> 85.87%             
client [55] (test)  loss: 0.4527 -> 0.4914   acc: 85.13% -> 87.67%             
client [13] (test)  loss: 0.2513 -> 0.2593   acc: 91.86% -> 91.60%             
client [31] (test)  loss: 0.6094 -> 0.5593   acc: 80.12% -> 79.72%             
client [75] (test)  loss: 0.2374 -> 0.2575   acc: 92.02% -> 91.41%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.2036 -> 0.1608   acc: 92.41% -> 93.10%             
client [7] (test)  loss: 0.3903 -> 0.4342   acc: 87.22% -> 88.06%              
client [57] (test)  loss: 0.3160 -> 0.3335   acc: 90.97% -> 91.70%             
client [13] (test)  loss: 0.2497 -> 0.2593   acc: 91.34% -> 91.60%             
client [43] (test)  loss: 0.1748 -> 0.1772   acc: 93.55% -> 95.70%             
client [91] (test)  loss: 0.4861 -> 0.3971   acc: 82.37% -> 87.11%             
client [10] (test)  loss: 0.2885 -> 0.2985   acc: 91.39% -> 91.67%             
client [64] (test)  loss: 0.4712 -> 0.4444   acc: 86.12% -> 85.84%             
client [82] (test)  loss: 0.2295 -> 0.2808   acc: 93.03% -> 90.55%             
client [22] (test)  loss: 0.4029 -> 0.4305   acc: 86.13% -> 86.77%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.4094 -> 0.4511   acc: 86.62% -> 85.67%             
client [23] (test)  loss: 0.4020 -> 0.2730   acc: 88.96% -> 94.27%             
client [88] (test)  loss: 0.5470 -> 0.4846   acc: 82.37% -> 82.92%             
client [98] (test)  loss: 0.4212 -> 0.4604   acc: 86.39% -> 84.72%             
client [79] (test)  loss: 0.4893 -> 0.4567   acc: 81.49% -> 83.15%             
client [21] (test)  loss: 0.3484 -> 0.3540   acc: 90.28% -> 91.11%             
client [92] (test)  loss: 0.5549 -> 0.5066   acc: 83.56% -> 83.83%             
client [56] (test)  loss: 0.3809 -> 0.4046   acc: 88.44% -> 88.75%             
client [5] (test)  loss: 0.3923 -> 0.3994   acc: 86.59% -> 88.12%              
client [52] (test)  loss: 0.4497 -> 0.4446   acc: 83.93% -> 85.32%             
==================== pFedSim_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.4822 -> 0.0000', 'accuracy': '84.16% -> 0.00%'},          
    200: {'loss': '0.3596 -> 0.0000', 'accuracy': '88.72% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_1 achieved 10.0%(16.06%) at epoch: 1                                   
pFedSim_1 achieved 20.0%(22.12%) at epoch: 2                                   
pFedSim_1 achieved 30.0%(33.22%) at epoch: 3                                   
pFedSim_1 achieved 50.0%(50.39%) at epoch: 4                                   
pFedSim_1 achieved 70.0%(71.14%) at epoch: 7                                   
pFedSim_1 achieved 80.0%(80.49%) at epoch: 28                                  
pFedSim_1 achieved 90.0%(90.43%) at epoch: 154                                 
Convergence (test_after):                                                      
pFedSim_1 achieved 50.0%(53.09%) at epoch: 0                                   
pFedSim_1 achieved 70.0%(71.93%) at epoch: 2                                   
pFedSim_1 achieved 80.0%(81.50%) at epoch: 8                                   
pFedSim_1 achieved 90.0%(91.29%) at epoch: 56                                  
