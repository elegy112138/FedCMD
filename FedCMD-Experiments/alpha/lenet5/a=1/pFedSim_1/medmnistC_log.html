==================== ALGORITHM: pFedSim_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.9525 -> 1.4842   acc: 35.48% -> 43.55%             
client [81] (test)  loss: 2.3189 -> 1.5914   acc: 8.20% -> 49.18%              
client [21] (test)  loss: 2.1173 -> 1.4218   acc: 47.06% -> 53.78%             
client [68] (test)  loss: 1.7308 -> 1.2601   acc: 49.49% -> 51.52%             
client [93] (test)  loss: 1.7064 -> 0.8569   acc: 67.50% -> 74.17%             
client [31] (test)  loss: 2.4356 -> 1.9592   acc: 14.10% -> 46.15%             
client [20] (test)  loss: 1.7872 -> 1.4474   acc: 25.90% -> 46.76%             
client [59] (test)  loss: 2.2793 -> 1.6791   acc: 31.50% -> 38.58%             
client [48] (test)  loss: 1.9675 -> 1.7383   acc: 30.91% -> 43.64%             
client [34] (test)  loss: 1.8126 -> 1.5062   acc: 45.77% -> 50.00%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4431 -> 1.0643   acc: 59.82% -> 63.39%             
client [99] (test)  loss: 1.8731 -> 1.2352   acc: 46.59% -> 57.95%             
client [67] (test)  loss: 1.6944 -> 1.1616   acc: 43.65% -> 60.32%             
client [0] (test)  loss: 1.4383 -> 0.8321   acc: 54.91% -> 76.30%              
client [76] (test)  loss: 1.2849 -> 0.8178   acc: 69.62% -> 75.95%             
client [41] (test)  loss: 1.6500 -> 0.9407   acc: 50.00% -> 71.31%             
client [62] (test)  loss: 2.0867 -> 1.2796   acc: 21.13% -> 59.15%             
client [2] (test)  loss: 2.3147 -> 0.6930   acc: 10.34% -> 84.83%              
client [14] (test)  loss: 1.1688 -> 0.8404   acc: 71.65% -> 74.80%             
client [46] (test)  loss: 1.7924 -> 1.0759   acc: 35.90% -> 66.67%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.2163 -> 0.8871   acc: 64.29% -> 67.86%             
client [68] (test)  loss: 1.0622 -> 0.5318   acc: 61.62% -> 82.83%             
client [57] (test)  loss: 1.3677 -> 0.6814   acc: 43.86% -> 83.63%             
client [17] (test)  loss: 1.2425 -> 1.2800   acc: 58.65% -> 61.54%             
client [54] (test)  loss: 1.5015 -> 1.3069   acc: 48.65% -> 47.30%             
client [23] (test)  loss: 2.3626 -> 1.0815   acc: 17.57% -> 64.86%             
client [35] (test)  loss: 1.2731 -> 0.6800   acc: 58.33% -> 80.95%             
client [59] (test)  loss: 1.1048 -> 0.8642   acc: 64.57% -> 63.78%             
client [31] (test)  loss: 1.5763 -> 1.1774   acc: 30.77% -> 66.67%             
client [9] (test)  loss: 1.3470 -> 0.7917   acc: 62.89% -> 77.32%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9713 -> 0.6225   acc: 66.40% -> 77.60%             
client [33] (test)  loss: 1.0507 -> 0.6811   acc: 66.36% -> 73.83%             
client [16] (test)  loss: 0.9700 -> 0.7037   acc: 70.83% -> 73.61%             
client [44] (test)  loss: 1.4549 -> 0.5820   acc: 49.63% -> 82.22%             
client [8] (test)  loss: 1.0547 -> 0.4550   acc: 70.83% -> 82.64%              
client [31] (test)  loss: 1.6320 -> 1.0417   acc: 46.15% -> 73.08%             
client [47] (test)  loss: 0.8057 -> 0.4947   acc: 73.95% -> 84.03%             
client [36] (test)  loss: 1.4525 -> 0.8430   acc: 46.15% -> 68.38%             
client [20] (test)  loss: 1.2040 -> 0.7606   acc: 56.83% -> 72.66%             
client [56] (test)  loss: 0.9616 -> 0.6232   acc: 69.23% -> 78.63%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5725 -> 0.5282   acc: 81.90% -> 83.62%              
client [60] (test)  loss: 1.2933 -> 0.8266   acc: 55.26% -> 75.00%             
client [28] (test)  loss: 0.8255 -> 0.4213   acc: 73.39% -> 82.26%             
client [25] (test)  loss: 1.2358 -> 0.6540   acc: 60.33% -> 78.51%             
client [58] (test)  loss: 0.5223 -> 0.4136   acc: 80.62% -> 87.50%             
client [44] (test)  loss: 0.6059 -> 0.4929   acc: 81.48% -> 83.70%             
client [39] (test)  loss: 0.7136 -> 0.2387   acc: 77.14% -> 93.57%             
client [29] (test)  loss: 0.9199 -> 0.5235   acc: 69.75% -> 84.03%             
client [3] (test)  loss: 1.0336 -> 0.7490   acc: 58.47% -> 73.73%              
client [84] (test)  loss: 0.8836 -> 0.2488   acc: 70.55% -> 94.48%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8907 -> 0.4442   acc: 72.27% -> 89.08%             
client [84] (test)  loss: 0.6081 -> 0.2095   acc: 82.21% -> 95.09%             
client [10] (test)  loss: 0.9096 -> 0.5309   acc: 76.92% -> 79.49%             
client [36] (test)  loss: 1.2822 -> 0.5363   acc: 58.97% -> 81.20%             
client [65] (test)  loss: 1.0732 -> 0.8360   acc: 61.02% -> 66.10%             
client [81] (test)  loss: 1.1613 -> 0.5375   acc: 61.48% -> 79.51%             
client [79] (test)  loss: 0.7635 -> 0.5258   acc: 76.92% -> 78.63%             
client [42] (test)  loss: 0.6184 -> 0.4049   acc: 80.47% -> 87.50%             
client [11] (test)  loss: 0.8826 -> 0.5160   acc: 68.94% -> 84.85%             
client [96] (test)  loss: 0.5912 -> 0.5620   acc: 80.67% -> 77.31%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7518 -> 0.3774   acc: 79.86% -> 86.11%              
client [53] (test)  loss: 0.4350 -> 0.3131   acc: 85.71% -> 87.39%             
client [52] (test)  loss: 0.8683 -> 0.3845   acc: 71.32% -> 89.15%             
client [42] (test)  loss: 0.5522 -> 0.3637   acc: 82.03% -> 89.84%             
client [69] (test)  loss: 0.8687 -> 0.5921   acc: 74.11% -> 77.68%             
client [59] (test)  loss: 0.7933 -> 0.6266   acc: 74.02% -> 77.95%             
client [7] (test)  loss: 0.8620 -> 0.4973   acc: 69.63% -> 82.22%              
client [26] (test)  loss: 0.5671 -> 0.4778   acc: 80.77% -> 86.15%             
client [49] (test)  loss: 0.3658 -> 0.2907   acc: 88.24% -> 91.18%             
client [98] (test)  loss: 0.6651 -> 0.6271   acc: 79.82% -> 79.82%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6881 -> 0.6170   acc: 78.07% -> 80.70%             
client [47] (test)  loss: 0.5939 -> 0.3684   acc: 84.87% -> 84.87%             
client [21] (test)  loss: 0.6831 -> 0.4302   acc: 84.87% -> 91.60%             
client [77] (test)  loss: 0.6768 -> 0.5375   acc: 76.61% -> 80.65%             
client [95] (test)  loss: 1.0120 -> 0.3451   acc: 65.36% -> 87.71%             
client [91] (test)  loss: 0.7057 -> 0.5067   acc: 71.43% -> 84.13%             
client [14] (test)  loss: 0.4369 -> 0.3017   acc: 82.68% -> 89.76%             
client [99] (test)  loss: 0.7575 -> 0.5221   acc: 72.73% -> 86.36%             
client [20] (test)  loss: 1.3575 -> 0.5447   acc: 59.71% -> 82.73%             
client [39] (test)  loss: 0.2902 -> 0.1874   acc: 92.86% -> 95.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1714 -> 0.3684   acc: 64.34% -> 90.70%             
client [62] (test)  loss: 0.6249 -> 0.3209   acc: 80.28% -> 90.14%             
client [71] (test)  loss: 0.7564 -> 0.6379   acc: 71.76% -> 73.28%             
client [97] (test)  loss: 0.5217 -> 0.2920   acc: 82.55% -> 90.60%             
client [30] (test)  loss: 0.6049 -> 0.4652   acc: 81.89% -> 85.04%             
client [88] (test)  loss: 0.7249 -> 0.4370   acc: 74.26% -> 84.56%             
client [60] (test)  loss: 0.5519 -> 0.5470   acc: 78.95% -> 80.26%             
client [82] (test)  loss: 0.3824 -> 0.2628   acc: 88.52% -> 91.80%             
client [91] (test)  loss: 0.6459 -> 0.4828   acc: 71.43% -> 82.54%             
client [57] (test)  loss: 0.3997 -> 0.3543   acc: 87.13% -> 91.81%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2653 -> 0.8466   acc: 58.97% -> 75.64%             
client [15] (test)  loss: 1.0523 -> 0.3922   acc: 70.23% -> 87.02%             
client [71] (test)  loss: 0.8572 -> 0.6435   acc: 73.28% -> 74.81%             
client [97] (test)  loss: 0.3664 -> 0.2971   acc: 88.59% -> 89.93%             
client [53] (test)  loss: 0.3897 -> 0.2677   acc: 88.24% -> 89.08%             
client [77] (test)  loss: 0.6015 -> 0.5150   acc: 75.81% -> 81.45%             
client [76] (test)  loss: 0.5131 -> 0.4266   acc: 87.34% -> 89.87%             
client [79] (test)  loss: 0.8051 -> 0.4623   acc: 79.49% -> 82.91%             
client [28] (test)  loss: 0.5439 -> 0.3090   acc: 80.65% -> 87.10%             
client [99] (test)  loss: 0.5262 -> 0.5111   acc: 86.36% -> 84.09%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.4329 -> 0.2906   acc: 85.91% -> 89.93%             
client [86] (test)  loss: 0.4242 -> 0.2751   acc: 88.62% -> 91.87%             
client [34] (test)  loss: 0.4509 -> 0.4992   acc: 86.62% -> 83.10%             
client [73] (test)  loss: 0.6147 -> 0.5870   acc: 78.40% -> 77.60%             
client [5] (test)  loss: 0.6938 -> 0.6378   acc: 76.19% -> 76.19%              
client [96] (test)  loss: 0.4540 -> 0.4824   acc: 83.19% -> 83.19%             
client [22] (test)  loss: 0.4773 -> 0.4909   acc: 85.98% -> 79.44%             
client [60] (test)  loss: 0.4516 -> 0.4904   acc: 84.21% -> 81.58%             
client [66] (test)  loss: 0.6758 -> 0.5155   acc: 79.03% -> 83.87%             
client [83] (test)  loss: 0.4914 -> 0.2931   acc: 86.73% -> 90.27%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.3949 -> 0.4008   acc: 91.14% -> 89.87%             
client [65] (test)  loss: 0.9299 -> 0.6811   acc: 68.64% -> 74.58%             
client [95] (test)  loss: 0.4370 -> 0.3472   acc: 85.47% -> 88.27%             
client [17] (test)  loss: 1.3362 -> 0.5700   acc: 62.50% -> 81.73%             
client [8] (test)  loss: 0.5718 -> 0.3536   acc: 82.64% -> 86.11%              
client [35] (test)  loss: 0.2518 -> 0.1805   acc: 89.29% -> 94.05%             
client [98] (test)  loss: 0.5148 -> 0.5512   acc: 83.33% -> 82.46%             
client [53] (test)  loss: 0.3357 -> 0.2491   acc: 89.08% -> 89.92%             
client [43] (test)  loss: 0.5155 -> 0.2914   acc: 81.82% -> 93.30%             
client [64] (test)  loss: 0.4338 -> 0.3045   acc: 88.80% -> 91.20%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.4541 -> 0.4393   acc: 90.76% -> 91.60%             
client [88] (test)  loss: 0.4268 -> 0.4454   acc: 85.29% -> 82.35%             
client [38] (test)  loss: 0.5157 -> 0.5508   acc: 80.95% -> 82.14%             
client [3] (test)  loss: 0.6434 -> 0.5477   acc: 76.27% -> 77.12%              
client [5] (test)  loss: 0.5881 -> 0.6244   acc: 79.05% -> 77.14%              
client [41] (test)  loss: 0.3108 -> 0.3705   acc: 88.52% -> 85.25%             
client [7] (test)  loss: 0.4988 -> 0.4168   acc: 82.22% -> 86.67%              
client [37] (test)  loss: 0.4690 -> 0.4138   acc: 86.32% -> 87.26%             
client [45] (test)  loss: 0.4391 -> 0.2659   acc: 83.84% -> 92.93%             
client [47] (test)  loss: 0.5829 -> 0.4224   acc: 85.71% -> 84.87%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.4185 -> 0.4805   acc: 87.50% -> 84.72%             
client [11] (test)  loss: 0.4730 -> 0.4494   acc: 84.85% -> 86.36%             
client [37] (test)  loss: 0.4496 -> 0.4257   acc: 85.85% -> 87.74%             
client [41] (test)  loss: 0.3124 -> 0.3707   acc: 88.52% -> 85.25%             
client [95] (test)  loss: 0.3362 -> 0.3676   acc: 86.59% -> 87.71%             
client [53] (test)  loss: 0.3702 -> 0.2515   acc: 87.39% -> 89.92%             
client [22] (test)  loss: 0.4551 -> 0.4949   acc: 85.98% -> 79.44%             
client [25] (test)  loss: 0.5213 -> 0.3991   acc: 83.47% -> 87.60%             
client [69] (test)  loss: 0.7109 -> 0.5210   acc: 74.11% -> 80.36%             
client [46] (test)  loss: 0.4344 -> 0.4102   acc: 84.62% -> 85.47%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.3661 -> 0.3661   acc: 87.39% -> 84.87%             
client [69] (test)  loss: 0.6859 -> 0.5267   acc: 76.79% -> 80.36%             
client [82] (test)  loss: 0.3257 -> 0.2344   acc: 88.52% -> 95.08%             
client [45] (test)  loss: 0.3740 -> 0.2616   acc: 86.87% -> 92.93%             
client [7] (test)  loss: 0.4792 -> 0.4235   acc: 84.44% -> 86.67%              
client [50] (test)  loss: 0.2216 -> 0.1264   acc: 91.85% -> 96.30%             
client [35] (test)  loss: 0.1633 -> 0.1656   acc: 94.05% -> 94.05%             
client [24] (test)  loss: 0.4422 -> 0.3980   acc: 78.57% -> 82.14%             
client [15] (test)  loss: 0.5682 -> 0.4016   acc: 83.21% -> 86.26%             
client [58] (test)  loss: 0.2952 -> 0.2656   acc: 90.62% -> 91.88%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.5190 -> 0.5078   acc: 80.00% -> 83.64%             
client [76] (test)  loss: 0.3941 -> 0.3976   acc: 91.14% -> 89.87%             
client [67] (test)  loss: 0.3897 -> 0.4177   acc: 87.30% -> 84.13%             
client [37] (test)  loss: 0.4674 -> 0.4294   acc: 85.85% -> 87.74%             
client [58] (test)  loss: 0.2952 -> 0.2627   acc: 90.62% -> 92.50%             
client [64] (test)  loss: 0.3952 -> 0.2895   acc: 88.00% -> 91.20%             
client [77] (test)  loss: 0.5458 -> 0.5105   acc: 75.81% -> 80.65%             
client [55] (test)  loss: 0.3579 -> 0.4269   acc: 88.10% -> 85.71%             
client [12] (test)  loss: 0.7011 -> 0.7967   acc: 77.14% -> 81.43%             
client [89] (test)  loss: 0.5202 -> 0.5448   acc: 84.78% -> 84.06%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.2501 -> 0.1513   acc: 92.64% -> 95.71%             
client [51] (test)  loss: 0.3427 -> 0.2988   acc: 87.74% -> 89.03%             
client [8] (test)  loss: 0.4586 -> 0.3467   acc: 84.03% -> 86.81%              
client [18] (test)  loss: 0.6849 -> 0.6734   acc: 78.35% -> 77.32%             
client [94] (test)  loss: 0.2613 -> 0.2509   acc: 91.67% -> 92.50%             
client [81] (test)  loss: 0.4224 -> 0.4166   acc: 84.43% -> 86.07%             
client [3] (test)  loss: 0.6612 -> 0.5585   acc: 76.27% -> 77.12%              
client [11] (test)  loss: 0.4819 -> 0.4525   acc: 87.12% -> 87.12%             
client [95] (test)  loss: 0.3290 -> 0.3959   acc: 88.27% -> 87.71%             
client [67] (test)  loss: 0.3867 -> 0.4178   acc: 86.51% -> 83.33%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.4285 -> 0.4297   acc: 91.60% -> 91.60%             
client [79] (test)  loss: 0.6163 -> 0.4614   acc: 83.76% -> 85.47%             
client [58] (test)  loss: 0.3018 -> 0.2607   acc: 90.62% -> 92.50%             
client [88] (test)  loss: 0.4189 -> 0.4493   acc: 83.09% -> 83.09%             
client [46] (test)  loss: 0.3874 -> 0.4015   acc: 84.62% -> 85.47%             
client [11] (test)  loss: 0.4868 -> 0.4509   acc: 87.12% -> 87.12%             
client [55] (test)  loss: 0.3449 -> 0.4283   acc: 90.48% -> 86.51%             
client [13] (test)  loss: 0.5633 -> 0.4411   acc: 81.71% -> 82.93%             
client [31] (test)  loss: 0.9110 -> 0.7085   acc: 66.67% -> 78.21%             
client [75] (test)  loss: 0.7218 -> 0.4624   acc: 77.31% -> 86.55%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.3825 -> 0.3888   acc: 88.24% -> 88.24%             
client [7] (test)  loss: 0.4830 -> 0.4470   acc: 83.70% -> 86.67%              
client [57] (test)  loss: 0.3169 -> 0.3501   acc: 91.23% -> 90.64%             
client [13] (test)  loss: 0.5582 -> 0.4377   acc: 80.49% -> 82.93%             
client [43] (test)  loss: 0.2646 -> 0.3204   acc: 94.26% -> 92.82%             
client [91] (test)  loss: 0.4464 -> 0.4605   acc: 85.71% -> 85.71%             
client [10] (test)  loss: 0.4175 -> 0.2746   acc: 94.87% -> 92.31%             
client [64] (test)  loss: 0.3796 -> 0.2869   acc: 84.80% -> 91.20%             
client [82] (test)  loss: 0.3049 -> 0.2277   acc: 89.34% -> 95.90%             
client [22] (test)  loss: 0.4253 -> 0.5110   acc: 87.85% -> 80.37%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.6079 -> 0.5427   acc: 79.86% -> 82.73%             
client [23] (test)  loss: 0.4777 -> 0.4082   acc: 78.38% -> 81.08%             
client [88] (test)  loss: 0.4135 -> 0.4473   acc: 83.82% -> 83.09%             
client [98] (test)  loss: 0.4294 -> 0.5474   acc: 84.21% -> 81.58%             
client [79] (test)  loss: 0.6216 -> 0.4581   acc: 84.62% -> 84.62%             
client [21] (test)  loss: 0.4202 -> 0.4273   acc: 91.60% -> 91.60%             
client [92] (test)  loss: 0.3837 -> 0.3727   acc: 86.15% -> 84.62%             
client [56] (test)  loss: 0.3387 -> 0.3387   acc: 91.45% -> 88.03%             
client [5] (test)  loss: 0.5496 -> 0.6379   acc: 79.05% -> 77.14%              
client [52] (test)  loss: 0.3338 -> 0.3769   acc: 91.47% -> 89.92%             
==================== pFedSim_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.6252 -> 0.0000', 'accuracy': '80.21% -> 0.00%'},          
    200: {'loss': '0.4088 -> 0.0000', 'accuracy': '86.70% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_1 achieved 10.0%(12.38%) at epoch: 0                                   
pFedSim_1 achieved 20.0%(23.56%) at epoch: 2                                   
pFedSim_1 achieved 30.0%(30.97%) at epoch: 6                                   
pFedSim_1 achieved 40.0%(41.05%) at epoch: 11                                  
pFedSim_1 achieved 50.0%(51.50%) at epoch: 16                                  
pFedSim_1 achieved 60.0%(61.40%) at epoch: 28                                  
pFedSim_1 achieved 70.0%(70.77%) at epoch: 44                                  
pFedSim_1 achieved 80.0%(80.88%) at epoch: 75                                  
pFedSim_1 achieved 90.0%(90.78%) at epoch: 180                                 
Convergence (test_after):                                                      
pFedSim_1 achieved 30.0%(34.47%) at epoch: 0                                   
pFedSim_1 achieved 40.0%(40.36%) at epoch: 3                                   
pFedSim_1 achieved 50.0%(51.03%) at epoch: 6                                   
pFedSim_1 achieved 60.0%(62.05%) at epoch: 13                                  
pFedSim_1 achieved 70.0%(70.26%) at epoch: 19                                  
pFedSim_1 achieved 80.0%(80.56%) at epoch: 31                                  
pFedSim_1 achieved 90.0%(90.12%) at epoch: 150                                 
