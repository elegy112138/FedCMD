==================== ALGORITHM: pFedSim_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5416 -> 4.3766   acc: 0.33% -> 6.25%               
client [81] (test)  loss: 4.5264 -> 4.3674   acc: 3.99% -> 7.31%               
client [21] (test)  loss: 53.3324 -> 4.4790   acc: 1.33% -> 2.33%              
client [68] (test)  loss: 4.5627 -> 4.3855   acc: 1.32% -> 5.96%               
client [93] (test)  loss: 4.5501 -> 4.4047   acc: 1.62% -> 6.82%               
client [31] (test)  loss: 4.6566 -> 4.4645   acc: 1.05% -> 5.23%               
client [20] (test)  loss: 4.6500 -> 4.4732   acc: 0.35% -> 3.82%               
client [59] (test)  loss: 49.4456 -> 4.3024   acc: 0.91% -> 6.99%              
client [48] (test)  loss: 4.5102 -> 4.4264   acc: 3.96% -> 3.30%               
client [34] (test)  loss: 4.5550 -> 4.3549   acc: 0.90% -> 10.51%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.5216 -> 3.9119   acc: 1.65% -> 10.89%              
client [99] (test)  loss: 4.4195 -> 4.6416   acc: 5.36% -> 3.79%               
client [67] (test)  loss: 4.3724 -> 3.9692   acc: 3.99% -> 10.30%              
client [0] (test)  loss: 4.4542 -> 4.1154   acc: 2.99% -> 8.31%                
client [76] (test)  loss: 4.4596 -> 4.1248   acc: 2.87% -> 7.53%               
client [41] (test)  loss: 4.5126 -> 3.9804   acc: 1.63% -> 7.82%               
client [62] (test)  loss: 138.5057 -> 4.0585   acc: 1.45% -> 10.51%            
client [2] (test)  loss: 133.9180 -> 3.9389   acc: 0.97% -> 6.47%              
client [14] (test)  loss: 4.3964 -> 4.1664   acc: 3.53% -> 7.42%               
client [46] (test)  loss: 4.4784 -> 4.4516   acc: 2.60% -> 6.49%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1136 -> 4.2523   acc: 11.15% -> 4.73%              
client [68] (test)  loss: 4.3734 -> 3.8776   acc: 4.97% -> 12.91%              
client [57] (test)  loss: 4.1895 -> 4.1302   acc: 5.88% -> 6.21%               
client [17] (test)  loss: 4.3267 -> 3.9695   acc: 5.16% -> 8.39%               
client [54] (test)  loss: 4.3580 -> 3.8713   acc: 7.14% -> 15.36%              
client [23] (test)  loss: 365.4154 -> 3.8705   acc: 0.33% -> 6.67%             
client [35] (test)  loss: 4.1290 -> 4.0478   acc: 5.25% -> 7.87%               
client [59] (test)  loss: 4.2103 -> 3.8751   acc: 5.17% -> 9.42%               
client [31] (test)  loss: 4.0877 -> 3.8365   acc: 8.36% -> 9.76%               
client [9] (test)  loss: 4.2320 -> 4.0573   acc: 7.62% -> 7.28%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.4627 -> 4.1783   acc: 3.63% -> 9.57%               
client [33] (test)  loss: 4.0488 -> 3.8425   acc: 8.14% -> 13.68%              
client [16] (test)  loss: 4.1410 -> 3.9651   acc: 7.32% -> 9.06%               
client [44] (test)  loss: 4.8840 -> 3.8856   acc: 1.64% -> 14.43%              
client [8] (test)  loss: 4.4594 -> 4.1528   acc: 3.04% -> 6.08%                
client [31] (test)  loss: 4.2344 -> 3.7733   acc: 5.92% -> 10.80%              
client [47] (test)  loss: 4.4815 -> 5.1826   acc: 3.61% -> 6.56%               
client [36] (test)  loss: 4.1654 -> 3.9556   acc: 8.97% -> 14.29%              
client [20] (test)  loss: 4.0451 -> 3.6413   acc: 7.64% -> 15.28%              
client [56] (test)  loss: 4.1220 -> 4.4732   acc: 7.56% -> 2.41%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0938 -> 5.4489   acc: 7.89% -> 5.92%                
client [60] (test)  loss: 5.7580 -> 3.7547   acc: 2.27% -> 12.66%              
client [28] (test)  loss: 5.0554 -> 3.6381   acc: 5.30% -> 15.23%              
client [25] (test)  loss: 5.3913 -> 4.0653   acc: 5.17% -> 12.07%              
client [58] (test)  loss: 4.2398 -> 3.5786   acc: 5.47% -> 17.19%              
client [44] (test)  loss: 4.3820 -> 3.8071   acc: 7.54% -> 14.75%              
client [39] (test)  loss: 3.6883 -> 3.6268   acc: 15.00% -> 15.33%             
client [29] (test)  loss: 4.6184 -> 3.7206   acc: 10.93% -> 15.23%             
client [3] (test)  loss: 4.1175 -> 4.0328   acc: 7.84% -> 11.76%               
client [84] (test)  loss: 4.0982 -> 3.6698   acc: 8.82% -> 11.76%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.7781 -> 3.7543   acc: 5.98% -> 11.63%              
client [84] (test)  loss: 3.9791 -> 4.2026   acc: 12.09% -> 9.48%              
client [10] (test)  loss: 4.8796 -> 4.2813   acc: 5.61% -> 8.58%               
client [36] (test)  loss: 3.7486 -> 3.9972   acc: 12.62% -> 15.28%             
client [65] (test)  loss: 4.3380 -> 3.9054   acc: 7.26% -> 8.91%               
client [81] (test)  loss: 3.9168 -> 3.6255   acc: 10.30% -> 13.95%             
client [79] (test)  loss: 4.3796 -> 3.9937   acc: 5.57% -> 10.16%              
client [42] (test)  loss: 4.2532 -> 3.6152   acc: 4.97% -> 18.21%              
client [11] (test)  loss: 4.4901 -> 3.7106   acc: 3.36% -> 11.74%              
client [96] (test)  loss: 5.3562 -> 3.6797   acc: 4.00% -> 10.55%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.4492 -> 4.0345   acc: 8.11% -> 10.14%               
client [53] (test)  loss: 3.8864 -> 3.7273   acc: 11.40% -> 13.36%             
client [52] (test)  loss: 4.3964 -> 3.6560   acc: 7.79% -> 20.78%              
client [42] (test)  loss: 4.0485 -> 3.6022   acc: 8.28% -> 17.88%              
client [69] (test)  loss: 3.9846 -> 3.4445   acc: 11.22% -> 18.15%             
client [59] (test)  loss: 4.1476 -> 3.9418   acc: 10.94% -> 10.94%             
client [7] (test)  loss: 5.2149 -> 3.5276   acc: 6.54% -> 16.34%               
client [26] (test)  loss: 3.8626 -> 3.5606   acc: 10.60% -> 19.54%             
client [49] (test)  loss: 3.6738 -> 3.7226   acc: 13.77% -> 14.75%             
client [98] (test)  loss: 3.7882 -> 3.6193   acc: 12.62% -> 15.86%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.2401 -> 3.5569   acc: 10.68% -> 16.83%             
client [47] (test)  loss: 4.4521 -> 4.8398   acc: 9.51% -> 7.87%               
client [21] (test)  loss: 4.1083 -> 3.5058   acc: 11.96% -> 19.27%             
client [77] (test)  loss: 3.8476 -> 4.0079   acc: 11.84% -> 9.87%              
client [95] (test)  loss: 3.7936 -> 3.7872   acc: 11.82% -> 14.53%             
client [91] (test)  loss: 3.7511 -> 3.5237   acc: 16.78% -> 19.74%             
client [14] (test)  loss: 3.7514 -> 3.9862   acc: 19.79% -> 12.72%             
client [99] (test)  loss: 4.0029 -> 3.4070   acc: 9.78% -> 18.61%              
client [20] (test)  loss: 3.8962 -> 3.3904   acc: 13.19% -> 19.79%             
client [39] (test)  loss: 3.7844 -> 4.1314   acc: 14.67% -> 9.67%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.3674 -> 3.5086   acc: 11.04% -> 20.45%             
client [62] (test)  loss: 4.1370 -> 4.4721   acc: 9.42% -> 10.51%              
client [71] (test)  loss: 3.3291 -> 3.1915   acc: 18.15% -> 19.80%             
client [97] (test)  loss: 3.9154 -> 4.1415   acc: 16.56% -> 9.27%              
client [30] (test)  loss: 3.4425 -> 3.3711   acc: 19.47% -> 20.46%             
client [88] (test)  loss: 4.6201 -> 3.9045   acc: 4.32% -> 17.28%              
client [60] (test)  loss: 3.8331 -> 3.4353   acc: 15.58% -> 18.83%             
client [82] (test)  loss: 3.3565 -> 3.4656   acc: 19.87% -> 17.88%             
client [91] (test)  loss: 3.6962 -> 3.4370   acc: 15.13% -> 20.39%             
client [57] (test)  loss: 3.4095 -> 3.8809   acc: 19.28% -> 16.34%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.7121 -> 3.2865   acc: 14.98% -> 21.95%             
client [15] (test)  loss: 3.8292 -> 3.4506   acc: 17.11% -> 18.09%             
client [71] (test)  loss: 3.3748 -> 3.2486   acc: 19.47% -> 24.09%             
client [97] (test)  loss: 3.9583 -> 4.2018   acc: 10.60% -> 10.60%             
client [53] (test)  loss: 3.9139 -> 3.5994   acc: 12.38% -> 17.92%             
client [77] (test)  loss: 3.7058 -> 3.7417   acc: 16.12% -> 12.83%             
client [76] (test)  loss: 4.4396 -> 3.5178   acc: 6.45% -> 15.77%              
client [79] (test)  loss: 3.8633 -> 3.3953   acc: 12.13% -> 17.70%             
client [28] (test)  loss: 3.9435 -> 3.2463   acc: 11.92% -> 20.53%             
client [99] (test)  loss: 3.5559 -> 3.3280   acc: 17.98% -> 20.50%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 3.8862 -> 4.1841   acc: 11.92% -> 12.58%             
client [86] (test)  loss: 3.7539 -> 3.9329   acc: 15.05% -> 15.05%             
client [34] (test)  loss: 3.3130 -> 3.3926   acc: 23.72% -> 25.23%             
client [73] (test)  loss: 3.1536 -> 3.4514   acc: 23.93% -> 20.98%             
client [5] (test)  loss: 3.2642 -> 4.2757   acc: 19.41% -> 12.50%              
client [96] (test)  loss: 3.5422 -> 3.5226   acc: 18.18% -> 17.09%             
client [22] (test)  loss: 3.3102 -> 5.0922   acc: 20.85% -> 8.14%              
client [60] (test)  loss: 3.4867 -> 3.5435   acc: 19.81% -> 18.18%             
client [66] (test)  loss: 3.9497 -> 3.9131   acc: 16.77% -> 16.13%             
client [83] (test)  loss: 4.1415 -> 3.4300   acc: 11.88% -> 23.43%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 3.9791 -> 4.2970   acc: 11.83% -> 11.11%             
client [65] (test)  loss: 3.8271 -> 3.9485   acc: 12.87% -> 10.56%             
client [95] (test)  loss: 3.5813 -> 3.9717   acc: 17.57% -> 14.86%             
client [17] (test)  loss: 4.5483 -> 3.9752   acc: 10.32% -> 15.48%             
client [8] (test)  loss: 4.8473 -> 3.9224   acc: 9.46% -> 10.81%               
client [35] (test)  loss: 3.5333 -> 3.6420   acc: 17.05% -> 15.41%             
client [98] (test)  loss: 3.6399 -> 3.5225   acc: 18.45% -> 19.42%             
client [53] (test)  loss: 3.3536 -> 3.6708   acc: 20.20% -> 17.59%             
client [43] (test)  loss: 3.3833 -> 3.4058   acc: 19.47% -> 23.76%             
client [64] (test)  loss: 3.6896 -> 3.3225   acc: 15.84% -> 19.47%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 3.4146 -> 3.4710   acc: 19.60% -> 18.94%             
client [88] (test)  loss: 4.3113 -> 4.1586   acc: 12.96% -> 18.94%             
client [38] (test)  loss: 4.1679 -> 3.7261   acc: 14.47% -> 16.78%             
client [3] (test)  loss: 3.5762 -> 3.2972   acc: 20.26% -> 19.28%              
client [5] (test)  loss: 3.5294 -> 4.5047   acc: 17.76% -> 13.16%              
client [41] (test)  loss: 3.7199 -> 3.9227   acc: 20.52% -> 18.89%             
client [7] (test)  loss: 3.4444 -> 3.5149   acc: 21.24% -> 19.61%              
client [37] (test)  loss: 3.9064 -> 3.8633   acc: 21.85% -> 21.52%             
client [45] (test)  loss: 3.7045 -> 3.5987   acc: 15.56% -> 18.54%             
client [47] (test)  loss: 3.3716 -> 4.1283   acc: 20.00% -> 13.77%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 3.7621 -> 4.9139   acc: 13.94% -> 11.50%             
client [11] (test)  loss: 3.9063 -> 3.6836   acc: 14.77% -> 20.81%             
client [37] (test)  loss: 4.0840 -> 4.0751   acc: 21.52% -> 21.85%             
client [41] (test)  loss: 3.7825 -> 4.0840   acc: 18.89% -> 18.24%             
client [95] (test)  loss: 3.5252 -> 4.2637   acc: 18.24% -> 14.86%             
client [53] (test)  loss: 3.4567 -> 3.7609   acc: 20.20% -> 18.89%             
client [22] (test)  loss: 3.5983 -> 5.7190   acc: 15.64% -> 8.14%              
client [25] (test)  loss: 3.3390 -> 3.8205   acc: 19.31% -> 14.48%             
client [69] (test)  loss: 3.4549 -> 3.5943   acc: 25.08% -> 25.74%             
client [46] (test)  loss: 3.0703 -> 3.8491   acc: 30.84% -> 21.75%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 3.6750 -> 3.9377   acc: 19.02% -> 17.70%             
client [69] (test)  loss: 3.5563 -> 3.7366   acc: 24.42% -> 25.41%             
client [82] (test)  loss: 3.5296 -> 3.7152   acc: 19.87% -> 15.89%             
client [45] (test)  loss: 3.6877 -> 3.5989   acc: 20.86% -> 16.56%             
client [7] (test)  loss: 3.8125 -> 3.6392   acc: 18.30% -> 16.67%              
client [50] (test)  loss: 3.8051 -> 3.6678   acc: 16.85% -> 18.73%             
client [35] (test)  loss: 3.7917 -> 3.7933   acc: 15.41% -> 13.77%             
client [24] (test)  loss: 3.9627 -> 3.7486   acc: 14.53% -> 18.58%             
client [15] (test)  loss: 3.8305 -> 3.7697   acc: 20.07% -> 19.08%             
client [58] (test)  loss: 3.9376 -> 4.4977   acc: 21.48% -> 16.02%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 4.4956 -> 5.2324   acc: 12.54% -> 12.54%             
client [76] (test)  loss: 4.1703 -> 4.0113   acc: 12.19% -> 15.41%             
client [67] (test)  loss: 3.9030 -> 3.9293   acc: 14.95% -> 13.62%             
client [37] (test)  loss: 4.4011 -> 4.3146   acc: 20.53% -> 20.86%             
client [58] (test)  loss: 4.1103 -> 4.6323   acc: 21.48% -> 15.23%             
client [64] (test)  loss: 3.6437 -> 3.7513   acc: 17.49% -> 16.17%             
client [77] (test)  loss: 3.6903 -> 3.7690   acc: 21.71% -> 21.05%             
client [55] (test)  loss: 3.3756 -> 4.0893   acc: 24.26% -> 17.70%             
client [12] (test)  loss: 4.0869 -> 4.3667   acc: 16.50% -> 14.85%             
client [89] (test)  loss: 4.0208 -> 3.9556   acc: 14.84% -> 14.19%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 4.5530 -> 5.2599   acc: 11.11% -> 10.46%             
client [51] (test)  loss: 3.8914 -> 3.8824   acc: 22.85% -> 21.85%             
client [8] (test)  loss: 4.9731 -> 4.4413   acc: 11.15% -> 13.51%              
client [18] (test)  loss: 3.6677 -> 3.8833   acc: 19.28% -> 21.57%             
client [94] (test)  loss: 4.3488 -> 4.2110   acc: 16.67% -> 18.03%             
client [81] (test)  loss: 4.2549 -> 3.8457   acc: 14.29% -> 21.59%             
client [3] (test)  loss: 3.7369 -> 3.6111   acc: 16.99% -> 20.59%              
client [11] (test)  loss: 4.2543 -> 4.0973   acc: 14.77% -> 18.79%             
client [95] (test)  loss: 3.9590 -> 5.5976   acc: 16.22% -> 12.84%             
client [67] (test)  loss: 3.9477 -> 4.0259   acc: 13.62% -> 14.95%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 3.9412 -> 3.8420   acc: 17.28% -> 18.94%             
client [79] (test)  loss: 4.2667 -> 4.2509   acc: 16.39% -> 18.69%             
client [58] (test)  loss: 4.4232 -> 4.2541   acc: 21.88% -> 19.14%             
client [88] (test)  loss: 4.5301 -> 4.7821   acc: 16.28% -> 15.95%             
client [46] (test)  loss: 3.5432 -> 3.9080   acc: 26.95% -> 25.97%             
client [11] (test)  loss: 4.2813 -> 4.2562   acc: 16.11% -> 18.79%             
client [55] (test)  loss: 3.8055 -> 5.0060   acc: 21.64% -> 11.15%             
client [13] (test)  loss: 3.7948 -> 4.8226   acc: 16.56% -> 11.36%             
client [31] (test)  loss: 3.4736 -> 3.5605   acc: 20.91% -> 17.77%             
client [75] (test)  loss: 4.2593 -> 4.6162   acc: 22.37% -> 15.79%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 4.2940 -> 4.5328   acc: 17.67% -> 17.67%             
client [7] (test)  loss: 4.5228 -> 3.9407   acc: 16.67% -> 19.28%              
client [57] (test)  loss: 3.8932 -> 4.1987   acc: 17.97% -> 19.61%             
client [13] (test)  loss: 3.8938 -> 4.9521   acc: 16.88% -> 11.04%             
client [43] (test)  loss: 3.8698 -> 4.2075   acc: 21.45% -> 21.12%             
client [91] (test)  loss: 3.2058 -> 3.5249   acc: 30.59% -> 26.32%             
client [10] (test)  loss: 4.2350 -> 4.3857   acc: 13.86% -> 14.85%             
client [64] (test)  loss: 4.0282 -> 4.3108   acc: 13.86% -> 15.18%             
client [82] (test)  loss: 4.3101 -> 4.3675   acc: 15.89% -> 13.58%             
client [22] (test)  loss: 4.2023 -> 5.5563   acc: 13.36% -> 10.75%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 3.8833 -> 3.9407   acc: 21.53% -> 22.92%             
client [23] (test)  loss: 3.6707 -> 4.4456   acc: 19.00% -> 17.33%             
client [88] (test)  loss: 4.6555 -> 4.6512   acc: 15.95% -> 17.61%             
client [98] (test)  loss: 4.0224 -> 4.3638   acc: 22.65% -> 16.83%             
client [79] (test)  loss: 4.4319 -> 4.4709   acc: 15.41% -> 17.70%             
client [21] (test)  loss: 4.1728 -> 4.1248   acc: 14.29% -> 17.94%             
client [92] (test)  loss: 3.9476 -> 4.2301   acc: 20.00% -> 17.50%             
client [56] (test)  loss: 4.2735 -> 4.4701   acc: 16.84% -> 16.49%             
client [5] (test)  loss: 4.2114 -> 5.6857   acc: 18.42% -> 11.84%              
client [52] (test)  loss: 5.1040 -> 4.2384   acc: 14.61% -> 17.86%             
==================== pFedSim_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '3.8881 -> 0.0000', 'accuracy': '14.05% -> 0.00%'},          
    200: {'loss': '4.3604 -> 0.0000', 'accuracy': '17.12% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_1 achieved 10.0%(10.14%) at epoch: 69                                  
pFedSim_1 achieved 20.0%(20.50%) at epoch: 116                                 
Convergence (test_after):                                                      
pFedSim_1 achieved 10.0%(10.02%) at epoch: 27                                  
pFedSim_1 achieved 20.0%(20.41%) at epoch: 107                                 
