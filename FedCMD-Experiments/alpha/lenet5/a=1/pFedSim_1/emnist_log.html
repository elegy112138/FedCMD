==================== ALGORITHM: pFedSim_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5680 -> 0.3860   acc: 80.33% -> 87.38%             
client [81] (test)  loss: 0.8902 -> 0.5687   acc: 76.97% -> 82.83%             
client [21] (test)  loss: 159.2276 -> 0.5796   acc: 45.27% -> 80.63%           
client [68] (test)  loss: 0.8594 -> 0.4498   acc: 74.58% -> 85.43%             
client [93] (test)  loss: 1.0326 -> 0.6507   acc: 72.57% -> 79.14%             
client [31] (test)  loss: 1.9246 -> 0.5432   acc: 55.58% -> 82.71%             
client [20] (test)  loss: 0.5579 -> 0.4404   acc: 81.97% -> 85.64%             
client [59] (test)  loss: 57.3320 -> 0.3205   acc: 68.72% -> 89.60%            
client [48] (test)  loss: 0.9266 -> 0.6651   acc: 74.61% -> 76.20%             
client [34] (test)  loss: 1.0791 -> 0.5714   acc: 67.18% -> 81.37%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4034 -> 0.1980   acc: 74.49% -> 93.67%             
client [99] (test)  loss: 0.7926 -> 0.5292   acc: 78.17% -> 82.59%             
client [67] (test)  loss: 0.4728 -> 0.2546   acc: 83.94% -> 92.20%             
client [0] (test)  loss: 0.8816 -> 0.5238   acc: 75.17% -> 80.90%              
client [76] (test)  loss: 0.8360 -> 0.4722   acc: 77.89% -> 84.21%             
client [41] (test)  loss: 1.0464 -> 0.5864   acc: 72.26% -> 76.72%             
client [62] (test)  loss: 343.3022 -> 0.4144   acc: 32.83% -> 86.08%           
client [2] (test)  loss: 336.1884 -> 0.4786   acc: 36.24% -> 84.80%            
client [14] (test)  loss: 0.7930 -> 0.5107   acc: 78.01% -> 82.37%             
client [46] (test)  loss: 1.4573 -> 0.4852   acc: 62.66% -> 85.26%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5024 -> 0.4297   acc: 81.66% -> 83.47%             
client [68] (test)  loss: 0.5496 -> 0.3693   acc: 82.42% -> 87.69%             
client [57] (test)  loss: 0.4195 -> 0.2299   acc: 86.55% -> 91.67%             
client [17] (test)  loss: 0.4602 -> 0.3277   acc: 86.17% -> 89.15%             
client [54] (test)  loss: 0.4300 -> 0.2782   acc: 85.19% -> 90.14%             
client [23] (test)  loss: 342.3258 -> 0.5513   acc: 37.47% -> 81.97%           
client [35] (test)  loss: 0.7922 -> 0.5347   acc: 75.69% -> 82.12%             
client [59] (test)  loss: 0.3779 -> 0.2504   acc: 88.22% -> 91.81%             
client [31] (test)  loss: 0.5230 -> 0.4483   acc: 82.20% -> 84.91%             
client [9] (test)  loss: 0.8569 -> 0.5089   acc: 73.16% -> 80.66%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7474 -> 0.3978   acc: 75.71% -> 85.97%             
client [33] (test)  loss: 0.8013 -> 0.4854   acc: 74.42% -> 83.42%             
client [16] (test)  loss: 0.8345 -> 0.5024   acc: 71.25% -> 83.46%             
client [44] (test)  loss: 2.1639 -> 0.5775   acc: 63.59% -> 76.01%             
client [8] (test)  loss: 0.4271 -> 0.3620   acc: 86.93% -> 87.77%              
client [31] (test)  loss: 0.6240 -> 0.4284   acc: 80.59% -> 85.30%             
client [47] (test)  loss: 0.4887 -> 0.2142   acc: 83.33% -> 91.94%             
client [36] (test)  loss: 0.4634 -> 0.1532   acc: 84.54% -> 94.98%             
client [20] (test)  loss: 0.4395 -> 0.3330   acc: 86.09% -> 88.54%             
client [56] (test)  loss: 0.4669 -> 0.3141   acc: 84.31% -> 88.40%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6029 -> 0.3453   acc: 80.51% -> 87.47%              
client [60] (test)  loss: 0.3778 -> 0.2420   acc: 87.91% -> 91.04%             
client [28] (test)  loss: 0.4036 -> 0.2538   acc: 86.52% -> 92.51%             
client [25] (test)  loss: 0.2915 -> 0.1597   acc: 90.99% -> 95.07%             
client [58] (test)  loss: 0.3964 -> 0.2593   acc: 88.00% -> 91.89%             
client [44] (test)  loss: 0.7825 -> 0.5644   acc: 74.45% -> 76.53%             
client [39] (test)  loss: 0.6353 -> 0.4126   acc: 76.71% -> 85.53%             
client [29] (test)  loss: 0.6860 -> 0.4284   acc: 78.22% -> 86.93%             
client [3] (test)  loss: 0.3849 -> 0.2902   acc: 86.79% -> 89.14%              
client [84] (test)  loss: 0.6691 -> 0.4847   acc: 79.07% -> 84.18%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9949 -> 0.4388   acc: 73.49% -> 84.87%             
client [84] (test)  loss: 0.9678 -> 0.4770   acc: 73.17% -> 84.05%             
client [10] (test)  loss: 0.9629 -> 0.3766   acc: 72.34% -> 87.95%             
client [36] (test)  loss: 0.3799 -> 0.1423   acc: 87.44% -> 95.15%             
client [65] (test)  loss: 0.3013 -> 0.2268   acc: 90.38% -> 92.96%             
client [81] (test)  loss: 0.9262 -> 0.4201   acc: 78.13% -> 87.13%             
client [79] (test)  loss: 0.2181 -> 0.1840   acc: 93.32% -> 93.81%             
client [42] (test)  loss: 0.8961 -> 0.3523   acc: 72.09% -> 88.74%             
client [11] (test)  loss: 0.5061 -> 0.3232   acc: 86.16% -> 89.95%             
client [96] (test)  loss: 0.3180 -> 0.2599   acc: 89.21% -> 90.50%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3924 -> 0.3426   acc: 87.70% -> 88.57%              
client [53] (test)  loss: 0.2459 -> 0.1601   acc: 92.79% -> 94.90%             
client [52] (test)  loss: 0.9535 -> 0.4200   acc: 69.43% -> 85.69%             
client [42] (test)  loss: 0.5974 -> 0.3453   acc: 77.04% -> 88.98%             
client [69] (test)  loss: 0.2647 -> 0.1729   acc: 91.69% -> 94.18%             
client [59] (test)  loss: 0.3024 -> 0.2240   acc: 90.48% -> 92.91%             
client [7] (test)  loss: 0.6688 -> 0.4782   acc: 76.12% -> 82.08%              
client [26] (test)  loss: 0.2674 -> 0.2033   acc: 91.36% -> 93.08%             
client [49] (test)  loss: 0.4304 -> 0.3460   acc: 86.37% -> 88.10%             
client [98] (test)  loss: 0.4554 -> 0.3952   acc: 84.48% -> 85.40%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5498 -> 0.3915   acc: 82.65% -> 85.61%             
client [47] (test)  loss: 0.2988 -> 0.2049   acc: 89.09% -> 92.46%             
client [21] (test)  loss: 0.6093 -> 0.4266   acc: 80.95% -> 85.31%             
client [77] (test)  loss: 0.3049 -> 0.2171   acc: 89.59% -> 90.82%             
client [95] (test)  loss: 0.4491 -> 0.3155   acc: 86.25% -> 89.19%             
client [91] (test)  loss: 1.2574 -> 0.5047   acc: 68.37% -> 83.02%             
client [14] (test)  loss: 0.6985 -> 0.4315   acc: 79.20% -> 85.08%             
client [99] (test)  loss: 0.6741 -> 0.4544   acc: 79.61% -> 84.52%             
client [20] (test)  loss: 0.4195 -> 0.3091   acc: 86.45% -> 89.69%             
client [39] (test)  loss: 0.7727 -> 0.3942   acc: 75.83% -> 85.73%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9268 -> 0.4184   acc: 71.30% -> 85.84%             
client [62] (test)  loss: 0.6544 -> 0.3495   acc: 81.30% -> 88.35%             
client [71] (test)  loss: 0.6687 -> 0.4655   acc: 80.47% -> 83.97%             
client [97] (test)  loss: 0.2640 -> 0.1908   acc: 92.14% -> 94.07%             
client [30] (test)  loss: 0.3283 -> 0.2214   acc: 89.15% -> 92.46%             
client [88] (test)  loss: 0.4135 -> 0.3056   acc: 86.83% -> 89.83%             
client [60] (test)  loss: 0.3188 -> 0.2259   acc: 89.85% -> 91.47%             
client [82] (test)  loss: 0.3936 -> 0.2919   acc: 85.62% -> 88.71%             
client [91] (test)  loss: 1.0633 -> 0.5044   acc: 68.16% -> 82.73%             
client [57] (test)  loss: 0.3702 -> 0.1984   acc: 87.27% -> 92.37%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4813 -> 0.4055   acc: 82.47% -> 86.42%             
client [15] (test)  loss: 0.4420 -> 0.3944   acc: 83.55% -> 84.68%             
client [71] (test)  loss: 0.6986 -> 0.4564   acc: 76.46% -> 84.17%             
client [97] (test)  loss: 0.2992 -> 0.1896   acc: 89.01% -> 93.88%             
client [53] (test)  loss: 0.3733 -> 0.1617   acc: 83.88% -> 94.93%             
client [77] (test)  loss: 0.3181 -> 0.2077   acc: 88.41% -> 91.43%             
client [76] (test)  loss: 0.6337 -> 0.3752   acc: 77.48% -> 86.82%             
client [79] (test)  loss: 0.3652 -> 0.1691   acc: 86.82% -> 94.35%             
client [28] (test)  loss: 0.5668 -> 0.2323   acc: 78.53% -> 93.24%             
client [99] (test)  loss: 0.5953 -> 0.4429   acc: 78.31% -> 84.91%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.1813 -> 0.1915   acc: 94.67% -> 94.15%             
client [86] (test)  loss: 0.1854 -> 0.1956   acc: 94.28% -> 93.83%             
client [34] (test)  loss: 0.4355 -> 0.4340   acc: 85.07% -> 85.12%             
client [73] (test)  loss: 0.4245 -> 0.4359   acc: 85.67% -> 85.09%             
client [5] (test)  loss: 0.3893 -> 0.3688   acc: 87.59% -> 87.80%              
client [96] (test)  loss: 0.2937 -> 0.2454   acc: 89.63% -> 90.71%             
client [22] (test)  loss: 0.3783 -> 0.3985   acc: 87.61% -> 87.53%             
client [60] (test)  loss: 0.2438 -> 0.2318   acc: 91.47% -> 91.37%             
client [66] (test)  loss: 0.2692 -> 0.2712   acc: 89.96% -> 89.49%             
client [83] (test)  loss: 0.4432 -> 0.3448   acc: 86.61% -> 87.63%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.4237 -> 0.3890   acc: 85.92% -> 86.60%             
client [65] (test)  loss: 0.2097 -> 0.2173   acc: 93.74% -> 93.52%             
client [95] (test)  loss: 0.3481 -> 0.3129   acc: 88.88% -> 89.88%             
client [17] (test)  loss: 0.3546 -> 0.2757   acc: 90.66% -> 91.07%             
client [8] (test)  loss: 0.3758 -> 0.3305   acc: 88.33% -> 89.29%              
client [35] (test)  loss: 0.4796 -> 0.4934   acc: 83.48% -> 83.42%             
client [98] (test)  loss: 0.4139 -> 0.3919   acc: 84.97% -> 85.33%             
client [53] (test)  loss: 0.1669 -> 0.1618   acc: 94.95% -> 94.95%             
client [43] (test)  loss: 0.4447 -> 0.3238   acc: 86.47% -> 89.09%             
client [64] (test)  loss: 0.3884 -> 0.3692   acc: 86.29% -> 86.94%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.4111 -> 0.4259   acc: 86.07% -> 85.56%             
client [88] (test)  loss: 0.3214 -> 0.3247   acc: 89.33% -> 89.47%             
client [38] (test)  loss: 0.3857 -> 0.3957   acc: 86.83% -> 85.61%             
client [3] (test)  loss: 0.2743 -> 0.2762   acc: 89.66% -> 89.70%              
client [5] (test)  loss: 0.3968 -> 0.3854   acc: 87.37% -> 87.35%              
client [41] (test)  loss: 0.5095 -> 0.5297   acc: 80.81% -> 80.77%             
client [7] (test)  loss: 0.4176 -> 0.4816   acc: 83.92% -> 82.47%              
client [37] (test)  loss: 0.5733 -> 0.6062   acc: 80.23% -> 79.11%             
client [45] (test)  loss: 0.4720 -> 0.3573   acc: 84.13% -> 87.26%             
client [47] (test)  loss: 0.3660 -> 0.2060   acc: 86.28% -> 92.77%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.4763 -> 0.4787   acc: 84.14% -> 84.11%             
client [11] (test)  loss: 0.3343 -> 0.3356   acc: 90.05% -> 89.83%             
client [37] (test)  loss: 0.5959 -> 0.6408   acc: 79.54% -> 78.74%             
client [41] (test)  loss: 0.5167 -> 0.5379   acc: 80.64% -> 80.62%             
client [95] (test)  loss: 0.3269 -> 0.3203   acc: 89.27% -> 89.78%             
client [53] (test)  loss: 0.1806 -> 0.1644   acc: 94.68% -> 94.97%             
client [22] (test)  loss: 0.4150 -> 0.4158   acc: 86.40% -> 86.94%             
client [25] (test)  loss: 0.1393 -> 0.1443   acc: 95.69% -> 95.47%             
client [69] (test)  loss: 0.1888 -> 0.1773   acc: 94.08% -> 94.35%             
client [46] (test)  loss: 0.4275 -> 0.3960   acc: 87.08% -> 88.66%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2121 -> 0.2125   acc: 92.04% -> 92.43%             
client [69] (test)  loss: 0.1944 -> 0.1807   acc: 93.67% -> 94.37%             
client [82] (test)  loss: 0.3175 -> 0.3024   acc: 87.64% -> 88.73%             
client [45] (test)  loss: 0.3479 -> 0.3800   acc: 87.60% -> 86.99%             
client [7] (test)  loss: 0.4335 -> 0.4880   acc: 82.89% -> 82.38%              
client [50] (test)  loss: 0.3008 -> 0.3088   acc: 90.65% -> 90.43%             
client [35] (test)  loss: 0.5253 -> 0.5172   acc: 83.13% -> 83.26%             
client [24] (test)  loss: 0.3869 -> 0.4087   acc: 86.02% -> 85.24%             
client [15] (test)  loss: 0.4001 -> 0.4101   acc: 85.24% -> 84.53%             
client [58] (test)  loss: 0.2350 -> 0.2608   acc: 92.60% -> 92.11%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.4983 -> 0.5041   acc: 83.06% -> 83.33%             
client [76] (test)  loss: 0.4462 -> 0.4032   acc: 85.21% -> 86.26%             
client [67] (test)  loss: 0.2257 -> 0.2221   acc: 93.62% -> 93.96%             
client [37] (test)  loss: 0.6150 -> 0.6613   acc: 79.28% -> 78.34%             
client [58] (test)  loss: 0.2390 -> 0.2646   acc: 92.50% -> 92.16%             
client [64] (test)  loss: 0.4372 -> 0.3983   acc: 85.03% -> 86.44%             
client [77] (test)  loss: 0.2213 -> 0.2137   acc: 91.95% -> 91.31%             
client [55] (test)  loss: 0.2780 -> 0.2873   acc: 89.47% -> 89.49%             
client [12] (test)  loss: 0.4930 -> 0.4430   acc: 84.88% -> 86.36%             
client [89] (test)  loss: 0.3216 -> 0.3409   acc: 88.71% -> 88.47%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.5660 -> 0.5468   acc: 82.49% -> 83.65%             
client [51] (test)  loss: 0.4914 -> 0.5267   acc: 82.61% -> 81.97%             
client [8] (test)  loss: 0.3604 -> 0.3569   acc: 88.38% -> 88.96%              
client [18] (test)  loss: 0.3957 -> 0.4318   acc: 87.44% -> 86.76%             
client [94] (test)  loss: 0.1674 -> 0.1723   acc: 94.39% -> 94.22%             
client [81] (test)  loss: 0.4784 -> 0.4735   acc: 85.92% -> 86.53%             
client [3] (test)  loss: 0.2922 -> 0.2891   acc: 89.48% -> 89.80%              
client [11] (test)  loss: 0.3614 -> 0.3544   acc: 89.18% -> 89.35%             
client [95] (test)  loss: 0.3677 -> 0.3365   acc: 88.24% -> 89.66%             
client [67] (test)  loss: 0.2253 -> 0.2241   acc: 93.74% -> 93.99%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.4396 -> 0.4460   acc: 84.85% -> 84.62%             
client [79] (test)  loss: 0.2067 -> 0.1929   acc: 93.74% -> 94.30%             
client [58] (test)  loss: 0.2488 -> 0.2708   acc: 92.14% -> 92.11%             
client [88] (test)  loss: 0.3324 -> 0.3451   acc: 89.59% -> 89.09%             
client [46] (test)  loss: 0.4281 -> 0.4243   acc: 87.29% -> 88.37%             
client [11] (test)  loss: 0.3620 -> 0.3586   acc: 89.18% -> 89.30%             
client [55] (test)  loss: 0.3004 -> 0.3073   acc: 88.69% -> 88.96%             
client [13] (test)  loss: 0.3550 -> 0.3661   acc: 87.80% -> 88.42%             
client [31] (test)  loss: 0.4081 -> 0.4349   acc: 87.03% -> 86.08%             
client [75] (test)  loss: 0.3609 -> 0.3766   acc: 88.57% -> 87.96%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.4635 -> 0.4004   acc: 86.54% -> 87.76%             
client [7] (test)  loss: 0.4669 -> 0.5183   acc: 82.18% -> 81.62%              
client [57] (test)  loss: 0.2424 -> 0.1998   acc: 91.43% -> 92.49%             
client [13] (test)  loss: 0.3680 -> 0.3765   acc: 87.73% -> 88.25%             
client [43] (test)  loss: 0.3451 -> 0.3632   acc: 88.78% -> 87.88%             
client [91] (test)  loss: 0.5578 -> 0.5372   acc: 82.34% -> 83.18%             
client [10] (test)  loss: 0.4158 -> 0.4273   acc: 87.71% -> 87.20%             
client [64] (test)  loss: 0.4676 -> 0.4312   acc: 84.38% -> 85.89%             
client [82] (test)  loss: 0.3388 -> 0.3175   acc: 87.66% -> 88.66%             
client [22] (test)  loss: 0.4593 -> 0.4540   acc: 86.01% -> 86.31%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.3523 -> 0.3499   acc: 89.25% -> 89.32%             
client [23] (test)  loss: 0.5792 -> 0.5810   acc: 82.44% -> 81.64%             
client [88] (test)  loss: 0.3328 -> 0.3501   acc: 89.69% -> 88.99%             
client [98] (test)  loss: 0.4686 -> 0.4356   acc: 82.35% -> 84.43%             
client [79] (test)  loss: 0.2114 -> 0.1978   acc: 93.69% -> 94.38%             
client [21] (test)  loss: 0.4483 -> 0.4595   acc: 84.48% -> 84.26%             
client [92] (test)  loss: 0.4279 -> 0.4390   acc: 87.31% -> 86.86%             
client [56] (test)  loss: 0.3064 -> 0.3189   acc: 88.93% -> 88.23%             
client [5] (test)  loss: 0.4072 -> 0.4457   acc: 87.35% -> 86.89%              
client [52] (test)  loss: 0.4851 -> 0.4905   acc: 83.92% -> 84.77%             
==================== pFedSim_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.4980 -> 0.0000', 'accuracy': '82.22% -> 0.00%'},          
    200: {'loss': '0.3791 -> 0.0000', 'accuracy': '87.65% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_1 achieved 30.0%(33.08%) at epoch: 1                                   
pFedSim_1 achieved 50.0%(50.92%) at epoch: 2                                   
pFedSim_1 achieved 60.0%(63.89%) at epoch: 4                                   
pFedSim_1 achieved 70.0%(72.21%) at epoch: 13                                  
pFedSim_1 achieved 80.0%(83.56%) at epoch: 30                                  
pFedSim_1 achieved 90.0%(90.06%) at epoch: 127                                 
Convergence (test_after):                                                      
pFedSim_1 achieved 60.0%(62.28%) at epoch: 0                                   
pFedSim_1 achieved 70.0%(74.14%) at epoch: 1                                   
pFedSim_1 achieved 80.0%(80.20%) at epoch: 2                                   
pFedSim_1 achieved 90.0%(90.12%) at epoch: 60                                  
