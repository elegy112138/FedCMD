==================== ALGORITHM: LG-FedAvg-1.0 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6217 -> 1.4903   acc: 47.52% -> 47.78%             
client [81] (test)  loss: 2.0969 -> 1.9493   acc: 32.74% -> 31.86%             
client [21] (test)  loss: 2.3778 -> 1.9256   acc: 11.84% -> 27.73%             
client [68] (test)  loss: 1.8903 -> 1.6258   acc: 29.50% -> 43.17%             
client [93] (test)  loss: 0.7370 -> 0.6407   acc: 78.78% -> 78.78%             
client [31] (test)  loss: 2.1672 -> 2.0532   acc: 21.59% -> 26.43%             
client [20] (test)  loss: 1.1815 -> 0.9915   acc: 64.05% -> 67.32%             
client [59] (test)  loss: 2.3601 -> 1.9662   acc: 24.83% -> 46.03%             
client [48] (test)  loss: 1.4244 -> 1.2841   acc: 54.39% -> 56.76%             
client [34] (test)  loss: 1.2242 -> 1.0471   acc: 52.96% -> 56.18%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4247 -> 1.2540   acc: 51.51% -> 66.89%             
client [99] (test)  loss: 1.9138 -> 1.6488   acc: 32.07% -> 40.34%             
client [67] (test)  loss: 1.9361 -> 1.6712   acc: 35.14% -> 39.38%             
client [0] (test)  loss: 1.2840 -> 1.0928   acc: 54.43% -> 68.85%              
client [76] (test)  loss: 1.7094 -> 1.5708   acc: 45.23% -> 46.87%             
client [41] (test)  loss: 2.1055 -> 1.7778   acc: 39.60% -> 40.40%             
client [62] (test)  loss: 2.3720 -> 1.2675   acc: 15.14% -> 54.86%             
client [2] (test)  loss: 2.3880 -> 1.7199   acc: 17.07% -> 50.60%              
client [14] (test)  loss: 1.1627 -> 1.0424   acc: 48.79% -> 58.18%             
client [46] (test)  loss: 1.3314 -> 1.2506   acc: 56.41% -> 60.68%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3994 -> 1.2455   acc: 48.98% -> 58.88%             
client [68] (test)  loss: 1.1602 -> 1.0785   acc: 67.27% -> 67.99%             
client [57] (test)  loss: 1.9757 -> 1.8306   acc: 41.33% -> 46.94%             
client [17] (test)  loss: 1.8249 -> 1.7324   acc: 33.56% -> 37.67%             
client [54] (test)  loss: 1.3091 -> 1.1695   acc: 53.99% -> 60.84%             
client [23] (test)  loss: 2.3543 -> 1.5125   acc: 22.78% -> 46.67%             
client [35] (test)  loss: 1.1284 -> 1.0052   acc: 71.76% -> 72.92%             
client [59] (test)  loss: 1.3948 -> 1.2002   acc: 61.26% -> 65.56%             
client [31] (test)  loss: 1.8375 -> 1.7448   acc: 40.09% -> 41.85%             
client [9] (test)  loss: 1.6118 -> 1.3656   acc: 48.97% -> 54.87%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.7320 -> 1.6170   acc: 37.97% -> 47.47%             
client [33] (test)  loss: 0.9478 -> 0.9060   acc: 66.56% -> 67.86%             
client [16] (test)  loss: 1.1970 -> 1.0141   acc: 60.22% -> 65.80%             
client [44] (test)  loss: 1.9054 -> 1.5136   acc: 42.78% -> 47.88%             
client [8] (test)  loss: 0.9076 -> 0.8499   acc: 67.21% -> 74.10%              
client [31] (test)  loss: 1.6724 -> 1.5891   acc: 43.61% -> 47.14%             
client [47] (test)  loss: 1.0315 -> 0.9511   acc: 59.34% -> 61.45%             
client [36] (test)  loss: 1.8351 -> 1.5337   acc: 43.09% -> 52.30%             
client [20] (test)  loss: 0.7417 -> 0.6930   acc: 72.88% -> 74.84%             
client [56] (test)  loss: 1.2343 -> 1.0310   acc: 55.21% -> 60.43%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.0808 -> 0.9939   acc: 63.19% -> 66.78%              
client [60] (test)  loss: 0.9334 -> 0.7516   acc: 73.46% -> 77.16%             
client [28] (test)  loss: 1.6005 -> 1.5328   acc: 44.05% -> 48.41%             
client [25] (test)  loss: 1.2292 -> 1.1080   acc: 54.95% -> 65.81%             
client [58] (test)  loss: 0.7108 -> 0.6991   acc: 77.83% -> 78.59%             
client [44] (test)  loss: 1.5221 -> 1.3296   acc: 45.89% -> 58.64%             
client [39] (test)  loss: 1.1558 -> 1.0233   acc: 60.47% -> 64.83%             
client [29] (test)  loss: 1.6233 -> 1.5791   acc: 44.21% -> 46.78%             
client [3] (test)  loss: 0.8847 -> 0.8223   acc: 72.55% -> 73.20%              
client [84] (test)  loss: 1.5979 -> 1.5007   acc: 44.48% -> 49.47%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.3609 -> 1.1025   acc: 62.62% -> 69.16%             
client [84] (test)  loss: 1.4113 -> 1.3252   acc: 53.38% -> 56.23%             
client [10] (test)  loss: 1.2142 -> 1.1685   acc: 56.64% -> 61.33%             
client [36] (test)  loss: 1.3055 -> 1.2350   acc: 61.51% -> 60.86%             
client [65] (test)  loss: 0.9238 -> 0.8309   acc: 73.08% -> 73.72%             
client [81] (test)  loss: 1.5987 -> 1.5174   acc: 50.44% -> 50.88%             
client [79] (test)  loss: 1.7070 -> 1.6120   acc: 44.55% -> 50.45%             
client [42] (test)  loss: 1.3858 -> 1.3240   acc: 52.25% -> 56.16%             
client [11] (test)  loss: 1.6998 -> 1.5624   acc: 51.26% -> 55.04%             
client [96] (test)  loss: 1.3124 -> 1.1880   acc: 57.09% -> 59.22%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7412 -> 0.6821   acc: 77.38% -> 79.67%              
client [53] (test)  loss: 1.4624 -> 1.3978   acc: 45.10% -> 47.45%             
client [52] (test)  loss: 0.6860 -> 0.6215   acc: 79.23% -> 81.79%             
client [42] (test)  loss: 1.2962 -> 1.2461   acc: 56.76% -> 57.36%             
client [69] (test)  loss: 0.7369 -> 0.7183   acc: 75.92% -> 78.26%             
client [59] (test)  loss: 0.9012 -> 0.8160   acc: 69.87% -> 71.52%             
client [7] (test)  loss: 0.6643 -> 0.6537   acc: 79.54% -> 80.12%              
client [26] (test)  loss: 0.5186 -> 0.4733   acc: 80.10% -> 83.67%             
client [49] (test)  loss: 0.6672 -> 0.5945   acc: 77.60% -> 79.87%             
client [98] (test)  loss: 1.3314 -> 1.2677   acc: 56.02% -> 59.69%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2745 -> 1.2133   acc: 59.69% -> 60.21%             
client [47] (test)  loss: 0.9100 -> 0.8704   acc: 65.96% -> 66.27%             
client [21] (test)  loss: 0.9965 -> 0.8832   acc: 71.34% -> 73.83%             
client [77] (test)  loss: 1.0225 -> 0.9939   acc: 69.45% -> 70.23%             
client [95] (test)  loss: 1.4451 -> 1.3961   acc: 41.77% -> 46.99%             
client [91] (test)  loss: 1.5594 -> 1.5128   acc: 39.04% -> 39.04%             
client [14] (test)  loss: 0.6027 -> 0.5499   acc: 80.91% -> 82.12%             
client [99] (test)  loss: 1.2422 -> 1.1383   acc: 59.31% -> 64.48%             
client [20] (test)  loss: 0.6128 -> 0.5730   acc: 82.03% -> 82.03%             
client [39] (test)  loss: 0.8606 -> 0.8864   acc: 69.48% -> 67.73%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6476 -> 0.5920   acc: 81.47% -> 82.43%             
client [62] (test)  loss: 0.7111 -> 0.6442   acc: 76.57% -> 81.14%             
client [71] (test)  loss: 1.2787 -> 1.2306   acc: 56.80% -> 62.40%             
client [97] (test)  loss: 0.6378 -> 0.6092   acc: 81.40% -> 81.13%             
client [30] (test)  loss: 0.5190 -> 0.4807   acc: 82.59% -> 83.23%             
client [88] (test)  loss: 0.6590 -> 0.5914   acc: 78.85% -> 82.69%             
client [60] (test)  loss: 0.6157 -> 0.5745   acc: 79.63% -> 79.94%             
client [82] (test)  loss: 1.0906 -> 1.0491   acc: 65.70% -> 67.64%             
client [91] (test)  loss: 1.4641 -> 1.4161   acc: 42.25% -> 45.99%             
client [57] (test)  loss: 1.5561 -> 1.4772   acc: 51.02% -> 53.57%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2347 -> 1.2145   acc: 63.44% -> 61.67%             
client [15] (test)  loss: 0.6908 -> 0.6325   acc: 75.62% -> 79.38%             
client [71] (test)  loss: 1.2337 -> 1.1888   acc: 60.00% -> 68.00%             
client [97] (test)  loss: 0.5823 -> 0.5682   acc: 82.21% -> 82.48%             
client [53] (test)  loss: 1.2402 -> 1.1977   acc: 54.12% -> 56.08%             
client [77] (test)  loss: 0.9866 -> 0.9766   acc: 69.19% -> 70.76%             
client [76] (test)  loss: 1.0152 -> 0.9827   acc: 68.39% -> 65.94%             
client [79] (test)  loss: 1.4235 -> 1.3184   acc: 54.55% -> 58.64%             
client [28] (test)  loss: 1.1194 -> 1.1324   acc: 61.11% -> 63.10%             
client [99] (test)  loss: 1.1065 -> 1.0320   acc: 64.48% -> 71.03%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5673 -> 0.5582   acc: 83.02% -> 81.94%             
client [86] (test)  loss: 1.2553 -> 1.1879   acc: 60.00% -> 63.59%             
client [34] (test)  loss: 0.5682 -> 0.5152   acc: 79.03% -> 80.38%             
client [73] (test)  loss: 0.9471 -> 0.9102   acc: 67.61% -> 68.42%             
client [5] (test)  loss: 0.5047 -> 0.4999   acc: 80.49% -> 80.77%              
client [96] (test)  loss: 1.0048 -> 0.9453   acc: 66.31% -> 66.67%             
client [22] (test)  loss: 1.3797 -> 1.3186   acc: 52.78% -> 57.22%             
client [60] (test)  loss: 0.5351 -> 0.5230   acc: 81.17% -> 82.10%             
client [66] (test)  loss: 1.1514 -> 1.0646   acc: 61.23% -> 67.03%             
client [83] (test)  loss: 0.9033 -> 0.8503   acc: 74.14% -> 76.35%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.9515 -> 0.9489   acc: 68.94% -> 69.48%             
client [65] (test)  loss: 0.8492 -> 0.7551   acc: 74.68% -> 76.60%             
client [95] (test)  loss: 1.2570 -> 1.2408   acc: 57.83% -> 58.63%             
client [17] (test)  loss: 1.4792 -> 1.4086   acc: 45.21% -> 50.68%             
client [8] (test)  loss: 0.5743 -> 0.5475   acc: 83.61% -> 83.93%              
client [35] (test)  loss: 0.7995 -> 0.7311   acc: 76.39% -> 78.01%             
client [98] (test)  loss: 1.1163 -> 1.0688   acc: 64.40% -> 64.92%             
client [53] (test)  loss: 1.1692 -> 1.1492   acc: 58.04% -> 58.82%             
client [43] (test)  loss: 0.7379 -> 0.6892   acc: 73.96% -> 76.66%             
client [64] (test)  loss: 1.2863 -> 1.2375   acc: 60.13% -> 61.39%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8679 -> 0.8035   acc: 74.45% -> 75.08%             
client [88] (test)  loss: 0.5118 -> 0.5044   acc: 83.97% -> 84.29%             
client [38] (test)  loss: 0.8166 -> 0.7747   acc: 73.00% -> 72.70%             
client [3] (test)  loss: 0.6220 -> 0.6361   acc: 82.35% -> 83.33%              
client [5] (test)  loss: 0.5083 -> 0.5006   acc: 79.67% -> 82.69%              
client [41] (test)  loss: 1.0115 -> 0.9370   acc: 73.20% -> 73.60%             
client [7] (test)  loss: 0.6001 -> 0.6362   acc: 81.27% -> 79.54%              
client [37] (test)  loss: 1.1099 -> 1.0521   acc: 61.00% -> 62.33%             
client [45] (test)  loss: 1.0563 -> 1.0143   acc: 65.30% -> 67.51%             
client [47] (test)  loss: 0.8052 -> 0.7782   acc: 72.59% -> 73.80%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8027 -> 0.7776   acc: 77.70% -> 77.70%             
client [11] (test)  loss: 1.2531 -> 1.1938   acc: 63.45% -> 65.13%             
client [37] (test)  loss: 0.9765 -> 0.9551   acc: 64.00% -> 65.67%             
client [41] (test)  loss: 0.9771 -> 0.9154   acc: 72.00% -> 73.20%             
client [95] (test)  loss: 1.2077 -> 1.1991   acc: 60.24% -> 60.24%             
client [53] (test)  loss: 1.1407 -> 1.1329   acc: 60.39% -> 60.00%             
client [22] (test)  loss: 1.2520 -> 1.1906   acc: 61.11% -> 65.00%             
client [25] (test)  loss: 0.7465 -> 0.7220   acc: 77.32% -> 78.59%             
client [69] (test)  loss: 0.6916 -> 0.6902   acc: 78.93% -> 79.26%             
client [46] (test)  loss: 0.9311 -> 0.8961   acc: 69.66% -> 69.23%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6969 -> 0.6766   acc: 77.11% -> 77.71%             
client [69] (test)  loss: 0.6674 -> 0.6980   acc: 78.60% -> 78.26%             
client [82] (test)  loss: 0.9712 -> 0.9415   acc: 70.55% -> 71.52%             
client [45] (test)  loss: 0.9385 -> 0.8982   acc: 70.03% -> 70.98%             
client [7] (test)  loss: 0.5896 -> 0.6323   acc: 80.69% -> 79.54%              
client [50] (test)  loss: 0.8152 -> 0.7465   acc: 78.83% -> 78.83%             
client [35] (test)  loss: 0.8414 -> 0.7412   acc: 76.62% -> 78.47%             
client [24] (test)  loss: 0.9302 -> 0.9138   acc: 71.83% -> 72.34%             
client [15] (test)  loss: 0.5004 -> 0.4788   acc: 83.75% -> 85.00%             
client [58] (test)  loss: 0.7643 -> 0.7707   acc: 80.35% -> 80.10%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8931 -> 0.9002   acc: 68.92% -> 70.61%             
client [76] (test)  loss: 0.9841 -> 0.9639   acc: 69.75% -> 71.39%             
client [67] (test)  loss: 1.0434 -> 1.0618   acc: 71.04% -> 70.66%             
client [37] (test)  loss: 0.9452 -> 0.9329   acc: 66.33% -> 67.67%             
client [58] (test)  loss: 0.7892 -> 0.7840   acc: 80.35% -> 80.35%             
client [64] (test)  loss: 1.1025 -> 1.0722   acc: 66.46% -> 68.99%             
client [77] (test)  loss: 0.9115 -> 0.9600   acc: 72.06% -> 69.45%             
client [55] (test)  loss: 1.1279 -> 1.0478   acc: 68.67% -> 71.69%             
client [12] (test)  loss: 0.9529 -> 0.9321   acc: 69.29% -> 70.47%             
client [89] (test)  loss: 0.6329 -> 0.6396   acc: 82.13% -> 82.13%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.2750 -> 1.2786   acc: 64.41% -> 61.57%             
client [51] (test)  loss: 1.0052 -> 1.0077   acc: 66.67% -> 67.52%             
client [8] (test)  loss: 0.4780 -> 0.4643   acc: 85.25% -> 84.59%              
client [18] (test)  loss: 0.3270 -> 0.3105   acc: 89.77% -> 90.10%             
client [94] (test)  loss: 0.7774 -> 0.7637   acc: 76.17% -> 76.56%             
client [81] (test)  loss: 1.2504 -> 1.2475   acc: 62.83% -> 62.39%             
client [3] (test)  loss: 0.6762 -> 0.6963   acc: 82.35% -> 82.35%              
client [11] (test)  loss: 1.2039 -> 1.2083   acc: 63.03% -> 62.61%             
client [95] (test)  loss: 1.2576 -> 1.2395   acc: 61.04% -> 63.05%             
client [67] (test)  loss: 1.0813 -> 1.0813   acc: 70.66% -> 71.04%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7808 -> 0.7624   acc: 75.39% -> 76.64%             
client [79] (test)  loss: 0.9631 -> 0.9752   acc: 66.82% -> 66.36%             
client [58] (test)  loss: 0.7981 -> 0.8080   acc: 80.10% -> 80.10%             
client [88] (test)  loss: 0.5035 -> 0.4947   acc: 83.33% -> 84.29%             
client [46] (test)  loss: 0.8518 -> 0.8397   acc: 70.94% -> 70.51%             
client [11] (test)  loss: 1.2663 -> 1.3357   acc: 60.92% -> 60.08%             
client [55] (test)  loss: 1.0859 -> 1.0072   acc: 72.89% -> 73.49%             
client [13] (test)  loss: 0.7596 -> 0.7770   acc: 77.25% -> 76.97%             
client [31] (test)  loss: 1.2622 -> 1.2348   acc: 62.56% -> 63.00%             
client [75] (test)  loss: 0.8958 -> 0.8829   acc: 70.37% -> 71.43%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5793 -> 0.5791   acc: 83.13% -> 83.44%             
client [7] (test)  loss: 0.5612 -> 0.5891   acc: 84.73% -> 84.15%              
client [57] (test)  loss: 1.0916 -> 1.0737   acc: 63.78% -> 64.29%             
client [13] (test)  loss: 0.8243 -> 0.7978   acc: 76.12% -> 77.81%             
client [43] (test)  loss: 0.6321 -> 0.6174   acc: 77.40% -> 80.34%             
client [91] (test)  loss: 1.2263 -> 1.1934   acc: 64.17% -> 62.57%             
client [10] (test)  loss: 0.8765 -> 0.8679   acc: 73.44% -> 73.05%             
client [64] (test)  loss: 0.9816 -> 0.9822   acc: 69.62% -> 70.89%             
client [82] (test)  loss: 0.9121 -> 0.8938   acc: 72.82% -> 73.79%             
client [22] (test)  loss: 0.9835 -> 0.9590   acc: 66.67% -> 67.22%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.6059 -> 0.5688   acc: 83.01% -> 83.01%             
client [23] (test)  loss: 0.6728 -> 0.6487   acc: 79.72% -> 81.94%             
client [88] (test)  loss: 0.5111 -> 0.4923   acc: 84.62% -> 84.62%             
client [98] (test)  loss: 0.8516 -> 0.8324   acc: 73.30% -> 72.25%             
client [79] (test)  loss: 1.0089 -> 1.0123   acc: 65.91% -> 65.45%             
client [21] (test)  loss: 0.7600 -> 0.7647   acc: 76.32% -> 75.70%             
client [92] (test)  loss: 1.2266 -> 1.0268   acc: 59.85% -> 64.39%             
client [56] (test)  loss: 0.4581 -> 0.4366   acc: 84.36% -> 84.66%             
client [5] (test)  loss: 0.5187 -> 0.5156   acc: 84.34% -> 84.89%              
client [52] (test)  loss: 0.4972 -> 0.5025   acc: 85.94% -> 85.62%             
==================== LG-FedAvg-1.0 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '0.9134 -> 0.0000', 'accuracy': '70.91% -> 0.00%'},          
    200: {'loss': '0.8189 -> 0.0000', 'accuracy': '75.64% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-1.0 achieved 10.0%(15.55%) at epoch: 0                               
LG-FedAvg-1.0 achieved 20.0%(20.08%) at epoch: 2                               
LG-FedAvg-1.0 achieved 30.0%(31.42%) at epoch: 4                               
LG-FedAvg-1.0 achieved 40.0%(43.37%) at epoch: 9                               
LG-FedAvg-1.0 achieved 50.0%(50.91%) at epoch: 17                              
LG-FedAvg-1.0 achieved 60.0%(60.02%) at epoch: 43                              
LG-FedAvg-1.0 achieved 70.0%(70.04%) at epoch: 60                              
Convergence (test_after):                                                      
LG-FedAvg-1.0 achieved 30.0%(38.48%) at epoch: 0                               
LG-FedAvg-1.0 achieved 40.0%(43.00%) at epoch: 1                               
LG-FedAvg-1.0 achieved 50.0%(51.37%) at epoch: 5                               
LG-FedAvg-1.0 achieved 60.0%(60.34%) at epoch: 20                              
LG-FedAvg-1.0 achieved 70.0%(70.13%) at epoch: 45                              
LG-FedAvg-1.0 achieved 80.0%(80.30%) at epoch: 168                             
