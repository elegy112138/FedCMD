==================== ALGORITHM: LG-FedAvg-1.0 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1498 -> 5.1255   acc: 2.70% -> 2.88%               
client [81] (test)  loss: 5.1911 -> 5.1748   acc: 2.58% -> 2.40%               
client [21] (test)  loss: 5.2933 -> 5.1980   acc: 0.18% -> 2.00%               
client [68] (test)  loss: 5.1304 -> 4.9962   acc: 4.88% -> 5.42%               
client [93] (test)  loss: 5.2102 -> 5.1270   acc: 2.36% -> 2.00%               
client [31] (test)  loss: 5.2122 -> 5.1518   acc: 4.68% -> 4.68%               
client [20] (test)  loss: 5.0446 -> 5.0100   acc: 7.94% -> 8.13%               
client [59] (test)  loss: 5.2918 -> 5.2052   acc: 1.09% -> 1.27%               
client [48] (test)  loss: 5.0804 -> 5.0645   acc: 5.20% -> 5.73%               
client [34] (test)  loss: 5.2068 -> 5.1453   acc: 2.00% -> 1.64%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.1796 -> 5.0952   acc: 1.30% -> 1.85%               
client [99] (test)  loss: 5.2283 -> 5.1611   acc: 1.99% -> 3.07%               
client [67] (test)  loss: 5.2563 -> 5.1247   acc: 0.75% -> 2.24%               
client [0] (test)  loss: 5.1013 -> 5.0599   acc: 2.90% -> 3.08%                
client [76] (test)  loss: 5.0096 -> 4.9595   acc: 3.27% -> 3.99%               
client [41] (test)  loss: 5.2478 -> 5.1639   acc: 1.27% -> 1.63%               
client [62] (test)  loss: 5.2958 -> 5.2046   acc: 0.72% -> 2.87%               
client [2] (test)  loss: 5.2966 -> 5.2098   acc: 0.00% -> 4.99%                
client [14] (test)  loss: 5.1552 -> 5.1577   acc: 4.15% -> 4.33%               
client [46] (test)  loss: 5.0653 -> 5.0365   acc: 3.63% -> 4.54%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7732 -> 4.7640   acc: 11.23% -> 11.94%             
client [68] (test)  loss: 4.8958 -> 4.8812   acc: 5.61% -> 6.33%               
client [57] (test)  loss: 5.1660 -> 5.1372   acc: 2.72% -> 3.81%               
client [17] (test)  loss: 5.1288 -> 5.0830   acc: 4.32% -> 5.23%               
client [54] (test)  loss: 4.9754 -> 5.0289   acc: 3.63% -> 4.54%               
client [23] (test)  loss: 5.3051 -> 5.2298   acc: 0.18% -> 1.81%               
client [35] (test)  loss: 5.0060 -> 5.0134   acc: 2.00% -> 2.00%               
client [59] (test)  loss: 5.0520 -> 5.0031   acc: 1.27% -> 1.27%               
client [31] (test)  loss: 5.2527 -> 5.3143   acc: 4.86% -> 3.96%               
client [9] (test)  loss: 5.2196 -> 5.2273   acc: 2.35% -> 2.53%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.1498 -> 5.1313   acc: 3.72% -> 4.65%               
client [33] (test)  loss: 5.3512 -> 5.5585   acc: 2.72% -> 3.62%               
client [16] (test)  loss: 5.1237 -> 5.0571   acc: 3.95% -> 4.49%               
client [44] (test)  loss: 5.2906 -> 5.2425   acc: 1.95% -> 2.13%               
client [8] (test)  loss: 5.0990 -> 5.2670   acc: 5.96% -> 5.05%                
client [31] (test)  loss: 5.3969 -> 5.6100   acc: 3.42% -> 2.70%               
client [47] (test)  loss: 5.0341 -> 5.0237   acc: 1.62% -> 2.71%               
client [36] (test)  loss: 5.2231 -> 5.1110   acc: 0.91% -> 2.18%               
client [20] (test)  loss: 5.0812 -> 5.2275   acc: 7.56% -> 8.32%               
client [56] (test)  loss: 5.0893 -> 5.0091   acc: 5.60% -> 6.14%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.1092 -> 5.0999   acc: 1.45% -> 1.81%                
client [60] (test)  loss: 4.9131 -> 4.8807   acc: 5.40% -> 7.19%               
client [28] (test)  loss: 5.1070 -> 5.0392   acc: 3.99% -> 3.99%               
client [25] (test)  loss: 5.1688 -> 5.0655   acc: 1.80% -> 2.34%               
client [58] (test)  loss: 5.1363 -> 5.1753   acc: 3.42% -> 4.32%               
client [44] (test)  loss: 5.2797 -> 5.2039   acc: 2.13% -> 2.13%               
client [39] (test)  loss: 5.1058 -> 5.0532   acc: 3.64% -> 5.09%               
client [29] (test)  loss: 5.2082 -> 5.1365   acc: 3.68% -> 3.85%               
client [3] (test)  loss: 4.9819 -> 4.9896   acc: 5.90% -> 5.90%                
client [84] (test)  loss: 5.1092 -> 5.1315   acc: 6.52% -> 7.61%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.0972 -> 5.0518   acc: 2.90% -> 3.81%               
client [84] (test)  loss: 5.3100 -> 5.4938   acc: 6.34% -> 7.43%               
client [10] (test)  loss: 5.1498 -> 5.1078   acc: 4.86% -> 5.04%               
client [36] (test)  loss: 5.0604 -> 5.0030   acc: 3.09% -> 5.09%               
client [65] (test)  loss: 5.2534 -> 5.3223   acc: 4.54% -> 3.81%               
client [81] (test)  loss: 5.3369 -> 5.3604   acc: 3.32% -> 3.87%               
client [79] (test)  loss: 5.1720 -> 5.1941   acc: 3.91% -> 4.44%               
client [42] (test)  loss: 5.2026 -> 5.2717   acc: 6.23% -> 4.91%               
client [11] (test)  loss: 4.9379 -> 4.9260   acc: 8.63% -> 7.19%               
client [96] (test)  loss: 5.0182 -> 4.9512   acc: 4.32% -> 5.05%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.8257 -> 6.0717   acc: 5.78% -> 4.87%                
client [53] (test)  loss: 5.0393 -> 5.0361   acc: 5.11% -> 4.94%               
client [52] (test)  loss: 5.2362 -> 5.2744   acc: 4.89% -> 4.71%               
client [42] (test)  loss: 5.4575 -> 5.6613   acc: 5.09% -> 5.66%               
client [69] (test)  loss: 5.6814 -> 5.9887   acc: 5.37% -> 5.00%               
client [59] (test)  loss: 5.0927 -> 5.2255   acc: 4.91% -> 4.00%               
client [7] (test)  loss: 5.4731 -> 5.3174   acc: 4.53% -> 5.98%                
client [26] (test)  loss: 5.1158 -> 5.0765   acc: 4.32% -> 4.14%               
client [49] (test)  loss: 5.1597 -> 5.2212   acc: 5.05% -> 3.79%               
client [98] (test)  loss: 5.4131 -> 5.6644   acc: 5.09% -> 4.91%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 5.7868 -> 6.0047   acc: 4.36% -> 3.64%               
client [47] (test)  loss: 5.1150 -> 5.0910   acc: 3.25% -> 2.89%               
client [21] (test)  loss: 5.0343 -> 5.0481   acc: 3.81% -> 4.72%               
client [77] (test)  loss: 5.4487 -> 5.7333   acc: 5.04% -> 4.50%               
client [95] (test)  loss: 5.5018 -> 5.7073   acc: 4.50% -> 4.32%               
client [91] (test)  loss: 5.5307 -> 5.8608   acc: 4.55% -> 4.00%               
client [14] (test)  loss: 5.5721 -> 5.8801   acc: 5.05% -> 4.51%               
client [99] (test)  loss: 5.1719 -> 5.2577   acc: 3.25% -> 4.15%               
client [20] (test)  loss: 6.3414 -> 6.5550   acc: 6.05% -> 6.62%               
client [39] (test)  loss: 5.0963 -> 5.0724   acc: 6.55% -> 5.45%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.3435 -> 5.4359   acc: 5.25% -> 5.07%               
client [62] (test)  loss: 6.0415 -> 6.4027   acc: 3.77% -> 3.59%               
client [71] (test)  loss: 5.3661 -> 5.5620   acc: 4.30% -> 3.76%               
client [97] (test)  loss: 5.4276 -> 5.4937   acc: 3.45% -> 3.82%               
client [30] (test)  loss: 6.1288 -> 6.4867   acc: 3.62% -> 3.99%               
client [88] (test)  loss: 4.9457 -> 4.9988   acc: 6.51% -> 7.05%               
client [60] (test)  loss: 5.3052 -> 5.4771   acc: 7.01% -> 8.09%               
client [82] (test)  loss: 5.3251 -> 5.4528   acc: 5.89% -> 6.43%               
client [91] (test)  loss: 6.0285 -> 6.2819   acc: 4.91% -> 4.91%               
client [57] (test)  loss: 5.1928 -> 5.2254   acc: 4.72% -> 5.63%               
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 8.3925 -> 8.5292   acc: 2.70% -> 2.88%               
client [15] (test)  loss: 5.1748 -> 5.2905   acc: 4.49% -> 4.67%               
client [71] (test)  loss: 5.5422 -> 5.7877   acc: 4.12% -> 4.30%               
client [97] (test)  loss: 5.8829 -> 6.2348   acc: 3.64% -> 3.64%               
client [53] (test)  loss: 5.3712 -> 5.4836   acc: 4.06% -> 4.23%               
client [77] (test)  loss: 5.7572 -> 6.0175   acc: 4.68% -> 3.78%               
client [76] (test)  loss: 5.5268 -> 5.7086   acc: 4.17% -> 4.54%               
client [79] (test)  loss: 5.4574 -> 5.5348   acc: 4.97% -> 4.62%               
client [28] (test)  loss: 6.1536 -> 6.4359   acc: 4.72% -> 4.54%               
client [99] (test)  loss: 5.4806 -> 5.6582   acc: 4.51% -> 4.33%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 6.5496 -> 6.8395   acc: 3.45% -> 3.27%               
client [86] (test)  loss: 5.4353 -> 5.6957   acc: 5.08% -> 5.63%               
client [34] (test)  loss: 6.7082 -> 7.0735   acc: 2.73% -> 2.73%               
client [73] (test)  loss: 5.5766 -> 5.7691   acc: 4.07% -> 3.86%               
client [5] (test)  loss: 5.9217 -> 6.1363   acc: 4.80% -> 4.63%                
client [96] (test)  loss: 6.7272 -> 6.7418   acc: 4.50% -> 3.78%               
client [22] (test)  loss: 5.2219 -> 5.3325   acc: 5.06% -> 5.24%               
client [60] (test)  loss: 6.6817 -> 6.8730   acc: 5.76% -> 6.29%               
client [66] (test)  loss: 5.3336 -> 5.4799   acc: 6.32% -> 6.50%               
client [83] (test)  loss: 6.1386 -> 6.3239   acc: 4.52% -> 4.34%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 6.7510 -> 6.7681   acc: 3.45% -> 4.36%               
client [65] (test)  loss: 5.7792 -> 5.9857   acc: 3.09% -> 3.27%               
client [95] (test)  loss: 6.8990 -> 6.9952   acc: 3.38% -> 3.00%               
client [17] (test)  loss: 5.3412 -> 5.3646   acc: 4.14% -> 3.78%               
client [8] (test)  loss: 7.0633 -> 7.2107   acc: 5.05% -> 4.69%                
client [35] (test)  loss: 6.9360 -> 7.0527   acc: 2.90% -> 2.18%               
client [98] (test)  loss: 6.7135 -> 6.9151   acc: 3.27% -> 3.27%               
client [53] (test)  loss: 5.6977 -> 6.0235   acc: 4.41% -> 3.70%               
client [43] (test)  loss: 6.2671 -> 6.3790   acc: 2.90% -> 2.72%               
client [64] (test)  loss: 5.8774 -> 6.0717   acc: 6.88% -> 6.32%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.0762 -> 5.1440   acc: 4.90% -> 5.44%               
client [88] (test)  loss: 6.1816 -> 6.4096   acc: 6.69% -> 6.87%               
client [38] (test)  loss: 6.1655 -> 6.4917   acc: 3.70% -> 3.15%               
client [3] (test)  loss: 6.8117 -> 7.0726   acc: 6.08% -> 6.08%                
client [5] (test)  loss: 6.4941 -> 6.6988   acc: 4.09% -> 3.74%                
client [41] (test)  loss: 6.0125 -> 6.2275   acc: 2.90% -> 2.90%               
client [7] (test)  loss: 5.9659 -> 6.1173   acc: 4.53% -> 3.80%                
client [37] (test)  loss: 5.8523 -> 6.1669   acc: 2.88% -> 2.88%               
client [45] (test)  loss: 5.1456 -> 5.1385   acc: 5.27% -> 5.64%               
client [47] (test)  loss: 5.3413 -> 5.4202   acc: 3.43% -> 4.87%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 6.6907 -> 6.8680   acc: 3.59% -> 3.77%               
client [11] (test)  loss: 6.4209 -> 6.5937   acc: 5.40% -> 5.58%               
client [37] (test)  loss: 6.8094 -> 7.1410   acc: 2.88% -> 2.52%               
client [41] (test)  loss: 6.2944 -> 6.4609   acc: 2.54% -> 2.54%               
client [95] (test)  loss: 7.7403 -> 7.7948   acc: 3.19% -> 3.38%               
client [53] (test)  loss: 6.0665 -> 6.3653   acc: 3.35% -> 3.53%               
client [22] (test)  loss: 5.5950 -> 5.8480   acc: 4.70% -> 4.70%               
client [25] (test)  loss: 5.6011 -> 5.7825   acc: 3.60% -> 4.50%               
client [69] (test)  loss: 7.7668 -> 7.8821   acc: 3.89% -> 4.07%               
client [46] (test)  loss: 5.7403 -> 6.1141   acc: 4.54% -> 4.36%               
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 6.6860 -> 6.9039   acc: 3.07% -> 3.61%               
client [69] (test)  loss: 8.0296 -> 8.0697   acc: 4.07% -> 4.26%               
client [82] (test)  loss: 6.5155 -> 6.6450   acc: 5.71% -> 6.25%               
client [45] (test)  loss: 5.5485 -> 5.7503   acc: 5.27% -> 5.27%               
client [7] (test)  loss: 6.3118 -> 6.4661   acc: 3.08% -> 3.44%                
client [50] (test)  loss: 5.4132 -> 5.5683   acc: 3.80% -> 4.35%               
client [35] (test)  loss: 7.4051 -> 7.4759   acc: 2.54% -> 2.36%               
client [24] (test)  loss: 7.9027 -> 7.8612   acc: 3.03% -> 4.63%               
client [15] (test)  loss: 6.4025 -> 6.6351   acc: 4.49% -> 4.13%               
client [58] (test)  loss: 7.5992 -> 7.6603   acc: 4.86% -> 4.50%               
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 7.8203 -> 7.8207   acc: 3.94% -> 4.30%               
client [76] (test)  loss: 7.2163 -> 7.2274   acc: 3.63% -> 4.17%               
client [67] (test)  loss: 6.4908 -> 6.6639   acc: 2.80% -> 2.80%               
client [37] (test)  loss: 7.4379 -> 7.5839   acc: 3.24% -> 3.06%               
client [58] (test)  loss: 7.7397 -> 7.7995   acc: 4.68% -> 4.68%               
client [64] (test)  loss: 7.1764 -> 7.2701   acc: 6.51% -> 6.32%               
client [77] (test)  loss: 7.2282 -> 7.4176   acc: 4.68% -> 4.68%               
client [55] (test)  loss: 7.2592 -> 7.3182   acc: 3.94% -> 4.11%               
client [12] (test)  loss: 7.1797 -> 7.2639   acc: 3.05% -> 2.87%               
client [89] (test)  loss: 7.7715 -> 7.8654   acc: 4.48% -> 3.58%               
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 8.3940 -> 8.4550   acc: 5.43% -> 5.80%               
client [51] (test)  loss: 7.4974 -> 7.5216   acc: 4.68% -> 5.77%               
client [8] (test)  loss: 8.0331 -> 8.2515   acc: 4.87% -> 4.33%                
client [18] (test)  loss: 6.5030 -> 6.8102   acc: 4.11% -> 3.94%               
client [94] (test)  loss: 6.8966 -> 7.1589   acc: 2.71% -> 2.71%               
client [81] (test)  loss: 8.0669 -> 8.1919   acc: 2.95% -> 2.77%               
client [3] (test)  loss: 7.5411 -> 7.7753   acc: 6.44% -> 6.62%                
client [11] (test)  loss: 7.2471 -> 7.3855   acc: 5.76% -> 5.40%               
client [95] (test)  loss: 8.6208 -> 8.5093   acc: 3.38% -> 3.38%               
client [67] (test)  loss: 6.8112 -> 6.9551   acc: 2.80% -> 2.43%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.5562 -> 5.8449   acc: 4.72% -> 4.72%               
client [79] (test)  loss: 8.1961 -> 8.3733   acc: 2.66% -> 2.84%               
client [58] (test)  loss: 8.0365 -> 8.0254   acc: 4.32% -> 5.05%               
client [88] (test)  loss: 6.9653 -> 7.0299   acc: 6.15% -> 6.51%               
client [46] (test)  loss: 7.0073 -> 7.2591   acc: 3.81% -> 4.17%               
client [11] (test)  loss: 7.3648 -> 7.4346   acc: 5.22% -> 5.04%               
client [55] (test)  loss: 7.9777 -> 8.0784   acc: 3.76% -> 3.94%               
client [13] (test)  loss: 7.6592 -> 7.8641   acc: 4.89% -> 4.53%               
client [31] (test)  loss: 8.8167 -> 8.9125   acc: 2.34% -> 3.06%               
client [75] (test)  loss: 7.5290 -> 7.6729   acc: 5.96% -> 6.86%               
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 8.1190 -> 8.1631   acc: 3.48% -> 3.89%               
client [7] (test)  loss: 7.8007 -> 7.9013   acc: 2.54% -> 2.36%                
client [57] (test)  loss: 7.6281 -> 7.6014   acc: 5.44% -> 6.17%               
client [13] (test)  loss: 7.8181 -> 8.0273   acc: 3.99% -> 4.17%               
client [43] (test)  loss: 7.8271 -> 7.9833   acc: 2.90% -> 2.90%               
client [91] (test)  loss: 7.6659 -> 7.9210   acc: 3.64% -> 3.45%               
client [10] (test)  loss: 7.9717 -> 8.1104   acc: 4.86% -> 5.40%               
client [64] (test)  loss: 8.1943 -> 8.2308   acc: 5.20% -> 5.58%               
client [82] (test)  loss: 7.5340 -> 7.5997   acc: 5.54% -> 5.89%               
client [22] (test)  loss: 7.1311 -> 7.4000   acc: 3.80% -> 4.52%               
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 7.6929 -> 7.9500   acc: 5.48% -> 6.05%               
client [23] (test)  loss: 6.3537 -> 6.7306   acc: 1.63% -> 2.17%               
client [88] (test)  loss: 7.0390 -> 7.1292   acc: 6.33% -> 6.33%               
client [98] (test)  loss: 8.0897 -> 8.2077   acc: 3.45% -> 2.91%               
client [79] (test)  loss: 8.5238 -> 8.6989   acc: 2.49% -> 2.66%               
client [21] (test)  loss: 6.1036 -> 6.4323   acc: 4.72% -> 3.99%               
client [92] (test)  loss: 7.7228 -> 7.7489   acc: 8.21% -> 9.64%               
client [56] (test)  loss: 7.8458 -> 7.9359   acc: 3.79% -> 4.15%               
client [5] (test)  loss: 7.7076 -> 7.8420   acc: 4.63% -> 3.56%                
client [52] (test)  loss: 8.0214 -> 8.3491   acc: 3.62% -> 4.71%               
==================== LG-FedAvg-1.0 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '5.8577 -> 0.0000', 'accuracy': '4.33% -> 0.00%'},           
    200: {'loss': '7.7310 -> 0.0000', 'accuracy': '3.99% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
Convergence (test_after):                                                      
