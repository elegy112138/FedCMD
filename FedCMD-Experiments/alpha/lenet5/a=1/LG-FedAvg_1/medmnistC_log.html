==================== ALGORITHM: LG-FedAvg-1.0 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0317 -> 1.8272   acc: 37.90% -> 41.94%             
client [81] (test)  loss: 1.9878 -> 1.7655   acc: 37.70% -> 43.44%             
client [21] (test)  loss: 2.3614 -> 2.0501   acc: 2.52% -> 34.45%              
client [68] (test)  loss: 2.1179 -> 1.8648   acc: 30.30% -> 30.30%             
client [93] (test)  loss: 1.4840 -> 0.9565   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.3725 -> 2.2429   acc: 8.97% -> 29.49%              
client [20] (test)  loss: 1.9833 -> 1.8255   acc: 45.32% -> 45.32%             
client [59] (test)  loss: 2.3845 -> 2.1742   acc: 18.90% -> 36.22%             
client [48] (test)  loss: 2.2392 -> 2.1659   acc: 27.27% -> 23.64%             
client [34] (test)  loss: 2.1510 -> 1.9022   acc: 34.51% -> 34.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9083 -> 1.8211   acc: 28.57% -> 31.25%             
client [99] (test)  loss: 2.3070 -> 2.1676   acc: 27.27% -> 26.14%             
client [67] (test)  loss: 2.3004 -> 2.1176   acc: 22.22% -> 25.40%             
client [0] (test)  loss: 1.6253 -> 1.4401   acc: 42.77% -> 44.51%              
client [76] (test)  loss: 1.8985 -> 1.7512   acc: 36.71% -> 41.77%             
client [41] (test)  loss: 2.2423 -> 1.9926   acc: 38.52% -> 31.97%             
client [62] (test)  loss: 2.4037 -> 2.2778   acc: 1.41% -> 40.85%              
client [2] (test)  loss: 2.3731 -> 1.4659   acc: 2.76% -> 63.45%               
client [14] (test)  loss: 1.7833 -> 1.6582   acc: 42.52% -> 44.09%             
client [46] (test)  loss: 1.7260 -> 1.6616   acc: 52.99% -> 52.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.9887 -> 1.8150   acc: 39.29% -> 39.29%             
client [68] (test)  loss: 1.4847 -> 1.3537   acc: 43.43% -> 46.46%             
client [57] (test)  loss: 1.8791 -> 1.7584   acc: 39.18% -> 39.18%             
client [17] (test)  loss: 1.8184 -> 1.7122   acc: 43.27% -> 53.85%             
client [54] (test)  loss: 1.9133 -> 1.8909   acc: 39.19% -> 41.89%             
client [23] (test)  loss: 2.3642 -> 2.3042   acc: 14.86% -> 35.14%             
client [35] (test)  loss: 1.9376 -> 1.8553   acc: 40.48% -> 40.48%             
client [59] (test)  loss: 1.6892 -> 1.6009   acc: 36.22% -> 36.22%             
client [31] (test)  loss: 1.7724 -> 1.7316   acc: 46.15% -> 51.28%             
client [9] (test)  loss: 1.9028 -> 1.8125   acc: 19.59% -> 40.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.7870 -> 1.6644   acc: 37.60% -> 37.60%             
client [33] (test)  loss: 1.3094 -> 1.2783   acc: 57.94% -> 57.94%             
client [16] (test)  loss: 1.9977 -> 1.8969   acc: 31.94% -> 34.72%             
client [44] (test)  loss: 2.1829 -> 1.8920   acc: 40.00% -> 42.22%             
client [8] (test)  loss: 0.8564 -> 0.8158   acc: 65.97% -> 69.44%              
client [31] (test)  loss: 1.7070 -> 1.6778   acc: 51.28% -> 53.85%             
client [47] (test)  loss: 1.4411 -> 1.2373   acc: 62.18% -> 66.39%             
client [36] (test)  loss: 2.2868 -> 2.1057   acc: 36.75% -> 35.90%             
client [20] (test)  loss: 1.4242 -> 1.3651   acc: 51.80% -> 56.12%             
client [56] (test)  loss: 1.9433 -> 1.7512   acc: 45.30% -> 47.01%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.9850 -> 1.9054   acc: 30.17% -> 31.90%              
client [60] (test)  loss: 2.0887 -> 2.0035   acc: 22.37% -> 22.37%             
client [28] (test)  loss: 1.4163 -> 1.3617   acc: 54.84% -> 54.03%             
client [25] (test)  loss: 1.9841 -> 1.8783   acc: 35.54% -> 37.19%             
client [58] (test)  loss: 1.1129 -> 1.0514   acc: 63.12% -> 66.88%             
client [44] (test)  loss: 1.8975 -> 1.7116   acc: 42.22% -> 42.22%             
client [39] (test)  loss: 0.8309 -> 0.7944   acc: 76.43% -> 76.43%             
client [29] (test)  loss: 1.3248 -> 1.2469   acc: 51.26% -> 59.66%             
client [3] (test)  loss: 2.0252 -> 1.9758   acc: 27.12% -> 31.36%              
client [84] (test)  loss: 0.5623 -> 0.5243   acc: 82.82% -> 82.82%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.5895 -> 1.4748   acc: 44.54% -> 49.58%             
client [84] (test)  loss: 0.5008 -> 0.4760   acc: 84.66% -> 85.28%             
client [10] (test)  loss: 2.2433 -> 2.2101   acc: 30.77% -> 28.21%             
client [36] (test)  loss: 1.8641 -> 1.7890   acc: 35.90% -> 36.75%             
client [65] (test)  loss: 1.7260 -> 1.6984   acc: 37.29% -> 38.14%             
client [81] (test)  loss: 1.5304 -> 1.4656   acc: 50.00% -> 50.00%             
client [79] (test)  loss: 1.7449 -> 1.6391   acc: 41.88% -> 41.03%             
client [42] (test)  loss: 1.8618 -> 1.7967   acc: 36.72% -> 38.28%             
client [11] (test)  loss: 1.6379 -> 1.6098   acc: 45.45% -> 45.45%             
client [96] (test)  loss: 1.7007 -> 1.6289   acc: 42.02% -> 41.18%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7389 -> 0.6968   acc: 77.78% -> 79.86%              
client [53] (test)  loss: 1.5858 -> 1.4925   acc: 41.18% -> 42.02%             
client [52] (test)  loss: 1.1601 -> 1.0965   acc: 66.67% -> 68.22%             
client [42] (test)  loss: 1.7605 -> 1.6857   acc: 41.41% -> 42.97%             
client [69] (test)  loss: 1.4274 -> 1.3881   acc: 50.89% -> 53.57%             
client [59] (test)  loss: 1.4104 -> 1.3514   acc: 45.67% -> 50.39%             
client [7] (test)  loss: 1.6396 -> 1.5810   acc: 40.74% -> 45.93%              
client [26] (test)  loss: 1.8687 -> 1.7801   acc: 35.38% -> 37.69%             
client [49] (test)  loss: 1.6715 -> 1.5699   acc: 47.06% -> 50.00%             
client [98] (test)  loss: 1.5268 -> 1.4718   acc: 48.25% -> 50.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4712 -> 1.4266   acc: 49.12% -> 51.75%             
client [47] (test)  loss: 1.1192 -> 1.0540   acc: 67.23% -> 67.23%             
client [21] (test)  loss: 1.3784 -> 1.3020   acc: 50.42% -> 50.42%             
client [77] (test)  loss: 1.4012 -> 1.3626   acc: 54.03% -> 55.65%             
client [95] (test)  loss: 1.1000 -> 1.0650   acc: 70.95% -> 72.07%             
client [91] (test)  loss: 1.9636 -> 1.9114   acc: 34.92% -> 34.92%             
client [14] (test)  loss: 1.2698 -> 1.1961   acc: 51.97% -> 61.42%             
client [99] (test)  loss: 1.9020 -> 1.8716   acc: 29.55% -> 32.95%             
client [20] (test)  loss: 1.1778 -> 1.1459   acc: 64.03% -> 63.31%             
client [39] (test)  loss: 0.7480 -> 0.7251   acc: 76.43% -> 76.43%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1066 -> 1.0494   acc: 66.67% -> 68.99%             
client [62] (test)  loss: 1.2727 -> 1.2345   acc: 66.20% -> 67.61%             
client [71] (test)  loss: 1.4735 -> 1.4141   acc: 49.62% -> 52.67%             
client [97] (test)  loss: 0.9970 -> 0.9455   acc: 61.74% -> 63.09%             
client [30] (test)  loss: 1.2810 -> 1.2261   acc: 61.42% -> 62.99%             
client [88] (test)  loss: 1.5526 -> 1.5050   acc: 43.38% -> 47.79%             
client [60] (test)  loss: 1.8023 -> 1.7670   acc: 36.84% -> 38.16%             
client [82] (test)  loss: 1.2452 -> 1.1826   acc: 56.56% -> 56.56%             
client [91] (test)  loss: 1.8627 -> 1.8151   acc: 34.92% -> 34.92%             
client [57] (test)  loss: 1.5349 -> 1.4338   acc: 45.03% -> 49.71%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5696 -> 1.5565   acc: 58.97% -> 62.82%             
client [15] (test)  loss: 0.7807 -> 0.7202   acc: 77.86% -> 77.86%             
client [71] (test)  loss: 1.4240 -> 1.3683   acc: 51.15% -> 54.20%             
client [97] (test)  loss: 0.8489 -> 0.8015   acc: 65.10% -> 67.79%             
client [53] (test)  loss: 1.3205 -> 1.2517   acc: 52.10% -> 53.78%             
client [77] (test)  loss: 1.3675 -> 1.3329   acc: 54.84% -> 57.26%             
client [76] (test)  loss: 1.4180 -> 1.3686   acc: 55.70% -> 56.96%             
client [79] (test)  loss: 1.4871 -> 1.4316   acc: 56.41% -> 59.83%             
client [28] (test)  loss: 1.1134 -> 1.0868   acc: 65.32% -> 66.94%             
client [99] (test)  loss: 1.8509 -> 1.8225   acc: 32.95% -> 32.95%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7541 -> 0.7138   acc: 71.14% -> 71.81%             
client [86] (test)  loss: 0.7166 -> 0.6820   acc: 81.30% -> 80.49%             
client [34] (test)  loss: 1.2366 -> 1.1935   acc: 56.34% -> 57.75%             
client [73] (test)  loss: 1.7422 -> 1.7048   acc: 44.00% -> 44.80%             
client [5] (test)  loss: 1.6539 -> 1.5966   acc: 48.57% -> 51.43%              
client [96] (test)  loss: 1.3307 -> 1.3074   acc: 57.98% -> 57.98%             
client [22] (test)  loss: 1.8924 -> 1.8467   acc: 40.19% -> 41.12%             
client [60] (test)  loss: 1.6946 -> 1.6786   acc: 43.42% -> 42.11%             
client [66] (test)  loss: 1.4420 -> 1.3603   acc: 43.55% -> 48.39%             
client [83] (test)  loss: 1.5556 -> 1.5120   acc: 51.33% -> 51.33%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.2698 -> 1.2350   acc: 59.49% -> 59.49%             
client [65] (test)  loss: 1.6495 -> 1.6174   acc: 39.83% -> 40.68%             
client [95] (test)  loss: 1.0060 -> 1.0018   acc: 77.65% -> 77.65%             
client [17] (test)  loss: 1.4540 -> 1.4879   acc: 57.69% -> 58.65%             
client [8] (test)  loss: 0.6239 -> 0.6033   acc: 80.56% -> 81.25%              
client [35] (test)  loss: 1.3070 -> 1.2574   acc: 52.38% -> 54.76%             
client [98] (test)  loss: 1.3481 -> 1.3191   acc: 56.14% -> 57.89%             
client [53] (test)  loss: 1.2085 -> 1.1520   acc: 57.14% -> 58.82%             
client [43] (test)  loss: 0.5574 -> 0.5312   acc: 81.34% -> 82.30%             
client [64] (test)  loss: 1.2357 -> 1.1767   acc: 58.40% -> 60.00%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.2382 -> 1.1878   acc: 52.10% -> 52.94%             
client [88] (test)  loss: 1.1999 -> 1.1460   acc: 58.09% -> 60.29%             
client [38] (test)  loss: 1.6496 -> 1.5644   acc: 45.24% -> 47.62%             
client [3] (test)  loss: 1.6087 -> 1.5677   acc: 46.61% -> 48.31%              
client [5] (test)  loss: 1.5965 -> 1.5457   acc: 48.57% -> 50.48%              
client [41] (test)  loss: 1.1239 -> 1.0998   acc: 65.57% -> 66.39%             
client [7] (test)  loss: 1.4775 -> 1.4363   acc: 47.41% -> 46.67%              
client [37] (test)  loss: 1.1074 -> 1.0619   acc: 64.62% -> 65.09%             
client [45] (test)  loss: 1.7807 -> 1.7236   acc: 38.38% -> 38.38%             
client [47] (test)  loss: 0.9893 -> 0.9632   acc: 68.07% -> 68.07%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.3036 -> 1.2747   acc: 62.50% -> 65.28%             
client [11] (test)  loss: 1.4559 -> 1.4340   acc: 56.82% -> 56.06%             
client [37] (test)  loss: 1.0037 -> 0.9763   acc: 69.81% -> 70.75%             
client [41] (test)  loss: 1.0901 -> 1.0737   acc: 65.57% -> 66.39%             
client [95] (test)  loss: 0.9724 -> 0.9880   acc: 77.65% -> 78.21%             
client [53] (test)  loss: 1.1609 -> 1.1074   acc: 58.82% -> 58.82%             
client [22] (test)  loss: 1.8193 -> 1.7791   acc: 39.25% -> 40.19%             
client [25] (test)  loss: 1.5178 -> 1.4590   acc: 60.33% -> 60.33%             
client [69] (test)  loss: 1.2375 -> 1.2104   acc: 56.25% -> 58.93%             
client [46] (test)  loss: 1.3927 -> 1.3721   acc: 57.26% -> 58.12%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9155 -> 0.9025   acc: 69.75% -> 72.27%             
client [69] (test)  loss: 1.2076 -> 1.1814   acc: 58.04% -> 58.93%             
client [82] (test)  loss: 1.0070 -> 0.9678   acc: 62.30% -> 63.93%             
client [45] (test)  loss: 1.6243 -> 1.5703   acc: 44.44% -> 47.47%             
client [7] (test)  loss: 1.4338 -> 1.3928   acc: 46.67% -> 50.37%              
client [50] (test)  loss: 0.7988 -> 0.7429   acc: 76.30% -> 80.00%             
client [35] (test)  loss: 1.1900 -> 1.1547   acc: 63.10% -> 63.10%             
client [24] (test)  loss: 1.3838 -> 1.3539   acc: 62.50% -> 62.50%             
client [15] (test)  loss: 0.6223 -> 0.6171   acc: 78.63% -> 79.39%             
client [58] (test)  loss: 0.6995 -> 0.6847   acc: 77.50% -> 77.50%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.5037 -> 1.4876   acc: 54.55% -> 54.55%             
client [76] (test)  loss: 1.1824 -> 1.1604   acc: 64.56% -> 64.56%             
client [67] (test)  loss: 1.4750 -> 1.4275   acc: 49.21% -> 52.38%             
client [37] (test)  loss: 0.9698 -> 0.9517   acc: 72.17% -> 71.70%             
client [58] (test)  loss: 0.6809 -> 0.6657   acc: 77.50% -> 77.50%             
client [64] (test)  loss: 1.0532 -> 1.0141   acc: 65.60% -> 66.40%             
client [77] (test)  loss: 1.2130 -> 1.1862   acc: 61.29% -> 61.29%             
client [55] (test)  loss: 1.2861 -> 1.2581   acc: 55.56% -> 56.35%             
client [12] (test)  loss: 1.8254 -> 1.8083   acc: 50.00% -> 54.29%             
client [89] (test)  loss: 1.0798 -> 1.0930   acc: 65.94% -> 64.49%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3640 -> 0.3545   acc: 92.02% -> 92.02%             
client [51] (test)  loss: 0.6144 -> 0.6024   acc: 76.77% -> 76.13%             
client [8] (test)  loss: 0.5811 -> 0.5715   acc: 80.56% -> 81.94%              
client [18] (test)  loss: 1.9258 -> 1.8928   acc: 27.84% -> 29.90%             
client [94] (test)  loss: 0.6703 -> 0.6279   acc: 78.33% -> 81.67%             
client [81] (test)  loss: 1.1316 -> 1.0926   acc: 59.84% -> 61.48%             
client [3] (test)  loss: 1.4565 -> 1.4106   acc: 52.54% -> 55.08%              
client [11] (test)  loss: 1.3674 -> 1.3612   acc: 58.33% -> 59.09%             
client [95] (test)  loss: 1.0071 -> 1.0322   acc: 77.65% -> 77.65%             
client [67] (test)  loss: 1.4299 -> 1.3907   acc: 51.59% -> 53.97%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1021 -> 1.0631   acc: 66.39% -> 70.59%             
client [79] (test)  loss: 1.1113 -> 1.0942   acc: 70.09% -> 68.38%             
client [58] (test)  loss: 0.6531 -> 0.6387   acc: 77.50% -> 77.50%             
client [88] (test)  loss: 1.0506 -> 1.0153   acc: 64.71% -> 66.91%             
client [46] (test)  loss: 1.2853 -> 1.2801   acc: 63.25% -> 63.25%             
client [11] (test)  loss: 1.3773 -> 1.3514   acc: 58.33% -> 59.85%             
client [55] (test)  loss: 1.1748 -> 1.1631   acc: 62.70% -> 62.70%             
client [13] (test)  loss: 1.7397 -> 1.7059   acc: 43.90% -> 45.12%             
client [31] (test)  loss: 1.5535 -> 1.5206   acc: 60.26% -> 61.54%             
client [75] (test)  loss: 1.2211 -> 1.1979   acc: 62.18% -> 62.18%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.8817 -> 0.8633   acc: 73.95% -> 75.63%             
client [7] (test)  loss: 1.2446 -> 1.2371   acc: 55.56% -> 56.30%              
client [57] (test)  loss: 1.0556 -> 1.0193   acc: 70.18% -> 69.59%             
client [13] (test)  loss: 1.6942 -> 1.6787   acc: 43.90% -> 46.34%             
client [43] (test)  loss: 0.4940 -> 0.4917   acc: 83.73% -> 84.69%             
client [91] (test)  loss: 1.6610 -> 1.6345   acc: 34.92% -> 34.92%             
client [10] (test)  loss: 1.8601 -> 1.8496   acc: 41.03% -> 38.46%             
client [64] (test)  loss: 0.8894 -> 0.8714   acc: 68.80% -> 70.40%             
client [82] (test)  loss: 0.8635 -> 0.8435   acc: 72.13% -> 72.95%             
client [22] (test)  loss: 1.6800 -> 1.5985   acc: 48.60% -> 48.60%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0286 -> 1.0307   acc: 67.63% -> 68.35%             
client [23] (test)  loss: 1.4455 -> 1.3925   acc: 48.65% -> 54.05%             
client [88] (test)  loss: 1.0260 -> 0.9941   acc: 64.71% -> 66.91%             
client [98] (test)  loss: 1.1442 -> 1.1280   acc: 71.93% -> 71.93%             
client [79] (test)  loss: 1.0699 -> 1.0592   acc: 69.23% -> 68.38%             
client [21] (test)  loss: 1.0237 -> 0.9870   acc: 73.95% -> 74.79%             
client [92] (test)  loss: 1.0806 -> 1.0718   acc: 65.38% -> 64.62%             
client [56] (test)  loss: 0.9170 -> 0.8966   acc: 67.52% -> 67.52%             
client [5] (test)  loss: 1.5745 -> 1.5570   acc: 54.29% -> 53.33%              
client [52] (test)  loss: 0.9484 -> 0.9388   acc: 73.64% -> 75.19%             
==================== LG-FedAvg-1.0 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '1.2908 -> 0.0000', 'accuracy': '57.35% -> 0.00%'},          
    200: {'loss': '1.0535 -> 0.0000', 'accuracy': '67.10% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-1.0 achieved 10.0%(12.38%) at epoch: 0                               
LG-FedAvg-1.0 achieved 30.0%(31.30%) at epoch: 4                               
LG-FedAvg-1.0 achieved 40.0%(40.26%) at epoch: 18                              
LG-FedAvg-1.0 achieved 50.0%(52.93%) at epoch: 35                              
LG-FedAvg-1.0 achieved 60.0%(64.46%) at epoch: 82                              
LG-FedAvg-1.0 achieved 70.0%(70.81%) at epoch: 142                             
Convergence (test_after):                                                      
LG-FedAvg-1.0 achieved 30.0%(34.47%) at epoch: 0                               
LG-FedAvg-1.0 achieved 40.0%(41.60%) at epoch: 3                               
LG-FedAvg-1.0 achieved 50.0%(54.39%) at epoch: 20                              
LG-FedAvg-1.0 achieved 60.0%(62.79%) at epoch: 72                              
LG-FedAvg-1.0 achieved 70.0%(72.18%) at epoch: 142                             
