==================== ALGORITHM: LG-FedAvg-1.0 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7454 -> 1.3956   acc: 48.21% -> 50.36%             
client [81] (test)  loss: 1.2208 -> 1.0213   acc: 57.42% -> 59.38%             
client [21] (test)  loss: 12.4504 -> 1.7686   acc: 14.44% -> 48.06%            
client [68] (test)  loss: 2.1811 -> 2.0239   acc: 34.81% -> 51.27%             
client [93] (test)  loss: 1.6927 -> 1.2672   acc: 49.52% -> 69.84%             
client [31] (test)  loss: 1.6289 -> 1.0918   acc: 37.18% -> 66.00%             
client [20] (test)  loss: 1.6583 -> 1.3755   acc: 48.41% -> 55.10%             
client [59] (test)  loss: 11.7578 -> 1.5697   acc: 13.71% -> 58.00%            
client [48] (test)  loss: 0.5191 -> 0.4030   acc: 85.04% -> 86.61%             
client [34] (test)  loss: 1.3904 -> 0.9771   acc: 55.16% -> 73.64%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.0904 -> 0.9225   acc: 65.19% -> 72.99%             
client [99] (test)  loss: 1.7856 -> 1.3547   acc: 41.24% -> 53.67%             
client [67] (test)  loss: 1.3912 -> 1.1340   acc: 48.11% -> 62.72%             
client [0] (test)  loss: 1.3202 -> 1.0575   acc: 49.73% -> 65.69%              
client [76] (test)  loss: 0.9669 -> 0.7605   acc: 72.59% -> 73.45%             
client [41] (test)  loss: 1.8435 -> 1.5806   acc: 47.23% -> 50.18%             
client [62] (test)  loss: 13.4737 -> 1.9072   acc: 4.28% -> 28.75%             
client [2] (test)  loss: 15.0816 -> 1.6063   acc: 8.16% -> 39.63%              
client [14] (test)  loss: 0.8879 -> 0.7094   acc: 71.54% -> 79.09%             
client [46] (test)  loss: 0.7436 -> 0.6321   acc: 76.38% -> 79.30%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6662 -> 0.5594   acc: 78.59% -> 81.61%             
client [68] (test)  loss: 1.5416 -> 1.3994   acc: 53.16% -> 53.80%             
client [57] (test)  loss: 1.2515 -> 1.0520   acc: 61.37% -> 67.87%             
client [17] (test)  loss: 0.6105 -> 0.4400   acc: 82.20% -> 86.65%             
client [54] (test)  loss: 0.5034 -> 0.4487   acc: 87.11% -> 86.63%             
client [23] (test)  loss: 14.6585 -> 0.8893   acc: 13.80% -> 76.65%            
client [35] (test)  loss: 0.6360 -> 0.5213   acc: 81.34% -> 82.46%             
client [59] (test)  loss: 0.8689 -> 0.6394   acc: 73.14% -> 80.57%             
client [31] (test)  loss: 0.6855 -> 0.6491   acc: 74.75% -> 76.14%             
client [9] (test)  loss: 0.9146 -> 0.7937   acc: 68.51% -> 71.79%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7677 -> 0.6337   acc: 74.22% -> 79.32%             
client [33] (test)  loss: 0.6746 -> 0.6537   acc: 75.68% -> 76.76%             
client [16] (test)  loss: 0.7139 -> 0.5876   acc: 84.29% -> 86.13%             
client [44] (test)  loss: 1.5380 -> 1.0189   acc: 44.71% -> 71.81%             
client [8] (test)  loss: 0.7532 -> 0.6875   acc: 73.55% -> 76.13%              
client [31] (test)  loss: 0.6501 -> 0.6231   acc: 75.55% -> 76.94%             
client [47] (test)  loss: 1.3561 -> 1.1539   acc: 63.67% -> 68.91%             
client [36] (test)  loss: 1.9488 -> 1.4548   acc: 45.40% -> 61.35%             
client [20] (test)  loss: 0.9255 -> 0.8656   acc: 71.34% -> 72.93%             
client [56] (test)  loss: 1.3402 -> 1.0889   acc: 59.06% -> 64.69%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.9909 -> 0.8566   acc: 63.40% -> 66.75%              
client [60] (test)  loss: 0.8059 -> 0.5628   acc: 80.45% -> 83.91%             
client [28] (test)  loss: 1.2239 -> 1.0904   acc: 63.59% -> 68.66%             
client [25] (test)  loss: 0.8070 -> 0.6440   acc: 70.71% -> 76.52%             
client [58] (test)  loss: 0.4072 -> 0.3472   acc: 86.39% -> 87.70%             
client [44] (test)  loss: 1.0988 -> 0.7786   acc: 71.37% -> 78.19%             
client [39] (test)  loss: 0.9435 -> 0.8151   acc: 77.38% -> 77.38%             
client [29] (test)  loss: 0.8962 -> 0.8370   acc: 67.07% -> 69.46%             
client [3] (test)  loss: 0.6336 -> 0.5700   acc: 79.61% -> 80.17%              
client [84] (test)  loss: 0.6425 -> 0.6173   acc: 76.23% -> 76.52%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.1719 -> 0.9525   acc: 63.06% -> 71.94%             
client [84] (test)  loss: 0.5955 -> 0.5822   acc: 77.39% -> 77.39%             
client [10] (test)  loss: 0.7029 -> 0.6223   acc: 79.72% -> 81.11%             
client [36] (test)  loss: 1.0573 -> 0.9097   acc: 61.96% -> 65.34%             
client [65] (test)  loss: 0.5833 -> 0.5333   acc: 79.46% -> 81.03%             
client [81] (test)  loss: 0.7804 -> 0.7138   acc: 66.67% -> 71.15%             
client [79] (test)  loss: 0.8253 -> 0.7557   acc: 67.96% -> 73.20%             
client [42] (test)  loss: 0.8384 -> 0.7737   acc: 77.67% -> 79.07%             
client [11] (test)  loss: 1.0825 -> 0.9730   acc: 64.86% -> 65.58%             
client [96] (test)  loss: 0.5256 -> 0.4772   acc: 86.70% -> 86.43%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6298 -> 0.6038   acc: 78.71% -> 78.71%              
client [53] (test)  loss: 0.3585 -> 0.2908   acc: 89.69% -> 90.13%             
client [52] (test)  loss: 0.8365 -> 0.7963   acc: 69.25% -> 71.19%             
client [42] (test)  loss: 0.7499 -> 0.7039   acc: 78.14% -> 79.53%             
client [69] (test)  loss: 0.5023 -> 0.4694   acc: 85.19% -> 85.19%             
client [59] (test)  loss: 0.4606 -> 0.4108   acc: 88.00% -> 88.00%             
client [7] (test)  loss: 0.7297 -> 0.6912   acc: 74.44% -> 76.67%              
client [26] (test)  loss: 0.6501 -> 0.6069   acc: 80.35% -> 80.35%             
client [49] (test)  loss: 0.8558 -> 0.7834   acc: 66.11% -> 68.02%             
client [98] (test)  loss: 0.7689 -> 0.7549   acc: 70.00% -> 70.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7453 -> 0.7368   acc: 71.39% -> 71.39%             
client [47] (test)  loss: 1.0495 -> 0.9596   acc: 69.66% -> 70.41%             
client [21] (test)  loss: 0.8280 -> 0.7255   acc: 75.00% -> 80.83%             
client [77] (test)  loss: 0.7498 -> 0.6926   acc: 67.86% -> 73.21%             
client [95] (test)  loss: 0.4927 -> 0.4615   acc: 84.23% -> 84.79%             
client [91] (test)  loss: 0.6644 -> 0.6267   acc: 77.11% -> 78.16%             
client [14] (test)  loss: 0.5318 -> 0.4984   acc: 82.87% -> 83.88%             
client [99] (test)  loss: 0.5786 -> 0.5303   acc: 80.51% -> 83.33%             
client [20] (test)  loss: 0.7748 -> 0.7647   acc: 74.52% -> 74.20%             
client [39] (test)  loss: 0.6613 -> 0.6247   acc: 79.84% -> 80.11%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8077 -> 0.7723   acc: 69.81% -> 73.41%             
client [62] (test)  loss: 0.6792 -> 0.6682   acc: 77.98% -> 78.59%             
client [71] (test)  loss: 0.5477 -> 0.5227   acc: 83.33% -> 83.90%             
client [97] (test)  loss: 0.9217 -> 0.8407   acc: 75.00% -> 75.00%             
client [30] (test)  loss: 0.6602 -> 0.6444   acc: 81.76% -> 81.42%             
client [88] (test)  loss: 0.5942 -> 0.5413   acc: 78.51% -> 78.79%             
client [60] (test)  loss: 0.2975 -> 0.2817   acc: 90.35% -> 91.09%             
client [82] (test)  loss: 0.4824 -> 0.4556   acc: 81.59% -> 82.84%             
client [91] (test)  loss: 0.6133 -> 0.5917   acc: 77.11% -> 80.26%             
client [57] (test)  loss: 0.7006 -> 0.6496   acc: 80.51% -> 84.12%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7344 -> 0.7472   acc: 74.55% -> 76.74%             
client [15] (test)  loss: 0.7261 -> 0.6568   acc: 74.24% -> 77.84%             
client [71] (test)  loss: 0.5404 -> 0.5147   acc: 83.33% -> 84.75%             
client [97] (test)  loss: 0.7443 -> 0.7211   acc: 76.87% -> 76.49%             
client [53] (test)  loss: 0.2824 -> 0.2450   acc: 91.89% -> 92.54%             
client [77] (test)  loss: 0.7080 -> 0.6586   acc: 70.71% -> 74.64%             
client [76] (test)  loss: 0.4102 -> 0.3865   acc: 86.08% -> 86.72%             
client [79] (test)  loss: 0.7143 -> 0.6986   acc: 72.38% -> 72.38%             
client [28] (test)  loss: 0.8631 -> 0.8289   acc: 73.27% -> 73.73%             
client [99] (test)  loss: 0.4826 -> 0.4562   acc: 85.03% -> 85.59%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6971 -> 0.6864   acc: 78.73% -> 78.73%             
client [86] (test)  loss: 0.4331 -> 0.4066   acc: 83.26% -> 84.65%             
client [34] (test)  loss: 0.4602 -> 0.4596   acc: 86.96% -> 86.96%             
client [73] (test)  loss: 0.5278 -> 0.5053   acc: 82.69% -> 82.99%             
client [5] (test)  loss: 0.7023 -> 0.6847   acc: 75.48% -> 77.39%              
client [96] (test)  loss: 0.4217 -> 0.4289   acc: 88.09% -> 88.64%             
client [22] (test)  loss: 0.6475 -> 0.6375   acc: 78.06% -> 77.42%             
client [60] (test)  loss: 0.2586 -> 0.2566   acc: 92.33% -> 92.33%             
client [66] (test)  loss: 0.7902 -> 0.7321   acc: 72.96% -> 74.07%             
client [83] (test)  loss: 0.2807 -> 0.2609   acc: 90.21% -> 92.27%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3517 -> 0.3442   acc: 87.37% -> 87.79%             
client [65] (test)  loss: 0.5105 -> 0.4944   acc: 82.37% -> 83.93%             
client [95] (test)  loss: 0.4209 -> 0.4172   acc: 85.35% -> 84.79%             
client [17] (test)  loss: 0.3106 -> 0.2959   acc: 89.79% -> 89.79%             
client [8] (test)  loss: 0.5759 -> 0.5662   acc: 80.00% -> 77.74%              
client [35] (test)  loss: 0.4386 -> 0.4371   acc: 83.96% -> 84.51%             
client [98] (test)  loss: 0.7374 -> 0.7083   acc: 71.67% -> 72.78%             
client [53] (test)  loss: 0.2592 -> 0.2410   acc: 92.11% -> 92.32%             
client [43] (test)  loss: 0.5685 -> 0.5479   acc: 83.87% -> 84.95%             
client [64] (test)  loss: 0.5132 -> 0.5008   acc: 81.02% -> 81.30%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6679 -> 0.6106   acc: 82.50% -> 83.89%             
client [88] (test)  loss: 0.5348 -> 0.5174   acc: 77.69% -> 78.51%             
client [38] (test)  loss: 0.5627 -> 0.5503   acc: 80.82% -> 81.76%             
client [3] (test)  loss: 0.4333 -> 0.4360   acc: 85.12% -> 85.95%              
client [5] (test)  loss: 0.6685 -> 0.6625   acc: 76.25% -> 76.63%              
client [41] (test)  loss: 0.7895 -> 0.7744   acc: 69.74% -> 69.74%             
client [7] (test)  loss: 0.6864 -> 0.6583   acc: 76.67% -> 76.94%              
client [37] (test)  loss: 0.5167 -> 0.4987   acc: 84.92% -> 87.15%             
client [45] (test)  loss: 0.4524 -> 0.4366   acc: 82.46% -> 83.25%             
client [47] (test)  loss: 0.8654 -> 0.7964   acc: 72.28% -> 72.28%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3637 -> 0.3638   acc: 90.31% -> 90.58%             
client [11] (test)  loss: 0.6492 -> 0.6186   acc: 76.09% -> 77.90%             
client [37] (test)  loss: 0.4922 -> 0.4799   acc: 86.87% -> 87.43%             
client [41] (test)  loss: 0.7697 -> 0.7666   acc: 71.22% -> 71.59%             
client [95] (test)  loss: 0.4091 -> 0.4053   acc: 85.92% -> 85.63%             
client [53] (test)  loss: 0.2606 -> 0.2418   acc: 92.11% -> 92.11%             
client [22] (test)  loss: 0.6264 -> 0.6177   acc: 79.03% -> 78.71%             
client [25] (test)  loss: 0.4399 -> 0.4454   acc: 82.32% -> 81.79%             
client [69] (test)  loss: 0.4425 -> 0.4510   acc: 85.71% -> 86.23%             
client [46] (test)  loss: 0.4479 -> 0.4382   acc: 83.97% -> 84.26%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6995 -> 0.6820   acc: 75.28% -> 76.03%             
client [69] (test)  loss: 0.4527 -> 0.4612   acc: 86.23% -> 85.97%             
client [82] (test)  loss: 0.4328 -> 0.4172   acc: 84.83% -> 84.83%             
client [45] (test)  loss: 0.4210 -> 0.4142   acc: 83.51% -> 85.60%             
client [7] (test)  loss: 0.6759 -> 0.6545   acc: 75.83% -> 77.22%              
client [50] (test)  loss: 0.6373 -> 0.6436   acc: 77.03% -> 76.47%             
client [35] (test)  loss: 0.4525 -> 0.4579   acc: 85.07% -> 86.01%             
client [24] (test)  loss: 0.4650 -> 0.4596   acc: 85.89% -> 86.90%             
client [15] (test)  loss: 0.5613 -> 0.5508   acc: 80.06% -> 79.78%             
client [58] (test)  loss: 0.3223 -> 0.3214   acc: 91.62% -> 91.62%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3686 -> 0.4182   acc: 87.66% -> 87.93%             
client [76] (test)  loss: 0.3308 -> 0.3292   acc: 88.22% -> 89.29%             
client [67] (test)  loss: 0.4554 -> 0.4460   acc: 88.92% -> 89.42%             
client [37] (test)  loss: 0.4833 -> 0.4803   acc: 86.31% -> 87.43%             
client [58] (test)  loss: 0.3335 -> 0.3273   acc: 91.10% -> 91.62%             
client [64] (test)  loss: 0.5232 -> 0.5342   acc: 83.29% -> 81.30%             
client [77] (test)  loss: 0.5852 -> 0.5615   acc: 76.79% -> 79.29%             
client [55] (test)  loss: 0.6191 -> 0.6674   acc: 80.43% -> 80.82%             
client [12] (test)  loss: 0.8110 -> 0.7928   acc: 70.45% -> 71.36%             
client [89] (test)  loss: 0.5276 -> 0.5276   acc: 83.60% -> 84.24%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5772 -> 0.6026   acc: 82.03% -> 81.74%             
client [51] (test)  loss: 0.6568 -> 0.6709   acc: 81.08% -> 81.68%             
client [8] (test)  loss: 0.5709 -> 0.5795   acc: 78.39% -> 77.74%              
client [18] (test)  loss: 0.4581 -> 0.4768   acc: 82.67% -> 82.98%             
client [94] (test)  loss: 0.6954 -> 0.7072   acc: 74.79% -> 77.69%             
client [81] (test)  loss: 0.7429 -> 0.7171   acc: 75.35% -> 75.07%             
client [3] (test)  loss: 0.4614 -> 0.4764   acc: 86.50% -> 84.57%              
client [11] (test)  loss: 0.6014 -> 0.5883   acc: 80.80% -> 80.80%             
client [95] (test)  loss: 0.4171 -> 0.4173   acc: 85.63% -> 86.48%             
client [67] (test)  loss: 0.4482 -> 0.4447   acc: 89.17% -> 89.17%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5576 -> 0.5387   acc: 83.89% -> 85.56%             
client [79] (test)  loss: 0.6984 -> 0.6818   acc: 77.35% -> 77.07%             
client [58] (test)  loss: 0.3393 -> 0.3381   acc: 91.62% -> 91.88%             
client [88] (test)  loss: 0.6125 -> 0.5589   acc: 75.21% -> 76.31%             
client [46] (test)  loss: 0.4363 -> 0.4228   acc: 83.97% -> 84.55%             
client [11] (test)  loss: 0.5988 -> 0.5870   acc: 80.43% -> 80.43%             
client [55] (test)  loss: 0.7322 -> 0.7792   acc: 80.43% -> 80.63%             
client [13] (test)  loss: 0.4574 -> 0.4488   acc: 86.61% -> 87.66%             
client [31] (test)  loss: 0.7937 -> 0.8295   acc: 75.35% -> 76.14%             
client [75] (test)  loss: 0.6327 -> 0.6139   acc: 80.37% -> 80.98%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3940 -> 0.3869   acc: 88.97% -> 89.31%             
client [7] (test)  loss: 0.6653 -> 0.6665   acc: 78.61% -> 79.44%              
client [57] (test)  loss: 0.4806 -> 0.4940   acc: 89.17% -> 88.45%             
client [13] (test)  loss: 0.4652 -> 0.4599   acc: 86.88% -> 87.93%             
client [43] (test)  loss: 0.4689 -> 0.4567   acc: 88.17% -> 88.17%             
client [91] (test)  loss: 0.5829 -> 0.5982   acc: 79.47% -> 77.89%             
client [10] (test)  loss: 0.4483 -> 0.4307   acc: 86.11% -> 86.39%             
client [64] (test)  loss: 0.5802 -> 0.5822   acc: 83.57% -> 82.15%             
client [82] (test)  loss: 0.4518 -> 0.4432   acc: 85.32% -> 86.07%             
client [22] (test)  loss: 0.6018 -> 0.6006   acc: 79.35% -> 79.35%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7635 -> 0.7657   acc: 75.80% -> 75.48%             
client [23] (test)  loss: 0.3133 -> 0.3324   acc: 91.08% -> 91.08%             
client [88] (test)  loss: 0.5979 -> 0.5713   acc: 76.31% -> 77.13%             
client [98] (test)  loss: 0.8235 -> 0.7667   acc: 75.00% -> 75.00%             
client [79] (test)  loss: 0.6876 -> 0.6956   acc: 79.01% -> 78.73%             
client [21] (test)  loss: 0.5260 -> 0.5271   acc: 85.28% -> 85.00%             
client [92] (test)  loss: 0.6117 -> 0.6326   acc: 80.32% -> 80.32%             
client [56] (test)  loss: 0.5515 -> 0.5436   acc: 79.69% -> 80.62%             
client [5] (test)  loss: 0.6888 -> 0.6716   acc: 77.01% -> 77.39%              
client [52] (test)  loss: 0.8408 -> 0.8597   acc: 73.96% -> 75.35%             
==================== LG-FedAvg-1.0 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '0.5913 -> 0.0000', 'accuracy': '79.68% -> 0.00%'},          
    200: {'loss': '0.5622 -> 0.0000', 'accuracy': '82.21% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-1.0 achieved 10.0%(16.49%) at epoch: 1                               
LG-FedAvg-1.0 achieved 20.0%(22.69%) at epoch: 2                               
LG-FedAvg-1.0 achieved 40.0%(47.34%) at epoch: 7                               
LG-FedAvg-1.0 achieved 50.0%(54.04%) at epoch: 16                              
LG-FedAvg-1.0 achieved 60.0%(64.51%) at epoch: 27                              
LG-FedAvg-1.0 achieved 70.0%(71.42%) at epoch: 28                              
LG-FedAvg-1.0 achieved 80.0%(80.82%) at epoch: 56                              
Convergence (test_after):                                                      
LG-FedAvg-1.0 achieved 50.0%(53.09%) at epoch: 0                               
LG-FedAvg-1.0 achieved 60.0%(61.58%) at epoch: 7                               
LG-FedAvg-1.0 achieved 70.0%(71.38%) at epoch: 27                              
LG-FedAvg-1.0 achieved 80.0%(83.45%) at epoch: 56                              
