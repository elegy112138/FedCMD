==================== ALGORITHM: FedFomo_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.8822 -> 1.6219   acc: 45.00% -> 49.29%             
client [81] (test)  loss: 1.3416 -> 1.1671   acc: 50.42% -> 55.74%             
client [21] (test)  loss: 17.0093 -> 1.9168   acc: 13.06% -> 53.61%            
client [68] (test)  loss: 2.2401 -> 2.1075   acc: 23.42% -> 24.05%             
client [93] (test)  loss: 1.8378 -> 1.4549   acc: 46.67% -> 66.98%             
client [31] (test)  loss: 1.6621 -> 1.2539   acc: 37.18% -> 65.01%             
client [20] (test)  loss: 1.7913 -> 1.5321   acc: 48.41% -> 52.87%             
client [59] (test)  loss: 12.8140 -> 1.7620   acc: 15.71% -> 42.86%            
client [48] (test)  loss: 0.5873 -> 0.4746   acc: 82.94% -> 86.61%             
client [34] (test)  loss: 1.5902 -> 1.1534   acc: 49.73% -> 67.12%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.1100 -> 0.9968   acc: 56.62% -> 72.73%             
client [99] (test)  loss: 2.7754 -> 1.4144   acc: 22.32% -> 59.04%             
client [67] (test)  loss: 1.5112 -> 1.2777   acc: 47.86% -> 55.42%             
client [0] (test)  loss: 0.8645 -> 0.7510   acc: 74.73% -> 77.39%              
client [76] (test)  loss: 0.5827 -> 0.5127   acc: 77.94% -> 82.01%             
client [41] (test)  loss: 1.9971 -> 1.7189   acc: 28.41% -> 45.39%             
client [62] (test)  loss: 16.8553 -> 2.0271   acc: 6.42% -> 28.75%             
client [2] (test)  loss: 16.4918 -> 1.8587   acc: 3.73% -> 39.63%              
client [14] (test)  loss: 1.0447 -> 0.8337   acc: 65.99% -> 77.08%             
client [46] (test)  loss: 0.8936 -> 0.7443   acc: 75.51% -> 79.01%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4485 -> 0.4376   acc: 85.64% -> 85.89%             
client [68] (test)  loss: 0.8904 -> 0.6673   acc: 65.19% -> 72.78%             
client [57] (test)  loss: 1.4253 -> 1.2137   acc: 53.79% -> 64.98%             
client [17] (test)  loss: 0.4231 -> 0.3646   acc: 86.91% -> 89.01%             
client [54] (test)  loss: 0.5338 -> 0.4852   acc: 85.44% -> 87.11%             
client [23] (test)  loss: 15.7227 -> 1.0955   acc: 11.04% -> 61.78%            
client [35] (test)  loss: 0.6679 -> 0.5719   acc: 80.97% -> 82.09%             
client [59] (test)  loss: 0.4877 -> 0.4240   acc: 88.00% -> 88.86%             
client [31] (test)  loss: 0.7283 -> 0.6976   acc: 74.16% -> 74.55%             
client [9] (test)  loss: 0.5935 -> 0.5722   acc: 77.08% -> 77.83%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8170 -> 0.7245   acc: 69.97% -> 75.35%             
client [33] (test)  loss: 0.6055 -> 0.5946   acc: 75.95% -> 76.22%             
client [16] (test)  loss: 0.3115 -> 0.2984   acc: 91.10% -> 91.10%             
client [44] (test)  loss: 1.0652 -> 0.5942   acc: 69.82% -> 81.06%             
client [8] (test)  loss: 0.6366 -> 0.6169   acc: 77.74% -> 79.03%              
client [31] (test)  loss: 0.6784 -> 0.6672   acc: 75.15% -> 75.15%             
client [47] (test)  loss: 0.8241 -> 0.6345   acc: 70.41% -> 77.15%             
client [36] (test)  loss: 0.6202 -> 0.6004   acc: 75.77% -> 75.77%             
client [20] (test)  loss: 0.6862 -> 0.6808   acc: 76.75% -> 77.07%             
client [56] (test)  loss: 0.5674 -> 0.5514   acc: 76.88% -> 77.50%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6790 -> 0.6576   acc: 70.88% -> 72.16%              
client [60] (test)  loss: 0.9461 -> 0.6927   acc: 66.83% -> 83.42%             
client [28] (test)  loss: 0.8898 -> 0.8714   acc: 69.59% -> 70.51%             
client [25] (test)  loss: 0.6369 -> 0.5911   acc: 74.41% -> 78.63%             
client [58] (test)  loss: 0.4082 -> 0.3902   acc: 86.39% -> 86.91%             
client [44] (test)  loss: 0.5942 -> 0.5148   acc: 81.06% -> 82.82%             
client [39] (test)  loss: 1.1155 -> 0.9618   acc: 75.20% -> 75.20%             
client [29] (test)  loss: 0.7423 -> 0.7276   acc: 71.86% -> 71.56%             
client [3] (test)  loss: 0.6822 -> 0.6327   acc: 80.17% -> 80.17%              
client [84] (test)  loss: 0.5668 -> 0.5538   acc: 79.13% -> 80.00%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7391 -> 0.5034   acc: 76.94% -> 85.28%             
client [84] (test)  loss: 0.5436 -> 0.5356   acc: 80.87% -> 80.87%             
client [10] (test)  loss: 0.5668 -> 0.4497   acc: 83.33% -> 85.83%             
client [36] (test)  loss: 0.5785 -> 0.5664   acc: 76.99% -> 77.30%             
client [65] (test)  loss: 0.4383 -> 0.4345   acc: 84.15% -> 84.60%             
client [81] (test)  loss: 0.8800 -> 0.8470   acc: 64.15% -> 64.43%             
client [79] (test)  loss: 0.6534 -> 0.6311   acc: 72.93% -> 74.03%             
client [42] (test)  loss: 0.5603 -> 0.5567   acc: 83.26% -> 82.79%             
client [11] (test)  loss: 0.7382 -> 0.5644   acc: 78.26% -> 82.25%             
client [96] (test)  loss: 0.4828 -> 0.4552   acc: 85.60% -> 86.70%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5913 -> 0.5844   acc: 80.00% -> 79.68%              
client [53] (test)  loss: 0.2640 -> 0.2584   acc: 91.01% -> 92.11%             
client [52] (test)  loss: 0.7035 -> 0.6988   acc: 71.47% -> 71.47%             
client [42] (test)  loss: 0.5521 -> 0.5522   acc: 82.79% -> 82.79%             
client [69] (test)  loss: 0.6157 -> 0.3541   acc: 76.10% -> 87.53%             
client [59] (test)  loss: 0.3530 -> 0.3437   acc: 89.43% -> 90.00%             
client [7] (test)  loss: 0.6269 -> 0.6251   acc: 77.22% -> 77.78%              
client [26] (test)  loss: 0.3428 -> 0.3212   acc: 88.42% -> 89.12%             
client [49] (test)  loss: 0.5542 -> 0.5484   acc: 78.76% -> 79.24%             
client [98] (test)  loss: 0.7322 -> 0.7194   acc: 71.11% -> 71.39%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.7194 -> 0.7073   acc: 71.39% -> 71.94%             
client [47] (test)  loss: 0.6275 -> 0.6238   acc: 75.66% -> 74.91%             
client [21] (test)  loss: 0.4906 -> 0.4802   acc: 85.56% -> 86.39%             
client [77] (test)  loss: 0.5512 -> 0.5409   acc: 79.64% -> 80.00%             
client [95] (test)  loss: 0.4296 -> 0.4262   acc: 84.51% -> 84.79%             
client [91] (test)  loss: 0.5771 -> 0.5634   acc: 79.21% -> 79.74%             
client [14] (test)  loss: 0.5603 -> 0.5496   acc: 82.62% -> 82.12%             
client [99] (test)  loss: 0.6386 -> 0.5750   acc: 80.23% -> 83.62%             
client [20] (test)  loss: 0.6922 -> 0.7032   acc: 78.66% -> 78.66%             
client [39] (test)  loss: 0.7937 -> 0.7358   acc: 76.84% -> 77.93%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6988 -> 0.6967   acc: 71.47% -> 72.02%             
client [62] (test)  loss: 0.5870 -> 0.5803   acc: 81.35% -> 81.35%             
client [71] (test)  loss: 0.4296 -> 0.4226   acc: 84.46% -> 85.31%             
client [97] (test)  loss: 0.7676 -> 0.7349   acc: 74.25% -> 74.63%             
client [30] (test)  loss: 0.5082 -> 0.5109   acc: 85.14% -> 85.14%             
client [88] (test)  loss: 0.6424 -> 0.6024   acc: 76.86% -> 77.13%             
client [60] (test)  loss: 0.3479 -> 0.3324   acc: 90.10% -> 89.60%             
client [82] (test)  loss: 0.4462 -> 0.4382   acc: 84.33% -> 84.08%             
client [91] (test)  loss: 0.5540 -> 0.5509   acc: 80.53% -> 81.05%             
client [57] (test)  loss: 0.4160 -> 0.4017   acc: 88.45% -> 89.53%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.7639 -> 0.7830   acc: 74.75% -> 74.75%             
client [15] (test)  loss: 0.5256 -> 0.5214   acc: 81.16% -> 81.72%             
client [71] (test)  loss: 0.4226 -> 0.4199   acc: 85.31% -> 85.59%             
client [97] (test)  loss: 0.6868 -> 0.6697   acc: 75.00% -> 75.75%             
client [53] (test)  loss: 0.2509 -> 0.2506   acc: 92.32% -> 92.32%             
client [77] (test)  loss: 0.5409 -> 0.5305   acc: 80.00% -> 80.36%             
client [76] (test)  loss: 0.3631 -> 0.3557   acc: 85.22% -> 85.65%             
client [79] (test)  loss: 0.5781 -> 0.5585   acc: 75.69% -> 76.80%             
client [28] (test)  loss: 0.8387 -> 0.8473   acc: 75.58% -> 75.12%             
client [99] (test)  loss: 0.5309 -> 0.5020   acc: 84.75% -> 85.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6578 -> 0.6489   acc: 76.49% -> 75.75%             
client [86] (test)  loss: 0.3468 -> 0.3423   acc: 86.74% -> 86.74%             
client [34] (test)  loss: 0.4671 -> 0.4705   acc: 85.33% -> 85.33%             
client [73] (test)  loss: 0.4789 -> 0.4737   acc: 84.18% -> 83.88%             
client [5] (test)  loss: 0.5481 -> 0.5525   acc: 80.46% -> 79.69%              
client [96] (test)  loss: 0.3641 -> 0.3691   acc: 89.47% -> 89.20%             
client [22] (test)  loss: 0.5006 -> 0.5038   acc: 81.29% -> 81.29%             
client [60] (test)  loss: 0.3059 -> 0.3000   acc: 89.36% -> 89.36%             
client [66] (test)  loss: 0.5352 -> 0.5342   acc: 78.89% -> 78.15%             
client [83] (test)  loss: 0.2805 -> 0.2743   acc: 91.49% -> 91.24%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3438 -> 0.3416   acc: 86.72% -> 87.37%             
client [65] (test)  loss: 0.4364 -> 0.4407   acc: 85.04% -> 84.82%             
client [95] (test)  loss: 0.4277 -> 0.4289   acc: 84.51% -> 85.07%             
client [17] (test)  loss: 0.3031 -> 0.3007   acc: 89.01% -> 89.01%             
client [8] (test)  loss: 0.5749 -> 0.5754   acc: 79.03% -> 78.71%              
client [35] (test)  loss: 0.4473 -> 0.4518   acc: 84.33% -> 83.77%             
client [98] (test)  loss: 0.6967 -> 0.6937   acc: 72.78% -> 73.06%             
client [53] (test)  loss: 0.2508 -> 0.2515   acc: 92.76% -> 92.76%             
client [43] (test)  loss: 0.2586 -> 0.2540   acc: 89.78% -> 90.86%             
client [64] (test)  loss: 0.5510 -> 0.5459   acc: 78.47% -> 78.75%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4713 -> 0.4672   acc: 86.39% -> 85.56%             
client [88] (test)  loss: 0.5558 -> 0.5642   acc: 76.86% -> 76.86%             
client [38] (test)  loss: 0.4571 -> 0.4613   acc: 86.48% -> 86.48%             
client [3] (test)  loss: 0.4545 -> 0.4517   acc: 83.47% -> 82.37%              
client [5] (test)  loss: 0.5584 -> 0.5638   acc: 79.31% -> 79.31%              
client [41] (test)  loss: 0.7016 -> 0.7017   acc: 72.32% -> 71.59%             
client [7] (test)  loss: 0.6294 -> 0.6328   acc: 78.61% -> 78.61%              
client [37] (test)  loss: 0.5136 -> 0.5062   acc: 83.80% -> 84.36%             
client [45] (test)  loss: 0.3876 -> 0.3722   acc: 84.03% -> 85.08%             
client [47] (test)  loss: 0.6187 -> 0.6167   acc: 75.28% -> 75.28%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2761 -> 0.2769   acc: 93.19% -> 93.19%             
client [11] (test)  loss: 0.5439 -> 0.5454   acc: 81.16% -> 81.16%             
client [37] (test)  loss: 0.4994 -> 0.4986   acc: 85.47% -> 85.47%             
client [41] (test)  loss: 0.7017 -> 0.7100   acc: 71.59% -> 71.59%             
client [95] (test)  loss: 0.4368 -> 0.4401   acc: 83.94% -> 83.94%             
client [53] (test)  loss: 0.2515 -> 0.2534   acc: 92.76% -> 92.98%             
client [22] (test)  loss: 0.5048 -> 0.5084   acc: 81.94% -> 80.97%             
client [25] (test)  loss: 0.5066 -> 0.5144   acc: 80.21% -> 80.47%             
client [69] (test)  loss: 0.3611 -> 0.3661   acc: 88.83% -> 88.83%             
client [46] (test)  loss: 0.5155 -> 0.5093   acc: 82.80% -> 83.09%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6167 -> 0.6187   acc: 76.03% -> 76.03%             
client [69] (test)  loss: 0.3714 -> 0.3768   acc: 88.83% -> 88.83%             
client [82] (test)  loss: 0.4234 -> 0.4211   acc: 85.07% -> 84.83%             
client [45] (test)  loss: 0.3559 -> 0.3524   acc: 88.74% -> 89.01%             
client [7] (test)  loss: 0.6328 -> 0.6379   acc: 78.61% -> 78.89%              
client [50] (test)  loss: 0.6361 -> 0.6309   acc: 76.75% -> 76.47%             
client [35] (test)  loss: 0.4637 -> 0.4702   acc: 84.70% -> 84.89%             
client [24] (test)  loss: 0.4835 -> 0.4889   acc: 86.15% -> 86.15%             
client [15] (test)  loss: 0.5200 -> 0.5220   acc: 81.72% -> 81.44%             
client [58] (test)  loss: 0.3843 -> 0.3880   acc: 89.27% -> 88.74%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3910 -> 0.3935   acc: 88.71% -> 88.19%             
client [76] (test)  loss: 0.3402 -> 0.3390   acc: 87.58% -> 87.58%             
client [67] (test)  loss: 0.3739 -> 0.3761   acc: 89.42% -> 89.92%             
client [37] (test)  loss: 0.4984 -> 0.4998   acc: 85.75% -> 85.47%             
client [58] (test)  loss: 0.3925 -> 0.3964   acc: 88.74% -> 89.01%             
client [64] (test)  loss: 0.5507 -> 0.5555   acc: 80.45% -> 80.45%             
client [77] (test)  loss: 0.5098 -> 0.5072   acc: 79.29% -> 79.64%             
client [55] (test)  loss: 0.7381 -> 0.7632   acc: 79.84% -> 79.65%             
client [12] (test)  loss: 0.7419 -> 0.7462   acc: 71.36% -> 70.45%             
client [89] (test)  loss: 0.4921 -> 0.4963   acc: 85.21% -> 84.89%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5397 -> 0.5446   acc: 82.03% -> 82.32%             
client [51] (test)  loss: 0.5691 -> 0.5714   acc: 82.28% -> 81.98%             
client [8] (test)  loss: 0.5953 -> 0.5986   acc: 78.39% -> 78.71%              
client [18] (test)  loss: 0.3994 -> 0.4010   acc: 83.89% -> 84.19%             
client [94] (test)  loss: 0.6353 -> 0.6461   acc: 78.51% -> 77.89%             
client [81] (test)  loss: 0.7466 -> 0.7516   acc: 73.39% -> 74.23%             
client [3] (test)  loss: 0.4664 -> 0.4791   acc: 83.47% -> 83.20%              
client [11] (test)  loss: 0.5526 -> 0.5561   acc: 80.43% -> 80.43%             
client [95] (test)  loss: 0.4636 -> 0.4681   acc: 83.94% -> 83.94%             
client [67] (test)  loss: 0.3761 -> 0.3791   acc: 89.92% -> 89.92%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4656 -> 0.4683   acc: 85.56% -> 85.28%             
client [79] (test)  loss: 0.6062 -> 0.6174   acc: 82.04% -> 81.77%             
client [58] (test)  loss: 0.4092 -> 0.4134   acc: 89.01% -> 89.01%             
client [88] (test)  loss: 0.5990 -> 0.6089   acc: 77.69% -> 77.41%             
client [46] (test)  loss: 0.4941 -> 0.4903   acc: 84.55% -> 84.26%             
client [11] (test)  loss: 0.5561 -> 0.5607   acc: 80.43% -> 80.80%             
client [55] (test)  loss: 0.8928 -> 0.9102   acc: 79.65% -> 79.65%             
client [13] (test)  loss: 0.5185 -> 0.5247   acc: 84.78% -> 84.51%             
client [31] (test)  loss: 0.8349 -> 0.8503   acc: 75.94% -> 76.34%             
client [75] (test)  loss: 0.4036 -> 0.4075   acc: 87.73% -> 88.34%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2964 -> 0.2967   acc: 91.38% -> 91.38%             
client [7] (test)  loss: 0.6864 -> 0.6995   acc: 79.72% -> 79.72%              
client [57] (test)  loss: 0.4084 -> 0.4115   acc: 89.53% -> 89.17%             
client [13] (test)  loss: 0.5306 -> 0.5358   acc: 84.51% -> 84.51%             
client [43] (test)  loss: 0.2447 -> 0.2440   acc: 90.86% -> 91.40%             
client [91] (test)  loss: 0.5726 -> 0.5857   acc: 81.32% -> 80.53%             
client [10] (test)  loss: 0.4055 -> 0.4075   acc: 87.50% -> 87.50%             
client [64] (test)  loss: 0.5916 -> 0.6002   acc: 79.04% -> 78.75%             
client [82] (test)  loss: 0.4493 -> 0.4538   acc: 86.57% -> 86.57%             
client [22] (test)  loss: 0.5257 -> 0.5298   acc: 81.29% -> 81.61%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7790 -> 0.7886   acc: 77.39% -> 77.39%             
client [23] (test)  loss: 0.3399 -> 0.3429   acc: 89.60% -> 89.81%             
client [88] (test)  loss: 0.6089 -> 0.6221   acc: 77.41% -> 77.13%             
client [98] (test)  loss: 0.7696 -> 0.7804   acc: 74.44% -> 74.72%             
client [79] (test)  loss: 0.6400 -> 0.6505   acc: 82.04% -> 82.32%             
client [21] (test)  loss: 0.4701 -> 0.4732   acc: 85.00% -> 84.72%             
client [92] (test)  loss: 0.6394 -> 0.6494   acc: 79.78% -> 80.05%             
client [56] (test)  loss: 0.5451 -> 0.5492   acc: 80.31% -> 80.31%             
client [5] (test)  loss: 0.6195 -> 0.6287   acc: 77.39% -> 77.39%              
client [52] (test)  loss: 0.7123 -> 0.7262   acc: 74.24% -> 73.68%             
==================== FedFomo_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.5158 -> 0.0000', 'accuracy': '81.82% -> 0.00%'},          
    200: {'loss': '0.5369 -> 0.0000', 'accuracy': '82.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_1 achieved 10.0%(16.74%) at epoch: 1                                   
FedFomo_1 achieved 20.0%(21.83%) at epoch: 2                                   
FedFomo_1 achieved 40.0%(45.66%) at epoch: 7                                   
FedFomo_1 achieved 50.0%(51.69%) at epoch: 16                                  
FedFomo_1 achieved 60.0%(61.90%) at epoch: 24                                  
FedFomo_1 achieved 70.0%(70.96%) at epoch: 28                                  
FedFomo_1 achieved 80.0%(84.77%) at epoch: 56                                  
Convergence (test_after):                                                      
FedFomo_1 achieved 40.0%(49.09%) at epoch: 0                                   
FedFomo_1 achieved 50.0%(54.37%) at epoch: 2                                   
FedFomo_1 achieved 60.0%(60.33%) at epoch: 12                                  
FedFomo_1 achieved 70.0%(73.77%) at epoch: 27                                  
FedFomo_1 achieved 80.0%(81.96%) at epoch: 37                                  
