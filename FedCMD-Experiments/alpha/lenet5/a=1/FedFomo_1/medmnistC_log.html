==================== ALGORITHM: FedFomo_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0337 -> 1.7186   acc: 23.39% -> 37.90%             
client [81] (test)  loss: 2.1940 -> 1.7189   acc: 11.48% -> 40.16%             
client [21] (test)  loss: 2.1383 -> 1.6928   acc: 33.61% -> 51.26%             
client [68] (test)  loss: 1.8771 -> 1.5434   acc: 57.58% -> 58.59%             
client [93] (test)  loss: 1.3034 -> 0.9323   acc: 74.17% -> 74.17%             
client [31] (test)  loss: 2.5001 -> 2.2687   acc: 11.54% -> 15.38%             
client [20] (test)  loss: 1.8837 -> 1.5691   acc: 45.32% -> 48.20%             
client [59] (test)  loss: 2.2234 -> 1.7464   acc: 36.22% -> 39.37%             
client [48] (test)  loss: 1.9918 -> 1.9168   acc: 30.91% -> 34.55%             
client [34] (test)  loss: 1.8595 -> 1.6816   acc: 34.51% -> 37.32%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6264 -> 1.4564   acc: 35.71% -> 51.79%             
client [99] (test)  loss: 1.9384 -> 1.7846   acc: 42.05% -> 42.05%             
client [67] (test)  loss: 1.9091 -> 1.7238   acc: 38.89% -> 37.30%             
client [0] (test)  loss: 1.3592 -> 1.1993   acc: 52.60% -> 56.65%              
client [76] (test)  loss: 1.4222 -> 1.2956   acc: 54.43% -> 54.43%             
client [41] (test)  loss: 1.9176 -> 1.6113   acc: 45.90% -> 45.08%             
client [62] (test)  loss: 2.1943 -> 1.8654   acc: 12.68% -> 40.85%             
client [2] (test)  loss: 2.1705 -> 1.2188   acc: 35.86% -> 64.14%              
client [14] (test)  loss: 1.4063 -> 1.3156   acc: 45.67% -> 49.61%             
client [46] (test)  loss: 1.5412 -> 1.4732   acc: 56.41% -> 57.26%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3853 -> 1.3163   acc: 64.29% -> 64.29%             
client [68] (test)  loss: 1.2859 -> 1.0542   acc: 41.41% -> 71.72%             
client [57] (test)  loss: 1.6754 -> 1.4419   acc: 50.29% -> 47.95%             
client [17] (test)  loss: 1.6048 -> 1.4880   acc: 56.73% -> 56.73%             
client [54] (test)  loss: 1.7826 -> 1.7424   acc: 36.49% -> 36.49%             
client [23] (test)  loss: 2.0843 -> 1.8600   acc: 39.19% -> 51.35%             
client [35] (test)  loss: 1.8792 -> 1.8437   acc: 40.48% -> 41.67%             
client [59] (test)  loss: 1.3745 -> 1.3002   acc: 48.03% -> 49.61%             
client [31] (test)  loss: 1.6045 -> 1.5594   acc: 51.28% -> 53.85%             
client [9] (test)  loss: 1.6632 -> 1.3232   acc: 36.08% -> 65.98%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.4048 -> 1.3172   acc: 53.60% -> 59.20%             
client [33] (test)  loss: 1.1272 -> 1.1065   acc: 57.94% -> 57.94%             
client [16] (test)  loss: 1.5205 -> 1.3822   acc: 58.33% -> 63.89%             
client [44] (test)  loss: 1.9066 -> 1.6713   acc: 46.67% -> 43.70%             
client [8] (test)  loss: 0.7808 -> 0.7381   acc: 75.69% -> 77.78%              
client [31] (test)  loss: 1.5305 -> 1.5111   acc: 51.28% -> 52.56%             
client [47] (test)  loss: 1.1793 -> 1.0584   acc: 68.91% -> 68.91%             
client [36] (test)  loss: 1.7926 -> 1.4936   acc: 48.72% -> 49.57%             
client [20] (test)  loss: 1.3160 -> 1.2758   acc: 52.52% -> 57.55%             
client [56] (test)  loss: 1.3673 -> 1.2508   acc: 53.85% -> 58.12%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.5488 -> 1.5003   acc: 44.83% -> 50.86%              
client [60] (test)  loss: 1.6732 -> 1.5687   acc: 43.42% -> 43.42%             
client [28] (test)  loss: 1.1410 -> 1.1004   acc: 62.10% -> 64.52%             
client [25] (test)  loss: 1.5784 -> 1.5277   acc: 54.55% -> 55.37%             
client [58] (test)  loss: 1.0557 -> 1.0141   acc: 62.50% -> 66.25%             
client [44] (test)  loss: 1.6713 -> 1.5549   acc: 43.70% -> 45.19%             
client [39] (test)  loss: 0.7066 -> 0.6736   acc: 76.43% -> 77.86%             
client [29] (test)  loss: 1.1302 -> 1.0737   acc: 58.82% -> 60.50%             
client [3] (test)  loss: 1.5515 -> 1.4768   acc: 50.00% -> 46.61%              
client [84] (test)  loss: 0.5123 -> 0.4864   acc: 85.89% -> 85.28%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2357 -> 1.1104   acc: 52.94% -> 65.55%             
client [84] (test)  loss: 0.4679 -> 0.4535   acc: 85.28% -> 85.89%             
client [10] (test)  loss: 1.7331 -> 1.6964   acc: 38.46% -> 35.90%             
client [36] (test)  loss: 1.3280 -> 1.2889   acc: 55.56% -> 58.12%             
client [65] (test)  loss: 1.4841 -> 1.4664   acc: 43.22% -> 43.22%             
client [81] (test)  loss: 1.4595 -> 1.4066   acc: 49.18% -> 53.28%             
client [79] (test)  loss: 1.3051 -> 1.2432   acc: 64.96% -> 66.67%             
client [42] (test)  loss: 1.3419 -> 1.2830   acc: 59.38% -> 62.50%             
client [11] (test)  loss: 1.3543 -> 1.3311   acc: 49.24% -> 54.55%             
client [96] (test)  loss: 1.3712 -> 1.1600   acc: 57.14% -> 62.18%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6681 -> 0.6436   acc: 79.17% -> 79.86%              
client [53] (test)  loss: 0.9987 -> 0.9786   acc: 58.82% -> 62.18%             
client [52] (test)  loss: 0.9540 -> 0.9366   acc: 72.09% -> 72.87%             
client [42] (test)  loss: 1.2331 -> 1.1901   acc: 62.50% -> 62.50%             
client [69] (test)  loss: 1.2149 -> 1.1988   acc: 58.04% -> 57.14%             
client [59] (test)  loss: 1.1397 -> 1.1060   acc: 53.54% -> 52.76%             
client [7] (test)  loss: 1.4511 -> 1.4092   acc: 51.11% -> 55.56%              
client [26] (test)  loss: 1.1303 -> 1.0524   acc: 73.85% -> 76.92%             
client [49] (test)  loss: 1.1340 -> 1.0963   acc: 58.82% -> 57.35%             
client [98] (test)  loss: 1.2902 -> 1.2581   acc: 62.28% -> 63.16%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.1132 -> 1.0024   acc: 63.16% -> 74.56%             
client [47] (test)  loss: 0.9892 -> 0.9469   acc: 67.23% -> 67.23%             
client [21] (test)  loss: 1.0386 -> 0.9888   acc: 71.43% -> 71.43%             
client [77] (test)  loss: 1.0930 -> 1.0550   acc: 56.45% -> 58.87%             
client [95] (test)  loss: 0.9807 -> 0.9750   acc: 75.98% -> 76.54%             
client [91] (test)  loss: 1.5417 -> 1.5144   acc: 39.68% -> 39.68%             
client [14] (test)  loss: 0.8115 -> 0.7440   acc: 75.59% -> 78.74%             
client [99] (test)  loss: 1.4324 -> 1.3978   acc: 55.68% -> 55.68%             
client [20] (test)  loss: 1.1468 -> 1.1276   acc: 63.31% -> 64.75%             
client [39] (test)  loss: 0.5383 -> 0.5160   acc: 85.00% -> 84.29%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9366 -> 0.9294   acc: 72.87% -> 73.64%             
client [62] (test)  loss: 0.9577 -> 0.9539   acc: 70.42% -> 74.65%             
client [71] (test)  loss: 1.3747 -> 1.0586   acc: 51.91% -> 64.89%             
client [97] (test)  loss: 0.7948 -> 0.7476   acc: 67.11% -> 69.13%             
client [30] (test)  loss: 1.0202 -> 0.9983   acc: 69.29% -> 70.08%             
client [88] (test)  loss: 1.4419 -> 1.3934   acc: 48.53% -> 52.21%             
client [60] (test)  loss: 1.3357 -> 1.1135   acc: 51.32% -> 65.79%             
client [82] (test)  loss: 1.0534 -> 1.0161   acc: 67.21% -> 66.39%             
client [91] (test)  loss: 1.4877 -> 1.4624   acc: 39.68% -> 41.27%             
client [57] (test)  loss: 1.1733 -> 1.1084   acc: 64.33% -> 66.08%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.4084 -> 1.4083   acc: 60.26% -> 60.26%             
client [15] (test)  loss: 0.7725 -> 0.7189   acc: 74.81% -> 77.10%             
client [71] (test)  loss: 1.0586 -> 1.0141   acc: 64.89% -> 67.94%             
client [97] (test)  loss: 0.9048 -> 0.5664   acc: 78.52% -> 85.23%             
client [53] (test)  loss: 1.5663 -> 0.8309   acc: 52.94% -> 68.91%             
client [77] (test)  loss: 1.4020 -> 1.0145   acc: 48.39% -> 58.87%             
client [76] (test)  loss: 1.1285 -> 0.8499   acc: 69.62% -> 75.95%             
client [79] (test)  loss: 1.1556 -> 1.1237   acc: 68.38% -> 70.09%             
client [28] (test)  loss: 0.9631 -> 0.9536   acc: 66.94% -> 66.94%             
client [99] (test)  loss: 1.3776 -> 1.3644   acc: 55.68% -> 55.68%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5160 -> 0.4897   acc: 85.91% -> 85.23%             
client [86] (test)  loss: 0.5789 -> 0.5731   acc: 80.49% -> 80.49%             
client [34] (test)  loss: 0.9173 -> 0.9109   acc: 69.72% -> 69.01%             
client [73] (test)  loss: 1.1418 -> 1.1185   acc: 52.80% -> 58.40%             
client [5] (test)  loss: 1.3684 -> 1.3496   acc: 50.48% -> 50.48%              
client [96] (test)  loss: 1.3822 -> 1.0464   acc: 63.87% -> 71.43%             
client [22] (test)  loss: 1.4124 -> 1.3983   acc: 42.99% -> 45.79%             
client [60] (test)  loss: 1.1146 -> 1.1193   acc: 71.05% -> 72.37%             
client [66] (test)  loss: 0.8402 -> 0.8350   acc: 68.55% -> 66.13%             
client [83] (test)  loss: 1.1493 -> 1.1170   acc: 69.91% -> 71.68%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6510 -> 0.6572   acc: 79.75% -> 79.75%             
client [65] (test)  loss: 1.1604 -> 1.1353   acc: 55.08% -> 54.24%             
client [95] (test)  loss: 0.9750 -> 0.9778   acc: 77.09% -> 77.09%             
client [17] (test)  loss: 1.3410 -> 1.3362   acc: 58.65% -> 59.62%             
client [8] (test)  loss: 0.6035 -> 0.5984   acc: 81.94% -> 81.94%              
client [35] (test)  loss: 0.9644 -> 0.9624   acc: 67.86% -> 69.05%             
client [98] (test)  loss: 0.9400 -> 0.9241   acc: 75.44% -> 76.32%             
client [53] (test)  loss: 1.1563 -> 0.7259   acc: 64.71% -> 75.63%             
client [43] (test)  loss: 0.6697 -> 0.6607   acc: 79.90% -> 81.82%             
client [64] (test)  loss: 1.0358 -> 1.0035   acc: 67.20% -> 67.20%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6455 -> 0.6160   acc: 85.71% -> 85.71%             
client [88] (test)  loss: 1.1481 -> 1.1212   acc: 61.03% -> 61.76%             
client [38] (test)  loss: 1.1855 -> 1.1719   acc: 55.95% -> 60.71%             
client [3] (test)  loss: 1.6256 -> 1.2542   acc: 52.54% -> 60.17%              
client [5] (test)  loss: 1.3350 -> 1.3264   acc: 52.38% -> 55.24%              
client [41] (test)  loss: 0.9755 -> 0.9760   acc: 71.31% -> 71.31%             
client [7] (test)  loss: 1.3337 -> 1.2983   acc: 60.74% -> 62.96%              
client [37] (test)  loss: 0.7199 -> 0.6914   acc: 76.42% -> 76.89%             
client [45] (test)  loss: 1.4656 -> 0.8290   acc: 60.61% -> 71.72%             
client [47] (test)  loss: 0.9014 -> 0.8892   acc: 68.07% -> 68.07%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9830 -> 0.9733   acc: 66.67% -> 66.67%             
client [11] (test)  loss: 0.8387 -> 0.8362   acc: 75.76% -> 74.24%             
client [37] (test)  loss: 0.6631 -> 0.6547   acc: 77.83% -> 78.77%             
client [41] (test)  loss: 0.9760 -> 0.9774   acc: 71.31% -> 71.31%             
client [95] (test)  loss: 1.0011 -> 1.0109   acc: 77.09% -> 77.09%             
client [53] (test)  loss: 0.7259 -> 0.7169   acc: 75.63% -> 73.95%             
client [22] (test)  loss: 1.3681 -> 1.3541   acc: 48.60% -> 49.53%             
client [25] (test)  loss: 1.2447 -> 1.2178   acc: 66.12% -> 66.12%             
client [69] (test)  loss: 0.8894 -> 0.8820   acc: 70.54% -> 70.54%             
client [46] (test)  loss: 1.1952 -> 1.1546   acc: 67.52% -> 67.52%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.8593 -> 0.8521   acc: 71.43% -> 73.11%             
client [69] (test)  loss: 0.8757 -> 0.8721   acc: 70.54% -> 70.54%             
client [82] (test)  loss: 1.2788 -> 0.9871   acc: 52.46% -> 67.21%             
client [45] (test)  loss: 0.7920 -> 0.7780   acc: 74.75% -> 73.74%             
client [7] (test)  loss: 1.2983 -> 1.2661   acc: 62.96% -> 61.48%              
client [50] (test)  loss: 0.4032 -> 0.3971   acc: 88.89% -> 88.15%             
client [35] (test)  loss: 0.6040 -> 0.6015   acc: 79.76% -> 78.57%             
client [24] (test)  loss: 1.0501 -> 1.0267   acc: 67.86% -> 66.07%             
client [15] (test)  loss: 0.6170 -> 0.6099   acc: 80.15% -> 79.39%             
client [58] (test)  loss: 0.7578 -> 0.7507   acc: 75.00% -> 75.00%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0815 -> 1.0724   acc: 65.45% -> 65.45%             
client [76] (test)  loss: 0.6751 -> 0.6823   acc: 81.01% -> 79.75%             
client [67] (test)  loss: 1.3079 -> 0.8467   acc: 56.35% -> 68.25%             
client [37] (test)  loss: 0.6499 -> 0.6460   acc: 79.25% -> 79.72%             
client [58] (test)  loss: 0.7447 -> 0.7392   acc: 74.38% -> 75.00%             
client [64] (test)  loss: 0.9278 -> 0.9084   acc: 68.80% -> 69.60%             
client [77] (test)  loss: 0.8808 -> 0.8614   acc: 65.32% -> 65.32%             
client [55] (test)  loss: 0.8354 -> 0.8269   acc: 72.22% -> 72.22%             
client [12] (test)  loss: 1.8235 -> 1.8345   acc: 42.14% -> 43.57%             
client [89] (test)  loss: 0.9571 -> 0.9621   acc: 71.74% -> 71.74%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3792 -> 0.3733   acc: 91.41% -> 90.18%             
client [51] (test)  loss: 0.5744 -> 0.5677   acc: 77.42% -> 78.06%             
client [8] (test)  loss: 0.5989 -> 0.6004   acc: 82.64% -> 82.64%              
client [18] (test)  loss: 1.1112 -> 1.1027   acc: 56.70% -> 57.73%             
client [94] (test)  loss: 0.7990 -> 0.7775   acc: 75.00% -> 75.00%             
client [81] (test)  loss: 1.0375 -> 1.0196   acc: 69.67% -> 68.85%             
client [3] (test)  loss: 1.6955 -> 1.2871   acc: 49.15% -> 62.71%              
client [11] (test)  loss: 0.8449 -> 0.8516   acc: 71.21% -> 69.70%             
client [95] (test)  loss: 0.7784 -> 0.7606   acc: 79.89% -> 78.21%             
client [67] (test)  loss: 0.8467 -> 0.8546   acc: 68.25% -> 69.84%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5910 -> 0.5820   acc: 85.71% -> 84.87%             
client [79] (test)  loss: 0.9754 -> 0.9660   acc: 70.09% -> 70.09%             
client [58] (test)  loss: 0.7250 -> 0.7217   acc: 75.62% -> 75.00%             
client [88] (test)  loss: 1.0666 -> 1.0530   acc: 63.97% -> 63.97%             
client [46] (test)  loss: 1.0846 -> 1.0721   acc: 69.23% -> 70.09%             
client [11] (test)  loss: 0.8516 -> 0.8591   acc: 69.70% -> 69.70%             
client [55] (test)  loss: 0.8245 -> 0.8255   acc: 74.60% -> 74.60%             
client [13] (test)  loss: 1.5296 -> 1.5133   acc: 53.66% -> 53.66%             
client [31] (test)  loss: 1.3912 -> 1.3895   acc: 60.26% -> 60.26%             
client [75] (test)  loss: 0.9917 -> 0.9892   acc: 68.91% -> 68.91%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7806 -> 0.7772   acc: 76.47% -> 77.31%             
client [7] (test)  loss: 1.1646 -> 1.1543   acc: 63.70% -> 64.44%              
client [57] (test)  loss: 0.5541 -> 0.5485   acc: 85.38% -> 84.80%             
client [13] (test)  loss: 1.4996 -> 1.4882   acc: 53.66% -> 53.66%             
client [43] (test)  loss: 0.6482 -> 0.6516   acc: 82.30% -> 82.30%             
client [91] (test)  loss: 0.9465 -> 0.8924   acc: 65.08% -> 69.84%             
client [10] (test)  loss: 0.9039 -> 0.9015   acc: 76.92% -> 76.92%             
client [64] (test)  loss: 0.8427 -> 0.8360   acc: 68.80% -> 69.60%             
client [82] (test)  loss: 0.9455 -> 0.8502   acc: 71.31% -> 72.95%             
client [22] (test)  loss: 1.2106 -> 1.1976   acc: 56.07% -> 57.94%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7368 -> 0.7255   acc: 76.98% -> 76.98%             
client [23] (test)  loss: 0.8188 -> 0.8308   acc: 70.27% -> 71.62%             
client [88] (test)  loss: 1.0530 -> 1.0453   acc: 63.97% -> 63.24%             
client [98] (test)  loss: 0.8848 -> 0.8856   acc: 78.07% -> 78.07%             
client [79] (test)  loss: 0.9550 -> 0.9492   acc: 70.94% -> 71.79%             
client [21] (test)  loss: 0.5754 -> 0.5692   acc: 84.87% -> 84.87%             
client [92] (test)  loss: 0.7645 -> 0.7675   acc: 73.08% -> 72.31%             
client [56] (test)  loss: 0.8685 -> 0.8616   acc: 68.38% -> 68.38%             
client [5] (test)  loss: 1.3259 -> 1.3291   acc: 51.43% -> 52.38%              
client [52] (test)  loss: 0.7783 -> 0.7823   acc: 79.07% -> 79.84%             
==================== FedFomo_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '1.0324 -> 0.0000', 'accuracy': '66.59% -> 0.00%'},          
    200: {'loss': '0.8379 -> 0.0000', 'accuracy': '73.18% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_1 achieved 10.0%(12.38%) at epoch: 0                                   
FedFomo_1 achieved 20.0%(29.63%) at epoch: 1                                   
FedFomo_1 achieved 30.0%(35.13%) at epoch: 4                                   
FedFomo_1 achieved 40.0%(40.28%) at epoch: 7                                   
FedFomo_1 achieved 50.0%(50.41%) at epoch: 13                                  
FedFomo_1 achieved 60.0%(60.66%) at epoch: 35                                  
FedFomo_1 achieved 70.0%(70.44%) at epoch: 90                                  
Convergence (test_after):                                                      
FedFomo_1 achieved 30.0%(31.70%) at epoch: 0                                   
FedFomo_1 achieved 40.0%(42.98%) at epoch: 3                                   
FedFomo_1 achieved 50.0%(51.15%) at epoch: 11                                  
FedFomo_1 achieved 60.0%(61.05%) at epoch: 20                                  
FedFomo_1 achieved 70.0%(71.51%) at epoch: 90                                  
