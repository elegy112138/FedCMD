==================== ALGORITHM: FedFomo_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7564 -> 1.4639   acc: 42.82% -> 57.72%             
client [81] (test)  loss: 1.7936 -> 1.5911   acc: 55.79% -> 56.61%             
client [21] (test)  loss: 14.8790 -> 2.0597   acc: 14.83% -> 50.95%            
client [68] (test)  loss: 1.8430 -> 1.2838   acc: 59.83% -> 71.51%             
client [93] (test)  loss: 1.7963 -> 1.4815   acc: 46.34% -> 50.98%             
client [31] (test)  loss: 1.7259 -> 1.5543   acc: 45.45% -> 45.78%             
client [20] (test)  loss: 1.1141 -> 0.8659   acc: 69.43% -> 75.80%             
client [59] (test)  loss: 12.5257 -> 1.7861   acc: 6.54% -> 50.41%             
client [48] (test)  loss: 1.3517 -> 1.2212   acc: 50.00% -> 56.76%             
client [34] (test)  loss: 2.0006 -> 1.7642   acc: 26.27% -> 41.81%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5170 -> 1.2386   acc: 51.90% -> 65.31%             
client [99] (test)  loss: 1.8418 -> 1.5640   acc: 41.95% -> 49.76%             
client [67] (test)  loss: 1.8951 -> 1.3917   acc: 41.31% -> 60.23%             
client [0] (test)  loss: 1.3028 -> 1.0091   acc: 67.20% -> 70.13%              
client [76] (test)  loss: 0.9608 -> 0.7733   acc: 87.85% -> 86.92%             
client [41] (test)  loss: 1.8165 -> 1.5722   acc: 37.90% -> 44.06%             
client [62] (test)  loss: 15.2000 -> 1.8904   acc: 9.50% -> 39.66%             
client [2] (test)  loss: 18.5188 -> 1.9896   acc: 7.22% -> 40.43%              
client [14] (test)  loss: 1.3482 -> 1.1486   acc: 69.61% -> 74.59%             
client [46] (test)  loss: 1.5968 -> 1.3870   acc: 48.15% -> 51.52%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.7445 -> 1.5454   acc: 45.14% -> 49.42%             
client [68] (test)  loss: 0.5075 -> 0.4241   acc: 87.18% -> 89.46%             
client [57] (test)  loss: 1.3454 -> 1.1030   acc: 59.06% -> 62.73%             
client [17] (test)  loss: 0.8469 -> 0.5109   acc: 78.15% -> 88.60%             
client [54] (test)  loss: 0.7424 -> 0.6599   acc: 78.27% -> 79.67%             
client [23] (test)  loss: 8.1712 -> 1.6496   acc: 34.17% -> 56.58%             
client [35] (test)  loss: 1.0864 -> 0.9637   acc: 61.48% -> 67.21%             
client [59] (test)  loss: 0.5624 -> 0.4490   acc: 82.83% -> 86.92%             
client [31] (test)  loss: 0.9831 -> 0.8952   acc: 70.45% -> 72.40%             
client [9] (test)  loss: 0.8648 -> 0.7584   acc: 71.55% -> 78.02%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.3641 -> 0.2443   acc: 91.62% -> 93.46%             
client [33] (test)  loss: 0.9998 -> 0.8679   acc: 69.74% -> 76.97%             
client [16] (test)  loss: 0.3830 -> 0.3097   acc: 87.84% -> 89.83%             
client [44] (test)  loss: 2.0887 -> 1.8293   acc: 30.38% -> 32.15%             
client [8] (test)  loss: 0.6452 -> 0.6162   acc: 78.57% -> 80.10%              
client [31] (test)  loss: 0.8263 -> 0.7719   acc: 74.03% -> 75.65%             
client [47] (test)  loss: 0.7984 -> 0.3941   acc: 76.96% -> 85.51%             
client [36] (test)  loss: 1.9638 -> 1.5686   acc: 32.60% -> 63.02%             
client [20] (test)  loss: 0.4678 -> 0.4149   acc: 87.05% -> 88.75%             
client [56] (test)  loss: 1.5004 -> 1.2579   acc: 47.89% -> 59.72%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3246 -> 0.2991   acc: 91.63% -> 91.63%              
client [60] (test)  loss: 0.4796 -> 0.3583   acc: 88.51% -> 91.69%             
client [28] (test)  loss: 0.4408 -> 0.3599   acc: 88.62% -> 90.00%             
client [25] (test)  loss: 1.1090 -> 0.8918   acc: 70.17% -> 76.52%             
client [58] (test)  loss: 0.4126 -> 0.1811   acc: 88.92% -> 94.18%             
client [44] (test)  loss: 1.8292 -> 1.5726   acc: 32.15% -> 55.75%             
client [39] (test)  loss: 1.1418 -> 0.5250   acc: 60.43% -> 87.29%             
client [29] (test)  loss: 0.9622 -> 0.8796   acc: 68.33% -> 70.42%             
client [3] (test)  loss: 0.8090 -> 0.6467   acc: 78.14% -> 82.09%              
client [84] (test)  loss: 0.8110 -> 0.7345   acc: 72.94% -> 73.45%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6387 -> 0.5203   acc: 85.17% -> 85.17%             
client [84] (test)  loss: 0.6734 -> 0.6231   acc: 76.55% -> 79.12%             
client [10] (test)  loss: 0.3752 -> 0.2117   acc: 86.97% -> 94.15%             
client [36] (test)  loss: 0.4164 -> 0.3644   acc: 89.78% -> 90.51%             
client [65] (test)  loss: 0.3980 -> 0.3793   acc: 88.04% -> 87.77%             
client [81] (test)  loss: 0.3208 -> 0.3063   acc: 89.67% -> 90.50%             
client [79] (test)  loss: 0.2342 -> 0.2095   acc: 93.23% -> 93.75%             
client [42] (test)  loss: 0.3482 -> 0.3307   acc: 91.74% -> 91.74%             
client [11] (test)  loss: 0.5854 -> 0.1528   acc: 83.66% -> 96.62%             
client [96] (test)  loss: 0.3716 -> 0.3387   acc: 89.45% -> 90.20%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2923 -> 0.2850   acc: 92.09% -> 91.84%              
client [53] (test)  loss: 0.4873 -> 0.4475   acc: 87.80% -> 88.21%             
client [52] (test)  loss: 0.5895 -> 0.5478   acc: 85.05% -> 85.41%             
client [42] (test)  loss: 0.3169 -> 0.3054   acc: 91.74% -> 92.56%             
client [69] (test)  loss: 0.5705 -> 0.5397   acc: 86.30% -> 86.88%             
client [59] (test)  loss: 0.1869 -> 0.1796   acc: 94.55% -> 94.28%             
client [7] (test)  loss: 0.2778 -> 0.2428   acc: 91.41% -> 94.01%              
client [26] (test)  loss: 0.5142 -> 0.4497   acc: 84.80% -> 88.11%             
client [49] (test)  loss: 0.1999 -> 0.1842   acc: 95.75% -> 95.75%             
client [98] (test)  loss: 0.4170 -> 0.4041   acc: 90.26% -> 90.64%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4041 -> 0.3954   acc: 90.64% -> 90.64%             
client [47] (test)  loss: 0.3340 -> 0.2967   acc: 87.65% -> 88.60%             
client [21] (test)  loss: 0.2281 -> 0.2231   acc: 93.54% -> 93.54%             
client [77] (test)  loss: 0.4775 -> 0.4323   acc: 85.91% -> 86.72%             
client [95] (test)  loss: 0.3668 -> 0.3418   acc: 89.72% -> 90.49%             
client [91] (test)  loss: 0.3881 -> 0.3640   acc: 90.27% -> 91.15%             
client [14] (test)  loss: 0.3662 -> 0.3619   acc: 89.50% -> 89.50%             
client [99] (test)  loss: 0.2927 -> 0.2788   acc: 91.22% -> 90.98%             
client [20] (test)  loss: 0.2677 -> 0.1669   acc: 92.57% -> 94.48%             
client [39] (test)  loss: 0.3428 -> 0.3045   acc: 90.41% -> 91.85%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5478 -> 0.5149   acc: 85.41% -> 86.12%             
client [62] (test)  loss: 0.2745 -> 0.2671   acc: 92.18% -> 92.18%             
client [71] (test)  loss: 0.1912 -> 0.1894   acc: 95.37% -> 95.37%             
client [97] (test)  loss: 0.1615 -> 0.1568   acc: 96.56% -> 96.25%             
client [30] (test)  loss: 0.2233 -> 0.2165   acc: 93.82% -> 94.28%             
client [88] (test)  loss: 0.2604 -> 0.2342   acc: 93.82% -> 94.46%             
client [60] (test)  loss: 0.2051 -> 0.1958   acc: 94.38% -> 94.38%             
client [82] (test)  loss: 0.3383 -> 0.3291   acc: 90.61% -> 90.61%             
client [91] (test)  loss: 0.3444 -> 0.3285   acc: 91.15% -> 90.71%             
client [57] (test)  loss: 0.2165 -> 0.1928   acc: 94.23% -> 94.49%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2766 -> 0.2761   acc: 91.56% -> 91.56%             
client [15] (test)  loss: 0.2157 -> 0.2010   acc: 94.76% -> 93.15%             
client [71] (test)  loss: 0.1894 -> 0.1886   acc: 95.37% -> 95.10%             
client [97] (test)  loss: 0.1496 -> 0.1473   acc: 95.62% -> 95.62%             
client [53] (test)  loss: 0.3891 -> 0.3801   acc: 89.43% -> 89.84%             
client [77] (test)  loss: 0.4323 -> 0.4002   acc: 86.72% -> 87.80%             
client [76] (test)  loss: 0.1122 -> 0.1113   acc: 97.20% -> 97.20%             
client [79] (test)  loss: 0.1824 -> 0.1748   acc: 94.10% -> 94.44%             
client [28] (test)  loss: 0.3225 -> 0.3210   acc: 90.34% -> 90.69%             
client [99] (test)  loss: 0.2694 -> 0.2622   acc: 91.71% -> 91.71%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.1458 -> 0.1447   acc: 95.62% -> 95.62%             
client [86] (test)  loss: 0.2084 -> 0.2070   acc: 96.01% -> 95.65%             
client [34] (test)  loss: 0.1914 -> 0.1891   acc: 93.79% -> 93.79%             
client [73] (test)  loss: 0.1429 -> 0.1325   acc: 97.33% -> 97.59%             
client [5] (test)  loss: 0.2950 -> 0.2896   acc: 90.61% -> 90.61%              
client [96] (test)  loss: 0.1827 -> 0.1819   acc: 94.72% -> 94.97%             
client [22] (test)  loss: 0.1692 -> 0.1627   acc: 94.35% -> 94.63%             
client [60] (test)  loss: 0.1790 -> 0.1756   acc: 94.87% -> 95.11%             
client [66] (test)  loss: 0.1411 -> 0.1389   acc: 95.54% -> 95.33%             
client [83] (test)  loss: 0.2633 -> 0.2566   acc: 92.07% -> 91.82%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1099 -> 0.1097   acc: 97.20% -> 97.20%             
client [65] (test)  loss: 0.3557 -> 0.3486   acc: 89.13% -> 89.13%             
client [95] (test)  loss: 0.2948 -> 0.2844   acc: 91.52% -> 92.03%             
client [17] (test)  loss: 0.1606 -> 0.1504   acc: 95.49% -> 95.49%             
client [8] (test)  loss: 0.2783 -> 0.2785   acc: 92.09% -> 92.09%              
client [35] (test)  loss: 0.2109 -> 0.2098   acc: 94.54% -> 94.26%             
client [98] (test)  loss: 0.3850 -> 0.3820   acc: 91.01% -> 91.01%             
client [53] (test)  loss: 0.3731 -> 0.3681   acc: 89.84% -> 89.84%             
client [43] (test)  loss: 0.2269 -> 0.2241   acc: 91.63% -> 91.25%             
client [64] (test)  loss: 0.1027 -> 0.0950   acc: 97.12% -> 97.12%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2210 -> 0.2207   acc: 93.92% -> 93.92%             
client [88] (test)  loss: 0.1365 -> 0.1345   acc: 96.16% -> 96.16%             
client [38] (test)  loss: 0.2172 -> 0.2165   acc: 93.45% -> 93.45%             
client [3] (test)  loss: 0.3158 -> 0.3119   acc: 89.77% -> 89.53%              
client [5] (test)  loss: 0.2849 -> 0.2817   acc: 90.61% -> 90.36%              
client [41] (test)  loss: 0.2150 -> 0.2125   acc: 92.69% -> 92.92%             
client [7] (test)  loss: 0.2308 -> 0.2256   acc: 94.01% -> 93.75%              
client [37] (test)  loss: 0.1293 -> 0.1291   acc: 95.63% -> 95.63%             
client [45] (test)  loss: 0.2178 -> 0.2068   acc: 93.01% -> 93.26%             
client [47] (test)  loss: 0.2552 -> 0.2439   acc: 90.97% -> 91.45%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.2011 -> 0.2000   acc: 92.56% -> 93.05%             
client [11] (test)  loss: 0.1117 -> 0.1101   acc: 96.90% -> 96.90%             
client [37] (test)  loss: 0.1291 -> 0.1294   acc: 95.63% -> 95.63%             
client [41] (test)  loss: 0.2125 -> 0.2106   acc: 92.92% -> 92.92%             
client [95] (test)  loss: 0.2617 -> 0.2566   acc: 92.03% -> 92.29%             
client [53] (test)  loss: 0.3681 -> 0.3648   acc: 89.84% -> 89.02%             
client [22] (test)  loss: 0.1573 -> 0.1529   acc: 94.63% -> 94.63%             
client [25] (test)  loss: 0.2219 -> 0.2162   acc: 93.65% -> 93.65%             
client [69] (test)  loss: 0.4366 -> 0.4335   acc: 88.05% -> 88.05%             
client [46] (test)  loss: 0.2659 -> 0.2631   acc: 92.26% -> 91.92%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2239 -> 0.2221   acc: 91.92% -> 91.92%             
client [69] (test)  loss: 0.4554 -> 0.2399   acc: 87.17% -> 91.25%             
client [82] (test)  loss: 0.3113 -> 0.3094   acc: 91.02% -> 91.02%             
client [45] (test)  loss: 0.1936 -> 0.1894   acc: 93.52% -> 93.52%             
client [7] (test)  loss: 0.2256 -> 0.2214   acc: 93.75% -> 94.01%              
client [50] (test)  loss: 0.0616 -> 0.0607   acc: 98.09% -> 98.09%             
client [35] (test)  loss: 0.2082 -> 0.2079   acc: 94.26% -> 94.26%             
client [24] (test)  loss: 0.2972 -> 0.2661   acc: 89.11% -> 93.00%             
client [15] (test)  loss: 0.1834 -> 0.1824   acc: 93.95% -> 93.95%             
client [58] (test)  loss: 0.1255 -> 0.1217   acc: 95.57% -> 95.84%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2347 -> 0.2328   acc: 93.58% -> 93.58%             
client [76] (test)  loss: 0.1092 -> 0.1091   acc: 97.20% -> 97.20%             
client [67] (test)  loss: 0.5496 -> 0.5367   acc: 82.63% -> 82.63%             
client [37] (test)  loss: 0.1296 -> 0.1299   acc: 95.63% -> 95.63%             
client [58] (test)  loss: 0.1195 -> 0.1184   acc: 96.12% -> 96.12%             
client [64] (test)  loss: 0.0801 -> 0.0770   acc: 97.38% -> 97.38%             
client [77] (test)  loss: 0.3412 -> 0.3346   acc: 89.16% -> 89.16%             
client [55] (test)  loss: 0.2494 -> 0.1913   acc: 92.55% -> 94.51%             
client [12] (test)  loss: 0.1690 -> 0.1679   acc: 93.45% -> 93.45%             
client [89] (test)  loss: 0.2005 -> 0.1998   acc: 94.49% -> 94.49%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3737 -> 0.3718   acc: 88.92% -> 89.18%             
client [51] (test)  loss: 0.2226 -> 0.2233   acc: 94.15% -> 94.33%             
client [8] (test)  loss: 0.2885 -> 0.2903   acc: 92.09% -> 92.09%              
client [18] (test)  loss: 0.3146 -> 0.3108   acc: 91.24% -> 91.24%             
client [94] (test)  loss: 0.1495 -> 0.1483   acc: 96.35% -> 96.35%             
client [81] (test)  loss: 0.1548 -> 0.1519   acc: 93.39% -> 94.63%             
client [3] (test)  loss: 0.3041 -> 0.3027   acc: 90.00% -> 90.23%              
client [11] (test)  loss: 0.1069 -> 0.1061   acc: 96.90% -> 96.90%             
client [95] (test)  loss: 0.2410 -> 0.2395   acc: 92.54% -> 92.54%             
client [67] (test)  loss: 0.5367 -> 0.5267   acc: 82.63% -> 83.01%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2225 -> 0.2237   acc: 93.16% -> 93.54%             
client [79] (test)  loss: 0.1513 -> 0.1505   acc: 95.66% -> 95.49%             
client [58] (test)  loss: 0.1416 -> 0.1396   acc: 95.57% -> 95.57%             
client [88] (test)  loss: 0.1314 -> 0.1309   acc: 95.95% -> 95.95%             
client [46] (test)  loss: 0.2610 -> 0.2611   acc: 91.92% -> 91.92%             
client [11] (test)  loss: 0.1061 -> 0.1054   acc: 96.90% -> 96.34%             
client [55] (test)  loss: 0.1899 -> 0.1872   acc: 93.33% -> 93.33%             
client [13] (test)  loss: 0.2982 -> 0.2973   acc: 89.31% -> 89.69%             
client [31] (test)  loss: 0.2762 -> 0.2767   acc: 91.56% -> 91.56%             
client [75] (test)  loss: 0.0982 -> 0.0938   acc: 96.88% -> 96.88%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1416 -> 0.1422   acc: 95.74% -> 95.74%             
client [7] (test)  loss: 0.2112 -> 0.2103   acc: 94.01% -> 94.01%              
client [57] (test)  loss: 0.1728 -> 0.1725   acc: 95.80% -> 96.06%             
client [13] (test)  loss: 0.3380 -> 0.3205   acc: 90.08% -> 90.84%             
client [43] (test)  loss: 0.2197 -> 0.2199   acc: 90.87% -> 90.87%             
client [91] (test)  loss: 0.3484 -> 0.1818   acc: 85.84% -> 95.58%             
client [10] (test)  loss: 0.1471 -> 0.1467   acc: 96.28% -> 96.28%             
client [64] (test)  loss: 0.0672 -> 0.0660   acc: 98.17% -> 98.17%             
client [82] (test)  loss: 0.3052 -> 0.3053   acc: 90.61% -> 91.02%             
client [22] (test)  loss: 0.1410 -> 0.1397   acc: 95.76% -> 95.76%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1261 -> 0.1252   acc: 96.39% -> 96.39%             
client [23] (test)  loss: 0.1835 -> 0.1834   acc: 94.96% -> 94.96%             
client [88] (test)  loss: 0.1309 -> 0.1305   acc: 95.95% -> 95.95%             
client [98] (test)  loss: 0.2658 -> 0.2664   acc: 92.88% -> 93.26%             
client [79] (test)  loss: 0.1495 -> 0.1490   acc: 95.66% -> 95.83%             
client [21] (test)  loss: 0.1993 -> 0.1927   acc: 94.30% -> 94.68%             
client [92] (test)  loss: 0.1442 -> 0.1445   acc: 96.51% -> 96.51%             
client [56] (test)  loss: 0.1709 -> 0.1712   acc: 97.18% -> 97.18%             
client [5] (test)  loss: 0.2709 -> 0.2701   acc: 91.37% -> 91.37%              
client [52] (test)  loss: 0.2380 -> 0.2385   acc: 92.53% -> 92.53%             
==================== FedFomo_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.2606 -> 0.0000', 'accuracy': '92.42% -> 0.00%'},          
    200: {'loss': '0.2010 -> 0.0000', 'accuracy': '93.92% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_1 achieved 10.0%(12.68%) at epoch: 0                                   
FedFomo_1 achieved 20.0%(22.42%) at epoch: 1                                   
FedFomo_1 achieved 40.0%(45.07%) at epoch: 7                                   
FedFomo_1 achieved 50.0%(54.84%) at epoch: 16                                  
FedFomo_1 achieved 60.0%(65.14%) at epoch: 24                                  
FedFomo_1 achieved 70.0%(71.57%) at epoch: 30                                  
FedFomo_1 achieved 80.0%(82.75%) at epoch: 38                                  
FedFomo_1 achieved 90.0%(90.78%) at epoch: 63                                  
Convergence (test_after):                                                      
FedFomo_1 achieved 30.0%(38.81%) at epoch: 0                                   
FedFomo_1 achieved 40.0%(46.65%) at epoch: 1                                   
FedFomo_1 achieved 50.0%(54.77%) at epoch: 7                                   
FedFomo_1 achieved 60.0%(64.74%) at epoch: 16                                  
FedFomo_1 achieved 70.0%(72.69%) at epoch: 24                                  
FedFomo_1 achieved 80.0%(80.22%) at epoch: 34                                  
FedFomo_1 achieved 90.0%(92.22%) at epoch: 53                                  
