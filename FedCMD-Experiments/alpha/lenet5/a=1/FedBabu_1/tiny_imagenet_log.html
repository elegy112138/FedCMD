==================== ALGORITHM: FedBabu_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2347 -> 5.1858   acc: 0.72% -> 3.60%               
client [81] (test)  loss: 5.2520 -> 5.2051   acc: 1.29% -> 2.77%               
client [21] (test)  loss: 5.2771 -> 5.1702   acc: 0.73% -> 2.54%               
client [68] (test)  loss: 5.2444 -> 5.1172   acc: 1.08% -> 5.24%               
client [93] (test)  loss: 5.2436 -> 5.1763   acc: 1.27% -> 2.36%               
client [31] (test)  loss: 5.2748 -> 5.2171   acc: 1.80% -> 4.86%               
client [20] (test)  loss: 5.2400 -> 5.0992   acc: 1.32% -> 8.51%               
client [59] (test)  loss: 5.2814 -> 5.1929   acc: 2.91% -> 2.00%               
client [48] (test)  loss: 5.2383 -> 5.1544   acc: 1.97% -> 4.48%               
client [34] (test)  loss: 5.2005 -> 5.1506   acc: 1.82% -> 1.64%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.2866 -> 5.1002   acc: 1.85% -> 3.70%               
client [99] (test)  loss: 5.2111 -> 5.1266   acc: 2.53% -> 5.60%               
client [67] (test)  loss: 5.2803 -> 5.1610   acc: 2.05% -> 2.43%               
client [0] (test)  loss: 5.1727 -> 5.0884   acc: 2.36% -> 3.80%                
client [76] (test)  loss: 5.2152 -> 5.0809   acc: 2.18% -> 4.90%               
client [41] (test)  loss: 5.2261 -> 5.1504   acc: 1.09% -> 1.63%               
client [62] (test)  loss: 5.2533 -> 5.1346   acc: 1.08% -> 3.05%               
client [2] (test)  loss: 5.2988 -> 5.1976   acc: 0.77% -> 5.95%                
client [14] (test)  loss: 5.1369 -> 5.0675   acc: 3.07% -> 5.23%               
client [46] (test)  loss: 5.2935 -> 5.1695   acc: 0.91% -> 2.90%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 5.1757 -> 4.8939   acc: 2.85% -> 12.66%              
client [68] (test)  loss: 5.2405 -> 5.0973   acc: 2.71% -> 3.80%               
client [57] (test)  loss: 5.2251 -> 5.0824   acc: 2.36% -> 4.36%               
client [17] (test)  loss: 5.2338 -> 5.1122   acc: 3.24% -> 5.23%               
client [54] (test)  loss: 5.1278 -> 5.0368   acc: 2.54% -> 5.26%               
client [23] (test)  loss: 5.2667 -> 5.1286   acc: 1.27% -> 3.25%               
client [35] (test)  loss: 5.0752 -> 5.0147   acc: 3.45% -> 3.81%               
client [59] (test)  loss: 5.1816 -> 5.1292   acc: 2.00% -> 4.36%               
client [31] (test)  loss: 5.1736 -> 5.1782   acc: 3.78% -> 6.31%               
client [9] (test)  loss: 5.2476 -> 5.2258   acc: 2.17% -> 3.25%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.1240 -> 5.0648   acc: 2.23% -> 5.76%               
client [33] (test)  loss: 5.1097 -> 5.1588   acc: 2.54% -> 3.44%               
client [16] (test)  loss: 5.2065 -> 5.0770   acc: 2.87% -> 6.10%               
client [44] (test)  loss: 5.6774 -> 5.1338   acc: 2.31% -> 3.37%               
client [8] (test)  loss: 5.2046 -> 5.0914   acc: 2.35% -> 5.96%                
client [31] (test)  loss: 5.1931 -> 5.1812   acc: 2.88% -> 5.41%               
client [47] (test)  loss: 5.2767 -> 5.0410   acc: 1.81% -> 4.69%               
client [36] (test)  loss: 5.1440 -> 5.0508   acc: 2.55% -> 4.91%               
client [20] (test)  loss: 5.0704 -> 4.9044   acc: 4.35% -> 9.07%               
client [56] (test)  loss: 5.2195 -> 5.0861   acc: 3.07% -> 2.35%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.1083 -> 5.0574   acc: 2.54% -> 4.90%                
client [60] (test)  loss: 5.6802 -> 4.9589   acc: 2.88% -> 7.91%               
client [28] (test)  loss: 5.4160 -> 5.0135   acc: 2.72% -> 3.99%               
client [25] (test)  loss: 6.0843 -> 5.1470   acc: 1.44% -> 3.96%               
client [58] (test)  loss: 5.2407 -> 5.1603   acc: 3.06% -> 3.60%               
client [44] (test)  loss: 5.1836 -> 5.2004   acc: 4.80% -> 2.84%               
client [39] (test)  loss: 5.1087 -> 4.9679   acc: 3.09% -> 6.73%               
client [29] (test)  loss: 5.7168 -> 5.1185   acc: 1.23% -> 3.85%               
client [3] (test)  loss: 5.2129 -> 4.9270   acc: 2.68% -> 6.80%                
client [84] (test)  loss: 5.1490 -> 5.0111   acc: 3.80% -> 5.07%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.2116 -> 5.0236   acc: 4.36% -> 5.44%               
client [84] (test)  loss: 5.1338 -> 5.0448   acc: 3.80% -> 5.98%               
client [10] (test)  loss: 5.4747 -> 5.0967   acc: 3.42% -> 5.40%               
client [36] (test)  loss: 5.1394 -> 5.0037   acc: 2.00% -> 6.00%               
client [65] (test)  loss: 5.0422 -> 5.1123   acc: 6.35% -> 6.35%               
client [81] (test)  loss: 5.3068 -> 5.1154   acc: 3.14% -> 3.69%               
client [79] (test)  loss: 5.3320 -> 5.1267   acc: 3.37% -> 3.02%               
client [42] (test)  loss: 5.1866 -> 5.0994   acc: 3.40% -> 6.42%               
client [11] (test)  loss: 5.3637 -> 5.0709   acc: 3.24% -> 4.32%               
client [96] (test)  loss: 5.2268 -> 4.9141   acc: 5.05% -> 7.57%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.3349 -> 5.1955   acc: 4.33% -> 6.50%                
client [53] (test)  loss: 5.4234 -> 5.0977   acc: 3.00% -> 4.76%               
client [52] (test)  loss: 5.2123 -> 5.1382   acc: 2.90% -> 5.43%               
client [42] (test)  loss: 5.1709 -> 5.1475   acc: 3.77% -> 6.60%               
client [69] (test)  loss: 5.1628 -> 5.0961   acc: 5.19% -> 5.93%               
client [59] (test)  loss: 5.1957 -> 5.1286   acc: 2.00% -> 4.55%               
client [7] (test)  loss: 5.3982 -> 5.1328   acc: 3.08% -> 6.16%                
client [26] (test)  loss: 5.0890 -> 4.9856   acc: 4.68% -> 4.86%               
client [49] (test)  loss: 5.1857 -> 5.2264   acc: 4.87% -> 4.33%               
client [98] (test)  loss: 5.1208 -> 5.0850   acc: 3.45% -> 6.55%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 5.1915 -> 5.1329   acc: 4.36% -> 7.09%               
client [47] (test)  loss: 5.7408 -> 5.1279   acc: 2.53% -> 6.14%               
client [21] (test)  loss: 5.0512 -> 5.1305   acc: 4.54% -> 5.44%               
client [77] (test)  loss: 5.1505 -> 5.0945   acc: 4.14% -> 6.12%               
client [95] (test)  loss: 5.1738 -> 5.0671   acc: 3.94% -> 6.00%               
client [91] (test)  loss: 5.4359 -> 5.3227   acc: 3.64% -> 4.73%               
client [14] (test)  loss: 5.0067 -> 5.0867   acc: 5.05% -> 6.50%               
client [99] (test)  loss: 5.0675 -> 5.2030   acc: 5.23% -> 5.78%               
client [20] (test)  loss: 5.1988 -> 4.9186   acc: 4.16% -> 9.64%               
client [39] (test)  loss: 5.2908 -> 5.0434   acc: 4.36% -> 7.82%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.3598 -> 5.2326   acc: 4.89% -> 5.25%               
client [62] (test)  loss: 5.1716 -> 5.2468   acc: 3.41% -> 4.31%               
client [71] (test)  loss: 5.2185 -> 5.2654   acc: 4.66% -> 5.91%               
client [97] (test)  loss: 5.2326 -> 5.2954   acc: 2.55% -> 2.73%               
client [30] (test)  loss: 5.1148 -> 5.2672   acc: 4.53% -> 5.07%               
client [88] (test)  loss: 5.3415 -> 5.2214   acc: 3.07% -> 5.24%               
client [60] (test)  loss: 5.3430 -> 5.0963   acc: 3.96% -> 8.81%               
client [82] (test)  loss: 5.1381 -> 5.0520   acc: 5.89% -> 9.82%               
client [91] (test)  loss: 5.3569 -> 5.4440   acc: 5.09% -> 4.36%               
client [57] (test)  loss: 5.1772 -> 5.1439   acc: 3.45% -> 6.53%               
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.3437 -> 5.7067   acc: 4.14% -> 6.13%               
client [15] (test)  loss: 5.2301 -> 5.3389   acc: 3.59% -> 3.41%               
client [71] (test)  loss: 5.3704 -> 5.3108   acc: 4.12% -> 4.66%               
client [97] (test)  loss: 5.2467 -> 5.3122   acc: 2.55% -> 2.00%               
client [53] (test)  loss: 5.7591 -> 5.3784   acc: 1.06% -> 3.88%               
client [77] (test)  loss: 5.3551 -> 5.2493   acc: 4.14% -> 4.68%               
client [76] (test)  loss: 5.2385 -> 5.0777   acc: 4.36% -> 5.81%               
client [79] (test)  loss: 5.7933 -> 5.2718   acc: 2.49% -> 3.73%               
client [28] (test)  loss: 5.1643 -> 5.2559   acc: 3.63% -> 4.54%               
client [99] (test)  loss: 5.1428 -> 5.4510   acc: 4.51% -> 5.05%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 5.2453 -> 5.3744   acc: 3.82% -> 2.36%               
client [86] (test)  loss: 5.2792 -> 5.4666   acc: 3.81% -> 5.63%               
client [34] (test)  loss: 5.1996 -> 5.5817   acc: 4.36% -> 4.73%               
client [73] (test)  loss: 5.2854 -> 5.4643   acc: 4.47% -> 4.67%               
client [5] (test)  loss: 5.3125 -> 5.3850   acc: 5.16% -> 6.76%                
client [96] (test)  loss: 5.2450 -> 5.3852   acc: 5.23% -> 4.68%               
client [22] (test)  loss: 5.2525 -> 5.3053   acc: 4.52% -> 7.96%               
client [60] (test)  loss: 5.5297 -> 5.3589   acc: 3.24% -> 8.27%               
client [66] (test)  loss: 5.4962 -> 5.3540   acc: 3.25% -> 6.14%               
client [83] (test)  loss: 5.5890 -> 5.3211   acc: 4.34% -> 6.51%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.4020 -> 5.3310   acc: 3.99% -> 5.26%               
client [65] (test)  loss: 5.4292 -> 5.4383   acc: 4.36% -> 5.81%               
client [95] (test)  loss: 5.4945 -> 5.5198   acc: 4.88% -> 5.63%               
client [17] (test)  loss: 5.8713 -> 5.4229   acc: 3.78% -> 4.68%               
client [8] (test)  loss: 5.7710 -> 5.6279   acc: 3.79% -> 5.78%                
client [35] (test)  loss: 5.1919 -> 5.2420   acc: 7.08% -> 7.62%               
client [98] (test)  loss: 5.4259 -> 5.4495   acc: 4.36% -> 7.45%               
client [53] (test)  loss: 5.6689 -> 5.6966   acc: 3.17% -> 4.41%               
client [43] (test)  loss: 5.5211 -> 5.3657   acc: 4.35% -> 4.17%               
client [64] (test)  loss: 5.5942 -> 5.3806   acc: 3.90% -> 8.74%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.5602 -> 5.6041   acc: 4.17% -> 6.17%               
client [88] (test)  loss: 5.6956 -> 5.8754   acc: 2.35% -> 5.24%               
client [38] (test)  loss: 5.5875 -> 5.4651   acc: 1.85% -> 4.63%               
client [3] (test)  loss: 5.6236 -> 5.5740   acc: 3.22% -> 6.98%                
client [5] (test)  loss: 5.6339 -> 5.6508   acc: 4.45% -> 5.69%                
client [41] (test)  loss: 5.6087 -> 5.9317   acc: 3.80% -> 2.36%               
client [7] (test)  loss: 5.7435 -> 5.5984   acc: 3.62% -> 4.35%                
client [37] (test)  loss: 5.5178 -> 5.6011   acc: 3.60% -> 4.32%               
client [45] (test)  loss: 5.6596 -> 5.4280   acc: 4.55% -> 6.18%               
client [47] (test)  loss: 5.9097 -> 5.6256   acc: 3.43% -> 5.60%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.7345 -> 5.7768   acc: 4.85% -> 4.67%               
client [11] (test)  loss: 5.8614 -> 5.7972   acc: 2.52% -> 6.12%               
client [37] (test)  loss: 5.5472 -> 5.9908   acc: 3.24% -> 5.05%               
client [41] (test)  loss: 5.6851 -> 6.1025   acc: 2.54% -> 1.27%               
client [95] (test)  loss: 5.6183 -> 5.9989   acc: 3.56% -> 4.13%               
client [53] (test)  loss: 6.0694 -> 5.9251   acc: 1.59% -> 2.65%               
client [22] (test)  loss: 5.4973 -> 5.6327   acc: 4.70% -> 6.33%               
client [25] (test)  loss: 5.6200 -> 5.7723   acc: 2.88% -> 2.52%               
client [69] (test)  loss: 5.5646 -> 5.9293   acc: 4.63% -> 5.00%               
client [46] (test)  loss: 5.6792 -> 5.7523   acc: 3.27% -> 3.63%               
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.7622 -> 6.2241   acc: 2.89% -> 3.43%               
client [69] (test)  loss: 5.7558 -> 6.2526   acc: 3.89% -> 4.63%               
client [82] (test)  loss: 5.6749 -> 5.6941   acc: 5.18% -> 8.39%               
client [45] (test)  loss: 5.6318 -> 5.7875   acc: 3.64% -> 5.64%               
client [7] (test)  loss: 5.8823 -> 5.9331   acc: 3.80% -> 4.89%                
client [50] (test)  loss: 5.8588 -> 5.9943   acc: 3.26% -> 3.26%               
client [35] (test)  loss: 5.3456 -> 5.9058   acc: 6.35% -> 5.99%               
client [24] (test)  loss: 6.0791 -> 5.9678   acc: 2.32% -> 5.53%               
client [15] (test)  loss: 5.7150 -> 6.0647   acc: 3.23% -> 3.77%               
client [58] (test)  loss: 5.6127 -> 6.2737   acc: 3.78% -> 4.14%               
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.7739 -> 6.0121   acc: 4.48% -> 4.12%               
client [76] (test)  loss: 5.8900 -> 6.0923   acc: 4.90% -> 5.26%               
client [67] (test)  loss: 5.9566 -> 6.2226   acc: 4.48% -> 4.29%               
client [37] (test)  loss: 6.0024 -> 6.4117   acc: 2.88% -> 4.14%               
client [58] (test)  loss: 5.6864 -> 6.5642   acc: 3.96% -> 3.60%               
client [64] (test)  loss: 5.8560 -> 6.0826   acc: 3.72% -> 7.06%               
client [77] (test)  loss: 5.8836 -> 6.0222   acc: 3.60% -> 4.14%               
client [55] (test)  loss: 6.1120 -> 6.3375   acc: 3.76% -> 5.01%               
client [12] (test)  loss: 6.1373 -> 6.5849   acc: 3.41% -> 5.38%               
client [89] (test)  loss: 5.8994 -> 6.2495   acc: 5.38% -> 6.27%               
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.9394 -> 6.8814   acc: 4.89% -> 5.07%               
client [51] (test)  loss: 5.9815 -> 6.1786   acc: 4.32% -> 5.23%               
client [8] (test)  loss: 6.1517 -> 6.6889   acc: 2.89% -> 5.23%                
client [18] (test)  loss: 6.0287 -> 6.4666   acc: 4.47% -> 4.29%               
client [94] (test)  loss: 6.0747 -> 6.3745   acc: 2.71% -> 3.44%               
client [81] (test)  loss: 6.2201 -> 6.4809   acc: 3.87% -> 3.51%               
client [3] (test)  loss: 6.1207 -> 6.5041   acc: 2.68% -> 5.19%                
client [11] (test)  loss: 6.2157 -> 6.3731   acc: 2.34% -> 5.04%               
client [95] (test)  loss: 6.1058 -> 6.5556   acc: 3.38% -> 3.94%               
client [67] (test)  loss: 6.2676 -> 6.2550   acc: 4.85% -> 4.85%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 6.1754 -> 6.0093   acc: 4.36% -> 4.90%               
client [79] (test)  loss: 6.4864 -> 6.5916   acc: 2.31% -> 4.26%               
client [58] (test)  loss: 5.9514 -> 7.0177   acc: 3.24% -> 2.70%               
client [88] (test)  loss: 6.3971 -> 6.6554   acc: 3.25% -> 5.42%               
client [46] (test)  loss: 6.5550 -> 6.3060   acc: 2.36% -> 3.81%               
client [11] (test)  loss: 6.3541 -> 6.4649   acc: 2.16% -> 6.12%               
client [55] (test)  loss: 6.2520 -> 6.8819   acc: 4.11% -> 4.83%               
client [13] (test)  loss: 5.9273 -> 6.4028   acc: 5.25% -> 5.80%               
client [31] (test)  loss: 6.3975 -> 6.7438   acc: 3.60% -> 4.32%               
client [75] (test)  loss: 6.0401 -> 6.8315   acc: 3.61% -> 5.05%               
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 6.5758 -> 6.7765   acc: 4.10% -> 5.94%               
client [7] (test)  loss: 6.0610 -> 6.8768   acc: 4.35% -> 3.44%                
client [57] (test)  loss: 6.1829 -> 6.6243   acc: 2.72% -> 4.72%               
client [13] (test)  loss: 6.1054 -> 6.5847   acc: 3.26% -> 5.07%               
client [43] (test)  loss: 6.1461 -> 6.6558   acc: 2.54% -> 2.90%               
client [91] (test)  loss: 6.6598 -> 6.2834   acc: 3.09% -> 4.00%               
client [10] (test)  loss: 6.4620 -> 6.9375   acc: 3.60% -> 4.32%               
client [64] (test)  loss: 6.1667 -> 6.8040   acc: 4.46% -> 6.32%               
client [82] (test)  loss: 6.0970 -> 6.5826   acc: 4.29% -> 7.50%               
client [22] (test)  loss: 6.1776 -> 6.6490   acc: 3.98% -> 4.52%               
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.5098 -> 6.4235   acc: 3.02% -> 7.37%               
client [23] (test)  loss: 6.6547 -> 6.9120   acc: 2.53% -> 1.81%               
client [88] (test)  loss: 6.8145 -> 6.8865   acc: 2.17% -> 4.34%               
client [98] (test)  loss: 6.4113 -> 7.2027   acc: 3.45% -> 3.82%               
client [79] (test)  loss: 6.7520 -> 6.9769   acc: 2.31% -> 4.09%               
client [21] (test)  loss: 6.3516 -> 6.4028   acc: 4.90% -> 5.81%               
client [92] (test)  loss: 6.7213 -> 6.7015   acc: 5.00% -> 8.39%               
client [56] (test)  loss: 6.3604 -> 6.8525   acc: 4.51% -> 5.60%               
client [5] (test)  loss: 6.7373 -> 6.8634   acc: 3.91% -> 4.09%                
client [52] (test)  loss: 6.3608 -> 6.9043   acc: 3.99% -> 3.44%               
==================== FedBabu_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '5.3039 -> 5.1929', 'accuracy': '3.82% -> 5.43%'},           
    200: {'loss': '6.6223 -> 6.4232', 'accuracy': '3.36% -> 4.11%'}            
}                                                                              
Convergence (test_before):                                                     
Convergence (test_after):                                                      
