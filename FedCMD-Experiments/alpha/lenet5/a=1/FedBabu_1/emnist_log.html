==================== ALGORITHM: FedBabu_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.8453 -> 0.4509   acc: 74.20% -> 85.32%             
client [81] (test)  loss: 1.1427 -> 0.7529   acc: 73.15% -> 80.24%             
client [21] (test)  loss: 87.1782 -> 0.7709   acc: 53.97% -> 77.71%            
client [68] (test)  loss: 1.1511 -> 0.6232   acc: 70.15% -> 83.26%             
client [93] (test)  loss: 1.3072 -> 0.9000   acc: 68.18% -> 75.89%             
client [31] (test)  loss: 2.0298 -> 0.7392   acc: 50.48% -> 79.56%             
client [20] (test)  loss: 1.0215 -> 0.5972   acc: 73.62% -> 82.80%             
client [59] (test)  loss: 56.9509 -> 0.4972   acc: 63.94% -> 86.21%            
client [48] (test)  loss: 1.1595 -> 0.8385   acc: 71.49% -> 77.38%             
client [34] (test)  loss: 1.2755 -> 0.7868   acc: 62.58% -> 78.51%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2456 -> 0.2463   acc: 73.11% -> 92.62%             
client [99] (test)  loss: 1.0478 -> 0.6586   acc: 73.69% -> 80.54%             
client [67] (test)  loss: 0.5942 -> 0.3106   acc: 79.17% -> 90.88%             
client [0] (test)  loss: 0.9736 -> 0.6328   acc: 73.28% -> 80.59%              
client [76] (test)  loss: 0.9642 -> 0.5959   acc: 76.11% -> 82.58%             
client [41] (test)  loss: 1.2219 -> 0.6627   acc: 65.79% -> 76.65%             
client [62] (test)  loss: 204.1934 -> 0.5329   acc: 47.87% -> 84.89%           
client [2] (test)  loss: 175.2114 -> 0.6110   acc: 48.04% -> 82.31%            
client [14] (test)  loss: 0.8435 -> 0.6007   acc: 76.96% -> 80.87%             
client [46] (test)  loss: 1.4045 -> 0.5678   acc: 61.08% -> 84.63%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5763 -> 0.5035   acc: 80.25% -> 82.16%             
client [68] (test)  loss: 0.7448 -> 0.4434   acc: 77.96% -> 86.82%             
client [57] (test)  loss: 0.5460 -> 0.2756   acc: 83.16% -> 91.09%             
client [17] (test)  loss: 0.6854 -> 0.3909   acc: 80.76% -> 88.63%             
client [54] (test)  loss: 0.5434 -> 0.3149   acc: 81.95% -> 89.75%             
client [23] (test)  loss: 212.5871 -> 0.6764   acc: 44.02% -> 79.99%           
client [35] (test)  loss: 0.8370 -> 0.6355   acc: 73.96% -> 80.39%             
client [59] (test)  loss: 0.4689 -> 0.3043   acc: 86.33% -> 91.00%             
client [31] (test)  loss: 0.6353 -> 0.5370   acc: 80.78% -> 83.76%             
client [9] (test)  loss: 0.9615 -> 0.6101   acc: 74.06% -> 79.58%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7664 -> 0.4874   acc: 76.30% -> 84.23%             
client [33] (test)  loss: 0.8906 -> 0.5535   acc: 73.11% -> 82.48%             
client [16] (test)  loss: 0.9580 -> 0.6014   acc: 70.37% -> 81.95%             
client [44] (test)  loss: 2.1191 -> 0.6661   acc: 66.12% -> 75.42%             
client [8] (test)  loss: 0.5115 -> 0.4649   acc: 86.23% -> 85.07%              
client [31] (test)  loss: 0.6807 -> 0.5017   acc: 80.49% -> 84.69%             
client [47] (test)  loss: 0.5225 -> 0.2373   acc: 83.15% -> 91.26%             
client [36] (test)  loss: 0.4366 -> 0.1913   acc: 86.00% -> 93.98%             
client [20] (test)  loss: 0.6098 -> 0.3986   acc: 83.19% -> 87.21%             
client [56] (test)  loss: 0.5459 -> 0.3734   acc: 82.74% -> 87.12%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6232 -> 0.4028   acc: 80.36% -> 86.15%              
client [60] (test)  loss: 0.4632 -> 0.2862   acc: 85.51% -> 90.08%             
client [28] (test)  loss: 0.4874 -> 0.3118   acc: 85.41% -> 91.52%             
client [25] (test)  loss: 0.3139 -> 0.1984   acc: 91.02% -> 94.28%             
client [58] (test)  loss: 0.4270 -> 0.3072   acc: 87.29% -> 90.50%             
client [44] (test)  loss: 0.9132 -> 0.6395   acc: 70.98% -> 75.23%             
client [39] (test)  loss: 0.7622 -> 0.4874   acc: 73.74% -> 83.95%             
client [29] (test)  loss: 0.7130 -> 0.5084   acc: 79.35% -> 84.91%             
client [3] (test)  loss: 0.4432 -> 0.3383   acc: 85.67% -> 88.16%              
client [84] (test)  loss: 0.7679 -> 0.5677   acc: 77.78% -> 83.20%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9190 -> 0.4978   acc: 75.06% -> 84.50%             
client [84] (test)  loss: 0.9653 -> 0.5508   acc: 73.20% -> 83.47%             
client [10] (test)  loss: 0.9811 -> 0.4455   acc: 72.68% -> 87.03%             
client [36] (test)  loss: 0.4099 -> 0.1722   acc: 86.32% -> 94.51%             
client [65] (test)  loss: 0.3300 -> 0.2559   acc: 90.06% -> 92.33%             
client [81] (test)  loss: 0.9416 -> 0.4827   acc: 77.02% -> 86.60%             
client [79] (test)  loss: 0.2787 -> 0.2015   acc: 92.12% -> 93.71%             
client [42] (test)  loss: 0.7566 -> 0.4042   acc: 76.92% -> 88.08%             
client [11] (test)  loss: 0.4831 -> 0.3681   acc: 87.18% -> 89.04%             
client [96] (test)  loss: 0.3670 -> 0.3083   acc: 88.42% -> 89.79%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4463 -> 0.4036   acc: 87.34% -> 87.36%              
client [53] (test)  loss: 0.2908 -> 0.1924   acc: 91.89% -> 94.22%             
client [52] (test)  loss: 0.8495 -> 0.4941   acc: 72.40% -> 84.49%             
client [42] (test)  loss: 0.5743 -> 0.3953   acc: 79.27% -> 88.10%             
client [69] (test)  loss: 0.2525 -> 0.1872   acc: 92.45% -> 94.20%             
client [59] (test)  loss: 0.3387 -> 0.2479   acc: 89.99% -> 92.15%             
client [7] (test)  loss: 0.6797 -> 0.4998   acc: 75.72% -> 81.66%              
client [26] (test)  loss: 0.3397 -> 0.2453   acc: 89.79% -> 92.34%             
client [49] (test)  loss: 0.4992 -> 0.3992   acc: 85.20% -> 87.08%             
client [98] (test)  loss: 0.5823 -> 0.4306   acc: 82.02% -> 85.40%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6732 -> 0.4250   acc: 80.76% -> 85.33%             
client [47] (test)  loss: 0.3470 -> 0.2107   acc: 88.96% -> 92.36%             
client [21] (test)  loss: 0.6706 -> 0.4714   acc: 79.77% -> 85.16%             
client [77] (test)  loss: 0.2992 -> 0.2329   acc: 89.27% -> 91.16%             
client [95] (test)  loss: 0.4688 -> 0.3486   acc: 87.08% -> 89.24%             
client [91] (test)  loss: 1.1359 -> 0.5502   acc: 66.46% -> 81.97%             
client [14] (test)  loss: 0.5928 -> 0.4681   acc: 82.25% -> 84.10%             
client [99] (test)  loss: 0.7136 -> 0.5114   acc: 79.07% -> 83.84%             
client [20] (test)  loss: 0.5455 -> 0.3569   acc: 83.86% -> 88.71%             
client [39] (test)  loss: 0.8016 -> 0.4566   acc: 75.86% -> 84.68%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7939 -> 0.4806   acc: 74.60% -> 85.00%             
client [62] (test)  loss: 0.7063 -> 0.3976   acc: 80.06% -> 87.45%             
client [71] (test)  loss: 0.6967 -> 0.5228   acc: 78.96% -> 83.22%             
client [97] (test)  loss: 0.3185 -> 0.2235   acc: 90.68% -> 93.41%             
client [30] (test)  loss: 0.3842 -> 0.2274   acc: 87.19% -> 92.31%             
client [88] (test)  loss: 0.4107 -> 0.3345   acc: 87.50% -> 89.21%             
client [60] (test)  loss: 0.4312 -> 0.2571   acc: 87.06% -> 91.28%             
client [82] (test)  loss: 0.4602 -> 0.3350   acc: 84.72% -> 87.88%             
client [91] (test)  loss: 1.0142 -> 0.5436   acc: 68.00% -> 81.92%             
client [57] (test)  loss: 0.5597 -> 0.2252   acc: 81.69% -> 92.13%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5681 -> 0.4283   acc: 79.85% -> 85.98%             
client [15] (test)  loss: 0.6127 -> 0.4288   acc: 77.35% -> 84.31%             
client [71] (test)  loss: 0.7288 -> 0.5166   acc: 74.95% -> 83.15%             
client [97] (test)  loss: 0.3392 -> 0.2225   acc: 89.18% -> 93.69%             
client [53] (test)  loss: 0.4433 -> 0.1904   acc: 82.88% -> 94.25%             
client [77] (test)  loss: 0.3531 -> 0.2249   acc: 86.28% -> 91.23%             
client [76] (test)  loss: 0.8074 -> 0.4165   acc: 74.39% -> 86.60%             
client [79] (test)  loss: 0.3756 -> 0.1892   acc: 86.13% -> 93.74%             
client [28] (test)  loss: 0.6415 -> 0.2794   acc: 75.07% -> 92.37%             
client [99] (test)  loss: 0.6406 -> 0.4963   acc: 78.41% -> 83.94%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2944 -> 0.2169   acc: 91.30% -> 93.76%             
client [86] (test)  loss: 0.2527 -> 0.2044   acc: 92.90% -> 94.21%             
client [34] (test)  loss: 0.7712 -> 0.4470   acc: 73.24% -> 85.02%             
client [73] (test)  loss: 0.7970 -> 0.4999   acc: 76.37% -> 83.80%             
client [5] (test)  loss: 0.7522 -> 0.4035   acc: 81.60% -> 87.21%              
client [96] (test)  loss: 0.3750 -> 0.2761   acc: 87.76% -> 90.26%             
client [22] (test)  loss: 0.9716 -> 0.4312   acc: 72.79% -> 87.29%             
client [60] (test)  loss: 0.4600 -> 0.2504   acc: 86.32% -> 91.11%             
client [66] (test)  loss: 0.4444 -> 0.2875   acc: 86.03% -> 89.59%             
client [83] (test)  loss: 0.4681 -> 0.3761   acc: 83.13% -> 86.78%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7982 -> 0.4111   acc: 78.59% -> 86.62%             
client [65] (test)  loss: 0.3022 -> 0.2257   acc: 91.04% -> 93.30%             
client [95] (test)  loss: 0.4498 -> 0.3400   acc: 87.43% -> 89.07%             
client [17] (test)  loss: 0.4249 -> 0.3155   acc: 87.56% -> 90.44%             
client [8] (test)  loss: 0.4186 -> 0.3696   acc: 87.68% -> 88.98%              
client [35] (test)  loss: 0.7513 -> 0.5157   acc: 75.80% -> 83.13%             
client [98] (test)  loss: 0.6210 -> 0.4097   acc: 81.95% -> 85.92%             
client [53] (test)  loss: 0.2477 -> 0.1858   acc: 93.15% -> 94.49%             
client [43] (test)  loss: 0.5494 -> 0.3540   acc: 83.60% -> 88.95%             
client [64] (test)  loss: 0.7240 -> 0.4217   acc: 78.26% -> 86.19%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5576 -> 0.4490   acc: 83.59% -> 85.53%             
client [88] (test)  loss: 0.4081 -> 0.3204   acc: 88.34% -> 89.28%             
client [38] (test)  loss: 0.6486 -> 0.3928   acc: 82.12% -> 85.84%             
client [3] (test)  loss: 0.3930 -> 0.3025   acc: 86.45% -> 89.19%              
client [5] (test)  loss: 0.6910 -> 0.3952   acc: 81.97% -> 87.10%              
client [41] (test)  loss: 0.8009 -> 0.5093   acc: 76.38% -> 80.84%             
client [7] (test)  loss: 0.7102 -> 0.4689   acc: 77.84% -> 82.65%              
client [37] (test)  loss: 1.0038 -> 0.6104   acc: 72.58% -> 78.65%             
client [45] (test)  loss: 0.4155 -> 0.3796   acc: 86.26% -> 87.46%             
client [47] (test)  loss: 0.2772 -> 0.2065   acc: 90.53% -> 92.31%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9448 -> 0.4955   acc: 71.25% -> 83.63%             
client [11] (test)  loss: 0.4146 -> 0.3355   acc: 86.65% -> 90.00%             
client [37] (test)  loss: 0.8268 -> 0.6158   acc: 72.55% -> 78.54%             
client [41] (test)  loss: 0.6562 -> 0.5103   acc: 77.79% -> 80.91%             
client [95] (test)  loss: 0.4688 -> 0.3350   acc: 86.54% -> 89.51%             
client [53] (test)  loss: 0.4089 -> 0.1873   acc: 86.87% -> 94.39%             
client [22] (test)  loss: 0.8021 -> 0.4220   acc: 74.40% -> 87.51%             
client [25] (test)  loss: 0.3221 -> 0.1562   acc: 89.60% -> 95.33%             
client [69] (test)  loss: 0.2713 -> 0.1762   acc: 91.01% -> 94.18%             
client [46] (test)  loss: 0.6500 -> 0.4128   acc: 75.55% -> 87.50%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3200 -> 0.2042   acc: 88.18% -> 92.19%             
client [69] (test)  loss: 0.2735 -> 0.1759   acc: 90.60% -> 94.47%             
client [82] (test)  loss: 0.4528 -> 0.3190   acc: 84.33% -> 88.10%             
client [45] (test)  loss: 0.4167 -> 0.3782   acc: 85.55% -> 87.43%             
client [7] (test)  loss: 0.6293 -> 0.4688   acc: 77.22% -> 82.60%              
client [50] (test)  loss: 0.3749 -> 0.3054   acc: 88.40% -> 90.65%             
client [35] (test)  loss: 0.6933 -> 0.5108   acc: 77.10% -> 83.10%             
client [24] (test)  loss: 0.5256 -> 0.4019   acc: 81.87% -> 85.48%             
client [15] (test)  loss: 0.5525 -> 0.4179   acc: 80.45% -> 84.95%             
client [58] (test)  loss: 0.3969 -> 0.2686   acc: 86.36% -> 91.62%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5932 -> 0.5156   acc: 82.17% -> 82.56%             
client [76] (test)  loss: 0.6996 -> 0.3977   acc: 79.86% -> 87.11%             
client [67] (test)  loss: 0.4323 -> 0.2346   acc: 87.26% -> 94.16%             
client [37] (test)  loss: 0.8069 -> 0.6113   acc: 73.41% -> 78.68%             
client [58] (test)  loss: 0.3651 -> 0.2685   acc: 88.02% -> 91.72%             
client [64] (test)  loss: 0.5621 -> 0.4106   acc: 80.81% -> 86.42%             
client [77] (test)  loss: 0.3050 -> 0.2219   acc: 89.07% -> 91.68%             
client [55] (test)  loss: 0.4881 -> 0.2865   acc: 84.87% -> 90.23%             
client [12] (test)  loss: 0.5827 -> 0.4298   acc: 81.78% -> 86.71%             
client [89] (test)  loss: 0.5055 -> 0.3361   acc: 85.26% -> 88.81%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6747 -> 0.4907   acc: 76.48% -> 84.79%             
client [51] (test)  loss: 0.7359 -> 0.5257   acc: 74.43% -> 81.11%             
client [8] (test)  loss: 0.4476 -> 0.3629   acc: 86.18% -> 89.05%              
client [18] (test)  loss: 0.6104 -> 0.4088   acc: 79.42% -> 87.39%             
client [94] (test)  loss: 0.3250 -> 0.1857   acc: 89.25% -> 93.68%             
client [81] (test)  loss: 0.5925 -> 0.4217   acc: 82.08% -> 87.48%             
client [3] (test)  loss: 0.4176 -> 0.2986   acc: 85.11% -> 89.12%              
client [11] (test)  loss: 0.3993 -> 0.3255   acc: 87.08% -> 90.36%             
client [95] (test)  loss: 0.4508 -> 0.3300   acc: 86.32% -> 89.66%             
client [67] (test)  loss: 0.4499 -> 0.2366   acc: 87.92% -> 94.21%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5423 -> 0.4418   acc: 82.83% -> 85.61%             
client [79] (test)  loss: 0.2535 -> 0.1784   acc: 92.78% -> 94.35%             
client [58] (test)  loss: 0.3962 -> 0.2712   acc: 87.24% -> 91.82%             
client [88] (test)  loss: 0.4108 -> 0.3116   acc: 88.03% -> 89.93%             
client [46] (test)  loss: 0.7707 -> 0.4127   acc: 70.02% -> 88.08%             
client [11] (test)  loss: 0.3772 -> 0.3214   acc: 88.72% -> 90.41%             
client [55] (test)  loss: 0.4070 -> 0.2858   acc: 86.77% -> 90.23%             
client [13] (test)  loss: 0.6377 -> 0.3668   acc: 76.54% -> 88.12%             
client [31] (test)  loss: 0.5436 -> 0.4230   acc: 83.93% -> 86.23%             
client [75] (test)  loss: 0.4653 -> 0.3547   acc: 85.05% -> 88.20%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6111 -> 0.3527   acc: 84.20% -> 88.46%             
client [7] (test)  loss: 0.6772 -> 0.4634   acc: 76.90% -> 82.57%              
client [57] (test)  loss: 0.3791 -> 0.1989   acc: 87.63% -> 92.83%             
client [13] (test)  loss: 0.6749 -> 0.3668   acc: 75.48% -> 88.20%             
client [43] (test)  loss: 0.4531 -> 0.3443   acc: 86.36% -> 89.35%             
client [91] (test)  loss: 0.9722 -> 0.5306   acc: 70.02% -> 82.70%             
client [10] (test)  loss: 0.6989 -> 0.3819   acc: 78.77% -> 88.03%             
client [64] (test)  loss: 0.7384 -> 0.4120   acc: 79.28% -> 86.44%             
client [82] (test)  loss: 0.4116 -> 0.3107   acc: 86.08% -> 88.54%             
client [22] (test)  loss: 0.9113 -> 0.4186   acc: 73.62% -> 87.66%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5089 -> 0.3338   acc: 85.28% -> 89.02%             
client [23] (test)  loss: 0.7615 -> 0.5218   acc: 79.64% -> 83.67%             
client [88] (test)  loss: 0.3926 -> 0.3143   acc: 87.79% -> 89.62%             
client [98] (test)  loss: 0.4715 -> 0.4052   acc: 84.60% -> 86.44%             
client [79] (test)  loss: 0.2317 -> 0.1796   acc: 93.67% -> 94.38%             
client [21] (test)  loss: 0.5458 -> 0.4377   acc: 81.95% -> 85.61%             
client [92] (test)  loss: 0.6363 -> 0.4048   acc: 81.64% -> 87.09%             
client [56] (test)  loss: 0.4609 -> 0.3097   acc: 84.75% -> 88.74%             
client [5] (test)  loss: 0.7137 -> 0.3885   acc: 81.17% -> 87.29%              
client [52] (test)  loss: 0.8280 -> 0.4510   acc: 73.35% -> 85.20%             
==================== FedBabu_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.5486 -> 0.6326', 'accuracy': '81.14% -> 83.52%'},         
    200: {'loss': '0.5417 -> 0.6120', 'accuracy': '83.00% -> 84.25%'}          
}                                                                              
Convergence (test_before):                                                     
FedBabu_1 achieved 20.0%(24.92%) at epoch: 1                                   
FedBabu_1 achieved 50.0%(51.39%) at epoch: 2                                   
FedBabu_1 achieved 60.0%(63.42%) at epoch: 7                                   
FedBabu_1 achieved 70.0%(73.91%) at epoch: 13                                  
FedBabu_1 achieved 80.0%(83.22%) at epoch: 30                                  
Convergence (test_after):                                                      
FedBabu_1 achieved 50.0%(50.89%) at epoch: 0                                   
FedBabu_1 achieved 60.0%(67.58%) at epoch: 1                                   
FedBabu_1 achieved 70.0%(73.99%) at epoch: 2                                   
FedBabu_1 achieved 80.0%(81.73%) at epoch: 8                                   
FedBabu_1 achieved 90.0%(90.67%) at epoch: 71                                  
