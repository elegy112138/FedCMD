==================== ALGORITHM: FedBabu_1 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5890 -> 4.5437   acc: 0.66% -> 1.64%               
client [81] (test)  loss: 4.5498 -> 4.4867   acc: 6.98% -> 6.31%               
client [21] (test)  loss: 33.5839 -> 4.5636   acc: 0.33% -> 1.00%              
client [68] (test)  loss: 4.5917 -> 4.5267   acc: 1.66% -> 3.31%               
client [93] (test)  loss: 4.5735 -> 4.5224   acc: 2.27% -> 2.27%               
client [31] (test)  loss: 4.6345 -> 4.5685   acc: 1.39% -> 1.05%               
client [20] (test)  loss: 4.6191 -> 4.5781   acc: 0.35% -> 1.39%               
client [59] (test)  loss: 29.9167 -> 4.4257   acc: 4.56% -> 6.38%              
client [48] (test)  loss: 4.5589 -> 4.5196   acc: 2.31% -> 3.96%               
client [34] (test)  loss: 4.5830 -> 4.5231   acc: 0.30% -> 1.20%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.5140 -> 4.3559   acc: 2.64% -> 8.91%               
client [99] (test)  loss: 4.5006 -> 4.4522   acc: 3.15% -> 4.10%               
client [67] (test)  loss: 4.4519 -> 4.3438   acc: 6.31% -> 6.98%               
client [0] (test)  loss: 4.4668 -> 4.3616   acc: 2.99% -> 6.64%                
client [76] (test)  loss: 4.5815 -> 4.4986   acc: 1.79% -> 2.87%               
client [41] (test)  loss: 4.5310 -> 4.4307   acc: 1.30% -> 3.91%               
client [62] (test)  loss: 76.4736 -> 4.4357   acc: 2.17% -> 5.43%              
client [2] (test)  loss: 77.7076 -> 4.4491   acc: 0.97% -> 5.18%               
client [14] (test)  loss: 4.5163 -> 4.4665   acc: 1.06% -> 3.18%               
client [46] (test)  loss: 4.4918 -> 4.3557   acc: 0.97% -> 7.14%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.4572 -> 4.3848   acc: 4.39% -> 4.39%               
client [68] (test)  loss: 4.5072 -> 4.3648   acc: 1.99% -> 8.28%               
client [57] (test)  loss: 4.3769 -> 4.2700   acc: 5.56% -> 8.50%               
client [17] (test)  loss: 4.5354 -> 4.3828   acc: 0.97% -> 2.26%               
client [54] (test)  loss: 4.4679 -> 4.2441   acc: 1.79% -> 11.43%              
client [23] (test)  loss: 162.3316 -> 4.3038   acc: 0.33% -> 7.00%             
client [35] (test)  loss: 4.4581 -> 4.3909   acc: 3.28% -> 4.59%               
client [59] (test)  loss: 4.4067 -> 4.2399   acc: 6.38% -> 6.69%               
client [31] (test)  loss: 4.4836 -> 4.4068   acc: 1.39% -> 5.23%               
client [9] (test)  loss: 4.4213 -> 4.4065   acc: 6.62% -> 2.65%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6333 -> 4.3190   acc: 0.66% -> 6.60%               
client [33] (test)  loss: 4.4913 -> 4.3566   acc: 2.93% -> 7.17%               
client [16] (test)  loss: 4.4133 -> 4.3549   acc: 4.53% -> 3.48%               
client [44] (test)  loss: 4.5009 -> 4.3270   acc: 2.30% -> 6.23%               
client [8] (test)  loss: 4.5289 -> 4.4361   acc: 3.04% -> 4.05%                
client [31] (test)  loss: 4.4894 -> 4.3341   acc: 2.79% -> 4.88%               
client [47] (test)  loss: 4.5246 -> 4.5954   acc: 0.98% -> 5.25%               
client [36] (test)  loss: 4.4867 -> 4.2381   acc: 6.64% -> 8.64%               
client [20] (test)  loss: 4.6192 -> 4.3426   acc: 2.43% -> 3.47%               
client [56] (test)  loss: 4.4031 -> 4.5065   acc: 3.78% -> 5.50%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.3732 -> 4.9318   acc: 4.61% -> 2.96%                
client [60] (test)  loss: 4.4977 -> 4.3547   acc: 2.92% -> 8.77%               
client [28] (test)  loss: 4.4608 -> 4.3732   acc: 2.98% -> 7.28%               
client [25] (test)  loss: 4.4244 -> 4.2427   acc: 2.07% -> 10.34%              
client [58] (test)  loss: 4.4504 -> 4.3469   acc: 7.42% -> 6.25%               
client [44] (test)  loss: 4.5068 -> 4.3266   acc: 3.61% -> 7.21%               
client [39] (test)  loss: 4.3067 -> 4.2010   acc: 4.67% -> 5.33%               
client [29] (test)  loss: 4.4513 -> 4.4049   acc: 3.64% -> 7.95%               
client [3] (test)  loss: 4.4927 -> 4.3166   acc: 3.92% -> 6.21%                
client [84] (test)  loss: 4.6380 -> 4.4608   acc: 1.63% -> 1.96%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.7351 -> 4.3778   acc: 1.99% -> 3.99%               
client [84] (test)  loss: 4.6313 -> 4.4318   acc: 3.59% -> 2.94%               
client [10] (test)  loss: 4.6085 -> 4.2858   acc: 0.99% -> 7.26%               
client [36] (test)  loss: 4.5310 -> 4.2070   acc: 4.32% -> 8.64%               
client [65] (test)  loss: 4.5756 -> 4.2868   acc: 1.98% -> 6.60%               
client [81] (test)  loss: 4.3522 -> 4.3321   acc: 5.98% -> 5.32%               
client [79] (test)  loss: 4.4518 -> 4.2415   acc: 4.59% -> 9.51%               
client [42] (test)  loss: 4.3821 -> 4.0914   acc: 7.62% -> 11.59%              
client [11] (test)  loss: 4.4314 -> 4.2922   acc: 3.36% -> 9.06%               
client [96] (test)  loss: 4.3846 -> 4.2632   acc: 4.73% -> 6.55%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.6139 -> 4.3594   acc: 1.01% -> 5.41%                
client [53] (test)  loss: 4.5057 -> 4.2278   acc: 3.91% -> 6.84%               
client [52] (test)  loss: 4.5202 -> 4.2617   acc: 6.49% -> 10.71%              
client [42] (test)  loss: 4.4303 -> 4.0612   acc: 4.64% -> 11.92%              
client [69] (test)  loss: 4.4710 -> 4.1506   acc: 7.59% -> 11.88%              
client [59] (test)  loss: 4.1675 -> 3.9510   acc: 5.47% -> 13.37%              
client [7] (test)  loss: 4.7592 -> 4.1170   acc: 3.92% -> 10.13%               
client [26] (test)  loss: 4.8324 -> 4.0682   acc: 5.30% -> 11.92%              
client [49] (test)  loss: 4.1816 -> 4.0180   acc: 9.18% -> 11.80%              
client [98] (test)  loss: 4.4018 -> 4.3638   acc: 5.83% -> 5.83%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.5092 -> 4.3162   acc: 5.83% -> 8.09%               
client [47] (test)  loss: 5.6290 -> 4.9573   acc: 2.95% -> 4.26%               
client [21] (test)  loss: 4.8331 -> 4.3254   acc: 3.65% -> 5.32%               
client [77] (test)  loss: 4.4755 -> 4.1205   acc: 3.95% -> 7.57%               
client [95] (test)  loss: 4.4847 -> 4.2876   acc: 4.39% -> 7.09%               
client [91] (test)  loss: 4.2529 -> 3.9761   acc: 7.57% -> 15.13%              
client [14] (test)  loss: 4.4329 -> 4.2519   acc: 6.71% -> 10.60%              
client [99] (test)  loss: 4.6036 -> 4.4110   acc: 5.05% -> 8.52%               
client [20] (test)  loss: 4.8283 -> 4.1388   acc: 1.04% -> 12.50%              
client [39] (test)  loss: 4.5809 -> 4.0337   acc: 7.67% -> 12.00%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.3025 -> 4.1906   acc: 6.49% -> 11.69%              
client [62] (test)  loss: 4.3372 -> 4.0384   acc: 4.71% -> 11.59%              
client [71] (test)  loss: 4.2443 -> 4.1765   acc: 8.25% -> 7.26%               
client [97] (test)  loss: 4.3746 -> 4.1566   acc: 6.95% -> 9.93%               
client [30] (test)  loss: 4.2857 -> 4.1807   acc: 9.90% -> 8.58%               
client [88] (test)  loss: 4.3574 -> 4.0497   acc: 5.65% -> 10.63%              
client [60] (test)  loss: 4.3998 -> 4.2789   acc: 4.22% -> 10.39%              
client [82] (test)  loss: 4.2938 -> 4.2913   acc: 8.28% -> 9.60%               
client [91] (test)  loss: 4.0894 -> 4.2049   acc: 9.54% -> 11.18%              
client [57] (test)  loss: 4.3152 -> 3.9839   acc: 8.50% -> 13.73%              
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.4057 -> 4.1777   acc: 5.92% -> 11.85%              
client [15] (test)  loss: 4.2418 -> 4.1892   acc: 8.55% -> 7.24%               
client [71] (test)  loss: 4.2348 -> 4.1165   acc: 6.27% -> 7.92%               
client [97] (test)  loss: 4.3355 -> 4.1490   acc: 6.62% -> 9.60%               
client [53] (test)  loss: 4.3671 -> 4.2777   acc: 6.84% -> 8.47%               
client [77] (test)  loss: 4.1990 -> 4.0707   acc: 6.91% -> 10.53%              
client [76] (test)  loss: 4.5867 -> 4.2006   acc: 4.66% -> 7.17%               
client [79] (test)  loss: 4.4024 -> 4.1920   acc: 4.92% -> 10.49%              
client [28] (test)  loss: 4.6565 -> 4.2879   acc: 1.99% -> 9.60%               
client [99] (test)  loss: 4.4412 -> 4.1687   acc: 5.05% -> 11.67%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.4658 -> 4.1308   acc: 7.95% -> 12.25%              
client [86] (test)  loss: 4.1374 -> 4.0958   acc: 6.69% -> 13.38%              
client [34] (test)  loss: 4.5304 -> 3.9903   acc: 3.90% -> 15.02%              
client [73] (test)  loss: 4.2282 -> 4.1057   acc: 9.18% -> 8.20%               
client [5] (test)  loss: 4.5885 -> 4.5848   acc: 3.62% -> 5.26%                
client [96] (test)  loss: 4.1546 -> 4.0780   acc: 9.09% -> 11.27%              
client [22] (test)  loss: 4.5560 -> 4.4319   acc: 6.51% -> 9.45%               
client [60] (test)  loss: 4.3472 -> 4.1644   acc: 7.14% -> 10.71%              
client [66] (test)  loss: 4.3156 -> 4.0213   acc: 7.10% -> 11.61%              
client [83] (test)  loss: 4.6117 -> 4.1345   acc: 4.29% -> 8.91%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.4618 -> 4.1487   acc: 4.30% -> 8.60%               
client [65] (test)  loss: 4.4694 -> 4.1609   acc: 6.27% -> 11.55%              
client [95] (test)  loss: 4.3421 -> 4.2579   acc: 6.08% -> 10.81%              
client [17] (test)  loss: 4.4095 -> 3.9583   acc: 7.74% -> 11.61%              
client [8] (test)  loss: 4.4123 -> 4.2426   acc: 7.43% -> 7.09%                
client [35] (test)  loss: 4.2917 -> 4.0777   acc: 8.85% -> 11.15%              
client [98] (test)  loss: 4.1521 -> 4.5615   acc: 9.06% -> 7.44%               
client [53] (test)  loss: 4.1384 -> 4.2588   acc: 8.47% -> 8.79%               
client [43] (test)  loss: 4.0676 -> 3.8560   acc: 10.56% -> 15.18%             
client [64] (test)  loss: 4.4929 -> 4.1344   acc: 5.28% -> 10.89%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.3976 -> 4.3519   acc: 9.97% -> 7.97%               
client [88] (test)  loss: 4.4504 -> 4.7875   acc: 4.32% -> 7.64%               
client [38] (test)  loss: 4.3005 -> 4.1868   acc: 3.95% -> 8.88%               
client [3] (test)  loss: 4.8640 -> 4.0229   acc: 6.21% -> 13.07%               
client [5] (test)  loss: 4.4227 -> 4.4360   acc: 5.26% -> 9.21%                
client [41] (test)  loss: 4.3372 -> 4.0909   acc: 4.56% -> 11.73%              
client [7] (test)  loss: 4.0750 -> 3.9817   acc: 10.13% -> 13.73%              
client [37] (test)  loss: 4.4921 -> 4.4365   acc: 4.97% -> 8.61%               
client [45] (test)  loss: 4.2916 -> 3.7648   acc: 7.28% -> 18.54%              
client [47] (test)  loss: 4.3109 -> 5.3767   acc: 8.52% -> 5.25%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.4235 -> 4.0123   acc: 5.92% -> 12.54%              
client [11] (test)  loss: 4.1725 -> 4.0838   acc: 10.40% -> 11.74%             
client [37] (test)  loss: 4.4689 -> 4.4097   acc: 4.30% -> 9.60%               
client [41] (test)  loss: 4.2922 -> 4.1182   acc: 6.84% -> 13.03%              
client [95] (test)  loss: 4.2350 -> 4.0747   acc: 4.73% -> 12.84%              
client [53] (test)  loss: 4.2878 -> 4.0806   acc: 9.45% -> 9.77%               
client [22] (test)  loss: 4.8627 -> 3.9958   acc: 5.86% -> 13.03%              
client [25] (test)  loss: 4.2643 -> 3.9692   acc: 9.31% -> 14.83%              
client [69] (test)  loss: 4.2967 -> 3.9213   acc: 9.24% -> 14.85%              
client [46] (test)  loss: 3.9113 -> 3.7054   acc: 12.01% -> 16.23%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.1198 -> 4.9460   acc: 13.11% -> 8.85%              
client [69] (test)  loss: 4.1966 -> 3.9113   acc: 9.90% -> 14.85%              
client [82] (test)  loss: 4.4368 -> 4.3623   acc: 10.60% -> 11.59%             
client [45] (test)  loss: 4.2555 -> 3.7801   acc: 4.97% -> 18.21%              
client [7] (test)  loss: 4.0632 -> 3.9587   acc: 10.13% -> 13.73%              
client [50] (test)  loss: 3.9548 -> 4.0187   acc: 14.98% -> 11.24%             
client [35] (test)  loss: 4.1153 -> 4.2205   acc: 10.49% -> 9.51%              
client [24] (test)  loss: 4.3482 -> 4.1736   acc: 10.47% -> 11.49%             
client [15] (test)  loss: 4.1496 -> 4.1425   acc: 8.88% -> 10.20%              
client [58] (test)  loss: 4.3246 -> 4.1337   acc: 10.55% -> 16.41%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.1242 -> 3.9401   acc: 10.23% -> 11.88%             
client [76] (test)  loss: 4.3825 -> 4.0901   acc: 6.81% -> 11.11%              
client [67] (test)  loss: 4.3325 -> 4.2210   acc: 6.98% -> 10.63%              
client [37] (test)  loss: 4.5757 -> 4.4147   acc: 6.62% -> 10.93%              
client [58] (test)  loss: 4.1383 -> 4.1086   acc: 15.23% -> 14.84%             
client [64] (test)  loss: 4.7720 -> 4.0469   acc: 4.29% -> 8.25%               
client [77] (test)  loss: 4.0767 -> 4.3708   acc: 10.53% -> 5.59%              
client [55] (test)  loss: 4.0033 -> 4.0077   acc: 13.11% -> 12.46%             
client [12] (test)  loss: 4.3236 -> 3.9819   acc: 8.25% -> 12.21%              
client [89] (test)  loss: 4.5418 -> 3.9337   acc: 6.77% -> 13.23%              
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.6368 -> 4.1700   acc: 7.52% -> 9.80%               
client [51] (test)  loss: 4.8045 -> 4.1729   acc: 5.63% -> 10.93%              
client [8] (test)  loss: 4.2791 -> 4.4672   acc: 7.09% -> 8.11%                
client [18] (test)  loss: 4.1175 -> 3.8982   acc: 7.84% -> 12.42%              
client [94] (test)  loss: 4.4366 -> 4.1317   acc: 7.48% -> 9.86%               
client [81] (test)  loss: 4.1897 -> 3.7075   acc: 7.97% -> 17.94%              
client [3] (test)  loss: 4.6685 -> 3.9413   acc: 4.25% -> 14.05%               
client [11] (test)  loss: 4.3170 -> 4.0687   acc: 10.07% -> 14.43%             
client [95] (test)  loss: 4.3318 -> 4.0463   acc: 6.08% -> 14.19%              
client [67] (test)  loss: 4.5069 -> 4.0634   acc: 6.64% -> 12.29%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.3186 -> 4.4092   acc: 11.63% -> 10.30%             
client [79] (test)  loss: 4.2984 -> 4.0471   acc: 10.16% -> 15.74%             
client [58] (test)  loss: 3.9960 -> 4.1650   acc: 17.19% -> 15.62%             
client [88] (test)  loss: 4.1134 -> 4.0494   acc: 11.30% -> 16.61%             
client [46] (test)  loss: 4.0244 -> 3.6328   acc: 11.04% -> 19.16%             
client [11] (test)  loss: 4.1504 -> 4.0004   acc: 10.74% -> 14.43%             
client [55] (test)  loss: 4.0527 -> 4.1939   acc: 12.46% -> 10.16%             
client [13] (test)  loss: 4.3492 -> 4.0687   acc: 8.44% -> 14.94%              
client [31] (test)  loss: 4.3779 -> 3.9556   acc: 11.15% -> 11.50%             
client [75] (test)  loss: 4.1616 -> 4.1200   acc: 12.83% -> 15.79%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.2057 -> 3.9634   acc: 10.00% -> 14.33%             
client [7] (test)  loss: 3.9964 -> 4.0108   acc: 13.40% -> 15.36%              
client [57] (test)  loss: 3.9612 -> 3.8415   acc: 13.73% -> 20.26%             
client [13] (test)  loss: 4.4882 -> 4.1167   acc: 5.84% -> 12.99%              
client [43] (test)  loss: 4.4268 -> 3.9076   acc: 7.59% -> 16.83%              
client [91] (test)  loss: 4.0294 -> 3.7627   acc: 14.14% -> 20.07%             
client [10] (test)  loss: 4.3554 -> 4.1712   acc: 7.59% -> 13.20%              
client [64] (test)  loss: 4.0296 -> 4.0108   acc: 10.23% -> 11.55%             
client [82] (test)  loss: 4.4699 -> 4.2830   acc: 9.60% -> 12.58%              
client [22] (test)  loss: 4.4116 -> 4.1124   acc: 7.49% -> 11.73%              
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.9361 -> 3.9655   acc: 6.25% -> 17.01%              
client [23] (test)  loss: 4.0493 -> 4.2001   acc: 11.33% -> 12.67%             
client [88] (test)  loss: 4.1055 -> 4.2575   acc: 10.30% -> 12.62%             
client [98] (test)  loss: 4.1521 -> 3.8626   acc: 9.39% -> 14.24%              
client [79] (test)  loss: 4.1539 -> 4.0095   acc: 9.51% -> 17.05%              
client [21] (test)  loss: 4.2181 -> 4.2856   acc: 10.30% -> 10.30%             
client [92] (test)  loss: 4.4225 -> 4.3005   acc: 13.75% -> 13.12%             
client [56] (test)  loss: 5.4890 -> 4.2000   acc: 4.12% -> 13.06%              
client [5] (test)  loss: 4.0306 -> 4.1443   acc: 12.50% -> 12.50%              
client [52] (test)  loss: 4.6587 -> 3.9877   acc: 8.77% -> 16.23%              
==================== FedBabu_1 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '4.3984 -> 4.1616', 'accuracy': '6.45% -> 10.34%'},          
    200: {'loss': '4.3217 -> 4.1054', 'accuracy': '9.28% -> 13.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBabu_1 achieved 10.0%(10.35%) at epoch: 149                                 
Convergence (test_after):                                                      
FedBabu_1 achieved 10.0%(10.01%) at epoch: 69                                  
