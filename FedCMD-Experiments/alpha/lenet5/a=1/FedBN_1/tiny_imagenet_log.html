==================== ALGORITHM: FedBN_1 ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1771 -> 4.9671   acc: 2.70% -> 4.68%               
client [81] (test)  loss: 5.1969 -> 4.9533   acc: 1.66% -> 4.24%               
client [21] (test)  loss: 5.2474 -> 4.9147   acc: 1.09% -> 3.99%               
client [68] (test)  loss: 5.1116 -> 4.7973   acc: 1.81% -> 6.69%               
client [93] (test)  loss: 5.1073 -> 5.0794   acc: 2.36% -> 2.90%               
client [31] (test)  loss: 5.1612 -> 4.9983   acc: 2.70% -> 5.05%               
client [20] (test)  loss: 5.2475 -> 4.8466   acc: 1.70% -> 8.70%               
client [59] (test)  loss: 5.2614 -> 4.8809   acc: 2.73% -> 2.91%               
client [48] (test)  loss: 5.1605 -> 4.8891   acc: 2.15% -> 3.76%               
client [34] (test)  loss: 5.1251 -> 5.0780   acc: 1.64% -> 2.36%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.9613 -> 4.5682   acc: 1.48% -> 8.33%               
client [99] (test)  loss: 5.5266 -> 4.9252   acc: 2.89% -> 3.97%               
client [67] (test)  loss: 4.9129 -> 4.5695   acc: 4.66% -> 10.07%              
client [0] (test)  loss: 4.7259 -> 4.8139   acc: 5.62% -> 7.97%                
client [76] (test)  loss: 4.7798 -> 4.4846   acc: 5.99% -> 6.35%               
client [41] (test)  loss: 5.3238 -> 4.7507   acc: 1.45% -> 3.08%               
client [62] (test)  loss: 5.1699 -> 4.7627   acc: 1.44% -> 5.21%               
client [2] (test)  loss: 5.1922 -> 5.0657   acc: 2.30% -> 4.03%                
client [14] (test)  loss: 4.7097 -> 4.8689   acc: 6.86% -> 6.50%               
client [46] (test)  loss: 5.0641 -> 4.6861   acc: 3.45% -> 5.26%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7689 -> 4.1757   acc: 7.13% -> 14.80%              
client [68] (test)  loss: 4.6041 -> 4.5578   acc: 6.69% -> 8.68%               
client [57] (test)  loss: 4.5955 -> 4.5709   acc: 6.90% -> 10.71%              
client [17] (test)  loss: 6.5371 -> 4.5864   acc: 3.42% -> 7.75%               
client [54] (test)  loss: 4.6523 -> 4.5469   acc: 5.81% -> 8.17%               
client [23] (test)  loss: 5.1699 -> 4.6969   acc: 1.81% -> 5.61%               
client [35] (test)  loss: 4.6889 -> 4.4351   acc: 6.53% -> 9.07%               
client [59] (test)  loss: 4.5587 -> 4.4363   acc: 5.27% -> 9.27%               
client [31] (test)  loss: 4.5589 -> 4.7200   acc: 5.95% -> 8.11%               
client [9] (test)  loss: 4.7062 -> 4.6693   acc: 6.15% -> 5.79%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6066 -> 4.4351   acc: 8.92% -> 11.15%              
client [33] (test)  loss: 4.4905 -> 4.4928   acc: 8.33% -> 7.07%               
client [16] (test)  loss: 4.4437 -> 4.2948   acc: 8.44% -> 11.31%              
client [44] (test)  loss: 10.2753 -> 4.3920   acc: 2.31% -> 10.48%             
client [8] (test)  loss: 4.6336 -> 4.5998   acc: 4.87% -> 7.94%                
client [31] (test)  loss: 4.6360 -> 4.6877   acc: 5.05% -> 7.39%               
client [47] (test)  loss: 4.6893 -> 4.4405   acc: 7.40% -> 8.66%               
client [36] (test)  loss: 4.5521 -> 4.3154   acc: 6.36% -> 9.45%               
client [20] (test)  loss: 4.7336 -> 4.3227   acc: 7.75% -> 10.78%              
client [56] (test)  loss: 4.5924 -> 4.3840   acc: 10.29% -> 9.39%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4969 -> 4.3318   acc: 8.53% -> 9.62%                
client [60] (test)  loss: 4.9679 -> 4.2990   acc: 8.45% -> 11.87%              
client [28] (test)  loss: 5.0181 -> 4.5300   acc: 9.44% -> 9.62%               
client [25] (test)  loss: 5.3404 -> 4.2524   acc: 6.49% -> 12.07%              
client [58] (test)  loss: 4.4882 -> 4.4353   acc: 10.45% -> 11.53%             
client [44] (test)  loss: 4.2830 -> 4.3389   acc: 11.19% -> 11.01%             
client [39] (test)  loss: 4.2808 -> 4.2273   acc: 12.18% -> 11.82%             
client [29] (test)  loss: 4.9485 -> 4.1731   acc: 7.18% -> 13.66%              
client [3] (test)  loss: 4.6665 -> 4.2078   acc: 7.16% -> 14.13%               
client [84] (test)  loss: 4.4579 -> 4.2440   acc: 13.04% -> 12.68%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.6721 -> 4.2739   acc: 9.62% -> 11.43%              
client [84] (test)  loss: 4.3167 -> 4.1702   acc: 13.04% -> 15.76%             
client [10] (test)  loss: 4.9079 -> 4.2371   acc: 9.35% -> 14.75%              
client [36] (test)  loss: 4.4450 -> 4.1732   acc: 8.91% -> 14.91%              
client [65] (test)  loss: 4.3129 -> 4.4328   acc: 11.25% -> 10.71%             
client [81] (test)  loss: 4.5735 -> 4.1962   acc: 9.59% -> 12.18%              
client [79] (test)  loss: 4.4089 -> 4.3623   acc: 10.48% -> 7.99%              
client [42] (test)  loss: 4.5263 -> 4.4469   acc: 10.75% -> 13.21%             
client [11] (test)  loss: 4.5891 -> 4.2289   acc: 6.47% -> 12.41%              
client [96] (test)  loss: 4.2898 -> 4.0193   acc: 11.53% -> 16.04%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.4720 -> 4.5975   acc: 9.93% -> 10.47%               
client [53] (test)  loss: 4.5119 -> 4.2732   acc: 8.29% -> 12.52%              
client [52] (test)  loss: 4.4249 -> 4.4153   acc: 11.96% -> 12.14%             
client [42] (test)  loss: 4.4200 -> 4.5033   acc: 12.83% -> 14.34%             
client [69] (test)  loss: 4.3519 -> 4.2267   acc: 11.67% -> 15.19%             
client [59] (test)  loss: 4.2983 -> 4.1290   acc: 10.73% -> 13.45%             
client [7] (test)  loss: 4.9380 -> 4.2177   acc: 9.42% -> 13.59%               
client [26] (test)  loss: 4.4248 -> 4.2218   acc: 10.79% -> 11.51%             
client [49] (test)  loss: 4.3010 -> 4.4351   acc: 11.01% -> 10.83%             
client [98] (test)  loss: 4.2745 -> 4.3022   acc: 10.73% -> 13.27%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.3177 -> 4.2778   acc: 11.09% -> 13.45%             
client [47] (test)  loss: 4.6592 -> 4.3047   acc: 10.83% -> 14.26%             
client [21] (test)  loss: 4.1875 -> 4.2741   acc: 11.07% -> 13.25%             
client [77] (test)  loss: 4.1980 -> 4.2816   acc: 11.69% -> 13.13%             
client [95] (test)  loss: 4.4485 -> 4.3807   acc: 10.13% -> 12.95%             
client [91] (test)  loss: 4.5773 -> 4.5075   acc: 11.64% -> 12.55%             
client [14] (test)  loss: 4.1999 -> 4.4261   acc: 11.19% -> 12.64%             
client [99] (test)  loss: 4.1718 -> 4.4864   acc: 14.80% -> 10.47%             
client [20] (test)  loss: 4.7627 -> 3.9946   acc: 10.02% -> 20.60%             
client [39] (test)  loss: 4.3487 -> 4.1065   acc: 12.91% -> 14.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.4944 -> 4.4560   acc: 11.05% -> 13.22%             
client [62] (test)  loss: 4.4061 -> 4.5032   acc: 11.13% -> 12.03%             
client [71] (test)  loss: 4.3573 -> 4.3264   acc: 12.54% -> 11.47%             
client [97] (test)  loss: 4.4503 -> 4.4240   acc: 12.55% -> 11.45%             
client [30] (test)  loss: 4.1842 -> 4.5340   acc: 13.77% -> 9.60%              
client [88] (test)  loss: 4.4066 -> 4.1547   acc: 10.49% -> 18.44%             
client [60] (test)  loss: 4.5556 -> 4.2605   acc: 9.17% -> 16.01%              
client [82] (test)  loss: 4.2667 -> 4.1574   acc: 14.46% -> 19.11%             
client [91] (test)  loss: 4.5479 -> 4.5698   acc: 10.73% -> 12.36%             
client [57] (test)  loss: 4.2131 -> 4.2108   acc: 12.89% -> 15.61%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.0593 -> 5.0371   acc: 9.37% -> 10.99%              
client [15] (test)  loss: 4.7624 -> 4.4119   acc: 8.80% -> 12.03%              
client [71] (test)  loss: 4.3812 -> 4.3779   acc: 12.01% -> 12.37%             
client [97] (test)  loss: 4.4036 -> 4.5294   acc: 13.64% -> 12.00%             
client [53] (test)  loss: 4.6829 -> 4.5509   acc: 8.82% -> 10.76%              
client [77] (test)  loss: 4.3535 -> 4.3614   acc: 12.05% -> 12.59%             
client [76] (test)  loss: 4.3257 -> 4.1867   acc: 15.06% -> 19.42%             
client [79] (test)  loss: 4.4157 -> 4.3900   acc: 11.55% -> 10.48%             
client [28] (test)  loss: 4.3290 -> 5.1123   acc: 13.43% -> 9.26%              
client [99] (test)  loss: 4.4266 -> 4.5272   acc: 12.09% -> 12.45%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.4352 -> 4.5719   acc: 13.82% -> 10.91%             
client [86] (test)  loss: 4.3426 -> 4.4788   acc: 11.07% -> 13.07%             
client [34] (test)  loss: 4.6742 -> 4.5178   acc: 10.18% -> 12.91%             
client [73] (test)  loss: 4.3081 -> 4.4089   acc: 12.60% -> 11.99%             
client [5] (test)  loss: 4.4823 -> 4.4635   acc: 9.43% -> 9.96%                
client [96] (test)  loss: 4.2732 -> 4.2016   acc: 16.04% -> 16.40%             
client [22] (test)  loss: 4.3789 -> 4.1679   acc: 10.85% -> 14.47%             
client [60] (test)  loss: 4.7280 -> 4.5007   acc: 11.69% -> 14.75%             
client [66] (test)  loss: 4.5567 -> 4.5623   acc: 9.39% -> 14.44%              
client [83] (test)  loss: 4.8776 -> 4.5631   acc: 12.12% -> 15.37%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.5262 -> 4.4592   acc: 14.88% -> 17.97%             
client [65] (test)  loss: 4.4704 -> 4.6045   acc: 11.62% -> 10.71%             
client [95] (test)  loss: 4.9153 -> 4.6568   acc: 9.94% -> 12.01%              
client [17] (test)  loss: 4.6024 -> 4.4647   acc: 13.51% -> 13.15%             
client [8] (test)  loss: 4.8202 -> 4.8833   acc: 12.27% -> 13.54%              
client [35] (test)  loss: 4.6493 -> 4.5911   acc: 13.61% -> 14.52%             
client [98] (test)  loss: 4.4633 -> 4.4581   acc: 11.27% -> 14.00%             
client [53] (test)  loss: 4.6601 -> 4.7051   acc: 8.99% -> 10.58%              
client [43] (test)  loss: 4.5820 -> 4.4776   acc: 11.05% -> 11.41%             
client [64] (test)  loss: 4.6203 -> 4.5248   acc: 11.34% -> 14.68%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.5495 -> 4.5300   acc: 10.53% -> 14.52%             
client [88] (test)  loss: 4.7572 -> 4.5850   acc: 9.22% -> 15.37%              
client [38] (test)  loss: 4.6362 -> 4.6924   acc: 11.11% -> 12.59%             
client [3] (test)  loss: 5.1515 -> 4.6557   acc: 8.41% -> 17.53%               
client [5] (test)  loss: 4.5769 -> 4.7165   acc: 11.57% -> 9.43%               
client [41] (test)  loss: 4.5089 -> 4.6195   acc: 10.69% -> 11.78%             
client [7] (test)  loss: 4.5602 -> 4.5591   acc: 12.68% -> 12.14%              
client [37] (test)  loss: 4.4333 -> 4.5807   acc: 11.17% -> 12.97%             
client [45] (test)  loss: 4.4929 -> 4.3002   acc: 14.55% -> 13.82%             
client [47] (test)  loss: 5.0784 -> 4.4688   acc: 10.47% -> 16.06%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.6539 -> 4.7131   acc: 13.64% -> 17.24%             
client [11] (test)  loss: 4.6484 -> 4.4529   acc: 11.33% -> 14.93%             
client [37] (test)  loss: 4.5151 -> 4.7023   acc: 10.27% -> 13.51%             
client [41] (test)  loss: 4.6104 -> 4.7310   acc: 10.14% -> 11.78%             
client [95] (test)  loss: 5.0686 -> 4.9203   acc: 10.13% -> 13.13%             
client [53] (test)  loss: 5.2247 -> 4.8326   acc: 7.76% -> 10.58%              
client [22] (test)  loss: 4.5753 -> 4.4014   acc: 9.95% -> 15.01%              
client [25] (test)  loss: 4.4222 -> 4.6528   acc: 10.63% -> 11.53%             
client [69] (test)  loss: 4.9292 -> 4.8441   acc: 11.11% -> 13.89%             
client [46] (test)  loss: 4.5951 -> 4.5981   acc: 13.25% -> 13.07%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.5618 -> 4.7483   acc: 12.09% -> 16.25%             
client [69] (test)  loss: 5.0164 -> 5.0570   acc: 10.37% -> 12.78%             
client [82] (test)  loss: 4.6522 -> 4.5385   acc: 14.11% -> 18.75%             
client [45] (test)  loss: 4.4288 -> 4.5465   acc: 13.82% -> 15.45%             
client [7] (test)  loss: 4.5302 -> 4.6473   acc: 13.22% -> 12.86%              
client [50] (test)  loss: 4.5376 -> 4.7191   acc: 10.51% -> 13.77%             
client [35] (test)  loss: 4.5975 -> 4.7556   acc: 14.16% -> 14.70%             
client [24] (test)  loss: 5.0835 -> 4.5550   acc: 10.70% -> 18.18%             
client [15] (test)  loss: 5.2877 -> 4.8425   acc: 8.44% -> 10.77%              
client [58] (test)  loss: 4.9555 -> 5.2558   acc: 14.59% -> 14.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.6723 -> 4.7683   acc: 12.90% -> 15.05%             
client [76] (test)  loss: 4.8764 -> 4.8267   acc: 13.25% -> 19.24%             
client [67] (test)  loss: 4.6127 -> 4.5776   acc: 12.13% -> 18.66%             
client [37] (test)  loss: 4.9005 -> 4.9315   acc: 11.35% -> 13.33%             
client [58] (test)  loss: 5.2201 -> 5.4276   acc: 11.89% -> 13.15%             
client [64] (test)  loss: 4.9269 -> 4.9191   acc: 11.34% -> 13.57%             
client [77] (test)  loss: 4.6765 -> 4.8020   acc: 11.69% -> 13.31%             
client [55] (test)  loss: 5.0471 -> 4.9188   acc: 10.73% -> 13.77%             
client [12] (test)  loss: 5.1270 -> 5.0971   acc: 8.42% -> 12.01%              
client [89] (test)  loss: 4.9667 -> 4.7897   acc: 14.16% -> 17.38%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.3971 -> 5.1642   acc: 13.59% -> 14.49%             
client [51] (test)  loss: 4.9548 -> 4.8765   acc: 13.69% -> 17.12%             
client [8] (test)  loss: 5.1705 -> 5.2452   acc: 12.27% -> 13.90%              
client [18] (test)  loss: 4.7284 -> 4.8764   acc: 12.88% -> 14.49%             
client [94] (test)  loss: 5.1794 -> 5.0508   acc: 8.32% -> 12.48%              
client [81] (test)  loss: 5.2041 -> 5.2018   acc: 8.86% -> 9.78%               
client [3] (test)  loss: 5.2935 -> 5.0661   acc: 12.70% -> 15.56%              
client [11] (test)  loss: 4.9458 -> 4.7309   acc: 10.79% -> 16.55%             
client [95] (test)  loss: 5.7057 -> 5.3537   acc: 10.13% -> 14.45%             
client [67] (test)  loss: 4.9298 -> 4.6649   acc: 11.38% -> 17.35%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.9431 -> 4.7056   acc: 10.71% -> 15.97%             
client [79] (test)  loss: 5.0129 -> 5.3048   acc: 13.50% -> 12.43%             
client [58] (test)  loss: 5.4580 -> 5.5884   acc: 12.43% -> 12.43%             
client [88] (test)  loss: 5.4432 -> 5.0074   acc: 7.23% -> 12.30%              
client [46] (test)  loss: 5.3453 -> 4.9367   acc: 11.80% -> 13.07%             
client [11] (test)  loss: 5.1953 -> 4.8143   acc: 8.45% -> 16.91%              
client [55] (test)  loss: 5.2588 -> 5.1904   acc: 10.91% -> 13.77%             
client [13] (test)  loss: 5.5309 -> 5.0492   acc: 9.24% -> 13.59%              
client [31] (test)  loss: 5.8083 -> 5.4156   acc: 9.91% -> 10.81%              
client [75] (test)  loss: 5.4592 -> 5.1025   acc: 10.47% -> 15.16%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.2970 -> 5.2281   acc: 10.66% -> 12.50%             
client [7] (test)  loss: 4.9170 -> 4.9444   acc: 11.05% -> 13.41%              
client [57] (test)  loss: 4.9464 -> 5.0288   acc: 12.89% -> 15.43%             
client [13] (test)  loss: 5.6439 -> 5.1091   acc: 8.33% -> 12.68%              
client [43] (test)  loss: 5.2189 -> 4.9771   acc: 10.51% -> 12.86%             
client [91] (test)  loss: 5.4396 -> 5.2600   acc: 10.36% -> 11.64%             
client [10] (test)  loss: 5.4053 -> 5.2191   acc: 12.95% -> 16.01%             
client [64] (test)  loss: 5.0985 -> 5.2823   acc: 12.64% -> 12.83%             
client [82] (test)  loss: 5.3535 -> 4.9320   acc: 11.79% -> 17.68%             
client [22] (test)  loss: 4.9163 -> 4.8396   acc: 10.31% -> 16.46%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.0045 -> 4.7923   acc: 13.42% -> 19.09%             
client [23] (test)  loss: 5.2528 -> 5.4874   acc: 9.95% -> 9.40%               
client [88] (test)  loss: 5.6166 -> 5.1451   acc: 9.04% -> 13.38%              
client [98] (test)  loss: 5.1112 -> 5.4807   acc: 12.91% -> 12.91%             
client [79] (test)  loss: 5.0617 -> 5.4046   acc: 13.68% -> 12.79%             
client [21] (test)  loss: 4.8629 -> 4.8597   acc: 13.79% -> 14.88%             
client [92] (test)  loss: 5.3582 -> 4.9857   acc: 12.14% -> 15.71%             
client [56] (test)  loss: 5.7348 -> 5.0983   acc: 12.64% -> 19.49%             
client [5] (test)  loss: 5.4372 -> 5.3353   acc: 10.85% -> 11.57%              
client [52] (test)  loss: 5.6076 -> 5.6205   acc: 11.59% -> 13.04%             
==================== FedBN_1 TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '4.4407 -> 0.0000', 'accuracy': '12.04% -> 0.00%'},          
    200: {'loss': '5.3958 -> 0.0000', 'accuracy': '11.11% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_1 achieved 10.0%(10.01%) at epoch: 54                                    
Convergence (test_after):                                                      
FedBN_1 achieved 10.0%(10.98%) at epoch: 40                                    
