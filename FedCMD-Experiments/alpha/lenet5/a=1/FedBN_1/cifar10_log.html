==================== ALGORITHM: FedBN_1 ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 1.0,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3471 -> 1.5578   acc: 11.92% -> 38.86%             
client [81] (test)  loss: 2.0957 -> 2.4631   acc: 17.54% -> 26.15%             
client [21] (test)  loss: 49.3073 -> 1.9089   acc: 10.03% -> 36.78%            
client [68] (test)  loss: 2.0099 -> 1.7659   acc: 25.00% -> 30.77%             
client [93] (test)  loss: 2.3016 -> 1.5401   acc: 22.02% -> 45.24%             
client [31] (test)  loss: 2.5171 -> 1.5804   acc: 17.67% -> 42.05%             
client [20] (test)  loss: 1.9232 -> 1.2098   acc: 31.99% -> 62.50%             
client [59] (test)  loss: 43.1017 -> 2.2980   acc: 5.25% -> 25.36%             
client [48] (test)  loss: 2.2217 -> 1.6679   acc: 41.32% -> 42.98%             
client [34] (test)  loss: 1.9903 -> 2.2126   acc: 29.97% -> 32.15%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.8919 -> 1.5973   acc: 6.76% -> 40.99%              
client [99] (test)  loss: 1.7951 -> 1.3823   acc: 26.89% -> 51.89%             
client [67] (test)  loss: 1.4290 -> 1.3307   acc: 50.00% -> 50.59%             
client [0] (test)  loss: 1.5500 -> 1.6246   acc: 50.62% -> 47.33%              
client [76] (test)  loss: 1.6713 -> 1.4113   acc: 46.08% -> 50.33%             
client [41] (test)  loss: 1.8192 -> 1.5844   acc: 30.86% -> 41.64%             
client [62] (test)  loss: 82.5455 -> 1.5309   acc: 29.59% -> 45.92%            
client [2] (test)  loss: 144.7944 -> 1.4333   acc: 6.92% -> 52.25%             
client [14] (test)  loss: 1.6718 -> 1.7367   acc: 42.32% -> 46.06%             
client [46] (test)  loss: 2.0607 -> 1.4516   acc: 32.51% -> 53.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.6922 -> 1.5002   acc: 33.73% -> 51.48%             
client [68] (test)  loss: 1.5572 -> 1.5497   acc: 38.14% -> 37.50%             
client [57] (test)  loss: 2.0761 -> 1.4463   acc: 28.87% -> 50.30%             
client [17] (test)  loss: 2.8429 -> 1.2018   acc: 8.77% -> 57.35%              
client [54] (test)  loss: 1.4739 -> 1.3513   acc: 48.65% -> 52.69%             
client [23] (test)  loss: 191.7059 -> 1.3081   acc: 12.30% -> 53.00%           
client [35] (test)  loss: 1.9038 -> 1.8858   acc: 30.18% -> 42.18%             
client [59] (test)  loss: 2.0075 -> 1.6589   acc: 26.53% -> 44.02%             
client [31] (test)  loss: 1.6240 -> 1.3509   acc: 44.17% -> 50.53%             
client [9] (test)  loss: 1.7202 -> 1.4579   acc: 40.75% -> 50.47%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.9313 -> 1.1387   acc: 37.69% -> 58.36%             
client [33] (test)  loss: 1.9435 -> 1.4379   acc: 37.62% -> 50.50%             
client [16] (test)  loss: 2.9451 -> 1.2446   acc: 12.23% -> 53.52%             
client [44] (test)  loss: 3.4723 -> 1.3664   acc: 30.77% -> 52.17%             
client [8] (test)  loss: 2.0471 -> 1.7366   acc: 32.49% -> 45.84%              
client [31] (test)  loss: 2.5662 -> 1.2750   acc: 23.32% -> 52.65%             
client [47] (test)  loss: 1.7962 -> 1.1884   acc: 38.59% -> 55.95%             
client [36] (test)  loss: 1.6560 -> 1.2846   acc: 39.69% -> 56.31%             
client [20] (test)  loss: 1.3536 -> 1.0152   acc: 51.84% -> 68.75%             
client [56] (test)  loss: 2.8504 -> 1.4839   acc: 22.14% -> 50.38%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.7493 -> 1.2887   acc: 43.13% -> 59.89%              
client [60] (test)  loss: 1.8236 -> 1.0687   acc: 46.61% -> 68.22%             
client [28] (test)  loss: 2.6946 -> 1.2401   acc: 32.92% -> 59.01%             
client [25] (test)  loss: 2.7480 -> 1.5777   acc: 16.02% -> 42.43%             
client [58] (test)  loss: 2.3962 -> 1.2793   acc: 15.38% -> 51.38%             
client [44] (test)  loss: 1.6336 -> 1.1941   acc: 45.15% -> 58.86%             
client [39] (test)  loss: 2.1562 -> 1.3567   acc: 25.78% -> 53.33%             
client [29] (test)  loss: 2.0992 -> 1.4449   acc: 38.44% -> 52.26%             
client [3] (test)  loss: 1.7978 -> 1.2374   acc: 31.05% -> 59.27%              
client [84] (test)  loss: 1.8293 -> 1.3889   acc: 37.01% -> 56.49%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.3541 -> 1.7702   acc: 31.00% -> 50.76%             
client [84] (test)  loss: 1.8164 -> 1.2868   acc: 37.01% -> 57.79%             
client [10] (test)  loss: 1.4169 -> 1.4717   acc: 47.35% -> 50.38%             
client [36] (test)  loss: 1.5633 -> 1.1993   acc: 45.54% -> 60.31%             
client [65] (test)  loss: 2.2654 -> 1.4511   acc: 36.51% -> 59.52%             
client [81] (test)  loss: 1.7035 -> 1.6726   acc: 42.77% -> 47.38%             
client [79] (test)  loss: 1.6671 -> 1.2457   acc: 44.20% -> 56.35%             
client [42] (test)  loss: 2.2656 -> 1.2397   acc: 43.98% -> 57.70%             
client [11] (test)  loss: 1.5413 -> 1.2759   acc: 49.59% -> 56.91%             
client [96] (test)  loss: 1.5817 -> 1.3710   acc: 44.72% -> 56.50%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.0917 -> 1.5129   acc: 38.79% -> 52.64%              
client [53] (test)  loss: 1.5554 -> 1.3916   acc: 47.74% -> 57.42%             
client [52] (test)  loss: 2.7532 -> 1.1968   acc: 26.35% -> 63.17%             
client [42] (test)  loss: 2.3716 -> 1.2512   acc: 33.61% -> 57.14%             
client [69] (test)  loss: 1.5164 -> 1.4976   acc: 45.05% -> 55.41%             
client [59] (test)  loss: 1.6573 -> 1.4971   acc: 43.15% -> 52.77%             
client [7] (test)  loss: 2.0500 -> 0.7149   acc: 42.13% -> 76.65%              
client [26] (test)  loss: 1.7846 -> 1.4296   acc: 45.04% -> 54.45%             
client [49] (test)  loss: 1.6381 -> 1.1159   acc: 43.85% -> 60.88%             
client [98] (test)  loss: 2.1514 -> 1.2990   acc: 37.82% -> 57.14%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.5655 -> 1.3555   acc: 49.58% -> 56.30%             
client [47] (test)  loss: 1.9782 -> 1.3485   acc: 43.41% -> 61.41%             
client [21] (test)  loss: 1.8611 -> 1.7055   acc: 39.51% -> 53.80%             
client [77] (test)  loss: 1.5836 -> 1.4938   acc: 46.11% -> 50.78%             
client [95] (test)  loss: 1.7992 -> 1.2817   acc: 41.64% -> 54.41%             
client [91] (test)  loss: 1.5495 -> 1.1308   acc: 49.03% -> 66.30%             
client [14] (test)  loss: 1.4290 -> 1.0708   acc: 51.87% -> 65.15%             
client [99] (test)  loss: 2.6229 -> 1.2261   acc: 34.91% -> 57.08%             
client [20] (test)  loss: 2.1065 -> 1.0593   acc: 43.75% -> 68.75%             
client [39] (test)  loss: 1.7565 -> 1.3695   acc: 42.67% -> 52.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.2245 -> 1.1725   acc: 36.19% -> 63.81%             
client [62] (test)  loss: 1.4170 -> 1.1057   acc: 54.08% -> 61.90%             
client [71] (test)  loss: 1.7117 -> 1.2614   acc: 45.50% -> 60.81%             
client [97] (test)  loss: 1.5903 -> 0.9608   acc: 51.69% -> 65.54%             
client [30] (test)  loss: 1.2887 -> 1.3442   acc: 55.19% -> 60.53%             
client [88] (test)  loss: 2.3296 -> 1.5549   acc: 38.87% -> 53.82%             
client [60] (test)  loss: 1.9151 -> 0.9919   acc: 40.68% -> 71.19%             
client [82] (test)  loss: 2.1613 -> 1.3573   acc: 39.16% -> 58.74%             
client [91] (test)  loss: 2.0100 -> 1.0422   acc: 40.95% -> 69.92%             
client [57] (test)  loss: 1.5293 -> 1.4308   acc: 54.17% -> 54.17%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.5811 -> 1.1980   acc: 47.00% -> 57.24%             
client [15] (test)  loss: 2.0357 -> 1.3431   acc: 45.19% -> 60.58%             
client [71] (test)  loss: 1.8683 -> 1.2983   acc: 40.54% -> 60.36%             
client [97] (test)  loss: 1.3844 -> 1.0066   acc: 52.43% -> 66.29%             
client [53] (test)  loss: 1.9440 -> 1.4940   acc: 49.03% -> 55.48%             
client [77] (test)  loss: 1.6609 -> 1.6110   acc: 46.63% -> 50.78%             
client [76] (test)  loss: 1.2825 -> 1.1475   acc: 56.54% -> 60.13%             
client [79] (test)  loss: 1.8789 -> 1.3699   acc: 45.86% -> 54.70%             
client [28] (test)  loss: 2.1198 -> 1.0720   acc: 46.58% -> 68.01%             
client [99] (test)  loss: 2.5026 -> 1.2031   acc: 37.74% -> 58.02%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.3067 -> 1.0123   acc: 58.43% -> 65.54%             
client [86] (test)  loss: 1.3117 -> 0.9620   acc: 63.39% -> 73.21%             
client [34] (test)  loss: 2.3055 -> 1.3732   acc: 35.15% -> 55.04%             
client [73] (test)  loss: 1.0525 -> 1.0894   acc: 63.33% -> 65.93%             
client [5] (test)  loss: 1.4659 -> 1.1995   acc: 52.41% -> 58.29%              
client [96] (test)  loss: 2.0716 -> 1.3613   acc: 41.46% -> 60.16%             
client [22] (test)  loss: 1.4513 -> 1.2720   acc: 48.40% -> 60.64%             
client [60] (test)  loss: 1.7872 -> 1.0269   acc: 43.22% -> 72.88%             
client [66] (test)  loss: 1.4558 -> 1.3104   acc: 52.91% -> 60.94%             
client [83] (test)  loss: 1.8021 -> 2.3215   acc: 42.91% -> 40.30%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.3368 -> 1.2693   acc: 52.94% -> 54.58%             
client [65] (test)  loss: 2.0734 -> 1.3704   acc: 41.67% -> 61.11%             
client [95] (test)  loss: 1.9622 -> 1.2737   acc: 40.43% -> 59.27%             
client [17] (test)  loss: 2.2546 -> 1.4735   acc: 38.63% -> 59.00%             
client [8] (test)  loss: 1.6659 -> 1.4102   acc: 50.38% -> 60.96%              
client [35] (test)  loss: 2.6348 -> 1.6429   acc: 34.55% -> 53.82%             
client [98] (test)  loss: 2.0363 -> 1.3435   acc: 39.08% -> 58.82%             
client [53] (test)  loss: 1.6542 -> 1.4871   acc: 52.26% -> 56.77%             
client [43] (test)  loss: 2.1759 -> 0.9348   acc: 38.58% -> 70.68%             
client [64] (test)  loss: 1.5854 -> 1.1911   acc: 48.94% -> 62.92%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.3506 -> 1.3690   acc: 37.08% -> 58.97%             
client [88] (test)  loss: 2.0996 -> 1.5982   acc: 44.85% -> 53.82%             
client [38] (test)  loss: 2.1957 -> 1.4226   acc: 38.00% -> 54.40%             
client [3] (test)  loss: 1.7066 -> 1.2759   acc: 48.79% -> 60.89%              
client [5] (test)  loss: 1.6692 -> 1.2793   acc: 47.59% -> 58.29%              
client [41] (test)  loss: 2.3059 -> 1.1997   acc: 41.26% -> 60.22%             
client [7] (test)  loss: 1.8370 -> 0.6960   acc: 47.46% -> 78.68%              
client [37] (test)  loss: 2.6219 -> 0.8151   acc: 31.18% -> 74.71%             
client [45] (test)  loss: 1.8353 -> 1.5318   acc: 48.36% -> 56.25%             
client [47] (test)  loss: 1.7768 -> 1.3171   acc: 51.77% -> 62.70%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.7393 -> 1.3891   acc: 48.01% -> 57.49%             
client [11] (test)  loss: 1.5234 -> 1.4637   acc: 54.88% -> 58.54%             
client [37] (test)  loss: 1.6375 -> 0.8324   acc: 52.35% -> 71.18%             
client [41] (test)  loss: 1.7274 -> 1.1446   acc: 47.58% -> 58.74%             
client [95] (test)  loss: 2.1813 -> 1.3854   acc: 40.73% -> 57.14%             
client [53] (test)  loss: 2.2916 -> 1.3949   acc: 46.77% -> 61.94%             
client [22] (test)  loss: 1.2193 -> 1.3080   acc: 60.06% -> 60.64%             
client [25] (test)  loss: 3.4262 -> 1.5088   acc: 26.11% -> 50.45%             
client [69] (test)  loss: 2.1357 -> 1.5150   acc: 49.10% -> 59.91%             
client [46] (test)  loss: 1.9851 -> 1.5736   acc: 50.69% -> 59.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.6514 -> 1.4383   acc: 54.98% -> 60.77%             
client [69] (test)  loss: 1.5015 -> 1.5284   acc: 56.76% -> 59.01%             
client [82] (test)  loss: 1.7166 -> 1.4013   acc: 49.30% -> 59.79%             
client [45] (test)  loss: 1.7547 -> 1.4698   acc: 51.32% -> 58.22%             
client [7] (test)  loss: 1.8722 -> 0.6936   acc: 45.18% -> 79.44%              
client [50] (test)  loss: 1.7330 -> 1.4454   acc: 54.00% -> 59.60%             
client [35] (test)  loss: 2.0176 -> 1.4647   acc: 42.55% -> 56.73%             
client [24] (test)  loss: 1.9650 -> 1.0748   acc: 46.45% -> 69.82%             
client [15] (test)  loss: 3.0946 -> 1.3896   acc: 28.85% -> 61.54%             
client [58] (test)  loss: 2.8571 -> 1.4069   acc: 28.00% -> 56.62%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.7108 -> 1.1190   acc: 53.44% -> 65.84%             
client [76] (test)  loss: 1.5601 -> 1.1876   acc: 49.35% -> 58.17%             
client [67] (test)  loss: 1.3715 -> 1.1457   acc: 52.96% -> 61.83%             
client [37] (test)  loss: 1.7931 -> 0.8226   acc: 49.41% -> 72.35%             
client [58] (test)  loss: 1.6201 -> 1.4542   acc: 49.23% -> 53.54%             
client [64] (test)  loss: 1.3770 -> 1.2020   acc: 58.36% -> 62.61%             
client [77] (test)  loss: 2.1686 -> 1.5843   acc: 39.38% -> 54.40%             
client [55] (test)  loss: 1.9299 -> 1.3352   acc: 42.45% -> 62.86%             
client [12] (test)  loss: 2.3177 -> 0.8726   acc: 31.82% -> 74.33%             
client [89] (test)  loss: 1.7901 -> 1.4760   acc: 47.22% -> 56.79%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.2182 -> 1.2073   acc: 59.09% -> 66.23%             
client [51] (test)  loss: 1.4418 -> 1.4786   acc: 58.94% -> 59.60%             
client [8] (test)  loss: 2.0359 -> 1.4638   acc: 45.09% -> 61.71%              
client [18] (test)  loss: 1.5309 -> 1.0861   acc: 53.42% -> 69.71%             
client [94] (test)  loss: 2.0429 -> 1.5141   acc: 44.13% -> 58.69%             
client [81] (test)  loss: 1.7436 -> 1.3757   acc: 53.85% -> 60.92%             
client [3] (test)  loss: 1.7177 -> 1.4185   acc: 50.00% -> 60.08%              
client [11] (test)  loss: 1.4645 -> 1.7161   acc: 55.28% -> 54.88%             
client [95] (test)  loss: 1.8899 -> 1.4781   acc: 42.86% -> 57.75%             
client [67] (test)  loss: 1.9409 -> 1.1449   acc: 45.56% -> 61.54%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.1530 -> 1.2385   acc: 42.55% -> 59.88%             
client [79] (test)  loss: 1.8774 -> 1.3337   acc: 47.51% -> 59.12%             
client [58] (test)  loss: 1.8175 -> 1.5392   acc: 45.23% -> 55.08%             
client [88] (test)  loss: 2.2613 -> 1.4331   acc: 47.18% -> 56.15%             
client [46] (test)  loss: 2.3070 -> 1.4394   acc: 49.31% -> 61.98%             
client [11] (test)  loss: 1.5704 -> 1.7333   acc: 57.72% -> 58.54%             
client [55] (test)  loss: 1.8556 -> 1.4184   acc: 46.12% -> 58.78%             
client [13] (test)  loss: 1.6302 -> 1.4975   acc: 48.39% -> 60.08%             
client [31] (test)  loss: 1.4102 -> 1.1574   acc: 57.60% -> 63.60%             
client [75] (test)  loss: 1.2902 -> 1.1448   acc: 66.08% -> 68.49%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.9305 -> 1.2527   acc: 44.90% -> 60.82%             
client [7] (test)  loss: 1.1847 -> 0.7147   acc: 62.94% -> 79.95%              
client [57] (test)  loss: 1.4379 -> 1.5626   acc: 55.06% -> 58.33%             
client [13] (test)  loss: 1.7741 -> 1.5087   acc: 45.56% -> 59.27%             
client [43] (test)  loss: 2.7854 -> 0.9508   acc: 33.95% -> 71.91%             
client [91] (test)  loss: 1.6474 -> 1.0215   acc: 50.42% -> 70.75%             
client [10] (test)  loss: 2.6488 -> 1.5837   acc: 37.12% -> 53.79%             
client [64] (test)  loss: 1.3634 -> 1.1570   acc: 58.36% -> 63.53%             
client [82] (test)  loss: 1.9659 -> 1.3814   acc: 46.50% -> 62.24%             
client [22] (test)  loss: 1.4958 -> 1.3981   acc: 55.10% -> 62.68%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.2417 -> 1.0862   acc: 47.43% -> 69.85%             
client [23] (test)  loss: 2.7627 -> 1.3232   acc: 37.22% -> 59.62%             
client [88] (test)  loss: 2.5227 -> 1.5143   acc: 42.52% -> 57.48%             
client [98] (test)  loss: 1.7813 -> 1.3673   acc: 47.48% -> 63.45%             
client [79] (test)  loss: 1.8559 -> 1.4533   acc: 47.51% -> 55.25%             
client [21] (test)  loss: 1.7287 -> 1.2532   acc: 50.15% -> 62.01%             
client [92] (test)  loss: 2.1964 -> 1.4786   acc: 39.02% -> 58.36%             
client [56] (test)  loss: 2.2672 -> 1.5937   acc: 42.75% -> 59.16%             
client [5] (test)  loss: 2.0790 -> 1.4634   acc: 45.45% -> 58.29%              
client [52] (test)  loss: 3.7753 -> 1.3195   acc: 27.30% -> 66.03%             
==================== FedBN_1 TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '1.7588 -> 0.0000', 'accuracy': '47.22% -> 0.00%'},          
    200: {'loss': '2.0883 -> 0.0000', 'accuracy': '46.81% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_1 achieved 10.0%(11.25%) at epoch: 1                                     
FedBN_1 achieved 20.0%(22.83%) at epoch: 6                                     
FedBN_1 achieved 30.0%(32.95%) at epoch: 19                                    
FedBN_1 achieved 40.0%(45.13%) at epoch: 34                                    
FedBN_1 achieved 50.0%(52.88%) at epoch: 80                                    
Convergence (test_after):                                                      
FedBN_1 achieved 30.0%(32.75%) at epoch: 0                                     
FedBN_1 achieved 40.0%(40.03%) at epoch: 8                                     
FedBN_1 achieved 50.0%(50.24%) at epoch: 17                                    
FedBN_1 achieved 60.0%(61.02%) at epoch: 72                                    
