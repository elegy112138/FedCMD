==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9489 -> 0.7968   acc: 73.71% -> 75.75%             
client [81] (test)  loss: 0.6646 -> 0.5483   acc: 81.37% -> 83.61%             
client [21] (test)  loss: 29.6759 -> 0.5282   acc: 0.05% -> 87.52%             
client [68] (test)  loss: 0.3430 -> 0.1848   acc: 90.48% -> 94.92%             
client [93] (test)  loss: 1.0482 -> 0.6643   acc: 75.96% -> 83.97%             
client [31] (test)  loss: 1.4315 -> 0.8960   acc: 62.64% -> 73.72%             
client [20] (test)  loss: 1.1058 -> 0.9211   acc: 71.44% -> 75.26%             
client [59] (test)  loss: 27.1993 -> 1.2073   acc: 0.11% -> 65.49%             
client [48] (test)  loss: 0.6520 -> 0.5858   acc: 79.77% -> 81.44%             
client [34] (test)  loss: 1.3462 -> 0.8516   acc: 68.21% -> 78.76%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4804 -> 0.3709   acc: 88.11% -> 90.43%             
client [99] (test)  loss: 1.3244 -> 0.8833   acc: 68.97% -> 77.27%             
client [67] (test)  loss: 1.2880 -> 0.8181   acc: 66.85% -> 77.51%             
client [0] (test)  loss: 0.5218 -> 0.3980   acc: 86.44% -> 89.45%              
client [76] (test)  loss: 0.9414 -> 0.7600   acc: 74.41% -> 78.81%             
client [41] (test)  loss: 2.2537 -> 1.5104   acc: 45.51% -> 61.23%             
client [62] (test)  loss: 28.1433 -> 1.8885   acc: 0.59% -> 57.11%             
client [2] (test)  loss: 23.6933 -> 0.8432   acc: 0.02% -> 76.73%              
client [14] (test)  loss: 0.6072 -> 0.5418   acc: 85.91% -> 86.94%             
client [46] (test)  loss: 0.7157 -> 0.6435   acc: 80.28% -> 81.89%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4458 -> 0.3996   acc: 88.27% -> 89.65%             
client [68] (test)  loss: 0.1195 -> 0.1154   acc: 96.75% -> 96.78%             
client [57] (test)  loss: 0.6250 -> 0.4959   acc: 83.79% -> 86.19%             
client [17] (test)  loss: 0.2961 -> 0.2621   acc: 91.88% -> 92.73%             
client [54] (test)  loss: 0.6083 -> 0.6304   acc: 83.05% -> 83.08%             
client [23] (test)  loss: 33.1438 -> 1.3458   acc: 0.17% -> 63.75%             
client [35] (test)  loss: 0.7484 -> 0.7137   acc: 79.16% -> 79.76%             
client [59] (test)  loss: 0.7140 -> 0.6492   acc: 75.43% -> 76.94%             
client [31] (test)  loss: 0.5971 -> 0.5893   acc: 80.68% -> 81.20%             
client [9] (test)  loss: 1.1683 -> 1.0358   acc: 66.00% -> 68.58%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7710 -> 0.7244   acc: 75.06% -> 76.02%             
client [33] (test)  loss: 0.7742 -> 0.7878   acc: 77.56% -> 78.33%             
client [16] (test)  loss: 0.5306 -> 0.4682   acc: 85.25% -> 86.79%             
client [44] (test)  loss: 2.1200 -> 1.3482   acc: 47.86% -> 64.10%             
client [8] (test)  loss: 0.7567 -> 0.7564   acc: 77.51% -> 77.41%              
client [31] (test)  loss: 0.5836 -> 0.5890   acc: 81.15% -> 81.32%             
client [47] (test)  loss: 0.5516 -> 0.4912   acc: 83.04% -> 84.50%             
client [36] (test)  loss: 1.3812 -> 0.9307   acc: 65.31% -> 72.85%             
client [20] (test)  loss: 0.7169 -> 0.7254   acc: 79.83% -> 80.10%             
client [56] (test)  loss: 0.9794 -> 0.7966   acc: 74.15% -> 77.75%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4507 -> 0.4204   acc: 87.44% -> 88.20%              
client [60] (test)  loss: 0.7047 -> 0.5561   acc: 81.76% -> 85.30%             
client [28] (test)  loss: 0.6784 -> 0.6877   acc: 79.34% -> 79.81%             
client [25] (test)  loss: 0.0261 -> 0.0233   acc: 99.27% -> 99.34%             
client [58] (test)  loss: 0.2581 -> 0.2581   acc: 93.10% -> 93.20%             
client [44] (test)  loss: 1.3482 -> 1.0689   acc: 64.10% -> 68.07%             
client [39] (test)  loss: 0.6589 -> 0.5736   acc: 81.93% -> 83.63%             
client [29] (test)  loss: 1.0280 -> 0.9622   acc: 68.88% -> 70.42%             
client [3] (test)  loss: 0.5256 -> 0.4918   acc: 86.26% -> 87.14%              
client [84] (test)  loss: 0.4023 -> 0.3986   acc: 89.02% -> 89.29%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2847 -> 0.2432   acc: 91.78% -> 92.61%             
client [84] (test)  loss: 0.4050 -> 0.4174   acc: 89.51% -> 89.59%             
client [10] (test)  loss: 0.7092 -> 0.6896   acc: 79.18% -> 79.78%             
client [36] (test)  loss: 0.6729 -> 0.6330   acc: 80.00% -> 80.93%             
client [65] (test)  loss: 0.7675 -> 0.7583   acc: 76.75% -> 77.42%             
client [81] (test)  loss: 0.4707 -> 0.4777   acc: 83.78% -> 83.83%             
client [79] (test)  loss: 0.6891 -> 0.6648   acc: 81.82% -> 82.21%             
client [42] (test)  loss: 0.3773 -> 0.3680   acc: 89.52% -> 89.87%             
client [11] (test)  loss: 0.6321 -> 0.6106   acc: 83.90% -> 84.59%             
client [96] (test)  loss: 0.5897 -> 0.5707   acc: 82.46% -> 82.89%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7790 -> 0.7982   acc: 77.32% -> 77.16%              
client [53] (test)  loss: 0.7556 -> 0.7118   acc: 77.68% -> 79.16%             
client [52] (test)  loss: 0.7049 -> 0.7058   acc: 78.09% -> 78.94%             
client [42] (test)  loss: 0.3621 -> 0.3640   acc: 90.26% -> 90.35%             
client [69] (test)  loss: 0.3031 -> 0.3145   acc: 93.15% -> 93.35%             
client [59] (test)  loss: 0.5958 -> 0.5904   acc: 79.37% -> 80.08%             
client [7] (test)  loss: 0.5223 -> 0.5307   acc: 83.89% -> 83.77%              
client [26] (test)  loss: 0.3308 -> 0.3142   acc: 88.49% -> 89.20%             
client [49] (test)  loss: 0.2414 -> 0.2347   acc: 93.21% -> 93.61%             
client [98] (test)  loss: 0.2329 -> 0.2358   acc: 93.63% -> 93.58%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2358 -> 0.2421   acc: 93.58% -> 93.43%             
client [47] (test)  loss: 0.4656 -> 0.4535   acc: 84.82% -> 85.30%             
client [21] (test)  loss: 0.2208 -> 0.2075   acc: 93.32% -> 93.74%             
client [77] (test)  loss: 0.6841 -> 0.7036   acc: 78.70% -> 78.80%             
client [95] (test)  loss: 0.1255 -> 0.1263   acc: 96.57% -> 96.59%             
client [91] (test)  loss: 0.6123 -> 0.6274   acc: 82.55% -> 82.42%             
client [14] (test)  loss: 0.4822 -> 0.4865   acc: 88.48% -> 88.51%             
client [99] (test)  loss: 0.5579 -> 0.5457   acc: 85.42% -> 85.54%             
client [20] (test)  loss: 0.8008 -> 0.8235   acc: 80.61% -> 80.12%             
client [39] (test)  loss: 0.5116 -> 0.5119   acc: 85.26% -> 85.36%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7058 -> 0.7118   acc: 78.94% -> 79.33%             
client [62] (test)  loss: 0.8390 -> 0.8761   acc: 77.15% -> 77.21%             
client [71] (test)  loss: 0.7113 -> 0.7250   acc: 78.46% -> 77.88%             
client [97] (test)  loss: 0.2511 -> 0.2507   acc: 92.83% -> 92.56%             
client [30] (test)  loss: 0.4451 -> 0.4585   acc: 88.62% -> 88.67%             
client [88] (test)  loss: 0.4864 -> 0.4737   acc: 83.87% -> 84.16%             
client [60] (test)  loss: 0.4792 -> 0.4892   acc: 87.63% -> 87.56%             
client [82] (test)  loss: 0.6471 -> 0.6594   acc: 81.31% -> 81.25%             
client [91] (test)  loss: 0.6481 -> 0.6731   acc: 82.44% -> 82.23%             
client [57] (test)  loss: 0.3874 -> 0.3738   acc: 89.04% -> 89.33%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.8332 -> 0.8614   acc: 81.91% -> 81.98%             
client [15] (test)  loss: 0.7477 -> 0.7466   acc: 78.85% -> 79.16%             
client [71] (test)  loss: 0.7250 -> 0.7368   acc: 77.88% -> 78.22%             
client [97] (test)  loss: 0.2626 -> 0.2698   acc: 92.49% -> 92.64%             
client [53] (test)  loss: 0.7128 -> 0.7300   acc: 80.31% -> 80.10%             
client [77] (test)  loss: 0.7036 -> 0.7279   acc: 78.80% -> 78.61%             
client [76] (test)  loss: 0.6493 -> 0.6687   acc: 81.75% -> 81.56%             
client [79] (test)  loss: 0.6400 -> 0.6469   acc: 82.75% -> 82.78%             
client [28] (test)  loss: 0.8280 -> 0.8544   acc: 79.91% -> 80.03%             
client [99] (test)  loss: 0.5441 -> 0.5493   acc: 85.67% -> 85.89%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2776 -> 0.2865   acc: 92.54% -> 92.28%             
client [86] (test)  loss: 0.4716 -> 0.4830   acc: 88.15% -> 88.25%             
client [34] (test)  loss: 0.7209 -> 0.7448   acc: 84.51% -> 84.27%             
client [73] (test)  loss: 0.8527 -> 0.8820   acc: 75.96% -> 75.76%             
client [5] (test)  loss: 0.7231 -> 0.7516   acc: 80.95% -> 80.61%              
client [96] (test)  loss: 0.7146 -> 0.7563   acc: 82.08% -> 81.72%             
client [22] (test)  loss: 0.8650 -> 0.8686   acc: 75.40% -> 75.94%             
client [60] (test)  loss: 0.5365 -> 0.5510   acc: 87.59% -> 87.61%             
client [66] (test)  loss: 0.5106 -> 0.5167   acc: 85.99% -> 85.92%             
client [83] (test)  loss: 0.2665 -> 0.2707   acc: 92.70% -> 92.80%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7620 -> 0.7923   acc: 80.52% -> 80.28%             
client [65] (test)  loss: 0.7752 -> 0.7968   acc: 77.94% -> 78.06%             
client [95] (test)  loss: 0.1304 -> 0.1318   acc: 96.69% -> 96.71%             
client [17] (test)  loss: 0.2296 -> 0.2316   acc: 94.11% -> 94.13%             
client [8] (test)  loss: 0.8797 -> 0.9102   acc: 77.26% -> 76.76%              
client [35] (test)  loss: 0.9912 -> 1.0484   acc: 78.45% -> 78.13%             
client [98] (test)  loss: 0.2534 -> 0.2608   acc: 93.43% -> 93.26%             
client [53] (test)  loss: 0.7550 -> 0.7841   acc: 79.95% -> 79.64%             
client [43] (test)  loss: 0.5174 -> 0.5367   acc: 88.20% -> 88.27%             
client [64] (test)  loss: 0.7046 -> 0.7156   acc: 77.10% -> 77.12%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1992 -> 0.1935   acc: 93.83% -> 94.05%             
client [88] (test)  loss: 0.5227 -> 0.5402   acc: 83.46% -> 83.27%             
client [38] (test)  loss: 0.2231 -> 0.2260   acc: 94.88% -> 94.93%             
client [3] (test)  loss: 0.6083 -> 0.6246   acc: 88.19% -> 88.21%              
client [5] (test)  loss: 0.7823 -> 0.8153   acc: 80.30% -> 80.25%              
client [41] (test)  loss: 0.9332 -> 0.9606   acc: 73.75% -> 73.75%             
client [7] (test)  loss: 0.5566 -> 0.5693   acc: 83.97% -> 83.87%              
client [37] (test)  loss: 0.6063 -> 0.6248   acc: 83.45% -> 83.41%             
client [45] (test)  loss: 0.8225 -> 0.8283   acc: 76.74% -> 76.53%             
client [47] (test)  loss: 0.4439 -> 0.4369   acc: 85.54% -> 85.85%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4983 -> 0.5127   acc: 88.11% -> 88.24%             
client [11] (test)  loss: 0.6770 -> 0.6968   acc: 84.34% -> 84.54%             
client [37] (test)  loss: 0.6668 -> 0.6906   acc: 83.30% -> 83.49%             
client [41] (test)  loss: 0.9606 -> 0.9937   acc: 73.75% -> 73.44%             
client [95] (test)  loss: 0.1354 -> 0.1365   acc: 96.69% -> 96.69%             
client [53] (test)  loss: 0.7841 -> 0.8272   acc: 79.64% -> 79.28%             
client [22] (test)  loss: 0.8853 -> 0.9212   acc: 76.25% -> 75.88%             
client [25] (test)  loss: 0.0215 -> 0.0216   acc: 99.49% -> 99.49%             
client [69] (test)  loss: 0.3756 -> 0.3821   acc: 92.53% -> 92.60%             
client [46] (test)  loss: 0.6309 -> 0.6451   acc: 83.38% -> 83.40%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4935 -> 0.5214   acc: 85.88% -> 85.76%             
client [69] (test)  loss: 0.3876 -> 0.3930   acc: 92.49% -> 92.51%             
client [82] (test)  loss: 0.7383 -> 0.7666   acc: 81.73% -> 81.75%             
client [45] (test)  loss: 0.8605 -> 0.8898   acc: 76.99% -> 76.46%             
client [7] (test)  loss: 0.5693 -> 0.5911   acc: 83.87% -> 83.48%              
client [50] (test)  loss: 0.5448 -> 0.5532   acc: 83.30% -> 83.52%             
client [35] (test)  loss: 1.1475 -> 1.1895   acc: 77.60% -> 77.48%             
client [24] (test)  loss: 0.4451 -> 0.4545   acc: 90.80% -> 90.77%             
client [15] (test)  loss: 0.8201 -> 0.8458   acc: 78.36% -> 78.24%             
client [58] (test)  loss: 0.3449 -> 0.3509   acc: 93.27% -> 93.27%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7201 -> 0.7522   acc: 81.94% -> 81.65%             
client [76] (test)  loss: 0.8535 -> 0.8865   acc: 80.50% -> 80.38%             
client [67] (test)  loss: 0.5954 -> 0.5997   acc: 84.38% -> 84.62%             
client [37] (test)  loss: 0.7143 -> 0.7402   acc: 83.30% -> 83.26%             
client [58] (test)  loss: 0.3561 -> 0.3609   acc: 93.29% -> 93.34%             
client [64] (test)  loss: 0.8026 -> 0.8277   acc: 77.02% -> 76.85%             
client [77] (test)  loss: 0.8825 -> 0.9326   acc: 78.01% -> 77.85%             
client [55] (test)  loss: 0.8321 -> 0.8761   acc: 78.81% -> 78.73%             
client [12] (test)  loss: 0.9774 -> 1.0238   acc: 78.31% -> 78.11%             
client [89] (test)  loss: 1.2003 -> 1.2425   acc: 77.50% -> 77.39%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6886 -> 0.6965   acc: 88.98% -> 88.93%             
client [51] (test)  loss: 0.5078 -> 0.5213   acc: 88.82% -> 88.99%             
client [8] (test)  loss: 1.1131 -> 1.1383   acc: 77.72% -> 77.91%              
client [18] (test)  loss: 0.8260 -> 0.8642   acc: 77.14% -> 77.21%             
client [94] (test)  loss: 0.8396 -> 0.8660   acc: 81.65% -> 81.51%             
client [81] (test)  loss: 0.7183 -> 0.7827   acc: 83.56% -> 84.34%             
client [3] (test)  loss: 0.6783 -> 0.6891   acc: 88.26% -> 88.31%              
client [11] (test)  loss: 0.7409 -> 0.7570   acc: 85.82% -> 85.84%             
client [95] (test)  loss: 0.1416 -> 0.1423   acc: 96.81% -> 96.81%             
client [67] (test)  loss: 0.5997 -> 0.6144   acc: 84.62% -> 84.46%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1886 -> 0.1891   acc: 94.23% -> 94.15%             
client [79] (test)  loss: 0.7786 -> 0.7934   acc: 83.49% -> 83.79%             
client [58] (test)  loss: 0.3748 -> 0.3788   acc: 93.29% -> 93.25%             
client [88] (test)  loss: 0.6078 -> 0.6391   acc: 83.05% -> 83.17%             
client [46] (test)  loss: 0.6987 -> 0.7139   acc: 83.19% -> 83.33%             
client [11] (test)  loss: 0.7570 -> 0.7737   acc: 85.84% -> 86.06%             
client [55] (test)  loss: 1.0926 -> 1.1400   acc: 78.29% -> 78.41%             
client [13] (test)  loss: 1.1008 -> 1.1445   acc: 75.88% -> 75.72%             
client [31] (test)  loss: 0.9754 -> 0.9611   acc: 81.15% -> 81.44%             
client [75] (test)  loss: 1.0929 -> 1.1256   acc: 78.74% -> 78.64%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4404 -> 0.4469   acc: 91.50% -> 91.50%             
client [7] (test)  loss: 0.7276 -> 0.7481   acc: 83.19% -> 83.46%              
client [57] (test)  loss: 0.3973 -> 0.4106   acc: 90.44% -> 90.14%             
client [13] (test)  loss: 1.1908 -> 1.2371   acc: 75.49% -> 75.14%             
client [43] (test)  loss: 0.6387 -> 0.6575   acc: 87.86% -> 87.80%             
client [91] (test)  loss: 0.8035 -> 0.8473   acc: 81.13% -> 81.24%             
client [10] (test)  loss: 0.9989 -> 1.0266   acc: 80.75% -> 80.81%             
client [64] (test)  loss: 1.0201 -> 1.1673   acc: 78.03% -> 74.35%             
client [82] (test)  loss: 0.9937 -> 1.0473   acc: 81.02% -> 81.63%             
client [22] (test)  loss: 1.2039 -> 1.2592   acc: 74.94% -> 74.94%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0377 -> 1.0679   acc: 80.05% -> 80.07%             
client [23] (test)  loss: 0.5759 -> 0.5934   acc: 83.74% -> 83.49%             
client [88] (test)  loss: 0.6391 -> 0.6868   acc: 83.17% -> 82.78%             
client [98] (test)  loss: 0.3095 -> 0.3146   acc: 93.43% -> 93.38%             
client [79] (test)  loss: 0.8248 -> 0.8417   acc: 84.06% -> 84.06%             
client [21] (test)  loss: 0.1898 -> 0.1917   acc: 94.13% -> 94.18%             
client [92] (test)  loss: 0.7785 -> 0.8002   acc: 83.61% -> 83.58%             
client [56] (test)  loss: 1.1258 -> 1.1582   acc: 79.80% -> 79.77%             
client [5] (test)  loss: 1.0524 -> 1.0816   acc: 79.60% -> 79.60%              
client [52] (test)  loss: 1.0460 -> 1.0852   acc: 78.01% -> 77.84%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.5715 -> 0.0000', 'accuracy': '84.60% -> 0.00%'},          
    200: {'loss': '0.7832 -> 0.0000', 'accuracy': '84.25% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(13.52%) at epoch: 1                                
Local-only-1 achieved 20.0%(23.04%) at epoch: 2                                
Local-only-1 achieved 40.0%(45.48%) at epoch: 4                                
Local-only-1 achieved 60.0%(60.68%) at epoch: 7                                
Local-only-1 achieved 70.0%(74.81%) at epoch: 16                               
Local-only-1 achieved 80.0%(81.20%) at epoch: 22                               
Local-only-1 achieved 90.0%(90.39%) at epoch: 146                              
Convergence (test_after):                                                      
Local-only-1 achieved 60.0%(67.30%) at epoch: 0                                
Local-only-1 achieved 70.0%(72.72%) at epoch: 2                                
Local-only-1 achieved 80.0%(81.75%) at epoch: 16                               
Local-only-1 achieved 90.0%(90.41%) at epoch: 146                              
