==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.3546 -> 1.2005   acc: 57.97% -> 58.45%             
client [81] (test)  loss: 0.4298 -> 0.3393   acc: 89.65% -> 90.75%             
client [21] (test)  loss: 2.3887 -> 1.9620   acc: 18.64% -> 37.97%             
client [68] (test)  loss: 1.4443 -> 1.2633   acc: 43.69% -> 55.34%             
client [93] (test)  loss: 1.0237 -> 0.9080   acc: 76.49% -> 81.34%             
client [31] (test)  loss: 1.4820 -> 1.2466   acc: 52.20% -> 57.29%             
client [20] (test)  loss: 1.8308 -> 1.6784   acc: 41.32% -> 41.32%             
client [59] (test)  loss: 2.3632 -> 1.0057   acc: 8.25% -> 67.66%              
client [48] (test)  loss: 1.1635 -> 0.9869   acc: 67.91% -> 70.32%             
client [34] (test)  loss: 1.6038 -> 1.3188   acc: 49.84% -> 50.49%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4228 -> 1.2988   acc: 54.42% -> 57.83%             
client [99] (test)  loss: 2.2231 -> 1.9471   acc: 49.19% -> 62.90%             
client [67] (test)  loss: 1.5182 -> 1.0827   acc: 43.99% -> 67.41%             
client [0] (test)  loss: 0.9685 -> 0.8860   acc: 75.60% -> 75.60%              
client [76] (test)  loss: 1.4060 -> 1.2095   acc: 51.38% -> 55.52%             
client [41] (test)  loss: 1.3847 -> 1.2974   acc: 52.83% -> 53.54%             
client [62] (test)  loss: 2.3798 -> 0.8438   acc: 0.55% -> 70.88%              
client [2] (test)  loss: 2.4088 -> 2.1706   acc: 11.73% -> 26.53%              
client [14] (test)  loss: 1.4583 -> 1.3168   acc: 46.51% -> 57.36%             
client [46] (test)  loss: 1.5749 -> 1.4899   acc: 45.51% -> 46.71%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.5312 -> 1.4352   acc: 49.11% -> 50.45%             
client [68] (test)  loss: 0.9492 -> 0.8822   acc: 69.26% -> 71.20%             
client [57] (test)  loss: 0.9452 -> 0.7449   acc: 70.16% -> 75.81%             
client [17] (test)  loss: 1.0212 -> 0.9418   acc: 63.57% -> 68.03%             
client [54] (test)  loss: 0.6966 -> 0.6664   acc: 80.00% -> 80.63%             
client [23] (test)  loss: 2.4489 -> 1.3178   acc: 0.00% -> 59.60%              
client [35] (test)  loss: 1.0981 -> 1.0271   acc: 61.93% -> 64.91%             
client [59] (test)  loss: 0.7376 -> 0.6273   acc: 73.27% -> 81.85%             
client [31] (test)  loss: 0.8400 -> 0.7764   acc: 73.56% -> 79.66%             
client [9] (test)  loss: 1.1775 -> 1.0091   acc: 60.83% -> 71.39%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.4107 -> 1.2718   acc: 41.86% -> 46.90%             
client [33] (test)  loss: 1.0420 -> 1.0085   acc: 64.55% -> 69.84%             
client [16] (test)  loss: 1.5696 -> 1.4595   acc: 51.56% -> 55.86%             
client [44] (test)  loss: 0.6059 -> 0.5106   acc: 83.02% -> 83.02%             
client [8] (test)  loss: 0.4857 -> 0.4494   acc: 86.20% -> 87.24%              
client [31] (test)  loss: 0.7205 -> 0.6695   acc: 80.34% -> 81.36%             
client [47] (test)  loss: 0.8282 -> 0.7392   acc: 70.86% -> 75.50%             
client [36] (test)  loss: 1.7002 -> 1.4123   acc: 43.61% -> 46.42%             
client [20] (test)  loss: 1.2231 -> 1.1681   acc: 61.16% -> 61.16%             
client [56] (test)  loss: 1.0545 -> 0.8671   acc: 63.93% -> 75.07%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.4254 -> 1.3197   acc: 56.97% -> 59.43%              
client [60] (test)  loss: 1.1759 -> 1.1222   acc: 55.42% -> 59.17%             
client [28] (test)  loss: 1.2501 -> 1.1551   acc: 64.05% -> 66.67%             
client [25] (test)  loss: 1.5161 -> 1.4403   acc: 54.67% -> 57.01%             
client [58] (test)  loss: 0.8350 -> 0.7523   acc: 72.22% -> 79.01%             
client [44] (test)  loss: 0.5106 -> 0.4631   acc: 83.02% -> 83.02%             
client [39] (test)  loss: 1.4966 -> 1.3962   acc: 47.03% -> 55.08%             
client [29] (test)  loss: 0.5547 -> 0.5302   acc: 77.56% -> 77.89%             
client [3] (test)  loss: 1.2103 -> 1.0789   acc: 60.52% -> 68.61%              
client [84] (test)  loss: 1.1688 -> 1.1382   acc: 59.61% -> 59.28%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.7240 -> 1.6120   acc: 45.76% -> 47.80%             
client [84] (test)  loss: 1.1146 -> 1.0987   acc: 58.96% -> 61.24%             
client [10] (test)  loss: 0.2956 -> 0.2737   acc: 88.96% -> 89.40%             
client [36] (test)  loss: 0.9260 -> 0.7916   acc: 66.98% -> 72.59%             
client [65] (test)  loss: 1.1396 -> 1.0645   acc: 59.76% -> 61.79%             
client [81] (test)  loss: 0.2692 -> 0.2697   acc: 92.29% -> 92.73%             
client [79] (test)  loss: 0.9991 -> 0.9134   acc: 60.00% -> 60.77%             
client [42] (test)  loss: 0.5179 -> 0.5107   acc: 84.40% -> 84.17%             
client [11] (test)  loss: 0.8674 -> 0.7784   acc: 71.00% -> 76.19%             
client [96] (test)  loss: 0.5085 -> 0.4988   acc: 87.60% -> 86.63%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4073 -> 0.3985   acc: 88.54% -> 89.32%              
client [53] (test)  loss: 0.9873 -> 0.8908   acc: 64.83% -> 70.64%             
client [52] (test)  loss: 0.8157 -> 0.7524   acc: 72.13% -> 76.07%             
client [42] (test)  loss: 0.5093 -> 0.5174   acc: 84.63% -> 84.40%             
client [69] (test)  loss: 0.8147 -> 0.8107   acc: 73.50% -> 73.79%             
client [59] (test)  loss: 0.4626 -> 0.4378   acc: 84.16% -> 84.16%             
client [7] (test)  loss: 0.5217 -> 0.5054   acc: 89.18% -> 89.18%              
client [26] (test)  loss: 0.4863 -> 0.4556   acc: 83.69% -> 85.20%             
client [49] (test)  loss: 1.4006 -> 1.3566   acc: 43.83% -> 46.81%             
client [98] (test)  loss: 1.0098 -> 0.9800   acc: 63.74% -> 65.79%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9800 -> 0.9501   acc: 65.79% -> 66.37%             
client [47] (test)  loss: 0.6613 -> 0.5902   acc: 77.81% -> 78.81%             
client [21] (test)  loss: 1.5023 -> 1.4116   acc: 49.49% -> 50.17%             
client [77] (test)  loss: 0.7203 -> 0.6926   acc: 75.36% -> 75.85%             
client [95] (test)  loss: 0.5215 -> 0.5053   acc: 84.56% -> 84.93%             
client [91] (test)  loss: 0.8812 -> 0.8300   acc: 68.72% -> 69.60%             
client [14] (test)  loss: 0.9624 -> 0.9127   acc: 71.32% -> 71.32%             
client [99] (test)  loss: 1.1440 -> 1.0629   acc: 67.74% -> 72.58%             
client [20] (test)  loss: 1.0673 -> 1.0533   acc: 63.64% -> 63.64%             
client [39] (test)  loss: 1.2012 -> 1.1277   acc: 61.44% -> 61.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7524 -> 0.7090   acc: 76.07% -> 77.70%             
client [62] (test)  loss: 0.3658 -> 0.3585   acc: 88.74% -> 88.74%             
client [71] (test)  loss: 0.7602 -> 0.7412   acc: 76.29% -> 76.29%             
client [97] (test)  loss: 0.5283 -> 0.5104   acc: 81.84% -> 82.08%             
client [30] (test)  loss: 0.6419 -> 0.6132   acc: 76.35% -> 77.03%             
client [88] (test)  loss: 0.8848 -> 0.8494   acc: 74.65% -> 77.42%             
client [60] (test)  loss: 0.9059 -> 0.8722   acc: 74.17% -> 77.50%             
client [82] (test)  loss: 1.2979 -> 1.2466   acc: 56.95% -> 57.28%             
client [91] (test)  loss: 0.7852 -> 0.7532   acc: 72.69% -> 74.01%             
client [57] (test)  loss: 0.5250 -> 0.4982   acc: 80.38% -> 81.18%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5274 -> 0.5301   acc: 84.07% -> 83.73%             
client [15] (test)  loss: 0.4295 -> 0.4095   acc: 86.50% -> 86.50%             
client [71] (test)  loss: 0.7412 -> 0.7248   acc: 76.29% -> 76.29%             
client [97] (test)  loss: 0.4857 -> 0.4799   acc: 84.43% -> 85.38%             
client [53] (test)  loss: 0.7274 -> 0.7054   acc: 76.45% -> 77.33%             
client [77] (test)  loss: 0.6926 -> 0.6712   acc: 75.85% -> 75.85%             
client [76] (test)  loss: 0.7068 -> 0.6780   acc: 77.59% -> 78.28%             
client [79] (test)  loss: 0.7962 -> 0.7485   acc: 65.38% -> 67.69%             
client [28] (test)  loss: 0.8555 -> 0.8291   acc: 77.12% -> 79.08%             
client [99] (test)  loss: 1.0062 -> 0.9639   acc: 74.19% -> 75.00%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4756 -> 0.4734   acc: 85.61% -> 84.91%             
client [86] (test)  loss: 0.9820 -> 0.9520   acc: 68.56% -> 70.62%             
client [34] (test)  loss: 0.6090 -> 0.5974   acc: 82.95% -> 83.28%             
client [73] (test)  loss: 0.2071 -> 0.1953   acc: 94.72% -> 95.92%             
client [5] (test)  loss: 0.6137 -> 0.5948   acc: 83.64% -> 83.64%              
client [96] (test)  loss: 0.4676 -> 0.4791   acc: 88.73% -> 88.08%             
client [22] (test)  loss: 0.7512 -> 0.7214   acc: 77.41% -> 77.82%             
client [60] (test)  loss: 0.7459 -> 0.7081   acc: 79.17% -> 81.25%             
client [66] (test)  loss: 0.9360 -> 0.8892   acc: 74.73% -> 76.34%             
client [83] (test)  loss: 0.2393 -> 0.2300   acc: 93.84% -> 94.33%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6188 -> 0.6104   acc: 82.76% -> 82.76%             
client [65] (test)  loss: 0.9441 -> 0.8961   acc: 65.85% -> 69.11%             
client [95] (test)  loss: 0.4769 -> 0.4724   acc: 84.19% -> 83.09%             
client [17] (test)  loss: 0.7161 -> 0.6902   acc: 79.18% -> 79.18%             
client [8] (test)  loss: 0.3919 -> 0.3931   acc: 89.58% -> 89.06%              
client [35] (test)  loss: 1.0524 -> 1.0741   acc: 71.79% -> 71.33%             
client [98] (test)  loss: 0.9120 -> 0.8947   acc: 66.67% -> 69.88%             
client [53] (test)  loss: 0.6931 -> 0.6875   acc: 78.49% -> 78.20%             
client [43] (test)  loss: 0.3058 -> 0.3025   acc: 92.17% -> 92.42%             
client [64] (test)  loss: 0.8649 -> 0.8365   acc: 72.09% -> 72.87%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.3308 -> 1.2592   acc: 53.90% -> 57.63%             
client [88] (test)  loss: 0.7118 -> 0.6984   acc: 79.26% -> 79.72%             
client [38] (test)  loss: 0.7429 -> 0.7268   acc: 79.57% -> 80.11%             
client [3] (test)  loss: 0.5838 -> 0.5782   acc: 79.94% -> 79.94%              
client [5] (test)  loss: 0.5807 -> 0.5731   acc: 83.64% -> 83.27%              
client [41] (test)  loss: 1.0057 -> 1.0166   acc: 69.10% -> 69.10%             
client [7] (test)  loss: 0.4845 -> 0.4788   acc: 89.51% -> 89.51%              
client [37] (test)  loss: 0.7223 -> 0.7046   acc: 81.29% -> 81.65%             
client [45] (test)  loss: 0.7194 -> 0.6486   acc: 75.92% -> 78.26%             
client [47] (test)  loss: 0.4829 -> 0.4449   acc: 83.11% -> 84.44%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9295 -> 0.9080   acc: 68.75% -> 70.70%             
client [11] (test)  loss: 0.6565 -> 0.6605   acc: 79.87% -> 80.52%             
client [37] (test)  loss: 0.6801 -> 0.6715   acc: 82.01% -> 82.01%             
client [41] (test)  loss: 1.0166 -> 1.0352   acc: 69.10% -> 69.10%             
client [95] (test)  loss: 0.4623 -> 0.4604   acc: 84.19% -> 84.19%             
client [53] (test)  loss: 0.6875 -> 0.6848   acc: 78.20% -> 78.20%             
client [22] (test)  loss: 0.7004 -> 0.6845   acc: 78.66% -> 79.50%             
client [25] (test)  loss: 1.0611 -> 1.0297   acc: 65.89% -> 66.36%             
client [69] (test)  loss: 0.8741 -> 0.8845   acc: 74.64% -> 74.93%             
client [46] (test)  loss: 1.1930 -> 1.1280   acc: 55.09% -> 58.08%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3522 -> 0.3381   acc: 88.74% -> 88.74%             
client [69] (test)  loss: 0.8989 -> 0.9155   acc: 74.64% -> 74.93%             
client [82] (test)  loss: 1.2206 -> 1.2374   acc: 58.94% -> 60.60%             
client [45] (test)  loss: 0.5685 -> 0.5515   acc: 78.93% -> 79.60%             
client [7] (test)  loss: 0.4788 -> 0.4763   acc: 89.51% -> 89.51%              
client [50] (test)  loss: 0.7755 -> 0.7554   acc: 77.32% -> 77.53%             
client [35] (test)  loss: 1.1182 -> 1.1379   acc: 71.79% -> 72.02%             
client [24] (test)  loss: 0.8970 -> 0.8714   acc: 70.54% -> 70.98%             
client [15] (test)  loss: 0.3835 -> 0.3828   acc: 87.83% -> 88.05%             
client [58] (test)  loss: 0.4943 -> 0.4946   acc: 83.95% -> 83.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5881 -> 0.5935   acc: 89.57% -> 89.57%             
client [76] (test)  loss: 0.6013 -> 0.6004   acc: 82.76% -> 83.10%             
client [67] (test)  loss: 0.4608 -> 0.4570   acc: 86.39% -> 86.08%             
client [37] (test)  loss: 0.6652 -> 0.6597   acc: 82.73% -> 83.09%             
client [58] (test)  loss: 0.4954 -> 0.4986   acc: 83.64% -> 83.64%             
client [64] (test)  loss: 0.7927 -> 0.7858   acc: 73.64% -> 74.03%             
client [77] (test)  loss: 0.6131 -> 0.6042   acc: 79.71% -> 79.23%             
client [55] (test)  loss: 0.2395 -> 0.2374   acc: 93.47% -> 93.47%             
client [12] (test)  loss: 0.7751 -> 0.7840   acc: 75.85% -> 76.19%             
client [89] (test)  loss: 1.0644 -> 1.0713   acc: 71.16% -> 71.54%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.3916 -> 1.4136   acc: 67.10% -> 67.43%             
client [51] (test)  loss: 0.8858 -> 0.8862   acc: 74.07% -> 74.69%             
client [8] (test)  loss: 0.4108 -> 0.4151   acc: 89.06% -> 89.06%              
client [18] (test)  loss: 0.7572 -> 0.7515   acc: 76.06% -> 76.36%             
client [94] (test)  loss: 0.9780 -> 0.9554   acc: 67.65% -> 67.65%             
client [81] (test)  loss: 0.3410 -> 0.3466   acc: 94.27% -> 94.49%             
client [3] (test)  loss: 0.5759 -> 0.5780   acc: 82.52% -> 82.85%              
client [11] (test)  loss: 0.6761 -> 0.6813   acc: 80.74% -> 80.52%             
client [95] (test)  loss: 0.4570 -> 0.4574   acc: 84.93% -> 84.93%             
client [67] (test)  loss: 0.4570 -> 0.4519   acc: 86.08% -> 86.08%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1607 -> 1.1391   acc: 62.71% -> 65.08%             
client [79] (test)  loss: 0.4833 -> 0.4730   acc: 83.85% -> 83.85%             
client [58] (test)  loss: 0.5125 -> 0.5159   acc: 83.33% -> 83.33%             
client [88] (test)  loss: 0.6683 -> 0.6614   acc: 79.72% -> 79.72%             
client [46] (test)  loss: 0.9880 -> 0.9367   acc: 62.28% -> 61.68%             
client [11] (test)  loss: 0.6813 -> 0.6880   acc: 80.52% -> 80.74%             
client [55] (test)  loss: 0.2287 -> 0.2276   acc: 93.47% -> 93.47%             
client [13] (test)  loss: 0.3271 -> 0.3261   acc: 92.95% -> 93.20%             
client [31] (test)  loss: 0.5460 -> 0.5499   acc: 83.73% -> 84.07%             
client [75] (test)  loss: 0.1662 -> 0.1653   acc: 94.15% -> 94.15%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.9153 -> 0.9241   acc: 77.73% -> 77.73%             
client [7] (test)  loss: 0.4729 -> 0.4733   acc: 89.18% -> 89.18%              
client [57] (test)  loss: 0.3880 -> 0.3796   acc: 88.71% -> 88.71%             
client [13] (test)  loss: 0.3265 -> 0.3277   acc: 93.45% -> 93.45%             
client [43] (test)  loss: 0.2990 -> 0.3005   acc: 92.93% -> 92.93%             
client [91] (test)  loss: 0.7020 -> 0.7033   acc: 75.33% -> 75.33%             
client [10] (test)  loss: 0.1787 -> 0.1772   acc: 93.16% -> 93.16%             
client [64] (test)  loss: 0.7988 -> 0.8045   acc: 73.26% -> 74.42%             
client [82] (test)  loss: 1.4040 -> 1.4120   acc: 61.92% -> 62.58%             
client [22] (test)  loss: 0.6654 -> 0.6655   acc: 80.33% -> 79.50%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9962 -> 0.9947   acc: 68.60% -> 69.42%             
client [23] (test)  loss: 0.6699 -> 0.6785   acc: 84.34% -> 84.34%             
client [88] (test)  loss: 0.6614 -> 0.6550   acc: 79.72% -> 79.72%             
client [98] (test)  loss: 0.9210 -> 0.9310   acc: 71.64% -> 72.22%             
client [79] (test)  loss: 0.4562 -> 0.4489   acc: 84.62% -> 84.62%             
client [21] (test)  loss: 1.1365 -> 1.1358   acc: 64.41% -> 65.76%             
client [92] (test)  loss: 1.0189 -> 1.0189   acc: 69.71% -> 69.14%             
client [56] (test)  loss: 0.3957 -> 0.3976   acc: 89.12% -> 89.12%             
client [5] (test)  loss: 0.5721 -> 0.5765   acc: 83.27% -> 82.90%              
client [52] (test)  loss: 0.7228 -> 0.7310   acc: 78.69% -> 79.02%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.7234 -> 0.0000', 'accuracy': '77.05% -> 0.00%'},          
    200: {'loss': '0.6585 -> 0.0000', 'accuracy': '81.09% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(13.73%) at epoch: 0                                
Local-only-1 achieved 20.0%(21.83%) at epoch: 1                                
Local-only-1 achieved 30.0%(33.76%) at epoch: 3                                
Local-only-1 achieved 40.0%(44.39%) at epoch: 4                                
Local-only-1 achieved 50.0%(52.41%) at epoch: 7                                
Local-only-1 achieved 60.0%(63.77%) at epoch: 20                               
Local-only-1 achieved 70.0%(71.50%) at epoch: 28                               
Local-only-1 achieved 80.0%(80.04%) at epoch: 82                               
Convergence (test_after):                                                      
Local-only-1 achieved 50.0%(59.82%) at epoch: 0                                
Local-only-1 achieved 60.0%(64.67%) at epoch: 3                                
Local-only-1 achieved 70.0%(72.13%) at epoch: 20                               
Local-only-1 achieved 80.0%(80.94%) at epoch: 76                               
