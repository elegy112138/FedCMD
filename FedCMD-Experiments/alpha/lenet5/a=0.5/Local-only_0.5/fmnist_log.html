==================== ALGORITHM: Local-only-1 ====================              
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7367 -> 0.6195   acc: 75.57% -> 82.87%             
client [81] (test)  loss: 1.7484 -> 1.4316   acc: 44.03% -> 55.22%             
client [21] (test)  loss: 16.8913 -> 1.3707   acc: 6.97% -> 60.30%             
client [68] (test)  loss: 1.0069 -> 0.8678   acc: 71.95% -> 71.95%             
client [93] (test)  loss: 1.3328 -> 0.8703   acc: 37.21% -> 64.86%             
client [31] (test)  loss: 1.8297 -> 1.4019   acc: 33.80% -> 64.80%             
client [20] (test)  loss: 0.7160 -> 0.5287   acc: 81.53% -> 83.11%             
client [59] (test)  loss: 14.2428 -> 1.5798   acc: 13.54% -> 31.88%            
client [48] (test)  loss: 1.4549 -> 1.2597   acc: 41.79% -> 51.07%             
client [34] (test)  loss: 1.4952 -> 1.0794   acc: 52.42% -> 71.25%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6545 -> 1.2458   acc: 51.19% -> 67.56%             
client [99] (test)  loss: 1.4726 -> 1.1530   acc: 42.59% -> 61.11%             
client [67] (test)  loss: 0.9540 -> 0.7915   acc: 61.57% -> 72.23%             
client [0] (test)  loss: 1.0592 -> 0.8590   acc: 63.40% -> 68.41%              
client [76] (test)  loss: 0.7149 -> 0.6175   acc: 75.87% -> 76.78%             
client [41] (test)  loss: 1.0985 -> 0.6712   acc: 68.89% -> 78.06%             
client [62] (test)  loss: 13.2148 -> 1.6452   acc: 9.06% -> 56.45%             
client [2] (test)  loss: 21.5256 -> 1.6549   acc: 4.10% -> 46.69%              
client [14] (test)  loss: 0.8953 -> 0.7364   acc: 68.39% -> 79.02%             
client [46] (test)  loss: 0.5206 -> 0.4607   acc: 75.73% -> 79.47%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1849 -> 1.0252   acc: 64.36% -> 67.02%             
client [68] (test)  loss: 0.7009 -> 0.6619   acc: 76.06% -> 77.68%             
client [57] (test)  loss: 0.3926 -> 0.2392   acc: 93.06% -> 94.17%             
client [17] (test)  loss: 0.7375 -> 0.6298   acc: 77.81% -> 81.16%             
client [54] (test)  loss: 0.6743 -> 0.6455   acc: 74.53% -> 75.07%             
client [23] (test)  loss: 23.8650 -> 1.6864   acc: 1.25% -> 48.75%             
client [35] (test)  loss: 0.5909 -> 0.5010   acc: 79.59% -> 83.98%             
client [59] (test)  loss: 0.8501 -> 0.7198   acc: 77.73% -> 78.17%             
client [31] (test)  loss: 0.7257 -> 0.6802   acc: 76.82% -> 77.65%             
client [9] (test)  loss: 0.4927 -> 0.4372   acc: 86.82% -> 88.64%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6041 -> 0.5489   acc: 84.29% -> 85.71%             
client [33] (test)  loss: 0.2453 -> 0.2363   acc: 93.18% -> 92.93%             
client [16] (test)  loss: 0.6445 -> 0.5474   acc: 83.18% -> 83.78%             
client [44] (test)  loss: 1.0620 -> 0.6479   acc: 63.40% -> 80.67%             
client [8] (test)  loss: 0.7599 -> 0.7139   acc: 75.11% -> 78.17%              
client [31] (test)  loss: 0.6493 -> 0.6262   acc: 78.21% -> 78.77%             
client [47] (test)  loss: 0.4525 -> 0.4035   acc: 85.49% -> 88.57%             
client [36] (test)  loss: 0.8320 -> 0.5396   acc: 69.04% -> 83.65%             
client [20] (test)  loss: 0.2757 -> 0.2643   acc: 88.92% -> 89.45%             
client [56] (test)  loss: 1.4011 -> 1.1281   acc: 63.30% -> 64.29%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.0102 -> 0.9531   acc: 62.11% -> 62.50%              
client [60] (test)  loss: 0.7110 -> 0.6241   acc: 80.61% -> 80.91%             
client [28] (test)  loss: 0.3347 -> 0.2946   acc: 87.32% -> 89.86%             
client [25] (test)  loss: 0.5363 -> 0.4835   acc: 81.60% -> 83.06%             
client [58] (test)  loss: 0.7469 -> 0.7324   acc: 71.98% -> 71.70%             
client [44] (test)  loss: 0.6479 -> 0.4416   acc: 80.67% -> 81.44%             
client [39] (test)  loss: 1.0985 -> 0.9294   acc: 68.09% -> 74.77%             
client [29] (test)  loss: 0.7755 -> 0.7234   acc: 74.54% -> 75.07%             
client [3] (test)  loss: 0.6383 -> 0.5733   acc: 77.16% -> 80.20%              
client [84] (test)  loss: 0.4280 -> 0.4108   acc: 87.26% -> 88.21%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8250 -> 0.7255   acc: 75.15% -> 76.97%             
client [84] (test)  loss: 0.3993 -> 0.3921   acc: 88.97% -> 89.16%             
client [10] (test)  loss: 0.6531 -> 0.6103   acc: 80.06% -> 81.65%             
client [36] (test)  loss: 0.3505 -> 0.3133   acc: 91.73% -> 91.54%             
client [65] (test)  loss: 0.6542 -> 0.5984   acc: 78.57% -> 80.52%             
client [81] (test)  loss: 0.7413 -> 0.6612   acc: 82.09% -> 81.34%             
client [79] (test)  loss: 0.9338 -> 0.8948   acc: 65.71% -> 68.01%             
client [42] (test)  loss: 0.5365 -> 0.5094   acc: 82.37% -> 83.09%             
client [11] (test)  loss: 0.2462 -> 0.2184   acc: 93.00% -> 93.45%             
client [96] (test)  loss: 1.0469 -> 0.9619   acc: 62.70% -> 66.93%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6498 -> 0.6302   acc: 82.53% -> 84.28%              
client [53] (test)  loss: 1.0453 -> 0.9366   acc: 68.11% -> 69.10%             
client [52] (test)  loss: 0.5869 -> 0.5451   acc: 82.75% -> 82.75%             
client [42] (test)  loss: 0.4887 -> 0.4754   acc: 83.09% -> 84.06%             
client [69] (test)  loss: 0.5842 -> 0.5760   acc: 81.55% -> 81.55%             
client [59] (test)  loss: 0.5437 -> 0.5091   acc: 83.84% -> 86.46%             
client [7] (test)  loss: 0.4042 -> 0.3871   acc: 85.87% -> 87.17%              
client [26] (test)  loss: 0.6250 -> 0.6059   acc: 84.70% -> 84.70%             
client [49] (test)  loss: 1.1092 -> 1.0083   acc: 60.24% -> 64.83%             
client [98] (test)  loss: 0.2450 -> 0.2297   acc: 89.47% -> 90.53%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2297 -> 0.2179   acc: 90.53% -> 91.32%             
client [47] (test)  loss: 0.3752 -> 0.3567   acc: 87.91% -> 88.79%             
client [21] (test)  loss: 0.6650 -> 0.6249   acc: 78.79% -> 79.39%             
client [77] (test)  loss: 0.4317 -> 0.4252   acc: 87.41% -> 87.41%             
client [95] (test)  loss: 0.5204 -> 0.5055   acc: 86.05% -> 86.43%             
client [91] (test)  loss: 0.4290 -> 0.4023   acc: 84.48% -> 85.75%             
client [14] (test)  loss: 0.5077 -> 0.4987   acc: 84.74% -> 84.20%             
client [99] (test)  loss: 0.6871 -> 0.6226   acc: 82.96% -> 83.33%             
client [20] (test)  loss: 0.2441 -> 0.2419   acc: 91.29% -> 91.56%             
client [39] (test)  loss: 0.7057 -> 0.6328   acc: 79.94% -> 82.07%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5451 -> 0.5225   acc: 82.75% -> 82.75%             
client [62] (test)  loss: 0.4258 -> 0.4102   acc: 86.41% -> 86.41%             
client [71] (test)  loss: 1.0994 -> 1.0613   acc: 71.60% -> 71.60%             
client [97] (test)  loss: 0.8090 -> 0.7559   acc: 71.21% -> 72.76%             
client [30] (test)  loss: 0.8219 -> 0.8002   acc: 73.83% -> 73.83%             
client [88] (test)  loss: 0.7520 -> 0.7025   acc: 77.78% -> 80.00%             
client [60] (test)  loss: 0.4265 -> 0.4035   acc: 86.67% -> 88.18%             
client [82] (test)  loss: 0.7136 -> 0.7041   acc: 72.65% -> 74.59%             
client [91] (test)  loss: 0.3797 -> 0.3630   acc: 88.30% -> 89.57%             
client [57] (test)  loss: 0.1312 -> 0.1168   acc: 95.28% -> 96.67%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6320 -> 0.6455   acc: 80.45% -> 81.01%             
client [15] (test)  loss: 0.6261 -> 0.6081   acc: 78.60% -> 78.25%             
client [71] (test)  loss: 1.0613 -> 1.0317   acc: 71.60% -> 71.60%             
client [97] (test)  loss: 0.6929 -> 0.6708   acc: 72.76% -> 73.93%             
client [53] (test)  loss: 0.7673 -> 0.7262   acc: 71.43% -> 75.08%             
client [77] (test)  loss: 0.4252 -> 0.4243   acc: 87.41% -> 87.15%             
client [76] (test)  loss: 0.4621 -> 0.4631   acc: 83.55% -> 84.28%             
client [79] (test)  loss: 0.8404 -> 0.8218   acc: 68.01% -> 68.88%             
client [28] (test)  loss: 0.2122 -> 0.2092   acc: 93.24% -> 93.24%             
client [99] (test)  loss: 0.5740 -> 0.5386   acc: 84.07% -> 84.44%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6557 -> 0.6432   acc: 75.49% -> 75.88%             
client [86] (test)  loss: 0.4348 -> 0.4283   acc: 85.14% -> 85.71%             
client [34] (test)  loss: 0.4498 -> 0.4464   acc: 83.21% -> 83.21%             
client [73] (test)  loss: 0.4585 -> 0.4540   acc: 85.35% -> 85.53%             
client [5] (test)  loss: 0.2485 -> 0.2461   acc: 91.47% -> 92.40%              
client [96] (test)  loss: 0.6953 -> 0.6899   acc: 75.66% -> 74.60%             
client [22] (test)  loss: 0.6211 -> 0.6068   acc: 80.54% -> 80.54%             
client [60] (test)  loss: 0.3621 -> 0.3548   acc: 90.00% -> 90.30%             
client [66] (test)  loss: 0.3190 -> 0.3091   acc: 92.43% -> 92.43%             
client [83] (test)  loss: 0.5074 -> 0.4959   acc: 80.09% -> 80.09%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4906 -> 0.5023   acc: 83.73% -> 83.91%             
client [65] (test)  loss: 0.5368 -> 0.5211   acc: 82.79% -> 82.79%             
client [95] (test)  loss: 0.4809 -> 0.4772   acc: 85.27% -> 84.11%             
client [17] (test)  loss: 0.4548 -> 0.4389   acc: 85.41% -> 86.02%             
client [8] (test)  loss: 0.6064 -> 0.6046   acc: 86.03% -> 86.46%              
client [35] (test)  loss: 0.2802 -> 0.2768   acc: 90.96% -> 90.70%             
client [98] (test)  loss: 0.2020 -> 0.1967   acc: 91.05% -> 91.05%             
client [53] (test)  loss: 0.6902 -> 0.6630   acc: 78.07% -> 78.07%             
client [43] (test)  loss: 0.3461 -> 0.3494   acc: 87.44% -> 87.19%             
client [64] (test)  loss: 0.4140 -> 0.4000   acc: 88.00% -> 88.29%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5930 -> 0.5681   acc: 81.52% -> 82.12%             
client [88] (test)  loss: 0.5757 -> 0.5694   acc: 81.27% -> 81.59%             
client [38] (test)  loss: 0.5019 -> 0.5033   acc: 83.15% -> 83.43%             
client [3] (test)  loss: 0.3727 -> 0.3723   acc: 87.31% -> 87.06%              
client [5] (test)  loss: 0.2446 -> 0.2426   acc: 92.40% -> 92.40%              
client [41] (test)  loss: 0.1926 -> 0.1876   acc: 93.89% -> 93.89%             
client [7] (test)  loss: 0.3734 -> 0.3691   acc: 87.61% -> 88.26%              
client [37] (test)  loss: 0.3606 -> 0.3473   acc: 89.06% -> 89.06%             
client [45] (test)  loss: 0.4619 -> 0.4354   acc: 84.31% -> 85.11%             
client [47] (test)  loss: 0.3400 -> 0.3344   acc: 89.67% -> 89.89%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3591 -> 0.3573   acc: 91.29% -> 91.29%             
client [11] (test)  loss: 0.1673 -> 0.1663   acc: 94.81% -> 94.81%             
client [37] (test)  loss: 0.3325 -> 0.3279   acc: 88.54% -> 88.54%             
client [41] (test)  loss: 0.1876 -> 0.1840   acc: 93.89% -> 93.89%             
client [95] (test)  loss: 0.4764 -> 0.4783   acc: 84.88% -> 84.11%             
client [53] (test)  loss: 0.6630 -> 0.6458   acc: 78.07% -> 78.41%             
client [22] (test)  loss: 0.5958 -> 0.5870   acc: 80.87% -> 81.88%             
client [25] (test)  loss: 0.3560 -> 0.3495   acc: 88.27% -> 88.60%             
client [69] (test)  loss: 0.5748 -> 0.5773   acc: 83.63% -> 83.93%             
client [46] (test)  loss: 0.2939 -> 0.2888   acc: 90.13% -> 89.87%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3427 -> 0.3480   acc: 89.45% -> 89.45%             
client [69] (test)  loss: 0.5816 -> 0.5888   acc: 83.93% -> 84.52%             
client [82] (test)  loss: 0.6759 -> 0.6785   acc: 77.07% -> 78.45%             
client [45] (test)  loss: 0.4091 -> 0.4046   acc: 87.23% -> 87.50%             
client [7] (test)  loss: 0.3691 -> 0.3698   acc: 88.26% -> 89.13%              
client [50] (test)  loss: 0.4932 -> 0.4677   acc: 86.27% -> 87.39%             
client [35] (test)  loss: 0.2732 -> 0.2717   acc: 90.70% -> 90.96%             
client [24] (test)  loss: 0.7003 -> 0.7171   acc: 76.06% -> 75.80%             
client [15] (test)  loss: 0.5734 -> 0.5721   acc: 80.35% -> 80.35%             
client [58] (test)  loss: 0.8918 -> 0.9054   acc: 74.73% -> 75.27%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6623 -> 0.6627   acc: 75.71% -> 76.43%             
client [76] (test)  loss: 0.5393 -> 0.5602   acc: 83.73% -> 83.36%             
client [67] (test)  loss: 0.3754 -> 0.3699   acc: 85.51% -> 86.12%             
client [37] (test)  loss: 0.3254 -> 0.3245   acc: 88.28% -> 87.76%             
client [58] (test)  loss: 0.9194 -> 0.9340   acc: 75.27% -> 75.27%             
client [64] (test)  loss: 0.3708 -> 0.3643   acc: 88.29% -> 88.29%             
client [77] (test)  loss: 0.4471 -> 0.4549   acc: 87.91% -> 87.91%             
client [55] (test)  loss: 0.2808 -> 0.2805   acc: 92.29% -> 92.29%             
client [12] (test)  loss: 0.4239 -> 0.4268   acc: 85.91% -> 85.91%             
client [89] (test)  loss: 0.3556 -> 0.3573   acc: 88.40% -> 88.71%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5348 -> 0.5461   acc: 88.02% -> 88.21%             
client [51] (test)  loss: 0.2023 -> 0.2025   acc: 96.77% -> 96.77%             
client [8] (test)  loss: 0.6233 -> 0.6286   acc: 87.34% -> 87.34%              
client [18] (test)  loss: 0.4471 -> 0.4448   acc: 88.36% -> 88.01%             
client [94] (test)  loss: 0.4530 -> 0.4560   acc: 87.85% -> 87.85%             
client [81] (test)  loss: 0.3783 -> 0.3746   acc: 87.31% -> 86.57%             
client [3] (test)  loss: 0.3757 -> 0.3764   acc: 87.82% -> 88.07%              
client [11] (test)  loss: 0.1667 -> 0.1676   acc: 95.26% -> 95.26%             
client [95] (test)  loss: 0.5074 -> 0.5147   acc: 85.27% -> 84.88%             
client [67] (test)  loss: 0.3699 -> 0.3650   acc: 86.12% -> 86.32%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5268 -> 0.5124   acc: 84.24% -> 83.94%             
client [79] (test)  loss: 0.8733 -> 0.8938   acc: 74.06% -> 74.35%             
client [58] (test)  loss: 0.9748 -> 0.9874   acc: 75.00% -> 74.73%             
client [88] (test)  loss: 0.5676 -> 0.5700   acc: 81.90% -> 82.22%             
client [46] (test)  loss: 0.2862 -> 0.2867   acc: 90.40% -> 90.40%             
client [11] (test)  loss: 0.1676 -> 0.1684   acc: 95.26% -> 95.26%             
client [55] (test)  loss: 0.2923 -> 0.2974   acc: 91.36% -> 91.59%             
client [13] (test)  loss: 0.5075 -> 0.5117   acc: 86.08% -> 85.82%             
client [31] (test)  loss: 0.6841 -> 0.6977   acc: 80.45% -> 80.45%             
client [75] (test)  loss: 0.1996 -> 0.1994   acc: 93.75% -> 94.02%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2606 -> 0.2602   acc: 93.90% -> 94.37%             
client [7] (test)  loss: 0.3989 -> 0.4061   acc: 88.91% -> 89.13%              
client [57] (test)  loss: 0.0745 -> 0.0735   acc: 97.78% -> 97.78%             
client [13] (test)  loss: 0.5164 -> 0.5200   acc: 86.34% -> 86.08%             
client [43] (test)  loss: 0.3944 -> 0.4034   acc: 86.43% -> 86.68%             
client [91] (test)  loss: 0.3231 -> 0.3190   acc: 90.08% -> 90.08%             
client [10] (test)  loss: 0.4173 -> 0.4190   acc: 87.66% -> 87.34%             
client [64] (test)  loss: 0.3426 -> 0.3390   acc: 88.29% -> 88.29%             
client [82] (test)  loss: 0.7671 -> 0.7810   acc: 79.28% -> 79.01%             
client [22] (test)  loss: 0.5888 -> 0.5980   acc: 80.87% -> 81.21%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2426 -> 0.2450   acc: 92.08% -> 92.08%             
client [23] (test)  loss: 0.5773 -> 0.5528   acc: 81.88% -> 81.88%             
client [88] (test)  loss: 0.5700 -> 0.5739   acc: 82.22% -> 82.86%             
client [98] (test)  loss: 0.1898 -> 0.1903   acc: 92.11% -> 92.37%             
client [79] (test)  loss: 0.9369 -> 0.9572   acc: 74.35% -> 74.35%             
client [21] (test)  loss: 0.5018 -> 0.4940   acc: 85.15% -> 85.76%             
client [92] (test)  loss: 0.1243 -> 0.1229   acc: 95.95% -> 95.95%             
client [56] (test)  loss: 0.7663 -> 0.7863   acc: 78.57% -> 78.08%             
client [5] (test)  loss: 0.2476 -> 0.2490   acc: 93.55% -> 93.55%              
client [52] (test)  loss: 0.5389 -> 0.5465   acc: 85.67% -> 85.67%             
==================== Local-only-1 TEST RESULTS: ====================           
{                                                                              
    100: {'loss': '0.4706 -> 0.0000', 'accuracy': '84.51% -> 0.00%'},          
    200: {'loss': '0.4566 -> 0.0000', 'accuracy': '86.51% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Local-only-1 achieved 10.0%(15.02%) at epoch: 1                                
Local-only-1 achieved 20.0%(26.62%) at epoch: 3                                
Local-only-1 achieved 30.0%(37.80%) at epoch: 4                                
Local-only-1 achieved 40.0%(43.29%) at epoch: 7                                
Local-only-1 achieved 50.0%(50.45%) at epoch: 9                                
Local-only-1 achieved 60.0%(63.18%) at epoch: 16                               
Local-only-1 achieved 70.0%(71.53%) at epoch: 24                               
Local-only-1 achieved 80.0%(82.49%) at epoch: 41                               
Local-only-1 achieved 90.0%(90.20%) at epoch: 155                              
Convergence (test_after):                                                      
Local-only-1 achieved 50.0%(51.52%) at epoch: 0                                
Local-only-1 achieved 60.0%(60.86%) at epoch: 2                                
Local-only-1 achieved 70.0%(73.07%) at epoch: 13                               
Local-only-1 achieved 80.0%(82.83%) at epoch: 39                               
Local-only-1 achieved 90.0%(90.35%) at epoch: 155                              
