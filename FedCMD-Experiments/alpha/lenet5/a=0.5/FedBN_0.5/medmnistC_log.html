==================== ALGORITHM: FedBN_0.5 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0346 -> 1.1040   acc: 50.49% -> 54.37%             
client [81] (test)  loss: 1.9482 -> 1.7164   acc: 28.83% -> 35.14%             
client [21] (test)  loss: 2.2561 -> 1.0718   acc: 21.24% -> 70.35%             
client [68] (test)  loss: 2.2082 -> 1.8651   acc: 22.11% -> 27.37%             
client [93] (test)  loss: 1.9587 -> 1.3437   acc: 41.73% -> 59.84%             
client [31] (test)  loss: 2.0359 -> 0.9791   acc: 30.58% -> 72.73%             
client [20] (test)  loss: 1.0579 -> 0.3991   acc: 84.97% -> 87.58%             
client [59] (test)  loss: 2.1725 -> 1.1665   acc: 68.03% -> 66.39%             
client [48] (test)  loss: 1.2582 -> 0.7707   acc: 68.93% -> 73.79%             
client [34] (test)  loss: 2.1303 -> 1.7296   acc: 9.59% -> 30.14%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.7044 -> 1.3253   acc: 36.26% -> 46.15%             
client [99] (test)  loss: 1.9088 -> 1.3665   acc: 41.43% -> 65.71%             
client [67] (test)  loss: 1.8478 -> 0.8289   acc: 32.47% -> 72.08%             
client [0] (test)  loss: 1.6964 -> 0.3989   acc: 41.62% -> 89.02%              
client [76] (test)  loss: 1.7811 -> 0.7049   acc: 30.15% -> 77.94%             
client [41] (test)  loss: 1.8312 -> 0.8870   acc: 42.86% -> 75.51%             
client [62] (test)  loss: 2.2421 -> 0.7306   acc: 5.88% -> 83.82%              
client [2] (test)  loss: 2.1764 -> 1.0320   acc: 28.12% -> 79.17%              
client [14] (test)  loss: 1.1663 -> 0.7364   acc: 73.02% -> 79.37%             
client [46] (test)  loss: 0.8070 -> 0.4718   acc: 76.19% -> 85.71%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1552 -> 0.8340   acc: 58.82% -> 73.11%             
client [68] (test)  loss: 1.4348 -> 0.9555   acc: 42.11% -> 68.42%             
client [57] (test)  loss: 1.8516 -> 0.8365   acc: 17.29% -> 69.92%             
client [17] (test)  loss: 2.0220 -> 0.4520   acc: 22.52% -> 88.74%             
client [54] (test)  loss: 1.4034 -> 0.7922   acc: 50.36% -> 75.54%             
client [23] (test)  loss: 2.1328 -> 1.4076   acc: 9.45% -> 55.12%              
client [35] (test)  loss: 1.3231 -> 1.1443   acc: 55.79% -> 52.63%             
client [59] (test)  loss: 0.7454 -> 0.4920   acc: 76.23% -> 81.97%             
client [31] (test)  loss: 1.0415 -> 0.5002   acc: 67.77% -> 80.17%             
client [9] (test)  loss: 1.2908 -> 1.1038   acc: 63.83% -> 55.32%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.4131 -> 0.4656   acc: 45.27% -> 86.49%             
client [33] (test)  loss: 1.1061 -> 0.7304   acc: 65.25% -> 73.05%             
client [16] (test)  loss: 0.9839 -> 0.5429   acc: 64.24% -> 80.13%             
client [44] (test)  loss: 3.7451 -> 0.0163   acc: 2.27% -> 100.00%             
client [8] (test)  loss: 0.5987 -> 0.3106   acc: 79.03% -> 92.74%              
client [31] (test)  loss: 0.6802 -> 0.4283   acc: 75.21% -> 82.64%             
client [47] (test)  loss: 0.9788 -> 0.7174   acc: 65.15% -> 78.79%             
client [36] (test)  loss: 1.2255 -> 0.6599   acc: 65.28% -> 83.33%             
client [20] (test)  loss: 0.7417 -> 0.1981   acc: 82.35% -> 94.77%             
client [56] (test)  loss: 1.2121 -> 0.5388   acc: 59.26% -> 80.00%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5827 -> 0.2266   acc: 84.57% -> 94.68%              
client [60] (test)  loss: 1.0565 -> 0.8667   acc: 61.18% -> 71.76%             
client [28] (test)  loss: 1.6610 -> 0.6582   acc: 47.17% -> 77.36%             
client [25] (test)  loss: 1.4614 -> 0.5666   acc: 48.74% -> 78.99%             
client [58] (test)  loss: 1.4279 -> 0.8897   acc: 41.35% -> 69.17%             
client [44] (test)  loss: 2.5234 -> 0.0112   acc: 35.61% -> 100.00%            
client [39] (test)  loss: 0.7274 -> 0.4534   acc: 81.77% -> 82.76%             
client [29] (test)  loss: 1.3212 -> 0.3391   acc: 50.85% -> 91.53%             
client [3] (test)  loss: 0.5431 -> 0.3381   acc: 86.17% -> 90.91%              
client [84] (test)  loss: 1.2606 -> 0.6505   acc: 47.06% -> 80.67%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.7951 -> 0.3551   acc: 38.94% -> 90.27%             
client [84] (test)  loss: 1.0887 -> 0.6637   acc: 54.62% -> 80.67%             
client [10] (test)  loss: 1.3237 -> 0.4421   acc: 48.12% -> 83.46%             
client [36] (test)  loss: 0.9828 -> 0.5303   acc: 59.72% -> 83.33%             
client [65] (test)  loss: 0.9352 -> 0.5445   acc: 67.21% -> 78.69%             
client [81] (test)  loss: 0.8083 -> 0.5063   acc: 69.37% -> 87.39%             
client [79] (test)  loss: 0.6581 -> 0.2909   acc: 76.76% -> 93.66%             
client [42] (test)  loss: 0.9311 -> 0.7985   acc: 74.60% -> 73.81%             
client [11] (test)  loss: 1.1768 -> 0.8684   acc: 51.43% -> 74.29%             
client [96] (test)  loss: 0.4667 -> 0.0510   acc: 84.76% -> 98.78%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3372 -> 0.1935   acc: 90.32% -> 93.55%              
client [53] (test)  loss: 0.8718 -> 0.3709   acc: 68.61% -> 86.86%             
client [52] (test)  loss: 0.7216 -> 0.4281   acc: 80.75% -> 84.47%             
client [42] (test)  loss: 0.9967 -> 0.7271   acc: 71.43% -> 76.98%             
client [69] (test)  loss: 0.9112 -> 0.6925   acc: 69.23% -> 76.92%             
client [59] (test)  loss: 0.3025 -> 0.2095   acc: 90.98% -> 93.44%             
client [7] (test)  loss: 0.6271 -> 0.5113   acc: 81.74% -> 82.61%              
client [26] (test)  loss: 0.6843 -> 0.3389   acc: 75.21% -> 85.95%             
client [49] (test)  loss: 0.4764 -> 0.2679   acc: 81.48% -> 91.11%             
client [98] (test)  loss: 1.5868 -> 0.4775   acc: 48.33% -> 80.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2197 -> 0.4627   acc: 61.67% -> 81.67%             
client [47] (test)  loss: 0.7411 -> 0.4478   acc: 72.73% -> 84.85%             
client [21] (test)  loss: 1.3223 -> 0.2790   acc: 56.19% -> 92.04%             
client [77] (test)  loss: 0.6026 -> 0.3120   acc: 79.61% -> 89.32%             
client [95] (test)  loss: 0.6561 -> 0.2190   acc: 81.63% -> 93.20%             
client [91] (test)  loss: 0.8632 -> 0.3085   acc: 69.77% -> 93.02%             
client [14] (test)  loss: 0.4949 -> 0.3562   acc: 88.10% -> 87.30%             
client [99] (test)  loss: 0.9188 -> 0.6489   acc: 70.00% -> 81.43%             
client [20] (test)  loss: 0.7635 -> 0.2050   acc: 81.05% -> 96.08%             
client [39] (test)  loss: 0.4309 -> 0.3641   acc: 85.22% -> 87.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6705 -> 0.3617   acc: 78.26% -> 86.34%             
client [62] (test)  loss: 0.6388 -> 0.3171   acc: 80.15% -> 90.44%             
client [71] (test)  loss: 1.0616 -> 0.5478   acc: 74.51% -> 81.37%             
client [97] (test)  loss: 0.7050 -> 0.4471   acc: 82.00% -> 86.00%             
client [30] (test)  loss: 0.4759 -> 0.3223   acc: 85.25% -> 90.16%             
client [88] (test)  loss: 1.3215 -> 0.5282   acc: 53.79% -> 81.82%             
client [60] (test)  loss: 0.7584 -> 0.7238   acc: 76.47% -> 80.00%             
client [82] (test)  loss: 0.9184 -> 0.3817   acc: 64.89% -> 85.50%             
client [91] (test)  loss: 0.9222 -> 0.2964   acc: 68.99% -> 95.35%             
client [57] (test)  loss: 1.0259 -> 0.4286   acc: 68.42% -> 82.71%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.3983 -> 0.2659   acc: 83.47% -> 93.39%             
client [15] (test)  loss: 0.9821 -> 0.6553   acc: 72.73% -> 84.85%             
client [71] (test)  loss: 0.9861 -> 0.5300   acc: 74.51% -> 82.35%             
client [97] (test)  loss: 0.5598 -> 0.4322   acc: 80.00% -> 84.00%             
client [53] (test)  loss: 0.5698 -> 0.3602   acc: 77.37% -> 86.86%             
client [77] (test)  loss: 0.9320 -> 0.2999   acc: 67.96% -> 94.17%             
client [76] (test)  loss: 0.3346 -> 0.2938   acc: 88.97% -> 90.44%             
client [79] (test)  loss: 0.6752 -> 0.2505   acc: 78.87% -> 92.25%             
client [28] (test)  loss: 0.6762 -> 0.7031   acc: 67.92% -> 79.25%             
client [99] (test)  loss: 1.1877 -> 0.5760   acc: 57.14% -> 84.29%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7832 -> 0.4418   acc: 72.00% -> 86.00%             
client [86] (test)  loss: 0.2965 -> 0.2281   acc: 90.91% -> 94.32%             
client [34] (test)  loss: 0.7259 -> 0.6031   acc: 78.08% -> 83.56%             
client [73] (test)  loss: 0.7898 -> 0.6755   acc: 71.93% -> 79.82%             
client [5] (test)  loss: 0.7905 -> 0.3815   acc: 75.29% -> 87.06%              
client [96] (test)  loss: 0.1085 -> 0.0323   acc: 96.95% -> 99.39%             
client [22] (test)  loss: 0.6125 -> 0.4227   acc: 76.15% -> 82.57%             
client [60] (test)  loss: 0.6526 -> 0.6873   acc: 76.47% -> 81.18%             
client [66] (test)  loss: 0.4145 -> 0.2356   acc: 89.29% -> 94.64%             
client [83] (test)  loss: 0.6758 -> 0.2013   acc: 75.70% -> 94.86%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4072 -> 0.2673   acc: 86.03% -> 91.18%             
client [65] (test)  loss: 0.7900 -> 0.4579   acc: 74.59% -> 84.43%             
client [95] (test)  loss: 0.5673 -> 0.2090   acc: 79.59% -> 94.56%             
client [17] (test)  loss: 1.0120 -> 0.2615   acc: 65.56% -> 92.05%             
client [8] (test)  loss: 0.4350 -> 0.1446   acc: 83.87% -> 95.16%              
client [35] (test)  loss: 0.5303 -> 0.6182   acc: 82.11% -> 76.84%             
client [98] (test)  loss: 2.1502 -> 0.3991   acc: 38.33% -> 83.33%             
client [53] (test)  loss: 0.5014 -> 0.3184   acc: 83.94% -> 90.51%             
client [43] (test)  loss: 1.4100 -> 0.3818   acc: 64.75% -> 89.34%             
client [64] (test)  loss: 0.3938 -> 0.2259   acc: 88.51% -> 91.22%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.5514 -> 0.1855   acc: 53.54% -> 94.69%             
client [88] (test)  loss: 1.0709 -> 0.4792   acc: 63.64% -> 83.33%             
client [38] (test)  loss: 0.5062 -> 0.2945   acc: 86.27% -> 92.16%             
client [3] (test)  loss: 0.2581 -> 0.2269   acc: 94.07% -> 93.68%              
client [5] (test)  loss: 0.6426 -> 0.3614   acc: 77.65% -> 87.06%              
client [41] (test)  loss: 1.1421 -> 0.2274   acc: 63.27% -> 91.16%             
client [7] (test)  loss: 0.5034 -> 0.4163   acc: 83.48% -> 86.96%              
client [37] (test)  loss: 1.0857 -> 0.3385   acc: 61.07% -> 89.26%             
client [45] (test)  loss: 0.2845 -> 0.1437   acc: 92.42% -> 95.45%             
client [47] (test)  loss: 0.4505 -> 0.3977   acc: 87.88% -> 87.88%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6386 -> 0.3963   acc: 79.47% -> 86.75%             
client [11] (test)  loss: 0.7262 -> 0.6288   acc: 75.71% -> 80.00%             
client [37] (test)  loss: 1.1097 -> 0.3334   acc: 65.77% -> 89.26%             
client [41] (test)  loss: 1.3305 -> 0.2190   acc: 59.86% -> 89.80%             
client [95] (test)  loss: 0.3457 -> 0.2033   acc: 89.80% -> 93.88%             
client [53] (test)  loss: 0.8114 -> 0.3027   acc: 74.45% -> 87.59%             
client [22] (test)  loss: 0.5615 -> 0.4299   acc: 80.73% -> 83.49%             
client [25] (test)  loss: 0.7714 -> 0.4037   acc: 72.27% -> 85.71%             
client [69] (test)  loss: 1.0270 -> 0.5619   acc: 68.13% -> 81.32%             
client [46] (test)  loss: 0.1850 -> 0.1859   acc: 93.65% -> 93.65%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4891 -> 0.4055   acc: 84.85% -> 86.36%             
client [69] (test)  loss: 0.9268 -> 0.5689   acc: 68.13% -> 81.32%             
client [82] (test)  loss: 0.3872 -> 0.2938   acc: 87.79% -> 88.55%             
client [45] (test)  loss: 0.2784 -> 0.1333   acc: 92.42% -> 94.70%             
client [7] (test)  loss: 0.5529 -> 0.4207   acc: 80.00% -> 87.83%              
client [50] (test)  loss: 0.6018 -> 0.2887   acc: 78.20% -> 90.23%             
client [35] (test)  loss: 0.5863 -> 0.6386   acc: 80.00% -> 75.79%             
client [24] (test)  loss: 0.6595 -> 0.3087   acc: 78.15% -> 89.92%             
client [15] (test)  loss: 0.6496 -> 0.5350   acc: 81.82% -> 84.85%             
client [58] (test)  loss: 0.8240 -> 0.6352   acc: 69.92% -> 81.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3531 -> 0.1753   acc: 89.32% -> 96.12%             
client [76] (test)  loss: 0.3252 -> 0.2755   acc: 91.91% -> 92.65%             
client [67] (test)  loss: 0.5529 -> 0.3115   acc: 83.77% -> 88.96%             
client [37] (test)  loss: 1.2566 -> 0.3338   acc: 61.07% -> 90.60%             
client [58] (test)  loss: 0.8409 -> 0.6116   acc: 68.42% -> 78.95%             
client [64] (test)  loss: 0.2464 -> 0.1996   acc: 91.22% -> 92.57%             
client [77] (test)  loss: 0.4925 -> 0.2429   acc: 80.58% -> 92.23%             
client [55] (test)  loss: 0.7809 -> 0.6654   acc: 75.96% -> 78.85%             
client [12] (test)  loss: 0.6772 -> 0.4979   acc: 73.50% -> 78.63%             
client [89] (test)  loss: 0.7782 -> 0.4937   acc: 71.43% -> 77.14%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6770 -> 0.6480   acc: 76.47% -> 77.31%             
client [51] (test)  loss: 0.4541 -> 0.2399   acc: 84.26% -> 89.81%             
client [8] (test)  loss: 0.3051 -> 0.1371   acc: 89.52% -> 96.77%              
client [18] (test)  loss: 0.4079 -> 0.3301   acc: 85.98% -> 87.85%             
client [94] (test)  loss: 0.4684 -> 0.0465   acc: 86.89% -> 99.18%             
client [81] (test)  loss: 0.3675 -> 0.2843   acc: 86.49% -> 90.99%             
client [3] (test)  loss: 0.2951 -> 0.1992   acc: 90.12% -> 94.47%              
client [11] (test)  loss: 0.8548 -> 0.5871   acc: 74.29% -> 81.43%             
client [95] (test)  loss: 0.2284 -> 0.1844   acc: 93.88% -> 94.56%             
client [67] (test)  loss: 1.0691 -> 0.3214   acc: 66.88% -> 87.66%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1741 -> 0.1685   acc: 69.47% -> 94.69%             
client [79] (test)  loss: 0.3111 -> 0.2449   acc: 91.55% -> 92.96%             
client [58] (test)  loss: 0.7394 -> 0.6179   acc: 73.68% -> 79.70%             
client [88] (test)  loss: 0.8470 -> 0.4219   acc: 75.00% -> 84.09%             
client [46] (test)  loss: 0.2377 -> 0.1862   acc: 92.86% -> 93.65%             
client [11] (test)  loss: 0.7761 -> 0.6014   acc: 72.86% -> 82.86%             
client [55] (test)  loss: 0.9476 -> 0.6370   acc: 66.35% -> 76.92%             
client [13] (test)  loss: 0.8465 -> 0.3106   acc: 67.61% -> 87.32%             
client [31] (test)  loss: 0.3593 -> 0.2043   acc: 87.60% -> 94.21%             
client [75] (test)  loss: 0.4529 -> 0.3721   acc: 83.02% -> 86.79%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5630 -> 0.3861   acc: 81.32% -> 85.71%             
client [7] (test)  loss: 0.4896 -> 0.3847   acc: 84.35% -> 90.43%              
client [57] (test)  loss: 0.7148 -> 0.3789   acc: 76.69% -> 82.71%             
client [13] (test)  loss: 0.6767 -> 0.3453   acc: 73.24% -> 88.73%             
client [43] (test)  loss: 0.7503 -> 0.3494   acc: 79.51% -> 90.16%             
client [91] (test)  loss: 1.0929 -> 0.2287   acc: 68.99% -> 93.80%             
client [10] (test)  loss: 0.5178 -> 0.2598   acc: 75.94% -> 90.98%             
client [64] (test)  loss: 0.2350 -> 0.1912   acc: 89.86% -> 91.89%             
client [82] (test)  loss: 0.4985 -> 0.2631   acc: 80.92% -> 90.08%             
client [22] (test)  loss: 0.4931 -> 0.3560   acc: 77.98% -> 87.16%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8426 -> 0.2384   acc: 77.12% -> 96.08%             
client [23] (test)  loss: 0.5288 -> 0.5137   acc: 80.31% -> 84.25%             
client [88] (test)  loss: 0.7074 -> 0.3910   acc: 76.52% -> 85.61%             
client [98] (test)  loss: 0.8024 -> 0.3736   acc: 75.00% -> 81.67%             
client [79] (test)  loss: 0.4098 -> 0.2257   acc: 87.32% -> 92.25%             
client [21] (test)  loss: 0.7796 -> 0.1783   acc: 76.55% -> 93.81%             
client [92] (test)  loss: 0.4208 -> 0.4161   acc: 88.78% -> 87.76%             
client [56] (test)  loss: 0.3904 -> 0.1917   acc: 87.41% -> 91.11%             
client [5] (test)  loss: 0.5199 -> 0.3154   acc: 81.18% -> 90.59%              
client [52] (test)  loss: 0.5188 -> 0.2513   acc: 86.34% -> 90.68%             
==================== FedBN_0.5 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '0.7403 -> 0.0000', 'accuracy': '75.67% -> 0.00%'},          
    200: {'loss': '0.5586 -> 0.0000', 'accuracy': '82.74% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_0.5 achieved 10.0%(13.52%) at epoch: 0                                   
FedBN_0.5 achieved 20.0%(21.60%) at epoch: 1                                   
FedBN_0.5 achieved 40.0%(46.45%) at epoch: 6                                   
FedBN_0.5 achieved 50.0%(52.41%) at epoch: 22                                  
FedBN_0.5 achieved 60.0%(61.37%) at epoch: 27                                  
FedBN_0.5 achieved 70.0%(71.99%) at epoch: 38                                  
FedBN_0.5 achieved 80.0%(80.66%) at epoch: 77                                  
Convergence (test_after):                                                      
FedBN_0.5 achieved 40.0%(45.42%) at epoch: 0                                   
FedBN_0.5 achieved 50.0%(53.94%) at epoch: 3                                   
FedBN_0.5 achieved 60.0%(67.15%) at epoch: 6                                   
FedBN_0.5 achieved 70.0%(72.15%) at epoch: 14                                  
FedBN_0.5 achieved 80.0%(83.18%) at epoch: 24                                  
FedBN_0.5 achieved 90.0%(91.85%) at epoch: 114                                 
