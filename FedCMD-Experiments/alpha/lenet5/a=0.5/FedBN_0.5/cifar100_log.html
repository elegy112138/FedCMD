==================== ALGORITHM: FedBN_0.5 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.5127 -> 4.0746   acc: 1.31% -> 4.92%               
client [81] (test)  loss: 4.5155 -> 4.0332   acc: 2.30% -> 12.50%              
client [21] (test)  loss: 25.3773 -> 4.0231   acc: 0.70% -> 10.10%             
client [68] (test)  loss: 4.7639 -> 3.9818   acc: 0.30% -> 13.68%              
client [93] (test)  loss: 4.4668 -> 3.9027   acc: 3.58% -> 10.75%              
client [31] (test)  loss: 4.5844 -> 4.0656   acc: 0.00% -> 11.27%              
client [20] (test)  loss: 4.5332 -> 4.2827   acc: 4.14% -> 2.41%               
client [59] (test)  loss: 21.2868 -> 4.0260   acc: 0.00% -> 5.50%              
client [48] (test)  loss: 4.6304 -> 4.1491   acc: 0.33% -> 5.57%               
client [34] (test)  loss: 4.5516 -> 4.1344   acc: 1.11% -> 11.07%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.7194 -> 3.5509   acc: 1.44% -> 13.31%              
client [99] (test)  loss: 4.4420 -> 3.8317   acc: 2.88% -> 13.78%              
client [67] (test)  loss: 4.3022 -> 3.7573   acc: 3.26% -> 12.70%              
client [0] (test)  loss: 4.1935 -> 3.3631   acc: 4.00% -> 16.00%               
client [76] (test)  loss: 4.5055 -> 4.2369   acc: 3.03% -> 4.92%               
client [41] (test)  loss: 6.0100 -> 4.2285   acc: 1.66% -> 2.33%               
client [62] (test)  loss: 227.6028 -> 3.6944   acc: 0.00% -> 14.52%            
client [2] (test)  loss: 215.3156 -> 3.6460   acc: 0.33% -> 15.89%             
client [14] (test)  loss: 4.4452 -> 3.7746   acc: 2.24% -> 11.82%              
client [46] (test)  loss: 4.6653 -> 3.7994   acc: 0.66% -> 13.62%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.0204 -> 3.6315   acc: 8.68% -> 15.97%              
client [68] (test)  loss: 4.3444 -> 3.5585   acc: 4.86% -> 17.02%              
client [57] (test)  loss: 4.1016 -> 3.4841   acc: 10.68% -> 15.53%             
client [17] (test)  loss: 5.3543 -> 3.4361   acc: 0.88% -> 18.42%              
client [54] (test)  loss: 4.0655 -> 3.5014   acc: 3.22% -> 13.83%              
client [23] (test)  loss: 268.9698 -> 4.0868   acc: 0.67% -> 6.67%             
client [35] (test)  loss: 4.2188 -> 3.6820   acc: 6.56% -> 12.79%              
client [59] (test)  loss: 4.0875 -> 3.7358   acc: 8.41% -> 12.94%              
client [31] (test)  loss: 4.2642 -> 3.7621   acc: 6.91% -> 11.64%              
client [9] (test)  loss: 4.2428 -> 3.8014   acc: 1.95% -> 9.12%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.2545 -> 3.3257   acc: 2.66% -> 19.60%              
client [33] (test)  loss: 4.1131 -> 3.6724   acc: 7.51% -> 9.90%               
client [16] (test)  loss: 4.3769 -> 2.9208   acc: 3.95% -> 28.42%              
client [44] (test)  loss: 5.9427 -> 3.4417   acc: 1.98% -> 17.82%              
client [8] (test)  loss: 4.1403 -> 3.5003   acc: 10.16% -> 13.33%              
client [31] (test)  loss: 4.8254 -> 3.8314   acc: 1.09% -> 12.36%              
client [47] (test)  loss: 4.7547 -> 3.7048   acc: 3.44% -> 12.19%              
client [36] (test)  loss: 4.3755 -> 3.8904   acc: 6.25% -> 14.17%              
client [20] (test)  loss: 4.1194 -> 3.7253   acc: 6.90% -> 13.10%              
client [56] (test)  loss: 4.3346 -> 3.8335   acc: 3.50% -> 14.34%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0007 -> 3.3468   acc: 11.36% -> 23.81%              
client [60] (test)  loss: 4.3723 -> 3.6937   acc: 3.70% -> 16.67%              
client [28] (test)  loss: 4.5042 -> 3.5768   acc: 7.42% -> 17.42%              
client [25] (test)  loss: 4.1727 -> 3.0663   acc: 5.83% -> 24.60%              
client [58] (test)  loss: 3.8724 -> 3.2956   acc: 7.55% -> 16.67%              
client [44] (test)  loss: 4.0914 -> 3.3366   acc: 5.28% -> 20.79%              
client [39] (test)  loss: 3.8046 -> 3.4926   acc: 9.24% -> 19.80%              
client [29] (test)  loss: 6.4817 -> 3.3545   acc: 1.99% -> 19.60%              
client [3] (test)  loss: 3.9135 -> 3.0274   acc: 9.06% -> 27.51%               
client [84] (test)  loss: 4.1999 -> 3.4118   acc: 7.17% -> 19.00%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.4501 -> 3.2367   acc: 1.74% -> 23.34%              
client [84] (test)  loss: 4.1979 -> 3.3529   acc: 5.61% -> 19.94%              
client [10] (test)  loss: 5.3727 -> 3.0848   acc: 4.26% -> 17.05%              
client [36] (test)  loss: 4.3604 -> 3.7376   acc: 7.08% -> 18.33%              
client [65] (test)  loss: 4.2353 -> 3.2940   acc: 5.18% -> 26.54%              
client [81] (test)  loss: 4.0532 -> 4.1338   acc: 10.53% -> 14.14%             
client [79] (test)  loss: 4.2902 -> 3.4126   acc: 7.64% -> 18.94%              
client [42] (test)  loss: 4.8945 -> 3.9320   acc: 5.44% -> 13.95%              
client [11] (test)  loss: 4.1892 -> 3.1814   acc: 4.91% -> 20.00%              
client [96] (test)  loss: 5.0174 -> 3.3579   acc: 5.18% -> 15.86%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.8481 -> 3.4609   acc: 12.38% -> 17.14%              
client [53] (test)  loss: 4.4028 -> 3.3423   acc: 5.59% -> 18.42%              
client [52] (test)  loss: 4.6978 -> 3.3180   acc: 6.47% -> 19.42%              
client [42] (test)  loss: 4.8794 -> 3.1964   acc: 3.40% -> 22.79%              
client [69] (test)  loss: 3.5667 -> 3.2770   acc: 13.67% -> 20.50%             
client [59] (test)  loss: 3.8985 -> 3.6690   acc: 11.97% -> 11.97%             
client [7] (test)  loss: 5.0063 -> 3.3543   acc: 4.47% -> 16.61%               
client [26] (test)  loss: 3.9849 -> 4.1350   acc: 7.31% -> 17.94%              
client [49] (test)  loss: 4.1883 -> 3.5513   acc: 7.66% -> 19.35%              
client [98] (test)  loss: 3.9043 -> 3.4914   acc: 10.42% -> 13.68%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.7578 -> 3.6383   acc: 14.01% -> 14.98%             
client [47] (test)  loss: 4.7015 -> 3.3155   acc: 6.56% -> 23.12%              
client [21] (test)  loss: 4.2501 -> 3.1572   acc: 10.10% -> 23.34%             
client [77] (test)  loss: 3.9001 -> 3.4517   acc: 12.13% -> 18.69%             
client [95] (test)  loss: 3.7978 -> 3.7476   acc: 9.57% -> 14.85%              
client [91] (test)  loss: 3.7581 -> 3.4849   acc: 12.82% -> 22.44%             
client [14] (test)  loss: 3.7826 -> 3.2405   acc: 8.31% -> 23.32%              
client [99] (test)  loss: 3.8511 -> 3.2432   acc: 10.90% -> 24.36%             
client [20] (test)  loss: 4.0953 -> 3.3159   acc: 10.34% -> 21.38%             
client [39] (test)  loss: 4.5036 -> 3.6282   acc: 9.24% -> 19.47%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.3658 -> 3.2667   acc: 9.71% -> 21.04%              
client [62] (test)  loss: 3.6108 -> 3.5112   acc: 14.85% -> 20.79%             
client [71] (test)  loss: 4.0032 -> 3.9389   acc: 15.20% -> 16.22%             
client [97] (test)  loss: 3.8437 -> 2.9602   acc: 17.96% -> 26.63%             
client [30] (test)  loss: 3.2717 -> 4.1516   acc: 21.00% -> 10.00%             
client [88] (test)  loss: 3.4747 -> 3.2193   acc: 16.31% -> 20.57%             
client [60] (test)  loss: 3.9846 -> 3.6420   acc: 11.48% -> 18.52%             
client [82] (test)  loss: 3.5964 -> 3.8036   acc: 17.75% -> 13.99%             
client [91] (test)  loss: 3.9290 -> 3.6761   acc: 10.90% -> 21.79%             
client [57] (test)  loss: 4.2100 -> 3.3169   acc: 7.44% -> 18.12%              
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.3509 -> 3.3196   acc: 5.45% -> 21.45%              
client [15] (test)  loss: 3.8236 -> 3.3445   acc: 11.55% -> 20.46%             
client [71] (test)  loss: 4.4779 -> 3.9597   acc: 12.16% -> 15.88%             
client [97] (test)  loss: 4.4112 -> 3.0642   acc: 10.84% -> 29.10%             
client [53] (test)  loss: 4.2382 -> 3.1891   acc: 8.88% -> 20.72%              
client [77] (test)  loss: 3.9808 -> 3.1281   acc: 15.41% -> 19.67%             
client [76] (test)  loss: 4.3251 -> 3.4116   acc: 9.47% -> 19.70%              
client [79] (test)  loss: 4.1620 -> 3.0822   acc: 13.29% -> 30.90%             
client [28] (test)  loss: 4.1921 -> 3.8760   acc: 7.42% -> 15.81%              
client [99] (test)  loss: 4.0312 -> 3.2758   acc: 8.97% -> 20.51%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.8363 -> 3.0281   acc: 17.96% -> 27.24%             
client [86] (test)  loss: 3.4380 -> 3.2497   acc: 19.48% -> 24.03%             
client [34] (test)  loss: 4.5908 -> 3.4852   acc: 10.70% -> 19.56%             
client [73] (test)  loss: 3.2889 -> 3.8691   acc: 23.62% -> 17.48%             
client [5] (test)  loss: 3.7992 -> 3.9171   acc: 17.55% -> 17.22%              
client [96] (test)  loss: 3.5739 -> 3.1043   acc: 17.48% -> 23.95%             
client [22] (test)  loss: 4.7995 -> 3.2518   acc: 8.28% -> 18.87%              
client [60] (test)  loss: 3.5253 -> 3.4768   acc: 17.04% -> 24.81%             
client [66] (test)  loss: 4.4530 -> 3.5101   acc: 6.98% -> 17.28%              
client [83] (test)  loss: 4.1037 -> 3.1365   acc: 8.53% -> 23.55%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.7250 -> 3.4269   acc: 21.21% -> 20.45%             
client [65] (test)  loss: 4.8312 -> 3.1209   acc: 6.80% -> 30.74%              
client [95] (test)  loss: 4.0706 -> 3.5227   acc: 10.56% -> 18.15%             
client [17] (test)  loss: 4.9322 -> 2.9179   acc: 6.73% -> 32.75%              
client [8] (test)  loss: 3.7485 -> 2.9318   acc: 16.51% -> 28.89%              
client [35] (test)  loss: 3.5017 -> 3.1707   acc: 20.66% -> 23.93%             
client [98] (test)  loss: 3.9690 -> 3.4220   acc: 15.31% -> 18.89%             
client [53] (test)  loss: 3.8295 -> 3.2578   acc: 10.86% -> 18.75%             
client [43] (test)  loss: 3.9939 -> 3.3214   acc: 11.55% -> 16.83%             
client [64] (test)  loss: 3.5724 -> 2.7675   acc: 12.96% -> 34.22%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.0833 -> 2.9905   acc: 11.85% -> 27.87%             
client [88] (test)  loss: 3.7046 -> 2.8505   acc: 15.25% -> 26.24%             
client [38] (test)  loss: 3.5536 -> 2.6065   acc: 14.75% -> 35.74%             
client [3] (test)  loss: 3.3653 -> 3.1103   acc: 20.71% -> 30.74%              
client [5] (test)  loss: 3.6812 -> 3.6406   acc: 17.22% -> 20.86%              
client [41] (test)  loss: 4.5211 -> 3.3172   acc: 9.63% -> 21.26%              
client [7] (test)  loss: 4.2066 -> 3.4737   acc: 7.67% -> 19.49%               
client [37] (test)  loss: 3.8405 -> 3.1173   acc: 13.86% -> 30.03%             
client [45] (test)  loss: 3.7454 -> 2.9069   acc: 14.95% -> 28.24%             
client [47] (test)  loss: 4.9600 -> 3.1426   acc: 7.50% -> 27.50%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.8796 -> 2.6286   acc: 11.84% -> 35.79%             
client [11] (test)  loss: 4.4359 -> 2.9300   acc: 9.12% -> 30.88%              
client [37] (test)  loss: 3.8065 -> 3.0689   acc: 14.85% -> 30.36%             
client [41] (test)  loss: 4.3181 -> 3.1891   acc: 10.96% -> 24.25%             
client [95] (test)  loss: 4.1119 -> 3.3031   acc: 10.89% -> 22.44%             
client [53] (test)  loss: 3.6940 -> 3.3353   acc: 8.88% -> 21.05%              
client [22] (test)  loss: 4.3193 -> 3.3519   acc: 8.28% -> 22.19%              
client [25] (test)  loss: 3.3517 -> 2.8637   acc: 18.12% -> 31.72%             
client [69] (test)  loss: 3.7122 -> 3.0142   acc: 14.75% -> 32.73%             
client [46] (test)  loss: 3.5657 -> 3.3010   acc: 15.28% -> 24.58%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.8452 -> 3.1136   acc: 11.56% -> 30.00%             
client [69] (test)  loss: 3.4806 -> 2.9946   acc: 16.91% -> 33.81%             
client [82] (test)  loss: 3.6798 -> 3.6377   acc: 20.14% -> 16.38%             
client [45] (test)  loss: 3.9268 -> 3.2095   acc: 14.29% -> 23.92%             
client [7] (test)  loss: 3.7708 -> 3.4116   acc: 11.82% -> 20.13%              
client [50] (test)  loss: 3.9027 -> 3.1669   acc: 13.29% -> 24.58%             
client [35] (test)  loss: 3.3713 -> 3.2541   acc: 20.00% -> 22.95%             
client [24] (test)  loss: 3.8275 -> 3.0333   acc: 14.24% -> 26.04%             
client [15] (test)  loss: 3.5617 -> 3.6140   acc: 17.82% -> 20.46%             
client [58] (test)  loss: 3.2895 -> 2.9965   acc: 21.38% -> 30.50%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.6163 -> 3.1099   acc: 9.84% -> 25.90%              
client [76] (test)  loss: 3.8459 -> 3.2915   acc: 17.05% -> 23.11%             
client [67] (test)  loss: 3.2564 -> 3.6737   acc: 23.45% -> 19.22%             
client [37] (test)  loss: 3.6627 -> 3.1255   acc: 20.13% -> 31.02%             
client [58] (test)  loss: 3.5226 -> 2.9842   acc: 20.13% -> 31.13%             
client [64] (test)  loss: 3.0938 -> 2.6255   acc: 21.59% -> 33.22%             
client [77] (test)  loss: 3.8972 -> 3.1518   acc: 15.41% -> 23.28%             
client [55] (test)  loss: 4.2637 -> 3.3311   acc: 11.70% -> 23.40%             
client [12] (test)  loss: 3.5176 -> 3.0703   acc: 16.94% -> 27.57%             
client [89] (test)  loss: 3.6747 -> 2.9951   acc: 14.47% -> 29.26%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.8704 -> 3.3981   acc: 15.89% -> 24.61%             
client [51] (test)  loss: 3.6881 -> 2.9256   acc: 16.28% -> 33.55%             
client [8] (test)  loss: 4.0184 -> 3.0387   acc: 13.02% -> 31.43%              
client [18] (test)  loss: 3.3545 -> 2.6440   acc: 21.31% -> 35.08%             
client [94] (test)  loss: 3.7054 -> 3.1625   acc: 13.43% -> 27.56%             
client [81] (test)  loss: 3.4172 -> 3.4217   acc: 16.12% -> 26.64%             
client [3] (test)  loss: 3.3250 -> 3.0360   acc: 23.30% -> 31.39%              
client [11] (test)  loss: 3.7782 -> 3.0390   acc: 21.40% -> 27.37%             
client [95] (test)  loss: 3.7052 -> 3.2469   acc: 15.18% -> 26.07%             
client [67] (test)  loss: 3.1509 -> 3.6393   acc: 22.15% -> 19.54%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.0005 -> 2.9330   acc: 17.42% -> 31.01%             
client [79] (test)  loss: 5.1733 -> 2.9589   acc: 11.96% -> 31.89%             
client [58] (test)  loss: 3.4700 -> 2.9877   acc: 23.58% -> 30.82%             
client [88] (test)  loss: 3.9735 -> 2.8700   acc: 14.89% -> 27.30%             
client [46] (test)  loss: 3.9318 -> 3.3428   acc: 14.62% -> 27.24%             
client [11] (test)  loss: 4.4149 -> 2.9319   acc: 14.39% -> 31.58%             
client [55] (test)  loss: 3.8742 -> 3.3575   acc: 16.31% -> 23.76%             
client [13] (test)  loss: 4.0681 -> 3.1258   acc: 13.24% -> 24.39%             
client [31] (test)  loss: 3.9985 -> 3.3192   acc: 17.45% -> 24.00%             
client [75] (test)  loss: 4.0645 -> 3.0027   acc: 11.04% -> 28.06%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.6252 -> 3.0830   acc: 17.26% -> 26.71%             
client [7] (test)  loss: 3.8169 -> 3.3248   acc: 14.38% -> 23.96%              
client [57] (test)  loss: 3.4276 -> 3.1336   acc: 22.33% -> 27.83%             
client [13] (test)  loss: 3.8177 -> 3.1242   acc: 15.33% -> 24.04%             
client [43] (test)  loss: 3.6346 -> 3.1476   acc: 18.15% -> 21.78%             
client [91] (test)  loss: 3.8724 -> 2.8992   acc: 15.06% -> 29.81%             
client [10] (test)  loss: 3.8397 -> 2.7717   acc: 17.38% -> 30.49%             
client [64] (test)  loss: 2.8937 -> 2.6957   acc: 27.24% -> 33.22%             
client [82] (test)  loss: 3.8719 -> 3.3024   acc: 16.38% -> 23.55%             
client [22] (test)  loss: 4.0193 -> 3.2234   acc: 12.58% -> 27.48%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.4702 -> 2.8101   acc: 16.90% -> 26.90%             
client [23] (test)  loss: 3.9514 -> 3.2094   acc: 15.67% -> 26.00%             
client [88] (test)  loss: 3.4257 -> 2.9011   acc: 18.09% -> 26.95%             
client [98] (test)  loss: 3.5438 -> 2.9758   acc: 19.87% -> 29.64%             
client [79] (test)  loss: 4.5974 -> 3.0608   acc: 15.28% -> 32.89%             
client [21] (test)  loss: 3.4085 -> 3.0684   acc: 18.47% -> 28.57%             
client [92] (test)  loss: 3.9097 -> 3.0046   acc: 13.67% -> 30.33%             
client [56] (test)  loss: 3.3614 -> 3.1421   acc: 23.08% -> 25.17%             
client [5] (test)  loss: 3.8780 -> 3.5749   acc: 17.22% -> 23.18%              
client [52] (test)  loss: 3.2531 -> 3.0886   acc: 20.06% -> 29.77%             
==================== FedBN_0.5 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '4.2438 -> 0.0000', 'accuracy': '10.67% -> 0.00%'},          
    200: {'loss': '3.7133 -> 0.0000', 'accuracy': '17.49% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_0.5 achieved 10.0%(10.25%) at epoch: 66                                  
Convergence (test_after):                                                      
FedBN_0.5 achieved 10.0%(10.93%) at epoch: 12                                  
FedBN_0.5 achieved 20.0%(20.58%) at epoch: 49                                  
FedBN_0.5 achieved 30.0%(30.97%) at epoch: 178                                 
