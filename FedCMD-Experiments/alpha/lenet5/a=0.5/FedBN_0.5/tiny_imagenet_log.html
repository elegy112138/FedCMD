==================== ALGORITHM: FedBN_0.5 ====================                 
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1814 -> 4.5432   acc: 2.43% -> 8.52%               
client [81] (test)  loss: 5.1897 -> 4.9095   acc: 1.82% -> 3.64%               
client [21] (test)  loss: 5.2470 -> 4.5441   acc: 1.62% -> 6.86%               
client [68] (test)  loss: 5.2422 -> 4.6931   acc: 1.08% -> 7.37%               
client [93] (test)  loss: 5.4158 -> 4.6470   acc: 1.27% -> 9.58%               
client [31] (test)  loss: 5.2542 -> 4.4286   acc: 1.26% -> 6.85%               
client [20] (test)  loss: 4.9899 -> 4.3803   acc: 2.67% -> 7.13%               
client [59] (test)  loss: 5.2412 -> 4.5742   acc: 2.16% -> 5.40%               
client [48] (test)  loss: 5.3221 -> 4.6751   acc: 1.79% -> 7.16%               
client [34] (test)  loss: 5.0792 -> 4.5812   acc: 3.25% -> 7.40%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.8756 -> 4.4996   acc: 0.92% -> 9.89%               
client [99] (test)  loss: 5.7550 -> 4.5575   acc: 1.98% -> 6.83%               
client [67] (test)  loss: 5.0844 -> 4.0157   acc: 4.42% -> 14.69%              
client [0] (test)  loss: 4.9594 -> 4.3186   acc: 3.05% -> 9.34%                
client [76] (test)  loss: 4.9294 -> 4.4310   acc: 4.53% -> 7.43%               
client [41] (test)  loss: 5.5653 -> 4.2644   acc: 3.25% -> 9.04%               
client [62] (test)  loss: 5.1958 -> 4.4664   acc: 1.63% -> 7.26%               
client [2] (test)  loss: 5.1981 -> 4.4803   acc: 1.35% -> 10.06%               
client [14] (test)  loss: 4.9987 -> 4.3947   acc: 4.62% -> 10.72%              
client [46] (test)  loss: 5.1378 -> 4.4101   acc: 3.43% -> 6.68%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.5116 -> 4.1047   acc: 8.98% -> 11.58%              
client [68] (test)  loss: 4.9872 -> 4.4830   acc: 7.37% -> 11.87%              
client [57] (test)  loss: 4.5667 -> 4.1719   acc: 7.62% -> 12.70%              
client [17] (test)  loss: 7.2153 -> 4.2221   acc: 1.28% -> 10.46%              
client [54] (test)  loss: 4.6000 -> 4.1666   acc: 6.35% -> 11.07%              
client [23] (test)  loss: 5.0090 -> 4.1994   acc: 2.58% -> 10.71%              
client [35] (test)  loss: 4.7052 -> 4.7523   acc: 6.33% -> 5.24%               
client [59] (test)  loss: 4.4812 -> 4.2176   acc: 6.47% -> 8.27%               
client [31] (test)  loss: 4.5002 -> 4.0370   acc: 8.47% -> 14.05%              
client [9] (test)  loss: 4.5242 -> 4.2886   acc: 5.26% -> 8.11%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.5385 -> 4.1280   acc: 6.35% -> 12.16%              
client [33] (test)  loss: 4.4863 -> 4.0460   acc: 6.87% -> 10.85%              
client [16] (test)  loss: 4.6705 -> 4.0897   acc: 7.65% -> 15.30%              
client [44] (test)  loss: 12.7349 -> 4.2395   acc: 0.90% -> 11.39%             
client [8] (test)  loss: 4.5303 -> 3.9615   acc: 6.90% -> 16.15%               
client [31] (test)  loss: 4.6939 -> 3.9098   acc: 6.13% -> 15.32%              
client [47] (test)  loss: 4.9571 -> 4.0575   acc: 5.71% -> 14.00%              
client [36] (test)  loss: 4.8578 -> 4.2064   acc: 3.42% -> 10.99%              
client [20] (test)  loss: 4.4190 -> 3.9614   acc: 9.98% -> 15.69%              
client [56] (test)  loss: 4.3619 -> 3.9900   acc: 12.48% -> 15.37%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.2711 -> 3.9557   acc: 12.73% -> 14.73%              
client [60] (test)  loss: 4.8127 -> 3.7439   acc: 8.27% -> 16.73%              
client [28] (test)  loss: 5.6508 -> 4.0045   acc: 7.44% -> 15.06%              
client [25] (test)  loss: 5.3591 -> 4.1565   acc: 7.09% -> 14.00%              
client [58] (test)  loss: 4.5895 -> 4.1786   acc: 7.23% -> 13.02%              
client [44] (test)  loss: 4.3821 -> 4.0656   acc: 10.85% -> 14.83%             
client [39] (test)  loss: 4.5191 -> 3.9634   acc: 9.78% -> 16.12%              
client [29] (test)  loss: 5.2046 -> 4.0723   acc: 6.26% -> 15.74%              
client [3] (test)  loss: 4.4174 -> 3.8968   acc: 7.59% -> 13.38%               
client [84] (test)  loss: 4.4487 -> 4.0253   acc: 9.75% -> 15.70%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.6058 -> 3.9551   acc: 11.37% -> 18.23%             
client [84] (test)  loss: 4.1987 -> 3.9742   acc: 13.18% -> 17.33%             
client [10] (test)  loss: 4.7790 -> 3.9859   acc: 9.22% -> 15.91%              
client [36] (test)  loss: 4.5413 -> 4.0248   acc: 8.11% -> 13.87%              
client [65] (test)  loss: 4.5278 -> 4.1859   acc: 8.92% -> 11.20%              
client [81] (test)  loss: 4.3247 -> 4.3355   acc: 11.45% -> 9.64%              
client [79] (test)  loss: 4.5053 -> 3.9414   acc: 7.81% -> 18.03%              
client [42] (test)  loss: 4.4862 -> 4.0212   acc: 7.59% -> 14.83%              
client [11] (test)  loss: 4.3827 -> 3.6755   acc: 10.30% -> 19.80%             
client [96] (test)  loss: 4.3964 -> 3.8755   acc: 12.66% -> 15.55%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.5465 -> 3.7937   acc: 7.08% -> 19.96%               
client [53] (test)  loss: 4.7792 -> 3.8318   acc: 7.03% -> 17.48%              
client [52] (test)  loss: 4.3084 -> 4.1889   acc: 12.48% -> 13.78%             
client [42] (test)  loss: 4.4798 -> 3.9625   acc: 7.78% -> 17.90%              
client [69] (test)  loss: 4.7216 -> 4.0536   acc: 9.34% -> 17.95%              
client [59] (test)  loss: 4.2004 -> 3.8668   acc: 10.97% -> 14.21%             
client [7] (test)  loss: 5.5346 -> 3.9527   acc: 7.50% -> 17.50%               
client [26] (test)  loss: 4.4732 -> 3.8614   acc: 10.05% -> 19.41%             
client [49] (test)  loss: 4.3818 -> 4.1866   acc: 11.41% -> 14.49%             
client [98] (test)  loss: 4.3994 -> 3.8874   acc: 7.59% -> 15.55%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.7624 -> 3.8743   acc: 9.76% -> 16.46%              
client [47] (test)  loss: 4.7520 -> 3.9312   acc: 7.73% -> 18.42%              
client [21] (test)  loss: 4.4397 -> 3.8907   acc: 10.65% -> 18.95%             
client [77] (test)  loss: 4.4266 -> 3.8871   acc: 9.91% -> 17.04%              
client [95] (test)  loss: 4.3500 -> 3.8709   acc: 11.03% -> 18.63%             
client [91] (test)  loss: 4.4074 -> 3.8195   acc: 8.45% -> 20.95%              
client [14] (test)  loss: 4.6089 -> 4.1650   acc: 7.76% -> 13.86%              
client [99] (test)  loss: 4.5320 -> 4.1506   acc: 8.27% -> 14.93%              
client [20] (test)  loss: 4.5164 -> 4.0345   acc: 10.34% -> 17.65%             
client [39] (test)  loss: 4.3457 -> 3.8090   acc: 13.04% -> 20.07%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.5693 -> 4.1153   acc: 10.99% -> 14.34%             
client [62] (test)  loss: 4.4590 -> 4.0663   acc: 11.43% -> 18.87%             
client [71] (test)  loss: 4.1579 -> 3.8860   acc: 13.33% -> 18.20%             
client [97] (test)  loss: 4.3234 -> 4.0386   acc: 14.71% -> 15.26%             
client [30] (test)  loss: 4.0681 -> 4.1758   acc: 14.52% -> 17.42%             
client [88] (test)  loss: 4.5074 -> 3.8370   acc: 7.10% -> 17.41%              
client [60] (test)  loss: 4.1989 -> 3.8825   acc: 12.77% -> 17.27%             
client [82] (test)  loss: 4.5898 -> 4.1363   acc: 9.57% -> 16.52%              
client [91] (test)  loss: 4.4853 -> 3.9083   acc: 9.80% -> 20.10%              
client [57] (test)  loss: 4.3136 -> 3.9925   acc: 11.43% -> 17.79%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.8097 -> 4.2157   acc: 13.51% -> 16.22%             
client [15] (test)  loss: 4.5485 -> 4.0838   acc: 8.70% -> 13.85%              
client [71] (test)  loss: 4.5055 -> 3.9057   acc: 8.47% -> 18.56%              
client [97] (test)  loss: 4.5170 -> 4.2557   acc: 11.03% -> 15.99%             
client [53] (test)  loss: 4.9641 -> 3.9225   acc: 9.91% -> 16.22%              
client [77] (test)  loss: 4.7304 -> 3.9350   acc: 8.70% -> 18.09%              
client [76] (test)  loss: 4.4032 -> 4.2355   acc: 11.05% -> 16.67%             
client [79] (test)  loss: 4.7443 -> 4.0025   acc: 10.04% -> 19.52%             
client [28] (test)  loss: 4.3952 -> 4.0268   acc: 13.25% -> 19.60%             
client [99] (test)  loss: 4.4805 -> 4.1807   acc: 11.87% -> 14.93%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.5980 -> 4.3780   acc: 12.32% -> 15.62%             
client [86] (test)  loss: 4.5701 -> 4.0843   acc: 9.98% -> 15.43%              
client [34] (test)  loss: 4.6841 -> 4.2219   acc: 10.83% -> 18.41%             
client [73] (test)  loss: 4.4721 -> 4.0924   acc: 10.00% -> 15.09%             
client [5] (test)  loss: 4.4705 -> 4.2040   acc: 11.89% -> 17.48%              
client [96] (test)  loss: 4.2590 -> 4.0776   acc: 14.29% -> 17.00%             
client [22] (test)  loss: 4.3667 -> 3.8229   acc: 10.87% -> 18.89%             
client [60] (test)  loss: 4.3391 -> 4.0129   acc: 11.51% -> 18.88%             
client [66] (test)  loss: 4.3693 -> 4.2097   acc: 12.91% -> 16.73%             
client [83] (test)  loss: 4.5880 -> 4.0764   acc: 8.91% -> 17.27%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.6002 -> 4.4474   acc: 12.50% -> 16.85%             
client [65] (test)  loss: 4.6506 -> 4.3336   acc: 10.82% -> 15.56%             
client [95] (test)  loss: 4.7143 -> 4.1223   acc: 9.76% -> 18.08%              
client [17] (test)  loss: 5.1718 -> 4.1833   acc: 8.26% -> 15.41%              
client [8] (test)  loss: 4.7687 -> 4.0578   acc: 9.62% -> 19.06%               
client [35] (test)  loss: 4.7251 -> 4.5792   acc: 9.04% -> 15.55%              
client [98] (test)  loss: 4.9134 -> 4.1620   acc: 10.67% -> 16.46%             
client [53] (test)  loss: 4.4970 -> 4.1656   acc: 12.07% -> 17.66%             
client [43] (test)  loss: 4.5918 -> 3.9883   acc: 9.44% -> 19.78%              
client [64] (test)  loss: 4.3756 -> 3.9698   acc: 13.25% -> 19.78%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.8025 -> 4.0532   acc: 11.73% -> 20.76%             
client [88] (test)  loss: 4.9238 -> 4.2407   acc: 8.17% -> 17.23%              
client [38] (test)  loss: 4.4012 -> 4.0689   acc: 13.22% -> 21.01%             
client [3] (test)  loss: 4.4875 -> 4.1785   acc: 12.84% -> 17.36%              
client [5] (test)  loss: 4.6021 -> 4.3145   acc: 11.71% -> 18.92%              
client [41] (test)  loss: 4.5870 -> 4.1775   acc: 12.30% -> 17.90%             
client [7] (test)  loss: 4.5978 -> 4.1919   acc: 12.50% -> 19.64%              
client [37] (test)  loss: 4.4847 -> 3.8298   acc: 9.75% -> 21.30%              
client [45] (test)  loss: 5.0239 -> 4.0171   acc: 10.39% -> 19.37%             
client [47] (test)  loss: 4.6760 -> 4.2550   acc: 10.87% -> 16.94%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.6559 -> 4.3359   acc: 12.17% -> 20.70%             
client [11] (test)  loss: 4.5007 -> 4.0301   acc: 12.48% -> 22.57%             
client [37] (test)  loss: 4.4996 -> 3.9821   acc: 10.65% -> 20.76%             
client [41] (test)  loss: 4.7095 -> 4.2252   acc: 13.38% -> 17.72%             
client [95] (test)  loss: 4.4296 -> 4.4385   acc: 12.12% -> 16.82%             
client [53] (test)  loss: 5.1125 -> 4.2101   acc: 9.19% -> 17.84%              
client [22] (test)  loss: 4.5171 -> 4.1136   acc: 11.59% -> 18.18%             
client [25] (test)  loss: 4.4410 -> 4.0118   acc: 12.00% -> 19.82%             
client [69] (test)  loss: 4.8574 -> 4.4038   acc: 11.90% -> 17.58%             
client [46] (test)  loss: 4.2730 -> 4.2397   acc: 14.08% -> 18.23%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.5746 -> 4.4985   acc: 9.76% -> 17.13%              
client [69] (test)  loss: 4.9123 -> 4.5655   acc: 13.74% -> 18.50%             
client [82] (test)  loss: 4.9817 -> 4.5971   acc: 10.09% -> 17.04%             
client [45] (test)  loss: 4.7250 -> 4.2501   acc: 11.62% -> 19.37%             
client [7] (test)  loss: 4.7145 -> 4.2931   acc: 12.14% -> 18.57%              
client [50] (test)  loss: 4.4415 -> 4.2242   acc: 15.73% -> 20.80%             
client [35] (test)  loss: 4.7854 -> 4.7707   acc: 10.13% -> 15.19%             
client [24] (test)  loss: 5.0861 -> 4.5211   acc: 9.78% -> 18.16%              
client [15] (test)  loss: 4.9016 -> 4.7190   acc: 9.24% -> 15.45%              
client [58] (test)  loss: 4.8505 -> 4.6815   acc: 11.93% -> 16.82%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.9668 -> 4.5038   acc: 10.20% -> 20.75%             
client [76] (test)  loss: 4.9482 -> 4.7237   acc: 11.59% -> 17.75%             
client [67] (test)  loss: 4.7317 -> 4.1635   acc: 9.91% -> 18.94%              
client [37] (test)  loss: 4.8559 -> 4.1164   acc: 11.19% -> 20.94%             
client [58] (test)  loss: 5.0435 -> 4.8158   acc: 11.03% -> 14.83%             
client [64] (test)  loss: 4.5676 -> 4.1853   acc: 12.34% -> 19.42%             
client [77] (test)  loss: 4.6944 -> 4.4006   acc: 12.00% -> 16.70%             
client [55] (test)  loss: 4.9193 -> 4.3211   acc: 13.19% -> 18.72%             
client [12] (test)  loss: 4.7224 -> 4.2326   acc: 11.49% -> 20.11%             
client [89] (test)  loss: 5.1963 -> 4.8221   acc: 10.53% -> 16.52%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.0627 -> 4.8682   acc: 12.45% -> 17.87%             
client [51] (test)  loss: 4.9637 -> 4.5691   acc: 11.78% -> 18.84%             
client [8] (test)  loss: 4.9733 -> 4.4366   acc: 10.89% -> 18.69%              
client [18] (test)  loss: 5.1496 -> 4.5256   acc: 10.89% -> 18.93%             
client [94] (test)  loss: 4.8832 -> 4.4629   acc: 12.71% -> 16.49%             
client [81] (test)  loss: 5.0901 -> 4.9392   acc: 10.36% -> 12.55%             
client [3] (test)  loss: 4.6886 -> 4.4791   acc: 12.66% -> 16.64%              
client [11] (test)  loss: 4.7715 -> 4.2814   acc: 13.66% -> 23.96%             
client [95] (test)  loss: 5.0562 -> 4.8422   acc: 9.95% -> 18.08%              
client [67] (test)  loss: 4.9717 -> 4.2005   acc: 9.38% -> 19.12%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.1417 -> 4.2772   acc: 12.45% -> 20.58%             
client [79] (test)  loss: 5.5476 -> 4.7849   acc: 12.08% -> 18.03%             
client [58] (test)  loss: 5.3433 -> 5.0545   acc: 10.67% -> 14.47%             
client [88] (test)  loss: 5.5564 -> 4.5467   acc: 7.99% -> 17.76%              
client [46] (test)  loss: 5.2770 -> 4.5574   acc: 13.00% -> 18.23%             
client [11] (test)  loss: 5.2071 -> 4.3184   acc: 11.29% -> 22.97%             
client [55] (test)  loss: 4.8567 -> 4.6594   acc: 12.30% -> 19.79%             
client [13] (test)  loss: 4.9917 -> 4.3350   acc: 12.84% -> 20.82%             
client [31] (test)  loss: 5.9186 -> 4.6086   acc: 10.27% -> 17.66%             
client [75] (test)  loss: 5.0341 -> 4.5341   acc: 12.45% -> 20.40%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.9409 -> 4.8629   acc: 14.77% -> 16.94%             
client [7] (test)  loss: 5.0890 -> 4.6122   acc: 12.50% -> 21.07%              
client [57] (test)  loss: 4.6958 -> 4.7007   acc: 12.70% -> 17.42%             
client [13] (test)  loss: 5.0905 -> 4.3916   acc: 10.89% -> 20.43%             
client [43] (test)  loss: 5.0226 -> 4.5466   acc: 9.26% -> 19.96%              
client [91] (test)  loss: 4.9675 -> 4.3172   acc: 13.68% -> 19.43%             
client [10] (test)  loss: 5.3092 -> 4.8433   acc: 11.93% -> 17.00%             
client [64] (test)  loss: 4.7212 -> 4.5259   acc: 13.97% -> 18.15%             
client [82] (test)  loss: 5.4445 -> 5.0374   acc: 9.74% -> 17.22%              
client [22] (test)  loss: 4.9774 -> 4.4724   acc: 11.94% -> 18.54%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.0170 -> 4.4799   acc: 11.41% -> 18.72%             
client [23] (test)  loss: 5.1586 -> 4.9385   acc: 11.11% -> 15.08%             
client [88] (test)  loss: 5.5822 -> 4.7208   acc: 9.41% -> 16.52%              
client [98] (test)  loss: 5.0804 -> 4.8654   acc: 11.21% -> 17.90%             
client [79] (test)  loss: 5.3569 -> 4.9999   acc: 13.01% -> 16.36%             
client [21] (test)  loss: 5.0310 -> 4.4357   acc: 11.37% -> 19.31%             
client [92] (test)  loss: 5.0568 -> 4.6761   acc: 12.64% -> 21.66%             
client [56] (test)  loss: 5.4169 -> 4.6513   acc: 13.38% -> 21.88%             
client [5] (test)  loss: 5.5283 -> 4.8273   acc: 11.89% -> 17.84%              
client [52] (test)  loss: 5.4008 -> 4.9120   acc: 10.61% -> 16.20%             
==================== FedBN_0.5 TEST RESULTS: ====================              
{                                                                              
    100: {'loss': '4.5038 -> 0.0000', 'accuracy': '11.33% -> 0.00%'},          
    200: {'loss': '5.2488 -> 0.0000', 'accuracy': '11.40% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_0.5 achieved 10.0%(11.02%) at epoch: 53                                  
Convergence (test_after):                                                      
FedBN_0.5 achieved 10.0%(10.15%) at epoch: 22                                  
FedBN_0.5 achieved 20.0%(20.43%) at epoch: 174                                 
