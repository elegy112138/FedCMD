==================== ALGORITHM: FedFomo_0.5 ====================               
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.4817 -> 4.3132   acc: 3.61% -> 3.28%               
client [81] (test)  loss: 4.5266 -> 4.4185   acc: 7.89% -> 10.53%              
client [21] (test)  loss: 25.5893 -> 4.4357   acc: 0.00% -> 7.67%              
client [68] (test)  loss: 4.4633 -> 4.1629   acc: 13.68% -> 13.68%             
client [93] (test)  loss: 4.5389 -> 4.3167   acc: 2.28% -> 6.19%               
client [31] (test)  loss: 4.5323 -> 4.3915   acc: 2.91% -> 6.18%               
client [20] (test)  loss: 4.5313 -> 4.4549   acc: 1.03% -> 3.79%               
client [59] (test)  loss: 30.0531 -> 4.5417   acc: 0.65% -> 3.24%              
client [48] (test)  loss: 4.5272 -> 4.4510   acc: 6.56% -> 5.57%               
client [34] (test)  loss: 4.5744 -> 4.5318   acc: 2.21% -> 2.21%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.3019 -> 4.0430   acc: 7.19% -> 8.63%               
client [99] (test)  loss: 4.5428 -> 4.4012   acc: 5.45% -> 5.77%               
client [67] (test)  loss: 4.5586 -> 4.4609   acc: 2.93% -> 3.58%               
client [0] (test)  loss: 4.0820 -> 3.9230   acc: 14.67% -> 15.00%              
client [76] (test)  loss: 4.5268 -> 4.4429   acc: 3.03% -> 3.79%               
client [41] (test)  loss: 4.5208 -> 4.1742   acc: 3.99% -> 7.64%               
client [62] (test)  loss: 27.4300 -> 4.5163   acc: 2.64% -> 3.63%              
client [2] (test)  loss: 31.8165 -> 4.5458   acc: 0.66% -> 3.31%               
client [14] (test)  loss: 4.1392 -> 4.0724   acc: 9.27% -> 9.90%               
client [46] (test)  loss: 4.2720 -> 4.2244   acc: 9.30% -> 9.97%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.2625 -> 4.1500   acc: 6.60% -> 6.94%               
client [68] (test)  loss: 3.9066 -> 3.8857   acc: 13.98% -> 14.59%             
client [57] (test)  loss: 4.4695 -> 4.2859   acc: 10.36% -> 10.03%             
client [17] (test)  loss: 3.9587 -> 3.8601   acc: 14.33% -> 14.33%             
client [54] (test)  loss: 3.9373 -> 3.8937   acc: 12.86% -> 12.86%             
client [23] (test)  loss: 27.9613 -> 4.5649   acc: 2.00% -> 3.67%              
client [35] (test)  loss: 4.2748 -> 4.1467   acc: 6.56% -> 7.54%               
client [59] (test)  loss: 4.2534 -> 4.1032   acc: 3.56% -> 5.83%               
client [31] (test)  loss: 4.0628 -> 4.0483   acc: 13.82% -> 14.91%             
client [9] (test)  loss: 4.4580 -> 4.3655   acc: 4.89% -> 3.91%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.8276 -> 3.7848   acc: 11.96% -> 11.63%             
client [33] (test)  loss: 4.0186 -> 4.0658   acc: 5.46% -> 5.46%               
client [16] (test)  loss: 3.7100 -> 3.6087   acc: 22.89% -> 22.89%             
client [44] (test)  loss: 4.5360 -> 4.3287   acc: 5.61% -> 7.26%               
client [8] (test)  loss: 3.9369 -> 3.9473   acc: 9.52% -> 9.52%                
client [31] (test)  loss: 4.0403 -> 4.0172   acc: 15.27% -> 15.27%             
client [47] (test)  loss: 4.2022 -> 4.1302   acc: 8.75% -> 9.06%               
client [36] (test)  loss: 4.5396 -> 4.3593   acc: 7.92% -> 7.92%               
client [20] (test)  loss: 4.1349 -> 4.1169   acc: 9.66% -> 9.31%               
client [56] (test)  loss: 4.5106 -> 4.4447   acc: 3.15% -> 3.15%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.1317 -> 4.0534   acc: 5.49% -> 6.59%                
client [60] (test)  loss: 4.5527 -> 4.4945   acc: 4.81% -> 8.89%               
client [28] (test)  loss: 4.0663 -> 4.0441   acc: 9.68% -> 10.97%              
client [25] (test)  loss: 3.9511 -> 3.8371   acc: 8.74% -> 11.65%              
client [58] (test)  loss: 3.9775 -> 3.9603   acc: 11.32% -> 12.89%             
client [44] (test)  loss: 4.3287 -> 4.2024   acc: 7.26% -> 8.91%               
client [39] (test)  loss: 4.4049 -> 4.3233   acc: 4.29% -> 4.95%               
client [29] (test)  loss: 3.6378 -> 3.6084   acc: 16.28% -> 15.95%             
client [3] (test)  loss: 3.7835 -> 3.7143   acc: 16.83% -> 18.12%              
client [84] (test)  loss: 4.2294 -> 4.2162   acc: 4.98% -> 4.98%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.1370 -> 4.0713   acc: 9.76% -> 9.76%               
client [84] (test)  loss: 4.2149 -> 4.2131   acc: 7.17% -> 7.17%               
client [10] (test)  loss: 3.7620 -> 3.7429   acc: 9.51% -> 9.51%               
client [36] (test)  loss: 4.6836 -> 4.2884   acc: 1.25% -> 7.92%               
client [65] (test)  loss: 3.7610 -> 3.7165   acc: 13.27% -> 14.24%             
client [81] (test)  loss: 3.9957 -> 4.0277   acc: 11.51% -> 8.55%              
client [79] (test)  loss: 4.1320 -> 4.0603   acc: 8.64% -> 10.96%              
client [42] (test)  loss: 4.0430 -> 4.0380   acc: 10.20% -> 11.22%             
client [11] (test)  loss: 4.2164 -> 4.0681   acc: 9.82% -> 9.12%               
client [96] (test)  loss: 4.2604 -> 4.1542   acc: 6.47% -> 8.41%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.8601 -> 3.8106   acc: 10.79% -> 11.75%              
client [53] (test)  loss: 3.8590 -> 3.8504   acc: 8.55% -> 9.54%               
client [52] (test)  loss: 3.8346 -> 3.8011   acc: 12.62% -> 13.92%             
client [42] (test)  loss: 3.9172 -> 4.0384   acc: 10.88% -> 10.20%             
client [69] (test)  loss: 3.7483 -> 3.8000   acc: 19.06% -> 18.71%             
client [59] (test)  loss: 3.9066 -> 3.8800   acc: 10.03% -> 9.39%              
client [7] (test)  loss: 4.0441 -> 4.0399   acc: 8.63% -> 8.95%                
client [26] (test)  loss: 3.8980 -> 3.8848   acc: 16.94% -> 17.28%             
client [49] (test)  loss: 4.2387 -> 4.2687   acc: 8.87% -> 9.68%               
client [98] (test)  loss: 4.0530 -> 4.0424   acc: 4.56% -> 5.54%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.0424 -> 4.0483   acc: 5.54% -> 6.84%               
client [47] (test)  loss: 4.0919 -> 4.0633   acc: 10.31% -> 11.88%             
client [21] (test)  loss: 4.0108 -> 3.9798   acc: 9.41% -> 9.06%               
client [77] (test)  loss: 4.0370 -> 3.9803   acc: 7.54% -> 9.84%               
client [95] (test)  loss: 3.9740 -> 3.9841   acc: 14.19% -> 12.21%             
client [91] (test)  loss: 3.7482 -> 3.7250   acc: 13.46% -> 14.42%             
client [14] (test)  loss: 4.1954 -> 4.0169   acc: 11.82% -> 14.38%             
client [99] (test)  loss: 4.1809 -> 4.1800   acc: 8.01% -> 8.33%               
client [20] (test)  loss: 4.0410 -> 4.1125   acc: 10.34% -> 10.34%             
client [39] (test)  loss: 4.2434 -> 4.2239   acc: 6.60% -> 7.59%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.8011 -> 3.7851   acc: 13.92% -> 12.94%             
client [62] (test)  loss: 3.9049 -> 3.8799   acc: 11.88% -> 13.53%             
client [71] (test)  loss: 4.2389 -> 4.2427   acc: 12.50% -> 13.51%             
client [97] (test)  loss: 3.6186 -> 3.5915   acc: 17.03% -> 16.72%             
client [30] (test)  loss: 4.0253 -> 4.0091   acc: 13.67% -> 13.67%             
client [88] (test)  loss: 4.1375 -> 4.0438   acc: 2.13% -> 4.26%               
client [60] (test)  loss: 4.2069 -> 4.2090   acc: 10.37% -> 11.85%             
client [82] (test)  loss: 4.0178 -> 3.9871   acc: 8.19% -> 8.87%               
client [91] (test)  loss: 3.7052 -> 3.7165   acc: 15.38% -> 16.03%             
client [57] (test)  loss: 3.9482 -> 3.9029   acc: 11.33% -> 12.94%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.1342 -> 4.2229   acc: 15.27% -> 14.55%             
client [15] (test)  loss: 3.7554 -> 3.7239   acc: 18.81% -> 19.14%             
client [71] (test)  loss: 4.2427 -> 4.2509   acc: 13.51% -> 14.19%             
client [97] (test)  loss: 3.5580 -> 3.5091   acc: 17.34% -> 18.89%             
client [53] (test)  loss: 3.8488 -> 3.8470   acc: 11.18% -> 12.17%             
client [77] (test)  loss: 3.9803 -> 3.9424   acc: 9.84% -> 10.49%              
client [76] (test)  loss: 4.3746 -> 4.3879   acc: 6.06% -> 6.06%               
client [79] (test)  loss: 3.9891 -> 3.9822   acc: 12.62% -> 14.62%             
client [28] (test)  loss: 4.1060 -> 4.1149   acc: 13.23% -> 12.26%             
client [99] (test)  loss: 4.1706 -> 4.1712   acc: 9.29% -> 9.94%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.4725 -> 3.4965   acc: 20.43% -> 21.05%             
client [86] (test)  loss: 3.9730 -> 3.9584   acc: 12.01% -> 12.34%             
client [34] (test)  loss: 3.9561 -> 3.9956   acc: 14.76% -> 15.13%             
client [73] (test)  loss: 3.8840 -> 3.8781   acc: 14.56% -> 14.89%             
client [5] (test)  loss: 4.0952 -> 4.1164   acc: 14.57% -> 13.91%              
client [96] (test)  loss: 3.8583 -> 3.8514   acc: 11.65% -> 11.00%             
client [22] (test)  loss: 3.9345 -> 3.9406   acc: 10.60% -> 10.60%             
client [60] (test)  loss: 4.2430 -> 4.3018   acc: 10.00% -> 9.63%              
client [66] (test)  loss: 3.8865 -> 3.8790   acc: 9.63% -> 9.97%               
client [83] (test)  loss: 4.1582 -> 4.1392   acc: 8.53% -> 10.24%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.4452 -> 4.4677   acc: 6.44% -> 7.58%               
client [65] (test)  loss: 3.6591 -> 3.6392   acc: 19.42% -> 19.42%             
client [95] (test)  loss: 3.9782 -> 4.4696   acc: 11.88% -> 11.55%             
client [17] (test)  loss: 3.7914 -> 3.7842   acc: 14.91% -> 15.20%             
client [8] (test)  loss: 3.7809 -> 3.7863   acc: 15.56% -> 13.97%              
client [35] (test)  loss: 3.9366 -> 3.9085   acc: 11.15% -> 10.16%             
client [98] (test)  loss: 4.1112 -> 4.0612   acc: 7.82% -> 7.82%               
client [53] (test)  loss: 3.8578 -> 3.8781   acc: 13.82% -> 13.82%             
client [43] (test)  loss: 3.9261 -> 3.9228   acc: 7.26% -> 9.57%               
client [64] (test)  loss: 3.7186 -> 3.6934   acc: 11.30% -> 13.62%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.9508 -> 3.9279   acc: 10.10% -> 10.10%             
client [88] (test)  loss: 3.8439 -> 3.8133   acc: 12.77% -> 14.54%             
client [38] (test)  loss: 3.3050 -> 3.2721   acc: 21.64% -> 23.28%             
client [3] (test)  loss: 4.1535 -> 3.5542   acc: 19.42% -> 24.60%              
client [5] (test)  loss: 4.1489 -> 4.1543   acc: 13.25% -> 12.91%              
client [41] (test)  loss: 3.9077 -> 3.8639   acc: 10.63% -> 10.96%             
client [7] (test)  loss: 4.0269 -> 4.0108   acc: 9.58% -> 8.63%                
client [37] (test)  loss: 4.0469 -> 4.0004   acc: 9.57% -> 10.56%              
client [45] (test)  loss: 3.6563 -> 3.5629   acc: 15.61% -> 12.96%             
client [47] (test)  loss: 4.0083 -> 3.9894   acc: 11.56% -> 11.88%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.3365 -> 3.2851   acc: 27.11% -> 25.26%             
client [11] (test)  loss: 3.9503 -> 3.9980   acc: 13.68% -> 15.79%             
client [37] (test)  loss: 3.8884 -> 3.8643   acc: 12.87% -> 12.87%             
client [41] (test)  loss: 3.8639 -> 4.0639   acc: 10.96% -> 10.30%             
client [95] (test)  loss: 4.4452 -> 6.0611   acc: 12.21% -> 11.88%             
client [53] (test)  loss: 3.8781 -> 3.9611   acc: 13.82% -> 13.16%             
client [22] (test)  loss: 3.9497 -> 3.9532   acc: 11.59% -> 12.58%             
client [25] (test)  loss: 3.6320 -> 3.5936   acc: 14.56% -> 14.56%             
client [69] (test)  loss: 3.8994 -> 4.2011   acc: 21.58% -> 19.42%             
client [46] (test)  loss: 4.1824 -> 4.1929   acc: 10.96% -> 11.96%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.9527 -> 3.9566   acc: 14.37% -> 14.06%             
client [69] (test)  loss: 4.1584 -> 4.1395   acc: 21.22% -> 20.14%             
client [82] (test)  loss: 3.9094 -> 3.9331   acc: 9.56% -> 10.24%              
client [45] (test)  loss: 3.5771 -> 3.5086   acc: 14.29% -> 17.28%             
client [7] (test)  loss: 4.0108 -> 4.0020   acc: 8.63% -> 9.27%                
client [50] (test)  loss: 4.0677 -> 4.0256   acc: 9.63% -> 9.63%               
client [35] (test)  loss: 3.9535 -> 4.0048   acc: 9.18% -> 8.85%               
client [24] (test)  loss: 4.0918 -> 4.1144   acc: 13.19% -> 11.81%             
client [15] (test)  loss: 3.6644 -> 3.6454   acc: 15.18% -> 15.51%             
client [58] (test)  loss: 4.4634 -> 4.7798   acc: 12.89% -> 11.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.3299 -> 4.4120   acc: 13.11% -> 12.46%             
client [76] (test)  loss: 4.4908 -> 4.6131   acc: 6.82% -> 6.82%               
client [67] (test)  loss: 3.8374 -> 3.8407   acc: 17.92% -> 17.59%             
client [37] (test)  loss: 3.8936 -> 4.1442   acc: 13.53% -> 10.23%             
client [58] (test)  loss: 4.4195 -> 4.6733   acc: 14.15% -> 14.78%             
client [64] (test)  loss: 3.6345 -> 3.6503   acc: 15.61% -> 15.61%             
client [77] (test)  loss: 3.9601 -> 4.0115   acc: 12.13% -> 12.79%             
client [55] (test)  loss: 4.4387 -> 4.2956   acc: 8.16% -> 8.51%               
client [12] (test)  loss: 4.1639 -> 4.1357   acc: 9.97% -> 10.63%              
client [89] (test)  loss: 4.4941 -> 4.3814   acc: 11.25% -> 14.47%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.2996 -> 4.3784   acc: 14.95% -> 16.20%             
client [51] (test)  loss: 4.1399 -> 4.2033   acc: 14.62% -> 14.29%             
client [8] (test)  loss: 4.0134 -> 4.2446   acc: 16.83% -> 13.33%              
client [18] (test)  loss: 4.0175 -> 3.9691   acc: 18.03% -> 19.34%             
client [94] (test)  loss: 3.9142 -> 3.9277   acc: 17.31% -> 17.67%             
client [81] (test)  loss: 3.9653 -> 4.4329   acc: 17.76% -> 16.12%             
client [3] (test)  loss: 3.8108 -> 3.9271   acc: 19.74% -> 18.77%              
client [11] (test)  loss: 4.0608 -> 4.2139   acc: 16.84% -> 14.04%             
client [95] (test)  loss: 5.6493 -> 4.9122   acc: 7.59% -> 11.88%              
client [67] (test)  loss: 3.8407 -> 3.8206   acc: 17.59% -> 16.61%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.8763 -> 3.9614   acc: 11.85% -> 8.71%              
client [79] (test)  loss: 4.1929 -> 4.1976   acc: 14.29% -> 15.95%             
client [58] (test)  loss: 4.8660 -> 4.9839   acc: 13.84% -> 14.47%             
client [88] (test)  loss: 3.7878 -> 3.9173   acc: 14.54% -> 14.18%             
client [46] (test)  loss: 4.1401 -> 4.2626   acc: 15.61% -> 13.29%             
client [11] (test)  loss: 4.2139 -> 4.2388   acc: 14.04% -> 13.68%             
client [55] (test)  loss: 4.6197 -> 4.9368   acc: 10.64% -> 9.93%              
client [13] (test)  loss: 4.3569 -> 4.4223   acc: 12.89% -> 12.54%             
client [31] (test)  loss: 4.4127 -> 4.7588   acc: 14.55% -> 10.55%             
client [75] (test)  loss: 4.3161 -> 4.2595   acc: 10.15% -> 11.94%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.2743 -> 4.5316   acc: 13.68% -> 11.73%             
client [7] (test)  loss: 4.1384 -> 4.1764   acc: 10.86% -> 12.14%              
client [57] (test)  loss: 3.8050 -> 3.8273   acc: 14.56% -> 14.24%             
client [13] (test)  loss: 4.4837 -> 4.6118   acc: 11.85% -> 11.85%             
client [43] (test)  loss: 4.0176 -> 4.0540   acc: 8.58% -> 9.57%               
client [91] (test)  loss: 3.7665 -> 3.7233   acc: 20.19% -> 22.44%             
client [10] (test)  loss: 3.8359 -> 3.9813   acc: 15.08% -> 15.08%             
client [64] (test)  loss: 3.8518 -> 3.8994   acc: 19.60% -> 22.26%             
client [82] (test)  loss: 3.9892 -> 4.0527   acc: 11.95% -> 14.33%             
client [22] (test)  loss: 4.0660 -> 4.0895   acc: 12.58% -> 13.25%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.0547 -> 4.0833   acc: 13.45% -> 13.10%             
client [23] (test)  loss: 4.1369 -> 4.1178   acc: 9.00% -> 9.00%               
client [88] (test)  loss: 3.9173 -> 3.8818   acc: 14.18% -> 16.31%             
client [98] (test)  loss: 4.4466 -> 4.3998   acc: 7.49% -> 7.49%               
client [79] (test)  loss: 4.2389 -> 4.5531   acc: 15.95% -> 14.29%             
client [21] (test)  loss: 3.8302 -> 3.8535   acc: 14.29% -> 11.15%             
client [92] (test)  loss: 4.5862 -> 4.4336   acc: 12.67% -> 15.00%             
client [56] (test)  loss: 4.7485 -> 4.8474   acc: 8.04% -> 8.04%               
client [5] (test)  loss: 4.6370 -> 4.8334   acc: 11.59% -> 11.26%              
client [52] (test)  loss: 4.0384 -> 4.0937   acc: 14.56% -> 12.94%             
==================== FedFomo_0.5 TEST RESULTS: ====================            
{                                                                              
    100: {'loss': '3.9653 -> 0.0000', 'accuracy': '12.09% -> 0.00%'},          
    200: {'loss': '4.2638 -> 0.0000', 'accuracy': '14.01% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_0.5 achieved 10.0%(10.39%) at epoch: 39                                
Convergence (test_after):                                                      
FedFomo_0.5 achieved 10.0%(10.52%) at epoch: 39                                
