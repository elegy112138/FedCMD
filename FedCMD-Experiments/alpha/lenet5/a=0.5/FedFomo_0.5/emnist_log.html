==================== ALGORITHM: FedFomo_0.5 ====================               
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.1011 -> 0.8894   acc: 70.53% -> 75.09%             
client [81] (test)  loss: 0.7497 -> 0.6122   acc: 79.24% -> 82.24%             
client [21] (test)  loss: 29.6759 -> 0.6100   acc: 0.05% -> 85.29%             
client [68] (test)  loss: 0.4249 -> 0.2224   acc: 88.55% -> 93.70%             
client [93] (test)  loss: 1.2170 -> 0.7775   acc: 70.86% -> 81.45%             
client [31] (test)  loss: 1.6477 -> 1.0553   acc: 58.74% -> 70.58%             
client [20] (test)  loss: 1.2227 -> 0.9805   acc: 69.08% -> 73.99%             
client [59] (test)  loss: 27.1993 -> 1.3039   acc: 0.11% -> 64.30%             
client [48] (test)  loss: 0.7461 -> 0.6762   acc: 77.33% -> 78.81%             
client [34] (test)  loss: 1.5901 -> 0.9819   acc: 63.98% -> 76.47%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.5875 -> 0.4395   acc: 85.35% -> 88.66%             
client [99] (test)  loss: 1.4793 -> 1.0184   acc: 67.92% -> 74.30%             
client [67] (test)  loss: 1.4427 -> 0.9487   acc: 64.67% -> 73.80%             
client [0] (test)  loss: 0.6290 -> 0.4703   acc: 84.09% -> 87.69%              
client [76] (test)  loss: 1.0596 -> 0.8408   acc: 72.17% -> 77.29%             
client [41] (test)  loss: 2.4363 -> 1.7337   acc: 39.13% -> 57.30%             
client [62] (test)  loss: 28.1433 -> 2.1605   acc: 0.59% -> 53.10%             
client [2] (test)  loss: 23.6933 -> 0.9910   acc: 0.02% -> 71.13%              
client [14] (test)  loss: 0.6710 -> 0.5877   acc: 84.20% -> 85.83%             
client [46] (test)  loss: 0.8093 -> 0.7044   acc: 77.53% -> 80.16%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.5034 -> 0.4423   acc: 86.74% -> 88.10%             
client [68] (test)  loss: 0.1333 -> 0.1278   acc: 96.53% -> 96.58%             
client [57] (test)  loss: 0.7061 -> 0.5435   acc: 81.95% -> 85.51%             
client [17] (test)  loss: 0.3628 -> 0.3071   acc: 90.48% -> 91.53%             
client [54] (test)  loss: 0.6693 -> 0.6504   acc: 81.14% -> 82.10%             
client [23] (test)  loss: 33.1438 -> 1.4628   acc: 0.17% -> 60.79%             
client [35] (test)  loss: 0.8309 -> 0.7853   acc: 77.27% -> 78.47%             
client [59] (test)  loss: 0.7547 -> 0.6718   acc: 76.14% -> 77.38%             
client [31] (test)  loss: 0.6197 -> 0.6017   acc: 80.63% -> 81.07%             
client [9] (test)  loss: 1.3241 -> 1.1444   acc: 62.54% -> 66.19%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.8162 -> 0.7698   acc: 74.69% -> 75.48%             
client [33] (test)  loss: 0.8111 -> 0.8284   acc: 75.43% -> 75.72%             
client [16] (test)  loss: 0.6251 -> 0.5462   acc: 82.18% -> 83.73%             
client [44] (test)  loss: 2.4296 -> 1.5522   acc: 41.87% -> 57.28%             
client [8] (test)  loss: 0.8434 -> 0.8299   acc: 75.40% -> 75.71%              
client [31] (test)  loss: 0.5997 -> 0.6051   acc: 81.34% -> 81.44%             
client [47] (test)  loss: 0.6364 -> 0.5461   acc: 80.37% -> 82.94%             
client [36] (test)  loss: 1.6130 -> 1.0638   acc: 57.48% -> 69.74%             
client [20] (test)  loss: 0.7319 -> 0.7318   acc: 79.58% -> 79.44%             
client [56] (test)  loss: 1.1140 -> 0.8907   acc: 71.66% -> 76.25%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5339 -> 0.4913   acc: 85.41% -> 86.63%              
client [60] (test)  loss: 0.8146 -> 0.6322   acc: 79.38% -> 83.86%             
client [28] (test)  loss: 0.7143 -> 0.7095   acc: 79.27% -> 79.44%             
client [25] (test)  loss: 0.0294 -> 0.0261   acc: 99.16% -> 99.30%             
client [58] (test)  loss: 0.2874 -> 0.2849   acc: 92.56% -> 92.49%             
client [44] (test)  loss: 1.5522 -> 1.2237   acc: 57.28% -> 63.72%             
client [39] (test)  loss: 0.7590 -> 0.6492   acc: 78.98% -> 82.10%             
client [29] (test)  loss: 1.1615 -> 1.0879   acc: 65.38% -> 66.93%             
client [3] (test)  loss: 0.5959 -> 0.5440   acc: 84.62% -> 85.79%              
client [84] (test)  loss: 0.4545 -> 0.4489   acc: 87.70% -> 88.05%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3207 -> 0.2764   acc: 90.87% -> 91.93%             
client [84] (test)  loss: 0.4553 -> 0.4628   acc: 88.12% -> 88.29%             
client [10] (test)  loss: 0.7988 -> 0.7775   acc: 77.13% -> 78.05%             
client [36] (test)  loss: 0.7467 -> 0.6816   acc: 77.99% -> 80.07%             
client [65] (test)  loss: 0.8087 -> 0.8199   acc: 77.06% -> 77.13%             
client [81] (test)  loss: 0.5084 -> 0.5031   acc: 82.72% -> 82.81%             
client [79] (test)  loss: 0.7561 -> 0.7119   acc: 80.95% -> 81.49%             
client [42] (test)  loss: 0.3920 -> 0.3873   acc: 89.11% -> 89.58%             
client [11] (test)  loss: 0.6641 -> 0.6369   acc: 83.14% -> 83.95%             
client [96] (test)  loss: 0.6358 -> 0.6170   acc: 81.77% -> 82.25%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8350 -> 0.8509   acc: 75.61% -> 75.80%              
client [53] (test)  loss: 0.8471 -> 0.7877   acc: 76.16% -> 77.47%             
client [52] (test)  loss: 0.7897 -> 0.7799   acc: 76.76% -> 77.18%             
client [42] (test)  loss: 0.3851 -> 0.3851   acc: 89.77% -> 89.89%             
client [69] (test)  loss: 0.3188 -> 0.3276   acc: 92.46% -> 92.57%             
client [59] (test)  loss: 0.6059 -> 0.6048   acc: 79.90% -> 80.06%             
client [7] (test)  loss: 0.5810 -> 0.5865   acc: 81.40% -> 81.77%              
client [26] (test)  loss: 0.3559 -> 0.3375   acc: 87.95% -> 88.61%             
client [49] (test)  loss: 0.2576 -> 0.2450   acc: 92.79% -> 93.21%             
client [98] (test)  loss: 0.2718 -> 0.2753   acc: 92.41% -> 92.63%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2753 -> 0.2771   acc: 92.63% -> 92.66%             
client [47] (test)  loss: 0.4997 -> 0.4782   acc: 83.97% -> 84.50%             
client [21] (test)  loss: 0.2495 -> 0.2336   acc: 92.51% -> 92.88%             
client [77] (test)  loss: 0.7041 -> 0.7153   acc: 78.23% -> 78.51%             
client [95] (test)  loss: 0.1359 -> 0.1362   acc: 96.40% -> 96.37%             
client [91] (test)  loss: 0.6677 -> 0.6841   acc: 81.29% -> 81.42%             
client [14] (test)  loss: 0.4836 -> 0.4876   acc: 87.86% -> 87.91%             
client [99] (test)  loss: 0.6175 -> 0.6016   acc: 83.90% -> 84.44%             
client [20] (test)  loss: 0.7911 -> 0.8176   acc: 79.31% -> 79.17%             
client [39] (test)  loss: 0.5707 -> 0.5649   acc: 83.61% -> 83.85%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7799 -> 0.7933   acc: 77.18% -> 77.33%             
client [62] (test)  loss: 0.9002 -> 0.9407   acc: 76.33% -> 75.69%             
client [71] (test)  loss: 0.7660 -> 0.7772   acc: 77.22% -> 76.93%             
client [97] (test)  loss: 0.2814 -> 0.2783   acc: 91.85% -> 92.18%             
client [30] (test)  loss: 0.4622 -> 0.4732   acc: 87.88% -> 88.24%             
client [88] (test)  loss: 0.5514 -> 0.5289   acc: 81.84% -> 82.59%             
client [60] (test)  loss: 0.5106 -> 0.5201   acc: 86.51% -> 86.85%             
client [82] (test)  loss: 0.6394 -> 0.6513   acc: 81.29% -> 81.34%             
client [91] (test)  loss: 0.7024 -> 0.7270   acc: 81.24% -> 81.33%             
client [57] (test)  loss: 0.4023 -> 0.3909   acc: 88.30% -> 88.60%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9069 -> 0.9469   acc: 81.10% -> 81.02%             
client [15] (test)  loss: 0.8248 -> 0.8219   acc: 76.23% -> 76.61%             
client [71] (test)  loss: 0.7772 -> 0.7965   acc: 76.93% -> 76.76%             
client [97] (test)  loss: 0.2840 -> 0.2922   acc: 92.25% -> 92.18%             
client [53] (test)  loss: 0.7588 -> 0.7732   acc: 78.70% -> 78.77%             
client [77] (test)  loss: 0.7153 -> 0.7312   acc: 78.51% -> 78.32%             
client [76] (test)  loss: 0.6753 -> 0.6988   acc: 80.59% -> 80.64%             
client [79] (test)  loss: 0.6748 -> 0.6688   acc: 82.89% -> 83.01%             
client [28] (test)  loss: 0.8749 -> 0.9107   acc: 79.34% -> 78.98%             
client [99] (test)  loss: 0.6004 -> 0.6044   acc: 84.46% -> 84.71%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3013 -> 0.3099   acc: 92.16% -> 92.06%             
client [86] (test)  loss: 0.5180 -> 0.5261   acc: 86.81% -> 87.03%             
client [34] (test)  loss: 0.7793 -> 0.8059   acc: 83.11% -> 83.11%             
client [73] (test)  loss: 0.9004 -> 0.9223   acc: 74.98% -> 74.78%             
client [5] (test)  loss: 0.7532 -> 0.7806   acc: 80.13% -> 79.85%              
client [96] (test)  loss: 0.7001 -> 0.7284   acc: 82.27% -> 82.01%             
client [22] (test)  loss: 0.9054 -> 0.9108   acc: 74.23% -> 74.60%             
client [60] (test)  loss: 0.5597 -> 0.5788   acc: 86.63% -> 86.65%             
client [66] (test)  loss: 0.5568 -> 0.5601   acc: 84.75% -> 84.65%             
client [83] (test)  loss: 0.2970 -> 0.3024   acc: 92.04% -> 91.92%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7943 -> 0.8295   acc: 79.85% -> 80.01%             
client [65] (test)  loss: 0.8691 -> 0.8981   acc: 76.61% -> 76.56%             
client [95] (test)  loss: 0.1391 -> 0.1400   acc: 96.44% -> 96.47%             
client [17] (test)  loss: 0.2454 -> 0.2444   acc: 93.50% -> 93.42%             
client [8] (test)  loss: 0.9203 -> 0.9504   acc: 76.30% -> 76.26%              
client [35] (test)  loss: 1.0537 -> 1.1002   acc: 77.83% -> 77.60%             
client [98] (test)  loss: 0.2882 -> 0.2964   acc: 92.78% -> 92.63%             
client [53] (test)  loss: 0.7963 -> 0.8213   acc: 78.82% -> 78.79%             
client [43] (test)  loss: 0.5310 -> 0.5395   acc: 88.04% -> 88.02%             
client [64] (test)  loss: 0.7082 -> 0.7245   acc: 77.95% -> 77.86%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2253 -> 0.2205   acc: 93.32% -> 93.39%             
client [88] (test)  loss: 0.5798 -> 0.5950   acc: 82.83% -> 82.64%             
client [38] (test)  loss: 0.2450 -> 0.2453   acc: 94.17% -> 94.27%             
client [3] (test)  loss: 0.6153 -> 0.6286   acc: 87.50% -> 87.48%              
client [5] (test)  loss: 0.8052 -> 0.8315   acc: 79.71% -> 79.43%              
client [41] (test)  loss: 0.9416 -> 0.9739   acc: 73.96% -> 73.69%             
client [7] (test)  loss: 0.6071 -> 0.6197   acc: 82.35% -> 82.39%              
client [37] (test)  loss: 0.6301 -> 0.6460   acc: 82.47% -> 82.47%             
client [45] (test)  loss: 0.8856 -> 0.8714   acc: 75.50% -> 75.89%             
client [47] (test)  loss: 0.4612 -> 0.4612   acc: 85.20% -> 85.35%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5260 -> 0.5363   acc: 87.49% -> 87.49%             
client [11] (test)  loss: 0.6904 -> 0.7099   acc: 84.93% -> 84.88%             
client [37] (test)  loss: 0.6852 -> 0.7073   acc: 82.66% -> 82.62%             
client [41] (test)  loss: 0.9739 -> 1.0064   acc: 73.69% -> 73.84%             
client [95] (test)  loss: 0.1426 -> 0.1435   acc: 96.49% -> 96.52%             
client [53] (test)  loss: 0.8213 -> 0.8525   acc: 78.79% -> 78.46%             
client [22] (test)  loss: 0.9137 -> 0.9372   acc: 75.00% -> 75.00%             
client [25] (test)  loss: 0.0228 -> 0.0228   acc: 99.41% -> 99.41%             
client [69] (test)  loss: 0.3864 -> 0.3922   acc: 92.31% -> 92.35%             
client [46] (test)  loss: 0.6584 -> 0.6831   acc: 82.58% -> 82.41%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5100 -> 0.5431   acc: 85.03% -> 84.96%             
client [69] (test)  loss: 0.3971 -> 0.4016   acc: 92.40% -> 92.40%             
client [82] (test)  loss: 0.7386 -> 0.7715   acc: 80.79% -> 80.54%             
client [45] (test)  loss: 0.8857 -> 0.9055   acc: 75.78% -> 75.64%             
client [7] (test)  loss: 0.6197 -> 0.6413   acc: 82.39% -> 82.22%              
client [50] (test)  loss: 0.5671 -> 0.5730   acc: 81.87% -> 81.87%             
client [35] (test)  loss: 1.2075 -> 1.2634   acc: 77.41% -> 77.39%             
client [24] (test)  loss: 0.4570 -> 0.4677   acc: 90.56% -> 90.41%             
client [15] (test)  loss: 0.8826 -> 0.9053   acc: 77.15% -> 77.32%             
client [58] (test)  loss: 0.3632 -> 0.3687   acc: 92.56% -> 92.68%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8028 -> 0.8389   acc: 79.84% -> 79.92%             
client [76] (test)  loss: 0.9016 -> 0.9421   acc: 80.04% -> 79.94%             
client [67] (test)  loss: 0.6140 -> 0.6188   acc: 83.61% -> 83.92%             
client [37] (test)  loss: 0.7315 -> 0.7573   acc: 82.53% -> 82.47%             
client [58] (test)  loss: 0.3746 -> 0.3801   acc: 92.71% -> 92.76%             
client [64] (test)  loss: 0.8129 -> 0.8484   acc: 76.83% -> 76.56%             
client [77] (test)  loss: 0.8533 -> 0.8935   acc: 77.68% -> 77.73%             
client [55] (test)  loss: 0.9501 -> 0.9671   acc: 76.35% -> 77.23%             
client [12] (test)  loss: 0.9954 -> 1.0404   acc: 77.51% -> 77.07%             
client [89] (test)  loss: 1.1987 -> 1.2399   acc: 75.90% -> 75.95%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7302 -> 0.7390   acc: 88.41% -> 88.44%             
client [51] (test)  loss: 0.5638 -> 0.5863   acc: 88.06% -> 87.96%             
client [8] (test)  loss: 1.1499 -> 1.1765   acc: 77.16% -> 77.47%              
client [18] (test)  loss: 0.8739 -> 0.9168   acc: 75.21% -> 74.87%             
client [94] (test)  loss: 0.8609 -> 0.8927   acc: 81.06% -> 81.06%             
client [81] (test)  loss: 0.7689 -> 0.7916   acc: 83.64% -> 83.51%             
client [3] (test)  loss: 0.6733 -> 0.6825   acc: 87.45% -> 87.38%              
client [11] (test)  loss: 0.7847 -> 0.8163   acc: 84.07% -> 83.66%             
client [95] (test)  loss: 0.1479 -> 0.1484   acc: 96.49% -> 96.49%             
client [67] (test)  loss: 0.6188 -> 0.6308   acc: 83.92% -> 83.92%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2181 -> 0.2175   acc: 93.22% -> 93.30%             
client [79] (test)  loss: 0.8227 -> 0.8374   acc: 82.69% -> 82.95%             
client [58] (test)  loss: 0.3949 -> 0.3993   acc: 92.81% -> 92.78%             
client [88] (test)  loss: 0.6675 -> 0.6868   acc: 82.42% -> 82.25%             
client [46] (test)  loss: 0.7495 -> 0.7698   acc: 82.13% -> 82.08%             
client [11] (test)  loss: 0.8163 -> 0.8330   acc: 83.66% -> 83.46%             
client [55] (test)  loss: 1.1234 -> 1.1707   acc: 78.05% -> 77.70%             
client [13] (test)  loss: 1.1740 -> 1.2109   acc: 74.62% -> 74.33%             
client [31] (test)  loss: 0.9835 -> 0.9790   acc: 80.76% -> 80.83%             
client [75] (test)  loss: 1.1269 -> 1.1670   acc: 76.78% -> 76.81%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4610 -> 0.4670   acc: 90.55% -> 90.65%             
client [7] (test)  loss: 0.7802 -> 0.8016   acc: 81.64% -> 81.79%              
client [57] (test)  loss: 0.4109 -> 0.4190   acc: 89.31% -> 89.28%             
client [13] (test)  loss: 1.2523 -> 1.2900   acc: 74.30% -> 74.41%             
client [43] (test)  loss: 0.6301 -> 0.6466   acc: 87.86% -> 87.78%             
client [91] (test)  loss: 0.8973 -> 0.9505   acc: 80.36% -> 80.20%             
client [10] (test)  loss: 1.0423 -> 1.0685   acc: 79.56% -> 79.62%             
client [64] (test)  loss: 1.0711 -> 1.1195   acc: 75.77% -> 75.72%             
client [82] (test)  loss: 0.9810 -> 0.9971   acc: 81.09% -> 81.27%             
client [22] (test)  loss: 1.1222 -> 1.1727   acc: 74.09% -> 73.69%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9988 -> 1.0214   acc: 79.29% -> 79.24%             
client [23] (test)  loss: 0.5979 -> 0.6094   acc: 81.97% -> 82.14%             
client [88] (test)  loss: 0.6868 -> 0.7433   acc: 82.25% -> 82.45%             
client [98] (test)  loss: 0.3505 -> 0.3566   acc: 92.97% -> 92.95%             
client [79] (test)  loss: 0.8676 -> 0.8860   acc: 83.07% -> 83.19%             
client [21] (test)  loss: 0.2187 -> 0.2203   acc: 93.30% -> 93.27%             
client [92] (test)  loss: 0.7941 -> 0.8096   acc: 83.17% -> 83.30%             
client [56] (test)  loss: 1.0794 -> 1.0979   acc: 79.89% -> 79.89%             
client [5] (test)  loss: 1.0293 -> 1.0585   acc: 79.41% -> 79.24%              
client [52] (test)  loss: 1.1334 -> 1.1686   acc: 77.40% -> 77.38%             
==================== FedFomo_0.5 TEST RESULTS: ====================            
{                                                                              
    100: {'loss': '0.6028 -> 0.0000', 'accuracy': '83.75% -> 0.00%'},          
    200: {'loss': '0.8073 -> 0.0000', 'accuracy': '83.46% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_0.5 achieved 10.0%(12.44%) at epoch: 1                                 
FedFomo_0.5 achieved 20.0%(21.52%) at epoch: 2                                 
FedFomo_0.5 achieved 40.0%(42.34%) at epoch: 4                                 
FedFomo_0.5 achieved 50.0%(56.38%) at epoch: 7                                 
FedFomo_0.5 achieved 70.0%(73.56%) at epoch: 16                                
FedFomo_0.5 achieved 80.0%(81.48%) at epoch: 28                                
Convergence (test_after):                                                      
FedFomo_0.5 achieved 60.0%(62.50%) at epoch: 0                                 
FedFomo_0.5 achieved 70.0%(74.36%) at epoch: 7                                 
FedFomo_0.5 achieved 80.0%(80.11%) at epoch: 16                                
