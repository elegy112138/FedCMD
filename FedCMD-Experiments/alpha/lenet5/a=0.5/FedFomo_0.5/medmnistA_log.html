==================== ALGORITHM: FedFomo_0.5 ====================               
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'M': 5,                                                                    
    'valset_ratio': 0.2,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.3984 -> 1.2278   acc: 57.49% -> 58.45%             
client [81] (test)  loss: 0.5297 -> 0.3953   acc: 88.77% -> 90.75%             
client [21] (test)  loss: 2.3887 -> 2.0249   acc: 18.64% -> 37.97%             
client [68] (test)  loss: 1.3027 -> 1.1511   acc: 57.28% -> 56.96%             
client [93] (test)  loss: 1.0845 -> 0.9096   acc: 76.49% -> 82.09%             
client [31] (test)  loss: 1.5827 -> 1.3245   acc: 52.20% -> 52.20%             
client [20] (test)  loss: 1.7728 -> 1.6328   acc: 41.32% -> 41.32%             
client [59] (test)  loss: 1.9664 -> 0.8801   acc: 38.61% -> 67.66%             
client [48] (test)  loss: 1.1901 -> 1.0493   acc: 59.63% -> 69.52%             
client [34] (test)  loss: 1.6778 -> 1.3892   acc: 49.84% -> 50.16%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.4641 -> 1.3483   acc: 54.42% -> 56.13%             
client [99] (test)  loss: 1.6638 -> 1.2599   acc: 75.00% -> 77.42%             
client [67] (test)  loss: 1.7202 -> 1.2039   acc: 43.99% -> 62.66%             
client [0] (test)  loss: 0.9991 -> 0.9103   acc: 75.12% -> 75.12%              
client [76] (test)  loss: 1.3999 -> 1.2085   acc: 57.93% -> 60.00%             
client [41] (test)  loss: 1.3588 -> 1.2928   acc: 52.83% -> 53.07%             
client [62] (test)  loss: 2.3796 -> 0.8924   acc: 0.55% -> 70.88%              
client [2] (test)  loss: 2.4086 -> 2.2161   acc: 11.73% -> 28.57%              
client [14] (test)  loss: 1.5794 -> 1.4562   acc: 44.96% -> 45.74%             
client [46] (test)  loss: 1.6957 -> 1.5772   acc: 40.72% -> 46.11%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3462 -> 1.2761   acc: 51.79% -> 52.23%             
client [68] (test)  loss: 0.8922 -> 0.8270   acc: 74.11% -> 75.73%             
client [57] (test)  loss: 0.7946 -> 0.6752   acc: 75.27% -> 78.23%             
client [17] (test)  loss: 1.0793 -> 1.0213   acc: 63.57% -> 63.57%             
client [54] (test)  loss: 0.7121 -> 0.6848   acc: 80.00% -> 80.32%             
client [23] (test)  loss: 2.2528 -> 1.0539   acc: 1.52% -> 76.77%              
client [35] (test)  loss: 1.2032 -> 1.1255   acc: 58.72% -> 60.78%             
client [59] (test)  loss: 0.6575 -> 0.5918   acc: 81.52% -> 82.18%             
client [31] (test)  loss: 0.8132 -> 0.7604   acc: 79.32% -> 79.32%             
client [9] (test)  loss: 1.4057 -> 1.2643   acc: 43.33% -> 53.61%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.5154 -> 1.4004   acc: 39.53% -> 43.41%             
client [33] (test)  loss: 1.0780 -> 1.0399   acc: 63.49% -> 68.25%             
client [16] (test)  loss: 1.6184 -> 1.5255   acc: 46.09% -> 46.88%             
client [44] (test)  loss: 0.5629 -> 0.4954   acc: 83.02% -> 83.64%             
client [8] (test)  loss: 0.5267 -> 0.4790   acc: 85.68% -> 85.68%              
client [31] (test)  loss: 0.7172 -> 0.6815   acc: 79.32% -> 79.66%             
client [47] (test)  loss: 0.6015 -> 0.5364   acc: 82.45% -> 84.44%             
client [36] (test)  loss: 1.8194 -> 1.5171   acc: 43.61% -> 43.61%             
client [20] (test)  loss: 1.2389 -> 1.1791   acc: 60.33% -> 60.33%             
client [56] (test)  loss: 0.7609 -> 0.6720   acc: 79.31% -> 80.37%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.4629 -> 1.3649   acc: 53.28% -> 58.61%              
client [60] (test)  loss: 1.0780 -> 1.0096   acc: 57.92% -> 60.42%             
client [28] (test)  loss: 0.9724 -> 0.8869   acc: 77.78% -> 79.08%             
client [25] (test)  loss: 1.4045 -> 1.3308   acc: 63.08% -> 64.49%             
client [58] (test)  loss: 0.8597 -> 0.7850   acc: 70.68% -> 75.31%             
client [44] (test)  loss: 0.4954 -> 0.4551   acc: 83.64% -> 83.95%             
client [39] (test)  loss: 1.2472 -> 1.1740   acc: 59.75% -> 60.17%             
client [29] (test)  loss: 0.5709 -> 0.5327   acc: 79.87% -> 81.19%             
client [3] (test)  loss: 1.3130 -> 1.1879   acc: 58.25% -> 65.70%              
client [84] (test)  loss: 1.2344 -> 1.1729   acc: 57.65% -> 59.61%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.7960 -> 1.7141   acc: 38.64% -> 44.07%             
client [84] (test)  loss: 1.1306 -> 1.1061   acc: 60.26% -> 60.91%             
client [10] (test)  loss: 0.2852 -> 0.2687   acc: 88.96% -> 89.40%             
client [36] (test)  loss: 1.0831 -> 0.9126   acc: 63.55% -> 64.80%             
client [65] (test)  loss: 0.8331 -> 0.7899   acc: 70.73% -> 72.36%             
client [81] (test)  loss: 0.2730 -> 0.2672   acc: 92.29% -> 92.51%             
client [79] (test)  loss: 0.6634 -> 0.5734   acc: 71.54% -> 76.15%             
client [42] (test)  loss: 0.5392 -> 0.5277   acc: 83.94% -> 83.94%             
client [11] (test)  loss: 1.0016 -> 0.9093   acc: 64.94% -> 68.83%             
client [96] (test)  loss: 0.5128 -> 0.4953   acc: 87.12% -> 87.28%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4302 -> 0.4184   acc: 86.46% -> 86.46%              
client [53] (test)  loss: 1.0129 -> 0.9321   acc: 65.41% -> 67.44%             
client [52] (test)  loss: 0.8573 -> 0.7974   acc: 74.10% -> 77.38%             
client [42] (test)  loss: 0.5211 -> 0.5234   acc: 84.17% -> 84.40%             
client [69] (test)  loss: 0.8919 -> 0.8782   acc: 70.66% -> 70.66%             
client [59] (test)  loss: 0.4843 -> 0.4657   acc: 83.83% -> 83.83%             
client [7] (test)  loss: 0.5685 -> 0.5422   acc: 87.87% -> 88.20%              
client [26] (test)  loss: 0.4627 -> 0.4357   acc: 86.40% -> 87.31%             
client [49] (test)  loss: 1.3250 -> 1.2844   acc: 45.96% -> 47.23%             
client [98] (test)  loss: 1.0775 -> 1.0455   acc: 64.33% -> 64.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.0455 -> 1.0172   acc: 64.62% -> 64.62%             
client [47] (test)  loss: 0.4872 -> 0.4504   acc: 86.42% -> 86.42%             
client [21] (test)  loss: 1.6240 -> 1.5332   acc: 47.80% -> 48.47%             
client [77] (test)  loss: 0.7649 -> 0.7372   acc: 74.40% -> 74.88%             
client [95] (test)  loss: 0.5668 -> 0.5478   acc: 79.78% -> 81.62%             
client [91] (test)  loss: 1.0140 -> 0.9591   acc: 63.88% -> 65.20%             
client [14] (test)  loss: 1.0317 -> 0.9741   acc: 68.99% -> 71.32%             
client [99] (test)  loss: 0.9285 -> 0.9003   acc: 76.61% -> 76.61%             
client [20] (test)  loss: 1.0638 -> 1.0481   acc: 64.46% -> 65.29%             
client [39] (test)  loss: 1.0743 -> 1.0359   acc: 63.14% -> 65.25%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7974 -> 0.7583   acc: 77.38% -> 76.72%             
client [62] (test)  loss: 0.3718 -> 0.3636   acc: 87.91% -> 88.19%             
client [71] (test)  loss: 0.7912 -> 0.7729   acc: 75.26% -> 74.74%             
client [97] (test)  loss: 0.5956 -> 0.5793   acc: 81.60% -> 82.78%             
client [30] (test)  loss: 0.6707 -> 0.6501   acc: 75.00% -> 75.00%             
client [88] (test)  loss: 0.9109 -> 0.8621   acc: 77.42% -> 77.88%             
client [60] (test)  loss: 0.7344 -> 0.6989   acc: 80.00% -> 80.00%             
client [82] (test)  loss: 1.3410 -> 1.2960   acc: 52.32% -> 55.96%             
client [91] (test)  loss: 0.9071 -> 0.8589   acc: 66.96% -> 67.84%             
client [57] (test)  loss: 0.5337 -> 0.5133   acc: 80.65% -> 80.65%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5455 -> 0.5505   acc: 82.03% -> 81.69%             
client [15] (test)  loss: 0.4826 -> 0.4543   acc: 86.06% -> 87.17%             
client [71] (test)  loss: 0.7729 -> 0.7561   acc: 74.74% -> 75.77%             
client [97] (test)  loss: 0.5589 -> 0.5515   acc: 83.73% -> 84.43%             
client [53] (test)  loss: 0.7741 -> 0.7479   acc: 75.87% -> 76.74%             
client [77] (test)  loss: 0.7372 -> 0.7159   acc: 74.88% -> 75.36%             
client [76] (test)  loss: 0.8356 -> 0.8057   acc: 74.48% -> 76.21%             
client [79] (test)  loss: 0.5062 -> 0.4899   acc: 80.00% -> 82.31%             
client [28] (test)  loss: 0.6981 -> 0.6856   acc: 80.39% -> 80.39%             
client [99] (test)  loss: 0.8772 -> 0.8577   acc: 76.61% -> 78.23%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5464 -> 0.5433   acc: 85.14% -> 85.61%             
client [86] (test)  loss: 1.0600 -> 1.0233   acc: 68.04% -> 68.56%             
client [34] (test)  loss: 0.7444 -> 0.7327   acc: 80.00% -> 80.66%             
client [73] (test)  loss: 0.1895 -> 0.1775   acc: 95.68% -> 95.92%             
client [5] (test)  loss: 0.7420 -> 0.7131   acc: 76.95% -> 80.30%              
client [96] (test)  loss: 0.4930 -> 0.5002   acc: 88.08% -> 87.76%             
client [22] (test)  loss: 0.7259 -> 0.7105   acc: 76.99% -> 77.41%             
client [60] (test)  loss: 0.6165 -> 0.5955   acc: 80.83% -> 81.25%             
client [66] (test)  loss: 0.8928 -> 0.8702   acc: 74.73% -> 76.34%             
client [83] (test)  loss: 0.2835 -> 0.2741   acc: 91.63% -> 92.61%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7454 -> 0.7318   acc: 79.31% -> 79.66%             
client [65] (test)  loss: 0.7392 -> 0.7244   acc: 76.83% -> 77.24%             
client [95] (test)  loss: 0.5082 -> 0.5001   acc: 82.72% -> 83.09%             
client [17] (test)  loss: 0.7946 -> 0.7576   acc: 75.84% -> 78.44%             
client [8] (test)  loss: 0.4054 -> 0.4054   acc: 86.98% -> 86.20%              
client [35] (test)  loss: 1.0604 -> 1.0851   acc: 69.04% -> 69.27%             
client [98] (test)  loss: 0.9690 -> 0.9558   acc: 67.84% -> 68.71%             
client [53] (test)  loss: 0.7316 -> 0.7252   acc: 77.62% -> 77.03%             
client [43] (test)  loss: 0.3177 -> 0.3120   acc: 92.17% -> 92.17%             
client [64] (test)  loss: 0.9543 -> 0.9071   acc: 68.60% -> 71.32%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.4511 -> 1.3807   acc: 48.81% -> 52.54%             
client [88] (test)  loss: 0.7104 -> 0.6970   acc: 77.88% -> 77.88%             
client [38] (test)  loss: 0.4661 -> 0.4648   acc: 87.10% -> 87.10%             
client [3] (test)  loss: 0.6339 -> 0.6229   acc: 81.23% -> 80.91%              
client [5] (test)  loss: 0.6900 -> 0.6740   acc: 81.41% -> 82.53%              
client [41] (test)  loss: 1.0530 -> 1.0551   acc: 66.51% -> 66.51%             
client [7] (test)  loss: 0.5147 -> 0.5072   acc: 88.52% -> 88.52%              
client [37] (test)  loss: 0.7397 -> 0.7248   acc: 81.65% -> 81.65%             
client [45] (test)  loss: 0.8319 -> 0.7601   acc: 65.55% -> 69.90%             
client [47] (test)  loss: 0.4067 -> 0.3914   acc: 87.75% -> 87.75%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9769 -> 0.9531   acc: 67.19% -> 69.92%             
client [11] (test)  loss: 0.7225 -> 0.7220   acc: 78.57% -> 78.79%             
client [37] (test)  loss: 0.7011 -> 0.6914   acc: 82.37% -> 82.37%             
client [41] (test)  loss: 1.0551 -> 1.0624   acc: 66.51% -> 67.45%             
client [95] (test)  loss: 0.4837 -> 0.4801   acc: 81.25% -> 81.62%             
client [53] (test)  loss: 0.7252 -> 0.7240   acc: 77.03% -> 77.03%             
client [22] (test)  loss: 0.6996 -> 0.6930   acc: 78.66% -> 79.08%             
client [25] (test)  loss: 1.0268 -> 1.0010   acc: 67.76% -> 67.76%             
client [69] (test)  loss: 0.9212 -> 0.9216   acc: 72.36% -> 71.79%             
client [46] (test)  loss: 1.1888 -> 1.1282   acc: 55.69% -> 58.08%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3686 -> 0.3713   acc: 87.42% -> 86.75%             
client [69] (test)  loss: 0.9290 -> 0.9342   acc: 72.08% -> 72.65%             
client [82] (test)  loss: 1.2447 -> 1.2606   acc: 58.28% -> 58.61%             
client [45] (test)  loss: 0.6461 -> 0.6079   acc: 77.59% -> 79.60%             
client [7] (test)  loss: 0.5072 -> 0.5023   acc: 88.52% -> 88.85%              
client [50] (test)  loss: 0.8240 -> 0.8221   acc: 75.05% -> 74.85%             
client [35] (test)  loss: 1.1299 -> 1.1491   acc: 69.72% -> 69.72%             
client [24] (test)  loss: 0.8345 -> 0.8227   acc: 74.11% -> 73.66%             
client [15] (test)  loss: 0.4201 -> 0.4199   acc: 86.95% -> 86.73%             
client [58] (test)  loss: 0.5508 -> 0.5506   acc: 82.10% -> 82.10%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5881 -> 0.5812   acc: 86.63% -> 86.63%             
client [76] (test)  loss: 0.7188 -> 0.7160   acc: 80.34% -> 80.34%             
client [67] (test)  loss: 0.5171 -> 0.5167   acc: 82.28% -> 81.96%             
client [37] (test)  loss: 0.6837 -> 0.6767   acc: 82.37% -> 82.37%             
client [58] (test)  loss: 0.5515 -> 0.5511   acc: 82.10% -> 82.10%             
client [64] (test)  loss: 0.8288 -> 0.8133   acc: 72.48% -> 73.26%             
client [77] (test)  loss: 0.5294 -> 0.5101   acc: 84.06% -> 84.54%             
client [55] (test)  loss: 0.2453 -> 0.2435   acc: 93.47% -> 93.47%             
client [12] (test)  loss: 0.7850 -> 0.7800   acc: 75.85% -> 76.19%             
client [89] (test)  loss: 1.1352 -> 1.1450   acc: 66.29% -> 65.17%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.4155 -> 1.4343   acc: 63.52% -> 63.52%             
client [51] (test)  loss: 0.8382 -> 0.8321   acc: 73.15% -> 72.84%             
client [8] (test)  loss: 0.4175 -> 0.4200   acc: 86.72% -> 86.72%              
client [18] (test)  loss: 0.8217 -> 0.8101   acc: 74.55% -> 74.85%             
client [94] (test)  loss: 0.5340 -> 0.5269   acc: 79.41% -> 79.41%             
client [81] (test)  loss: 0.2796 -> 0.2819   acc: 93.61% -> 93.39%             
client [3] (test)  loss: 0.6067 -> 0.6092   acc: 80.91% -> 80.58%              
client [11] (test)  loss: 0.7355 -> 0.7393   acc: 79.22% -> 79.22%             
client [95] (test)  loss: 0.4699 -> 0.4696   acc: 84.19% -> 84.19%             
client [67] (test)  loss: 0.5167 -> 0.5157   acc: 81.96% -> 82.91%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.2673 -> 1.2199   acc: 56.61% -> 58.64%             
client [79] (test)  loss: 0.4295 -> 0.4299   acc: 84.62% -> 86.15%             
client [58] (test)  loss: 0.5524 -> 0.5531   acc: 82.10% -> 82.10%             
client [88] (test)  loss: 0.6699 -> 0.6622   acc: 77.42% -> 77.42%             
client [46] (test)  loss: 0.9926 -> 0.9533   acc: 60.48% -> 66.47%             
client [11] (test)  loss: 0.7393 -> 0.7476   acc: 79.22% -> 79.22%             
client [55] (test)  loss: 0.2374 -> 0.2363   acc: 93.47% -> 93.47%             
client [13] (test)  loss: 0.3354 -> 0.3356   acc: 93.20% -> 93.20%             
client [31] (test)  loss: 0.5552 -> 0.5554   acc: 82.37% -> 82.71%             
client [75] (test)  loss: 0.1801 -> 0.1793   acc: 93.91% -> 93.91%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.8582 -> 0.8643   acc: 79.04% -> 77.73%             
client [7] (test)  loss: 0.4948 -> 0.4970   acc: 88.52% -> 88.52%              
client [57] (test)  loss: 0.4211 -> 0.4185   acc: 85.75% -> 85.75%             
client [13] (test)  loss: 0.3353 -> 0.3365   acc: 93.45% -> 93.45%             
client [43] (test)  loss: 0.2980 -> 0.2970   acc: 92.68% -> 92.68%             
client [91] (test)  loss: 0.7116 -> 0.6886   acc: 76.21% -> 77.53%             
client [10] (test)  loss: 0.1945 -> 0.1934   acc: 92.72% -> 92.72%             
client [64] (test)  loss: 0.7975 -> 0.8013   acc: 74.03% -> 74.42%             
client [82] (test)  loss: 1.4142 -> 1.4315   acc: 58.61% -> 58.94%             
client [22] (test)  loss: 0.6908 -> 0.6943   acc: 77.82% -> 77.82%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9802 -> 0.9736   acc: 66.12% -> 66.12%             
client [23] (test)  loss: 0.5871 -> 0.5878   acc: 82.83% -> 84.34%             
client [88] (test)  loss: 0.6622 -> 0.6590   acc: 77.42% -> 77.42%             
client [98] (test)  loss: 0.9032 -> 0.9068   acc: 73.39% -> 73.39%             
client [79] (test)  loss: 0.4319 -> 0.4331   acc: 88.46% -> 88.46%             
client [21] (test)  loss: 1.1798 -> 1.1419   acc: 60.34% -> 62.37%             
client [92] (test)  loss: 0.9962 -> 1.0008   acc: 66.29% -> 66.29%             
client [56] (test)  loss: 0.4016 -> 0.4034   acc: 89.66% -> 88.86%             
client [5] (test)  loss: 0.6290 -> 0.6299   acc: 82.16% -> 82.16%              
client [52] (test)  loss: 0.7576 -> 0.7694   acc: 79.34% -> 79.34%             
==================== FedFomo_0.5 TEST RESULTS: ====================            
{                                                                              
    100: {'loss': '0.7414 -> 0.0000', 'accuracy': '76.39% -> 0.00%'},          
    200: {'loss': '0.6744 -> 0.0000', 'accuracy': '80.27% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedFomo_0.5 achieved 10.0%(13.73%) at epoch: 0                                 
FedFomo_0.5 achieved 20.0%(20.40%) at epoch: 1                                 
FedFomo_0.5 achieved 30.0%(37.39%) at epoch: 3                                 
FedFomo_0.5 achieved 50.0%(55.16%) at epoch: 4                                 
FedFomo_0.5 achieved 60.0%(60.53%) at epoch: 18                                
FedFomo_0.5 achieved 70.0%(72.31%) at epoch: 28                                
FedFomo_0.5 achieved 80.0%(83.23%) at epoch: 96                                
Convergence (test_after):                                                      
FedFomo_0.5 achieved 50.0%(55.48%) at epoch: 0                                 
FedFomo_0.5 achieved 60.0%(66.65%) at epoch: 3                                 
FedFomo_0.5 achieved 70.0%(73.05%) at epoch: 20                                
FedFomo_0.5 achieved 80.0%(80.49%) at epoch: 83                                
