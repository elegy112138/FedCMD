==================== ALGORITHM: pFedSim_0.5 ====================               
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0165 -> 1.0754   acc: 50.49% -> 56.31%             
client [81] (test)  loss: 1.9363 -> 1.6974   acc: 28.83% -> 35.14%             
client [21] (test)  loss: 2.2456 -> 1.0571   acc: 20.35% -> 70.80%             
client [68] (test)  loss: 2.1977 -> 1.8396   acc: 22.11% -> 29.47%             
client [93] (test)  loss: 1.9413 -> 1.3139   acc: 41.73% -> 62.20%             
client [31] (test)  loss: 2.0240 -> 0.9577   acc: 29.75% -> 72.73%             
client [20] (test)  loss: 1.0616 -> 0.3936   acc: 84.97% -> 87.58%             
client [59] (test)  loss: 2.1520 -> 1.1456   acc: 68.03% -> 66.39%             
client [48] (test)  loss: 1.2625 -> 0.7626   acc: 69.90% -> 73.79%             
client [34] (test)  loss: 2.1190 -> 1.7079   acc: 9.59% -> 28.77%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6767 -> 1.2884   acc: 36.26% -> 48.35%             
client [99] (test)  loss: 1.8604 -> 1.3143   acc: 41.43% -> 65.71%             
client [67] (test)  loss: 1.8112 -> 0.7894   acc: 34.42% -> 73.38%             
client [0] (test)  loss: 1.6669 -> 0.3794   acc: 44.51% -> 90.75%              
client [76] (test)  loss: 1.7442 -> 0.6984   acc: 32.35% -> 77.94%             
client [41] (test)  loss: 1.8063 -> 0.8659   acc: 42.18% -> 76.87%             
client [62] (test)  loss: 2.2310 -> 0.6938   acc: 5.15% -> 83.82%              
client [2] (test)  loss: 2.1322 -> 0.9730   acc: 31.25% -> 80.21%              
client [14] (test)  loss: 1.1259 -> 0.7045   acc: 75.40% -> 80.95%             
client [46] (test)  loss: 0.7805 -> 0.4479   acc: 75.40% -> 85.71%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0899 -> 0.8035   acc: 61.34% -> 73.95%             
client [68] (test)  loss: 1.4167 -> 0.9128   acc: 43.16% -> 69.47%             
client [57] (test)  loss: 1.8606 -> 0.7842   acc: 15.79% -> 72.93%             
client [17] (test)  loss: 2.0320 -> 0.4357   acc: 20.53% -> 88.74%             
client [54] (test)  loss: 1.3831 -> 0.7723   acc: 49.64% -> 75.54%             
client [23] (test)  loss: 2.0840 -> 1.3569   acc: 14.17% -> 54.33%             
client [35] (test)  loss: 1.2911 -> 1.1172   acc: 56.84% -> 49.47%             
client [59] (test)  loss: 0.7271 -> 0.4603   acc: 77.87% -> 81.97%             
client [31] (test)  loss: 1.0219 -> 0.4768   acc: 68.60% -> 80.99%             
client [9] (test)  loss: 1.2323 -> 1.0794   acc: 63.83% -> 57.45%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.3832 -> 0.4382   acc: 47.30% -> 87.16%             
client [33] (test)  loss: 1.0851 -> 0.7114   acc: 65.96% -> 73.05%             
client [16] (test)  loss: 0.9425 -> 0.5321   acc: 69.54% -> 80.79%             
client [44] (test)  loss: 4.1246 -> 0.0148   acc: 1.52% -> 100.00%             
client [8] (test)  loss: 0.5637 -> 0.2817   acc: 83.06% -> 92.74%              
client [31] (test)  loss: 0.6545 -> 0.4100   acc: 76.86% -> 83.47%             
client [47] (test)  loss: 0.9281 -> 0.6650   acc: 66.67% -> 80.30%             
client [36] (test)  loss: 1.1861 -> 0.6208   acc: 63.89% -> 84.72%             
client [20] (test)  loss: 0.8487 -> 0.2050   acc: 81.05% -> 94.12%             
client [56] (test)  loss: 1.1987 -> 0.5089   acc: 57.78% -> 81.48%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5492 -> 0.2276   acc: 83.51% -> 94.15%              
client [60] (test)  loss: 1.0151 -> 0.8415   acc: 64.71% -> 71.76%             
client [28] (test)  loss: 1.6395 -> 0.6738   acc: 50.94% -> 79.25%             
client [25] (test)  loss: 1.4273 -> 0.5352   acc: 52.94% -> 80.67%             
client [58] (test)  loss: 1.4315 -> 0.8977   acc: 42.86% -> 69.92%             
client [44] (test)  loss: 2.6869 -> 0.0081   acc: 40.15% -> 100.00%            
client [39] (test)  loss: 0.6809 -> 0.4405   acc: 82.27% -> 82.27%             
client [29] (test)  loss: 1.2960 -> 0.3257   acc: 52.54% -> 91.53%             
client [3] (test)  loss: 0.5346 -> 0.3241   acc: 87.75% -> 90.51%              
client [84] (test)  loss: 1.2316 -> 0.6257   acc: 48.74% -> 80.67%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.8163 -> 0.3242   acc: 42.92% -> 91.15%             
client [84] (test)  loss: 1.0436 -> 0.6360   acc: 57.14% -> 80.67%             
client [10] (test)  loss: 1.2879 -> 0.3962   acc: 51.13% -> 87.97%             
client [36] (test)  loss: 1.0073 -> 0.5025   acc: 61.11% -> 86.11%             
client [65] (test)  loss: 0.9176 -> 0.5192   acc: 68.85% -> 79.51%             
client [81] (test)  loss: 0.7941 -> 0.4639   acc: 70.27% -> 89.19%             
client [79] (test)  loss: 0.6894 -> 0.2744   acc: 76.76% -> 94.37%             
client [42] (test)  loss: 0.9401 -> 0.7621   acc: 71.43% -> 76.19%             
client [11] (test)  loss: 1.1456 -> 0.8095   acc: 54.29% -> 74.29%             
client [96] (test)  loss: 0.4456 -> 0.0417   acc: 85.37% -> 98.78%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3161 -> 0.1711   acc: 89.52% -> 93.55%              
client [53] (test)  loss: 0.7770 -> 0.3346   acc: 72.26% -> 87.59%             
client [52] (test)  loss: 0.7828 -> 0.4045   acc: 78.26% -> 84.47%             
client [42] (test)  loss: 1.0273 -> 0.6799   acc: 70.63% -> 79.37%             
client [69] (test)  loss: 0.8564 -> 0.6344   acc: 71.43% -> 78.02%             
client [59] (test)  loss: 0.2759 -> 0.1860   acc: 91.80% -> 94.26%             
client [7] (test)  loss: 0.5353 -> 0.4857   acc: 83.48% -> 84.35%              
client [26] (test)  loss: 0.6476 -> 0.3173   acc: 76.86% -> 89.26%             
client [49] (test)  loss: 0.5031 -> 0.2689   acc: 81.48% -> 91.11%             
client [98] (test)  loss: 1.8680 -> 0.4571   acc: 36.67% -> 80.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4775 -> 0.4399   acc: 55.00% -> 81.67%             
client [47] (test)  loss: 0.7323 -> 0.4461   acc: 69.70% -> 87.88%             
client [21] (test)  loss: 1.2030 -> 0.2568   acc: 59.29% -> 92.48%             
client [77] (test)  loss: 0.5590 -> 0.2799   acc: 80.58% -> 91.26%             
client [95] (test)  loss: 0.7295 -> 0.2218   acc: 78.23% -> 93.20%             
client [91] (test)  loss: 0.8694 -> 0.3100   acc: 70.54% -> 93.02%             
client [14] (test)  loss: 0.4784 -> 0.3257   acc: 86.51% -> 87.30%             
client [99] (test)  loss: 0.8344 -> 0.5924   acc: 72.86% -> 84.29%             
client [20] (test)  loss: 1.0746 -> 0.2170   acc: 75.16% -> 96.08%             
client [39] (test)  loss: 0.4174 -> 0.3414   acc: 86.21% -> 88.18%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7028 -> 0.3419   acc: 80.12% -> 87.58%             
client [62] (test)  loss: 0.6169 -> 0.3205   acc: 82.35% -> 90.44%             
client [71] (test)  loss: 1.1662 -> 0.5631   acc: 72.55% -> 81.37%             
client [97] (test)  loss: 0.6723 -> 0.4470   acc: 80.00% -> 86.00%             
client [30] (test)  loss: 0.5338 -> 0.3114   acc: 83.61% -> 90.16%             
client [88] (test)  loss: 1.5130 -> 0.5591   acc: 50.76% -> 79.55%             
client [60] (test)  loss: 0.7980 -> 0.7222   acc: 75.29% -> 80.00%             
client [82] (test)  loss: 1.1509 -> 0.3659   acc: 65.65% -> 86.26%             
client [91] (test)  loss: 1.0726 -> 0.2987   acc: 65.89% -> 94.57%             
client [57] (test)  loss: 1.1022 -> 0.4146   acc: 65.41% -> 82.71%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4228 -> 0.2550   acc: 80.17% -> 93.39%             
client [15] (test)  loss: 1.2138 -> 0.6443   acc: 63.64% -> 84.85%             
client [71] (test)  loss: 1.1332 -> 0.5465   acc: 71.57% -> 82.35%             
client [97] (test)  loss: 0.5472 -> 0.4220   acc: 82.00% -> 84.00%             
client [53] (test)  loss: 0.5324 -> 0.3818   acc: 83.21% -> 89.05%             
client [77] (test)  loss: 1.0721 -> 0.2837   acc: 65.05% -> 91.26%             
client [76] (test)  loss: 0.3465 -> 0.2906   acc: 88.24% -> 91.18%             
client [79] (test)  loss: 0.6148 -> 0.2365   acc: 79.58% -> 95.07%             
client [28] (test)  loss: 0.7259 -> 0.7249   acc: 75.47% -> 79.25%             
client [99] (test)  loss: 1.1577 -> 0.5421   acc: 61.43% -> 85.71%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.5958 -> 0.4448   acc: 78.00% -> 86.00%             
client [86] (test)  loss: 0.2460 -> 0.2197   acc: 92.05% -> 94.32%             
client [34] (test)  loss: 0.5791 -> 0.5730   acc: 84.93% -> 83.56%             
client [73] (test)  loss: 0.6342 -> 0.6875   acc: 76.32% -> 80.70%             
client [5] (test)  loss: 0.5780 -> 0.3709   acc: 77.65% -> 85.88%              
client [96] (test)  loss: 0.4244 -> 0.0303   acc: 84.76% -> 99.39%             
client [22] (test)  loss: 0.4253 -> 0.4296   acc: 84.40% -> 82.57%             
client [60] (test)  loss: 0.7292 -> 0.7210   acc: 75.29% -> 80.00%             
client [66] (test)  loss: 0.2180 -> 0.2069   acc: 96.43% -> 94.64%             
client [83] (test)  loss: 0.3447 -> 0.2009   acc: 88.32% -> 93.93%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.2630 -> 0.2843   acc: 91.18% -> 91.18%             
client [65] (test)  loss: 0.5443 -> 0.4417   acc: 78.69% -> 82.79%             
client [95] (test)  loss: 0.2681 -> 0.2099   acc: 90.48% -> 93.88%             
client [17] (test)  loss: 0.9876 -> 0.2665   acc: 65.56% -> 91.39%             
client [8] (test)  loss: 0.3537 -> 0.1394   acc: 90.32% -> 94.35%              
client [35] (test)  loss: 0.6455 -> 0.6407   acc: 73.68% -> 73.68%             
client [98] (test)  loss: 1.0253 -> 0.4196   acc: 65.00% -> 81.67%             
client [53] (test)  loss: 0.2944 -> 0.3250   acc: 90.51% -> 89.78%             
client [43] (test)  loss: 1.3683 -> 0.3706   acc: 59.02% -> 89.34%             
client [64] (test)  loss: 0.2336 -> 0.2232   acc: 90.54% -> 91.89%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.3725 -> 0.2107   acc: 88.94% -> 93.81%             
client [88] (test)  loss: 0.5460 -> 0.5043   acc: 81.82% -> 82.58%             
client [38] (test)  loss: 0.4609 -> 0.3162   acc: 90.20% -> 92.16%             
client [3] (test)  loss: 0.2929 -> 0.2277   acc: 91.30% -> 93.68%              
client [5] (test)  loss: 0.4445 -> 0.3782   acc: 78.82% -> 87.06%              
client [41] (test)  loss: 0.5028 -> 0.2659   acc: 81.63% -> 88.44%             
client [7] (test)  loss: 0.3772 -> 0.4664   acc: 88.70% -> 87.83%              
client [37] (test)  loss: 0.6560 -> 0.3513   acc: 81.21% -> 88.59%             
client [45] (test)  loss: 0.4557 -> 0.1583   acc: 84.85% -> 96.97%             
client [47] (test)  loss: 0.5569 -> 0.4610   acc: 84.85% -> 87.88%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.3615 -> 0.3843   acc: 85.43% -> 86.75%             
client [11] (test)  loss: 0.5604 -> 0.6628   acc: 85.71% -> 78.57%             
client [37] (test)  loss: 0.5418 -> 0.3432   acc: 81.88% -> 88.59%             
client [41] (test)  loss: 0.4575 -> 0.2633   acc: 84.35% -> 87.76%             
client [95] (test)  loss: 0.1931 -> 0.2063   acc: 93.20% -> 93.88%             
client [53] (test)  loss: 0.2647 -> 0.3248   acc: 92.70% -> 89.05%             
client [22] (test)  loss: 0.3978 -> 0.4515   acc: 84.40% -> 79.82%             
client [25] (test)  loss: 0.3851 -> 0.4153   acc: 87.39% -> 86.55%             
client [69] (test)  loss: 0.5151 -> 0.5390   acc: 83.52% -> 80.22%             
client [46] (test)  loss: 0.2003 -> 0.1835   acc: 93.65% -> 95.24%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.3666 -> 0.4459   acc: 87.88% -> 89.39%             
client [69] (test)  loss: 0.5136 -> 0.5428   acc: 82.42% -> 80.22%             
client [82] (test)  loss: 0.3775 -> 0.2877   acc: 86.26% -> 87.79%             
client [45] (test)  loss: 0.1912 -> 0.1389   acc: 93.94% -> 96.97%             
client [7] (test)  loss: 0.3733 -> 0.4705   acc: 88.70% -> 86.96%              
client [50] (test)  loss: 0.2835 -> 0.2767   acc: 87.22% -> 90.23%             
client [35] (test)  loss: 0.5950 -> 0.6327   acc: 74.74% -> 73.68%             
client [24] (test)  loss: 0.4001 -> 0.3862   acc: 84.03% -> 86.55%             
client [15] (test)  loss: 0.8683 -> 0.6864   acc: 75.76% -> 81.82%             
client [58] (test)  loss: 0.6863 -> 0.6489   acc: 80.45% -> 79.70%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.1759 -> 0.1679   acc: 96.12% -> 96.12%             
client [76] (test)  loss: 0.2737 -> 0.2783   acc: 89.71% -> 90.44%             
client [67] (test)  loss: 0.3135 -> 0.3335   acc: 88.96% -> 85.06%             
client [37] (test)  loss: 0.4944 -> 0.3462   acc: 83.22% -> 88.59%             
client [58] (test)  loss: 0.6768 -> 0.6462   acc: 79.70% -> 79.70%             
client [64] (test)  loss: 0.2325 -> 0.2298   acc: 91.22% -> 90.54%             
client [77] (test)  loss: 0.2610 -> 0.2054   acc: 93.20% -> 94.17%             
client [55] (test)  loss: 0.7699 -> 0.6420   acc: 70.19% -> 75.96%             
client [12] (test)  loss: 0.5430 -> 0.5679   acc: 80.34% -> 78.63%             
client [89] (test)  loss: 0.6359 -> 0.4792   acc: 78.57% -> 74.29%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.3871 -> 0.6058   acc: 85.71% -> 78.15%             
client [51] (test)  loss: 0.2246 -> 0.2458   acc: 89.81% -> 89.81%             
client [8] (test)  loss: 0.1368 -> 0.1093   acc: 95.16% -> 95.97%              
client [18] (test)  loss: 0.3778 -> 0.3982   acc: 87.85% -> 85.05%             
client [94] (test)  loss: 0.1831 -> 0.0494   acc: 93.44% -> 98.36%             
client [81] (test)  loss: 0.3847 -> 0.3500   acc: 89.19% -> 88.29%             
client [3] (test)  loss: 0.2376 -> 0.2247   acc: 92.09% -> 93.68%              
client [11] (test)  loss: 0.5709 -> 0.6618   acc: 84.29% -> 80.00%             
client [95] (test)  loss: 0.2112 -> 0.2163   acc: 93.20% -> 94.56%             
client [67] (test)  loss: 0.3183 -> 0.3379   acc: 88.31% -> 85.71%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.2702 -> 0.2008   acc: 91.59% -> 93.36%             
client [79] (test)  loss: 0.2501 -> 0.2459   acc: 93.66% -> 93.66%             
client [58] (test)  loss: 0.6680 -> 0.6541   acc: 78.95% -> 78.20%             
client [88] (test)  loss: 0.5353 -> 0.5241   acc: 80.30% -> 83.33%             
client [46] (test)  loss: 0.1843 -> 0.1748   acc: 93.65% -> 95.24%             
client [11] (test)  loss: 0.5678 -> 0.6565   acc: 84.29% -> 81.43%             
client [55] (test)  loss: 1.0032 -> 0.7344   acc: 63.46% -> 72.12%             
client [13] (test)  loss: 0.4729 -> 0.4162   acc: 83.10% -> 84.51%             
client [31] (test)  loss: 0.2355 -> 0.2266   acc: 93.39% -> 94.21%             
client [75] (test)  loss: 0.5490 -> 0.5432   acc: 79.25% -> 81.13%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.3463 -> 0.4262   acc: 92.31% -> 84.62%             
client [7] (test)  loss: 0.4034 -> 0.4901   acc: 87.83% -> 86.96%              
client [57] (test)  loss: 0.6032 -> 0.3729   acc: 76.69% -> 86.47%             
client [13] (test)  loss: 0.4468 -> 0.4142   acc: 85.92% -> 84.51%             
client [43] (test)  loss: 0.4325 -> 0.3448   acc: 86.89% -> 90.16%             
client [91] (test)  loss: 0.2443 -> 0.2835   acc: 93.02% -> 93.02%             
client [10] (test)  loss: 0.3450 -> 0.3146   acc: 86.47% -> 90.98%             
client [64] (test)  loss: 0.2541 -> 0.2396   acc: 90.54% -> 90.54%             
client [82] (test)  loss: 0.3755 -> 0.2704   acc: 82.44% -> 91.60%             
client [22] (test)  loss: 0.3823 -> 0.4652   acc: 86.24% -> 80.73%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.3797 -> 0.2226   acc: 90.20% -> 96.08%             
client [23] (test)  loss: 0.4770 -> 0.4984   acc: 81.89% -> 85.83%             
client [88] (test)  loss: 0.5355 -> 0.5229   acc: 79.55% -> 84.09%             
client [98] (test)  loss: 0.6538 -> 0.4427   acc: 73.33% -> 78.33%             
client [79] (test)  loss: 0.2548 -> 0.2484   acc: 93.66% -> 92.96%             
client [21] (test)  loss: 0.2727 -> 0.1994   acc: 91.59% -> 93.36%             
client [92] (test)  loss: 0.4103 -> 0.4705   acc: 84.69% -> 85.71%             
client [56] (test)  loss: 0.2427 -> 0.2560   acc: 88.89% -> 90.37%             
client [5] (test)  loss: 0.3714 -> 0.3841   acc: 81.18% -> 87.06%              
client [52] (test)  loss: 0.3667 -> 0.3206   acc: 86.34% -> 90.06%             
==================== pFedSim_0.5 TEST RESULTS: ====================            
{                                                                              
    100: {'loss': '0.7920 -> 0.0000', 'accuracy': '75.24% -> 0.00%'},          
    200: {'loss': '0.3498 -> 0.0000', 'accuracy': '88.75% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_0.5 achieved 10.0%(13.52%) at epoch: 0                                 
pFedSim_0.5 achieved 20.0%(21.60%) at epoch: 1                                 
pFedSim_0.5 achieved 40.0%(46.29%) at epoch: 6                                 
pFedSim_0.5 achieved 50.0%(52.10%) at epoch: 22                                
pFedSim_0.5 achieved 60.0%(61.84%) at epoch: 27                                
pFedSim_0.5 achieved 70.0%(72.34%) at epoch: 38                                
pFedSim_0.5 achieved 80.0%(80.59%) at epoch: 77                                
pFedSim_0.5 achieved 90.0%(91.07%) at epoch: 123                               
Convergence (test_after):                                                      
pFedSim_0.5 achieved 40.0%(45.42%) at epoch: 0                                 
pFedSim_0.5 achieved 50.0%(53.66%) at epoch: 3                                 
pFedSim_0.5 achieved 60.0%(67.30%) at epoch: 6                                 
pFedSim_0.5 achieved 70.0%(72.89%) at epoch: 14                                
pFedSim_0.5 achieved 80.0%(84.03%) at epoch: 24                                
pFedSim_0.5 achieved 90.0%(90.55%) at epoch: 77                                
