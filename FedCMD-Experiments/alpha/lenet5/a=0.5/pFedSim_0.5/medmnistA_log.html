==================== ALGORITHM: pFedSim_0.5 ====================               
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.2546 -> 0.6211   acc: 18.36% -> 81.64%             
client [81] (test)  loss: 1.4006 -> 0.3241   acc: 64.76% -> 89.43%             
client [21] (test)  loss: 2.4316 -> 1.2496   acc: 9.49% -> 53.56%              
client [68] (test)  loss: 1.8050 -> 0.6155   acc: 32.04% -> 80.26%             
client [93] (test)  loss: 2.9482 -> 0.5713   acc: 5.22% -> 82.46%              
client [31] (test)  loss: 2.3535 -> 0.6746   acc: 22.03% -> 79.32%             
client [20] (test)  loss: 2.1491 -> 0.8437   acc: 20.66% -> 73.55%             
client [59] (test)  loss: 2.6255 -> 0.4815   acc: 2.97% -> 83.17%              
client [48] (test)  loss: 2.1411 -> 0.7114   acc: 18.72% -> 79.95%             
client [34] (test)  loss: 1.4065 -> 0.6768   acc: 57.38% -> 83.61%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.9128 -> 0.5770   acc: 32.48% -> 80.91%             
client [99] (test)  loss: 1.3692 -> 0.4720   acc: 60.48% -> 87.90%             
client [67] (test)  loss: 1.4545 -> 0.5536   acc: 49.37% -> 81.96%             
client [0] (test)  loss: 0.7683 -> 0.4122   acc: 76.56% -> 87.08%              
client [76] (test)  loss: 1.1058 -> 0.5899   acc: 50.00% -> 80.34%             
client [41] (test)  loss: 2.2701 -> 0.8510   acc: 18.16% -> 72.88%             
client [62] (test)  loss: 3.0213 -> 0.2181   acc: 10.16% -> 92.58%             
client [2] (test)  loss: 2.1762 -> 0.9485   acc: 13.27% -> 65.82%              
client [14] (test)  loss: 0.9113 -> 0.5321   acc: 74.42% -> 82.17%             
client [46] (test)  loss: 0.7877 -> 0.6290   acc: 74.85% -> 80.24%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8070 -> 0.4836   acc: 68.30% -> 82.14%             
client [68] (test)  loss: 0.5474 -> 0.2552   acc: 77.02% -> 91.26%             
client [57] (test)  loss: 0.3225 -> 0.2474   acc: 89.78% -> 91.13%             
client [17] (test)  loss: 1.1573 -> 0.3285   acc: 65.80% -> 89.59%             
client [54] (test)  loss: 0.3845 -> 0.2815   acc: 90.48% -> 91.11%             
client [23] (test)  loss: 2.9299 -> 0.4874   acc: 5.05% -> 82.32%              
client [35] (test)  loss: 1.1101 -> 0.5732   acc: 58.72% -> 78.90%             
client [59] (test)  loss: 1.2340 -> 0.3146   acc: 63.70% -> 88.12%             
client [31] (test)  loss: 0.7568 -> 0.3627   acc: 80.00% -> 86.78%             
client [9] (test)  loss: 1.2214 -> 0.5037   acc: 58.89% -> 83.33%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2110 -> 0.4262   acc: 63.18% -> 85.27%             
client [33] (test)  loss: 0.7142 -> 0.2948   acc: 75.13% -> 91.53%             
client [16] (test)  loss: 0.7340 -> 0.5534   acc: 74.61% -> 82.03%             
client [44] (test)  loss: 3.4508 -> 0.0597   acc: 18.52% -> 98.46%             
client [8] (test)  loss: 0.7115 -> 0.2902   acc: 82.29% -> 91.15%              
client [31] (test)  loss: 0.7530 -> 0.3035   acc: 77.63% -> 90.85%             
client [47] (test)  loss: 0.5718 -> 0.2645   acc: 81.13% -> 91.39%             
client [36] (test)  loss: 0.7329 -> 0.2516   acc: 79.75% -> 92.83%             
client [20] (test)  loss: 1.8933 -> 0.4846   acc: 48.76% -> 85.95%             
client [56] (test)  loss: 0.8354 -> 0.2865   acc: 67.64% -> 90.98%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7511 -> 0.3727   acc: 74.18% -> 88.52%              
client [60] (test)  loss: 0.9426 -> 0.1956   acc: 66.67% -> 94.17%             
client [28] (test)  loss: 0.4111 -> 0.2363   acc: 86.27% -> 92.16%             
client [25] (test)  loss: 3.0634 -> 0.3058   acc: 31.78% -> 91.12%             
client [58] (test)  loss: 0.5518 -> 0.2491   acc: 81.48% -> 95.06%             
client [44] (test)  loss: 0.5739 -> 0.0449   acc: 83.64% -> 99.07%             
client [39] (test)  loss: 0.7268 -> 0.3480   acc: 74.15% -> 86.44%             
client [29] (test)  loss: 1.6073 -> 0.3431   acc: 54.46% -> 87.46%             
client [3] (test)  loss: 0.6277 -> 0.3101   acc: 69.58% -> 90.61%              
client [84] (test)  loss: 0.7658 -> 0.6479   acc: 70.03% -> 75.57%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8210 -> 0.6738   acc: 73.22% -> 80.34%             
client [84] (test)  loss: 0.8843 -> 0.6103   acc: 68.73% -> 78.50%             
client [10] (test)  loss: 0.5424 -> 0.0723   acc: 82.34% -> 98.01%             
client [36] (test)  loss: 0.4120 -> 0.2000   acc: 87.54% -> 94.39%             
client [65] (test)  loss: 0.5127 -> 0.3574   acc: 83.33% -> 89.43%             
client [81] (test)  loss: 1.3706 -> 0.1138   acc: 52.42% -> 96.92%             
client [79] (test)  loss: 0.4413 -> 0.1761   acc: 85.38% -> 95.38%             
client [42] (test)  loss: 0.9345 -> 0.2470   acc: 69.95% -> 91.28%             
client [11] (test)  loss: 0.9612 -> 0.3711   acc: 68.61% -> 88.74%             
client [96] (test)  loss: 0.9617 -> 0.1860   acc: 58.13% -> 94.20%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5473 -> 0.2138   acc: 85.16% -> 93.23%              
client [53] (test)  loss: 1.6528 -> 0.4041   acc: 49.71% -> 85.76%             
client [52] (test)  loss: 0.6012 -> 0.3330   acc: 80.66% -> 87.21%             
client [42] (test)  loss: 0.8245 -> 0.2408   acc: 72.25% -> 91.51%             
client [69] (test)  loss: 0.9044 -> 0.3423   acc: 68.66% -> 87.75%             
client [59] (test)  loss: 0.9838 -> 0.2208   acc: 71.62% -> 91.09%             
client [7] (test)  loss: 0.9517 -> 0.1521   acc: 69.51% -> 95.41%              
client [26] (test)  loss: 0.5032 -> 0.0467   acc: 84.59% -> 98.49%             
client [49] (test)  loss: 0.5953 -> 0.4228   acc: 75.32% -> 83.83%             
client [98] (test)  loss: 0.7891 -> 0.4464   acc: 70.18% -> 85.09%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9638 -> 0.4406   acc: 65.50% -> 85.38%             
client [47] (test)  loss: 0.4526 -> 0.2252   acc: 87.42% -> 92.72%             
client [21] (test)  loss: 0.8962 -> 0.6414   acc: 73.22% -> 81.69%             
client [77] (test)  loss: 0.6846 -> 0.2274   acc: 77.29% -> 91.79%             
client [95] (test)  loss: 0.4977 -> 0.2522   acc: 84.19% -> 90.44%             
client [91] (test)  loss: 0.6251 -> 0.2855   acc: 77.09% -> 90.31%             
client [14] (test)  loss: 0.7896 -> 0.2367   acc: 81.40% -> 93.02%             
client [99] (test)  loss: 0.6593 -> 0.2773   acc: 80.65% -> 91.13%             
client [20] (test)  loss: 1.5694 -> 0.2893   acc: 53.72% -> 90.91%             
client [39] (test)  loss: 0.9342 -> 0.3161   acc: 69.92% -> 91.10%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8293 -> 0.3299   acc: 73.77% -> 87.54%             
client [62] (test)  loss: 0.5451 -> 0.0428   acc: 85.99% -> 98.08%             
client [71] (test)  loss: 0.4057 -> 0.1925   acc: 89.18% -> 94.85%             
client [97] (test)  loss: 0.7974 -> 0.2026   acc: 74.06% -> 94.58%             
client [30] (test)  loss: 0.3166 -> 0.1478   acc: 91.22% -> 94.26%             
client [88] (test)  loss: 0.4147 -> 0.2813   acc: 86.64% -> 92.17%             
client [60] (test)  loss: 0.3330 -> 0.1296   acc: 88.75% -> 95.83%             
client [82] (test)  loss: 0.9128 -> 0.5905   acc: 72.52% -> 82.45%             
client [91] (test)  loss: 1.0574 -> 0.2553   acc: 68.72% -> 91.63%             
client [57] (test)  loss: 0.1644 -> 0.1310   acc: 93.82% -> 96.24%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4389 -> 0.2460   acc: 87.80% -> 92.88%             
client [15] (test)  loss: 0.5181 -> 0.1216   acc: 83.63% -> 96.24%             
client [71] (test)  loss: 0.3080 -> 0.2071   acc: 93.81% -> 93.81%             
client [97] (test)  loss: 0.6084 -> 0.2002   acc: 81.60% -> 93.87%             
client [53] (test)  loss: 1.2773 -> 0.3664   acc: 63.37% -> 85.17%             
client [77] (test)  loss: 0.4768 -> 0.2117   acc: 85.51% -> 92.75%             
client [76] (test)  loss: 0.4515 -> 0.2705   acc: 84.14% -> 90.69%             
client [79] (test)  loss: 0.3135 -> 0.1383   acc: 92.31% -> 96.15%             
client [28] (test)  loss: 0.2608 -> 0.1830   acc: 92.81% -> 94.12%             
client [99] (test)  loss: 0.5965 -> 0.2860   acc: 83.06% -> 91.13%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 0.2765 -> 0.1956   acc: 91.75% -> 93.63%             
client [86] (test)  loss: 0.5272 -> 0.2505   acc: 82.99% -> 92.27%             
client [34] (test)  loss: 0.4280 -> 0.2515   acc: 84.26% -> 92.79%             
client [73] (test)  loss: 0.0767 -> 0.0381   acc: 97.36% -> 99.04%             
client [5] (test)  loss: 0.2797 -> 0.2442   acc: 92.57% -> 93.31%              
client [96] (test)  loss: 1.0793 -> 0.1629   acc: 64.73% -> 95.49%             
client [22] (test)  loss: 0.3664 -> 0.2583   acc: 89.12% -> 90.38%             
client [60] (test)  loss: 0.2334 -> 0.1308   acc: 92.50% -> 95.42%             
client [66] (test)  loss: 0.2509 -> 0.1820   acc: 90.86% -> 94.09%             
client [83] (test)  loss: 0.2092 -> 0.0760   acc: 92.12% -> 98.28%             
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.2485 -> 0.2606   acc: 92.07% -> 92.07%             
client [65] (test)  loss: 0.3513 -> 0.2883   acc: 89.02% -> 90.24%             
client [95] (test)  loss: 0.2440 -> 0.2391   acc: 93.01% -> 91.18%             
client [17] (test)  loss: 0.3206 -> 0.2250   acc: 87.36% -> 92.57%             
client [8] (test)  loss: 0.4853 -> 0.1832   acc: 84.64% -> 93.75%              
client [35] (test)  loss: 0.6286 -> 0.3847   acc: 77.52% -> 89.22%             
client [98] (test)  loss: 0.5854 -> 0.3992   acc: 78.36% -> 86.84%             
client [53] (test)  loss: 0.5852 -> 0.3346   acc: 80.52% -> 86.05%             
client [43] (test)  loss: 0.1834 -> 0.1098   acc: 94.70% -> 96.72%             
client [64] (test)  loss: 0.8497 -> 0.2555   acc: 74.03% -> 89.92%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.7396 -> 0.6679   acc: 79.32% -> 81.36%             
client [88] (test)  loss: 0.2739 -> 0.2655   acc: 93.55% -> 92.63%             
client [38] (test)  loss: 0.1920 -> 0.1668   acc: 94.62% -> 94.09%             
client [3] (test)  loss: 0.1789 -> 0.1876   acc: 94.17% -> 93.85%              
client [5] (test)  loss: 0.2297 -> 0.2471   acc: 92.57% -> 93.31%              
client [41] (test)  loss: 0.3778 -> 0.3436   acc: 86.79% -> 88.21%             
client [7] (test)  loss: 0.1319 -> 0.1400   acc: 95.41% -> 95.41%              
client [37] (test)  loss: 0.2275 -> 0.1533   acc: 94.60% -> 96.04%             
client [45] (test)  loss: 0.5910 -> 0.2537   acc: 80.27% -> 88.96%             
client [47] (test)  loss: 1.1523 -> 0.2209   acc: 67.55% -> 93.05%             
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.4907 -> 0.4596   acc: 83.98% -> 84.77%             
client [11] (test)  loss: 0.3459 -> 0.3357   acc: 88.96% -> 90.04%             
client [37] (test)  loss: 0.2102 -> 0.1562   acc: 94.96% -> 95.32%             
client [41] (test)  loss: 0.3655 -> 0.3446   acc: 87.26% -> 87.74%             
client [95] (test)  loss: 0.2205 -> 0.2309   acc: 93.38% -> 92.28%             
client [53] (test)  loss: 0.5261 -> 0.3270   acc: 81.10% -> 86.92%             
client [22] (test)  loss: 0.4326 -> 0.2606   acc: 86.19% -> 89.12%             
client [25] (test)  loss: 0.5151 -> 0.1348   acc: 83.18% -> 94.86%             
client [69] (test)  loss: 0.2921 -> 0.3181   acc: 91.45% -> 89.74%             
client [46] (test)  loss: 0.3435 -> 0.2612   acc: 88.62% -> 90.42%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.2489 -> 0.2137   acc: 91.06% -> 93.71%             
client [69] (test)  loss: 0.2822 -> 0.3141   acc: 91.74% -> 89.46%             
client [82] (test)  loss: 0.6108 -> 0.5824   acc: 79.47% -> 81.79%             
client [45] (test)  loss: 0.3678 -> 0.2383   acc: 86.62% -> 90.30%             
client [7] (test)  loss: 0.1306 -> 0.1383   acc: 95.41% -> 95.41%              
client [50] (test)  loss: 0.2336 -> 0.2368   acc: 92.99% -> 93.40%             
client [35] (test)  loss: 0.3444 -> 0.3761   acc: 87.61% -> 89.91%             
client [24] (test)  loss: 0.3314 -> 0.2244   acc: 88.39% -> 91.07%             
client [15] (test)  loss: 0.1727 -> 0.1023   acc: 94.03% -> 96.46%             
client [58] (test)  loss: 0.2087 -> 0.1909   acc: 93.52% -> 94.75%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.3569 -> 0.2833   acc: 88.24% -> 90.91%             
client [76] (test)  loss: 0.2634 -> 0.2661   acc: 91.72% -> 91.72%             
client [67] (test)  loss: 0.4544 -> 0.3555   acc: 85.76% -> 87.97%             
client [37] (test)  loss: 0.2091 -> 0.1559   acc: 94.60% -> 95.68%             
client [58] (test)  loss: 0.2073 -> 0.1885   acc: 92.90% -> 95.06%             
client [64] (test)  loss: 0.4111 -> 0.2844   acc: 85.66% -> 89.53%             
client [77] (test)  loss: 0.2458 -> 0.2154   acc: 92.27% -> 92.27%             
client [55] (test)  loss: 0.1368 -> 0.0624   acc: 95.30% -> 98.43%             
client [12] (test)  loss: 0.4228 -> 0.3980   acc: 85.37% -> 88.44%             
client [89] (test)  loss: 0.3594 -> 0.3784   acc: 88.39% -> 87.64%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 0.5112 -> 0.5182   acc: 83.39% -> 83.71%             
client [51] (test)  loss: 0.4325 -> 0.4480   acc: 84.57% -> 83.02%             
client [8] (test)  loss: 0.3089 -> 0.1803   acc: 90.89% -> 94.53%              
client [18] (test)  loss: 0.3332 -> 0.2249   acc: 90.61% -> 92.12%             
client [94] (test)  loss: 0.2398 -> 0.1067   acc: 92.16% -> 96.08%             
client [81] (test)  loss: 0.1301 -> 0.0916   acc: 95.37% -> 97.36%             
client [3] (test)  loss: 0.1720 -> 0.1837   acc: 93.53% -> 93.85%              
client [11] (test)  loss: 0.3875 -> 0.3432   acc: 88.74% -> 90.26%             
client [95] (test)  loss: 0.2243 -> 0.2295   acc: 93.01% -> 91.91%             
client [67] (test)  loss: 0.4671 -> 0.3628   acc: 85.76% -> 87.03%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.7676 -> 0.6788   acc: 79.66% -> 82.71%             
client [79] (test)  loss: 0.2572 -> 0.1293   acc: 93.08% -> 96.15%             
client [58] (test)  loss: 0.2003 -> 0.1867   acc: 92.90% -> 94.75%             
client [88] (test)  loss: 0.2895 -> 0.2600   acc: 92.17% -> 92.17%             
client [46] (test)  loss: 0.3594 -> 0.2623   acc: 88.02% -> 90.42%             
client [11] (test)  loss: 0.3901 -> 0.3459   acc: 88.74% -> 90.26%             
client [55] (test)  loss: 0.0964 -> 0.0640   acc: 96.61% -> 98.43%             
client [13] (test)  loss: 0.2877 -> 0.1165   acc: 93.20% -> 96.22%             
client [31] (test)  loss: 0.3047 -> 0.2327   acc: 89.49% -> 93.56%             
client [75] (test)  loss: 0.0789 -> 0.0576   acc: 96.96% -> 98.13%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.3912 -> 0.2937   acc: 87.77% -> 89.52%             
client [7] (test)  loss: 0.1295 -> 0.1401   acc: 96.07% -> 95.74%              
client [57] (test)  loss: 0.1052 -> 0.1125   acc: 97.04% -> 96.51%             
client [13] (test)  loss: 0.2846 -> 0.1165   acc: 93.45% -> 95.97%             
client [43] (test)  loss: 0.0909 -> 0.1121   acc: 97.22% -> 96.72%             
client [91] (test)  loss: 0.2988 -> 0.2301   acc: 88.55% -> 92.51%             
client [10] (test)  loss: 0.1855 -> 0.0800   acc: 93.38% -> 97.35%             
client [64] (test)  loss: 0.2831 -> 0.2743   acc: 89.15% -> 89.53%             
client [82] (test)  loss: 0.5411 -> 0.5850   acc: 82.78% -> 82.45%             
client [22] (test)  loss: 0.3835 -> 0.2764   acc: 87.45% -> 89.12%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.3178 -> 0.2225   acc: 90.08% -> 93.39%             
client [23] (test)  loss: 0.7100 -> 0.2403   acc: 77.78% -> 89.39%             
client [88] (test)  loss: 0.2890 -> 0.2582   acc: 92.17% -> 92.17%             
client [98] (test)  loss: 0.5257 -> 0.3948   acc: 82.46% -> 86.84%             
client [79] (test)  loss: 0.2492 -> 0.1285   acc: 93.08% -> 96.15%             
client [21] (test)  loss: 0.8228 -> 0.6827   acc: 78.98% -> 82.03%             
client [92] (test)  loss: 0.5626 -> 0.4461   acc: 82.29% -> 85.71%             
client [56] (test)  loss: 0.3153 -> 0.1786   acc: 90.19% -> 95.23%             
client [5] (test)  loss: 0.2353 -> 0.2502   acc: 93.31% -> 93.31%              
client [52] (test)  loss: 0.4466 -> 0.3210   acc: 86.89% -> 87.87%             
==================== pFedSim_0.5 TEST RESULTS: ====================            
{                                                                              
    100: {'loss': '0.7014 -> 0.0000', 'accuracy': '77.93% -> 0.00%'},          
    200: {'loss': '0.2411 -> 0.0000', 'accuracy': '92.30% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim_0.5 achieved 10.0%(13.73%) at epoch: 0                                 
pFedSim_0.5 achieved 30.0%(30.65%) at epoch: 1                                 
pFedSim_0.5 achieved 40.0%(45.47%) at epoch: 13                                
pFedSim_0.5 achieved 50.0%(54.35%) at epoch: 18                                
pFedSim_0.5 achieved 60.0%(61.96%) at epoch: 23                                
pFedSim_0.5 achieved 70.0%(70.02%) at epoch: 33                                
pFedSim_0.5 achieved 80.0%(80.57%) at epoch: 42                                
pFedSim_0.5 achieved 90.0%(91.23%) at epoch: 125                               
Convergence (test_after):                                                      
pFedSim_0.5 achieved 50.0%(59.82%) at epoch: 0                                 
pFedSim_0.5 achieved 60.0%(61.41%) at epoch: 2                                 
pFedSim_0.5 achieved 70.0%(71.87%) at epoch: 3                                 
pFedSim_0.5 achieved 80.0%(80.80%) at epoch: 12                                
pFedSim_0.5 achieved 90.0%(90.34%) at epoch: 23                                
