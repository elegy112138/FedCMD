==================== ALGORITHM: FedRep_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6141 -> 1.3945   acc: 29.47% -> 47.34%             
client [81] (test)  loss: 0.7240 -> 0.6532   acc: 72.03% -> 77.75%             
client [21] (test)  loss: 2.3681 -> 1.9139   acc: 12.54% -> 38.98%             
client [68] (test)  loss: 1.5205 -> 1.3467   acc: 43.69% -> 48.22%             
client [93] (test)  loss: 1.1071 -> 0.9618   acc: 76.49% -> 78.36%             
client [31] (test)  loss: 1.6264 -> 1.4166   acc: 52.20% -> 52.20%             
client [20] (test)  loss: 1.7881 -> 1.6885   acc: 41.32% -> 41.32%             
client [59] (test)  loss: 2.2382 -> 1.0153   acc: 63.70% -> 67.66%             
client [48] (test)  loss: 1.4849 -> 1.4066   acc: 45.45% -> 51.34%             
client [34] (test)  loss: 1.5571 -> 1.4191   acc: 49.84% -> 49.84%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5075 -> 1.3469   acc: 53.56% -> 57.55%             
client [99] (test)  loss: 1.7830 -> 1.5081   acc: 45.16% -> 69.35%             
client [67] (test)  loss: 1.2854 -> 1.1444   acc: 45.25% -> 56.96%             
client [0] (test)  loss: 0.9822 -> 0.9021   acc: 75.12% -> 75.60%              
client [76] (test)  loss: 1.4149 -> 1.2689   acc: 47.93% -> 56.21%             
client [41] (test)  loss: 1.3306 -> 1.2905   acc: 52.59% -> 53.07%             
client [62] (test)  loss: 2.2243 -> 0.7589   acc: 53.30% -> 72.53%             
client [2] (test)  loss: 2.3130 -> 1.7839   acc: 6.12% -> 44.90%               
client [14] (test)  loss: 1.4442 -> 1.3397   acc: 44.19% -> 53.49%             
client [46] (test)  loss: 1.6101 -> 1.4727   acc: 46.11% -> 47.31%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3186 -> 1.2769   acc: 50.45% -> 55.80%             
client [68] (test)  loss: 1.0165 -> 0.9282   acc: 66.99% -> 70.87%             
client [57] (test)  loss: 0.8802 -> 0.7555   acc: 74.73% -> 74.73%             
client [17] (test)  loss: 1.0495 -> 0.8820   acc: 63.94% -> 69.52%             
client [54] (test)  loss: 0.7563 -> 0.7157   acc: 78.73% -> 79.05%             
client [23] (test)  loss: 2.4739 -> 0.9993   acc: 1.52% -> 68.18%              
client [35] (test)  loss: 1.2615 -> 1.2000   acc: 56.65% -> 58.26%             
client [59] (test)  loss: 0.7084 -> 0.6597   acc: 75.91% -> 79.87%             
client [31] (test)  loss: 0.9901 -> 0.9373   acc: 76.95% -> 77.29%             
client [9] (test)  loss: 1.3195 -> 1.2278   acc: 53.33% -> 58.06%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1724 -> 1.1163   acc: 55.81% -> 59.69%             
client [33] (test)  loss: 0.9638 -> 0.9225   acc: 75.13% -> 76.72%             
client [16] (test)  loss: 1.2817 -> 1.2180   acc: 58.98% -> 63.67%             
client [44] (test)  loss: 0.8987 -> 0.3954   acc: 83.02% -> 84.57%             
client [8] (test)  loss: 0.8104 -> 0.7413   acc: 75.00% -> 78.12%              
client [31] (test)  loss: 0.8403 -> 0.8158   acc: 77.97% -> 80.00%             
client [47] (test)  loss: 0.7009 -> 0.6448   acc: 70.53% -> 82.12%             
client [36] (test)  loss: 1.0520 -> 0.9033   acc: 62.31% -> 71.34%             
client [20] (test)  loss: 1.1203 -> 1.0608   acc: 64.46% -> 68.60%             
client [56] (test)  loss: 0.8089 -> 0.7238   acc: 74.80% -> 77.72%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1489 -> 1.0839   acc: 65.57% -> 67.62%              
client [60] (test)  loss: 0.8688 -> 0.8252   acc: 75.83% -> 76.25%             
client [28] (test)  loss: 1.0867 -> 0.9579   acc: 70.59% -> 78.43%             
client [25] (test)  loss: 1.3004 -> 1.0349   acc: 61.21% -> 70.09%             
client [58] (test)  loss: 0.9295 -> 0.8708   acc: 64.81% -> 69.44%             
client [44] (test)  loss: 0.3634 -> 0.3141   acc: 85.19% -> 88.58%             
client [39] (test)  loss: 1.0431 -> 0.9883   acc: 66.10% -> 65.25%             
client [29] (test)  loss: 0.8951 -> 0.7536   acc: 65.35% -> 71.95%             
client [3] (test)  loss: 1.1560 -> 1.0366   acc: 69.90% -> 70.55%              
client [84] (test)  loss: 1.2290 -> 1.1664   acc: 58.31% -> 59.93%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.4494 -> 1.3390   acc: 50.85% -> 53.22%             
client [84] (test)  loss: 1.1218 -> 1.0788   acc: 62.54% -> 65.47%             
client [10] (test)  loss: 0.2791 -> 0.2694   acc: 89.18% -> 90.07%             
client [36] (test)  loss: 0.6906 -> 0.6323   acc: 78.50% -> 80.69%             
client [65] (test)  loss: 0.8458 -> 0.8043   acc: 76.83% -> 77.64%             
client [81] (test)  loss: 0.5104 -> 0.3568   acc: 81.50% -> 89.21%             
client [79] (test)  loss: 0.5515 -> 0.5145   acc: 85.38% -> 86.15%             
client [42] (test)  loss: 0.5271 -> 0.5050   acc: 82.57% -> 83.72%             
client [11] (test)  loss: 0.8571 -> 0.7920   acc: 67.97% -> 70.78%             
client [96] (test)  loss: 0.5632 -> 0.5086   acc: 85.35% -> 86.15%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5467 -> 0.5479   acc: 83.07% -> 82.55%              
client [53] (test)  loss: 0.8442 -> 0.7987   acc: 69.77% -> 70.93%             
client [52] (test)  loss: 0.7088 -> 0.6984   acc: 73.11% -> 76.07%             
client [42] (test)  loss: 0.4900 -> 0.4792   acc: 85.55% -> 84.86%             
client [69] (test)  loss: 0.8043 -> 0.7654   acc: 74.07% -> 73.50%             
client [59] (test)  loss: 0.4429 -> 0.4407   acc: 84.49% -> 84.82%             
client [7] (test)  loss: 0.6822 -> 0.4543   acc: 83.61% -> 89.18%              
client [26] (test)  loss: 0.3501 -> 0.3182   acc: 88.82% -> 90.03%             
client [49] (test)  loss: 1.1174 -> 1.0604   acc: 57.45% -> 58.30%             
client [98] (test)  loss: 0.8958 -> 0.8803   acc: 66.67% -> 66.67%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8517 -> 0.8394   acc: 69.30% -> 68.42%             
client [47] (test)  loss: 0.4743 -> 0.4109   acc: 87.75% -> 86.09%             
client [21] (test)  loss: 1.2065 -> 1.1836   acc: 55.59% -> 57.29%             
client [77] (test)  loss: 0.5664 -> 0.5602   acc: 83.09% -> 82.61%             
client [95] (test)  loss: 0.4219 -> 0.4116   acc: 86.03% -> 85.66%             
client [91] (test)  loss: 0.6565 -> 0.6296   acc: 75.33% -> 76.65%             
client [14] (test)  loss: 0.7010 -> 0.6728   acc: 80.62% -> 79.84%             
client [99] (test)  loss: 0.7207 -> 0.6922   acc: 86.29% -> 87.10%             
client [20] (test)  loss: 0.7494 -> 0.7479   acc: 76.86% -> 73.55%             
client [39] (test)  loss: 0.7977 -> 0.7442   acc: 72.46% -> 75.42%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6326 -> 0.6246   acc: 77.70% -> 80.00%             
client [62] (test)  loss: 0.2782 -> 0.2595   acc: 90.11% -> 90.93%             
client [71] (test)  loss: 0.4996 -> 0.4548   acc: 84.02% -> 85.05%             
client [97] (test)  loss: 0.4720 -> 0.4315   acc: 84.20% -> 84.20%             
client [30] (test)  loss: 0.6467 -> 0.6490   acc: 77.36% -> 76.01%             
client [88] (test)  loss: 0.5670 -> 0.5437   acc: 81.11% -> 82.03%             
client [60] (test)  loss: 0.5569 -> 0.5519   acc: 85.42% -> 85.00%             
client [82] (test)  loss: 1.1217 -> 1.0973   acc: 60.26% -> 61.26%             
client [91] (test)  loss: 0.6035 -> 0.5768   acc: 78.41% -> 79.74%             
client [57] (test)  loss: 0.4442 -> 0.4166   acc: 88.98% -> 86.83%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4740 -> 0.4899   acc: 84.75% -> 85.42%             
client [15] (test)  loss: 0.3667 -> 0.3740   acc: 88.05% -> 88.05%             
client [71] (test)  loss: 0.4491 -> 0.4196   acc: 87.11% -> 89.18%             
client [97] (test)  loss: 0.4040 -> 0.3860   acc: 86.56% -> 88.21%             
client [53] (test)  loss: 0.6634 -> 0.6341   acc: 77.91% -> 78.20%             
client [77] (test)  loss: 0.4899 -> 0.4907   acc: 85.51% -> 84.54%             
client [76] (test)  loss: 0.6559 -> 0.7749   acc: 79.66% -> 75.52%             
client [79] (test)  loss: 0.3765 -> 0.3672   acc: 90.77% -> 90.00%             
client [28] (test)  loss: 0.5766 -> 0.5576   acc: 83.66% -> 86.27%             
client [99] (test)  loss: 0.6411 -> 0.6161   acc: 86.29% -> 87.10%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3766 -> 0.3573   acc: 88.68% -> 89.15%             
client [86] (test)  loss: 0.6270 -> 0.6184   acc: 82.99% -> 83.51%             
client [34] (test)  loss: 0.4999 -> 0.4715   acc: 86.89% -> 87.21%             
client [73] (test)  loss: 0.1287 -> 0.1232   acc: 97.60% -> 97.12%             
client [5] (test)  loss: 0.4365 -> 0.4340   acc: 86.25% -> 86.25%              
client [96] (test)  loss: 0.4143 -> 0.3811   acc: 89.53% -> 89.86%             
client [22] (test)  loss: 0.4840 -> 0.4639   acc: 84.52% -> 84.94%             
client [60] (test)  loss: 0.4804 -> 0.4661   acc: 85.83% -> 85.42%             
client [66] (test)  loss: 0.5946 -> 0.5718   acc: 83.33% -> 84.95%             
client [83] (test)  loss: 0.2248 -> 0.2073   acc: 94.33% -> 94.33%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5941 -> 0.6562   acc: 81.03% -> 79.31%             
client [65] (test)  loss: 0.6164 -> 0.6026   acc: 81.30% -> 81.71%             
client [95] (test)  loss: 0.3532 -> 0.3411   acc: 87.87% -> 88.60%             
client [17] (test)  loss: 0.4836 -> 0.4200   acc: 84.76% -> 88.85%             
client [8] (test)  loss: 0.3718 -> 0.3988   acc: 88.54% -> 86.98%              
client [35] (test)  loss: 0.6550 -> 0.6481   acc: 76.61% -> 78.21%             
client [98] (test)  loss: 0.7402 -> 0.7257   acc: 74.27% -> 72.81%             
client [53] (test)  loss: 0.5928 -> 0.5712   acc: 79.65% -> 79.07%             
client [43] (test)  loss: 0.2475 -> 0.1936   acc: 91.92% -> 93.94%             
client [64] (test)  loss: 0.7663 -> 0.7144   acc: 70.93% -> 72.87%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.0338 -> 0.9981   acc: 64.07% -> 65.08%             
client [88] (test)  loss: 0.4666 -> 0.4727   acc: 84.33% -> 84.79%             
client [38] (test)  loss: 0.4127 -> 0.3952   acc: 87.63% -> 87.63%             
client [3] (test)  loss: 0.5064 -> 0.5030   acc: 81.88% -> 83.17%              
client [5] (test)  loss: 0.4008 -> 0.3896   acc: 86.99% -> 88.48%              
client [41] (test)  loss: 0.9113 -> 0.9916   acc: 69.58% -> 65.57%             
client [7] (test)  loss: 0.3530 -> 0.3243   acc: 90.16% -> 89.84%              
client [37] (test)  loss: 0.4479 -> 0.4292   acc: 89.57% -> 89.21%             
client [45] (test)  loss: 0.5258 -> 0.4621   acc: 79.60% -> 85.28%             
client [47] (test)  loss: 0.3332 -> 0.3054   acc: 86.75% -> 89.07%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6637 -> 0.7004   acc: 76.95% -> 76.95%             
client [11] (test)  loss: 0.5046 -> 0.5747   acc: 82.90% -> 79.65%             
client [37] (test)  loss: 0.4052 -> 0.3969   acc: 89.21% -> 90.65%             
client [41] (test)  loss: 0.8654 -> 0.9843   acc: 70.28% -> 65.09%             
client [95] (test)  loss: 0.3377 -> 0.3250   acc: 88.24% -> 88.97%             
client [53] (test)  loss: 0.5637 -> 0.5360   acc: 81.10% -> 81.10%             
client [22] (test)  loss: 0.4473 -> 0.4092   acc: 84.10% -> 87.45%             
client [25] (test)  loss: 0.5850 -> 0.5898   acc: 77.57% -> 78.04%             
client [69] (test)  loss: 0.5188 -> 0.5080   acc: 81.48% -> 80.06%             
client [46] (test)  loss: 0.6401 -> 0.6300   acc: 79.64% -> 78.44%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2838 -> 0.2753   acc: 89.07% -> 89.40%             
client [69] (test)  loss: 0.4952 -> 0.4909   acc: 81.77% -> 81.20%             
client [82] (test)  loss: 0.9560 -> 0.9265   acc: 63.91% -> 68.21%             
client [45] (test)  loss: 0.4440 -> 0.4182   acc: 84.28% -> 85.95%             
client [7] (test)  loss: 0.3271 -> 0.3047   acc: 89.84% -> 90.16%              
client [50] (test)  loss: 0.5198 -> 0.6646   acc: 84.54% -> 78.35%             
client [35] (test)  loss: 0.5735 -> 0.5715   acc: 78.44% -> 79.82%             
client [24] (test)  loss: 0.6098 -> 0.6014   acc: 79.91% -> 80.80%             
client [15] (test)  loss: 0.2577 -> 0.2754   acc: 91.81% -> 91.15%             
client [58] (test)  loss: 0.3561 -> 0.3700   acc: 87.96% -> 87.04%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.4216 -> 0.4499   acc: 87.97% -> 87.70%             
client [76] (test)  loss: 0.5181 -> 0.6003   acc: 83.79% -> 79.66%             
client [67] (test)  loss: 0.4605 -> 0.5758   acc: 84.18% -> 79.43%             
client [37] (test)  loss: 0.3677 -> 0.3599   acc: 91.01% -> 91.37%             
client [58] (test)  loss: 0.3478 -> 0.3505   acc: 87.65% -> 88.27%             
client [64] (test)  loss: 0.6081 -> 0.5698   acc: 79.07% -> 81.01%             
client [77] (test)  loss: 0.3867 -> 0.3739   acc: 90.34% -> 91.79%             
client [55] (test)  loss: 0.1415 -> 0.1391   acc: 96.08% -> 96.08%             
client [12] (test)  loss: 0.6250 -> 0.5886   acc: 78.91% -> 80.27%             
client [89] (test)  loss: 0.6815 -> 0.6920   acc: 78.28% -> 77.15%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7226 -> 0.7380   acc: 69.38% -> 70.68%             
client [51] (test)  loss: 0.6788 -> 0.6724   acc: 79.63% -> 79.63%             
client [8] (test)  loss: 0.3238 -> 0.3398   acc: 90.10% -> 89.06%              
client [18] (test)  loss: 0.4746 -> 0.4668   acc: 85.15% -> 85.45%             
client [94] (test)  loss: 0.3335 -> 0.3348   acc: 87.25% -> 87.25%             
client [81] (test)  loss: 0.1849 -> 0.1833   acc: 94.71% -> 94.93%             
client [3] (test)  loss: 0.4355 -> 0.4437   acc: 84.79% -> 86.41%              
client [11] (test)  loss: 0.4664 -> 0.5658   acc: 85.50% -> 80.30%             
client [95] (test)  loss: 0.3309 -> 0.3201   acc: 87.50% -> 88.24%             
client [67] (test)  loss: 0.4505 -> 0.5545   acc: 85.44% -> 80.38%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.9027 -> 0.8836   acc: 69.49% -> 69.49%             
client [79] (test)  loss: 0.2680 -> 0.2614   acc: 92.31% -> 93.08%             
client [58] (test)  loss: 0.3286 -> 0.3266   acc: 88.27% -> 87.96%             
client [88] (test)  loss: 0.4296 -> 0.4187   acc: 84.79% -> 85.25%             
client [46] (test)  loss: 0.5381 -> 0.5403   acc: 83.23% -> 83.83%             
client [11] (test)  loss: 0.4582 -> 0.5487   acc: 85.28% -> 80.74%             
client [55] (test)  loss: 0.1307 -> 0.1312   acc: 96.61% -> 96.08%             
client [13] (test)  loss: 0.1962 -> 0.1940   acc: 93.70% -> 93.95%             
client [31] (test)  loss: 0.3808 -> 0.4419   acc: 86.78% -> 87.12%             
client [75] (test)  loss: 0.1072 -> 0.0995   acc: 96.96% -> 96.96%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5446 -> 0.5408   acc: 85.59% -> 83.84%             
client [7] (test)  loss: 0.2503 -> 0.2635   acc: 90.49% -> 90.16%              
client [57] (test)  loss: 0.2637 -> 0.2715   acc: 93.01% -> 91.94%             
client [13] (test)  loss: 0.1847 -> 0.1854   acc: 93.95% -> 93.95%             
client [43] (test)  loss: 0.1865 -> 0.1436   acc: 93.94% -> 96.72%             
client [91] (test)  loss: 0.3798 -> 0.3737   acc: 86.34% -> 88.55%             
client [10] (test)  loss: 0.1294 -> 0.1318   acc: 95.81% -> 95.81%             
client [64] (test)  loss: 0.5244 -> 0.5178   acc: 81.78% -> 85.27%             
client [82] (test)  loss: 0.8516 -> 0.8631   acc: 69.21% -> 70.20%             
client [22] (test)  loss: 0.3744 -> 0.3555   acc: 87.03% -> 89.96%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5385 -> 0.5220   acc: 85.12% -> 84.30%             
client [23] (test)  loss: 0.5945 -> 0.6055   acc: 81.82% -> 81.82%             
client [88] (test)  loss: 0.4520 -> 0.4129   acc: 84.33% -> 85.25%             
client [98] (test)  loss: 0.5867 -> 0.5813   acc: 80.12% -> 80.41%             
client [79] (test)  loss: 0.2442 -> 0.2388   acc: 93.85% -> 94.62%             
client [21] (test)  loss: 0.8817 -> 0.8465   acc: 70.17% -> 71.19%             
client [92] (test)  loss: 0.7288 -> 0.7253   acc: 72.57% -> 74.29%             
client [56] (test)  loss: 0.3320 -> 0.3285   acc: 88.06% -> 88.59%             
client [5] (test)  loss: 0.3127 -> 0.3158   acc: 90.33% -> 91.08%              
client [52] (test)  loss: 0.4267 -> 0.4635   acc: 85.57% -> 85.57%             
==================== FedRep_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.5601 -> 0.0000', 'accuracy': '81.80% -> 0.00%'},          
    200: {'loss': '0.3989 -> 0.0000', 'accuracy': '86.86% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_0.5 achieved 10.0%(13.73%) at epoch: 0                                  
FedRep_0.5 achieved 20.0%(23.71%) at epoch: 1                                  
FedRep_0.5 achieved 30.0%(37.83%) at epoch: 3                                  
FedRep_0.5 achieved 40.0%(42.08%) at epoch: 4                                  
FedRep_0.5 achieved 50.0%(50.63%) at epoch: 9                                  
FedRep_0.5 achieved 60.0%(63.83%) at epoch: 20                                 
FedRep_0.5 achieved 70.0%(70.35%) at epoch: 28                                 
FedRep_0.5 achieved 80.0%(80.01%) at epoch: 57                                 
FedRep_0.5 achieved 90.0%(90.22%) at epoch: 173                                
Convergence (test_after):                                                      
FedRep_0.5 achieved 50.0%(50.40%) at epoch: 0                                  
FedRep_0.5 achieved 60.0%(60.51%) at epoch: 10                                 
FedRep_0.5 achieved 70.0%(71.51%) at epoch: 20                                 
FedRep_0.5 achieved 80.0%(80.18%) at epoch: 57                                 
