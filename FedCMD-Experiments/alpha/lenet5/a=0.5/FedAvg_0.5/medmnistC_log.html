==================== ALGORITHM: FedAvg_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0165 -> 1.0754   acc: 50.49% -> 56.31%             
client [81] (test)  loss: 1.9363 -> 1.6974   acc: 28.83% -> 35.14%             
client [21] (test)  loss: 2.2456 -> 1.0571   acc: 20.35% -> 70.80%             
client [68] (test)  loss: 2.1977 -> 1.8396   acc: 22.11% -> 29.47%             
client [93] (test)  loss: 1.9413 -> 1.3139   acc: 41.73% -> 62.20%             
client [31] (test)  loss: 2.0240 -> 0.9577   acc: 29.75% -> 72.73%             
client [20] (test)  loss: 1.0616 -> 0.3936   acc: 84.97% -> 87.58%             
client [59] (test)  loss: 2.1520 -> 1.1456   acc: 68.03% -> 66.39%             
client [48] (test)  loss: 1.2625 -> 0.7626   acc: 69.90% -> 73.79%             
client [34] (test)  loss: 2.1190 -> 1.7079   acc: 9.59% -> 28.77%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6767 -> 1.2884   acc: 36.26% -> 48.35%             
client [99] (test)  loss: 1.8604 -> 1.3143   acc: 41.43% -> 65.71%             
client [67] (test)  loss: 1.8112 -> 0.7894   acc: 34.42% -> 73.38%             
client [0] (test)  loss: 1.6669 -> 0.3794   acc: 44.51% -> 90.75%              
client [76] (test)  loss: 1.7442 -> 0.6984   acc: 32.35% -> 77.94%             
client [41] (test)  loss: 1.8063 -> 0.8659   acc: 42.18% -> 76.87%             
client [62] (test)  loss: 2.2310 -> 0.6938   acc: 5.15% -> 83.82%              
client [2] (test)  loss: 2.1322 -> 0.9730   acc: 31.25% -> 80.21%              
client [14] (test)  loss: 1.1259 -> 0.7045   acc: 75.40% -> 80.95%             
client [46] (test)  loss: 0.7805 -> 0.4479   acc: 75.40% -> 85.71%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.0899 -> 0.8035   acc: 61.34% -> 73.95%             
client [68] (test)  loss: 1.4167 -> 0.9128   acc: 43.16% -> 69.47%             
client [57] (test)  loss: 1.8606 -> 0.7842   acc: 15.79% -> 72.93%             
client [17] (test)  loss: 2.0320 -> 0.4357   acc: 20.53% -> 88.74%             
client [54] (test)  loss: 1.3831 -> 0.7723   acc: 49.64% -> 75.54%             
client [23] (test)  loss: 2.0840 -> 1.3569   acc: 14.17% -> 54.33%             
client [35] (test)  loss: 1.2911 -> 1.1172   acc: 56.84% -> 49.47%             
client [59] (test)  loss: 0.7271 -> 0.4603   acc: 77.87% -> 81.97%             
client [31] (test)  loss: 1.0219 -> 0.4768   acc: 68.60% -> 80.99%             
client [9] (test)  loss: 1.2323 -> 1.0794   acc: 63.83% -> 57.45%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.3832 -> 0.4382   acc: 47.30% -> 87.16%             
client [33] (test)  loss: 1.0851 -> 0.7114   acc: 65.96% -> 73.05%             
client [16] (test)  loss: 0.9425 -> 0.5321   acc: 69.54% -> 80.79%             
client [44] (test)  loss: 4.1246 -> 0.0148   acc: 1.52% -> 100.00%             
client [8] (test)  loss: 0.5637 -> 0.2817   acc: 83.06% -> 92.74%              
client [31] (test)  loss: 0.6545 -> 0.4100   acc: 76.86% -> 83.47%             
client [47] (test)  loss: 0.9281 -> 0.6650   acc: 66.67% -> 80.30%             
client [36] (test)  loss: 1.1861 -> 0.6208   acc: 63.89% -> 84.72%             
client [20] (test)  loss: 0.8487 -> 0.2050   acc: 81.05% -> 94.12%             
client [56] (test)  loss: 1.1987 -> 0.5089   acc: 57.78% -> 81.48%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5492 -> 0.2276   acc: 83.51% -> 94.15%              
client [60] (test)  loss: 1.0151 -> 0.8415   acc: 64.71% -> 71.76%             
client [28] (test)  loss: 1.6395 -> 0.6738   acc: 50.94% -> 79.25%             
client [25] (test)  loss: 1.4273 -> 0.5352   acc: 52.94% -> 80.67%             
client [58] (test)  loss: 1.4315 -> 0.8977   acc: 42.86% -> 69.92%             
client [44] (test)  loss: 2.6869 -> 0.0081   acc: 40.15% -> 100.00%            
client [39] (test)  loss: 0.6809 -> 0.4405   acc: 82.27% -> 82.27%             
client [29] (test)  loss: 1.2960 -> 0.3257   acc: 52.54% -> 91.53%             
client [3] (test)  loss: 0.5346 -> 0.3241   acc: 87.75% -> 90.51%              
client [84] (test)  loss: 1.2316 -> 0.6257   acc: 48.74% -> 80.67%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.8163 -> 0.3242   acc: 42.92% -> 91.15%             
client [84] (test)  loss: 1.0436 -> 0.6360   acc: 57.14% -> 80.67%             
client [10] (test)  loss: 1.2879 -> 0.3962   acc: 51.13% -> 87.97%             
client [36] (test)  loss: 1.0073 -> 0.5025   acc: 61.11% -> 86.11%             
client [65] (test)  loss: 0.9176 -> 0.5192   acc: 68.85% -> 79.51%             
client [81] (test)  loss: 0.7941 -> 0.4639   acc: 70.27% -> 89.19%             
client [79] (test)  loss: 0.6894 -> 0.2744   acc: 76.76% -> 94.37%             
client [42] (test)  loss: 0.9401 -> 0.7621   acc: 71.43% -> 76.19%             
client [11] (test)  loss: 1.1456 -> 0.8095   acc: 54.29% -> 74.29%             
client [96] (test)  loss: 0.4456 -> 0.0417   acc: 85.37% -> 98.78%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3161 -> 0.1711   acc: 89.52% -> 93.55%              
client [53] (test)  loss: 0.7770 -> 0.3346   acc: 72.26% -> 87.59%             
client [52] (test)  loss: 0.7828 -> 0.4045   acc: 78.26% -> 84.47%             
client [42] (test)  loss: 1.0273 -> 0.6799   acc: 70.63% -> 79.37%             
client [69] (test)  loss: 0.8564 -> 0.6344   acc: 71.43% -> 78.02%             
client [59] (test)  loss: 0.2759 -> 0.1860   acc: 91.80% -> 94.26%             
client [7] (test)  loss: 0.5353 -> 0.4857   acc: 83.48% -> 84.35%              
client [26] (test)  loss: 0.6476 -> 0.3173   acc: 76.86% -> 89.26%             
client [49] (test)  loss: 0.5031 -> 0.2689   acc: 81.48% -> 91.11%             
client [98] (test)  loss: 1.8680 -> 0.4571   acc: 36.67% -> 80.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4775 -> 0.4399   acc: 55.00% -> 81.67%             
client [47] (test)  loss: 0.7323 -> 0.4461   acc: 69.70% -> 87.88%             
client [21] (test)  loss: 1.2030 -> 0.2568   acc: 59.29% -> 92.48%             
client [77] (test)  loss: 0.5590 -> 0.2799   acc: 80.58% -> 91.26%             
client [95] (test)  loss: 0.7295 -> 0.2218   acc: 78.23% -> 93.20%             
client [91] (test)  loss: 0.8694 -> 0.3100   acc: 70.54% -> 93.02%             
client [14] (test)  loss: 0.4784 -> 0.3257   acc: 86.51% -> 87.30%             
client [99] (test)  loss: 0.8344 -> 0.5924   acc: 72.86% -> 84.29%             
client [20] (test)  loss: 1.0746 -> 0.2170   acc: 75.16% -> 96.08%             
client [39] (test)  loss: 0.4174 -> 0.3414   acc: 86.21% -> 88.18%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7028 -> 0.3419   acc: 80.12% -> 87.58%             
client [62] (test)  loss: 0.6169 -> 0.3205   acc: 82.35% -> 90.44%             
client [71] (test)  loss: 1.1662 -> 0.5631   acc: 72.55% -> 81.37%             
client [97] (test)  loss: 0.6723 -> 0.4470   acc: 80.00% -> 86.00%             
client [30] (test)  loss: 0.5338 -> 0.3114   acc: 83.61% -> 90.16%             
client [88] (test)  loss: 1.5130 -> 0.5591   acc: 50.76% -> 79.55%             
client [60] (test)  loss: 0.7980 -> 0.7222   acc: 75.29% -> 80.00%             
client [82] (test)  loss: 1.1509 -> 0.3659   acc: 65.65% -> 86.26%             
client [91] (test)  loss: 1.0726 -> 0.2987   acc: 65.89% -> 94.57%             
client [57] (test)  loss: 1.1022 -> 0.4146   acc: 65.41% -> 82.71%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4228 -> 0.2550   acc: 80.17% -> 93.39%             
client [15] (test)  loss: 1.2138 -> 0.6443   acc: 63.64% -> 84.85%             
client [71] (test)  loss: 1.1332 -> 0.5465   acc: 71.57% -> 82.35%             
client [97] (test)  loss: 0.5472 -> 0.4220   acc: 82.00% -> 84.00%             
client [53] (test)  loss: 0.5324 -> 0.3818   acc: 83.21% -> 89.05%             
client [77] (test)  loss: 1.0721 -> 0.2837   acc: 65.05% -> 91.26%             
client [76] (test)  loss: 0.3465 -> 0.2906   acc: 88.24% -> 91.18%             
client [79] (test)  loss: 0.6148 -> 0.2365   acc: 79.58% -> 95.07%             
client [28] (test)  loss: 0.7259 -> 0.7249   acc: 75.47% -> 79.25%             
client [99] (test)  loss: 1.1577 -> 0.5421   acc: 61.43% -> 85.71%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7804 -> 0.4297   acc: 74.00% -> 86.00%             
client [86] (test)  loss: 0.3339 -> 0.2296   acc: 88.64% -> 93.18%             
client [34] (test)  loss: 0.7530 -> 0.5741   acc: 75.34% -> 82.19%             
client [73] (test)  loss: 0.7923 -> 0.6526   acc: 74.56% -> 79.82%             
client [5] (test)  loss: 0.7893 -> 0.3738   acc: 78.82% -> 87.06%              
client [96] (test)  loss: 0.2559 -> 0.0266   acc: 91.46% -> 99.39%             
client [22] (test)  loss: 0.5773 -> 0.4088   acc: 77.06% -> 81.65%             
client [60] (test)  loss: 0.6774 -> 0.6948   acc: 75.29% -> 82.35%             
client [66] (test)  loss: 0.5304 -> 0.1977   acc: 82.14% -> 94.64%             
client [83] (test)  loss: 0.6470 -> 0.2013   acc: 76.17% -> 93.93%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4441 -> 0.2737   acc: 86.03% -> 92.65%             
client [65] (test)  loss: 0.7775 -> 0.4457   acc: 75.41% -> 83.61%             
client [95] (test)  loss: 0.6319 -> 0.2042   acc: 80.27% -> 93.88%             
client [17] (test)  loss: 1.1430 -> 0.2547   acc: 58.28% -> 92.05%             
client [8] (test)  loss: 0.5018 -> 0.1273   acc: 79.84% -> 95.97%              
client [35] (test)  loss: 0.6014 -> 0.6020   acc: 77.89% -> 73.68%             
client [98] (test)  loss: 3.3878 -> 0.4554   acc: 21.67% -> 85.00%             
client [53] (test)  loss: 0.4973 -> 0.3431   acc: 83.21% -> 90.51%             
client [43] (test)  loss: 1.8313 -> 0.3596   acc: 55.74% -> 88.52%             
client [64] (test)  loss: 0.3914 -> 0.2162   acc: 86.49% -> 91.22%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.4869 -> 0.1738   acc: 53.54% -> 94.69%             
client [88] (test)  loss: 1.7286 -> 0.4682   acc: 50.00% -> 84.85%             
client [38] (test)  loss: 0.5428 -> 0.2995   acc: 86.27% -> 92.16%             
client [3] (test)  loss: 0.2644 -> 0.2146   acc: 92.89% -> 93.68%              
client [5] (test)  loss: 0.6611 -> 0.3420   acc: 77.65% -> 89.41%              
client [41] (test)  loss: 1.1451 -> 0.2056   acc: 64.63% -> 91.84%             
client [7] (test)  loss: 0.5180 -> 0.4036   acc: 82.61% -> 88.70%              
client [37] (test)  loss: 1.3581 -> 0.3542   acc: 56.38% -> 89.26%             
client [45] (test)  loss: 0.3659 -> 0.1455   acc: 89.39% -> 96.97%             
client [47] (test)  loss: 0.4904 -> 0.4276   acc: 87.88% -> 87.88%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6674 -> 0.3742   acc: 79.47% -> 86.75%             
client [11] (test)  loss: 0.7997 -> 0.7068   acc: 74.29% -> 78.57%             
client [37] (test)  loss: 1.3445 -> 0.3442   acc: 60.40% -> 89.93%             
client [41] (test)  loss: 1.3184 -> 0.2017   acc: 62.59% -> 91.84%             
client [95] (test)  loss: 0.5134 -> 0.1991   acc: 84.35% -> 93.88%             
client [53] (test)  loss: 0.6626 -> 0.3254   acc: 75.91% -> 89.05%             
client [22] (test)  loss: 0.5492 -> 0.3976   acc: 80.73% -> 85.32%             
client [25] (test)  loss: 0.7203 -> 0.3851   acc: 78.15% -> 86.55%             
client [69] (test)  loss: 0.9989 -> 0.5065   acc: 67.03% -> 83.52%             
client [46] (test)  loss: 0.2187 -> 0.1830   acc: 92.06% -> 95.24%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4826 -> 0.3853   acc: 84.85% -> 87.88%             
client [69] (test)  loss: 0.9310 -> 0.5261   acc: 68.13% -> 82.42%             
client [82] (test)  loss: 0.4827 -> 0.2675   acc: 81.68% -> 90.84%             
client [45] (test)  loss: 0.3765 -> 0.1449   acc: 90.15% -> 96.21%             
client [7] (test)  loss: 0.5788 -> 0.4086   acc: 79.13% -> 89.57%              
client [50] (test)  loss: 0.7105 -> 0.2775   acc: 75.94% -> 90.98%             
client [35] (test)  loss: 0.6255 -> 0.6072   acc: 77.89% -> 73.68%             
client [24] (test)  loss: 0.7779 -> 0.3275   acc: 73.11% -> 88.24%             
client [15] (test)  loss: 0.7544 -> 0.5403   acc: 78.79% -> 87.88%             
client [58] (test)  loss: 0.8286 -> 0.6103   acc: 69.92% -> 81.20%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3232 -> 0.1617   acc: 89.32% -> 96.12%             
client [76] (test)  loss: 0.3964 -> 0.2876   acc: 88.24% -> 93.38%             
client [67] (test)  loss: 0.6356 -> 0.3110   acc: 79.87% -> 88.96%             
client [37] (test)  loss: 1.6090 -> 0.3560   acc: 57.05% -> 90.60%             
client [58] (test)  loss: 0.7939 -> 0.6116   acc: 74.44% -> 79.70%             
client [64] (test)  loss: 0.2266 -> 0.1901   acc: 91.22% -> 93.24%             
client [77] (test)  loss: 0.4518 -> 0.2306   acc: 83.50% -> 89.32%             
client [55] (test)  loss: 0.8920 -> 0.6256   acc: 72.12% -> 76.92%             
client [12] (test)  loss: 0.7200 -> 0.4583   acc: 70.94% -> 81.20%             
client [89] (test)  loss: 0.7674 -> 0.4944   acc: 72.86% -> 77.14%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.8317 -> 0.6026   acc: 73.95% -> 78.99%             
client [51] (test)  loss: 0.4170 -> 0.2306   acc: 82.41% -> 90.74%             
client [8] (test)  loss: 0.3773 -> 0.1358   acc: 84.68% -> 96.77%              
client [18] (test)  loss: 0.4136 -> 0.3367   acc: 85.98% -> 87.85%             
client [94] (test)  loss: 0.6264 -> 0.0317   acc: 81.15% -> 99.18%             
client [81] (test)  loss: 0.4311 -> 0.2894   acc: 84.68% -> 91.89%             
client [3] (test)  loss: 0.3666 -> 0.1940   acc: 87.75% -> 94.07%              
client [11] (test)  loss: 0.9613 -> 0.6455   acc: 68.57% -> 84.29%             
client [95] (test)  loss: 0.4086 -> 0.1720   acc: 85.03% -> 95.92%             
client [67] (test)  loss: 1.0299 -> 0.3142   acc: 66.88% -> 88.31%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.2364 -> 0.1548   acc: 63.72% -> 95.13%             
client [79] (test)  loss: 0.3154 -> 0.2073   acc: 90.14% -> 94.37%             
client [58] (test)  loss: 0.7234 -> 0.6166   acc: 74.44% -> 80.45%             
client [88] (test)  loss: 1.7834 -> 0.4306   acc: 53.03% -> 85.61%             
client [46] (test)  loss: 0.2438 -> 0.1669   acc: 94.44% -> 93.65%             
client [11] (test)  loss: 0.7591 -> 0.6637   acc: 70.00% -> 82.86%             
client [55] (test)  loss: 1.1329 -> 0.6205   acc: 67.31% -> 76.92%             
client [13] (test)  loss: 0.8260 -> 0.3224   acc: 69.01% -> 84.51%             
client [31] (test)  loss: 0.4793 -> 0.1873   acc: 83.47% -> 92.56%             
client [75] (test)  loss: 0.4175 -> 0.3535   acc: 83.02% -> 84.91%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6204 -> 0.3343   acc: 81.32% -> 90.11%             
client [7] (test)  loss: 0.4494 -> 0.3907   acc: 86.96% -> 87.83%              
client [57] (test)  loss: 0.6423 -> 0.3842   acc: 79.70% -> 85.71%             
client [13] (test)  loss: 0.7138 -> 0.3382   acc: 71.83% -> 87.32%             
client [43] (test)  loss: 0.9490 -> 0.2988   acc: 71.31% -> 90.98%             
client [91] (test)  loss: 1.8204 -> 0.2445   acc: 52.71% -> 94.57%             
client [10] (test)  loss: 0.6323 -> 0.2510   acc: 76.69% -> 90.23%             
client [64] (test)  loss: 0.2700 -> 0.1802   acc: 89.19% -> 93.92%             
client [82] (test)  loss: 0.7515 -> 0.2512   acc: 73.28% -> 91.60%             
client [22] (test)  loss: 0.4838 -> 0.3267   acc: 79.82% -> 88.07%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0646 -> 0.2574   acc: 73.86% -> 95.42%             
client [23] (test)  loss: 0.5092 -> 0.4668   acc: 81.89% -> 85.83%             
client [88] (test)  loss: 1.4112 -> 0.4072   acc: 56.06% -> 85.61%             
client [98] (test)  loss: 1.0467 -> 0.4691   acc: 68.33% -> 83.33%             
client [79] (test)  loss: 0.4310 -> 0.1768   acc: 89.44% -> 95.07%             
client [21] (test)  loss: 0.9225 -> 0.1425   acc: 69.91% -> 95.58%             
client [92] (test)  loss: 0.4294 -> 0.4400   acc: 86.73% -> 88.78%             
client [56] (test)  loss: 0.5417 -> 0.2082   acc: 77.04% -> 91.85%             
client [5] (test)  loss: 0.5092 -> 0.3172   acc: 84.71% -> 91.76%              
client [52] (test)  loss: 0.4256 -> 0.2521   acc: 87.58% -> 90.68%             
==================== FedAvg_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.7920 -> 0.0000', 'accuracy': '75.24% -> 0.00%'},          
    200: {'loss': '0.6447 -> 0.0000', 'accuracy': '80.28% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_0.5 achieved 10.0%(13.52%) at epoch: 0                                  
FedAvg_0.5 achieved 20.0%(21.60%) at epoch: 1                                  
FedAvg_0.5 achieved 40.0%(46.29%) at epoch: 6                                  
FedAvg_0.5 achieved 50.0%(52.10%) at epoch: 22                                 
FedAvg_0.5 achieved 60.0%(61.84%) at epoch: 27                                 
FedAvg_0.5 achieved 70.0%(72.34%) at epoch: 38                                 
FedAvg_0.5 achieved 80.0%(80.59%) at epoch: 77                                 
Convergence (test_after):                                                      
FedAvg_0.5 achieved 40.0%(45.42%) at epoch: 0                                  
FedAvg_0.5 achieved 50.0%(53.66%) at epoch: 3                                  
FedAvg_0.5 achieved 60.0%(67.30%) at epoch: 6                                  
FedAvg_0.5 achieved 70.0%(72.89%) at epoch: 14                                 
FedAvg_0.5 achieved 80.0%(84.03%) at epoch: 24                                 
FedAvg_0.5 achieved 90.0%(90.55%) at epoch: 77                                 
