==================== ALGORITHM: FedAvg_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.8845 -> 1.6640   acc: 37.35% -> 43.03%             
client [81] (test)  loss: 2.1826 -> 1.1801   acc: 23.32% -> 59.56%             
client [21] (test)  loss: 48.9220 -> 0.5244   acc: 39.04% -> 80.58%            
client [68] (test)  loss: 1.3865 -> 0.0584   acc: 56.81% -> 98.85%             
client [93] (test)  loss: 1.9330 -> 0.6407   acc: 23.89% -> 73.97%             
client [31] (test)  loss: 0.7917 -> 0.0173   acc: 85.79% -> 99.83%             
client [20] (test)  loss: 1.7509 -> 1.1465   acc: 41.30% -> 65.18%             
client [59] (test)  loss: 68.5508 -> 1.0895   acc: 23.01% -> 66.32%            
client [48] (test)  loss: 1.5948 -> 1.4238   acc: 46.96% -> 46.61%             
client [34] (test)  loss: 2.4641 -> 1.2742   acc: 14.84% -> 49.03%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.8670 -> 0.9255   acc: 32.99% -> 68.75%             
client [99] (test)  loss: 1.2080 -> 0.5257   acc: 65.69% -> 83.14%             
client [67] (test)  loss: 1.2799 -> 0.5146   acc: 50.50% -> 84.23%             
client [0] (test)  loss: 1.3128 -> 0.6456   acc: 53.81% -> 77.54%              
client [76] (test)  loss: 1.7274 -> 0.4605   acc: 42.81% -> 84.27%             
client [41] (test)  loss: 1.3393 -> 0.6410   acc: 59.68% -> 79.68%             
client [62] (test)  loss: 31.2302 -> 0.3043   acc: 70.20% -> 90.07%            
client [2] (test)  loss: 36.6282 -> 0.4831   acc: 74.71% -> 84.75%             
client [14] (test)  loss: 0.6886 -> 0.3489   acc: 80.27% -> 89.84%             
client [46] (test)  loss: 1.8429 -> 0.8733   acc: 33.27% -> 71.25%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4680 -> 0.3012   acc: 86.80% -> 90.60%             
client [68] (test)  loss: 0.7157 -> 0.0454   acc: 82.21% -> 98.85%             
client [57] (test)  loss: 0.3923 -> 0.2402   acc: 90.40% -> 92.60%             
client [17] (test)  loss: 1.2567 -> 0.6532   acc: 59.03% -> 77.63%             
client [54] (test)  loss: 0.8451 -> 0.8821   acc: 73.75% -> 73.99%             
client [23] (test)  loss: 81.7398 -> 0.3866   acc: 57.25% -> 87.25%            
client [35] (test)  loss: 1.3185 -> 0.5854   acc: 56.36% -> 80.78%             
client [59] (test)  loss: 1.0882 -> 0.7704   acc: 63.18% -> 76.78%             
client [31] (test)  loss: 1.4981 -> 0.0099   acc: 60.49% -> 99.83%             
client [9] (test)  loss: 1.2274 -> 0.6546   acc: 61.45% -> 79.33%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0322 -> 0.6665   acc: 70.20% -> 81.96%             
client [33] (test)  loss: 1.2896 -> 0.5489   acc: 60.10% -> 85.49%             
client [16] (test)  loss: 0.9997 -> 0.3267   acc: 63.45% -> 89.50%             
client [44] (test)  loss: 1.5368 -> 0.2808   acc: 74.39% -> 90.42%             
client [8] (test)  loss: 1.6585 -> 0.3501   acc: 55.19% -> 89.83%              
client [31] (test)  loss: 1.2229 -> 0.0091   acc: 67.24% -> 99.83%             
client [47] (test)  loss: 0.4066 -> 0.1245   acc: 88.90% -> 95.79%             
client [36] (test)  loss: 1.3196 -> 0.9017   acc: 61.16% -> 71.90%             
client [20] (test)  loss: 1.2847 -> 0.5973   acc: 58.50% -> 83.00%             
client [56] (test)  loss: 1.4034 -> 0.6856   acc: 61.35% -> 78.09%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.2473 -> 0.5985   acc: 61.44% -> 82.35%              
client [60] (test)  loss: 0.9314 -> 0.5585   acc: 75.20% -> 82.46%             
client [28] (test)  loss: 0.8144 -> 0.7325   acc: 79.10% -> 78.78%             
client [25] (test)  loss: 1.0084 -> 0.6121   acc: 71.61% -> 82.86%             
client [58] (test)  loss: 0.5354 -> 0.4875   acc: 84.72% -> 87.74%             
client [44] (test)  loss: 0.8956 -> 0.2639   acc: 74.56% -> 91.64%             
client [39] (test)  loss: 0.8048 -> 0.3799   acc: 76.60% -> 87.71%             
client [29] (test)  loss: 0.7392 -> 0.4876   acc: 81.94% -> 85.46%             
client [3] (test)  loss: 1.5859 -> 0.6640   acc: 51.81% -> 75.05%              
client [84] (test)  loss: 0.8356 -> 0.4154   acc: 73.37% -> 87.71%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7529 -> 0.3221   acc: 81.54% -> 89.62%             
client [84] (test)  loss: 0.7412 -> 0.3784   acc: 76.35% -> 89.57%             
client [10] (test)  loss: 0.7274 -> 0.4322   acc: 81.45% -> 88.46%             
client [36] (test)  loss: 0.8643 -> 0.7173   acc: 75.21% -> 76.03%             
client [65] (test)  loss: 0.5454 -> 0.2621   acc: 83.03% -> 90.82%             
client [81] (test)  loss: 0.9521 -> 0.4506   acc: 70.49% -> 86.34%             
client [79] (test)  loss: 1.0786 -> 0.7306   acc: 69.57% -> 79.15%             
client [42] (test)  loss: 0.6957 -> 0.3506   acc: 75.33% -> 88.40%             
client [11] (test)  loss: 0.7363 -> 0.3340   acc: 79.19% -> 89.50%             
client [96] (test)  loss: 0.7363 -> 0.6077   acc: 81.48% -> 86.30%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9296 -> 0.3349   acc: 73.38% -> 89.61%              
client [53] (test)  loss: 0.9193 -> 0.4183   acc: 71.01% -> 89.93%             
client [52] (test)  loss: 0.6201 -> 0.3082   acc: 82.53% -> 91.42%             
client [42] (test)  loss: 0.9822 -> 0.3532   acc: 70.26% -> 88.73%             
client [69] (test)  loss: 1.4886 -> 0.6125   acc: 58.68% -> 83.33%             
client [59] (test)  loss: 0.8296 -> 0.5574   acc: 76.36% -> 85.77%             
client [7] (test)  loss: 1.5413 -> 0.4088   acc: 58.22% -> 87.03%              
client [26] (test)  loss: 1.4759 -> 0.3019   acc: 61.38% -> 91.80%             
client [49] (test)  loss: 0.8612 -> 0.4687   acc: 74.81% -> 85.97%             
client [98] (test)  loss: 0.7906 -> 0.7122   acc: 75.96% -> 80.70%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8150 -> 0.6806   acc: 77.19% -> 82.63%             
client [47] (test)  loss: 0.3135 -> 0.1217   acc: 91.43% -> 96.63%             
client [21] (test)  loss: 0.4910 -> 0.3106   acc: 88.27% -> 90.58%             
client [77] (test)  loss: 0.9792 -> 0.5378   acc: 70.57% -> 82.79%             
client [95] (test)  loss: 0.2733 -> 0.2096   acc: 95.53% -> 94.94%             
client [91] (test)  loss: 0.7247 -> 0.6467   acc: 81.75% -> 80.54%             
client [14] (test)  loss: 0.3579 -> 0.2616   acc: 91.63% -> 92.83%             
client [99] (test)  loss: 0.8439 -> 0.3742   acc: 76.86% -> 90.00%             
client [20] (test)  loss: 1.0178 -> 0.5398   acc: 72.87% -> 84.41%             
client [39] (test)  loss: 0.7332 -> 0.3734   acc: 80.38% -> 88.89%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8275 -> 0.3034   acc: 77.54% -> 92.20%             
client [62] (test)  loss: 0.4207 -> 0.2071   acc: 85.43% -> 94.37%             
client [71] (test)  loss: 0.8317 -> 0.6679   acc: 74.94% -> 79.76%             
client [97] (test)  loss: 0.8036 -> 0.3533   acc: 74.46% -> 88.51%             
client [30] (test)  loss: 0.4051 -> 0.2173   acc: 87.82% -> 94.55%             
client [88] (test)  loss: 0.5305 -> 0.1780   acc: 84.77% -> 94.68%             
client [60] (test)  loss: 0.6270 -> 0.4992   acc: 82.46% -> 84.88%             
client [82] (test)  loss: 0.5577 -> 0.4068   acc: 84.62% -> 87.18%             
client [91] (test)  loss: 0.6742 -> 0.6183   acc: 82.48% -> 81.51%             
client [57] (test)  loss: 0.3346 -> 0.2031   acc: 91.00% -> 94.60%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.2768 -> 0.0132   acc: 67.59% -> 99.48%             
client [15] (test)  loss: 0.7295 -> 0.4199   acc: 78.84% -> 87.74%             
client [71] (test)  loss: 0.7535 -> 0.6590   acc: 76.14% -> 80.24%             
client [97] (test)  loss: 0.8149 -> 0.3459   acc: 74.46% -> 88.91%             
client [53] (test)  loss: 1.0447 -> 0.3850   acc: 68.30% -> 91.65%             
client [77] (test)  loss: 0.9142 -> 0.5248   acc: 72.46% -> 84.51%             
client [76] (test)  loss: 0.8183 -> 0.3312   acc: 76.10% -> 90.17%             
client [79] (test)  loss: 1.2514 -> 0.6443   acc: 65.96% -> 82.34%             
client [28] (test)  loss: 0.6752 -> 0.6169   acc: 79.10% -> 84.24%             
client [99] (test)  loss: 1.1960 -> 0.3554   acc: 69.41% -> 91.18%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6579 -> 0.3402   acc: 79.21% -> 88.91%             
client [86] (test)  loss: 0.5640 -> 0.3979   acc: 85.38% -> 90.91%             
client [34] (test)  loss: 0.9984 -> 0.6209   acc: 70.32% -> 82.90%             
client [73] (test)  loss: 0.7149 -> 0.3125   acc: 79.22% -> 90.46%             
client [5] (test)  loss: 0.9543 -> 0.1662   acc: 71.60% -> 94.00%              
client [96] (test)  loss: 0.6767 -> 0.7142   acc: 83.15% -> 85.93%             
client [22] (test)  loss: 0.8057 -> 0.7302   acc: 79.89% -> 82.61%             
client [60] (test)  loss: 0.6470 -> 0.5093   acc: 82.46% -> 85.08%             
client [66] (test)  loss: 0.6012 -> 0.0315   acc: 83.88% -> 98.96%             
client [83] (test)  loss: 0.6811 -> 0.4242   acc: 81.82% -> 87.47%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4702 -> 0.3273   acc: 86.54% -> 91.07%             
client [65] (test)  loss: 0.5833 -> 0.2516   acc: 82.63% -> 91.82%             
client [95] (test)  loss: 0.4087 -> 0.1987   acc: 90.27% -> 95.33%             
client [17] (test)  loss: 0.9736 -> 0.5017   acc: 73.05% -> 84.10%             
client [8] (test)  loss: 0.9736 -> 0.3136   acc: 72.94% -> 91.13%              
client [35] (test)  loss: 0.7210 -> 0.4687   acc: 76.88% -> 88.05%             
client [98] (test)  loss: 0.6536 -> 0.6234   acc: 83.33% -> 84.04%             
client [53] (test)  loss: 0.6367 -> 0.3653   acc: 81.57% -> 91.65%             
client [43] (test)  loss: 1.0730 -> 0.6559   acc: 68.70% -> 82.64%             
client [64] (test)  loss: 0.6926 -> 0.5600   acc: 81.96% -> 84.71%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.7747 -> 0.3120   acc: 82.69% -> 91.54%             
client [88] (test)  loss: 0.4830 -> 0.1813   acc: 85.50% -> 94.86%             
client [38] (test)  loss: 0.4480 -> 0.2471   acc: 86.52% -> 93.16%             
client [3] (test)  loss: 1.0949 -> 0.4621   acc: 70.15% -> 86.14%              
client [5] (test)  loss: 1.0355 -> 0.1571   acc: 72.80% -> 95.20%              
client [41] (test)  loss: 0.7728 -> 0.4351   acc: 79.52% -> 89.05%             
client [7] (test)  loss: 1.3416 -> 0.4054   acc: 64.25% -> 87.48%              
client [37] (test)  loss: 0.9346 -> 0.5500   acc: 74.95% -> 85.10%             
client [45] (test)  loss: 0.9003 -> 0.5385   acc: 76.98% -> 83.40%             
client [47] (test)  loss: 0.3198 -> 0.1072   acc: 92.42% -> 96.91%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5385 -> 0.2795   acc: 84.73% -> 92.58%             
client [11] (test)  loss: 0.5365 -> 0.2728   acc: 86.92% -> 91.53%             
client [37] (test)  loss: 0.7007 -> 0.5581   acc: 80.13% -> 85.10%             
client [41] (test)  loss: 0.8841 -> 0.4112   acc: 77.30% -> 89.37%             
client [95] (test)  loss: 0.5423 -> 0.1971   acc: 86.38% -> 95.72%             
client [53] (test)  loss: 0.8971 -> 0.3799   acc: 75.92% -> 91.40%             
client [22] (test)  loss: 0.8489 -> 0.7002   acc: 78.26% -> 82.43%             
client [25] (test)  loss: 0.5958 -> 0.5252   acc: 83.75% -> 84.11%             
client [69] (test)  loss: 1.0016 -> 0.5902   acc: 72.57% -> 83.68%             
client [46] (test)  loss: 1.0861 -> 0.5186   acc: 69.98% -> 86.08%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2152 -> 0.1285   acc: 95.08% -> 96.77%             
client [69] (test)  loss: 1.3246 -> 0.5777   acc: 62.50% -> 83.68%             
client [82] (test)  loss: 0.7409 -> 0.4275   acc: 78.85% -> 87.50%             
client [45] (test)  loss: 0.9504 -> 0.5135   acc: 74.72% -> 82.64%             
client [7] (test)  loss: 1.1876 -> 0.4052   acc: 69.23% -> 88.39%              
client [50] (test)  loss: 0.6677 -> 0.4995   acc: 83.43% -> 87.57%             
client [35] (test)  loss: 0.6535 -> 0.4188   acc: 79.74% -> 89.35%             
client [24] (test)  loss: 0.4103 -> 0.2069   acc: 87.40% -> 94.40%             
client [15] (test)  loss: 0.7081 -> 0.3850   acc: 79.38% -> 89.76%             
client [58] (test)  loss: 0.7006 -> 0.4313   acc: 81.70% -> 90.19%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5470 -> 0.4978   acc: 84.29% -> 86.43%             
client [76] (test)  loss: 0.6486 -> 0.3247   acc: 82.75% -> 91.07%             
client [67] (test)  loss: 0.5048 -> 0.3289   acc: 86.23% -> 90.02%             
client [37] (test)  loss: 0.7392 -> 0.5452   acc: 79.48% -> 85.96%             
client [58] (test)  loss: 0.4815 -> 0.4296   acc: 87.17% -> 89.62%             
client [64] (test)  loss: 0.6505 -> 0.5253   acc: 82.35% -> 85.69%             
client [77] (test)  loss: 0.5986 -> 0.5128   acc: 82.79% -> 85.54%             
client [55] (test)  loss: 0.7368 -> 0.4656   acc: 84.05% -> 90.66%             
client [12] (test)  loss: 0.3795 -> 0.1534   acc: 89.01% -> 94.50%             
client [89] (test)  loss: 0.5603 -> 0.4854   acc: 85.35% -> 87.32%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6307 -> 0.2916   acc: 84.36% -> 92.55%             
client [51] (test)  loss: 0.8221 -> 0.5798   acc: 80.00% -> 87.88%             
client [8] (test)  loss: 0.6616 -> 0.3491   acc: 83.77% -> 90.91%              
client [18] (test)  loss: 0.6550 -> 0.4066   acc: 80.94% -> 87.82%             
client [94] (test)  loss: 0.4827 -> 0.3603   acc: 86.34% -> 93.59%             
client [81] (test)  loss: 0.7735 -> 0.3971   acc: 79.05% -> 88.71%             
client [3] (test)  loss: 0.8748 -> 0.4475   acc: 75.91% -> 86.14%              
client [11] (test)  loss: 0.5212 -> 0.2720   acc: 86.92% -> 91.90%             
client [95] (test)  loss: 0.5888 -> 0.2079   acc: 86.77% -> 95.72%             
client [67] (test)  loss: 0.7447 -> 0.3398   acc: 80.04% -> 90.42%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4902 -> 0.3494   acc: 88.46% -> 89.62%             
client [79] (test)  loss: 0.9332 -> 0.6059   acc: 76.17% -> 84.26%             
client [58] (test)  loss: 0.4809 -> 0.4078   acc: 87.74% -> 89.25%             
client [88] (test)  loss: 0.4504 -> 0.1828   acc: 87.71% -> 95.05%             
client [46] (test)  loss: 0.9779 -> 0.5118   acc: 71.79% -> 85.53%             
client [11] (test)  loss: 0.6372 -> 0.2733   acc: 83.24% -> 91.90%             
client [55] (test)  loss: 0.7663 -> 0.4739   acc: 81.32% -> 90.66%             
client [13] (test)  loss: 0.6626 -> 0.4536   acc: 80.69% -> 85.52%             
client [31] (test)  loss: 1.3729 -> 0.0087   acc: 66.55% -> 99.65%             
client [75] (test)  loss: 0.8267 -> 0.4699   acc: 78.31% -> 87.63%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5850 -> 0.3136   acc: 82.46% -> 90.60%             
client [7] (test)  loss: 1.1073 -> 0.4079   acc: 71.04% -> 89.14%              
client [57] (test)  loss: 0.2744 -> 0.2002   acc: 93.60% -> 95.00%             
client [13] (test)  loss: 0.7013 -> 0.4520   acc: 81.61% -> 86.21%             
client [43] (test)  loss: 0.9618 -> 0.6083   acc: 71.64% -> 84.11%             
client [91] (test)  loss: 0.7917 -> 0.6177   acc: 80.05% -> 85.89%             
client [10] (test)  loss: 0.7666 -> 0.4178   acc: 83.71% -> 89.82%             
client [64] (test)  loss: 0.6351 -> 0.5473   acc: 84.31% -> 85.69%             
client [82] (test)  loss: 0.4767 -> 0.3570   acc: 87.18% -> 87.82%             
client [22] (test)  loss: 0.7806 -> 0.7157   acc: 80.62% -> 82.43%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.8134 -> 0.5095   acc: 79.55% -> 86.44%             
client [23] (test)  loss: 0.6607 -> 0.4110   acc: 85.69% -> 90.78%             
client [88] (test)  loss: 0.4417 -> 0.1927   acc: 88.07% -> 94.86%             
client [98] (test)  loss: 0.6157 -> 0.5220   acc: 84.04% -> 87.02%             
client [79] (test)  loss: 0.7669 -> 0.5787   acc: 80.85% -> 85.74%             
client [21] (test)  loss: 0.4975 -> 0.3526   acc: 88.46% -> 90.19%             
client [92] (test)  loss: 0.3445 -> 0.2965   acc: 90.83% -> 92.60%             
client [56] (test)  loss: 0.7925 -> 0.5189   acc: 78.49% -> 86.06%             
client [5] (test)  loss: 0.7523 -> 0.1390   acc: 83.60% -> 95.60%              
client [52] (test)  loss: 0.5851 -> 0.2921   acc: 85.34% -> 92.36%             
==================== FedAvg_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.7552 -> 0.0000', 'accuracy': '78.84% -> 0.00%'},          
    200: {'loss': '0.6692 -> 0.0000', 'accuracy': '82.71% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_0.5 achieved 10.0%(13.40%) at epoch: 0                                  
FedAvg_0.5 achieved 20.0%(24.26%) at epoch: 4                                  
FedAvg_0.5 achieved 40.0%(45.78%) at epoch: 8                                  
FedAvg_0.5 achieved 50.0%(54.67%) at epoch: 12                                 
FedAvg_0.5 achieved 60.0%(61.09%) at epoch: 16                                 
FedAvg_0.5 achieved 70.0%(71.61%) at epoch: 23                                 
FedAvg_0.5 achieved 80.0%(81.98%) at epoch: 65                                 
Convergence (test_after):                                                      
FedAvg_0.5 achieved 50.0%(52.11%) at epoch: 0                                  
FedAvg_0.5 achieved 60.0%(60.86%) at epoch: 6                                  
FedAvg_0.5 achieved 70.0%(70.05%) at epoch: 9                                  
FedAvg_0.5 achieved 80.0%(82.48%) at epoch: 19                                 
FedAvg_0.5 achieved 90.0%(92.51%) at epoch: 53                                 
