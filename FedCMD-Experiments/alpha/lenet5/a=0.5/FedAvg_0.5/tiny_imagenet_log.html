==================== ALGORITHM: FedAvg_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.1727 -> 4.5389   acc: 2.61% -> 8.35%               
client [81] (test)  loss: 5.1812 -> 4.9126   acc: 1.82% -> 3.27%               
client [21] (test)  loss: 5.2353 -> 4.5301   acc: 1.62% -> 7.22%               
client [68] (test)  loss: 5.2393 -> 4.6853   acc: 1.08% -> 7.01%               
client [93] (test)  loss: 5.4081 -> 4.6297   acc: 1.27% -> 10.31%              
client [31] (test)  loss: 5.2602 -> 4.4172   acc: 1.08% -> 7.39%               
client [20] (test)  loss: 4.9795 -> 4.3687   acc: 2.85% -> 6.60%               
client [59] (test)  loss: 5.2347 -> 4.5693   acc: 2.52% -> 5.76%               
client [48] (test)  loss: 5.3036 -> 4.6647   acc: 1.79% -> 8.05%               
client [34] (test)  loss: 5.0680 -> 4.5703   acc: 3.43% -> 7.58%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 7.1563 -> 4.3935   acc: 0.92% -> 12.09%              
client [99] (test)  loss: 5.9424 -> 4.5825   acc: 1.62% -> 6.83%               
client [67] (test)  loss: 5.0938 -> 3.9800   acc: 4.60% -> 13.45%              
client [0] (test)  loss: 4.9302 -> 4.3371   acc: 3.41% -> 8.98%                
client [76] (test)  loss: 4.8957 -> 4.4237   acc: 4.71% -> 6.88%               
client [41] (test)  loss: 5.6073 -> 4.2778   acc: 3.25% -> 9.58%               
client [62] (test)  loss: 5.2043 -> 4.5057   acc: 1.63% -> 8.71%               
client [2] (test)  loss: 5.2055 -> 4.5094   acc: 1.55% -> 9.86%                
client [14] (test)  loss: 4.9931 -> 4.4000   acc: 5.36% -> 10.17%              
client [46] (test)  loss: 5.1628 -> 4.4651   acc: 3.43% -> 6.14%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.4808 -> 4.0998   acc: 8.58% -> 11.78%              
client [68] (test)  loss: 4.9734 -> 4.3451   acc: 7.01% -> 14.03%              
client [57] (test)  loss: 4.5409 -> 4.1295   acc: 7.62% -> 13.97%              
client [17] (test)  loss: 7.1934 -> 4.2370   acc: 1.28% -> 11.56%              
client [54] (test)  loss: 4.5706 -> 4.2116   acc: 6.72% -> 11.25%              
client [23] (test)  loss: 4.9580 -> 4.2615   acc: 2.38% -> 10.32%              
client [35] (test)  loss: 4.7716 -> 4.7631   acc: 5.79% -> 4.52%               
client [59] (test)  loss: 4.4383 -> 4.4491   acc: 7.19% -> 7.73%               
client [31] (test)  loss: 4.4520 -> 4.0133   acc: 8.29% -> 13.87%              
client [9] (test)  loss: 4.4939 -> 4.2471   acc: 5.92% -> 9.87%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.5271 -> 4.0883   acc: 6.90% -> 12.89%              
client [33] (test)  loss: 4.4876 -> 4.0295   acc: 7.59% -> 12.66%              
client [16] (test)  loss: 4.6692 -> 4.1443   acc: 7.48% -> 16.00%              
client [44] (test)  loss: 13.4937 -> 4.1708   acc: 1.08% -> 13.02%             
client [8] (test)  loss: 4.5318 -> 3.9352   acc: 7.80% -> 17.06%               
client [31] (test)  loss: 4.6147 -> 3.9301   acc: 7.03% -> 16.04%              
client [47] (test)  loss: 5.0476 -> 4.1159   acc: 5.89% -> 13.26%              
client [36] (test)  loss: 4.8573 -> 4.1833   acc: 4.14% -> 10.63%              
client [20] (test)  loss: 4.4771 -> 4.0331   acc: 8.56% -> 15.51%              
client [56] (test)  loss: 4.4054 -> 4.0998   acc: 12.12% -> 15.01%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.2903 -> 3.9994   acc: 13.09% -> 15.82%              
client [60] (test)  loss: 5.1022 -> 3.9970   acc: 7.55% -> 15.29%              
client [28] (test)  loss: 6.1238 -> 3.9026   acc: 6.17% -> 16.70%              
client [25] (test)  loss: 5.9295 -> 4.0766   acc: 5.45% -> 15.82%              
client [58] (test)  loss: 4.7007 -> 4.1391   acc: 7.41% -> 15.01%              
client [44] (test)  loss: 4.4198 -> 4.0468   acc: 10.85% -> 15.19%             
client [39] (test)  loss: 4.5529 -> 3.9624   acc: 11.15% -> 17.67%             
client [29] (test)  loss: 5.4009 -> 4.1754   acc: 7.69% -> 15.21%              
client [3] (test)  loss: 4.4266 -> 3.9113   acc: 9.22% -> 15.01%               
client [84] (test)  loss: 4.4469 -> 4.0833   acc: 10.29% -> 16.06%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.9809 -> 4.0655   acc: 11.91% -> 18.95%             
client [84] (test)  loss: 4.2697 -> 4.1700   acc: 14.26% -> 15.70%             
client [10] (test)  loss: 5.1338 -> 4.1587   acc: 8.14% -> 16.09%              
client [36] (test)  loss: 4.6535 -> 4.1675   acc: 7.75% -> 14.23%              
client [65] (test)  loss: 4.7241 -> 4.3560   acc: 8.35% -> 12.33%              
client [81] (test)  loss: 4.5215 -> 4.4446   acc: 12.18% -> 10.00%             
client [79] (test)  loss: 4.7221 -> 4.2288   acc: 8.18% -> 18.22%              
client [42] (test)  loss: 4.4520 -> 4.1561   acc: 9.58% -> 15.91%              
client [11] (test)  loss: 4.6172 -> 3.8523   acc: 10.10% -> 19.41%             
client [96] (test)  loss: 4.6975 -> 4.0703   acc: 9.40% -> 15.01%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.6753 -> 4.0922   acc: 7.99% -> 16.15%               
client [53] (test)  loss: 4.8689 -> 4.1774   acc: 8.11% -> 15.14%              
client [52] (test)  loss: 4.4672 -> 4.3544   acc: 11.92% -> 13.22%             
client [42] (test)  loss: 4.3741 -> 4.2485   acc: 10.31% -> 16.46%             
client [69] (test)  loss: 4.9006 -> 4.3500   acc: 9.34% -> 16.48%              
client [59] (test)  loss: 4.4183 -> 4.2268   acc: 11.51% -> 14.03%             
client [7] (test)  loss: 6.1264 -> 4.2378   acc: 7.86% -> 17.68%               
client [26] (test)  loss: 4.5618 -> 4.1304   acc: 10.92% -> 20.45%             
client [49] (test)  loss: 4.5625 -> 4.4839   acc: 11.59% -> 14.67%             
client [98] (test)  loss: 4.4953 -> 4.2400   acc: 9.04% -> 15.01%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.8854 -> 4.4519   acc: 10.49% -> 14.29%             
client [47] (test)  loss: 5.7029 -> 4.5439   acc: 8.29% -> 15.47%              
client [21] (test)  loss: 4.6762 -> 4.1699   acc: 11.55% -> 18.05%             
client [77] (test)  loss: 4.6712 -> 4.3992   acc: 9.04% -> 14.78%              
client [95] (test)  loss: 4.5882 -> 4.4030   acc: 11.57% -> 14.47%             
client [91] (test)  loss: 4.6462 -> 4.2137   acc: 9.29% -> 18.41%              
client [14] (test)  loss: 4.6682 -> 4.5794   acc: 9.80% -> 14.79%              
client [99] (test)  loss: 4.8209 -> 4.6192   acc: 8.63% -> 15.29%              
client [20] (test)  loss: 4.8776 -> 4.2910   acc: 10.52% -> 16.93%             
client [39] (test)  loss: 4.8607 -> 4.3180   acc: 10.98% -> 19.38%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.0507 -> 4.5522   acc: 10.80% -> 15.46%             
client [62] (test)  loss: 4.9234 -> 4.6367   acc: 9.80% -> 16.88%              
client [71] (test)  loss: 4.5155 -> 4.4028   acc: 9.37% -> 16.76%              
client [97] (test)  loss: 4.8044 -> 4.3477   acc: 12.32% -> 14.15%             
client [30] (test)  loss: 4.2615 -> 4.5220   acc: 14.70% -> 18.69%             
client [88] (test)  loss: 5.1058 -> 4.3303   acc: 7.64% -> 15.81%              
client [60] (test)  loss: 4.5014 -> 4.2378   acc: 11.33% -> 18.88%             
client [82] (test)  loss: 5.0240 -> 4.7108   acc: 8.70% -> 14.96%              
client [91] (test)  loss: 4.9915 -> 4.3913   acc: 8.28% -> 18.41%              
client [57] (test)  loss: 4.6230 -> 4.6158   acc: 10.71% -> 15.61%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 5.0577 -> 4.6149   acc: 11.71% -> 15.14%             
client [15] (test)  loss: 5.0644 -> 4.9254   acc: 10.48% -> 13.68%             
client [71] (test)  loss: 4.9222 -> 4.3854   acc: 8.29% -> 17.12%              
client [97] (test)  loss: 4.8721 -> 4.5534   acc: 11.21% -> 15.81%             
client [53] (test)  loss: 5.2465 -> 4.5696   acc: 9.73% -> 14.59%              
client [77] (test)  loss: 5.2475 -> 4.6540   acc: 9.22% -> 13.39%              
client [76] (test)  loss: 5.0101 -> 4.7672   acc: 10.33% -> 15.40%             
client [79] (test)  loss: 5.5193 -> 4.6835   acc: 8.18% -> 17.84%              
client [28] (test)  loss: 4.9971 -> 4.4572   acc: 11.98% -> 18.33%             
client [99] (test)  loss: 5.0469 -> 4.9483   acc: 11.15% -> 14.21%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.9576 -> 4.6652   acc: 9.38% -> 16.91%              
client [86] (test)  loss: 5.0410 -> 4.7755   acc: 10.53% -> 14.70%             
client [34] (test)  loss: 4.8891 -> 4.8508   acc: 12.09% -> 16.43%             
client [73] (test)  loss: 4.9177 -> 4.7789   acc: 8.55% -> 15.27%              
client [5] (test)  loss: 4.9948 -> 4.7827   acc: 11.17% -> 17.66%              
client [96] (test)  loss: 4.7871 -> 4.6050   acc: 12.30% -> 15.55%             
client [22] (test)  loss: 4.9429 -> 4.4525   acc: 10.52% -> 19.25%             
client [60] (test)  loss: 4.7770 -> 4.3877   acc: 10.79% -> 19.24%             
client [66] (test)  loss: 4.9797 -> 4.7636   acc: 13.09% -> 17.09%             
client [83] (test)  loss: 5.1274 -> 4.6399   acc: 8.18% -> 16.18%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 5.2965 -> 4.9683   acc: 11.59% -> 16.67%             
client [65] (test)  loss: 5.3346 -> 4.9787   acc: 8.54% -> 14.99%              
client [95] (test)  loss: 5.3443 -> 4.9808   acc: 8.14% -> 16.64%              
client [17] (test)  loss: 6.2408 -> 5.0315   acc: 7.89% -> 14.31%              
client [8] (test)  loss: 5.1808 -> 4.5048   acc: 8.35% -> 16.33%               
client [35] (test)  loss: 5.3693 -> 5.0600   acc: 8.32% -> 14.47%              
client [98] (test)  loss: 5.2154 -> 4.7957   acc: 8.86% -> 14.29%              
client [53] (test)  loss: 4.8503 -> 4.7997   acc: 11.53% -> 15.86%             
client [43] (test)  loss: 5.1786 -> 4.7402   acc: 9.62% -> 17.42%              
client [64] (test)  loss: 4.9821 -> 4.5481   acc: 9.26% -> 17.24%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.2842 -> 4.7101   acc: 12.09% -> 17.87%             
client [88] (test)  loss: 5.5702 -> 4.7899   acc: 8.53% -> 18.29%              
client [38] (test)  loss: 5.1142 -> 4.8949   acc: 11.23% -> 19.02%             
client [3] (test)  loss: 5.3523 -> 4.7916   acc: 9.04% -> 15.37%               
client [5] (test)  loss: 5.2263 -> 5.0221   acc: 10.99% -> 17.30%              
client [41] (test)  loss: 5.2794 -> 4.8961   acc: 11.75% -> 15.19%             
client [7] (test)  loss: 5.1945 -> 4.7198   acc: 11.25% -> 15.18%              
client [37] (test)  loss: 5.3289 -> 4.5266   acc: 7.94% -> 18.77%              
client [45] (test)  loss: 6.0497 -> 4.7520   acc: 8.63% -> 16.73%              
client [47] (test)  loss: 5.4785 -> 4.9411   acc: 9.58% -> 15.10%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.2766 -> 5.0835   acc: 11.83% -> 19.48%             
client [11] (test)  loss: 5.1150 -> 4.5695   acc: 13.07% -> 21.98%             
client [37] (test)  loss: 5.2401 -> 4.6711   acc: 8.48% -> 19.31%              
client [41] (test)  loss: 5.3926 -> 4.9597   acc: 11.39% -> 16.82%             
client [95] (test)  loss: 5.2117 -> 5.1413   acc: 10.13% -> 16.82%             
client [53] (test)  loss: 5.4981 -> 4.8851   acc: 8.11% -> 16.40%              
client [22] (test)  loss: 5.1987 -> 4.6862   acc: 10.34% -> 18.54%             
client [25] (test)  loss: 5.1199 -> 4.7123   acc: 9.64% -> 15.45%              
client [69] (test)  loss: 5.8065 -> 5.0829   acc: 9.71% -> 17.95%              
client [46] (test)  loss: 4.9827 -> 4.9532   acc: 11.37% -> 16.25%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.2278 -> 5.1391   acc: 11.23% -> 14.92%             
client [69] (test)  loss: 6.1258 -> 5.2462   acc: 10.99% -> 17.58%             
client [82] (test)  loss: 5.5780 -> 5.2533   acc: 8.70% -> 16.17%              
client [45] (test)  loss: 5.7690 -> 4.9974   acc: 10.04% -> 17.96%             
client [7] (test)  loss: 5.6030 -> 4.8551   acc: 11.07% -> 15.00%              
client [50] (test)  loss: 5.3837 -> 5.0730   acc: 12.30% -> 17.90%             
client [35] (test)  loss: 5.3696 -> 5.4429   acc: 9.04% -> 14.10%              
client [24] (test)  loss: 5.4789 -> 5.2139   acc: 9.78% -> 15.97%              
client [15] (test)  loss: 5.5848 -> 5.3499   acc: 9.77% -> 15.99%              
client [58] (test)  loss: 5.3493 -> 5.1965   acc: 9.95% -> 15.19%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.6778 -> 5.1170   acc: 11.27% -> 17.35%             
client [76] (test)  loss: 5.6124 -> 5.3038   acc: 11.78% -> 15.76%             
client [67] (test)  loss: 5.5112 -> 4.9066   acc: 8.50% -> 16.46%              
client [37] (test)  loss: 5.5257 -> 4.7826   acc: 10.11% -> 17.87%             
client [58] (test)  loss: 5.5257 -> 5.2728   acc: 11.21% -> 15.37%             
client [64] (test)  loss: 5.2978 -> 4.8286   acc: 9.80% -> 17.79%              
client [77] (test)  loss: 5.4647 -> 5.2275   acc: 10.96% -> 14.78%             
client [55] (test)  loss: 5.5234 -> 5.0933   acc: 10.52% -> 18.54%             
client [12] (test)  loss: 5.4009 -> 4.9388   acc: 10.73% -> 17.43%             
client [89] (test)  loss: 5.8152 -> 5.1690   acc: 10.34% -> 16.52%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.4046 -> 5.3142   acc: 12.64% -> 17.87%             
client [51] (test)  loss: 5.4014 -> 5.0773   acc: 10.51% -> 15.22%             
client [8] (test)  loss: 5.4817 -> 4.9922   acc: 9.80% -> 17.06%               
client [18] (test)  loss: 5.6069 -> 5.1720   acc: 11.79% -> 17.14%             
client [94] (test)  loss: 5.7623 -> 5.3250   acc: 10.48% -> 14.43%             
client [81] (test)  loss: 5.7156 -> 5.4306   acc: 7.82% -> 11.27%              
client [3] (test)  loss: 5.4624 -> 5.1971   acc: 9.58% -> 14.29%               
client [11] (test)  loss: 5.3269 -> 4.8001   acc: 12.67% -> 22.18%             
client [95] (test)  loss: 5.6931 -> 5.4520   acc: 9.22% -> 16.09%              
client [67] (test)  loss: 5.5556 -> 4.9425   acc: 9.38% -> 15.58%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.8911 -> 4.9955   acc: 11.73% -> 18.41%             
client [79] (test)  loss: 6.0288 -> 5.3485   acc: 9.67% -> 17.29%              
client [58] (test)  loss: 5.7082 -> 5.4315   acc: 9.58% -> 16.46%              
client [88] (test)  loss: 6.2099 -> 5.1203   acc: 7.82% -> 17.94%              
client [46] (test)  loss: 6.1672 -> 5.2741   acc: 11.91% -> 15.16%             
client [11] (test)  loss: 5.7175 -> 4.8458   acc: 8.71% -> 22.18%              
client [55] (test)  loss: 5.3478 -> 5.2251   acc: 9.80% -> 16.22%              
client [13] (test)  loss: 5.6874 -> 4.8803   acc: 11.28% -> 20.43%             
client [31] (test)  loss: 6.1520 -> 5.2397   acc: 9.55% -> 15.50%              
client [75] (test)  loss: 5.5533 -> 5.1486   acc: 11.55% -> 17.69%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.6101 -> 5.3523   acc: 12.61% -> 19.46%             
client [7] (test)  loss: 5.8595 -> 5.2613   acc: 8.21% -> 14.64%               
client [57] (test)  loss: 5.5672 -> 5.4288   acc: 10.53% -> 15.97%             
client [13] (test)  loss: 5.5268 -> 4.8875   acc: 12.26% -> 21.21%             
client [43] (test)  loss: 5.7443 -> 5.1810   acc: 10.34% -> 17.60%             
client [91] (test)  loss: 5.8508 -> 5.0486   acc: 10.47% -> 18.92%             
client [10] (test)  loss: 6.1105 -> 5.5262   acc: 8.50% -> 15.01%              
client [64] (test)  loss: 5.3140 -> 5.1298   acc: 12.16% -> 17.06%             
client [82] (test)  loss: 5.9593 -> 5.5520   acc: 9.22% -> 15.30%              
client [22] (test)  loss: 5.7050 -> 5.0025   acc: 9.98% -> 17.29%              
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.7007 -> 5.1421   acc: 9.63% -> 18.54%              
client [23] (test)  loss: 6.0370 -> 5.5732   acc: 8.53% -> 10.91%              
client [88] (test)  loss: 6.3862 -> 5.2690   acc: 10.12% -> 17.76%             
client [98] (test)  loss: 5.5386 -> 5.3434   acc: 10.67% -> 15.19%             
client [79] (test)  loss: 5.8463 -> 5.5342   acc: 13.38% -> 17.84%             
client [21] (test)  loss: 5.8427 -> 5.1399   acc: 10.83% -> 19.68%             
client [92] (test)  loss: 5.9953 -> 5.4275   acc: 11.55% -> 18.95%             
client [56] (test)  loss: 5.8897 -> 5.0190   acc: 11.03% -> 21.88%             
client [5] (test)  loss: 5.9039 -> 5.5584   acc: 10.81% -> 16.58%              
client [52] (test)  loss: 6.0144 -> 5.5376   acc: 11.36% -> 14.71%             
==================== FedAvg_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '4.9740 -> 0.0000', 'accuracy': '10.67% -> 0.00%'},          
    200: {'loss': '5.9270 -> 0.0000', 'accuracy': '10.34% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_0.5 achieved 10.0%(10.81%) at epoch: 51                                 
Convergence (test_after):                                                      
FedAvg_0.5 achieved 10.0%(10.29%) at epoch: 21                                 
