==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7935 -> 0.6263   acc: 74.06% -> 82.37%             
client [81] (test)  loss: 1.7735 -> 1.4212   acc: 42.54% -> 57.46%             
client [21] (test)  loss: 16.6249 -> 1.3166   acc: 12.42% -> 61.21%            
client [68] (test)  loss: 1.0881 -> 0.8582   acc: 72.10% -> 72.39%             
client [93] (test)  loss: 1.3587 -> 0.8357   acc: 37.73% -> 66.67%             
client [31] (test)  loss: 1.8662 -> 1.4036   acc: 32.12% -> 64.80%             
client [20] (test)  loss: 0.7647 -> 0.5218   acc: 80.47% -> 83.91%             
client [59] (test)  loss: 13.2218 -> 1.5269   acc: 6.55% -> 39.30%             
client [48] (test)  loss: 1.4219 -> 1.2042   acc: 42.86% -> 55.71%             
client [34] (test)  loss: 1.4232 -> 1.0168   acc: 51.40% -> 75.06%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6925 -> 1.2372   acc: 50.60% -> 68.45%             
client [99] (test)  loss: 1.4604 -> 1.1194   acc: 42.59% -> 62.59%             
client [67] (test)  loss: 0.9310 -> 0.7090   acc: 63.38% -> 78.47%             
client [0] (test)  loss: 1.0452 -> 0.8399   acc: 63.40% -> 68.41%              
client [76] (test)  loss: 0.7121 -> 0.5970   acc: 76.23% -> 77.33%             
client [41] (test)  loss: 1.0661 -> 0.6155   acc: 69.17% -> 80.00%             
client [62] (test)  loss: 9.8833 -> 1.5744   acc: 18.82% -> 56.79%             
client [2] (test)  loss: 18.9322 -> 1.5959   acc: 4.73% -> 54.89%              
client [14] (test)  loss: 0.8887 -> 0.7256   acc: 69.75% -> 80.11%             
client [46] (test)  loss: 0.5079 -> 0.4504   acc: 79.20% -> 81.87%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1622 -> 0.9894   acc: 64.10% -> 66.76%             
client [68] (test)  loss: 0.6817 -> 0.6398   acc: 76.65% -> 78.12%             
client [57] (test)  loss: 0.3880 -> 0.2344   acc: 90.56% -> 94.17%             
client [17] (test)  loss: 0.7684 -> 0.6198   acc: 79.64% -> 82.67%             
client [54] (test)  loss: 0.7053 -> 0.6432   acc: 72.12% -> 73.99%             
client [23] (test)  loss: 16.1018 -> 1.6354   acc: 1.25% -> 48.75%             
client [35] (test)  loss: 0.6473 -> 0.4911   acc: 78.55% -> 84.50%             
client [59] (test)  loss: 0.8078 -> 0.6782   acc: 77.29% -> 79.48%             
client [31] (test)  loss: 0.7115 -> 0.6645   acc: 77.09% -> 78.49%             
client [9] (test)  loss: 0.4909 -> 0.4204   acc: 88.03% -> 88.64%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6075 -> 0.5387   acc: 84.86% -> 86.29%             
client [33] (test)  loss: 0.2491 -> 0.2322   acc: 93.18% -> 93.43%             
client [16] (test)  loss: 0.6295 -> 0.5399   acc: 82.58% -> 83.78%             
client [44] (test)  loss: 1.1343 -> 0.6190   acc: 67.78% -> 80.15%             
client [8] (test)  loss: 0.7423 -> 0.6823   acc: 78.17% -> 79.91%              
client [31] (test)  loss: 0.6363 -> 0.6069   acc: 78.49% -> 79.05%             
client [47] (test)  loss: 0.4613 -> 0.3803   acc: 85.27% -> 89.45%             
client [36] (test)  loss: 0.8496 -> 0.5272   acc: 69.04% -> 84.04%             
client [20] (test)  loss: 0.3244 -> 0.2657   acc: 87.07% -> 89.45%             
client [56] (test)  loss: 1.3573 -> 1.0532   acc: 63.30% -> 64.78%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.0088 -> 0.9295   acc: 63.67% -> 64.06%              
client [60] (test)  loss: 0.7539 -> 0.6154   acc: 80.91% -> 80.91%             
client [28] (test)  loss: 0.3667 -> 0.2922   acc: 84.23% -> 90.99%             
client [25] (test)  loss: 0.5482 -> 0.4722   acc: 79.97% -> 84.04%             
client [58] (test)  loss: 0.7462 -> 0.7243   acc: 72.80% -> 73.90%             
client [44] (test)  loss: 0.7124 -> 0.4110   acc: 78.61% -> 82.73%             
client [39] (test)  loss: 1.0583 -> 0.8148   acc: 72.64% -> 78.12%             
client [29] (test)  loss: 0.8027 -> 0.7031   acc: 75.07% -> 74.54%             
client [3] (test)  loss: 0.6880 -> 0.5601   acc: 76.65% -> 80.71%              
client [84] (test)  loss: 0.4165 -> 0.4026   acc: 87.83% -> 88.59%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8000 -> 0.6873   acc: 75.15% -> 76.97%             
client [84] (test)  loss: 0.3929 -> 0.3857   acc: 88.78% -> 88.97%             
client [10] (test)  loss: 0.6398 -> 0.5812   acc: 80.06% -> 82.28%             
client [36] (test)  loss: 0.3487 -> 0.3045   acc: 92.31% -> 92.31%             
client [65] (test)  loss: 0.6011 -> 0.5561   acc: 80.52% -> 82.47%             
client [81] (test)  loss: 0.7198 -> 0.6113   acc: 85.82% -> 85.82%             
client [79] (test)  loss: 0.9202 -> 0.8652   acc: 66.86% -> 69.16%             
client [42] (test)  loss: 0.5171 -> 0.4934   acc: 81.88% -> 84.30%             
client [11] (test)  loss: 0.2605 -> 0.2161   acc: 94.13% -> 94.13%             
client [96] (test)  loss: 1.0108 -> 0.9149   acc: 64.55% -> 69.05%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6578 -> 0.6098   acc: 82.10% -> 83.41%              
client [53] (test)  loss: 1.0329 -> 0.9139   acc: 69.44% -> 69.44%             
client [52] (test)  loss: 0.5734 -> 0.5539   acc: 82.75% -> 82.75%             
client [42] (test)  loss: 0.4665 -> 0.4560   acc: 83.33% -> 85.02%             
client [69] (test)  loss: 0.5902 -> 0.5724   acc: 82.44% -> 82.74%             
client [59] (test)  loss: 0.5239 -> 0.4841   acc: 84.72% -> 86.90%             
client [7] (test)  loss: 0.4064 -> 0.4007   acc: 86.09% -> 86.09%              
client [26] (test)  loss: 0.6031 -> 0.5843   acc: 84.70% -> 84.70%             
client [49] (test)  loss: 1.0474 -> 0.9550   acc: 59.33% -> 66.06%             
client [98] (test)  loss: 0.2394 -> 0.2236   acc: 89.21% -> 89.21%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2279 -> 0.2140   acc: 89.47% -> 89.74%             
client [47] (test)  loss: 0.3656 -> 0.3323   acc: 88.79% -> 90.55%             
client [21] (test)  loss: 0.6490 -> 0.5986   acc: 77.58% -> 79.70%             
client [77] (test)  loss: 0.4268 -> 0.4129   acc: 86.90% -> 88.16%             
client [95] (test)  loss: 0.5014 -> 0.4838   acc: 86.82% -> 87.21%             
client [91] (test)  loss: 0.4271 -> 0.3990   acc: 83.97% -> 86.01%             
client [14] (test)  loss: 0.5134 -> 0.4895   acc: 83.65% -> 83.38%             
client [99] (test)  loss: 0.6390 -> 0.5681   acc: 83.33% -> 84.07%             
client [20] (test)  loss: 0.2690 -> 0.2344   acc: 90.50% -> 91.03%             
client [39] (test)  loss: 0.6450 -> 0.5672   acc: 81.16% -> 82.07%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5495 -> 0.5346   acc: 83.63% -> 83.92%             
client [62] (test)  loss: 0.4162 -> 0.3924   acc: 86.06% -> 87.11%             
client [71] (test)  loss: 1.0848 -> 1.0489   acc: 70.37% -> 70.37%             
client [97] (test)  loss: 0.7907 -> 0.7253   acc: 71.98% -> 73.54%             
client [30] (test)  loss: 0.7868 -> 0.7407   acc: 77.10% -> 75.70%             
client [88] (test)  loss: 0.7512 -> 0.6908   acc: 78.73% -> 79.68%             
client [60] (test)  loss: 0.4247 -> 0.3940   acc: 88.18% -> 87.88%             
client [82] (test)  loss: 0.7665 -> 0.6575   acc: 69.34% -> 75.41%             
client [91] (test)  loss: 0.3793 -> 0.3590   acc: 87.28% -> 89.06%             
client [57] (test)  loss: 0.1353 -> 0.1196   acc: 95.28% -> 96.39%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6372 -> 0.6405   acc: 78.49% -> 78.77%             
client [15] (test)  loss: 0.6084 -> 0.5904   acc: 78.25% -> 78.95%             
client [71] (test)  loss: 1.0591 -> 1.0213   acc: 70.37% -> 70.37%             
client [97] (test)  loss: 0.6828 -> 0.6595   acc: 72.76% -> 74.32%             
client [53] (test)  loss: 0.7436 -> 0.6883   acc: 75.08% -> 77.08%             
client [77] (test)  loss: 0.4238 -> 0.4078   acc: 87.41% -> 88.66%             
client [76] (test)  loss: 0.5592 -> 0.4465   acc: 80.99% -> 85.37%             
client [79] (test)  loss: 0.8183 -> 0.7846   acc: 68.88% -> 69.16%             
client [28] (test)  loss: 0.1800 -> 0.2129   acc: 93.80% -> 92.96%             
client [99] (test)  loss: 0.5541 -> 0.5006   acc: 82.96% -> 84.44%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6454 -> 0.6364   acc: 75.49% -> 75.10%             
client [86] (test)  loss: 0.4261 -> 0.3976   acc: 85.14% -> 87.14%             
client [34] (test)  loss: 0.4598 -> 0.4327   acc: 83.46% -> 83.21%             
client [73] (test)  loss: 0.4639 -> 0.4590   acc: 84.98% -> 85.71%             
client [5] (test)  loss: 0.2307 -> 0.2313   acc: 93.55% -> 93.09%              
client [96] (test)  loss: 0.7514 -> 0.7319   acc: 73.02% -> 72.22%             
client [22] (test)  loss: 0.6103 -> 0.5946   acc: 80.87% -> 80.20%             
client [60] (test)  loss: 0.3705 -> 0.3586   acc: 90.30% -> 90.00%             
client [66] (test)  loss: 0.3311 -> 0.3176   acc: 91.63% -> 92.43%             
client [83] (test)  loss: 0.4856 -> 0.4616   acc: 82.41% -> 82.41%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5238 -> 0.4975   acc: 83.36% -> 84.46%             
client [65] (test)  loss: 0.5158 -> 0.4943   acc: 83.12% -> 82.79%             
client [95] (test)  loss: 0.4656 -> 0.4604   acc: 86.43% -> 86.43%             
client [17] (test)  loss: 0.4997 -> 0.4274   acc: 86.02% -> 87.54%             
client [8] (test)  loss: 0.6099 -> 0.5875   acc: 85.59% -> 87.34%              
client [35] (test)  loss: 0.3231 -> 0.2703   acc: 90.44% -> 91.47%             
client [98] (test)  loss: 0.2004 -> 0.1928   acc: 90.79% -> 90.53%             
client [53] (test)  loss: 0.6694 -> 0.6318   acc: 77.41% -> 78.07%             
client [43] (test)  loss: 0.3477 -> 0.3363   acc: 86.93% -> 87.94%             
client [64] (test)  loss: 0.4190 -> 0.3988   acc: 88.29% -> 88.86%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5771 -> 0.5437   acc: 79.70% -> 82.12%             
client [88] (test)  loss: 0.5756 -> 0.5655   acc: 80.95% -> 83.17%             
client [38] (test)  loss: 0.4803 -> 0.4636   acc: 82.87% -> 83.70%             
client [3] (test)  loss: 0.3575 -> 0.3393   acc: 87.06% -> 87.82%              
client [5] (test)  loss: 0.2230 -> 0.2250   acc: 93.55% -> 93.55%              
client [41] (test)  loss: 0.1970 -> 0.1920   acc: 92.78% -> 93.06%             
client [7] (test)  loss: 0.4081 -> 0.4050   acc: 86.74% -> 87.17%              
client [37] (test)  loss: 0.3375 -> 0.3226   acc: 89.58% -> 90.10%             
client [45] (test)  loss: 0.4517 -> 0.3991   acc: 83.24% -> 86.44%             
client [47] (test)  loss: 0.3355 -> 0.3230   acc: 90.77% -> 90.77%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3314 -> 0.3294   acc: 91.29% -> 92.19%             
client [11] (test)  loss: 0.1677 -> 0.1655   acc: 95.03% -> 95.03%             
client [37] (test)  loss: 0.3133 -> 0.3028   acc: 90.36% -> 89.58%             
client [41] (test)  loss: 0.1986 -> 0.1897   acc: 93.06% -> 93.33%             
client [95] (test)  loss: 0.4726 -> 0.4498   acc: 86.43% -> 87.21%             
client [53] (test)  loss: 0.6438 -> 0.6180   acc: 78.07% -> 78.74%             
client [22] (test)  loss: 0.5804 -> 0.5696   acc: 79.87% -> 80.87%             
client [25] (test)  loss: 0.3540 -> 0.3352   acc: 89.41% -> 89.74%             
client [69] (test)  loss: 0.5566 -> 0.5516   acc: 85.42% -> 84.52%             
client [46] (test)  loss: 0.2930 -> 0.2840   acc: 89.07% -> 90.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3591 -> 0.3434   acc: 90.11% -> 90.99%             
client [69] (test)  loss: 0.5629 -> 0.5589   acc: 85.71% -> 84.23%             
client [82] (test)  loss: 0.8476 -> 0.6629   acc: 73.20% -> 77.07%             
client [45] (test)  loss: 0.3870 -> 0.3688   acc: 86.70% -> 87.23%             
client [7] (test)  loss: 0.4103 -> 0.4099   acc: 86.96% -> 87.17%              
client [50] (test)  loss: 0.4866 -> 0.4603   acc: 86.55% -> 86.55%             
client [35] (test)  loss: 0.3109 -> 0.2659   acc: 90.96% -> 92.25%             
client [24] (test)  loss: 0.6250 -> 0.6488   acc: 77.39% -> 78.46%             
client [15] (test)  loss: 0.5519 -> 0.5491   acc: 81.05% -> 80.35%             
client [58] (test)  loss: 0.8612 -> 0.9126   acc: 77.47% -> 75.27%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6585 -> 0.6655   acc: 74.64% -> 75.36%             
client [76] (test)  loss: 0.6160 -> 0.5582   acc: 82.27% -> 83.91%             
client [67] (test)  loss: 0.3627 -> 0.3452   acc: 84.91% -> 85.92%             
client [37] (test)  loss: 0.3042 -> 0.3006   acc: 90.62% -> 89.84%             
client [58] (test)  loss: 0.8867 -> 0.9322   acc: 76.65% -> 75.55%             
client [64] (test)  loss: 0.3722 -> 0.3652   acc: 88.86% -> 88.86%             
client [77] (test)  loss: 0.4280 -> 0.4149   acc: 87.66% -> 88.66%             
client [55] (test)  loss: 0.2779 -> 0.2662   acc: 92.76% -> 92.76%             
client [12] (test)  loss: 0.4244 -> 0.4207   acc: 87.53% -> 87.26%             
client [89] (test)  loss: 0.3167 -> 0.3169   acc: 90.60% -> 90.60%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5267 -> 0.5329   acc: 88.21% -> 87.83%             
client [51] (test)  loss: 0.1965 -> 0.1936   acc: 96.50% -> 96.77%             
client [8] (test)  loss: 0.6027 -> 0.6083   acc: 85.59% -> 86.90%              
client [18] (test)  loss: 0.4380 -> 0.4150   acc: 88.70% -> 90.75%             
client [94] (test)  loss: 0.4400 -> 0.4292   acc: 88.35% -> 88.10%             
client [81] (test)  loss: 0.3482 -> 0.3388   acc: 89.55% -> 90.30%             
client [3] (test)  loss: 0.3511 -> 0.3425   acc: 87.56% -> 87.56%              
client [11] (test)  loss: 0.1700 -> 0.1682   acc: 94.81% -> 95.26%             
client [95] (test)  loss: 0.4783 -> 0.4572   acc: 86.82% -> 86.43%             
client [67] (test)  loss: 0.3575 -> 0.3402   acc: 85.31% -> 86.52%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5110 -> 0.4953   acc: 84.24% -> 84.85%             
client [79] (test)  loss: 0.8350 -> 0.8212   acc: 74.93% -> 74.35%             
client [58] (test)  loss: 0.9413 -> 0.9703   acc: 76.92% -> 75.55%             
client [88] (test)  loss: 0.5738 -> 0.5730   acc: 82.54% -> 82.54%             
client [46] (test)  loss: 0.2992 -> 0.2848   acc: 88.00% -> 91.20%             
client [11] (test)  loss: 0.1713 -> 0.1699   acc: 94.81% -> 95.49%             
client [55] (test)  loss: 0.2911 -> 0.2841   acc: 91.82% -> 92.52%             
client [13] (test)  loss: 0.5554 -> 0.4841   acc: 82.73% -> 85.57%             
client [31] (test)  loss: 0.6634 -> 0.6900   acc: 78.77% -> 78.77%             
client [75] (test)  loss: 0.1852 -> 0.1842   acc: 94.84% -> 94.57%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2744 -> 0.2739   acc: 93.90% -> 93.90%             
client [7] (test)  loss: 0.4572 -> 0.4523   acc: 87.83% -> 87.39%              
client [57] (test)  loss: 0.0731 -> 0.0732   acc: 97.50% -> 97.50%             
client [13] (test)  loss: 0.5547 -> 0.4979   acc: 83.51% -> 85.57%             
client [43] (test)  loss: 0.4158 -> 0.3955   acc: 85.93% -> 86.93%             
client [91] (test)  loss: 0.3386 -> 0.3201   acc: 89.31% -> 89.57%             
client [10] (test)  loss: 0.4109 -> 0.4118   acc: 87.66% -> 87.66%             
client [64] (test)  loss: 0.3490 -> 0.3410   acc: 88.86% -> 88.86%             
client [82] (test)  loss: 0.7939 -> 0.7410   acc: 76.52% -> 76.80%             
client [22] (test)  loss: 0.5734 -> 0.5639   acc: 81.88% -> 82.89%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2429 -> 0.2270   acc: 90.50% -> 91.56%             
client [23] (test)  loss: 0.5424 -> 0.5197   acc: 83.12% -> 83.12%             
client [88] (test)  loss: 0.5785 -> 0.5775   acc: 81.90% -> 82.54%             
client [98] (test)  loss: 0.1846 -> 0.1808   acc: 91.84% -> 92.11%             
client [79] (test)  loss: 0.8907 -> 0.8665   acc: 74.64% -> 74.06%             
client [21] (test)  loss: 0.4912 -> 0.4830   acc: 85.76% -> 86.06%             
client [92] (test)  loss: 0.1103 -> 0.1089   acc: 95.95% -> 96.20%             
client [56] (test)  loss: 0.7389 -> 0.7825   acc: 78.57% -> 79.06%             
client [5] (test)  loss: 0.2292 -> 0.2312   acc: 93.55% -> 94.01%              
client [52] (test)  loss: 0.5449 -> 0.5548   acc: 85.38% -> 85.38%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '0.4638 -> 0.0000', 'accuracy': '84.84% -> 0.00%'},          
    200: {'loss': '0.4518 -> 0.0000', 'accuracy': '86.56% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(15.02%) at epoch: 1                               
LG-FedAvg-0.5 achieved 20.0%(26.62%) at epoch: 3                               
LG-FedAvg-0.5 achieved 30.0%(35.54%) at epoch: 4                               
LG-FedAvg-0.5 achieved 40.0%(42.61%) at epoch: 7                               
LG-FedAvg-0.5 achieved 50.0%(50.06%) at epoch: 9                               
LG-FedAvg-0.5 achieved 60.0%(63.38%) at epoch: 16                              
LG-FedAvg-0.5 achieved 70.0%(73.10%) at epoch: 24                              
LG-FedAvg-0.5 achieved 80.0%(82.63%) at epoch: 41                              
LG-FedAvg-0.5 achieved 90.0%(90.09%) at epoch: 155                             
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 50.0%(51.52%) at epoch: 0                               
LG-FedAvg-0.5 achieved 60.0%(61.33%) at epoch: 2                               
LG-FedAvg-0.5 achieved 70.0%(73.21%) at epoch: 13                              
LG-FedAvg-0.5 achieved 80.0%(83.22%) at epoch: 39                              
LG-FedAvg-0.5 achieved 90.0%(90.89%) at epoch: 155                             
