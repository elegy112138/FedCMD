==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4900 -> 1.2600   acc: 52.43% -> 55.34%             
client [81] (test)  loss: 2.2148 -> 2.1316   acc: 16.22% -> 16.22%             
client [21] (test)  loss: 2.3999 -> 1.3735   acc: 0.44% -> 67.70%              
client [68] (test)  loss: 2.3710 -> 2.2505   acc: 18.95% -> 18.95%             
client [93] (test)  loss: 2.0972 -> 1.6284   acc: 40.94% -> 40.94%             
client [31] (test)  loss: 1.8795 -> 1.3157   acc: 46.28% -> 46.28%             
client [20] (test)  loss: 0.5008 -> 0.4638   acc: 87.58% -> 87.58%             
client [59] (test)  loss: 2.3664 -> 1.9968   acc: 9.84% -> 60.66%              
client [48] (test)  loss: 1.0005 -> 0.8881   acc: 73.79% -> 73.79%             
client [34] (test)  loss: 2.3479 -> 2.2651   acc: 32.88% -> 19.18%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.0719 -> 1.8812   acc: 31.87% -> 34.07%             
client [99] (test)  loss: 2.3301 -> 2.2164   acc: 25.71% -> 14.29%             
client [67] (test)  loss: 2.1181 -> 1.6807   acc: 33.77% -> 33.77%             
client [0] (test)  loss: 1.0174 -> 0.7229   acc: 67.63% -> 75.14%              
client [76] (test)  loss: 1.5247 -> 1.2395   acc: 44.12% -> 66.91%             
client [41] (test)  loss: 1.8497 -> 1.3651   acc: 55.10% -> 55.10%             
client [62] (test)  loss: 2.3175 -> 1.7702   acc: 62.50% -> 62.50%             
client [2] (test)  loss: 2.3736 -> 2.0921   acc: 0.00% -> 57.29%               
client [14] (test)  loss: 1.6474 -> 1.5266   acc: 28.57% -> 31.75%             
client [46] (test)  loss: 0.8365 -> 0.7718   acc: 75.40% -> 75.40%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.7000 -> 1.6083   acc: 36.97% -> 36.97%             
client [68] (test)  loss: 1.9202 -> 1.8452   acc: 38.95% -> 41.05%             
client [57] (test)  loss: 1.6384 -> 1.5516   acc: 39.85% -> 39.85%             
client [17] (test)  loss: 0.7586 -> 0.6763   acc: 84.11% -> 84.11%             
client [54] (test)  loss: 1.2364 -> 1.2087   acc: 56.12% -> 56.12%             
client [23] (test)  loss: 2.3941 -> 2.3033   acc: 11.81% -> 28.35%             
client [35] (test)  loss: 2.1179 -> 2.0629   acc: 34.74% -> 37.89%             
client [59] (test)  loss: 1.1886 -> 1.0850   acc: 66.39% -> 68.03%             
client [31] (test)  loss: 0.9925 -> 0.9312   acc: 71.07% -> 73.55%             
client [9] (test)  loss: 2.2357 -> 2.1559   acc: 36.17% -> 36.17%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.4187 -> 1.3214   acc: 60.14% -> 62.84%             
client [33] (test)  loss: 1.2565 -> 1.2318   acc: 53.90% -> 57.45%             
client [16] (test)  loss: 1.3610 -> 1.2063   acc: 48.34% -> 49.01%             
client [44] (test)  loss: 0.5264 -> 0.0510   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.9142 -> 0.8772   acc: 59.68% -> 62.10%              
client [31] (test)  loss: 0.8827 -> 0.8380   acc: 76.03% -> 78.51%             
client [47] (test)  loss: 2.1143 -> 1.9831   acc: 36.36% -> 36.36%             
client [36] (test)  loss: 2.0193 -> 1.4629   acc: 58.33% -> 58.33%             
client [20] (test)  loss: 0.4012 -> 0.3913   acc: 87.58% -> 87.58%             
client [56] (test)  loss: 1.6415 -> 1.3406   acc: 54.81% -> 60.00%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.9461 -> 0.8769   acc: 61.17% -> 69.15%              
client [60] (test)  loss: 2.2687 -> 2.1760   acc: 35.29% -> 37.65%             
client [28] (test)  loss: 1.6115 -> 1.5616   acc: 37.74% -> 37.74%             
client [25] (test)  loss: 1.8862 -> 1.8079   acc: 26.89% -> 32.77%             
client [58] (test)  loss: 1.5114 -> 1.4278   acc: 45.86% -> 46.62%             
client [44] (test)  loss: 0.0690 -> 0.0180   acc: 100.00% -> 100.00%           
client [39] (test)  loss: 1.0961 -> 1.0126   acc: 69.46% -> 68.97%             
client [29] (test)  loss: 1.3678 -> 1.2812   acc: 46.61% -> 55.93%             
client [3] (test)  loss: 0.7200 -> 0.6306   acc: 78.66% -> 80.24%              
client [84] (test)  loss: 1.2604 -> 1.2297   acc: 70.59% -> 71.43%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.1558 -> 1.1048   acc: 67.70% -> 68.58%             
client [84] (test)  loss: 1.2252 -> 1.1863   acc: 70.59% -> 70.59%             
client [10] (test)  loss: 1.3880 -> 1.2870   acc: 56.39% -> 57.89%             
client [36] (test)  loss: 1.3799 -> 1.3352   acc: 58.33% -> 58.33%             
client [65] (test)  loss: 1.2953 -> 1.2037   acc: 60.66% -> 62.30%             
client [81] (test)  loss: 1.8819 -> 1.8072   acc: 28.83% -> 30.63%             
client [79] (test)  loss: 0.6277 -> 0.6111   acc: 78.87% -> 78.87%             
client [42] (test)  loss: 1.5542 -> 1.4920   acc: 54.76% -> 56.35%             
client [11] (test)  loss: 2.1460 -> 2.1133   acc: 20.00% -> 20.00%             
client [96] (test)  loss: 0.4107 -> 0.3894   acc: 89.02% -> 89.02%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8092 -> 0.7721   acc: 70.97% -> 74.19%              
client [53] (test)  loss: 1.3930 -> 1.2725   acc: 42.34% -> 52.55%             
client [52] (test)  loss: 0.9317 -> 0.8864   acc: 69.57% -> 69.57%             
client [42] (test)  loss: 1.4427 -> 1.4194   acc: 57.14% -> 56.35%             
client [69] (test)  loss: 1.5751 -> 1.5491   acc: 45.05% -> 47.25%             
client [59] (test)  loss: 0.9381 -> 0.9055   acc: 68.85% -> 70.49%             
client [7] (test)  loss: 1.3570 -> 1.2762   acc: 64.35% -> 64.35%              
client [26] (test)  loss: 1.1736 -> 1.0976   acc: 63.64% -> 66.12%             
client [49] (test)  loss: 0.7547 -> 0.7148   acc: 72.59% -> 72.59%             
client [98] (test)  loss: 1.1768 -> 1.1563   acc: 55.00% -> 56.67%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.1572 -> 1.1359   acc: 55.00% -> 56.67%             
client [47] (test)  loss: 1.8961 -> 1.8307   acc: 36.36% -> 36.36%             
client [21] (test)  loss: 1.0527 -> 1.0119   acc: 71.68% -> 73.01%             
client [77] (test)  loss: 0.6103 -> 0.5724   acc: 83.50% -> 82.52%             
client [95] (test)  loss: 0.5036 -> 0.5070   acc: 85.03% -> 85.71%             
client [91] (test)  loss: 0.8096 -> 0.7831   acc: 76.74% -> 79.07%             
client [14] (test)  loss: 1.0396 -> 0.9697   acc: 65.87% -> 70.63%             
client [99] (test)  loss: 1.7259 -> 1.6124   acc: 27.14% -> 44.29%             
client [20] (test)  loss: 0.3474 -> 0.3349   acc: 87.58% -> 87.58%             
client [39] (test)  loss: 0.9138 -> 0.8710   acc: 69.46% -> 70.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.8867 -> 0.8573   acc: 69.57% -> 70.19%             
client [62] (test)  loss: 0.7435 -> 0.7261   acc: 80.15% -> 80.15%             
client [71] (test)  loss: 1.0515 -> 1.0340   acc: 73.53% -> 72.55%             
client [97] (test)  loss: 1.2612 -> 1.2156   acc: 66.00% -> 66.00%             
client [30] (test)  loss: 1.3251 -> 1.2612   acc: 49.18% -> 50.82%             
client [88] (test)  loss: 1.4690 -> 1.3930   acc: 46.97% -> 55.30%             
client [60] (test)  loss: 1.7240 -> 1.6842   acc: 48.24% -> 48.24%             
client [82] (test)  loss: 1.2240 -> 1.1738   acc: 59.54% -> 59.54%             
client [91] (test)  loss: 0.7521 -> 0.7319   acc: 80.62% -> 82.17%             
client [57] (test)  loss: 1.4363 -> 1.3786   acc: 45.11% -> 53.38%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6740 -> 0.6647   acc: 76.86% -> 78.51%             
client [15] (test)  loss: 1.6461 -> 1.6089   acc: 33.33% -> 33.33%             
client [71] (test)  loss: 1.0346 -> 1.0119   acc: 72.55% -> 72.55%             
client [97] (test)  loss: 1.1746 -> 1.1488   acc: 66.00% -> 66.00%             
client [53] (test)  loss: 1.0930 -> 1.0098   acc: 62.77% -> 64.23%             
client [77] (test)  loss: 0.5559 -> 0.5293   acc: 83.50% -> 83.50%             
client [76] (test)  loss: 0.6555 -> 0.6133   acc: 83.82% -> 83.09%             
client [79] (test)  loss: 0.5859 -> 0.5672   acc: 78.87% -> 78.87%             
client [28] (test)  loss: 1.4039 -> 1.3765   acc: 52.83% -> 52.83%             
client [99] (test)  loss: 1.5236 -> 1.4459   acc: 48.57% -> 52.86%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.1435 -> 1.1204   acc: 66.00% -> 66.00%             
client [86] (test)  loss: 0.8053 -> 0.7955   acc: 77.27% -> 77.27%             
client [34] (test)  loss: 1.5662 -> 1.4968   acc: 38.36% -> 43.84%             
client [73] (test)  loss: 1.4005 -> 1.3779   acc: 51.75% -> 55.26%             
client [5] (test)  loss: 1.2166 -> 1.1839   acc: 62.35% -> 64.71%              
client [96] (test)  loss: 0.2958 -> 0.2822   acc: 89.02% -> 89.02%             
client [22] (test)  loss: 1.3739 -> 1.3707   acc: 55.05% -> 58.72%             
client [60] (test)  loss: 1.6169 -> 1.5890   acc: 48.24% -> 49.41%             
client [66] (test)  loss: 1.1314 -> 1.0736   acc: 71.43% -> 71.43%             
client [83] (test)  loss: 0.6744 -> 0.6486   acc: 78.97% -> 79.44%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.5311 -> 0.5100   acc: 83.09% -> 81.62%             
client [65] (test)  loss: 1.1586 -> 1.0829   acc: 64.75% -> 65.57%             
client [95] (test)  loss: 0.5140 -> 0.5191   acc: 85.03% -> 84.35%             
client [17] (test)  loss: 0.5715 -> 0.5592   acc: 84.77% -> 84.77%             
client [8] (test)  loss: 0.6860 -> 0.6636   acc: 79.84% -> 79.84%              
client [35] (test)  loss: 1.6967 -> 1.6754   acc: 42.11% -> 42.11%             
client [98] (test)  loss: 1.1074 -> 1.0907   acc: 55.00% -> 56.67%             
client [53] (test)  loss: 0.9893 -> 0.9215   acc: 66.42% -> 70.80%             
client [43] (test)  loss: 0.9351 -> 0.8650   acc: 72.95% -> 75.41%             
client [64] (test)  loss: 0.9949 -> 0.9481   acc: 68.24% -> 68.92%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.9652 -> 0.9399   acc: 73.89% -> 74.34%             
client [88] (test)  loss: 1.2080 -> 1.2007   acc: 64.39% -> 65.15%             
client [38] (test)  loss: 0.9675 -> 0.9429   acc: 80.39% -> 80.39%             
client [3] (test)  loss: 0.4018 -> 0.3769   acc: 88.14% -> 87.75%              
client [5] (test)  loss: 1.1595 -> 1.1316   acc: 65.88% -> 68.24%              
client [41] (test)  loss: 0.7773 -> 0.7454   acc: 77.55% -> 77.55%             
client [7] (test)  loss: 1.1407 -> 1.0935   acc: 66.96% -> 66.96%              
client [37] (test)  loss: 0.6562 -> 0.6084   acc: 78.52% -> 79.19%             
client [45] (test)  loss: 0.8706 -> 0.7544   acc: 74.24% -> 78.03%             
client [47] (test)  loss: 1.7609 -> 1.7214   acc: 36.36% -> 36.36%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7756 -> 0.7475   acc: 72.19% -> 74.17%             
client [11] (test)  loss: 1.7375 -> 1.6739   acc: 30.00% -> 35.71%             
client [37] (test)  loss: 0.5867 -> 0.5535   acc: 82.55% -> 83.22%             
client [41] (test)  loss: 0.7505 -> 0.7256   acc: 76.19% -> 79.59%             
client [95] (test)  loss: 0.5377 -> 0.5424   acc: 84.35% -> 84.35%             
client [53] (test)  loss: 0.9700 -> 0.8903   acc: 65.69% -> 72.99%             
client [22] (test)  loss: 1.2998 -> 1.2653   acc: 55.96% -> 59.63%             
client [25] (test)  loss: 1.3903 -> 1.2987   acc: 52.94% -> 57.14%             
client [69] (test)  loss: 1.4240 -> 1.4114   acc: 50.55% -> 51.65%             
client [46] (test)  loss: 0.5257 -> 0.4999   acc: 84.13% -> 84.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.6236 -> 1.5893   acc: 40.91% -> 40.91%             
client [69] (test)  loss: 1.4043 -> 1.4016   acc: 52.75% -> 51.65%             
client [82] (test)  loss: 1.0298 -> 1.0007   acc: 65.65% -> 67.18%             
client [45] (test)  loss: 0.6240 -> 0.5641   acc: 80.30% -> 79.55%             
client [7] (test)  loss: 1.0882 -> 1.0528   acc: 67.83% -> 66.96%              
client [50] (test)  loss: 0.8184 -> 0.7515   acc: 69.92% -> 71.43%             
client [35] (test)  loss: 1.6237 -> 1.6029   acc: 42.11% -> 40.00%             
client [24] (test)  loss: 1.3161 -> 1.2616   acc: 64.71% -> 67.23%             
client [15] (test)  loss: 1.4689 -> 1.4352   acc: 33.33% -> 33.33%             
client [58] (test)  loss: 1.0755 -> 1.0188   acc: 59.40% -> 57.89%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6000 -> 0.5852   acc: 87.38% -> 87.38%             
client [76] (test)  loss: 0.4823 -> 0.4847   acc: 82.35% -> 81.62%             
client [67] (test)  loss: 0.7590 -> 0.7142   acc: 72.08% -> 72.08%             
client [37] (test)  loss: 0.5702 -> 0.5309   acc: 81.88% -> 84.56%             
client [58] (test)  loss: 1.0912 -> 1.0347   acc: 59.40% -> 58.65%             
client [64] (test)  loss: 0.8562 -> 0.8290   acc: 79.73% -> 79.73%             
client [77] (test)  loss: 0.4434 -> 0.4251   acc: 85.44% -> 85.44%             
client [55] (test)  loss: 1.5590 -> 1.5129   acc: 46.15% -> 46.15%             
client [12] (test)  loss: 1.5044 -> 1.4393   acc: 55.56% -> 57.26%             
client [89] (test)  loss: 1.2398 -> 1.0881   acc: 58.57% -> 64.29%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.0260 -> 1.0221   acc: 71.43% -> 70.59%             
client [51] (test)  loss: 0.9548 -> 0.9712   acc: 75.00% -> 75.00%             
client [8] (test)  loss: 0.6002 -> 0.5995   acc: 79.03% -> 79.03%              
client [18] (test)  loss: 1.1514 -> 1.1099   acc: 62.62% -> 66.36%             
client [94] (test)  loss: 0.1307 -> 0.1388   acc: 95.90% -> 94.26%             
client [81] (test)  loss: 1.1935 -> 1.1040   acc: 63.96% -> 68.47%             
client [3] (test)  loss: 0.3602 -> 0.3487   acc: 88.14% -> 87.75%              
client [11] (test)  loss: 1.5229 -> 1.4839   acc: 41.43% -> 47.14%             
client [95] (test)  loss: 0.5684 -> 0.5697   acc: 86.39% -> 85.71%             
client [67] (test)  loss: 0.7575 -> 0.6989   acc: 71.43% -> 72.73%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.8691 -> 0.8635   acc: 77.43% -> 77.43%             
client [79] (test)  loss: 0.4457 -> 0.4398   acc: 84.51% -> 84.51%             
client [58] (test)  loss: 1.0948 -> 1.0838   acc: 59.40% -> 59.40%             
client [88] (test)  loss: 1.1889 -> 1.2108   acc: 65.91% -> 64.39%             
client [46] (test)  loss: 0.4428 -> 0.4288   acc: 85.71% -> 86.51%             
client [11] (test)  loss: 1.4896 -> 1.4461   acc: 47.14% -> 52.86%             
client [55] (test)  loss: 1.5739 -> 1.4738   acc: 47.12% -> 42.31%             
client [13] (test)  loss: 1.3089 -> 1.2796   acc: 59.15% -> 60.56%             
client [31] (test)  loss: 0.6650 -> 0.6629   acc: 81.82% -> 82.64%             
client [75] (test)  loss: 1.5720 -> 1.5675   acc: 56.60% -> 56.60%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.4911 -> 1.4754   acc: 57.14% -> 57.14%             
client [7] (test)  loss: 0.9322 -> 0.9302   acc: 73.91% -> 71.30%              
client [57] (test)  loss: 0.9843 -> 0.9459   acc: 69.92% -> 72.18%             
client [13] (test)  loss: 1.2998 -> 1.2865   acc: 60.56% -> 59.15%             
client [43] (test)  loss: 0.8072 -> 0.7230   acc: 75.41% -> 80.33%             
client [91] (test)  loss: 0.6989 -> 0.6818   acc: 81.40% -> 82.17%             
client [10] (test)  loss: 0.7827 -> 0.7742   acc: 72.93% -> 72.18%             
client [64] (test)  loss: 0.7738 -> 0.7587   acc: 78.38% -> 79.05%             
client [82] (test)  loss: 0.9544 -> 0.9561   acc: 74.05% -> 73.28%             
client [22] (test)  loss: 1.2054 -> 1.0584   acc: 58.72% -> 63.30%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2583 -> 0.2512   acc: 92.16% -> 92.81%             
client [23] (test)  loss: 1.3164 -> 1.2290   acc: 55.91% -> 59.06%             
client [88] (test)  loss: 1.2002 -> 1.2169   acc: 66.67% -> 63.64%             
client [98] (test)  loss: 1.0216 -> 1.0062   acc: 65.00% -> 65.00%             
client [79] (test)  loss: 0.4372 -> 0.4392   acc: 83.80% -> 83.10%             
client [21] (test)  loss: 0.8333 -> 0.8379   acc: 79.65% -> 78.32%             
client [92] (test)  loss: 1.0873 -> 1.0786   acc: 66.33% -> 67.35%             
client [56] (test)  loss: 0.6699 -> 0.6172   acc: 80.74% -> 82.96%             
client [5] (test)  loss: 1.0674 -> 1.0558   acc: 67.06% -> 69.41%              
client [52] (test)  loss: 0.8064 -> 0.7050   acc: 75.78% -> 79.50%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '1.0182 -> 0.0000', 'accuracy': '66.85% -> 0.00%'},          
    200: {'loss': '0.8480 -> 0.0000', 'accuracy': '73.67% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(13.52%) at epoch: 0                               
LG-FedAvg-0.5 achieved 20.0%(22.86%) at epoch: 1                               
LG-FedAvg-0.5 achieved 40.0%(41.22%) at epoch: 7                               
LG-FedAvg-0.5 achieved 50.0%(50.47%) at epoch: 22                              
LG-FedAvg-0.5 achieved 60.0%(62.49%) at epoch: 24                              
LG-FedAvg-0.5 achieved 70.0%(70.34%) at epoch: 44                              
LG-FedAvg-0.5 achieved 80.0%(81.24%) at epoch: 190                             
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 40.0%(45.42%) at epoch: 0                               
LG-FedAvg-0.5 achieved 50.0%(51.38%) at epoch: 2                               
LG-FedAvg-0.5 achieved 60.0%(65.09%) at epoch: 6                               
LG-FedAvg-0.5 achieved 70.0%(72.46%) at epoch: 44                              
LG-FedAvg-0.5 achieved 80.0%(81.94%) at epoch: 190                             
