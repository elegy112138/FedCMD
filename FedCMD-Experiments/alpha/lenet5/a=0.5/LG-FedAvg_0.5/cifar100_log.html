==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.4238 -> 4.2094   acc: 2.95% -> 5.25%               
client [81] (test)  loss: 4.4546 -> 4.2417   acc: 10.20% -> 11.18%             
client [21] (test)  loss: 9.5514 -> 4.3924   acc: 1.74% -> 7.67%               
client [68] (test)  loss: 4.4414 -> 4.0449   acc: 13.68% -> 13.68%             
client [93] (test)  loss: 4.5101 -> 4.1708   acc: 3.26% -> 7.17%               
client [31] (test)  loss: 4.4997 -> 4.2456   acc: 4.73% -> 9.09%               
client [20] (test)  loss: 4.5012 -> 4.4361   acc: 1.03% -> 3.79%               
client [59] (test)  loss: 10.4749 -> 4.5181   acc: 0.32% -> 3.24%              
client [48] (test)  loss: 4.4296 -> 4.2924   acc: 5.57% -> 5.57%               
client [34] (test)  loss: 4.5512 -> 4.4367   acc: 2.21% -> 2.58%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.1418 -> 3.9220   acc: 7.19% -> 8.99%               
client [99] (test)  loss: 4.5269 -> 4.3057   acc: 5.45% -> 8.01%               
client [67] (test)  loss: 4.5253 -> 4.3484   acc: 3.58% -> 3.58%               
client [0] (test)  loss: 4.0046 -> 3.8097   acc: 14.67% -> 14.67%              
client [76] (test)  loss: 4.4185 -> 4.3409   acc: 4.92% -> 4.55%               
client [41] (test)  loss: 4.4693 -> 4.2083   acc: 2.33% -> 2.33%               
client [62] (test)  loss: 11.7605 -> 4.4843   acc: 1.98% -> 3.63%              
client [2] (test)  loss: 13.3755 -> 4.4929   acc: 0.00% -> 3.64%               
client [14] (test)  loss: 4.1227 -> 4.0413   acc: 9.90% -> 10.86%              
client [46] (test)  loss: 4.2121 -> 4.1404   acc: 7.97% -> 7.97%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.1993 -> 4.0830   acc: 6.60% -> 7.29%               
client [68] (test)  loss: 3.8413 -> 3.8552   acc: 13.68% -> 14.59%             
client [57] (test)  loss: 4.3634 -> 4.1272   acc: 10.03% -> 10.03%             
client [17] (test)  loss: 3.8750 -> 3.8077   acc: 14.33% -> 14.33%             
client [54] (test)  loss: 3.8334 -> 3.7654   acc: 11.90% -> 13.83%             
client [23] (test)  loss: 11.5676 -> 4.5123   acc: 1.67% -> 4.33%              
client [35] (test)  loss: 4.1025 -> 4.0340   acc: 6.89% -> 7.87%               
client [59] (test)  loss: 4.1653 -> 3.9847   acc: 4.53% -> 5.18%               
client [31] (test)  loss: 4.2224 -> 4.0395   acc: 14.55% -> 14.91%             
client [9] (test)  loss: 4.3647 -> 4.2429   acc: 3.91% -> 4.89%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.7046 -> 3.6758   acc: 13.62% -> 14.29%             
client [33] (test)  loss: 3.9308 -> 3.9275   acc: 6.48% -> 7.51%               
client [16] (test)  loss: 3.5925 -> 3.4929   acc: 22.89% -> 22.89%             
client [44] (test)  loss: 4.4978 -> 4.2514   acc: 7.26% -> 7.59%               
client [8] (test)  loss: 3.9521 -> 3.8081   acc: 8.89% -> 10.16%               
client [31] (test)  loss: 4.1802 -> 4.0489   acc: 14.91% -> 15.27%             
client [47] (test)  loss: 4.1268 -> 4.0339   acc: 7.50% -> 10.00%              
client [36] (test)  loss: 4.4949 -> 4.2908   acc: 7.92% -> 7.92%               
client [20] (test)  loss: 4.1188 -> 4.0697   acc: 12.07% -> 12.76%             
client [56] (test)  loss: 4.4667 -> 4.3952   acc: 3.15% -> 3.15%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.0460 -> 3.9818   acc: 9.16% -> 9.16%                
client [60] (test)  loss: 4.4628 -> 4.2892   acc: 10.37% -> 10.00%             
client [28] (test)  loss: 3.9768 -> 4.0698   acc: 9.03% -> 9.35%               
client [25] (test)  loss: 3.9318 -> 3.8797   acc: 10.36% -> 9.71%              
client [58] (test)  loss: 3.9801 -> 3.8081   acc: 11.32% -> 12.89%             
client [44] (test)  loss: 4.2679 -> 4.1664   acc: 7.92% -> 11.22%              
client [39] (test)  loss: 4.3335 -> 4.2692   acc: 4.29% -> 6.27%               
client [29] (test)  loss: 3.7443 -> 3.6135   acc: 16.61% -> 17.28%             
client [3] (test)  loss: 3.6186 -> 3.6519   acc: 22.01% -> 18.45%              
client [84] (test)  loss: 4.3281 -> 4.0517   acc: 6.23% -> 7.17%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.1043 -> 4.0046   acc: 9.41% -> 9.76%               
client [84] (test)  loss: 4.2308 -> 4.0654   acc: 6.85% -> 9.66%               
client [10] (test)  loss: 3.8038 -> 3.7317   acc: 9.18% -> 9.51%               
client [36] (test)  loss: 4.1947 -> 4.1351   acc: 7.92% -> 8.75%               
client [65] (test)  loss: 3.8318 -> 3.6642   acc: 13.27% -> 18.12%             
client [81] (test)  loss: 3.8723 -> 4.0205   acc: 13.49% -> 8.88%              
client [79] (test)  loss: 4.0004 -> 3.9320   acc: 9.30% -> 10.96%              
client [42] (test)  loss: 3.9480 -> 3.9378   acc: 8.84% -> 9.86%               
client [11] (test)  loss: 3.9781 -> 3.9454   acc: 10.53% -> 13.33%             
client [96] (test)  loss: 4.1069 -> 4.0204   acc: 10.36% -> 9.06%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.8149 -> 3.9219   acc: 11.11% -> 10.16%              
client [53] (test)  loss: 3.8151 -> 3.7909   acc: 8.88% -> 9.54%               
client [52] (test)  loss: 3.7774 -> 3.6996   acc: 11.65% -> 13.59%             
client [42] (test)  loss: 3.9744 -> 3.8257   acc: 8.50% -> 13.95%              
client [69] (test)  loss: 3.7079 -> 3.7254   acc: 16.19% -> 19.06%             
client [59] (test)  loss: 3.9377 -> 3.8055   acc: 9.06% -> 9.39%               
client [7] (test)  loss: 3.9067 -> 3.8900   acc: 11.82% -> 12.14%              
client [26] (test)  loss: 3.8261 -> 3.8239   acc: 15.61% -> 18.27%             
client [49] (test)  loss: 4.1356 -> 4.0964   acc: 11.29% -> 11.69%             
client [98] (test)  loss: 3.9504 -> 3.9961   acc: 9.12% -> 9.45%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.0298 -> 3.9730   acc: 9.12% -> 10.10%              
client [47] (test)  loss: 4.0700 -> 3.9479   acc: 9.06% -> 14.06%              
client [21] (test)  loss: 3.9908 -> 3.9173   acc: 14.98% -> 12.20%             
client [77] (test)  loss: 4.0413 -> 4.0034   acc: 7.87% -> 11.48%              
client [95] (test)  loss: 4.1027 -> 3.9159   acc: 10.89% -> 11.22%             
client [91] (test)  loss: 3.8453 -> 3.6755   acc: 12.18% -> 20.19%             
client [14] (test)  loss: 3.9742 -> 4.0407   acc: 12.78% -> 12.14%             
client [99] (test)  loss: 4.0975 -> 4.0780   acc: 9.94% -> 9.94%               
client [20] (test)  loss: 3.9355 -> 3.9365   acc: 12.07% -> 12.76%             
client [39] (test)  loss: 4.2362 -> 4.1332   acc: 5.94% -> 9.57%               
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.8046 -> 3.6520   acc: 11.00% -> 14.56%             
client [62] (test)  loss: 3.7841 -> 3.8403   acc: 14.85% -> 13.20%             
client [71] (test)  loss: 4.4604 -> 4.4142   acc: 10.14% -> 13.51%             
client [97] (test)  loss: 3.6627 -> 3.4631   acc: 13.31% -> 19.50%             
client [30] (test)  loss: 3.9405 -> 3.9515   acc: 12.67% -> 10.00%             
client [88] (test)  loss: 4.1058 -> 3.9226   acc: 4.96% -> 12.41%              
client [60] (test)  loss: 4.2802 -> 4.2398   acc: 10.00% -> 10.74%             
client [82] (test)  loss: 3.9309 -> 4.0839   acc: 11.60% -> 11.60%             
client [91] (test)  loss: 3.8072 -> 3.6563   acc: 16.03% -> 22.76%             
client [57] (test)  loss: 4.1301 -> 3.8130   acc: 10.36% -> 15.21%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.6120 -> 4.3551   acc: 14.91% -> 12.73%             
client [15] (test)  loss: 3.6426 -> 3.5935   acc: 14.52% -> 17.16%             
client [71] (test)  loss: 4.3569 -> 4.3293   acc: 10.47% -> 13.85%             
client [97] (test)  loss: 3.5880 -> 3.4159   acc: 16.41% -> 22.60%             
client [53] (test)  loss: 3.7996 -> 3.7391   acc: 13.49% -> 16.12%             
client [77] (test)  loss: 4.0070 -> 4.0274   acc: 10.82% -> 12.13%             
client [76] (test)  loss: 4.3782 -> 4.4219   acc: 7.20% -> 9.47%               
client [79] (test)  loss: 3.9478 -> 3.9122   acc: 9.63% -> 11.63%              
client [28] (test)  loss: 3.9297 -> 4.1795   acc: 9.68% -> 14.52%              
client [99] (test)  loss: 4.0700 -> 4.0536   acc: 10.26% -> 11.22%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.5225 -> 3.3840   acc: 18.89% -> 25.70%             
client [86] (test)  loss: 3.7573 -> 3.9013   acc: 15.58% -> 13.96%             
client [34] (test)  loss: 3.8978 -> 4.2550   acc: 16.24% -> 11.44%             
client [73] (test)  loss: 3.9640 -> 4.5265   acc: 15.86% -> 8.09%              
client [5] (test)  loss: 4.5724 -> 4.0542   acc: 9.60% -> 14.24%               
client [96] (test)  loss: 3.8539 -> 3.7227   acc: 10.68% -> 15.53%             
client [22] (test)  loss: 3.8933 -> 3.8776   acc: 11.92% -> 12.58%             
client [60] (test)  loss: 4.3212 -> 4.1716   acc: 6.67% -> 12.96%              
client [66] (test)  loss: 3.8310 -> 3.8700   acc: 12.96% -> 11.30%             
client [83] (test)  loss: 4.1510 -> 3.8990   acc: 11.60% -> 14.33%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.5813 -> 4.4793   acc: 10.61% -> 12.12%             
client [65] (test)  loss: 3.7852 -> 3.6085   acc: 15.53% -> 19.09%             
client [95] (test)  loss: 4.0974 -> 3.9557   acc: 13.53% -> 13.20%             
client [17] (test)  loss: 4.0106 -> 3.6888   acc: 19.01% -> 18.13%             
client [8] (test)  loss: 3.7952 -> 3.7321   acc: 13.65% -> 14.29%              
client [35] (test)  loss: 4.0045 -> 4.1412   acc: 11.48% -> 7.54%              
client [98] (test)  loss: 4.0822 -> 4.1508   acc: 8.47% -> 4.89%               
client [53] (test)  loss: 3.7715 -> 3.7675   acc: 16.45% -> 17.76%             
client [43] (test)  loss: 3.9126 -> 4.0971   acc: 9.57% -> 7.26%               
client [64] (test)  loss: 3.5602 -> 3.5438   acc: 20.60% -> 18.94%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.8894 -> 3.8655   acc: 14.29% -> 13.94%             
client [88] (test)  loss: 3.9041 -> 3.7477   acc: 10.28% -> 16.31%             
client [38] (test)  loss: 3.1529 -> 3.1297   acc: 21.97% -> 24.26%             
client [3] (test)  loss: 3.3554 -> 3.3956   acc: 25.57% -> 25.89%              
client [5] (test)  loss: 4.8958 -> 4.1360   acc: 8.61% -> 14.90%               
client [41] (test)  loss: 3.7458 -> 3.7688   acc: 14.62% -> 11.96%             
client [7] (test)  loss: 4.1251 -> 3.8558   acc: 7.35% -> 11.50%               
client [37] (test)  loss: 4.3915 -> 3.8636   acc: 10.89% -> 12.87%             
client [45] (test)  loss: 3.5842 -> 3.4139   acc: 11.63% -> 14.62%             
client [47] (test)  loss: 3.9561 -> 3.8636   acc: 10.62% -> 14.06%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.4424 -> 3.2202   acc: 26.32% -> 26.58%             
client [11] (test)  loss: 3.7787 -> 3.8016   acc: 18.60% -> 20.00%             
client [37] (test)  loss: 4.0311 -> 3.7835   acc: 13.53% -> 15.84%             
client [41] (test)  loss: 3.7287 -> 3.7778   acc: 13.95% -> 11.63%             
client [95] (test)  loss: 4.0883 -> 4.1564   acc: 14.85% -> 13.20%             
client [53] (test)  loss: 3.7865 -> 3.8057   acc: 17.76% -> 18.09%             
client [22] (test)  loss: 3.9162 -> 3.8955   acc: 12.25% -> 14.57%             
client [25] (test)  loss: 3.5372 -> 3.5199   acc: 20.06% -> 17.15%             
client [69] (test)  loss: 4.5134 -> 4.1967   acc: 20.50% -> 20.14%             
client [46] (test)  loss: 3.9925 -> 3.9585   acc: 13.29% -> 13.62%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 3.7762 -> 3.8798   acc: 16.56% -> 14.06%             
client [69] (test)  loss: 4.5914 -> 4.4988   acc: 20.14% -> 19.42%             
client [82] (test)  loss: 3.7428 -> 3.8315   acc: 15.02% -> 11.95%             
client [45] (test)  loss: 3.4915 -> 3.3208   acc: 14.29% -> 19.27%             
client [7] (test)  loss: 4.0314 -> 3.8518   acc: 7.99% -> 11.82%               
client [50] (test)  loss: 4.0341 -> 3.9802   acc: 8.64% -> 9.63%               
client [35] (test)  loss: 4.1999 -> 4.2418   acc: 8.85% -> 9.51%               
client [24] (test)  loss: 4.6557 -> 4.0658   acc: 9.03% -> 12.15%              
client [15] (test)  loss: 3.5765 -> 3.5919   acc: 13.53% -> 16.17%             
client [58] (test)  loss: 4.2868 -> 4.1286   acc: 18.87% -> 23.27%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.2223 -> 4.7702   acc: 7.54% -> 8.85%               
client [76] (test)  loss: 4.7591 -> 4.5742   acc: 10.98% -> 12.50%             
client [67] (test)  loss: 3.9445 -> 3.8295   acc: 11.73% -> 14.98%             
client [37] (test)  loss: 4.2507 -> 3.7659   acc: 11.22% -> 17.16%             
client [58] (test)  loss: 4.9547 -> 4.4533   acc: 14.15% -> 19.18%             
client [64] (test)  loss: 3.6477 -> 3.5283   acc: 20.27% -> 21.93%             
client [77] (test)  loss: 4.1334 -> 4.0474   acc: 10.16% -> 13.11%             
client [55] (test)  loss: 4.5188 -> 4.3018   acc: 9.57% -> 9.22%               
client [12] (test)  loss: 4.1860 -> 4.2141   acc: 9.63% -> 9.63%               
client [89] (test)  loss: 4.4513 -> 4.9918   acc: 13.83% -> 14.47%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.6040 -> 4.8227   acc: 14.95% -> 16.82%             
client [51] (test)  loss: 4.2425 -> 4.2346   acc: 19.27% -> 18.60%             
client [8] (test)  loss: 4.1317 -> 4.2049   acc: 14.29% -> 16.51%              
client [18] (test)  loss: 3.3836 -> 3.4127   acc: 25.25% -> 25.57%             
client [94] (test)  loss: 4.0624 -> 3.9710   acc: 17.31% -> 19.08%             
client [81] (test)  loss: 4.1558 -> 4.3114   acc: 17.76% -> 18.09%             
client [3] (test)  loss: 4.2208 -> 3.6944   acc: 21.68% -> 25.24%              
client [11] (test)  loss: 3.8453 -> 3.8826   acc: 20.70% -> 20.00%             
client [95] (test)  loss: 4.7271 -> 4.8539   acc: 11.88% -> 12.21%             
client [67] (test)  loss: 3.8540 -> 3.8174   acc: 14.66% -> 15.64%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.8472 -> 3.8158   acc: 13.24% -> 15.68%             
client [79] (test)  loss: 4.0086 -> 4.0110   acc: 15.95% -> 13.95%             
client [58] (test)  loss: 5.0147 -> 4.8382   acc: 15.72% -> 20.75%             
client [88] (test)  loss: 4.1808 -> 3.7886   acc: 8.87% -> 15.96%              
client [46] (test)  loss: 4.2536 -> 3.9611   acc: 8.31% -> 16.61%              
client [11] (test)  loss: 4.0418 -> 3.9623   acc: 17.19% -> 17.89%             
client [55] (test)  loss: 4.4596 -> 4.6344   acc: 9.22% -> 8.51%               
client [13] (test)  loss: 4.1511 -> 4.1499   acc: 11.85% -> 12.89%             
client [31] (test)  loss: 5.4123 -> 4.7617   acc: 14.55% -> 13.45%             
client [75] (test)  loss: 3.9157 -> 3.9734   acc: 14.63% -> 17.61%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.1989 -> 4.4942   acc: 15.64% -> 14.01%             
client [7] (test)  loss: 4.1595 -> 4.0189   acc: 10.86% -> 15.02%              
client [57] (test)  loss: 3.8541 -> 3.7434   acc: 15.86% -> 17.15%             
client [13] (test)  loss: 4.2790 -> 4.2723   acc: 11.50% -> 13.59%             
client [43] (test)  loss: 4.1367 -> 4.3874   acc: 13.20% -> 8.58%              
client [91] (test)  loss: 3.7983 -> 3.7673   acc: 21.79% -> 21.79%             
client [10] (test)  loss: 3.9678 -> 4.1037   acc: 17.70% -> 18.36%             
client [64] (test)  loss: 3.7450 -> 3.7628   acc: 20.60% -> 22.92%             
client [82] (test)  loss: 4.1934 -> 4.0612   acc: 10.92% -> 15.70%             
client [22] (test)  loss: 4.0504 -> 4.1228   acc: 13.58% -> 13.25%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.0426 -> 4.1371   acc: 12.41% -> 17.93%             
client [23] (test)  loss: 4.1492 -> 3.8884   acc: 6.00% -> 12.33%              
client [88] (test)  loss: 4.3337 -> 3.8196   acc: 8.51% -> 14.18%              
client [98] (test)  loss: 4.8392 -> 4.5626   acc: 9.12% -> 9.45%               
client [79] (test)  loss: 4.1666 -> 4.2260   acc: 15.28% -> 15.28%             
client [21] (test)  loss: 3.8031 -> 3.8072   acc: 16.72% -> 16.38%             
client [92] (test)  loss: 5.0348 -> 4.6370   acc: 10.33% -> 11.33%             
client [56] (test)  loss: 4.5220 -> 4.5619   acc: 13.64% -> 14.34%             
client [5] (test)  loss: 7.0804 -> 4.8294   acc: 7.62% -> 10.93%               
client [52] (test)  loss: 4.5693 -> 3.9897   acc: 11.97% -> 13.92%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '3.9401 -> 0.0000', 'accuracy': '12.81% -> 0.00%'},          
    200: {'loss': '4.4380 -> 0.0000', 'accuracy': '14.32% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(10.82%) at epoch: 39                              
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 10.0%(10.56%) at epoch: 33                              
