==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6835 -> 1.8265   acc: 33.05% -> 34.42%             
client [81] (test)  loss: 1.6044 -> 1.6131   acc: 49.91% -> 50.46%             
client [21] (test)  loss: 3.0291 -> 1.2460   acc: 15.38% -> 65.38%             
client [68] (test)  loss: 0.0681 -> 0.0673   acc: 99.14% -> 99.14%             
client [93] (test)  loss: 1.1022 -> 0.9043   acc: 48.09% -> 60.95%             
client [31] (test)  loss: 0.0594 -> 0.0413   acc: 99.65% -> 99.65%             
client [20] (test)  loss: 1.8916 -> 1.8888   acc: 36.03% -> 32.39%             
client [59] (test)  loss: 6.3389 -> 1.9931   acc: 12.97% -> 28.03%             
client [48] (test)  loss: 1.6376 -> 1.4332   acc: 39.11% -> 49.82%             
client [34] (test)  loss: 1.7931 -> 1.6833   acc: 36.77% -> 36.77%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6825 -> 1.6663   acc: 36.11% -> 37.85%             
client [99] (test)  loss: 1.4962 -> 1.3970   acc: 41.37% -> 44.12%             
client [67] (test)  loss: 1.6812 -> 1.4057   acc: 48.10% -> 53.49%             
client [0] (test)  loss: 1.7429 -> 1.6399   acc: 35.17% -> 43.22%              
client [76] (test)  loss: 1.1107 -> 1.0416   acc: 65.36% -> 66.11%             
client [41] (test)  loss: 1.3733 -> 1.1785   acc: 57.30% -> 57.30%             
client [62] (test)  loss: 6.2730 -> 0.9851   acc: 8.28% -> 56.95%              
client [2] (test)  loss: 4.5247 -> 1.3811   acc: 14.86% -> 48.65%              
client [14] (test)  loss: 0.7364 -> 0.5504   acc: 78.18% -> 83.26%             
client [46] (test)  loss: 1.7267 -> 1.5998   acc: 43.94% -> 43.94%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8162 -> 0.9577   acc: 78.60% -> 64.00%             
client [68] (test)  loss: 0.0792 -> 0.0637   acc: 99.14% -> 99.14%             
client [57] (test)  loss: 1.1079 -> 0.8164   acc: 54.60% -> 71.60%             
client [17] (test)  loss: 1.9263 -> 1.8089   acc: 31.00% -> 33.42%             
client [54] (test)  loss: 1.6401 -> 1.5140   acc: 43.68% -> 53.46%             
client [23] (test)  loss: 7.0290 -> 0.9539   acc: 5.10% -> 73.73%              
client [35] (test)  loss: 1.5590 -> 1.5195   acc: 49.35% -> 49.61%             
client [59] (test)  loss: 1.6638 -> 1.4807   acc: 45.82% -> 51.67%             
client [31] (test)  loss: 0.0293 -> 0.0304   acc: 99.65% -> 99.65%             
client [9] (test)  loss: 1.5111 -> 1.3775   acc: 53.82% -> 58.85%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.4042 -> 1.2186   acc: 46.08% -> 56.47%             
client [33] (test)  loss: 1.5732 -> 1.3063   acc: 39.38% -> 57.51%             
client [16] (test)  loss: 0.8701 -> 0.7041   acc: 72.27% -> 79.41%             
client [44] (test)  loss: 1.3923 -> 1.1698   acc: 45.82% -> 61.50%             
client [8] (test)  loss: 0.8113 -> 0.8205   acc: 74.68% -> 75.54%              
client [31] (test)  loss: 0.0414 -> 0.0282   acc: 99.65% -> 99.65%             
client [47] (test)  loss: 0.2518 -> 0.3778   acc: 92.28% -> 85.25%             
client [36] (test)  loss: 2.2106 -> 2.0502   acc: 34.71% -> 34.71%             
client [20] (test)  loss: 1.2410 -> 1.1720   acc: 60.12% -> 63.77%             
client [56] (test)  loss: 1.8421 -> 1.6260   acc: 37.45% -> 45.22%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.7673 -> 1.5770   acc: 35.78% -> 50.49%              
client [60] (test)  loss: 1.6068 -> 1.3663   acc: 41.53% -> 50.60%             
client [28] (test)  loss: 1.6823 -> 1.6035   acc: 42.77% -> 46.30%             
client [25] (test)  loss: 1.7323 -> 1.5952   acc: 33.57% -> 38.93%             
client [58] (test)  loss: 0.9633 -> 0.9727   acc: 70.19% -> 67.92%             
client [44] (test)  loss: 1.1216 -> 1.0007   acc: 50.35% -> 67.94%             
client [39] (test)  loss: 1.2409 -> 1.0958   acc: 65.48% -> 68.09%             
client [29] (test)  loss: 1.2248 -> 1.1304   acc: 63.88% -> 66.96%             
client [3] (test)  loss: 1.4201 -> 1.2578   acc: 54.37% -> 59.49%              
client [84] (test)  loss: 1.1363 -> 1.0198   acc: 63.87% -> 65.92%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9371 -> 0.8269   acc: 65.38% -> 67.50%             
client [84] (test)  loss: 0.9751 -> 1.0443   acc: 69.65% -> 69.65%             
client [10] (test)  loss: 1.0344 -> 0.9742   acc: 68.55% -> 66.52%             
client [36] (test)  loss: 1.9286 -> 1.8338   acc: 34.71% -> 34.71%             
client [65] (test)  loss: 0.7095 -> 0.7761   acc: 75.45% -> 70.06%             
client [81] (test)  loss: 1.1394 -> 1.0217   acc: 61.75% -> 64.30%             
client [79] (test)  loss: 1.4076 -> 1.2511   acc: 53.62% -> 61.70%             
client [42] (test)  loss: 0.6132 -> 0.5637   acc: 77.94% -> 79.58%             
client [11] (test)  loss: 0.7404 -> 0.6152   acc: 72.74% -> 76.80%             
client [96] (test)  loss: 0.9840 -> 0.9661   acc: 64.26% -> 66.11%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7217 -> 0.7185   acc: 79.87% -> 80.74%              
client [53] (test)  loss: 0.9738 -> 0.8658   acc: 68.55% -> 73.71%             
client [52] (test)  loss: 0.5114 -> 0.5067   acc: 84.56% -> 86.43%             
client [42] (test)  loss: 0.5752 -> 0.5304   acc: 78.92% -> 81.54%             
client [69] (test)  loss: 1.2297 -> 1.1734   acc: 63.19% -> 64.93%             
client [59] (test)  loss: 1.5006 -> 1.1273   acc: 50.00% -> 62.13%             
client [7] (test)  loss: 0.8665 -> 0.8243   acc: 75.41% -> 76.77%              
client [26] (test)  loss: 0.6443 -> 0.5381   acc: 76.87% -> 81.42%             
client [49] (test)  loss: 1.1653 -> 1.0721   acc: 64.16% -> 68.57%             
client [98] (test)  loss: 0.8959 -> 1.0831   acc: 73.68% -> 65.44%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9035 -> 1.0180   acc: 73.51% -> 69.12%             
client [47] (test)  loss: 0.2251 -> 0.2200   acc: 92.56% -> 93.40%             
client [21] (test)  loss: 0.7428 -> 0.6492   acc: 74.81% -> 75.58%             
client [77] (test)  loss: 1.3095 -> 1.0136   acc: 58.52% -> 66.78%             
client [95] (test)  loss: 0.4768 -> 0.3863   acc: 85.21% -> 87.16%             
client [91] (test)  loss: 1.4056 -> 1.3155   acc: 53.77% -> 55.23%             
client [14] (test)  loss: 0.4180 -> 0.5159   acc: 88.49% -> 85.50%             
client [99] (test)  loss: 0.8044 -> 0.7169   acc: 72.35% -> 76.47%             
client [20] (test)  loss: 1.0381 -> 1.0405   acc: 68.62% -> 70.04%             
client [39] (test)  loss: 0.8946 -> 0.8549   acc: 72.81% -> 70.45%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5255 -> 0.5102   acc: 84.09% -> 86.90%             
client [62] (test)  loss: 0.3421 -> 0.3994   acc: 90.07% -> 88.25%             
client [71] (test)  loss: 1.5474 -> 1.4028   acc: 48.43% -> 55.18%             
client [97] (test)  loss: 1.2564 -> 0.8048   acc: 63.17% -> 75.25%             
client [30] (test)  loss: 0.3794 -> 0.2904   acc: 88.00% -> 91.09%             
client [88] (test)  loss: 0.4033 -> 0.3838   acc: 87.16% -> 88.26%             
client [60] (test)  loss: 0.9888 -> 0.9039   acc: 69.35% -> 71.98%             
client [82] (test)  loss: 1.4492 -> 1.5243   acc: 56.73% -> 58.33%             
client [91] (test)  loss: 1.3080 -> 1.2669   acc: 57.18% -> 58.88%             
client [57] (test)  loss: 0.5230 -> 0.4859   acc: 82.00% -> 84.60%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0509 -> 0.0205   acc: 99.65% -> 99.65%             
client [15] (test)  loss: 0.8792 -> 0.6709   acc: 69.54% -> 77.90%             
client [71] (test)  loss: 1.3931 -> 1.3628   acc: 54.70% -> 54.22%             
client [97] (test)  loss: 1.2035 -> 0.7667   acc: 68.32% -> 76.04%             
client [53] (test)  loss: 0.7447 -> 0.7004   acc: 77.89% -> 80.84%             
client [77] (test)  loss: 1.4626 -> 0.9585   acc: 57.83% -> 68.50%             
client [76] (test)  loss: 0.6855 -> 0.5888   acc: 76.85% -> 81.09%             
client [79] (test)  loss: 1.2389 -> 1.0853   acc: 58.72% -> 65.11%             
client [28] (test)  loss: 1.2349 -> 1.1916   acc: 58.52% -> 61.74%             
client [99] (test)  loss: 0.9550 -> 0.6382   acc: 68.43% -> 78.82%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.9657 -> 0.7964   acc: 74.65% -> 75.84%             
client [86] (test)  loss: 1.0096 -> 0.6442   acc: 64.23% -> 76.09%             
client [34] (test)  loss: 1.0625 -> 1.0670   acc: 67.42% -> 65.16%             
client [73] (test)  loss: 0.6381 -> 0.5861   acc: 80.39% -> 83.01%             
client [5] (test)  loss: 0.5758 -> 0.5654   acc: 87.20% -> 86.80%              
client [96] (test)  loss: 0.9451 -> 0.8851   acc: 75.00% -> 78.52%             
client [22] (test)  loss: 1.1975 -> 1.2975   acc: 64.67% -> 59.78%             
client [60] (test)  loss: 1.0260 -> 0.9375   acc: 70.77% -> 72.38%             
client [66] (test)  loss: 0.1056 -> 0.0808   acc: 95.15% -> 96.88%             
client [83] (test)  loss: 1.3583 -> 1.0591   acc: 59.19% -> 65.66%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6850 -> 0.6270   acc: 80.03% -> 81.24%             
client [65] (test)  loss: 0.6752 -> 0.6215   acc: 77.05% -> 77.84%             
client [95] (test)  loss: 0.3549 -> 0.3518   acc: 88.33% -> 88.72%             
client [17] (test)  loss: 1.4287 -> 1.3548   acc: 52.83% -> 54.45%             
client [8] (test)  loss: 0.7618 -> 0.6743   acc: 78.79% -> 81.39%              
client [35] (test)  loss: 1.0251 -> 1.0164   acc: 74.29% -> 73.77%             
client [98] (test)  loss: 0.9236 -> 0.9282   acc: 72.11% -> 71.93%             
client [53] (test)  loss: 0.6828 -> 0.6550   acc: 81.08% -> 81.57%             
client [43] (test)  loss: 1.2958 -> 1.2469   acc: 62.35% -> 63.33%             
client [64] (test)  loss: 0.9956 -> 0.9276   acc: 68.82% -> 71.96%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6873 -> 0.5987   acc: 76.92% -> 79.23%             
client [88] (test)  loss: 0.4005 -> 0.3947   acc: 90.46% -> 90.64%             
client [38] (test)  loss: 0.5241 -> 0.4695   acc: 84.91% -> 86.72%             
client [3] (test)  loss: 1.1716 -> 1.1049   acc: 66.95% -> 69.51%              
client [5] (test)  loss: 0.5520 -> 0.5481   acc: 87.20% -> 87.20%              
client [41] (test)  loss: 0.8638 -> 0.7329   acc: 72.86% -> 78.57%             
client [7] (test)  loss: 0.8246 -> 0.7756   acc: 76.47% -> 79.03%              
client [37] (test)  loss: 1.0950 -> 1.0630   acc: 68.47% -> 67.60%             
client [45] (test)  loss: 0.9255 -> 0.8446   acc: 67.36% -> 71.51%             
client [47] (test)  loss: 0.2155 -> 0.1950   acc: 93.40% -> 94.38%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6193 -> 0.6382   acc: 82.07% -> 82.21%             
client [11] (test)  loss: 0.5100 -> 0.5245   acc: 83.43% -> 82.32%             
client [37] (test)  loss: 1.1265 -> 1.0501   acc: 66.95% -> 68.68%             
client [41] (test)  loss: 0.9087 -> 0.7571   acc: 72.70% -> 79.52%             
client [95] (test)  loss: 0.3532 -> 0.3178   acc: 90.08% -> 90.27%             
client [53] (test)  loss: 0.7108 -> 0.6364   acc: 78.87% -> 81.82%             
client [22] (test)  loss: 1.3072 -> 1.2462   acc: 63.04% -> 62.50%             
client [25] (test)  loss: 1.0883 -> 0.9762   acc: 64.46% -> 65.00%             
client [69] (test)  loss: 1.1561 -> 1.1032   acc: 66.32% -> 71.18%             
client [46] (test)  loss: 1.1221 -> 1.0953   acc: 64.74% -> 66.18%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3006 -> 0.2020   acc: 90.87% -> 94.10%             
client [69] (test)  loss: 1.2247 -> 1.1492   acc: 65.62% -> 71.18%             
client [82] (test)  loss: 1.1100 -> 1.1452   acc: 69.87% -> 67.63%             
client [45] (test)  loss: 0.8094 -> 0.7951   acc: 72.64% -> 73.02%             
client [7] (test)  loss: 0.8270 -> 0.7870   acc: 77.07% -> 79.79%              
client [50] (test)  loss: 1.1557 -> 0.9296   acc: 59.12% -> 69.89%             
client [35] (test)  loss: 1.1129 -> 1.0803   acc: 73.25% -> 74.29%             
client [24] (test)  loss: 0.5155 -> 0.5263   acc: 85.40% -> 88.00%             
client [15] (test)  loss: 0.8108 -> 0.6441   acc: 75.61% -> 82.08%             
client [58] (test)  loss: 0.9117 -> 0.9398   acc: 76.42% -> 78.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.1662 -> 1.0299   acc: 72.14% -> 72.68%             
client [76] (test)  loss: 0.7430 -> 0.6741   acc: 79.73% -> 82.15%             
client [67] (test)  loss: 0.7888 -> 0.6913   acc: 71.86% -> 77.84%             
client [37] (test)  loss: 1.0632 -> 1.1065   acc: 71.27% -> 67.17%             
client [58] (test)  loss: 0.9386 -> 0.9592   acc: 78.30% -> 79.06%             
client [64] (test)  loss: 1.0023 -> 1.0035   acc: 71.37% -> 72.55%             
client [77] (test)  loss: 1.5312 -> 0.9820   acc: 61.96% -> 72.29%             
client [55] (test)  loss: 0.7163 -> 0.6282   acc: 79.95% -> 82.46%             
client [12] (test)  loss: 0.2744 -> 0.2686   acc: 91.49% -> 91.67%             
client [89] (test)  loss: 1.0419 -> 1.0368   acc: 70.70% -> 72.96%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.0611 -> 0.9912   acc: 77.09% -> 78.40%             
client [51] (test)  loss: 1.3165 -> 1.2095   acc: 63.64% -> 63.03%             
client [8] (test)  loss: 0.7661 -> 0.7160   acc: 80.09% -> 81.17%              
client [18] (test)  loss: 0.8878 -> 0.9900   acc: 74.66% -> 74.46%             
client [94] (test)  loss: 0.5463 -> 0.5435   acc: 84.15% -> 86.51%             
client [81] (test)  loss: 1.0085 -> 1.0034   acc: 73.22% -> 73.95%             
client [3] (test)  loss: 1.2366 -> 1.2527   acc: 70.58% -> 69.30%              
client [11] (test)  loss: 0.5553 -> 0.5808   acc: 82.69% -> 82.69%             
client [95] (test)  loss: 0.3564 -> 0.2756   acc: 91.63% -> 91.83%             
client [67] (test)  loss: 0.7702 -> 0.6832   acc: 73.85% -> 79.84%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6685 -> 0.6149   acc: 81.15% -> 82.69%             
client [79] (test)  loss: 1.3780 -> 1.3055   acc: 65.32% -> 68.72%             
client [58] (test)  loss: 1.1037 -> 0.9755   acc: 76.79% -> 79.43%             
client [88] (test)  loss: 0.5120 -> 0.4425   acc: 89.54% -> 90.83%             
client [46] (test)  loss: 1.1471 -> 1.1346   acc: 67.27% -> 67.09%             
client [11] (test)  loss: 0.7021 -> 0.5875   acc: 79.74% -> 82.87%             
client [55] (test)  loss: 0.8053 -> 0.6967   acc: 79.73% -> 82.69%             
client [13] (test)  loss: 1.3699 -> 1.0861   acc: 65.98% -> 73.33%             
client [31] (test)  loss: 0.0387 -> 0.0174   acc: 99.65% -> 99.65%             
client [75] (test)  loss: 0.9300 -> 0.9157   acc: 77.29% -> 77.63%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7314 -> 0.7042   acc: 81.92% -> 82.10%             
client [7] (test)  loss: 1.0274 -> 0.9576   acc: 77.83% -> 80.69%              
client [57] (test)  loss: 0.4511 -> 0.4236   acc: 86.40% -> 87.60%             
client [13] (test)  loss: 1.2897 -> 1.1277   acc: 68.05% -> 73.79%             
client [43] (test)  loss: 1.3559 -> 1.3812   acc: 63.81% -> 62.59%             
client [91] (test)  loss: 1.2192 -> 1.1553   acc: 63.26% -> 67.15%             
client [10] (test)  loss: 0.8099 -> 0.8099   acc: 78.28% -> 78.96%             
client [64] (test)  loss: 1.0834 -> 1.1066   acc: 73.73% -> 74.71%             
client [82] (test)  loss: 1.0547 -> 1.2524   acc: 71.47% -> 66.03%             
client [22] (test)  loss: 1.5616 -> 1.2625   acc: 61.23% -> 66.85%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1181 -> 1.0907   acc: 72.06% -> 73.48%             
client [23] (test)  loss: 0.7181 -> 0.6620   acc: 78.82% -> 79.22%             
client [88] (test)  loss: 0.4770 -> 0.4550   acc: 89.91% -> 90.28%             
client [98] (test)  loss: 1.1066 -> 1.1508   acc: 74.39% -> 73.68%             
client [79] (test)  loss: 1.2894 -> 1.3185   acc: 69.15% -> 69.79%             
client [21] (test)  loss: 0.7087 -> 0.6407   acc: 79.81% -> 82.88%             
client [92] (test)  loss: 0.8273 -> 0.8483   acc: 77.51% -> 76.33%             
client [56] (test)  loss: 1.3631 -> 1.0911   acc: 69.32% -> 73.11%             
client [5] (test)  loss: 0.5417 -> 0.5453   acc: 86.80% -> 86.80%              
client [52] (test)  loss: 0.7049 -> 0.6568   acc: 85.49% -> 86.58%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '0.8390 -> 0.0000', 'accuracy': '73.76% -> 0.00%'},          
    200: {'loss': '0.8826 -> 0.0000', 'accuracy': '77.61% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(13.40%) at epoch: 0                               
LG-FedAvg-0.5 achieved 20.0%(21.95%) at epoch: 3                               
LG-FedAvg-0.5 achieved 30.0%(36.96%) at epoch: 7                               
LG-FedAvg-0.5 achieved 40.0%(49.81%) at epoch: 9                               
LG-FedAvg-0.5 achieved 50.0%(53.69%) at epoch: 16                              
LG-FedAvg-0.5 achieved 60.0%(63.96%) at epoch: 28                              
LG-FedAvg-0.5 achieved 70.0%(71.03%) at epoch: 52                              
LG-FedAvg-0.5 achieved 80.0%(80.82%) at epoch: 142                             
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 50.0%(52.11%) at epoch: 0                               
LG-FedAvg-0.5 achieved 60.0%(64.13%) at epoch: 20                              
LG-FedAvg-0.5 achieved 70.0%(70.67%) at epoch: 39                              
LG-FedAvg-0.5 achieved 80.0%(80.09%) at epoch: 82                              
