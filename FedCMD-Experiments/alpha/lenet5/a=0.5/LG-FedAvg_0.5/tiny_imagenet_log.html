==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.8689 -> 4.7637   acc: 4.17% -> 5.57%               
client [81] (test)  loss: 4.9758 -> 4.9430   acc: 2.73% -> 2.55%               
client [21] (test)  loss: 5.3051 -> 4.8684   acc: 0.18% -> 3.43%               
client [68] (test)  loss: 5.0641 -> 4.8594   acc: 3.96% -> 5.22%               
client [93] (test)  loss: 4.9090 -> 4.7029   acc: 6.51% -> 7.78%               
client [31] (test)  loss: 4.9801 -> 4.7420   acc: 7.21% -> 7.21%               
client [20] (test)  loss: 4.6828 -> 4.5901   acc: 5.53% -> 6.06%               
client [59] (test)  loss: 5.2989 -> 5.1587   acc: 0.90% -> 1.62%               
client [48] (test)  loss: 4.7429 -> 4.7275   acc: 7.33% -> 8.94%               
client [34] (test)  loss: 5.1352 -> 4.8825   acc: 2.71% -> 5.42%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.9917 -> 4.7513   acc: 4.03% -> 5.86%               
client [99] (test)  loss: 5.1093 -> 4.9489   acc: 2.70% -> 3.60%               
client [67] (test)  loss: 4.8619 -> 4.6061   acc: 2.65% -> 7.79%               
client [0] (test)  loss: 4.7099 -> 4.6241   acc: 4.49% -> 5.21%                
client [76] (test)  loss: 4.8857 -> 4.8183   acc: 5.80% -> 6.70%               
client [41] (test)  loss: 4.9167 -> 4.6435   acc: 4.34% -> 3.80%               
client [62] (test)  loss: 5.2945 -> 5.0107   acc: 0.73% -> 2.36%               
client [2] (test)  loss: 5.3217 -> 5.0537   acc: 0.00% -> 2.32%                
client [14] (test)  loss: 4.8693 -> 4.8848   acc: 6.28% -> 6.10%               
client [46] (test)  loss: 4.7195 -> 4.6987   acc: 5.05% -> 5.60%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.8324 -> 4.7782   acc: 5.39% -> 4.99%               
client [68] (test)  loss: 4.9053 -> 4.9236   acc: 8.09% -> 8.81%               
client [57] (test)  loss: 4.8978 -> 4.8462   acc: 6.17% -> 6.90%               
client [17] (test)  loss: 4.7392 -> 4.7251   acc: 5.14% -> 6.24%               
client [54] (test)  loss: 4.3857 -> 4.4304   acc: 8.35% -> 11.07%              
client [23] (test)  loss: 5.3034 -> 5.1714   acc: 0.20% -> 3.77%               
client [35] (test)  loss: 4.7983 -> 4.7664   acc: 4.52% -> 5.97%               
client [59] (test)  loss: 4.7995 -> 4.7576   acc: 5.40% -> 5.58%               
client [31] (test)  loss: 4.5349 -> 4.5863   acc: 6.13% -> 6.67%               
client [9] (test)  loss: 4.9634 -> 4.9368   acc: 4.39% -> 5.70%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.6630 -> 4.6500   acc: 5.26% -> 9.62%               
client [33] (test)  loss: 4.9096 -> 5.2270   acc: 5.24% -> 4.16%               
client [16] (test)  loss: 4.7843 -> 4.7518   acc: 7.65% -> 8.17%               
client [44] (test)  loss: 5.0072 -> 4.7901   acc: 5.61% -> 6.15%               
client [8] (test)  loss: 4.4657 -> 4.5746   acc: 11.80% -> 11.62%              
client [31] (test)  loss: 4.6299 -> 4.8234   acc: 6.85% -> 7.93%               
client [47] (test)  loss: 4.8011 -> 4.7699   acc: 5.16% -> 5.89%               
client [36] (test)  loss: 4.9969 -> 4.8001   acc: 4.68% -> 4.68%               
client [20] (test)  loss: 4.5407 -> 4.7078   acc: 8.02% -> 9.09%               
client [56] (test)  loss: 4.6249 -> 4.5130   acc: 9.76% -> 9.76%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4623 -> 4.4621   acc: 8.00% -> 9.27%                
client [60] (test)  loss: 4.6761 -> 4.5847   acc: 4.68% -> 5.22%               
client [28] (test)  loss: 4.7797 -> 4.6175   acc: 9.44% -> 11.25%              
client [25] (test)  loss: 4.6962 -> 4.5487   acc: 5.27% -> 7.27%               
client [58] (test)  loss: 5.0015 -> 4.9490   acc: 5.06% -> 5.79%               
client [44] (test)  loss: 4.8020 -> 4.7360   acc: 6.15% -> 6.69%               
client [39] (test)  loss: 4.5828 -> 4.5595   acc: 10.63% -> 10.81%             
client [29] (test)  loss: 4.9427 -> 4.9192   acc: 6.26% -> 6.44%               
client [3] (test)  loss: 4.6436 -> 4.5822   acc: 7.23% -> 6.15%                
client [84] (test)  loss: 4.8980 -> 4.8239   acc: 5.96% -> 7.04%               
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.8300 -> 4.5683   acc: 7.58% -> 8.12%               
client [84] (test)  loss: 5.0368 -> 5.1812   acc: 8.30% -> 7.94%               
client [10] (test)  loss: 4.7769 -> 4.6749   acc: 5.79% -> 7.96%               
client [36] (test)  loss: 4.7260 -> 4.6878   acc: 6.49% -> 7.75%               
client [65] (test)  loss: 4.8143 -> 4.8087   acc: 7.97% -> 6.45%               
client [81] (test)  loss: 5.1267 -> 5.1777   acc: 5.45% -> 5.64%               
client [79] (test)  loss: 4.6089 -> 4.5848   acc: 10.04% -> 9.85%              
client [42] (test)  loss: 4.9572 -> 5.0048   acc: 5.24% -> 6.69%               
client [11] (test)  loss: 4.4110 -> 4.3951   acc: 15.25% -> 13.47%             
client [96] (test)  loss: 4.8106 -> 4.7366   acc: 5.24% -> 5.61%               
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.0461 -> 5.2614   acc: 9.80% -> 9.44%                
client [53] (test)  loss: 4.6012 -> 4.5300   acc: 8.29% -> 9.55%               
client [52] (test)  loss: 4.9236 -> 4.8726   acc: 8.01% -> 8.19%               
client [42] (test)  loss: 5.1983 -> 5.3430   acc: 5.97% -> 5.79%               
client [69] (test)  loss: 5.4106 -> 5.7610   acc: 8.24% -> 8.06%               
client [59] (test)  loss: 4.7821 -> 4.8197   acc: 7.19% -> 8.27%               
client [7] (test)  loss: 5.2471 -> 4.9380   acc: 6.25% -> 7.50%                
client [26] (test)  loss: 4.6307 -> 4.5340   acc: 7.11% -> 9.88%               
client [49] (test)  loss: 4.8700 -> 4.8620   acc: 4.17% -> 5.25%               
client [98] (test)  loss: 4.9861 -> 5.1287   acc: 5.79% -> 6.69%               
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 5.2121 -> 5.3673   acc: 5.97% -> 6.69%               
client [47] (test)  loss: 4.8537 -> 4.7948   acc: 7.00% -> 9.21%               
client [21] (test)  loss: 4.5622 -> 4.5439   acc: 10.47% -> 11.37%             
client [77] (test)  loss: 5.1095 -> 5.2215   acc: 8.35% -> 6.78%               
client [95] (test)  loss: 4.8973 -> 5.1296   acc: 6.33% -> 5.79%               
client [91] (test)  loss: 4.7675 -> 4.8908   acc: 8.45% -> 8.11%               
client [14] (test)  loss: 5.2404 -> 5.5175   acc: 6.84% -> 6.84%               
client [99] (test)  loss: 4.9489 -> 5.0156   acc: 4.32% -> 5.04%               
client [20] (test)  loss: 5.6592 -> 5.7244   acc: 8.20% -> 8.91%               
client [39] (test)  loss: 4.6453 -> 4.6519   acc: 11.32% -> 10.98%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 5.0185 -> 4.9763   acc: 6.52% -> 6.70%               
client [62] (test)  loss: 5.5639 -> 5.8720   acc: 7.44% -> 7.08%               
client [71] (test)  loss: 4.8295 -> 5.1460   acc: 7.39% -> 6.49%               
client [97] (test)  loss: 4.7700 -> 4.8611   acc: 6.80% -> 7.17%               
client [30] (test)  loss: 5.3037 -> 5.5693   acc: 8.35% -> 7.80%               
client [88] (test)  loss: 4.6773 -> 4.6976   acc: 7.28% -> 8.17%               
client [60] (test)  loss: 4.7334 -> 4.8622   acc: 7.73% -> 8.09%               
client [82] (test)  loss: 5.1328 -> 5.2881   acc: 5.04% -> 4.70%               
client [91] (test)  loss: 5.0787 -> 5.3290   acc: 7.43% -> 6.76%               
client [57] (test)  loss: 4.7569 -> 4.8236   acc: 8.35% -> 8.35%               
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 7.2188 -> 7.2739   acc: 6.13% -> 6.85%               
client [15] (test)  loss: 4.7195 -> 4.8490   acc: 7.28% -> 7.99%               
client [71] (test)  loss: 5.1607 -> 5.3975   acc: 6.85% -> 6.13%               
client [97] (test)  loss: 5.2307 -> 5.5776   acc: 5.51% -> 5.33%               
client [53] (test)  loss: 4.7643 -> 4.9235   acc: 9.55% -> 9.55%               
client [77] (test)  loss: 5.4016 -> 5.5153   acc: 7.83% -> 6.96%               
client [76] (test)  loss: 5.1497 -> 5.4041   acc: 7.25% -> 6.16%               
client [79] (test)  loss: 4.8769 -> 4.8971   acc: 7.62% -> 7.81%               
client [28] (test)  loss: 5.8476 -> 6.1068   acc: 8.53% -> 8.71%               
client [99] (test)  loss: 5.1452 -> 5.3125   acc: 5.04% -> 5.22%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 5.9021 -> 6.1999   acc: 6.07% -> 5.15%               
client [86] (test)  loss: 5.2426 -> 5.5211   acc: 7.99% -> 6.17%               
client [34] (test)  loss: 5.9536 -> 6.1857   acc: 7.76% -> 9.21%               
client [73] (test)  loss: 4.9365 -> 5.1757   acc: 7.09% -> 6.73%               
client [5] (test)  loss: 5.6219 -> 5.8904   acc: 7.21% -> 8.11%                
client [96] (test)  loss: 6.5248 -> 6.6745   acc: 5.61% -> 5.61%               
client [22] (test)  loss: 4.7562 -> 4.9030   acc: 11.41% -> 11.05%             
client [60] (test)  loss: 5.7626 -> 5.8816   acc: 6.29% -> 5.94%               
client [66] (test)  loss: 4.9214 -> 5.0749   acc: 5.64% -> 5.45%               
client [83] (test)  loss: 5.6403 -> 5.7497   acc: 4.91% -> 4.73%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 6.1811 -> 6.3005   acc: 5.62% -> 6.16%               
client [65] (test)  loss: 5.1534 -> 5.3566   acc: 6.07% -> 6.07%               
client [95] (test)  loss: 5.8584 -> 6.0646   acc: 6.87% -> 5.97%               
client [17] (test)  loss: 5.1025 -> 5.1289   acc: 7.71% -> 7.89%               
client [8] (test)  loss: 6.0267 -> 6.1343   acc: 8.71% -> 8.35%                
client [35] (test)  loss: 6.7833 -> 7.0260   acc: 6.51% -> 7.23%               
client [98] (test)  loss: 5.8958 -> 6.0655   acc: 6.33% -> 6.51%               
client [53] (test)  loss: 5.1534 -> 5.4554   acc: 8.11% -> 7.93%               
client [43] (test)  loss: 5.7759 -> 5.8835   acc: 7.08% -> 5.99%               
client [64] (test)  loss: 5.2227 -> 5.4686   acc: 7.80% -> 7.62%               
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.6645 -> 4.7716   acc: 8.12% -> 7.76%               
client [88] (test)  loss: 5.9119 -> 6.1158   acc: 6.22% -> 6.04%               
client [38] (test)  loss: 5.9416 -> 5.9679   acc: 7.25% -> 9.42%               
client [3] (test)  loss: 6.0944 -> 6.2618   acc: 7.96% -> 7.96%                
client [5] (test)  loss: 6.2108 -> 6.4337   acc: 7.93% -> 7.93%                
client [41] (test)  loss: 5.5233 -> 5.6768   acc: 7.96% -> 8.86%               
client [7] (test)  loss: 5.5072 -> 5.7208   acc: 7.14% -> 7.14%                
client [37] (test)  loss: 4.8805 -> 5.1036   acc: 9.39% -> 9.39%               
client [45] (test)  loss: 4.6538 -> 4.6749   acc: 9.33% -> 9.86%               
client [47] (test)  loss: 4.9778 -> 5.0792   acc: 8.47% -> 8.10%               
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 6.5260 -> 6.6587   acc: 7.48% -> 7.48%               
client [11] (test)  loss: 5.6831 -> 5.8295   acc: 11.09% -> 11.68%             
client [37] (test)  loss: 5.6321 -> 5.8821   acc: 9.21% -> 9.21%               
client [41] (test)  loss: 5.7303 -> 5.8938   acc: 7.96% -> 8.50%               
client [95] (test)  loss: 6.5402 -> 6.6699   acc: 6.15% -> 5.79%               
client [53] (test)  loss: 5.5330 -> 5.7650   acc: 8.11% -> 7.75%               
client [22] (test)  loss: 5.2360 -> 5.3401   acc: 10.34% -> 12.12%             
client [25] (test)  loss: 5.1776 -> 5.4431   acc: 6.73% -> 6.73%               
client [69] (test)  loss: 7.6773 -> 7.7673   acc: 7.33% -> 6.96%               
client [46] (test)  loss: 5.2352 -> 5.5183   acc: 7.94% -> 7.94%               
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 6.2465 -> 6.5498   acc: 4.79% -> 5.52%               
client [69] (test)  loss: 7.8879 -> 7.9734   acc: 7.33% -> 7.14%               
client [82] (test)  loss: 6.2354 -> 6.4694   acc: 4.87% -> 4.52%               
client [45] (test)  loss: 5.1166 -> 5.2710   acc: 8.63% -> 9.15%               
client [7] (test)  loss: 5.7967 -> 6.0292   acc: 7.14% -> 6.25%                
client [50] (test)  loss: 4.6837 -> 4.7874   acc: 9.40% -> 9.95%               
client [35] (test)  loss: 7.2309 -> 7.4024   acc: 6.33% -> 7.05%               
client [24] (test)  loss: 7.1305 -> 7.0917   acc: 5.59% -> 5.59%               
client [15] (test)  loss: 6.0920 -> 6.2971   acc: 6.75% -> 6.57%               
client [58] (test)  loss: 7.5634 -> 7.5513   acc: 5.42% -> 5.06%               
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 7.6686 -> 7.7503   acc: 5.90% -> 6.62%               
client [76] (test)  loss: 6.7444 -> 6.8001   acc: 6.70% -> 5.98%               
client [67] (test)  loss: 5.6117 -> 5.8567   acc: 6.73% -> 6.55%               
client [37] (test)  loss: 6.1091 -> 6.2077   acc: 7.76% -> 8.66%               
client [58] (test)  loss: 7.6710 -> 7.6817   acc: 5.06% -> 5.06%               
client [64] (test)  loss: 6.3227 -> 6.4878   acc: 6.53% -> 5.81%               
client [77] (test)  loss: 6.5635 -> 6.7165   acc: 7.13% -> 6.26%               
client [55] (test)  loss: 7.2278 -> 6.9824   acc: 5.35% -> 6.95%               
client [12] (test)  loss: 6.3765 -> 6.5855   acc: 7.66% -> 7.28%               
client [89] (test)  loss: 7.7973 -> 7.8453   acc: 4.72% -> 5.44%               
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 7.4503 -> 7.4195   acc: 5.96% -> 5.23%               
client [51] (test)  loss: 6.7862 -> 6.8981   acc: 4.71% -> 4.89%               
client [8] (test)  loss: 6.7650 -> 6.8699   acc: 8.89% -> 9.26%                
client [18] (test)  loss: 6.2972 -> 6.2707   acc: 8.57% -> 8.21%               
client [94] (test)  loss: 7.4627 -> 7.7889   acc: 4.64% -> 4.47%               
client [81] (test)  loss: 7.6205 -> 7.7306   acc: 4.91% -> 4.73%               
client [3] (test)  loss: 6.5554 -> 6.7114   acc: 7.78% -> 7.41%                
client [11] (test)  loss: 6.4692 -> 6.5491   acc: 11.09% -> 11.29%             
client [95] (test)  loss: 7.1778 -> 7.2375   acc: 6.33% -> 5.97%               
client [67] (test)  loss: 5.8972 -> 6.1283   acc: 6.55% -> 5.49%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.2449 -> 5.4598   acc: 7.04% -> 7.22%               
client [79] (test)  loss: 7.1790 -> 7.0965   acc: 5.76% -> 6.13%               
client [58] (test)  loss: 7.8795 -> 7.8838   acc: 5.24% -> 5.06%               
client [88] (test)  loss: 6.7573 -> 6.8799   acc: 4.97% -> 5.15%               
client [46] (test)  loss: 6.2758 -> 6.4787   acc: 5.78% -> 6.32%               
client [11] (test)  loss: 6.5782 -> 6.6787   acc: 10.69% -> 11.09%             
client [55] (test)  loss: 7.8377 -> 7.6696   acc: 5.88% -> 6.06%               
client [13] (test)  loss: 6.8143 -> 6.9377   acc: 11.28% -> 11.09%             
client [31] (test)  loss: 7.5686 -> 7.5708   acc: 5.77% -> 6.49%               
client [75] (test)  loss: 6.3967 -> 6.4777   acc: 7.40% -> 7.58%               
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 7.4639 -> 7.5173   acc: 6.31% -> 6.31%               
client [7] (test)  loss: 7.0679 -> 7.2304   acc: 5.71% -> 6.07%                
client [57] (test)  loss: 6.8543 -> 7.0592   acc: 5.81% -> 5.99%               
client [13] (test)  loss: 6.9870 -> 7.1199   acc: 11.28% -> 11.09%             
client [43] (test)  loss: 7.0915 -> 7.0593   acc: 5.99% -> 5.81%               
client [91] (test)  loss: 6.3823 -> 6.6755   acc: 7.09% -> 6.76%               
client [10] (test)  loss: 7.1641 -> 7.2820   acc: 4.70% -> 4.88%               
client [64] (test)  loss: 7.1713 -> 7.1895   acc: 7.08% -> 7.08%               
client [82] (test)  loss: 7.1836 -> 7.3369   acc: 5.22% -> 5.22%               
client [22] (test)  loss: 6.6329 -> 6.5838   acc: 10.87% -> 12.30%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 6.8698 -> 7.0163   acc: 8.20% -> 7.84%               
client [23] (test)  loss: 5.5679 -> 5.7454   acc: 6.94% -> 7.74%               
client [88] (test)  loss: 6.8672 -> 7.0072   acc: 5.68% -> 4.97%               
client [98] (test)  loss: 7.0277 -> 7.1590   acc: 7.41% -> 6.69%               
client [79] (test)  loss: 7.3513 -> 7.3372   acc: 5.76% -> 6.13%               
client [21] (test)  loss: 5.6963 -> 5.9043   acc: 7.22% -> 7.58%               
client [92] (test)  loss: 6.8952 -> 7.0020   acc: 7.76% -> 7.76%               
client [56] (test)  loss: 7.0672 -> 7.0658   acc: 10.31% -> 10.13%             
client [5] (test)  loss: 7.4524 -> 7.5083   acc: 6.13% -> 6.67%                
client [52] (test)  loss: 7.5996 -> 7.5198   acc: 5.77% -> 6.70%               
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '5.3860 -> 0.0000', 'accuracy': '7.53% -> 0.00%'},           
    200: {'loss': '7.0854 -> 0.0000', 'accuracy': '6.75% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
Convergence (test_after):                                                      
