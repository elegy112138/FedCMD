==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3760 -> 2.7951   acc: 38.62% -> 37.98%             
client [81] (test)  loss: 1.0320 -> 0.9968   acc: 72.30% -> 73.35%             
client [21] (test)  loss: 4.5571 -> 0.3820   acc: 4.03% -> 85.29%              
client [68] (test)  loss: 1.1431 -> 1.0180   acc: 66.16% -> 71.62%             
client [93] (test)  loss: 1.5559 -> 1.3716   acc: 43.50% -> 52.57%             
client [31] (test)  loss: 0.8782 -> 1.9515   acc: 68.00% -> 21.87%             
client [20] (test)  loss: 1.4197 -> 1.5188   acc: 49.58% -> 48.92%             
client [59] (test)  loss: 3.1290 -> 1.1655   acc: 18.19% -> 66.02%             
client [48] (test)  loss: 1.3524 -> 1.4038   acc: 55.21% -> 51.94%             
client [34] (test)  loss: 1.4743 -> 1.5051   acc: 42.77% -> 40.63%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.1273 -> 1.0398   acc: 54.29% -> 58.63%             
client [99] (test)  loss: 1.7804 -> 2.2449   acc: 39.27% -> 24.26%             
client [67] (test)  loss: 1.2458 -> 2.4079   acc: 50.89% -> 36.37%             
client [0] (test)  loss: 1.4218 -> 1.1483   acc: 60.79% -> 62.15%              
client [76] (test)  loss: 1.6132 -> 1.4269   acc: 42.77% -> 46.47%             
client [41] (test)  loss: 1.8174 -> 1.4105   acc: 40.96% -> 50.41%             
client [62] (test)  loss: 5.1919 -> 1.4381   acc: 9.85% -> 47.91%              
client [2] (test)  loss: 4.0919 -> 1.6457   acc: 17.99% -> 42.91%              
client [14] (test)  loss: 1.3769 -> 1.3861   acc: 54.30% -> 51.70%             
client [46] (test)  loss: 0.8810 -> 1.0654   acc: 66.22% -> 61.10%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.7209 -> 1.6155   acc: 45.62% -> 49.00%             
client [68] (test)  loss: 1.4834 -> 1.7310   acc: 64.91% -> 58.10%             
client [57] (test)  loss: 1.5682 -> 1.5295   acc: 43.44% -> 47.08%             
client [17] (test)  loss: 1.2582 -> 1.2374   acc: 46.56% -> 50.43%             
client [54] (test)  loss: 1.3364 -> 1.3954   acc: 48.92% -> 49.26%             
client [23] (test)  loss: 3.9412 -> 1.4531   acc: 16.27% -> 45.27%             
client [35] (test)  loss: 1.3398 -> 1.2840   acc: 46.51% -> 47.64%             
client [59] (test)  loss: 1.1565 -> 1.0633   acc: 66.14% -> 67.83%             
client [31] (test)  loss: 0.7316 -> 1.2758   acc: 72.96% -> 55.98%             
client [9] (test)  loss: 2.1051 -> 1.3063   acc: 37.76% -> 56.22%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.9587 -> 1.4599   acc: 40.53% -> 48.40%             
client [33] (test)  loss: 1.7174 -> 1.6239   acc: 51.44% -> 60.27%             
client [16] (test)  loss: 0.6909 -> 1.2056   acc: 73.52% -> 65.84%             
client [44] (test)  loss: 1.6461 -> 1.4188   acc: 42.29% -> 52.18%             
client [8] (test)  loss: 0.1233 -> 0.1017   acc: 96.74% -> 96.89%              
client [31] (test)  loss: 0.6893 -> 0.8477   acc: 75.73% -> 71.94%             
client [47] (test)  loss: 0.5183 -> 0.2849   acc: 89.42% -> 91.61%             
client [36] (test)  loss: 1.6154 -> 1.5454   acc: 40.47% -> 43.25%             
client [20] (test)  loss: 1.6626 -> 2.1757   acc: 46.09% -> 32.11%             
client [56] (test)  loss: 0.6474 -> 0.6881   acc: 74.37% -> 72.48%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8055 -> 0.9637   acc: 76.56% -> 70.12%              
client [60] (test)  loss: 1.0033 -> 0.9280   acc: 68.21% -> 69.56%             
client [28] (test)  loss: 1.6940 -> 1.5871   acc: 47.94% -> 48.23%             
client [25] (test)  loss: 1.0722 -> 0.8769   acc: 64.88% -> 70.54%             
client [58] (test)  loss: 1.7705 -> 0.9672   acc: 63.74% -> 69.57%             
client [44] (test)  loss: 1.3544 -> 1.5302   acc: 52.43% -> 47.49%             
client [39] (test)  loss: 2.1607 -> 1.2680   acc: 35.75% -> 46.44%             
client [29] (test)  loss: 1.5941 -> 1.9572   acc: 50.47% -> 49.84%             
client [3] (test)  loss: 1.2690 -> 1.3364   acc: 57.09% -> 56.81%              
client [84] (test)  loss: 1.5549 -> 1.6027   acc: 50.32% -> 50.65%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6556 -> 0.2878   acc: 86.09% -> 90.12%             
client [84] (test)  loss: 2.1336 -> 2.0343   acc: 45.13% -> 50.91%             
client [10] (test)  loss: 1.5766 -> 1.1869   acc: 53.93% -> 63.89%             
client [36] (test)  loss: 1.4149 -> 1.6831   acc: 45.48% -> 40.89%             
client [65] (test)  loss: 2.2050 -> 1.3808   acc: 43.32% -> 55.62%             
client [81] (test)  loss: 1.2617 -> 1.0222   acc: 68.22% -> 72.95%             
client [79] (test)  loss: 1.3912 -> 1.2132   acc: 49.52% -> 56.28%             
client [42] (test)  loss: 1.1508 -> 1.0494   acc: 64.88% -> 66.41%             
client [11] (test)  loss: 0.5816 -> 0.5701   acc: 76.71% -> 79.23%             
client [96] (test)  loss: 0.8656 -> 0.7726   acc: 74.32% -> 75.35%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1211 -> 0.1239   acc: 96.74% -> 97.18%              
client [53] (test)  loss: 1.3962 -> 1.3675   acc: 48.39% -> 50.60%             
client [52] (test)  loss: 0.1282 -> 0.1224   acc: 96.77% -> 96.77%             
client [42] (test)  loss: 0.9972 -> 1.0037   acc: 70.44% -> 69.29%             
client [69] (test)  loss: 1.7156 -> 1.4908   acc: 50.39% -> 57.76%             
client [59] (test)  loss: 1.1792 -> 1.1623   acc: 60.36% -> 61.69%             
client [7] (test)  loss: 1.9173 -> 2.3904   acc: 39.56% -> 31.91%              
client [26] (test)  loss: 1.2689 -> 1.3007   acc: 59.02% -> 58.44%             
client [49] (test)  loss: 1.2239 -> 1.3103   acc: 63.30% -> 63.23%             
client [98] (test)  loss: 2.9278 -> 1.8027   acc: 29.89% -> 50.75%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.5201 -> 2.0114   acc: 46.01% -> 48.34%             
client [47] (test)  loss: 0.4326 -> 0.2968   acc: 89.50% -> 91.32%             
client [21] (test)  loss: 0.3770 -> 0.3006   acc: 87.34% -> 90.34%             
client [77] (test)  loss: 1.6617 -> 1.7404   acc: 51.66% -> 51.98%             
client [95] (test)  loss: 1.8089 -> 1.7112   acc: 48.19% -> 58.32%             
client [91] (test)  loss: 2.2907 -> 1.2867   acc: 55.61% -> 60.57%             
client [14] (test)  loss: 1.9759 -> 1.7608   acc: 44.24% -> 53.98%             
client [99] (test)  loss: 2.0845 -> 1.7260   acc: 43.18% -> 43.34%             
client [20] (test)  loss: 1.7986 -> 1.8308   acc: 48.09% -> 50.75%             
client [39] (test)  loss: 3.1188 -> 1.5092   acc: 32.10% -> 45.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1369 -> 0.1256   acc: 96.92% -> 96.77%             
client [62] (test)  loss: 2.1143 -> 2.1013   acc: 53.93% -> 53.93%             
client [71] (test)  loss: 1.4177 -> 1.8923   acc: 59.14% -> 53.92%             
client [97] (test)  loss: 1.6136 -> 1.8049   acc: 45.46% -> 48.98%             
client [30] (test)  loss: 1.3006 -> 1.4154   acc: 67.19% -> 64.91%             
client [88] (test)  loss: 1.7571 -> 1.8241   acc: 52.15% -> 51.38%             
client [60] (test)  loss: 0.9242 -> 0.8012   acc: 70.52% -> 75.72%             
client [82] (test)  loss: 1.6152 -> 1.7578   acc: 50.57% -> 51.79%             
client [91] (test)  loss: 1.9667 -> 1.6501   acc: 58.66% -> 53.61%             
client [57] (test)  loss: 1.5756 -> 2.0929   acc: 46.70% -> 36.94%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.3949 -> 1.4504   acc: 77.26% -> 76.97%             
client [15] (test)  loss: 1.4946 -> 1.3825   acc: 42.43% -> 52.44%             
client [71] (test)  loss: 1.7071 -> 2.0902   acc: 55.26% -> 55.82%             
client [97] (test)  loss: 2.0606 -> 2.3256   acc: 42.78% -> 48.43%             
client [53] (test)  loss: 1.8669 -> 1.9613   acc: 48.96% -> 46.69%             
client [77] (test)  loss: 1.9119 -> 1.8106   acc: 49.15% -> 51.90%             
client [76] (test)  loss: 3.1342 -> 1.9803   acc: 40.00% -> 46.67%             
client [79] (test)  loss: 1.3563 -> 1.7366   acc: 54.05% -> 55.33%             
client [28] (test)  loss: 2.2803 -> 2.3325   acc: 48.92% -> 49.41%             
client [99] (test)  loss: 2.1436 -> 2.1363   acc: 41.42% -> 40.38%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.9449 -> 2.3085   acc: 37.13% -> 49.72%             
client [86] (test)  loss: 2.2634 -> 2.3409   acc: 43.51% -> 43.91%             
client [34] (test)  loss: 2.3282 -> 2.6629   acc: 48.46% -> 48.19%             
client [73] (test)  loss: 2.1622 -> 2.0717   acc: 50.58% -> 52.18%             
client [5] (test)  loss: 2.6169 -> 2.6360   acc: 41.40% -> 44.30%              
client [96] (test)  loss: 1.5337 -> 1.3743   acc: 69.47% -> 72.74%             
client [22] (test)  loss: 2.4231 -> 1.5945   acc: 40.65% -> 50.90%             
client [60] (test)  loss: 1.5913 -> 0.9046   acc: 54.72% -> 71.68%             
client [66] (test)  loss: 1.7852 -> 1.5552   acc: 50.15% -> 58.42%             
client [83] (test)  loss: 2.7169 -> 1.4566   acc: 70.46% -> 77.05%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.6860 -> 2.7787   acc: 38.94% -> 44.62%             
client [65] (test)  loss: 1.8824 -> 1.5998   acc: 50.70% -> 55.54%             
client [95] (test)  loss: 2.8789 -> 2.2813   acc: 49.44% -> 59.07%             
client [17] (test)  loss: 2.0475 -> 1.6401   acc: 43.70% -> 53.01%             
client [8] (test)  loss: 0.1601 -> 0.1558   acc: 96.89% -> 97.32%              
client [35] (test)  loss: 3.5560 -> 3.4652   acc: 42.71% -> 42.35%             
client [98] (test)  loss: 3.1633 -> 2.6061   acc: 45.63% -> 48.57%             
client [53] (test)  loss: 2.4870 -> 2.5336   acc: 45.68% -> 45.81%             
client [43] (test)  loss: 3.6084 -> 2.2160   acc: 44.92% -> 52.49%             
client [64] (test)  loss: 1.6110 -> 1.7591   acc: 52.40% -> 50.40%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3747 -> 0.3226   acc: 88.80% -> 89.53%             
client [88] (test)  loss: 4.7934 -> 2.7618   acc: 45.61% -> 51.57%             
client [38] (test)  loss: 4.2213 -> 2.4930   acc: 31.24% -> 50.78%             
client [3] (test)  loss: 2.1006 -> 2.1618   acc: 57.55% -> 56.91%              
client [5] (test)  loss: 3.0238 -> 2.9774   acc: 42.32% -> 42.89%              
client [41] (test)  loss: 2.2247 -> 1.9194   acc: 48.48% -> 50.61%             
client [7] (test)  loss: 2.1271 -> 2.6423   acc: 39.67% -> 36.07%              
client [37] (test)  loss: 1.5231 -> 1.4176   acc: 45.39% -> 49.92%             
client [45] (test)  loss: 1.5292 -> 1.3356   acc: 45.62% -> 55.28%             
client [47] (test)  loss: 0.4358 -> 0.3537   acc: 90.88% -> 90.96%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.1528 -> 1.0108   acc: 77.12% -> 80.25%             
client [11] (test)  loss: 1.1493 -> 1.0870   acc: 74.93% -> 78.89%             
client [37] (test)  loss: 2.4666 -> 2.1846   acc: 39.70% -> 42.55%             
client [41] (test)  loss: 2.3510 -> 2.1419   acc: 47.36% -> 48.98%             
client [95] (test)  loss: 3.7813 -> 2.1967   acc: 52.07% -> 59.32%             
client [53] (test)  loss: 3.1399 -> 2.8390   acc: 41.65% -> 46.12%             
client [22] (test)  loss: 2.8435 -> 1.8678   acc: 42.64% -> 50.14%             
client [25] (test)  loss: 1.4557 -> 1.5090   acc: 65.07% -> 61.80%             
client [69] (test)  loss: 2.5820 -> 2.4023   acc: 54.38% -> 57.24%             
client [46] (test)  loss: 2.0609 -> 1.5263   acc: 50.47% -> 68.24%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5152 -> 0.5009   acc: 91.10% -> 90.52%             
client [69] (test)  loss: 2.7615 -> 2.5649   acc: 54.29% -> 56.55%             
client [82] (test)  loss: 2.4955 -> 2.8777   acc: 47.74% -> 49.90%             
client [45] (test)  loss: 1.8549 -> 1.6440   acc: 46.65% -> 52.58%             
client [7] (test)  loss: 2.3240 -> 2.6629   acc: 38.80% -> 37.60%              
client [50] (test)  loss: 1.4131 -> 1.4764   acc: 49.83% -> 56.25%             
client [35] (test)  loss: 4.2704 -> 3.9548   acc: 41.86% -> 42.00%             
client [24] (test)  loss: 3.7180 -> 3.1715   acc: 49.96% -> 48.66%             
client [15] (test)  loss: 2.1507 -> 2.0932   acc: 48.75% -> 53.64%             
client [58] (test)  loss: 3.0343 -> 2.1667   acc: 67.18% -> 67.95%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.4555 -> 3.1814   acc: 50.74% -> 53.28%             
client [76] (test)  loss: 4.9134 -> 2.9905   acc: 40.40% -> 45.28%             
client [67] (test)  loss: 3.9141 -> 3.1843   acc: 50.00% -> 47.22%             
client [37] (test)  loss: 2.2953 -> 2.5541   acc: 42.88% -> 41.54%             
client [58] (test)  loss: 2.8200 -> 2.2469   acc: 67.11% -> 67.88%             
client [64] (test)  loss: 2.0059 -> 2.1106   acc: 51.33% -> 50.27%             
client [77] (test)  loss: 6.1877 -> 2.8524   acc: 26.15% -> 45.83%             
client [55] (test)  loss: 4.0362 -> 1.8650   acc: 36.07% -> 54.18%             
client [12] (test)  loss: 2.9287 -> 2.7437   acc: 47.64% -> 53.12%             
client [89] (test)  loss: 4.6671 -> 3.9367   acc: 46.83% -> 50.86%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.8601 -> 4.2858   acc: 44.48% -> 50.13%             
client [51] (test)  loss: 1.5297 -> 1.3053   acc: 79.07% -> 76.53%             
client [8] (test)  loss: 0.1909 -> 0.1791   acc: 97.03% -> 97.32%              
client [18] (test)  loss: 3.1285 -> 2.7589   acc: 42.55% -> 47.94%             
client [94] (test)  loss: 3.0931 -> 2.8973   acc: 47.75% -> 52.66%             
client [81] (test)  loss: 2.3658 -> 2.1949   acc: 66.73% -> 69.27%             
client [3] (test)  loss: 3.0795 -> 2.7522   acc: 55.25% -> 57.09%              
client [11] (test)  loss: 1.4281 -> 1.2659   acc: 72.88% -> 78.21%             
client [95] (test)  loss: 4.1269 -> 2.9546   acc: 57.57% -> 60.26%             
client [67] (test)  loss: 3.3279 -> 3.3005   acc: 51.89% -> 47.61%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3868 -> 0.3715   acc: 88.87% -> 89.46%             
client [79] (test)  loss: 2.8651 -> 2.8869   acc: 49.13% -> 55.09%             
client [58] (test)  loss: 2.6239 -> 2.3754   acc: 66.90% -> 67.67%             
client [88] (test)  loss: 5.0952 -> 3.6890   acc: 46.38% -> 49.90%             
client [46] (test)  loss: 3.9925 -> 1.8746   acc: 44.01% -> 67.29%             
client [11] (test)  loss: 1.8709 -> 1.3007   acc: 72.47% -> 77.66%             
client [55] (test)  loss: 3.5324 -> 2.4450   acc: 42.11% -> 52.17%             
client [13] (test)  loss: 3.6416 -> 3.2392   acc: 41.08% -> 49.89%             
client [31] (test)  loss: 1.4390 -> 1.5590   acc: 74.78% -> 76.82%             
client [75] (test)  loss: 3.8396 -> 3.4567   acc: 39.97% -> 47.08%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.7212 -> 3.8292   acc: 46.33% -> 55.00%             
client [7] (test)  loss: 3.5882 -> 3.3917   acc: 37.27% -> 38.80%              
client [57] (test)  loss: 3.5537 -> 3.6860   acc: 38.37% -> 37.70%             
client [13] (test)  loss: 3.4039 -> 3.3837   acc: 42.89% -> 48.76%             
client [43] (test)  loss: 5.1580 -> 3.5012   acc: 46.22% -> 51.74%             
client [91] (test)  loss: 2.5140 -> 2.6541   acc: 54.31% -> 51.78%             
client [10] (test)  loss: 2.8584 -> 2.8905   acc: 69.26% -> 68.00%             
client [64] (test)  loss: 2.6355 -> 2.5481   acc: 49.60% -> 50.80%             
client [82] (test)  loss: 4.1624 -> 3.8147   acc: 40.19% -> 49.16%             
client [22] (test)  loss: 3.4510 -> 2.6818   acc: 43.02% -> 49.86%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.7527 -> 2.5197   acc: 49.92% -> 51.91%             
client [23] (test)  loss: 2.4825 -> 2.5853   acc: 38.39% -> 44.53%             
client [88] (test)  loss: 4.4920 -> 3.8236   acc: 47.34% -> 49.71%             
client [98] (test)  loss: 4.3527 -> 3.9179   acc: 45.56% -> 45.78%             
client [79] (test)  loss: 3.0338 -> 3.0976   acc: 53.74% -> 54.29%             
client [21] (test)  loss: 0.4928 -> 0.4088   acc: 89.24% -> 89.31%             
client [92] (test)  loss: 3.5514 -> 3.0547   acc: 51.27% -> 55.92%             
client [56] (test)  loss: 1.8522 -> 1.7276   acc: 70.31% -> 72.77%             
client [5] (test)  loss: 4.5527 -> 4.2667   acc: 41.26% -> 42.11%              
client [52] (test)  loss: 0.2040 -> 0.1914   acc: 96.67% -> 96.67%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '1.9109 -> 0.0000', 'accuracy': '55.34% -> 0.00%'},          
    200: {'loss': '3.2553 -> 0.0000', 'accuracy': '54.26% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(10.12%) at epoch: 0                               
LG-FedAvg-0.5 achieved 20.0%(27.30%) at epoch: 3                               
LG-FedAvg-0.5 achieved 30.0%(31.16%) at epoch: 4                               
LG-FedAvg-0.5 achieved 50.0%(52.14%) at epoch: 7                               
LG-FedAvg-0.5 achieved 60.0%(61.00%) at epoch: 31                              
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 50.0%(51.49%) at epoch: 0                               
LG-FedAvg-0.5 achieved 60.0%(60.57%) at epoch: 11                              
LG-FedAvg-0.5 achieved 70.0%(70.08%) at epoch: 31                              
