==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'mnist',                                                        
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'mnist',                                                    
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.6829 -> 1.4648   acc: 40.00% -> 45.58%             
client [81] (test)  loss: 1.3920 -> 0.9405   acc: 55.03% -> 71.69%             
client [21] (test)  loss: 10.3823 -> 1.1566   acc: 9.12% -> 74.36%             
client [68] (test)  loss: 0.5742 -> 0.3839   acc: 78.65% -> 92.11%             
client [93] (test)  loss: 1.3339 -> 1.0101   acc: 50.96% -> 64.42%             
client [31] (test)  loss: 1.6309 -> 1.0504   acc: 33.95% -> 67.49%             
client [20] (test)  loss: 1.0480 -> 0.7365   acc: 71.30% -> 80.86%             
client [59] (test)  loss: 8.3717 -> 1.6892   acc: 15.42% -> 44.78%             
client [48] (test)  loss: 0.8568 -> 0.6296   acc: 79.30% -> 85.67%             
client [34] (test)  loss: 0.8699 -> 0.5611   acc: 69.42% -> 85.41%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.7205 -> 1.4016   acc: 39.67% -> 60.33%             
client [99] (test)  loss: 1.1829 -> 0.8919   acc: 59.57% -> 69.05%             
client [67] (test)  loss: 1.1375 -> 0.7481   acc: 68.98% -> 75.35%             
client [0] (test)  loss: 0.6189 -> 0.3606   acc: 82.88% -> 92.34%              
client [76] (test)  loss: 1.1104 -> 0.7866   acc: 71.53% -> 79.90%             
client [41] (test)  loss: 1.2466 -> 0.7726   acc: 47.12% -> 83.21%             
client [62] (test)  loss: 18.4414 -> 0.8263   acc: 0.88% -> 75.73%             
client [2] (test)  loss: 13.9981 -> 0.6790   acc: 0.00% -> 79.61%              
client [14] (test)  loss: 0.8940 -> 0.6974   acc: 61.93% -> 75.00%             
client [46] (test)  loss: 0.9919 -> 0.6934   acc: 78.97% -> 86.27%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.6232 -> 0.4163   acc: 85.95% -> 90.63%             
client [68] (test)  loss: 0.2175 -> 0.1934   acc: 92.81% -> 94.43%             
client [57] (test)  loss: 1.9400 -> 1.6437   acc: 50.00% -> 54.76%             
client [17] (test)  loss: 1.2269 -> 0.8631   acc: 72.70% -> 85.82%             
client [54] (test)  loss: 0.2704 -> 0.2497   acc: 93.73% -> 93.98%             
client [23] (test)  loss: 15.6446 -> 1.6859   acc: 6.72% -> 44.27%             
client [35] (test)  loss: 0.9690 -> 0.7832   acc: 71.72% -> 75.52%             
client [59] (test)  loss: 0.9541 -> 0.7544   acc: 77.61% -> 78.61%             
client [31] (test)  loss: 0.4581 -> 0.3433   acc: 87.16% -> 90.48%             
client [9] (test)  loss: 1.5648 -> 1.3714   acc: 39.66% -> 61.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9940 -> 0.8830   acc: 68.09% -> 71.28%             
client [33] (test)  loss: 0.3754 -> 0.3280   acc: 89.75% -> 91.97%             
client [16] (test)  loss: 1.4004 -> 1.1519   acc: 57.25% -> 61.57%             
client [44] (test)  loss: 1.0977 -> 0.4933   acc: 55.06% -> 91.09%             
client [8] (test)  loss: 0.8887 -> 0.7816   acc: 81.99% -> 81.99%              
client [31] (test)  loss: 0.4230 -> 0.3005   acc: 86.96% -> 91.30%             
client [47] (test)  loss: 0.0863 -> 0.0588   acc: 98.70% -> 98.70%             
client [36] (test)  loss: 0.9970 -> 0.6362   acc: 67.53% -> 81.51%             
client [20] (test)  loss: 0.4161 -> 0.3849   acc: 90.12% -> 89.81%             
client [56] (test)  loss: 0.9459 -> 0.6515   acc: 69.10% -> 84.55%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.8412 -> 0.6566   acc: 73.07% -> 80.23%              
client [60] (test)  loss: 0.8523 -> 0.6441   acc: 75.68% -> 81.76%             
client [28] (test)  loss: 0.2573 -> 0.2201   acc: 94.62% -> 94.62%             
client [25] (test)  loss: 1.2947 -> 1.1258   acc: 47.93% -> 56.21%             
client [58] (test)  loss: 0.2285 -> 0.2067   acc: 93.17% -> 93.73%             
client [44] (test)  loss: 0.5258 -> 0.2769   acc: 90.69% -> 94.94%             
client [39] (test)  loss: 0.6189 -> 0.4540   acc: 84.00% -> 90.57%             
client [29] (test)  loss: 0.5068 -> 0.4349   acc: 86.24% -> 88.39%             
client [3] (test)  loss: 1.0681 -> 0.8935   acc: 62.74% -> 74.06%              
client [84] (test)  loss: 0.2212 -> 0.1935   acc: 93.28% -> 94.09%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4391 -> 0.3166   acc: 87.46% -> 90.31%             
client [84] (test)  loss: 0.1771 -> 0.1640   acc: 94.30% -> 95.11%             
client [10] (test)  loss: 0.2482 -> 0.1974   acc: 93.38% -> 94.36%             
client [36] (test)  loss: 0.3545 -> 0.2856   acc: 92.04% -> 93.55%             
client [65] (test)  loss: 0.2423 -> 0.2113   acc: 93.52% -> 94.56%             
client [81] (test)  loss: 0.3612 -> 0.3018   acc: 90.48% -> 90.74%             
client [79] (test)  loss: 0.4328 -> 0.3773   acc: 83.62% -> 86.78%             
client [42] (test)  loss: 0.2945 -> 0.2438   acc: 89.75% -> 94.25%             
client [11] (test)  loss: 0.3582 -> 0.3001   acc: 92.70% -> 92.70%             
client [96] (test)  loss: 0.4917 -> 0.4377   acc: 83.80% -> 87.71%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.6471 -> 0.6080   acc: 86.96% -> 86.96%              
client [53] (test)  loss: 0.8231 -> 0.6540   acc: 76.47% -> 80.62%             
client [52] (test)  loss: 0.5568 -> 0.4471   acc: 87.19% -> 88.18%             
client [42] (test)  loss: 0.2103 -> 0.1805   acc: 95.50% -> 96.25%             
client [69] (test)  loss: 0.5111 -> 0.4681   acc: 82.88% -> 85.87%             
client [59] (test)  loss: 0.4846 -> 0.4320   acc: 82.59% -> 87.56%             
client [7] (test)  loss: 0.1836 -> 0.1692   acc: 95.15% -> 95.66%              
client [26] (test)  loss: 0.5667 -> 0.4471   acc: 80.53% -> 84.16%             
client [49] (test)  loss: 0.6504 -> 0.4893   acc: 87.12% -> 90.80%             
client [98] (test)  loss: 0.5334 -> 0.4748   acc: 87.35% -> 87.35%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4918 -> 0.4395   acc: 88.16% -> 89.39%             
client [47] (test)  loss: 0.0544 -> 0.0438   acc: 98.70% -> 98.89%             
client [21] (test)  loss: 0.2692 -> 0.2058   acc: 92.88% -> 94.59%             
client [77] (test)  loss: 0.7334 -> 0.5982   acc: 81.40% -> 81.40%             
client [95] (test)  loss: 0.1157 -> 0.1076   acc: 96.51% -> 96.26%             
client [91] (test)  loss: 0.4419 -> 0.3945   acc: 86.50% -> 86.92%             
client [14] (test)  loss: 0.2492 -> 0.2106   acc: 94.60% -> 95.17%             
client [99] (test)  loss: 0.3595 -> 0.2971   acc: 89.56% -> 91.49%             
client [20] (test)  loss: 0.3298 -> 0.3148   acc: 92.28% -> 92.28%             
client [39] (test)  loss: 0.2876 -> 0.2381   acc: 93.71% -> 94.86%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4709 -> 0.3782   acc: 88.18% -> 91.13%             
client [62] (test)  loss: 0.3524 -> 0.3442   acc: 90.06% -> 90.35%             
client [71] (test)  loss: 0.7217 -> 0.6830   acc: 77.27% -> 76.77%             
client [97] (test)  loss: 0.3215 -> 0.2831   acc: 91.40% -> 92.45%             
client [30] (test)  loss: 0.2897 -> 0.2674   acc: 93.60% -> 94.19%             
client [88] (test)  loss: 0.6146 -> 0.5422   acc: 80.89% -> 83.56%             
client [60] (test)  loss: 0.2808 -> 0.2588   acc: 92.10% -> 92.71%             
client [82] (test)  loss: 0.1340 -> 0.1240   acc: 93.63% -> 94.18%             
client [91] (test)  loss: 0.3687 -> 0.3459   acc: 88.61% -> 89.87%             
client [57] (test)  loss: 0.8598 -> 0.6716   acc: 83.81% -> 86.19%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.2552 -> 0.2378   acc: 91.93% -> 92.34%             
client [15] (test)  loss: 0.3954 -> 0.3490   acc: 89.01% -> 90.11%             
client [71] (test)  loss: 0.6863 -> 0.6496   acc: 77.27% -> 78.79%             
client [97] (test)  loss: 0.2490 -> 0.2335   acc: 92.24% -> 92.87%             
client [53] (test)  loss: 0.4037 -> 0.3686   acc: 87.89% -> 89.27%             
client [77] (test)  loss: 0.6494 -> 0.5406   acc: 82.33% -> 81.40%             
client [76] (test)  loss: 0.2696 -> 0.2342   acc: 92.11% -> 93.54%             
client [79] (test)  loss: 0.3083 -> 0.2868   acc: 89.37% -> 91.09%             
client [28] (test)  loss: 0.1626 -> 0.1534   acc: 95.47% -> 95.75%             
client [99] (test)  loss: 0.2690 -> 0.2429   acc: 92.65% -> 93.04%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2277 -> 0.2183   acc: 93.29% -> 93.08%             
client [86] (test)  loss: 0.1808 -> 0.1698   acc: 95.96% -> 96.19%             
client [34] (test)  loss: 0.1821 -> 0.1769   acc: 96.49% -> 96.66%             
client [73] (test)  loss: 0.3372 -> 0.3237   acc: 92.35% -> 92.86%             
client [5] (test)  loss: 0.2358 -> 0.2282   acc: 92.96% -> 92.96%              
client [96] (test)  loss: 0.2274 -> 0.2146   acc: 96.09% -> 96.37%             
client [22] (test)  loss: 0.2785 -> 0.2441   acc: 93.47% -> 95.45%             
client [60] (test)  loss: 0.2186 -> 0.2084   acc: 94.22% -> 94.83%             
client [66] (test)  loss: 0.2104 -> 0.1889   acc: 93.27% -> 94.46%             
client [83] (test)  loss: 0.4452 -> 0.4012   acc: 88.03% -> 89.19%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2102 -> 0.1905   acc: 94.02% -> 94.26%             
client [65] (test)  loss: 0.1720 -> 0.1602   acc: 95.34% -> 96.63%             
client [95] (test)  loss: 0.0975 -> 0.0950   acc: 96.51% -> 96.51%             
client [17] (test)  loss: 0.3843 -> 0.3393   acc: 89.01% -> 90.43%             
client [8] (test)  loss: 0.5162 -> 0.4988   acc: 88.82% -> 89.44%              
client [35] (test)  loss: 0.3069 -> 0.2993   acc: 90.00% -> 90.00%             
client [98] (test)  loss: 0.4012 -> 0.3751   acc: 89.80% -> 89.39%             
client [53] (test)  loss: 0.3377 -> 0.3162   acc: 88.93% -> 90.66%             
client [43] (test)  loss: 0.4573 -> 0.4297   acc: 85.03% -> 85.03%             
client [64] (test)  loss: 0.5355 -> 0.4912   acc: 85.82% -> 86.52%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2027 -> 0.1570   acc: 95.44% -> 96.58%             
client [88] (test)  loss: 0.3510 -> 0.3214   acc: 93.33% -> 93.78%             
client [38] (test)  loss: 0.2017 -> 0.1939   acc: 94.00% -> 94.75%             
client [3] (test)  loss: 0.4800 -> 0.4846   acc: 91.51% -> 91.98%              
client [5] (test)  loss: 0.2118 -> 0.2060   acc: 93.72% -> 93.72%              
client [41] (test)  loss: 0.1627 -> 0.1585   acc: 95.74% -> 95.99%             
client [7] (test)  loss: 0.1540 -> 0.1439   acc: 95.92% -> 96.17%              
client [37] (test)  loss: 0.4271 -> 0.3891   acc: 87.26% -> 89.49%             
client [45] (test)  loss: 0.2519 -> 0.2181   acc: 92.58% -> 93.96%             
client [47] (test)  loss: 0.0414 -> 0.0363   acc: 98.89% -> 98.89%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4311 -> 0.4163   acc: 88.63% -> 89.41%             
client [11] (test)  loss: 0.1950 -> 0.1900   acc: 96.07% -> 96.35%             
client [37] (test)  loss: 0.3428 -> 0.3240   acc: 92.04% -> 91.72%             
client [41] (test)  loss: 0.1562 -> 0.1538   acc: 95.49% -> 96.74%             
client [95] (test)  loss: 0.0923 -> 0.0898   acc: 96.51% -> 96.76%             
client [53] (test)  loss: 0.3160 -> 0.2991   acc: 90.66% -> 91.35%             
client [22] (test)  loss: 0.2231 -> 0.1982   acc: 96.02% -> 96.31%             
client [25] (test)  loss: 0.5774 -> 0.5242   acc: 84.62% -> 88.17%             
client [69] (test)  loss: 0.3267 -> 0.3168   acc: 90.49% -> 90.76%             
client [46] (test)  loss: 0.3007 -> 0.2762   acc: 89.70% -> 90.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0329 -> 0.0320   acc: 98.89% -> 98.89%             
client [69] (test)  loss: 0.3141 -> 0.3083   acc: 90.76% -> 91.03%             
client [82] (test)  loss: 0.0963 -> 0.0928   acc: 95.57% -> 96.12%             
client [45] (test)  loss: 0.2011 -> 0.1836   acc: 94.23% -> 94.78%             
client [7] (test)  loss: 0.1448 -> 0.1392   acc: 95.92% -> 96.17%              
client [50] (test)  loss: 0.4891 -> 0.4346   acc: 92.75% -> 91.79%             
client [35] (test)  loss: 0.2877 -> 0.2844   acc: 90.69% -> 91.38%             
client [24] (test)  loss: 0.1541 -> 0.1551   acc: 95.59% -> 95.59%             
client [15] (test)  loss: 0.3047 -> 0.2899   acc: 90.93% -> 91.21%             
client [58] (test)  loss: 0.1402 -> 0.1413   acc: 95.39% -> 95.20%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2535 -> 0.2517   acc: 92.68% -> 92.99%             
client [76] (test)  loss: 0.1931 -> 0.1787   acc: 94.02% -> 94.26%             
client [67] (test)  loss: 0.1954 -> 0.1879   acc: 94.18% -> 94.18%             
client [37] (test)  loss: 0.3109 -> 0.2974   acc: 92.99% -> 93.31%             
client [58] (test)  loss: 0.1393 -> 0.1404   acc: 95.76% -> 95.39%             
client [64] (test)  loss: 0.4163 -> 0.3934   acc: 87.59% -> 88.65%             
client [77] (test)  loss: 0.4273 -> 0.3864   acc: 86.51% -> 87.44%             
client [55] (test)  loss: 0.0609 -> 0.0589   acc: 98.11% -> 98.11%             
client [12] (test)  loss: 0.2960 -> 0.2670   acc: 89.77% -> 92.08%             
client [89] (test)  loss: 0.1422 -> 0.1396   acc: 95.30% -> 95.54%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.1135 -> 0.1148   acc: 96.33% -> 96.13%             
client [51] (test)  loss: 0.1362 -> 0.1317   acc: 95.98% -> 96.23%             
client [8] (test)  loss: 0.4266 -> 0.4259   acc: 89.44% -> 89.44%              
client [18] (test)  loss: 0.1978 -> 0.1893   acc: 93.25% -> 93.25%             
client [94] (test)  loss: 0.2935 -> 0.2624   acc: 92.16% -> 90.44%             
client [81] (test)  loss: 0.2023 -> 0.2008   acc: 95.50% -> 95.24%             
client [3] (test)  loss: 0.4927 -> 0.4949   acc: 91.51% -> 91.98%              
client [11] (test)  loss: 0.1858 -> 0.1834   acc: 96.35% -> 96.35%             
client [95] (test)  loss: 0.0871 -> 0.0867   acc: 96.51% -> 96.76%             
client [67] (test)  loss: 0.1858 -> 0.1827   acc: 94.46% -> 94.18%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1408 -> 0.1227   acc: 96.87% -> 96.87%             
client [79] (test)  loss: 0.1830 -> 0.1802   acc: 95.40% -> 94.83%             
client [58] (test)  loss: 0.1386 -> 0.1386   acc: 95.57% -> 95.94%             
client [88] (test)  loss: 0.2827 -> 0.2655   acc: 93.78% -> 94.22%             
client [46] (test)  loss: 0.2584 -> 0.2362   acc: 92.27% -> 93.13%             
client [11] (test)  loss: 0.1855 -> 0.1828   acc: 96.07% -> 96.35%             
client [55] (test)  loss: 0.0544 -> 0.0541   acc: 98.53% -> 98.53%             
client [13] (test)  loss: 0.0968 -> 0.0952   acc: 96.76% -> 96.76%             
client [31] (test)  loss: 0.2422 -> 0.2343   acc: 92.55% -> 92.34%             
client [75] (test)  loss: 0.5491 -> 0.5458   acc: 89.77% -> 89.77%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2602 -> 0.2538   acc: 93.89% -> 93.89%             
client [7] (test)  loss: 0.1265 -> 0.1239   acc: 96.17% -> 96.17%              
client [57] (test)  loss: 0.2916 -> 0.2750   acc: 92.38% -> 92.86%             
client [13] (test)  loss: 0.0953 -> 0.0939   acc: 96.76% -> 96.76%             
client [43] (test)  loss: 0.3798 -> 0.3738   acc: 87.07% -> 88.44%             
client [91] (test)  loss: 0.2991 -> 0.2912   acc: 91.56% -> 91.56%             
client [10] (test)  loss: 0.0930 -> 0.0925   acc: 96.81% -> 96.81%             
client [64] (test)  loss: 0.3285 -> 0.3173   acc: 90.07% -> 90.43%             
client [82] (test)  loss: 0.0814 -> 0.0791   acc: 96.95% -> 96.68%             
client [22] (test)  loss: 0.1445 -> 0.1346   acc: 96.31% -> 96.02%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2766 -> 0.2670   acc: 92.59% -> 93.52%             
client [23] (test)  loss: 0.4553 -> 0.4104   acc: 88.54% -> 90.12%             
client [88] (test)  loss: 0.2712 -> 0.2560   acc: 94.22% -> 94.22%             
client [98] (test)  loss: 0.3103 -> 0.3051   acc: 89.39% -> 90.20%             
client [79] (test)  loss: 0.1707 -> 0.1700   acc: 95.40% -> 95.11%             
client [21] (test)  loss: 0.1208 -> 0.1114   acc: 96.87% -> 96.58%             
client [92] (test)  loss: 0.3849 -> 0.3701   acc: 90.48% -> 89.68%             
client [56] (test)  loss: 0.1532 -> 0.1480   acc: 95.20% -> 96.03%             
client [5] (test)  loss: 0.1781 -> 0.1789   acc: 94.72% -> 94.72%              
client [52] (test)  loss: 0.2171 -> 0.2095   acc: 94.58% -> 94.58%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '0.2908 -> 0.0000', 'accuracy': '92.14% -> 0.00%'},          
    200: {'loss': '0.1987 -> 0.0000', 'accuracy': '94.53% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(12.28%) at epoch: 1                               
LG-FedAvg-0.5 achieved 20.0%(23.15%) at epoch: 2                               
LG-FedAvg-0.5 achieved 40.0%(42.01%) at epoch: 4                               
LG-FedAvg-0.5 achieved 50.0%(55.27%) at epoch: 7                               
LG-FedAvg-0.5 achieved 60.0%(68.96%) at epoch: 16                              
LG-FedAvg-0.5 achieved 70.0%(71.06%) at epoch: 22                              
LG-FedAvg-0.5 achieved 80.0%(81.84%) at epoch: 28                              
LG-FedAvg-0.5 achieved 90.0%(90.38%) at epoch: 59                              
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 40.0%(42.42%) at epoch: 0                               
LG-FedAvg-0.5 achieved 50.0%(55.43%) at epoch: 1                               
LG-FedAvg-0.5 achieved 60.0%(64.67%) at epoch: 4                               
LG-FedAvg-0.5 achieved 70.0%(72.68%) at epoch: 8                               
LG-FedAvg-0.5 achieved 80.0%(81.24%) at epoch: 17                              
LG-FedAvg-0.5 achieved 90.0%(90.39%) at epoch: 38                              
