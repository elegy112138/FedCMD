==================== ALGORITHM: LG-FedAvg-0.5 ====================             
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'emnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'num_global_layers': 1,                                                    
    'dataset_args': {                                                          
        'dataset': 'emnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'emnist_split': 'byclass',                                             
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.1724 -> 0.7827   acc: 67.51% -> 76.21%             
client [81] (test)  loss: 0.7097 -> 0.5306   acc: 80.11% -> 83.88%             
client [21] (test)  loss: 18.5573 -> 0.4797   acc: 2.20% -> 88.97%             
client [68] (test)  loss: 0.3290 -> 0.1706   acc: 90.21% -> 95.73%             
client [93] (test)  loss: 0.9626 -> 0.5916   acc: 77.48% -> 86.25%             
client [31] (test)  loss: 1.6929 -> 0.8891   acc: 56.88% -> 74.23%             
client [20] (test)  loss: 1.0691 -> 0.8349   acc: 73.47% -> 77.18%             
client [59] (test)  loss: 14.5916 -> 1.1151   acc: 3.70% -> 66.51%             
client [48] (test)  loss: 0.6476 -> 0.5614   acc: 79.80% -> 81.82%             
client [34] (test)  loss: 1.1755 -> 0.7866   acc: 72.30% -> 80.25%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.4670 -> 0.3381   acc: 88.00% -> 91.78%             
client [99] (test)  loss: 1.1798 -> 0.7862   acc: 71.50% -> 80.31%             
client [67] (test)  loss: 1.3097 -> 0.7447   acc: 67.14% -> 79.42%             
client [0] (test)  loss: 0.5122 -> 0.3651   acc: 87.10% -> 90.36%              
client [76] (test)  loss: 0.9652 -> 0.6986   acc: 74.05% -> 79.89%             
client [41] (test)  loss: 2.2783 -> 1.3204   acc: 44.60% -> 66.06%             
client [62] (test)  loss: 16.7594 -> 1.7387   acc: 1.55% -> 59.65%             
client [2] (test)  loss: 18.4942 -> 0.7988   acc: 0.17% -> 77.29%              
client [14] (test)  loss: 0.6142 -> 0.5255   acc: 84.92% -> 87.06%             
client [46] (test)  loss: 0.7290 -> 0.6053   acc: 79.50% -> 82.95%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.4422 -> 0.3757   acc: 88.22% -> 90.20%             
client [68] (test)  loss: 0.1241 -> 0.1031   acc: 96.49% -> 97.05%             
client [57] (test)  loss: 0.6231 -> 0.5058   acc: 84.33% -> 86.37%             
client [17] (test)  loss: 0.3386 -> 0.2515   acc: 90.65% -> 93.00%             
client [54] (test)  loss: 0.6246 -> 0.6640   acc: 82.93% -> 82.20%             
client [23] (test)  loss: 21.9911 -> 1.1899   acc: 0.29% -> 67.81%             
client [35] (test)  loss: 1.2183 -> 0.7047   acc: 66.61% -> 80.25%             
client [59] (test)  loss: 0.6836 -> 0.6167   acc: 76.41% -> 78.11%             
client [31] (test)  loss: 0.5990 -> 0.5561   acc: 80.41% -> 82.01%             
client [9] (test)  loss: 1.0890 -> 0.9642   acc: 66.95% -> 69.43%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7456 -> 0.7199   acc: 76.75% -> 76.58%             
client [33] (test)  loss: 0.7520 -> 0.7504   acc: 76.69% -> 77.22%             
client [16] (test)  loss: 0.5726 -> 0.4342   acc: 84.43% -> 87.61%             
client [44] (test)  loss: 1.8752 -> 1.1915   acc: 53.45% -> 66.68%             
client [8] (test)  loss: 0.6918 -> 0.6986   acc: 80.39% -> 79.21%              
client [31] (test)  loss: 0.6224 -> 0.5572   acc: 80.78% -> 82.20%             
client [47] (test)  loss: 0.5633 -> 0.4522   acc: 82.84% -> 85.56%             
client [36] (test)  loss: 1.3338 -> 0.8369   acc: 67.05% -> 74.81%             
client [20] (test)  loss: 0.7414 -> 0.6775   acc: 79.41% -> 80.66%             
client [56] (test)  loss: 0.9283 -> 0.7359   acc: 75.16% -> 78.90%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4878 -> 0.4010   acc: 86.27% -> 88.62%              
client [60] (test)  loss: 0.6559 -> 0.5262   acc: 82.81% -> 86.35%             
client [28] (test)  loss: 0.7223 -> 0.6770   acc: 79.59% -> 80.35%             
client [25] (test)  loss: 0.0214 -> 0.0179   acc: 99.49% -> 99.52%             
client [58] (test)  loss: 0.2527 -> 0.2265   acc: 93.17% -> 93.68%             
client [44] (test)  loss: 1.2732 -> 0.9658   acc: 64.10% -> 70.04%             
client [39] (test)  loss: 0.5892 -> 0.5119   acc: 83.63% -> 85.24%             
client [29] (test)  loss: 0.9996 -> 0.9229   acc: 70.20% -> 71.66%             
client [3] (test)  loss: 0.6513 -> 0.4664   acc: 83.13% -> 87.55%              
client [84] (test)  loss: 0.3668 -> 0.3573   acc: 89.74% -> 90.20%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.2706 -> 0.2250   acc: 91.78% -> 93.32%             
client [84] (test)  loss: 0.3735 -> 0.3690   acc: 89.93% -> 90.30%             
client [10] (test)  loss: 0.7079 -> 0.6510   acc: 79.24% -> 81.00%             
client [36] (test)  loss: 0.6039 -> 0.5679   acc: 81.71% -> 82.69%             
client [65] (test)  loss: 0.6929 -> 0.6869   acc: 78.33% -> 78.49%             
client [81] (test)  loss: 0.5002 -> 0.4346   acc: 82.09% -> 85.45%             
client [79] (test)  loss: 0.6402 -> 0.5975   acc: 83.64% -> 84.27%             
client [42] (test)  loss: 0.3674 -> 0.3358   acc: 89.87% -> 90.84%             
client [11] (test)  loss: 0.6999 -> 0.5612   acc: 83.36% -> 86.75%             
client [96] (test)  loss: 0.5431 -> 0.5227   acc: 83.58% -> 84.06%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.7249 -> 0.7140   acc: 80.39% -> 79.27%              
client [53] (test)  loss: 0.7438 -> 0.6670   acc: 77.93% -> 79.93%             
client [52] (test)  loss: 0.7245 -> 0.6446   acc: 78.40% -> 81.32%             
client [42] (test)  loss: 0.3762 -> 0.3410   acc: 90.14% -> 90.86%             
client [69] (test)  loss: 0.2838 -> 0.2785   acc: 92.95% -> 93.35%             
client [59] (test)  loss: 0.5767 -> 0.5738   acc: 79.24% -> 79.81%             
client [7] (test)  loss: 0.6896 -> 0.5098   acc: 80.89% -> 84.28%              
client [26] (test)  loss: 0.3029 -> 0.2775   acc: 89.79% -> 90.40%             
client [49] (test)  loss: 0.2593 -> 0.2355   acc: 92.47% -> 93.29%             
client [98] (test)  loss: 0.2384 -> 0.2094   acc: 93.50% -> 94.21%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.2607 -> 0.2115   acc: 93.26% -> 94.21%             
client [47] (test)  loss: 0.5158 -> 0.4126   acc: 84.22% -> 86.14%             
client [21] (test)  loss: 0.2145 -> 0.1948   acc: 93.81% -> 94.25%             
client [77] (test)  loss: 0.8383 -> 0.6649   acc: 75.80% -> 79.01%             
client [95] (test)  loss: 0.1006 -> 0.0968   acc: 97.19% -> 97.17%             
client [91] (test)  loss: 0.7738 -> 0.6226   acc: 80.05% -> 82.28%             
client [14] (test)  loss: 0.4899 -> 0.4697   acc: 88.22% -> 88.82%             
client [99] (test)  loss: 0.5987 -> 0.5193   acc: 83.68% -> 86.30%             
client [20] (test)  loss: 0.7657 -> 0.7298   acc: 80.74% -> 81.42%             
client [39] (test)  loss: 0.5483 -> 0.4715   acc: 84.64% -> 86.65%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6543 -> 0.6460   acc: 80.85% -> 81.22%             
client [62] (test)  loss: 0.7462 -> 0.7724   acc: 80.05% -> 80.22%             
client [71] (test)  loss: 0.7042 -> 0.6683   acc: 78.41% -> 78.95%             
client [97] (test)  loss: 0.2859 -> 0.2316   acc: 92.21% -> 93.71%             
client [30] (test)  loss: 0.4178 -> 0.4157   acc: 89.59% -> 89.64%             
client [88] (test)  loss: 0.4605 -> 0.4253   acc: 84.57% -> 85.29%             
client [60] (test)  loss: 0.4434 -> 0.4634   acc: 88.34% -> 88.39%             
client [82] (test)  loss: 0.6405 -> 0.5737   acc: 81.84% -> 83.51%             
client [91] (test)  loss: 0.7234 -> 0.6514   acc: 81.74% -> 82.35%             
client [57] (test)  loss: 0.3580 -> 0.3384   acc: 89.87% -> 90.19%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.8809 -> 0.7533   acc: 79.33% -> 82.13%             
client [15] (test)  loss: 1.1456 -> 0.7175   acc: 70.58% -> 79.79%             
client [71] (test)  loss: 0.7157 -> 0.6765   acc: 78.10% -> 78.80%             
client [97] (test)  loss: 0.2533 -> 0.2452   acc: 93.26% -> 93.33%             
client [53] (test)  loss: 0.6828 -> 0.6892   acc: 80.60% -> 80.75%             
client [77] (test)  loss: 0.8289 -> 0.6777   acc: 76.18% -> 79.08%             
client [76] (test)  loss: 0.6176 -> 0.6048   acc: 81.97% -> 83.22%             
client [79] (test)  loss: 0.6028 -> 0.5949   acc: 84.12% -> 83.85%             
client [28] (test)  loss: 0.8710 -> 0.8275   acc: 79.03% -> 80.37%             
client [99] (test)  loss: 0.5776 -> 0.5217   acc: 84.61% -> 86.38%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.2875 -> 0.2624   acc: 92.71% -> 93.04%             
client [86] (test)  loss: 0.4393 -> 0.4536   acc: 88.47% -> 88.59%             
client [34] (test)  loss: 0.7411 -> 0.6873   acc: 84.01% -> 84.82%             
client [73] (test)  loss: 0.8392 -> 0.8314   acc: 75.74% -> 76.45%             
client [5] (test)  loss: 0.7574 -> 0.6890   acc: 79.74% -> 81.96%              
client [96] (test)  loss: 0.6628 -> 0.6625   acc: 83.29% -> 83.72%             
client [22] (test)  loss: 0.8644 -> 0.8371   acc: 75.29% -> 76.20%             
client [60] (test)  loss: 0.5026 -> 0.5229   acc: 88.09% -> 88.57%             
client [66] (test)  loss: 0.5045 -> 0.5025   acc: 86.11% -> 86.59%             
client [83] (test)  loss: 0.2572 -> 0.2545   acc: 93.21% -> 93.33%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7935 -> 0.7160   acc: 80.30% -> 82.52%             
client [65] (test)  loss: 0.7331 -> 0.7538   acc: 78.14% -> 77.54%             
client [95] (test)  loss: 0.1007 -> 0.1000   acc: 97.17% -> 97.19%             
client [17] (test)  loss: 0.2285 -> 0.2207   acc: 93.50% -> 93.67%             
client [8] (test)  loss: 0.7868 -> 0.7832   acc: 79.30% -> 79.83%              
client [35] (test)  loss: 1.5393 -> 0.9674   acc: 69.94% -> 79.28%             
client [98] (test)  loss: 0.2342 -> 0.2206   acc: 93.75% -> 94.16%             
client [53] (test)  loss: 0.7131 -> 0.7513   acc: 80.00% -> 80.12%             
client [43] (test)  loss: 0.6288 -> 0.4730   acc: 86.63% -> 89.65%             
client [64] (test)  loss: 0.7058 -> 0.7528   acc: 79.06% -> 76.51%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.1992 -> 0.1829   acc: 94.13% -> 94.57%             
client [88] (test)  loss: 0.7395 -> 0.5101   acc: 81.19% -> 84.35%             
client [38] (test)  loss: 0.1740 -> 0.1762   acc: 95.73% -> 95.95%             
client [3] (test)  loss: 0.6059 -> 0.5468   acc: 87.01% -> 88.97%              
client [5] (test)  loss: 0.8262 -> 0.7420   acc: 79.01% -> 81.42%              
client [41] (test)  loss: 0.9140 -> 0.8961   acc: 74.73% -> 75.95%             
client [7] (test)  loss: 0.7147 -> 0.5442   acc: 81.14% -> 84.62%              
client [37] (test)  loss: 0.6093 -> 0.5912   acc: 82.79% -> 83.69%             
client [45] (test)  loss: 0.8039 -> 0.7841   acc: 77.13% -> 77.49%             
client [47] (test)  loss: 0.4331 -> 0.4055   acc: 85.90% -> 86.81%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5307 -> 0.4485   acc: 86.34% -> 89.01%             
client [11] (test)  loss: 0.8750 -> 0.6558   acc: 75.12% -> 85.52%             
client [37] (test)  loss: 0.6580 -> 0.6492   acc: 83.22% -> 83.88%             
client [41] (test)  loss: 0.9624 -> 0.9253   acc: 74.88% -> 75.64%             
client [95] (test)  loss: 0.1044 -> 0.1039   acc: 97.29% -> 97.32%             
client [53] (test)  loss: 0.7630 -> 0.7911   acc: 79.76% -> 79.76%             
client [22] (test)  loss: 0.9959 -> 0.8708   acc: 73.43% -> 76.20%             
client [25] (test)  loss: 0.0174 -> 0.0175   acc: 99.60% -> 99.52%             
client [69] (test)  loss: 0.3721 -> 0.3540   acc: 91.91% -> 92.93%             
client [46] (test)  loss: 0.6332 -> 0.6095   acc: 83.57% -> 84.33%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4608 -> 0.4749   acc: 86.79% -> 86.77%             
client [69] (test)  loss: 0.4073 -> 0.3653   acc: 91.36% -> 93.08%             
client [82] (test)  loss: 0.6541 -> 0.6620   acc: 82.76% -> 83.22%             
client [45] (test)  loss: 0.7929 -> 0.8227   acc: 78.12% -> 77.95%             
client [7] (test)  loss: 0.7704 -> 0.5650   acc: 80.63% -> 84.57%              
client [50] (test)  loss: 0.7495 -> 0.5462   acc: 78.97% -> 83.69%             
client [35] (test)  loss: 1.5709 -> 1.1177   acc: 70.77% -> 78.43%             
client [24] (test)  loss: 0.5011 -> 0.4443   acc: 90.61% -> 91.58%             
client [15] (test)  loss: 0.9000 -> 0.8042   acc: 77.21% -> 80.02%             
client [58] (test)  loss: 0.2812 -> 0.2795   acc: 93.90% -> 94.10%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6877 -> 0.6919   acc: 81.37% -> 82.41%             
client [76] (test)  loss: 0.9890 -> 0.8012   acc: 78.76% -> 82.14%             
client [67] (test)  loss: 0.5709 -> 0.5374   acc: 84.36% -> 85.18%             
client [37] (test)  loss: 0.7296 -> 0.6906   acc: 82.38% -> 83.69%             
client [58] (test)  loss: 0.2950 -> 0.2892   acc: 93.88% -> 94.20%             
client [64] (test)  loss: 0.8613 -> 0.9064   acc: 76.80% -> 75.01%             
client [77] (test)  loss: 0.9321 -> 0.8273   acc: 75.26% -> 77.78%             
client [55] (test)  loss: 0.7806 -> 0.7897   acc: 79.54% -> 79.94%             
client [12] (test)  loss: 0.9437 -> 0.9071   acc: 78.38% -> 79.25%             
client [89] (test)  loss: 1.1578 -> 1.1537   acc: 78.15% -> 77.81%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6086 -> 0.6043   acc: 89.10% -> 89.66%             
client [51] (test)  loss: 0.4660 -> 0.4783   acc: 89.61% -> 89.64%             
client [8] (test)  loss: 0.9865 -> 0.9710   acc: 77.97% -> 79.52%              
client [18] (test)  loss: 0.8203 -> 0.8066   acc: 77.54% -> 78.51%             
client [94] (test)  loss: 0.8615 -> 0.8444   acc: 80.74% -> 81.84%             
client [81] (test)  loss: 0.7155 -> 0.6980   acc: 83.27% -> 84.89%             
client [3] (test)  loss: 0.6243 -> 0.6043   acc: 87.50% -> 88.87%              
client [11] (test)  loss: 1.1681 -> 0.7347   acc: 72.88% -> 85.89%             
client [95] (test)  loss: 0.1093 -> 0.1095   acc: 97.56% -> 97.24%             
client [67] (test)  loss: 0.5771 -> 0.5527   acc: 84.60% -> 85.23%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.1825 -> 0.1790   acc: 94.74% -> 94.74%             
client [79] (test)  loss: 0.7630 -> 0.7639   acc: 82.72% -> 83.28%             
client [58] (test)  loss: 0.3148 -> 0.3071   acc: 93.86% -> 94.22%             
client [88] (test)  loss: 1.0344 -> 0.6191   acc: 78.83% -> 84.04%             
client [46] (test)  loss: 0.7330 -> 0.6865   acc: 83.14% -> 83.88%             
client [11] (test)  loss: 1.1885 -> 0.7518   acc: 73.91% -> 85.82%             
client [55] (test)  loss: 1.0603 -> 1.0061   acc: 77.21% -> 79.20%             
client [13] (test)  loss: 1.3318 -> 1.1059   acc: 71.65% -> 75.20%             
client [31] (test)  loss: 0.9409 -> 0.8543   acc: 79.80% -> 81.93%             
client [75] (test)  loss: 1.1173 -> 1.0576   acc: 77.72% -> 78.57%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4594 -> 0.4437   acc: 91.25% -> 91.71%             
client [7] (test)  loss: 0.8050 -> 0.6876   acc: 81.81% -> 84.21%              
client [57] (test)  loss: 0.3682 -> 0.3767   acc: 90.63% -> 91.32%             
client [13] (test)  loss: 1.2942 -> 1.1850   acc: 72.86% -> 75.01%             
client [43] (test)  loss: 0.7841 -> 0.5679   acc: 85.76% -> 89.27%             
client [91] (test)  loss: 0.9291 -> 0.7898   acc: 79.30% -> 82.35%             
client [10] (test)  loss: 1.0123 -> 0.9403   acc: 78.64% -> 81.59%             
client [64] (test)  loss: 1.0436 -> 1.1190   acc: 77.17% -> 75.87%             
client [82] (test)  loss: 0.8973 -> 0.9205   acc: 81.36% -> 82.44%             
client [22] (test)  loss: 1.2005 -> 1.0946   acc: 73.86% -> 75.09%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9283 -> 0.9326   acc: 81.64% -> 81.77%             
client [23] (test)  loss: 0.5684 -> 0.5437   acc: 83.25% -> 83.83%             
client [88] (test)  loss: 1.1710 -> 0.6510   acc: 77.87% -> 83.53%             
client [98] (test)  loss: 0.2944 -> 0.2535   acc: 93.29% -> 93.89%             
client [79] (test)  loss: 0.8102 -> 0.7982   acc: 82.86% -> 83.49%             
client [21] (test)  loss: 0.1833 -> 0.1816   acc: 94.69% -> 94.74%             
client [92] (test)  loss: 0.7397 -> 0.7543   acc: 85.01% -> 85.26%             
client [56] (test)  loss: 1.1526 -> 1.0447   acc: 79.39% -> 80.30%             
client [5] (test)  loss: 1.0841 -> 0.9896   acc: 78.12% -> 80.98%              
client [52] (test)  loss: 0.9964 -> 1.0056   acc: 80.00% -> 79.70%             
==================== LG-FedAvg-0.5 TEST RESULTS: ====================          
{                                                                              
    100: {'loss': '0.5921 -> 0.0000', 'accuracy': '84.20% -> 0.00%'},          
    200: {'loss': '0.8100 -> 0.0000', 'accuracy': '83.76% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
LG-FedAvg-0.5 achieved 10.0%(12.29%) at epoch: 1                               
LG-FedAvg-0.5 achieved 20.0%(22.22%) at epoch: 2                               
LG-FedAvg-0.5 achieved 40.0%(44.99%) at epoch: 4                               
LG-FedAvg-0.5 achieved 50.0%(58.64%) at epoch: 7                               
LG-FedAvg-0.5 achieved 60.0%(60.01%) at epoch: 13                              
LG-FedAvg-0.5 achieved 70.0%(73.95%) at epoch: 16                              
LG-FedAvg-0.5 achieved 80.0%(80.95%) at epoch: 22                              
LG-FedAvg-0.5 achieved 90.0%(90.50%) at epoch: 146                             
Convergence (test_after):                                                      
LG-FedAvg-0.5 achieved 60.0%(67.30%) at epoch: 0                               
LG-FedAvg-0.5 achieved 70.0%(74.06%) at epoch: 2                               
LG-FedAvg-0.5 achieved 80.0%(80.95%) at epoch: 9                               
LG-FedAvg-0.5 achieved 90.0%(90.94%) at epoch: 146                             
