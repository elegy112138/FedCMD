==================== ALGORITHM: FedDyn_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'alpha': 0.01,                                                             
    'max_grad_norm': 10,                                                       
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0450 -> 0.6371   acc: 22.71% -> 81.16%             
client [81] (test)  loss: 1.5500 -> 0.3391   acc: 61.89% -> 89.21%             
client [21] (test)  loss: 2.4119 -> 1.2740   acc: 12.54% -> 54.24%             
client [68] (test)  loss: 1.7792 -> 0.6367   acc: 35.60% -> 79.61%             
client [93] (test)  loss: 2.7983 -> 0.5849   acc: 6.72% -> 82.46%              
client [31] (test)  loss: 2.3610 -> 0.7000   acc: 22.37% -> 80.68%             
client [20] (test)  loss: 1.9603 -> 0.8682   acc: 26.45% -> 74.38%             
client [59] (test)  loss: 2.5964 -> 0.4927   acc: 2.97% -> 83.50%              
client [48] (test)  loss: 1.9851 -> 0.7488   acc: 21.93% -> 78.88%             
client [34] (test)  loss: 1.5282 -> 0.7048   acc: 55.41% -> 82.95%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.7247 -> 0.5968   acc: 38.18% -> 79.49%             
client [99] (test)  loss: 1.4200 -> 0.4846   acc: 62.10% -> 87.10%             
client [67] (test)  loss: 1.5338 -> 0.5589   acc: 47.15% -> 81.65%             
client [0] (test)  loss: 0.8213 -> 0.4232   acc: 72.25% -> 87.56%              
client [76] (test)  loss: 1.0074 -> 0.5901   acc: 55.52% -> 80.69%             
client [41] (test)  loss: 1.8055 -> 0.9086   acc: 39.39% -> 70.05%             
client [62] (test)  loss: 3.0054 -> 0.2291   acc: 9.62% -> 92.58%              
client [2] (test)  loss: 2.2055 -> 1.0073   acc: 13.78% -> 62.24%              
client [14] (test)  loss: 0.8810 -> 0.5436   acc: 75.97% -> 82.95%             
client [46] (test)  loss: 0.8240 -> 0.6338   acc: 74.25% -> 80.24%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7759 -> 0.4925   acc: 68.75% -> 82.59%             
client [68] (test)  loss: 0.6076 -> 0.2616   acc: 74.11% -> 91.26%             
client [57] (test)  loss: 0.3514 -> 0.2556   acc: 89.52% -> 90.59%             
client [17] (test)  loss: 1.1649 -> 0.3297   acc: 64.68% -> 89.22%             
client [54] (test)  loss: 0.4153 -> 0.2843   acc: 89.52% -> 90.79%             
client [23] (test)  loss: 2.9173 -> 0.4949   acc: 5.56% -> 82.32%              
client [35] (test)  loss: 1.0771 -> 0.5895   acc: 58.94% -> 78.21%             
client [59] (test)  loss: 1.1165 -> 0.3209   acc: 66.01% -> 89.11%             
client [31] (test)  loss: 0.7139 -> 0.3915   acc: 81.02% -> 85.76%             
client [9] (test)  loss: 1.2724 -> 0.5045   acc: 53.61% -> 83.06%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.0076 -> 0.4209   acc: 67.44% -> 85.27%             
client [33] (test)  loss: 0.6916 -> 0.2999   acc: 75.13% -> 91.01%             
client [16] (test)  loss: 0.8083 -> 0.5664   acc: 72.27% -> 80.47%             
client [44] (test)  loss: 2.7380 -> 0.0664   acc: 26.85% -> 97.84%             
client [8] (test)  loss: 0.6344 -> 0.2927   acc: 82.55% -> 90.89%              
client [31] (test)  loss: 0.6565 -> 0.3299   acc: 82.71% -> 89.15%             
client [47] (test)  loss: 0.6413 -> 0.2633   acc: 78.48% -> 92.05%             
client [36] (test)  loss: 0.7179 -> 0.2604   acc: 78.50% -> 92.21%             
client [20] (test)  loss: 1.9289 -> 0.4753   acc: 45.45% -> 86.78%             
client [56] (test)  loss: 0.9702 -> 0.2834   acc: 65.78% -> 91.51%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6923 -> 0.3865   acc: 75.41% -> 87.70%              
client [60] (test)  loss: 0.8587 -> 0.2021   acc: 67.08% -> 94.17%             
client [28] (test)  loss: 0.4251 -> 0.2384   acc: 84.97% -> 91.50%             
client [25] (test)  loss: 2.5637 -> 0.3205   acc: 35.51% -> 89.72%             
client [58] (test)  loss: 0.5006 -> 0.2570   acc: 82.72% -> 94.14%             
client [44] (test)  loss: 0.4840 -> 0.0481   acc: 85.80% -> 99.07%             
client [39] (test)  loss: 0.6687 -> 0.3688   acc: 77.97% -> 86.44%             
client [29] (test)  loss: 1.7718 -> 0.3395   acc: 53.47% -> 88.12%             
client [3] (test)  loss: 0.5754 -> 0.3174   acc: 72.49% -> 90.94%              
client [84] (test)  loss: 0.8141 -> 0.6469   acc: 69.06% -> 75.24%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8317 -> 0.6798   acc: 73.90% -> 80.00%             
client [84] (test)  loss: 0.9202 -> 0.6195   acc: 69.06% -> 76.87%             
client [10] (test)  loss: 0.4724 -> 0.0705   acc: 84.55% -> 97.79%             
client [36] (test)  loss: 0.3891 -> 0.2068   acc: 87.54% -> 94.08%             
client [65] (test)  loss: 0.5164 -> 0.3686   acc: 82.93% -> 88.62%             
client [81] (test)  loss: 1.7543 -> 0.1164   acc: 44.93% -> 96.92%             
client [79] (test)  loss: 0.4443 -> 0.1737   acc: 84.62% -> 95.38%             
client [42] (test)  loss: 0.9298 -> 0.2525   acc: 69.27% -> 90.37%             
client [11] (test)  loss: 0.9790 -> 0.3768   acc: 67.32% -> 88.96%             
client [96] (test)  loss: 0.8542 -> 0.1969   acc: 60.87% -> 94.20%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5966 -> 0.2282   acc: 83.07% -> 92.45%              
client [53] (test)  loss: 1.6446 -> 0.4288   acc: 49.42% -> 83.72%             
client [52] (test)  loss: 0.5645 -> 0.3342   acc: 82.95% -> 87.21%             
client [42] (test)  loss: 0.7708 -> 0.2459   acc: 72.25% -> 91.28%             
client [69] (test)  loss: 1.0233 -> 0.3402   acc: 63.82% -> 88.60%             
client [59] (test)  loss: 0.9817 -> 0.2459   acc: 71.62% -> 90.43%             
client [7] (test)  loss: 0.8917 -> 0.1515   acc: 69.51% -> 95.41%              
client [26] (test)  loss: 0.5333 -> 0.0468   acc: 83.08% -> 98.49%             
client [49] (test)  loss: 0.5828 -> 0.4393   acc: 75.32% -> 84.26%             
client [98] (test)  loss: 0.7515 -> 0.4266   acc: 70.76% -> 86.26%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8805 -> 0.4135   acc: 66.96% -> 86.26%             
client [47] (test)  loss: 0.5140 -> 0.2201   acc: 86.09% -> 92.72%             
client [21] (test)  loss: 0.9171 -> 0.6473   acc: 72.54% -> 81.36%             
client [77] (test)  loss: 0.5872 -> 0.2180   acc: 82.13% -> 93.24%             
client [95] (test)  loss: 0.4619 -> 0.2559   acc: 84.56% -> 89.34%             
client [91] (test)  loss: 0.5286 -> 0.2651   acc: 81.94% -> 90.75%             
client [14] (test)  loss: 0.7060 -> 0.2414   acc: 83.72% -> 93.02%             
client [99] (test)  loss: 0.6026 -> 0.2641   acc: 83.06% -> 91.13%             
client [20] (test)  loss: 1.4318 -> 0.3006   acc: 59.50% -> 90.91%             
client [39] (test)  loss: 0.8870 -> 0.3233   acc: 69.92% -> 90.25%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7895 -> 0.3262   acc: 74.43% -> 86.56%             
client [62] (test)  loss: 0.5426 -> 0.0436   acc: 86.26% -> 98.35%             
client [71] (test)  loss: 0.4220 -> 0.1921   acc: 89.18% -> 94.85%             
client [97] (test)  loss: 0.7237 -> 0.2124   acc: 76.89% -> 93.63%             
client [30] (test)  loss: 0.3163 -> 0.1522   acc: 89.53% -> 94.59%             
client [88] (test)  loss: 0.4273 -> 0.2671   acc: 86.64% -> 92.17%             
client [60] (test)  loss: 0.3692 -> 0.1302   acc: 85.83% -> 95.42%             
client [82] (test)  loss: 0.8985 -> 0.6012   acc: 72.52% -> 80.79%             
client [91] (test)  loss: 0.8004 -> 0.2579   acc: 74.45% -> 91.19%             
client [57] (test)  loss: 0.2005 -> 0.1302   acc: 93.55% -> 95.70%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4910 -> 0.2648   acc: 86.10% -> 92.54%             
client [15] (test)  loss: 0.6529 -> 0.1223   acc: 79.42% -> 95.80%             
client [71] (test)  loss: 0.3534 -> 0.2017   acc: 93.30% -> 94.33%             
client [97] (test)  loss: 0.5826 -> 0.2039   acc: 83.02% -> 94.10%             
client [53] (test)  loss: 1.4384 -> 0.4081   acc: 61.34% -> 83.72%             
client [77] (test)  loss: 0.3956 -> 0.1920   acc: 87.92% -> 93.24%             
client [76] (test)  loss: 0.4212 -> 0.2679   acc: 85.17% -> 91.38%             
client [79] (test)  loss: 0.3987 -> 0.1423   acc: 90.00% -> 96.15%             
client [28] (test)  loss: 0.2645 -> 0.1806   acc: 93.46% -> 94.77%             
client [99] (test)  loss: 0.5797 -> 0.2755   acc: 85.48% -> 91.13%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5072 -> 0.2011   acc: 83.25% -> 94.10%             
client [86] (test)  loss: 0.7915 -> 0.2409   acc: 72.68% -> 92.78%             
client [34] (test)  loss: 0.7337 -> 0.2481   acc: 78.03% -> 92.79%             
client [73] (test)  loss: 0.2479 -> 0.0427   acc: 92.57% -> 98.80%             
client [5] (test)  loss: 0.3773 -> 0.2416   acc: 88.10% -> 92.94%              
client [96] (test)  loss: 0.7215 -> 0.1649   acc: 70.69% -> 95.65%             
client [22] (test)  loss: 0.6408 -> 0.2877   acc: 80.75% -> 89.12%             
client [60] (test)  loss: 0.2671 -> 0.1295   acc: 92.08% -> 95.42%             
client [66] (test)  loss: 0.5999 -> 0.1842   acc: 76.34% -> 94.09%             
client [83] (test)  loss: 0.3576 -> 0.0681   acc: 87.93% -> 98.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.7131 -> 0.2587   acc: 76.55% -> 91.72%             
client [65] (test)  loss: 0.5311 -> 0.2647   acc: 82.52% -> 90.65%             
client [95] (test)  loss: 0.2760 -> 0.2449   acc: 91.18% -> 90.81%             
client [17] (test)  loss: 0.5474 -> 0.2272   acc: 84.39% -> 91.82%             
client [8] (test)  loss: 0.4524 -> 0.2077   acc: 87.76% -> 93.49%              
client [35] (test)  loss: 0.9181 -> 0.3812   acc: 69.72% -> 88.99%             
client [98] (test)  loss: 0.5964 -> 0.3690   acc: 80.12% -> 88.01%             
client [53] (test)  loss: 1.0806 -> 0.3758   acc: 68.31% -> 85.47%             
client [43] (test)  loss: 0.2792 -> 0.1186   acc: 91.16% -> 96.46%             
client [64] (test)  loss: 0.4476 -> 0.2685   acc: 86.82% -> 89.53%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8637 -> 0.6423   acc: 76.27% -> 81.69%             
client [88] (test)  loss: 0.3816 -> 0.2391   acc: 88.02% -> 93.55%             
client [38] (test)  loss: 0.5374 -> 0.1294   acc: 83.87% -> 95.16%             
client [3] (test)  loss: 0.2845 -> 0.1834   acc: 90.61% -> 94.17%              
client [5] (test)  loss: 0.5134 -> 0.2639   acc: 83.64% -> 92.19%              
client [41] (test)  loss: 1.2722 -> 0.3618   acc: 53.54% -> 87.50%             
client [7] (test)  loss: 0.4124 -> 0.1383   acc: 84.26% -> 96.39%              
client [37] (test)  loss: 1.1053 -> 0.1539   acc: 69.78% -> 95.32%             
client [45] (test)  loss: 0.7544 -> 0.2490   acc: 74.25% -> 90.64%             
client [47] (test)  loss: 1.5598 -> 0.2077   acc: 58.61% -> 94.04%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.5152 -> 0.4765   acc: 83.59% -> 85.55%             
client [11] (test)  loss: 0.9235 -> 0.3121   acc: 73.16% -> 91.56%             
client [37] (test)  loss: 0.5770 -> 0.1619   acc: 80.58% -> 96.40%             
client [41] (test)  loss: 0.6093 -> 0.3653   acc: 76.42% -> 87.74%             
client [95] (test)  loss: 0.4733 -> 0.2382   acc: 84.93% -> 91.54%             
client [53] (test)  loss: 1.1309 -> 0.3564   acc: 67.44% -> 85.76%             
client [22] (test)  loss: 0.7888 -> 0.2847   acc: 77.82% -> 89.54%             
client [25] (test)  loss: 0.5628 -> 0.1374   acc: 80.84% -> 95.33%             
client [69] (test)  loss: 0.8763 -> 0.3265   acc: 70.09% -> 88.32%             
client [46] (test)  loss: 0.4069 -> 0.2560   acc: 85.03% -> 91.02%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3547 -> 0.1960   acc: 89.40% -> 94.37%             
client [69] (test)  loss: 0.5836 -> 0.3036   acc: 81.20% -> 89.17%             
client [82] (test)  loss: 1.3661 -> 0.5112   acc: 64.24% -> 85.43%             
client [45] (test)  loss: 0.5752 -> 0.2375   acc: 82.94% -> 90.64%             
client [7] (test)  loss: 0.2223 -> 0.1477   acc: 93.44% -> 96.39%              
client [50] (test)  loss: 0.5918 -> 0.2222   acc: 80.00% -> 93.20%             
client [35] (test)  loss: 0.6215 -> 0.4008   acc: 79.82% -> 88.99%             
client [24] (test)  loss: 0.4615 -> 0.2270   acc: 85.71% -> 91.07%             
client [15] (test)  loss: 0.3364 -> 0.0860   acc: 86.73% -> 97.35%             
client [58] (test)  loss: 0.2463 -> 0.1875   acc: 91.05% -> 95.06%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.7347 -> 0.2328   acc: 77.81% -> 93.05%             
client [76] (test)  loss: 0.7734 -> 0.2763   acc: 75.17% -> 93.45%             
client [67] (test)  loss: 0.8641 -> 0.2672   acc: 73.10% -> 90.82%             
client [37] (test)  loss: 1.2661 -> 0.1626   acc: 70.86% -> 95.32%             
client [58] (test)  loss: 0.4541 -> 0.1723   acc: 87.04% -> 95.06%             
client [64] (test)  loss: 0.5709 -> 0.2546   acc: 81.78% -> 91.09%             
client [77] (test)  loss: 0.4620 -> 0.1928   acc: 85.51% -> 93.72%             
client [55] (test)  loss: 0.2554 -> 0.0661   acc: 91.64% -> 98.17%             
client [12] (test)  loss: 0.8447 -> 0.3764   acc: 73.13% -> 88.78%             
client [89] (test)  loss: 1.2913 -> 0.3343   acc: 62.92% -> 88.76%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.5949 -> 0.4009   acc: 80.46% -> 85.99%             
client [51] (test)  loss: 0.6290 -> 0.3616   acc: 78.09% -> 88.27%             
client [8] (test)  loss: 0.3994 -> 0.1748   acc: 88.02% -> 94.01%              
client [18] (test)  loss: 0.4596 -> 0.1793   acc: 86.36% -> 94.55%             
client [94] (test)  loss: 0.5896 -> 0.1163   acc: 81.37% -> 96.08%             
client [81] (test)  loss: 0.5655 -> 0.0660   acc: 81.50% -> 97.80%             
client [3] (test)  loss: 0.2892 -> 0.1576   acc: 88.67% -> 93.85%              
client [11] (test)  loss: 0.8736 -> 0.2930   acc: 73.38% -> 92.64%             
client [95] (test)  loss: 0.3365 -> 0.2174   acc: 88.97% -> 92.65%             
client [67] (test)  loss: 0.8787 -> 0.2595   acc: 75.00% -> 90.82%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.9237 -> 0.6727   acc: 78.31% -> 82.37%             
client [79] (test)  loss: 0.3554 -> 0.1299   acc: 92.31% -> 95.38%             
client [58] (test)  loss: 0.2849 -> 0.1713   acc: 90.12% -> 94.44%             
client [88] (test)  loss: 0.3018 -> 0.2339   acc: 92.17% -> 94.01%             
client [46] (test)  loss: 0.4705 -> 0.2342   acc: 82.63% -> 90.42%             
client [11] (test)  loss: 0.9014 -> 0.2885   acc: 71.65% -> 91.77%             
client [55] (test)  loss: 0.1011 -> 0.0676   acc: 96.61% -> 98.43%             
client [13] (test)  loss: 0.7837 -> 0.1331   acc: 76.07% -> 95.72%             
client [31] (test)  loss: 0.4021 -> 0.2407   acc: 89.15% -> 93.56%             
client [75] (test)  loss: 0.4294 -> 0.0651   acc: 88.99% -> 97.89%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.3096 -> 0.2439   acc: 87.34% -> 91.70%             
client [7] (test)  loss: 0.3335 -> 0.1517   acc: 89.18% -> 96.39%              
client [57] (test)  loss: 0.1099 -> 0.1102   acc: 97.58% -> 97.58%             
client [13] (test)  loss: 0.3999 -> 0.1300   acc: 88.66% -> 95.47%             
client [43] (test)  loss: 0.1160 -> 0.1081   acc: 97.22% -> 97.98%             
client [91] (test)  loss: 0.7603 -> 0.2320   acc: 78.41% -> 92.51%             
client [10] (test)  loss: 1.2531 -> 0.0871   acc: 66.00% -> 97.35%             
client [64] (test)  loss: 0.3710 -> 0.2482   acc: 86.82% -> 91.47%             
client [82] (test)  loss: 1.3301 -> 0.4577   acc: 64.57% -> 87.75%             
client [22] (test)  loss: 0.7589 -> 0.2653   acc: 78.66% -> 89.54%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1976 -> 0.2267   acc: 66.94% -> 92.56%             
client [23] (test)  loss: 3.1210 -> 0.1745   acc: 34.34% -> 96.46%             
client [88] (test)  loss: 0.3447 -> 0.2487   acc: 92.17% -> 93.55%             
client [98] (test)  loss: 0.4857 -> 0.3552   acc: 83.33% -> 88.30%             
client [79] (test)  loss: 0.5368 -> 0.1296   acc: 88.46% -> 96.15%             
client [21] (test)  loss: 1.0210 -> 0.6896   acc: 73.90% -> 82.03%             
client [92] (test)  loss: 1.4036 -> 0.4129   acc: 68.57% -> 87.43%             
client [56] (test)  loss: 0.6331 -> 0.1566   acc: 83.82% -> 96.29%             
client [5] (test)  loss: 0.2957 -> 0.2736   acc: 91.45% -> 94.05%              
client [52] (test)  loss: 0.7756 -> 0.2998   acc: 78.03% -> 90.49%             
==================== FedDyn_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.6845 -> 0.0000', 'accuracy': '78.52% -> 0.00%'},          
    200: {'loss': '0.6282 -> 0.0000', 'accuracy': '82.00% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedDyn_0.5 achieved 10.0%(13.73%) at epoch: 0                                  
FedDyn_0.5 achieved 30.0%(30.27%) at epoch: 1                                  
FedDyn_0.5 achieved 40.0%(41.53%) at epoch: 11                                 
FedDyn_0.5 achieved 50.0%(53.24%) at epoch: 18                                 
FedDyn_0.5 achieved 60.0%(62.14%) at epoch: 23                                 
FedDyn_0.5 achieved 70.0%(70.95%) at epoch: 33                                 
FedDyn_0.5 achieved 80.0%(81.62%) at epoch: 53                                 
Convergence (test_after):                                                      
FedDyn_0.5 achieved 50.0%(59.82%) at epoch: 0                                  
FedDyn_0.5 achieved 60.0%(60.82%) at epoch: 2                                  
FedDyn_0.5 achieved 70.0%(71.37%) at epoch: 3                                  
FedDyn_0.5 achieved 80.0%(80.67%) at epoch: 12                                 
FedDyn_0.5 achieved 90.0%(90.10%) at epoch: 23                                 
