==================== ALGORITHM: FedPer_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.6950 -> 4.6136   acc: 4.35% -> 7.83%               
client [81] (test)  loss: 4.9946 -> 4.9329   acc: 2.36% -> 3.82%               
client [21] (test)  loss: 5.2705 -> 4.5824   acc: 0.72% -> 6.50%               
client [68] (test)  loss: 4.8545 -> 4.7458   acc: 2.88% -> 7.01%               
client [93] (test)  loss: 4.9041 -> 4.6386   acc: 7.05% -> 11.03%              
client [31] (test)  loss: 5.2128 -> 4.4951   acc: 0.90% -> 7.75%               
client [20] (test)  loss: 4.5746 -> 4.4105   acc: 4.81% -> 7.84%               
client [59] (test)  loss: 5.2857 -> 4.6602   acc: 0.54% -> 3.42%               
client [48] (test)  loss: 4.6498 -> 4.6824   acc: 10.02% -> 10.55%             
client [34] (test)  loss: 4.7983 -> 4.6190   acc: 3.61% -> 8.84%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.0125 -> 4.5856   acc: 4.40% -> 10.81%              
client [99] (test)  loss: 5.6218 -> 4.7864   acc: 3.42% -> 6.12%               
client [67] (test)  loss: 4.5918 -> 4.2709   acc: 7.08% -> 12.57%              
client [0] (test)  loss: 4.5495 -> 4.4389   acc: 8.44% -> 10.95%               
client [76] (test)  loss: 4.5966 -> 4.6344   acc: 7.43% -> 7.97%               
client [41] (test)  loss: 4.8123 -> 4.3574   acc: 5.42% -> 9.22%               
client [62] (test)  loss: 5.3775 -> 4.7429   acc: 0.36% -> 5.99%               
client [2] (test)  loss: 5.3721 -> 4.5517   acc: 0.00% -> 11.03%               
client [14] (test)  loss: 4.7603 -> 4.6585   acc: 6.65% -> 9.24%               
client [46] (test)  loss: 4.6353 -> 4.5207   acc: 7.04% -> 7.22%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.4297 -> 4.4868   acc: 11.18% -> 9.78%              
client [68] (test)  loss: 5.0109 -> 4.7983   acc: 9.89% -> 12.77%              
client [57] (test)  loss: 4.5991 -> 4.5108   acc: 9.62% -> 9.80%               
client [17] (test)  loss: 6.7045 -> 4.5613   acc: 6.06% -> 9.17%               
client [54] (test)  loss: 4.3496 -> 4.3488   acc: 11.25% -> 10.34%             
client [23] (test)  loss: 5.3677 -> 4.5893   acc: 2.58% -> 7.54%               
client [35] (test)  loss: 4.5173 -> 4.8554   acc: 7.59% -> 3.44%               
client [59] (test)  loss: 4.5075 -> 4.4000   acc: 8.09% -> 8.09%               
client [31] (test)  loss: 4.3181 -> 4.4956   acc: 9.73% -> 11.17%              
client [9] (test)  loss: 4.7129 -> 4.6438   acc: 6.80% -> 8.77%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.7433 -> 4.5507   acc: 11.62% -> 11.98%             
client [33] (test)  loss: 4.5360 -> 4.9639   acc: 10.31% -> 8.86%              
client [16] (test)  loss: 4.6308 -> 4.6236   acc: 13.91% -> 13.22%             
client [44] (test)  loss: 12.9273 -> 4.5876   acc: 5.61% -> 10.31%             
client [8] (test)  loss: 4.7119 -> 4.5772   acc: 14.16% -> 14.16%              
client [31] (test)  loss: 4.5995 -> 4.7485   acc: 11.17% -> 11.35%             
client [47] (test)  loss: 5.3744 -> 4.6536   acc: 9.21% -> 8.47%               
client [36] (test)  loss: 5.0245 -> 4.6385   acc: 6.31% -> 9.91%               
client [20] (test)  loss: 4.6986 -> 4.5911   acc: 11.23% -> 13.55%             
client [56] (test)  loss: 4.4263 -> 4.2824   acc: 15.37% -> 14.10%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.4475 -> 4.5043   acc: 12.00% -> 11.64%              
client [60] (test)  loss: 5.9111 -> 4.3083   acc: 7.55% -> 11.87%              
client [28] (test)  loss: 6.6475 -> 4.5211   acc: 10.34% -> 14.34%             
client [25] (test)  loss: 6.5795 -> 4.5034   acc: 8.00% -> 11.82%              
client [58] (test)  loss: 5.2667 -> 4.9999   acc: 9.58% -> 10.85%              
client [44] (test)  loss: 4.7249 -> 4.6731   acc: 11.93% -> 11.21%             
client [39] (test)  loss: 4.7695 -> 4.6372   acc: 13.04% -> 15.44%             
client [29] (test)  loss: 7.0832 -> 4.9015   acc: 10.91% -> 12.34%             
client [3] (test)  loss: 4.6777 -> 4.4551   acc: 8.14% -> 10.49%               
client [84] (test)  loss: 5.2162 -> 4.9725   acc: 9.03% -> 11.73%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.9204 -> 4.6468   acc: 13.90% -> 14.62%             
client [84] (test)  loss: 5.3866 -> 5.6041   acc: 9.57% -> 10.47%              
client [10] (test)  loss: 6.1806 -> 5.1083   acc: 11.93% -> 12.66%             
client [36] (test)  loss: 5.1479 -> 5.1915   acc: 9.91% -> 10.81%              
client [65] (test)  loss: 5.1708 -> 5.5718   acc: 11.20% -> 12.90%             
client [81] (test)  loss: 6.0142 -> 5.4359   acc: 7.27% -> 7.27%               
client [79] (test)  loss: 5.5325 -> 5.2293   acc: 9.67% -> 11.90%              
client [42] (test)  loss: 5.3529 -> 5.5614   acc: 9.58% -> 12.48%              
client [11] (test)  loss: 5.2520 -> 4.5964   acc: 15.84% -> 16.83%             
client [96] (test)  loss: 5.5390 -> 5.1153   acc: 13.20% -> 12.12%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.9984 -> 5.3801   acc: 14.88% -> 14.88%              
client [53] (test)  loss: 5.2268 -> 5.0793   acc: 13.15% -> 12.43%             
client [52] (test)  loss: 6.2503 -> 5.8371   acc: 8.94% -> 10.24%              
client [42] (test)  loss: 6.0864 -> 6.1863   acc: 8.50% -> 11.39%              
client [69] (test)  loss: 5.8254 -> 6.1655   acc: 10.99% -> 10.44%             
client [59] (test)  loss: 5.3019 -> 5.2993   acc: 10.43% -> 9.89%              
client [7] (test)  loss: 8.3595 -> 5.4114   acc: 8.39% -> 11.61%               
client [26] (test)  loss: 5.6339 -> 5.4781   acc: 10.92% -> 16.12%             
client [49] (test)  loss: 5.4792 -> 5.8022   acc: 9.24% -> 8.70%               
client [98] (test)  loss: 5.5163 -> 5.7606   acc: 12.84% -> 12.84%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 6.6740 -> 6.3059   acc: 11.21% -> 11.75%             
client [47] (test)  loss: 7.5384 -> 5.6679   acc: 12.71% -> 12.52%             
client [21] (test)  loss: 5.6948 -> 5.4357   acc: 12.64% -> 14.80%             
client [77] (test)  loss: 6.0428 -> 6.1020   acc: 12.52% -> 11.65%             
client [95] (test)  loss: 6.0016 -> 6.1058   acc: 12.84% -> 12.84%             
client [91] (test)  loss: 6.5184 -> 5.7381   acc: 9.63% -> 13.85%              
client [14] (test)  loss: 6.6035 -> 6.7271   acc: 9.06% -> 9.61%               
client [99] (test)  loss: 6.2793 -> 6.2376   acc: 7.37% -> 8.27%               
client [20] (test)  loss: 6.7953 -> 6.1927   acc: 13.55% -> 13.73%             
client [39] (test)  loss: 6.5976 -> 5.8955   acc: 14.92% -> 14.75%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 7.6785 -> 6.8466   acc: 9.87% -> 9.68%               
client [62] (test)  loss: 7.2583 -> 7.1356   acc: 9.80% -> 10.89%              
client [71] (test)  loss: 5.7749 -> 6.2593   acc: 12.97% -> 12.07%             
client [97] (test)  loss: 6.2362 -> 5.7935   acc: 12.13% -> 10.66%             
client [30] (test)  loss: 6.8156 -> 6.8596   acc: 13.25% -> 14.52%             
client [88] (test)  loss: 6.3653 -> 6.1546   acc: 10.12% -> 9.77%              
client [60] (test)  loss: 6.6191 -> 6.3113   acc: 12.59% -> 11.51%             
client [82] (test)  loss: 6.9141 -> 6.7986   acc: 7.48% -> 6.26%               
client [91] (test)  loss: 6.7791 -> 6.4343   acc: 11.32% -> 13.68%             
client [57] (test)  loss: 6.4606 -> 6.4171   acc: 12.34% -> 12.70%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 8.7431 -> 8.0314   acc: 10.81% -> 11.53%             
client [15] (test)  loss: 6.5816 -> 6.7748   acc: 10.12% -> 10.12%             
client [71] (test)  loss: 6.8347 -> 6.6678   acc: 12.43% -> 12.61%             
client [97] (test)  loss: 6.8152 -> 7.1085   acc: 12.68% -> 10.11%             
client [53] (test)  loss: 7.2052 -> 6.9649   acc: 14.59% -> 12.25%             
client [77] (test)  loss: 7.5795 -> 7.1046   acc: 12.00% -> 9.91%              
client [76] (test)  loss: 7.7986 -> 7.4339   acc: 9.06% -> 11.41%              
client [79] (test)  loss: 8.0230 -> 7.3617   acc: 11.34% -> 11.52%             
client [28] (test)  loss: 7.6804 -> 7.3017   acc: 10.89% -> 13.79%             
client [99] (test)  loss: 8.4221 -> 7.5350   acc: 5.40% -> 8.81%               
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 7.7204 -> 7.8294   acc: 13.24% -> 11.03%             
client [86] (test)  loss: 7.3032 -> 7.7008   acc: 9.80% -> 8.89%               
client [34] (test)  loss: 7.6930 -> 8.1287   acc: 12.82% -> 13.36%             
client [73] (test)  loss: 7.1514 -> 7.2939   acc: 11.09% -> 13.09%             
client [5] (test)  loss: 7.7807 -> 7.8997   acc: 11.89% -> 11.17%              
client [96] (test)  loss: 8.1965 -> 7.9447   acc: 13.20% -> 12.66%             
client [22] (test)  loss: 7.2446 -> 7.2664   acc: 13.55% -> 13.73%             
client [60] (test)  loss: 7.8400 -> 7.6693   acc: 10.79% -> 9.71%              
client [66] (test)  loss: 7.7506 -> 7.5289   acc: 11.27% -> 10.36%             
client [83] (test)  loss: 8.8088 -> 7.7115   acc: 6.91% -> 8.73%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 9.7142 -> 8.8118   acc: 9.60% -> 11.78%              
client [65] (test)  loss: 8.2159 -> 8.3398   acc: 11.01% -> 11.76%             
client [95] (test)  loss: 8.9368 -> 8.2208   acc: 12.12% -> 11.39%             
client [17] (test)  loss: 10.4034 -> 7.8175   acc: 9.72% -> 10.64%             
client [8] (test)  loss: 9.0280 -> 7.9107   acc: 14.70% -> 15.97%              
client [35] (test)  loss: 9.1009 -> 8.7265   acc: 10.31% -> 11.75%             
client [98] (test)  loss: 8.6187 -> 8.2172   acc: 12.30% -> 12.30%             
client [53] (test)  loss: 7.8035 -> 7.9806   acc: 13.69% -> 12.97%             
client [43] (test)  loss: 9.4039 -> 8.2964   acc: 10.34% -> 13.07%             
client [64] (test)  loss: 8.5245 -> 8.0810   acc: 10.16% -> 11.43%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 8.7161 -> 7.4224   acc: 12.82% -> 14.26%             
client [88] (test)  loss: 8.6661 -> 8.8673   acc: 9.41% -> 9.59%               
client [38] (test)  loss: 8.8663 -> 8.8144   acc: 9.60% -> 12.50%              
client [3] (test)  loss: 9.6312 -> 8.8962   acc: 9.76% -> 9.04%                
client [5] (test)  loss: 9.2043 -> 8.9584   acc: 10.99% -> 9.91%               
client [41] (test)  loss: 8.1157 -> 8.1545   acc: 12.66% -> 12.48%             
client [7] (test)  loss: 9.1965 -> 7.9067   acc: 10.36% -> 11.07%              
client [37] (test)  loss: 7.8857 -> 7.6665   acc: 14.08% -> 14.08%             
client [45] (test)  loss: 10.2332 -> 7.3194   acc: 7.75% -> 15.32%             
client [47] (test)  loss: 9.6642 -> 7.8336   acc: 9.02% -> 11.60%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 10.1008 -> 9.3878   acc: 13.22% -> 13.39%            
client [11] (test)  loss: 8.3802 -> 8.2290   acc: 13.47% -> 16.44%             
client [37] (test)  loss: 8.2944 -> 8.4024   acc: 13.00% -> 13.54%             
client [41] (test)  loss: 8.6101 -> 8.5549   acc: 12.30% -> 12.48%             
client [95] (test)  loss: 9.2673 -> 9.3424   acc: 12.30% -> 11.93%             
client [53] (test)  loss: 9.4570 -> 8.6253   acc: 11.71% -> 13.15%             
client [22] (test)  loss: 8.7090 -> 8.3729   acc: 13.55% -> 12.48%             
client [25] (test)  loss: 8.9577 -> 8.3133   acc: 8.73% -> 11.82%              
client [69] (test)  loss: 10.9043 -> 10.7702   acc: 10.07% -> 11.36%           
client [46] (test)  loss: 8.5364 -> 8.1454   acc: 9.57% -> 10.47%              
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 9.5129 -> 9.5976   acc: 10.87% -> 11.42%             
client [69] (test)  loss: 11.1475 -> 11.4740   acc: 10.07% -> 10.81%           
client [82] (test)  loss: 10.5364 -> 9.9997   acc: 7.83% -> 9.57%              
client [45] (test)  loss: 9.5417 -> 8.3885   acc: 9.51% -> 15.85%              
client [7] (test)  loss: 9.7507 -> 8.6589   acc: 10.71% -> 11.43%              
client [50] (test)  loss: 9.0122 -> 8.0254   acc: 10.49% -> 11.03%             
client [35] (test)  loss: 10.2567 -> 9.9005   acc: 11.39% -> 11.75%            
client [24] (test)  loss: 10.4578 -> 10.1789   acc: 7.39% -> 9.18%             
client [15] (test)  loss: 9.2377 -> 9.1343   acc: 9.59% -> 10.83%              
client [58] (test)  loss: 10.4830 -> 10.9023   acc: 10.31% -> 10.31%           
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 11.0292 -> 9.8530   acc: 9.84% -> 13.60%             
client [76] (test)  loss: 11.4046 -> 10.8932   acc: 10.51% -> 10.51%           
client [67] (test)  loss: 9.4675 -> 9.1802   acc: 9.91% -> 9.73%               
client [37] (test)  loss: 9.7610 -> 9.0669   acc: 13.00% -> 13.00%             
client [58] (test)  loss: 11.1114 -> 11.4616   acc: 11.39% -> 10.85%           
client [64] (test)  loss: 10.7102 -> 10.1435   acc: 9.62% -> 11.07%            
client [77] (test)  loss: 10.1704 -> 9.5014   acc: 10.78% -> 8.87%             
client [55] (test)  loss: 11.1550 -> 10.3038   acc: 8.91% -> 11.05%            
client [12] (test)  loss: 10.2170 -> 9.7260   acc: 10.92% -> 10.34%            
client [89] (test)  loss: 11.7304 -> 11.3128   acc: 9.44% -> 9.98%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 11.5955 -> 11.5450   acc: 12.45% -> 12.45%           
client [51] (test)  loss: 10.6105 -> 10.3900   acc: 9.78% -> 11.78%            
client [8] (test)  loss: 10.7058 -> 10.3571   acc: 15.06% -> 14.88%            
client [18] (test)  loss: 10.2339 -> 9.9095   acc: 10.18% -> 11.25%            
client [94] (test)  loss: 10.7225 -> 10.5522   acc: 11.17% -> 12.37%           
client [81] (test)  loss: 11.5847 -> 11.6408   acc: 7.82% -> 8.36%             
client [3] (test)  loss: 11.0254 -> 10.7371   acc: 9.40% -> 9.95%              
client [11] (test)  loss: 9.4492 -> 9.5084   acc: 15.45% -> 15.64%             
client [95] (test)  loss: 10.7846 -> 10.9234   acc: 12.12% -> 12.30%           
client [67] (test)  loss: 9.5763 -> 9.5108   acc: 9.91% -> 9.56%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 10.6770 -> 9.1294   acc: 13.00% -> 13.54%            
client [79] (test)  loss: 12.0768 -> 11.4109   acc: 12.27% -> 11.34%           
client [58] (test)  loss: 12.0551 -> 12.2495   acc: 10.85% -> 11.03%           
client [88] (test)  loss: 10.9001 -> 10.8745   acc: 9.06% -> 9.06%             
client [46] (test)  loss: 10.5472 -> 9.7123   acc: 11.55% -> 10.11%            
client [11] (test)  loss: 10.0784 -> 9.8616   acc: 13.27% -> 16.04%            
client [55] (test)  loss: 11.4084 -> 11.3030   acc: 9.98% -> 11.59%            
client [13] (test)  loss: 11.0205 -> 10.7139   acc: 19.07% -> 18.29%           
client [31] (test)  loss: 12.3793 -> 11.0015   acc: 10.81% -> 10.81%           
client [75] (test)  loss: 10.5430 -> 10.4677   acc: 9.39% -> 9.93%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 11.3626 -> 11.4712   acc: 9.91% -> 10.09%            
client [7] (test)  loss: 11.1269 -> 10.8529   acc: 10.89% -> 11.61%            
client [57] (test)  loss: 11.4372 -> 11.2226   acc: 11.80% -> 12.16%           
client [13] (test)  loss: 10.9681 -> 11.0298   acc: 18.48% -> 19.65%           
client [43] (test)  loss: 11.5751 -> 11.5050   acc: 9.62% -> 11.07%            
client [91] (test)  loss: 10.9514 -> 10.1114   acc: 10.81% -> 13.01%           
client [10] (test)  loss: 12.2623 -> 11.9710   acc: 9.58% -> 10.49%            
client [64] (test)  loss: 11.8222 -> 11.7933   acc: 10.71% -> 11.43%           
client [82] (test)  loss: 12.0359 -> 12.1263   acc: 9.22% -> 8.87%             
client [22] (test)  loss: 10.7520 -> 10.6147   acc: 12.48% -> 12.83%           
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 11.5750 -> 11.0736   acc: 12.48% -> 12.83%           
client [23] (test)  loss: 11.2503 -> 11.0295   acc: 7.54% -> 8.73%             
client [88] (test)  loss: 11.7853 -> 11.6608   acc: 8.70% -> 9.24%             
client [98] (test)  loss: 12.2682 -> 12.2239   acc: 11.21% -> 11.93%           
client [79] (test)  loss: 12.4959 -> 12.3259   acc: 11.71% -> 10.97%           
client [21] (test)  loss: 11.0141 -> 10.0997   acc: 12.45% -> 12.82%           
client [92] (test)  loss: 12.3999 -> 11.7408   acc: 14.26% -> 12.09%           
client [56] (test)  loss: 11.2572 -> 11.5016   acc: 12.84% -> 12.66%           
client [5] (test)  loss: 12.4112 -> 11.9303   acc: 10.09% -> 10.45%            
client [52] (test)  loss: 13.2813 -> 12.7753   acc: 10.06% -> 10.61%           
==================== FedPer_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '7.6045 -> 0.0000', 'accuracy': '11.27% -> 0.00%'},          
    200: {'loss': '12.0499 -> 0.0000', 'accuracy': '10.75% -> 0.00%'}          
}                                                                              
Convergence (test_before):                                                     
FedPer_0.5 achieved 10.0%(10.27%) at epoch: 30                                 
Convergence (test_after):                                                      
FedPer_0.5 achieved 10.0%(10.61%) at epoch: 22                                 
