==================== ALGORITHM: FedPer_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.4656 -> 1.3831   acc: 54.25% -> 53.85%             
client [81] (test)  loss: 0.9595 -> 0.9499   acc: 70.26% -> 71.26%             
client [21] (test)  loss: 12.0328 -> 0.2541   acc: 85.07% -> 91.51%            
client [68] (test)  loss: 0.8112 -> 0.8544   acc: 75.46% -> 73.25%             
client [93] (test)  loss: 1.5942 -> 1.2931   acc: 44.62% -> 53.04%             
client [31] (test)  loss: 4.1880 -> 1.0725   acc: 9.26% -> 58.53%              
client [20] (test)  loss: 1.3011 -> 2.2918   acc: 53.08% -> 29.28%             
client [59] (test)  loss: 107.7708 -> 1.0582   acc: 1.08% -> 66.99%            
client [48] (test)  loss: 1.1275 -> 1.1513   acc: 60.83% -> 59.49%             
client [34] (test)  loss: 1.3094 -> 1.3428   acc: 49.93% -> 51.27%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.7107 -> 0.9061   acc: 44.06% -> 64.87%             
client [99] (test)  loss: 1.8263 -> 1.8131   acc: 44.53% -> 42.94%             
client [67] (test)  loss: 1.1295 -> 1.2933   acc: 54.67% -> 53.28%             
client [0] (test)  loss: 1.0411 -> 0.9338   acc: 64.34% -> 68.61%              
client [76] (test)  loss: 1.2916 -> 1.3456   acc: 51.35% -> 52.34%             
client [41] (test)  loss: 1.9885 -> 1.4344   acc: 32.01% -> 48.27%             
client [62] (test)  loss: 89.3278 -> 1.0943   acc: 8.82% -> 63.70%             
client [2] (test)  loss: 44.8408 -> 1.0842   acc: 41.52% -> 65.05%             
client [14] (test)  loss: 1.1307 -> 1.6116   acc: 62.26% -> 44.64%             
client [46] (test)  loss: 0.8647 -> 0.9065   acc: 68.84% -> 71.20%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3903 -> 1.2436   acc: 54.47% -> 59.06%             
client [68] (test)  loss: 0.8049 -> 0.7245   acc: 75.93% -> 79.00%             
client [57] (test)  loss: 1.3309 -> 1.4663   acc: 51.20% -> 44.78%             
client [17] (test)  loss: 1.5135 -> 0.9829   acc: 43.03% -> 61.12%             
client [54] (test)  loss: 1.4137 -> 1.0387   acc: 41.81% -> 58.25%             
client [23] (test)  loss: 81.4949 -> 1.2926   acc: 19.16% -> 51.18%            
client [35] (test)  loss: 1.4527 -> 1.2804   acc: 49.47% -> 45.60%             
client [59] (test)  loss: 1.2656 -> 1.0271   acc: 58.92% -> 69.04%             
client [31] (test)  loss: 0.8830 -> 0.7480   acc: 68.66% -> 72.59%             
client [9] (test)  loss: 1.2248 -> 1.4644   acc: 58.19% -> 53.57%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1425 -> 1.4762   acc: 60.67% -> 49.60%             
client [33] (test)  loss: 1.1752 -> 0.7559   acc: 53.75% -> 65.55%             
client [16] (test)  loss: 0.4690 -> 1.3015   acc: 82.79% -> 61.04%             
client [44] (test)  loss: 1.5484 -> 1.1170   acc: 55.15% -> 61.17%             
client [8] (test)  loss: 0.1464 -> 0.0807   acc: 94.43% -> 97.40%              
client [31] (test)  loss: 0.6302 -> 0.7447   acc: 78.28% -> 72.23%             
client [47] (test)  loss: 0.2896 -> 0.2314   acc: 89.35% -> 92.85%             
client [36] (test)  loss: 1.6636 -> 1.3347   acc: 43.12% -> 50.76%             
client [20] (test)  loss: 1.1689 -> 1.4482   acc: 61.23% -> 51.75%             
client [56] (test)  loss: 0.5514 -> 0.5768   acc: 78.20% -> 77.55%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.8549 -> 0.6431   acc: 50.50% -> 80.63%              
client [60] (test)  loss: 0.8806 -> 0.6503   acc: 69.36% -> 80.35%             
client [28] (test)  loss: 1.9607 -> 1.4443   acc: 49.90% -> 51.87%             
client [25] (test)  loss: 1.1100 -> 1.4280   acc: 68.33% -> 59.69%             
client [58] (test)  loss: 1.5854 -> 0.7882   acc: 55.75% -> 71.67%             
client [44] (test)  loss: 1.3732 -> 1.1923   acc: 50.54% -> 58.86%             
client [39] (test)  loss: 1.1720 -> 1.2387   acc: 54.25% -> 49.72%             
client [29] (test)  loss: 1.3322 -> 1.2731   acc: 56.69% -> 57.31%             
client [3] (test)  loss: 1.0562 -> 1.4369   acc: 63.72% -> 58.29%              
client [84] (test)  loss: 1.2043 -> 1.5093   acc: 59.16% -> 51.49%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4680 -> 0.2355   acc: 83.09% -> 91.07%             
client [84] (test)  loss: 1.1730 -> 1.4890   acc: 61.36% -> 52.53%             
client [10] (test)  loss: 1.4324 -> 0.8617   acc: 62.14% -> 74.52%             
client [36] (test)  loss: 1.2665 -> 1.3302   acc: 53.69% -> 49.51%             
client [65] (test)  loss: 1.3052 -> 1.2452   acc: 57.03% -> 60.28%             
client [81] (test)  loss: 0.7893 -> 0.7978   acc: 74.54% -> 74.94%             
client [79] (test)  loss: 1.3956 -> 1.0053   acc: 49.44% -> 63.75%             
client [42] (test)  loss: 0.8155 -> 0.6831   acc: 75.82% -> 80.04%             
client [11] (test)  loss: 0.5638 -> 0.5155   acc: 78.62% -> 80.53%             
client [96] (test)  loss: 0.8351 -> 0.6729   acc: 75.35% -> 78.32%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1235 -> 0.0894   acc: 95.22% -> 97.11%              
client [53] (test)  loss: 1.1502 -> 1.1555   acc: 59.61% -> 60.11%             
client [52] (test)  loss: 0.1013 -> 0.0980   acc: 96.37% -> 97.71%             
client [42] (test)  loss: 0.6877 -> 0.7197   acc: 78.12% -> 76.78%             
client [69] (test)  loss: 1.0786 -> 0.8943   acc: 58.11% -> 67.13%             
client [59] (test)  loss: 1.0316 -> 1.0460   acc: 69.04% -> 70.36%             
client [7] (test)  loss: 2.1059 -> 3.2078   acc: 40.66% -> 24.70%              
client [26] (test)  loss: 1.0845 -> 1.0190   acc: 65.37% -> 67.39%             
client [49] (test)  loss: 0.9252 -> 1.0033   acc: 67.73% -> 68.35%             
client [98] (test)  loss: 1.3239 -> 1.2933   acc: 54.97% -> 55.20%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2913 -> 1.4665   acc: 57.00% -> 50.00%             
client [47] (test)  loss: 0.2821 -> 0.2480   acc: 92.12% -> 91.76%             
client [21] (test)  loss: 0.4763 -> 0.2347   acc: 81.26% -> 91.43%             
client [77] (test)  loss: 1.4442 -> 1.3456   acc: 54.17% -> 59.76%             
client [95] (test)  loss: 1.1098 -> 1.1076   acc: 63.33% -> 60.83%             
client [91] (test)  loss: 1.2630 -> 1.0426   acc: 60.92% -> 67.19%             
client [14] (test)  loss: 1.0769 -> 1.2329   acc: 64.37% -> 61.12%             
client [99] (test)  loss: 1.6378 -> 1.8722   acc: 43.42% -> 47.41%             
client [20] (test)  loss: 1.3442 -> 1.2184   acc: 56.57% -> 60.57%             
client [39] (test)  loss: 1.3011 -> 1.2461   acc: 51.42% -> 54.19%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1029 -> 0.0985   acc: 97.17% -> 97.51%             
client [62] (test)  loss: 1.1484 -> 1.1980   acc: 65.83% -> 63.34%             
client [71] (test)  loss: 0.8872 -> 0.9658   acc: 67.11% -> 62.95%             
client [97] (test)  loss: 1.2764 -> 1.2965   acc: 57.13% -> 58.52%             
client [30] (test)  loss: 0.9590 -> 1.0004   acc: 69.13% -> 71.77%             
client [88] (test)  loss: 1.1698 -> 1.2471   acc: 60.36% -> 56.96%             
client [60] (test)  loss: 0.8221 -> 0.6465   acc: 74.95% -> 81.31%             
client [82] (test)  loss: 1.1156 -> 1.2846   acc: 61.77% -> 55.36%             
client [91] (test)  loss: 1.4778 -> 1.2017   acc: 56.83% -> 63.53%             
client [57] (test)  loss: 1.3111 -> 1.7097   acc: 52.73% -> 46.22%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9143 -> 0.5722   acc: 68.00% -> 82.22%             
client [15] (test)  loss: 1.1132 -> 1.2094   acc: 58.76% -> 60.19%             
client [71] (test)  loss: 0.8645 -> 0.9968   acc: 67.96% -> 63.94%             
client [97] (test)  loss: 1.4271 -> 1.3686   acc: 54.17% -> 57.78%             
client [53] (test)  loss: 1.2121 -> 1.2427   acc: 58.22% -> 59.74%             
client [77] (test)  loss: 1.9111 -> 1.5666   acc: 45.43% -> 56.11%             
client [76] (test)  loss: 1.5364 -> 1.3386   acc: 49.37% -> 54.79%             
client [79] (test)  loss: 1.7433 -> 1.0875   acc: 39.75% -> 62.80%             
client [28] (test)  loss: 1.3400 -> 1.6432   acc: 57.07% -> 47.74%             
client [99] (test)  loss: 1.5945 -> 1.6830   acc: 46.69% -> 50.04%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.3642 -> 1.5305   acc: 56.48% -> 54.63%             
client [86] (test)  loss: 1.6174 -> 1.5059   acc: 46.72% -> 54.33%             
client [34] (test)  loss: 1.4112 -> 1.4091   acc: 57.63% -> 58.23%             
client [73] (test)  loss: 1.0400 -> 1.3809   acc: 66.18% -> 57.63%             
client [5] (test)  loss: 1.2846 -> 1.1380   acc: 52.16% -> 56.69%              
client [96] (test)  loss: 0.7632 -> 0.7434   acc: 77.41% -> 77.59%             
client [22] (test)  loss: 1.5221 -> 1.1837   acc: 60.87% -> 60.02%             
client [60] (test)  loss: 0.8510 -> 0.6764   acc: 76.69% -> 79.58%             
client [66] (test)  loss: 1.1029 -> 1.0017   acc: 62.41% -> 68.58%             
client [83] (test)  loss: 1.7363 -> 1.0208   acc: 57.46% -> 77.26%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.4885 -> 1.4105   acc: 51.02% -> 52.67%             
client [65] (test)  loss: 1.1452 -> 1.2961   acc: 63.01% -> 61.42%             
client [95] (test)  loss: 1.6721 -> 0.9922   acc: 54.07% -> 67.77%             
client [17] (test)  loss: 1.2032 -> 1.0639   acc: 57.82% -> 61.26%             
client [8] (test)  loss: 0.1296 -> 0.1049   acc: 95.22% -> 97.25%              
client [35] (test)  loss: 1.3038 -> 1.2909   acc: 49.68% -> 51.52%             
client [98] (test)  loss: 1.5466 -> 1.4088   acc: 50.83% -> 54.67%             
client [53] (test)  loss: 1.5430 -> 1.3104   acc: 53.12% -> 58.79%             
client [43] (test)  loss: 1.6527 -> 1.3131   acc: 55.42% -> 59.85%             
client [64] (test)  loss: 1.5109 -> 1.3120   acc: 58.13% -> 56.53%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2747 -> 0.2300   acc: 88.87% -> 92.46%             
client [88] (test)  loss: 1.3717 -> 1.3957   acc: 58.63% -> 56.51%             
client [38] (test)  loss: 1.2745 -> 1.4231   acc: 57.12% -> 55.29%             
client [3] (test)  loss: 1.0786 -> 1.3849   acc: 67.03% -> 63.63%              
client [5] (test)  loss: 1.5784 -> 1.1588   acc: 49.04% -> 57.40%              
client [41] (test)  loss: 1.2277 -> 1.3944   acc: 57.42% -> 54.98%             
client [7] (test)  loss: 2.0178 -> 2.8007   acc: 41.53% -> 33.66%              
client [37] (test)  loss: 1.8267 -> 1.0564   acc: 37.35% -> 56.78%             
client [45] (test)  loss: 1.7698 -> 1.1900   acc: 48.71% -> 61.47%             
client [47] (test)  loss: 0.5127 -> 0.2946   acc: 83.15% -> 91.83%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9465 -> 0.6536   acc: 73.78% -> 81.79%             
client [11] (test)  loss: 0.5063 -> 0.5340   acc: 82.38% -> 82.58%             
client [37] (test)  loss: 1.6221 -> 1.1367   acc: 43.55% -> 55.95%             
client [41] (test)  loss: 1.6259 -> 1.3631   acc: 48.17% -> 55.39%             
client [95] (test)  loss: 1.4098 -> 1.3169   acc: 61.83% -> 67.21%             
client [53] (test)  loss: 1.3845 -> 1.3353   acc: 57.84% -> 58.35%             
client [22] (test)  loss: 1.5096 -> 1.3250   acc: 59.35% -> 58.50%             
client [25] (test)  loss: 2.0682 -> 1.0961   acc: 54.32% -> 69.19%             
client [69] (test)  loss: 0.8685 -> 1.0210   acc: 71.81% -> 69.38%             
client [46] (test)  loss: 0.7728 -> 0.9042   acc: 76.31% -> 74.83%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5012 -> 0.3625   acc: 86.36% -> 91.54%             
client [69] (test)  loss: 1.0197 -> 1.1704   acc: 66.61% -> 65.92%             
client [82] (test)  loss: 1.3803 -> 1.2534   acc: 60.49% -> 59.47%             
client [45] (test)  loss: 1.3904 -> 1.2532   acc: 58.76% -> 60.70%             
client [7] (test)  loss: 1.6531 -> 2.5312   acc: 49.07% -> 38.69%              
client [50] (test)  loss: 1.0276 -> 1.0298   acc: 65.46% -> 61.15%             
client [35] (test)  loss: 1.3648 -> 1.4534   acc: 52.57% -> 50.46%             
client [24] (test)  loss: 1.5735 -> 1.3373   acc: 61.14% -> 60.36%             
client [15] (test)  loss: 1.3923 -> 1.1620   acc: 52.09% -> 61.50%             
client [58] (test)  loss: 1.7914 -> 0.8693   acc: 58.49% -> 76.16%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.2501 -> 1.1856   acc: 60.70% -> 66.91%             
client [76] (test)  loss: 1.3967 -> 1.4877   acc: 56.44% -> 52.48%             
client [67] (test)  loss: 1.1758 -> 1.3548   acc: 60.34% -> 61.68%             
client [37] (test)  loss: 1.1381 -> 1.1536   acc: 56.62% -> 56.11%             
client [58] (test)  loss: 2.3776 -> 0.9032   acc: 51.19% -> 75.25%             
client [64] (test)  loss: 1.3260 -> 1.3093   acc: 57.47% -> 58.27%             
client [77] (test)  loss: 1.4358 -> 1.7614   acc: 55.63% -> 55.06%             
client [55] (test)  loss: 1.4076 -> 1.2516   acc: 60.22% -> 63.16%             
client [12] (test)  loss: 1.0837 -> 1.3881   acc: 64.51% -> 56.94%             
client [89] (test)  loss: 1.4855 -> 1.5836   acc: 57.44% -> 59.50%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.6465 -> 1.7288   acc: 52.40% -> 54.16%             
client [51] (test)  loss: 0.6348 -> 0.6719   acc: 79.80% -> 81.61%             
client [8] (test)  loss: 0.1088 -> 0.1140   acc: 96.67% -> 96.96%              
client [18] (test)  loss: 1.2425 -> 1.2733   acc: 61.73% -> 60.14%             
client [94] (test)  loss: 1.5729 -> 1.3263   acc: 52.84% -> 64.19%             
client [81] (test)  loss: 1.1351 -> 1.0243   acc: 76.33% -> 72.80%             
client [3] (test)  loss: 1.1033 -> 1.3586   acc: 67.03% -> 64.00%              
client [11] (test)  loss: 0.7494 -> 0.5745   acc: 77.87% -> 83.13%             
client [95] (test)  loss: 1.4966 -> 1.2715   acc: 61.14% -> 63.95%             
client [67] (test)  loss: 1.3226 -> 1.3637   acc: 57.40% -> 61.57%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3127 -> 0.2446   acc: 88.87% -> 92.46%             
client [79] (test)  loss: 2.4286 -> 1.2214   acc: 32.91% -> 63.28%             
client [58] (test)  loss: 1.9386 -> 0.9220   acc: 58.91% -> 74.68%             
client [88] (test)  loss: 1.9289 -> 1.5769   acc: 52.28% -> 56.45%             
client [46] (test)  loss: 1.1354 -> 1.0325   acc: 72.01% -> 74.02%             
client [11] (test)  loss: 0.6722 -> 0.5863   acc: 79.10% -> 83.40%             
client [55] (test)  loss: 1.4044 -> 1.3636   acc: 62.85% -> 63.47%             
client [13] (test)  loss: 1.6314 -> 1.2677   acc: 57.11% -> 62.98%             
client [31] (test)  loss: 0.8429 -> 0.6531   acc: 71.57% -> 81.63%             
client [75] (test)  loss: 1.7857 -> 1.5786   acc: 54.46% -> 57.80%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.5171 -> 1.1686   acc: 54.79% -> 66.06%             
client [7] (test)  loss: 1.8628 -> 2.2727   acc: 48.63% -> 44.70%              
client [57] (test)  loss: 1.5802 -> 1.8990   acc: 54.93% -> 48.52%             
client [13] (test)  loss: 1.7318 -> 1.2794   acc: 57.90% -> 62.53%             
client [43] (test)  loss: 1.6189 -> 1.3236   acc: 58.15% -> 62.44%             
client [91] (test)  loss: 1.3709 -> 1.2377   acc: 63.27% -> 64.06%             
client [10] (test)  loss: 2.2433 -> 1.0676   acc: 46.98% -> 74.34%             
client [64] (test)  loss: 1.5669 -> 1.3162   acc: 55.73% -> 60.40%             
client [82] (test)  loss: 1.2968 -> 1.3889   acc: 60.22% -> 60.01%             
client [22] (test)  loss: 1.6486 -> 1.3241   acc: 56.98% -> 61.54%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1493 -> 1.2782   acc: 63.73% -> 60.90%             
client [23] (test)  loss: 2.2037 -> 1.5691   acc: 38.68% -> 54.36%             
client [88] (test)  loss: 1.3356 -> 1.6015   acc: 61.64% -> 57.99%             
client [98] (test)  loss: 1.5324 -> 1.8453   acc: 58.66% -> 50.45%             
client [79] (test)  loss: 1.8111 -> 1.2856   acc: 47.22% -> 63.91%             
client [21] (test)  loss: 0.2648 -> 0.2413   acc: 90.04% -> 91.87%             
client [92] (test)  loss: 1.4543 -> 1.0996   acc: 57.47% -> 63.79%             
client [56] (test)  loss: 0.7190 -> 0.7618   acc: 80.09% -> 79.65%             
client [5] (test)  loss: 1.4506 -> 1.4681   acc: 55.41% -> 54.71%              
client [52] (test)  loss: 0.1485 -> 0.1112   acc: 95.48% -> 97.17%             
==================== FedPer_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '1.1853 -> 0.0000', 'accuracy': '61.62% -> 0.00%'},          
    200: {'loss': '1.3355 -> 0.0000', 'accuracy': '63.09% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_0.5 achieved 10.0%(10.12%) at epoch: 0                                  
FedPer_0.5 achieved 20.0%(28.20%) at epoch: 3                                  
FedPer_0.5 achieved 50.0%(52.28%) at epoch: 7                                  
FedPer_0.5 achieved 60.0%(60.58%) at epoch: 23                                 
FedPer_0.5 achieved 70.0%(71.04%) at epoch: 39                                 
Convergence (test_after):                                                      
FedPer_0.5 achieved 50.0%(51.49%) at epoch: 0                                  
FedPer_0.5 achieved 60.0%(62.10%) at epoch: 9                                  
FedPer_0.5 achieved 70.0%(73.91%) at epoch: 31                                 
