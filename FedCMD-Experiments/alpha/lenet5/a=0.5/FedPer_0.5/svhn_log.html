==================== ALGORITHM: FedPer_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.7484 -> 1.7819   acc: 35.80% -> 36.83%             
client [81] (test)  loss: 1.1690 -> 1.5420   acc: 58.65% -> 52.09%             
client [21] (test)  loss: 33.2124 -> 0.6126   acc: 30.19% -> 77.88%            
client [68] (test)  loss: 0.0553 -> 0.0516   acc: 99.14% -> 99.14%             
client [93] (test)  loss: 0.8260 -> 0.6528   acc: 70.75% -> 72.89%             
client [31] (test)  loss: 0.0332 -> 0.0226   acc: 99.65% -> 99.65%             
client [20] (test)  loss: 1.4560 -> 1.2385   acc: 48.18% -> 60.93%             
client [59] (test)  loss: 56.9509 -> 1.2651   acc: 16.32% -> 60.25%            
client [48] (test)  loss: 1.2493 -> 1.2552   acc: 56.25% -> 54.64%             
client [34] (test)  loss: 1.4250 -> 1.3460   acc: 49.35% -> 47.42%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.5478 -> 1.0114   acc: 55.90% -> 65.97%             
client [99] (test)  loss: 1.1385 -> 0.6599   acc: 60.78% -> 77.06%             
client [67] (test)  loss: 0.6898 -> 0.5967   acc: 73.65% -> 79.04%             
client [0] (test)  loss: 0.8171 -> 0.7673   acc: 73.73% -> 75.42%              
client [76] (test)  loss: 0.8043 -> 0.5018   acc: 77.31% -> 82.45%             
client [41] (test)  loss: 0.8344 -> 0.6961   acc: 70.48% -> 76.83%             
client [62] (test)  loss: 18.2391 -> 0.3318   acc: 66.56% -> 88.58%            
client [2] (test)  loss: 22.1200 -> 0.4902   acc: 71.04% -> 84.75%             
client [14] (test)  loss: 0.4589 -> 0.3142   acc: 85.80% -> 90.13%             
client [46] (test)  loss: 0.9257 -> 0.8971   acc: 70.16% -> 69.62%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3830 -> 0.3369   acc: 88.80% -> 89.80%             
client [68] (test)  loss: 0.0341 -> 0.0193   acc: 99.14% -> 99.43%             
client [57] (test)  loss: 0.3444 -> 0.3144   acc: 87.60% -> 89.00%             
client [17] (test)  loss: 0.8899 -> 0.8139   acc: 72.51% -> 71.43%             
client [54] (test)  loss: 0.7739 -> 0.9727   acc: 76.61% -> 69.93%             
client [23] (test)  loss: 45.6016 -> 0.3960   acc: 55.88% -> 87.45%            
client [35] (test)  loss: 0.7173 -> 0.6352   acc: 77.66% -> 79.48%             
client [59] (test)  loss: 0.7094 -> 0.7651   acc: 78.24% -> 76.36%             
client [31] (test)  loss: 0.0337 -> 0.0127   acc: 99.13% -> 99.83%             
client [9] (test)  loss: 0.6498 -> 0.8476   acc: 78.96% -> 72.25%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.7749 -> 0.7393   acc: 74.90% -> 77.45%             
client [33] (test)  loss: 0.7449 -> 0.5846   acc: 76.68% -> 84.97%             
client [16] (test)  loss: 0.3764 -> 0.3431   acc: 87.68% -> 88.80%             
client [44] (test)  loss: 1.0396 -> 0.2950   acc: 77.87% -> 91.46%             
client [8] (test)  loss: 0.4287 -> 0.3924   acc: 86.80% -> 88.31%              
client [31] (test)  loss: 0.0287 -> 0.0140   acc: 99.31% -> 99.83%             
client [47] (test)  loss: 0.1747 -> 0.1304   acc: 95.51% -> 95.79%             
client [36] (test)  loss: 0.9475 -> 0.9038   acc: 71.90% -> 71.07%             
client [20] (test)  loss: 0.7587 -> 0.6783   acc: 76.92% -> 80.77%             
client [56] (test)  loss: 0.7194 -> 0.8262   acc: 74.90% -> 71.91%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.7346 -> 0.6362   acc: 73.86% -> 80.23%              
client [60] (test)  loss: 0.6651 -> 0.5545   acc: 79.84% -> 81.05%             
client [28] (test)  loss: 0.8784 -> 0.8140   acc: 73.31% -> 75.56%             
client [25] (test)  loss: 0.7464 -> 0.7566   acc: 76.43% -> 76.25%             
client [58] (test)  loss: 0.5213 -> 0.5119   acc: 85.28% -> 86.60%             
client [44] (test)  loss: 0.3054 -> 0.2743   acc: 89.90% -> 91.46%             
client [39] (test)  loss: 0.4933 -> 0.4545   acc: 85.58% -> 85.58%             
client [29] (test)  loss: 0.6479 -> 0.4898   acc: 82.38% -> 85.90%             
client [3] (test)  loss: 0.5902 -> 0.6710   acc: 79.10% -> 75.48%              
client [84] (test)  loss: 0.6135 -> 0.5206   acc: 82.68% -> 84.36%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.3747 -> 0.3510   acc: 89.04% -> 90.58%             
client [84] (test)  loss: 0.5363 -> 0.4673   acc: 83.05% -> 86.41%             
client [10] (test)  loss: 0.5522 -> 0.4718   acc: 85.29% -> 87.10%             
client [36] (test)  loss: 0.8465 -> 0.8250   acc: 70.25% -> 76.03%             
client [65] (test)  loss: 0.3217 -> 0.2569   acc: 89.42% -> 91.62%             
client [81] (test)  loss: 0.5271 -> 0.5046   acc: 84.70% -> 85.79%             
client [79] (test)  loss: 0.7040 -> 0.7602   acc: 80.85% -> 77.23%             
client [42] (test)  loss: 0.4577 -> 0.3779   acc: 83.50% -> 88.56%             
client [11] (test)  loss: 0.3271 -> 0.3028   acc: 90.61% -> 90.42%             
client [96] (test)  loss: 0.5779 -> 0.6892   acc: 84.26% -> 83.33%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4955 -> 0.3824   acc: 85.06% -> 88.53%              
client [53] (test)  loss: 0.3296 -> 0.3733   acc: 88.94% -> 89.93%             
client [52] (test)  loss: 0.2938 -> 0.3103   acc: 92.04% -> 91.11%             
client [42] (test)  loss: 0.5561 -> 0.3953   acc: 79.25% -> 87.75%             
client [69] (test)  loss: 0.5713 -> 0.6357   acc: 81.60% -> 80.90%             
client [59] (test)  loss: 0.6323 -> 0.6157   acc: 80.75% -> 84.52%             
client [7] (test)  loss: 0.5480 -> 0.5251   acc: 87.33% -> 83.71%              
client [26] (test)  loss: 0.2866 -> 0.2662   acc: 92.17% -> 91.80%             
client [49] (test)  loss: 0.5305 -> 0.5078   acc: 83.90% -> 82.86%             
client [98] (test)  loss: 0.5506 -> 0.9638   acc: 84.91% -> 74.56%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5645 -> 0.9392   acc: 85.61% -> 76.49%             
client [47] (test)  loss: 0.1716 -> 0.1282   acc: 96.07% -> 95.93%             
client [21] (test)  loss: 0.3590 -> 0.3283   acc: 88.85% -> 90.96%             
client [77] (test)  loss: 0.6279 -> 0.6090   acc: 81.41% -> 81.76%             
client [95] (test)  loss: 0.2679 -> 0.1474   acc: 93.19% -> 96.11%             
client [91] (test)  loss: 0.6812 -> 0.6919   acc: 82.00% -> 80.05%             
client [14] (test)  loss: 0.2387 -> 0.2380   acc: 94.02% -> 93.42%             
client [99] (test)  loss: 0.5235 -> 0.3746   acc: 84.90% -> 90.20%             
client [20] (test)  loss: 0.6937 -> 0.6378   acc: 78.14% -> 82.39%             
client [39] (test)  loss: 0.4812 -> 0.3771   acc: 86.05% -> 87.94%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3060 -> 0.2950   acc: 91.42% -> 92.67%             
client [62] (test)  loss: 0.1649 -> 0.2391   acc: 94.54% -> 94.54%             
client [71] (test)  loss: 0.6932 -> 0.6517   acc: 79.04% -> 79.52%             
client [97] (test)  loss: 0.3479 -> 0.3668   acc: 88.32% -> 87.92%             
client [30] (test)  loss: 0.2564 -> 0.2179   acc: 91.82% -> 94.36%             
client [88] (test)  loss: 0.1885 -> 0.2111   acc: 93.76% -> 93.76%             
client [60] (test)  loss: 0.5083 -> 0.5250   acc: 85.48% -> 84.27%             
client [82] (test)  loss: 0.4638 -> 0.4642   acc: 85.90% -> 84.29%             
client [91] (test)  loss: 0.7291 -> 0.6842   acc: 80.78% -> 81.02%             
client [57] (test)  loss: 0.2092 -> 0.1840   acc: 93.00% -> 95.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.0495 -> 0.0142   acc: 98.09% -> 99.65%             
client [15] (test)  loss: 0.3964 -> 0.4320   acc: 88.01% -> 87.20%             
client [71] (test)  loss: 0.6585 -> 0.6631   acc: 80.48% -> 78.31%             
client [97] (test)  loss: 0.3361 -> 0.3705   acc: 87.33% -> 88.51%             
client [53] (test)  loss: 0.3122 -> 0.3536   acc: 89.19% -> 90.42%             
client [77] (test)  loss: 0.5392 -> 0.5883   acc: 84.51% -> 82.79%             
client [76] (test)  loss: 0.3558 -> 0.3504   acc: 89.41% -> 88.96%             
client [79] (test)  loss: 0.8081 -> 0.7034   acc: 77.87% -> 81.49%             
client [28] (test)  loss: 0.7117 -> 0.7120   acc: 79.42% -> 79.42%             
client [99] (test)  loss: 0.6621 -> 0.3613   acc: 81.57% -> 90.98%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3048 -> 0.3601   acc: 89.31% -> 88.91%             
client [86] (test)  loss: 0.3742 -> 0.3976   acc: 89.13% -> 88.54%             
client [34] (test)  loss: 0.7254 -> 0.7246   acc: 81.61% -> 81.94%             
client [73] (test)  loss: 0.3283 -> 0.3538   acc: 89.80% -> 89.41%             
client [5] (test)  loss: 0.2368 -> 0.2494   acc: 94.00% -> 92.00%              
client [96] (test)  loss: 0.5921 -> 0.7931   acc: 84.63% -> 85.74%             
client [22] (test)  loss: 0.6975 -> 0.7364   acc: 80.80% -> 79.17%             
client [60] (test)  loss: 0.5501 -> 0.5499   acc: 84.68% -> 84.68%             
client [66] (test)  loss: 0.0342 -> 0.0289   acc: 98.61% -> 99.31%             
client [83] (test)  loss: 0.5084 -> 0.4644   acc: 85.05% -> 85.66%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.3543 -> 0.3581   acc: 90.47% -> 89.71%             
client [65] (test)  loss: 0.2944 -> 0.2491   acc: 90.22% -> 92.42%             
client [95] (test)  loss: 0.3302 -> 0.1303   acc: 93.19% -> 95.53%             
client [17] (test)  loss: 0.5156 -> 0.5854   acc: 84.37% -> 81.13%             
client [8] (test)  loss: 0.4542 -> 0.3658   acc: 87.66% -> 88.96%              
client [35] (test)  loss: 0.4138 -> 0.4702   acc: 88.57% -> 87.01%             
client [98] (test)  loss: 0.5713 -> 0.7401   acc: 85.61% -> 81.58%             
client [53] (test)  loss: 0.3287 -> 0.3447   acc: 90.17% -> 89.93%             
client [43] (test)  loss: 0.8907 -> 0.8875   acc: 74.57% -> 76.28%             
client [64] (test)  loss: 0.6122 -> 0.6419   acc: 83.33% -> 83.92%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.3510 -> 0.3291   acc: 89.81% -> 90.58%             
client [88] (test)  loss: 0.1778 -> 0.2041   acc: 95.60% -> 94.50%             
client [38] (test)  loss: 0.3522 -> 0.2879   acc: 90.74% -> 92.35%             
client [3] (test)  loss: 0.5886 -> 0.5034   acc: 81.24% -> 82.73%              
client [5] (test)  loss: 0.2506 -> 0.2436   acc: 94.00% -> 93.20%              
client [41] (test)  loss: 0.4410 -> 0.5040   acc: 87.78% -> 88.25%             
client [7] (test)  loss: 0.5019 -> 0.4748   acc: 87.48% -> 87.33%              
client [37] (test)  loss: 0.7096 -> 0.6801   acc: 80.35% -> 81.21%             
client [45] (test)  loss: 0.4790 -> 0.5286   acc: 83.96% -> 84.34%             
client [47] (test)  loss: 0.1618 -> 0.1153   acc: 96.35% -> 96.91%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3271 -> 0.3066   acc: 90.20% -> 91.32%             
client [11] (test)  loss: 0.2841 -> 0.3112   acc: 92.08% -> 91.71%             
client [37] (test)  loss: 0.6186 -> 0.6820   acc: 83.37% -> 81.21%             
client [41] (test)  loss: 0.4114 -> 0.4878   acc: 87.78% -> 88.10%             
client [95] (test)  loss: 0.3100 -> 0.1184   acc: 93.00% -> 96.50%             
client [53] (test)  loss: 0.3280 -> 0.3441   acc: 89.93% -> 89.93%             
client [22] (test)  loss: 0.7161 -> 0.7214   acc: 82.43% -> 81.88%             
client [25] (test)  loss: 0.5715 -> 0.5665   acc: 83.57% -> 82.50%             
client [69] (test)  loss: 0.6012 -> 0.5857   acc: 83.33% -> 84.03%             
client [46] (test)  loss: 0.6232 -> 0.5926   acc: 83.91% -> 83.18%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.1383 -> 0.1259   acc: 96.21% -> 96.35%             
client [69] (test)  loss: 0.6461 -> 0.5991   acc: 81.94% -> 83.33%             
client [82] (test)  loss: 0.5144 -> 0.4781   acc: 84.94% -> 86.86%             
client [45] (test)  loss: 0.4647 -> 0.5147   acc: 83.02% -> 83.02%             
client [7] (test)  loss: 0.6847 -> 0.4918   acc: 82.65% -> 86.43%              
client [50] (test)  loss: 0.5470 -> 0.4992   acc: 82.60% -> 86.74%             
client [35] (test)  loss: 0.4411 -> 0.4750   acc: 87.53% -> 87.01%             
client [24] (test)  loss: 0.2795 -> 0.2360   acc: 92.40% -> 93.80%             
client [15] (test)  loss: 0.4751 -> 0.4484   acc: 86.79% -> 88.14%             
client [58] (test)  loss: 0.4863 -> 0.4846   acc: 87.17% -> 88.49%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6127 -> 0.6688   acc: 84.11% -> 84.11%             
client [76] (test)  loss: 0.3648 -> 0.3704   acc: 90.17% -> 90.02%             
client [67] (test)  loss: 0.3600 -> 0.3519   acc: 89.42% -> 89.42%             
client [37] (test)  loss: 0.7073 -> 0.6608   acc: 80.78% -> 83.59%             
client [58] (test)  loss: 0.4679 -> 0.4809   acc: 86.98% -> 87.74%             
client [64] (test)  loss: 0.6655 -> 0.6366   acc: 82.55% -> 83.73%             
client [77] (test)  loss: 0.5748 -> 0.5805   acc: 82.44% -> 83.99%             
client [55] (test)  loss: 0.4539 -> 0.4455   acc: 89.29% -> 90.21%             
client [12] (test)  loss: 0.1505 -> 0.1768   acc: 95.21% -> 95.04%             
client [89] (test)  loss: 0.6351 -> 0.6059   acc: 81.97% -> 83.94%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4829 -> 0.3933   acc: 87.71% -> 90.88%             
client [51] (test)  loss: 0.6941 -> 0.6383   acc: 83.03% -> 87.27%             
client [8] (test)  loss: 0.4215 -> 0.3912   acc: 89.18% -> 88.53%              
client [18] (test)  loss: 0.5204 -> 0.5043   acc: 87.03% -> 87.82%             
client [94] (test)  loss: 0.3162 -> 0.3643   acc: 92.24% -> 92.07%             
client [81] (test)  loss: 0.4875 -> 0.4425   acc: 86.52% -> 87.61%             
client [3] (test)  loss: 0.5842 -> 0.4937   acc: 82.09% -> 83.80%              
client [11] (test)  loss: 0.2844 -> 0.2956   acc: 90.61% -> 91.34%             
client [95] (test)  loss: 0.2033 -> 0.1125   acc: 95.72% -> 97.28%             
client [67] (test)  loss: 0.3736 -> 0.3534   acc: 88.02% -> 90.22%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.3361 -> 0.3461   acc: 91.15% -> 90.77%             
client [79] (test)  loss: 0.8004 -> 0.7220   acc: 81.91% -> 82.34%             
client [58] (test)  loss: 0.4673 -> 0.4819   acc: 87.36% -> 88.30%             
client [88] (test)  loss: 0.2070 -> 0.2110   acc: 94.50% -> 94.13%             
client [46] (test)  loss: 0.6474 -> 0.6160   acc: 85.17% -> 84.09%             
client [11] (test)  loss: 0.3491 -> 0.3213   acc: 90.24% -> 91.90%             
client [55] (test)  loss: 0.4986 -> 0.4908   acc: 89.75% -> 90.43%             
client [13] (test)  loss: 0.5764 -> 0.5675   acc: 83.68% -> 82.30%             
client [31] (test)  loss: 0.0368 -> 0.0081   acc: 98.79% -> 99.83%             
client [75] (test)  loss: 0.4596 -> 0.4721   acc: 87.29% -> 86.61%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.2958 -> 0.3163   acc: 91.50% -> 90.96%             
client [7] (test)  loss: 0.6587 -> 0.4820   acc: 84.16% -> 88.24%              
client [57] (test)  loss: 0.1595 -> 0.1947   acc: 95.00% -> 95.40%             
client [13] (test)  loss: 0.6608 -> 0.6056   acc: 83.22% -> 81.61%             
client [43] (test)  loss: 0.9812 -> 0.8947   acc: 77.02% -> 78.24%             
client [91] (test)  loss: 0.7357 -> 0.7005   acc: 82.48% -> 81.75%             
client [10] (test)  loss: 0.5771 -> 0.4840   acc: 88.69% -> 88.91%             
client [64] (test)  loss: 0.6767 -> 0.6304   acc: 83.53% -> 85.29%             
client [82] (test)  loss: 0.4706 -> 0.4711   acc: 86.86% -> 88.14%             
client [22] (test)  loss: 0.6826 -> 0.7547   acc: 84.96% -> 83.15%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7320 -> 0.6251   acc: 83.60% -> 82.59%             
client [23] (test)  loss: 0.3782 -> 0.3420   acc: 90.39% -> 90.98%             
client [88] (test)  loss: 0.2448 -> 0.1987   acc: 93.76% -> 95.05%             
client [98] (test)  loss: 0.5741 -> 0.6947   acc: 86.84% -> 85.09%             
client [79] (test)  loss: 0.8812 -> 0.7599   acc: 80.85% -> 82.34%             
client [21] (test)  loss: 0.3445 -> 0.3391   acc: 90.38% -> 91.15%             
client [92] (test)  loss: 0.4153 -> 0.3855   acc: 90.53% -> 92.31%             
client [56] (test)  loss: 0.7570 -> 0.6466   acc: 80.48% -> 84.06%             
client [5] (test)  loss: 0.2533 -> 0.2407   acc: 93.60% -> 93.20%              
client [52] (test)  loss: 0.3159 -> 0.3120   acc: 91.42% -> 92.36%             
==================== FedPer_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.4378 -> 0.0000', 'accuracy': '87.28% -> 0.00%'},          
    200: {'loss': '0.4772 -> 0.0000', 'accuracy': '88.21% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_0.5 achieved 10.0%(13.40%) at epoch: 0                                  
FedPer_0.5 achieved 20.0%(25.17%) at epoch: 1                                  
FedPer_0.5 achieved 30.0%(34.54%) at epoch: 4                                  
FedPer_0.5 achieved 40.0%(47.10%) at epoch: 7                                  
FedPer_0.5 achieved 50.0%(59.03%) at epoch: 9                                  
FedPer_0.5 achieved 60.0%(69.49%) at epoch: 12                                 
FedPer_0.5 achieved 70.0%(73.49%) at epoch: 16                                 
FedPer_0.5 achieved 80.0%(83.11%) at epoch: 28                                 
FedPer_0.5 achieved 90.0%(91.35%) at epoch: 53                                 
Convergence (test_after):                                                      
FedPer_0.5 achieved 50.0%(52.11%) at epoch: 0                                  
FedPer_0.5 achieved 60.0%(63.19%) at epoch: 8                                  
FedPer_0.5 achieved 70.0%(75.07%) at epoch: 12                                 
FedPer_0.5 achieved 80.0%(80.23%) at epoch: 19                                 
FedPer_0.5 achieved 90.0%(91.89%) at epoch: 53                                 
