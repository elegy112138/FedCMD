==================== ALGORITHM: FedPer_0.5 ====================                
Experiment Arguments:                                                          
{                                                                              
    'model': 'ModifiedLeNet5',                                                 
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.5,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.9166 -> 0.7014   acc: 73.43% -> 79.23%             
client [81] (test)  loss: 0.5002 -> 0.3313   acc: 83.26% -> 88.99%             
client [21] (test)  loss: 2.3552 -> 1.3877   acc: 11.53% -> 50.51%             
client [68] (test)  loss: 1.1548 -> 0.7317   acc: 68.93% -> 78.32%             
client [93] (test)  loss: 0.7048 -> 0.6609   acc: 82.09% -> 82.46%             
client [31] (test)  loss: 1.4825 -> 0.8018   acc: 57.97% -> 80.00%             
client [20] (test)  loss: 1.1294 -> 0.9427   acc: 68.60% -> 72.73%             
client [59] (test)  loss: 2.2127 -> 0.5659   acc: 38.94% -> 83.50%             
client [48] (test)  loss: 1.0339 -> 0.7478   acc: 67.65% -> 78.07%             
client [34] (test)  loss: 1.0430 -> 0.7446   acc: 70.49% -> 81.64%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.0082 -> 0.6890   acc: 64.96% -> 75.21%             
client [99] (test)  loss: 1.0093 -> 0.6204   acc: 78.23% -> 87.90%             
client [67] (test)  loss: 0.7595 -> 0.5990   acc: 78.80% -> 81.01%             
client [0] (test)  loss: 0.5578 -> 0.5010   acc: 81.82% -> 85.65%              
client [76] (test)  loss: 0.7299 -> 0.6563   acc: 76.21% -> 79.31%             
client [41] (test)  loss: 1.0594 -> 0.9895   acc: 59.67% -> 67.22%             
client [62] (test)  loss: 2.2562 -> 0.2878   acc: 29.12% -> 90.66%             
client [2] (test)  loss: 2.1357 -> 1.1986   acc: 18.88% -> 52.04%              
client [14] (test)  loss: 0.7743 -> 0.6177   acc: 81.40% -> 81.40%             
client [46] (test)  loss: 0.9253 -> 0.7513   acc: 73.05% -> 76.65%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.7009 -> 0.6051   acc: 78.12% -> 79.91%             
client [68] (test)  loss: 0.5107 -> 0.3292   acc: 81.55% -> 89.97%             
client [57] (test)  loss: 0.3985 -> 0.3229   acc: 89.78% -> 87.90%             
client [17] (test)  loss: 0.4764 -> 0.3741   acc: 86.62% -> 88.85%             
client [54] (test)  loss: 0.4380 -> 0.3403   acc: 86.67% -> 89.84%             
client [23] (test)  loss: 2.8058 -> 0.5758   acc: 4.04% -> 82.32%              
client [35] (test)  loss: 0.7015 -> 0.6384   acc: 76.15% -> 77.06%             
client [59] (test)  loss: 0.3895 -> 0.3347   acc: 87.46% -> 87.13%             
client [31] (test)  loss: 0.4547 -> 0.4234   acc: 85.42% -> 86.10%             
client [9] (test)  loss: 0.5799 -> 0.5410   acc: 84.17% -> 83.33%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5927 -> 0.5016   acc: 79.46% -> 84.50%             
client [33] (test)  loss: 0.4692 -> 0.4298   acc: 88.36% -> 89.42%             
client [16] (test)  loss: 0.6333 -> 0.6651   acc: 78.12% -> 77.34%             
client [44] (test)  loss: 0.3208 -> 0.0949   acc: 90.12% -> 96.91%             
client [8] (test)  loss: 0.4699 -> 0.3338   acc: 84.38% -> 89.06%              
client [31] (test)  loss: 0.4367 -> 0.3747   acc: 86.44% -> 86.78%             
client [47] (test)  loss: 0.3024 -> 0.2701   acc: 88.08% -> 90.07%             
client [36] (test)  loss: 0.3544 -> 0.3095   acc: 90.97% -> 90.03%             
client [20] (test)  loss: 0.6007 -> 0.5339   acc: 80.17% -> 83.47%             
client [56] (test)  loss: 0.3766 -> 0.3367   acc: 85.68% -> 88.59%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5228 -> 0.4913   acc: 85.66% -> 85.25%              
client [60] (test)  loss: 0.3496 -> 0.3005   acc: 90.00% -> 90.00%             
client [28] (test)  loss: 0.3355 -> 0.3205   acc: 90.20% -> 91.50%             
client [25] (test)  loss: 0.4633 -> 0.4235   acc: 85.51% -> 87.85%             
client [58] (test)  loss: 0.3186 -> 0.2850   acc: 89.81% -> 92.90%             
client [44] (test)  loss: 0.1363 -> 0.0749   acc: 95.99% -> 97.22%             
client [39] (test)  loss: 0.4461 -> 0.4121   acc: 85.59% -> 86.02%             
client [29] (test)  loss: 0.7752 -> 0.3824   acc: 77.89% -> 85.81%             
client [3] (test)  loss: 0.4611 -> 0.4011   acc: 85.11% -> 87.38%              
client [84] (test)  loss: 0.7834 -> 0.7179   acc: 69.71% -> 72.64%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2283 -> 0.7644   acc: 64.07% -> 77.29%             
client [84] (test)  loss: 0.7344 -> 0.6797   acc: 71.99% -> 75.24%             
client [10] (test)  loss: 0.1381 -> 0.1000   acc: 94.92% -> 96.47%             
client [36] (test)  loss: 0.3177 -> 0.2321   acc: 90.34% -> 92.83%             
client [65] (test)  loss: 0.4198 -> 0.4193   acc: 86.18% -> 85.37%             
client [81] (test)  loss: 0.1973 -> 0.1392   acc: 92.73% -> 96.04%             
client [79] (test)  loss: 0.2403 -> 0.1953   acc: 92.31% -> 93.08%             
client [42] (test)  loss: 0.4956 -> 0.3039   acc: 81.19% -> 88.53%             
client [11] (test)  loss: 0.5825 -> 0.4057   acc: 80.52% -> 86.15%             
client [96] (test)  loss: 0.3673 -> 0.2460   acc: 89.69% -> 92.75%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3903 -> 0.2867   acc: 86.98% -> 91.41%              
client [53] (test)  loss: 0.8446 -> 0.3826   acc: 65.70% -> 86.92%             
client [52] (test)  loss: 0.4025 -> 0.3555   acc: 87.54% -> 86.56%             
client [42] (test)  loss: 0.3343 -> 0.2815   acc: 87.39% -> 89.68%             
client [69] (test)  loss: 0.5284 -> 0.3474   acc: 83.19% -> 88.32%             
client [59] (test)  loss: 0.3701 -> 0.2580   acc: 86.47% -> 89.44%             
client [7] (test)  loss: 0.2215 -> 0.2063   acc: 93.11% -> 93.11%              
client [26] (test)  loss: 0.1177 -> 0.0642   acc: 96.68% -> 98.79%             
client [49] (test)  loss: 0.5691 -> 0.5368   acc: 78.72% -> 80.00%             
client [98] (test)  loss: 0.5518 -> 0.4856   acc: 78.07% -> 82.46%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5754 -> 0.4525   acc: 79.82% -> 83.63%             
client [47] (test)  loss: 0.3007 -> 0.2268   acc: 90.07% -> 92.05%             
client [21] (test)  loss: 0.7101 -> 0.7032   acc: 79.32% -> 78.64%             
client [77] (test)  loss: 0.2985 -> 0.2329   acc: 90.34% -> 93.72%             
client [95] (test)  loss: 0.2719 -> 0.2880   acc: 88.60% -> 88.97%             
client [91] (test)  loss: 0.3018 -> 0.3047   acc: 88.11% -> 89.43%             
client [14] (test)  loss: 0.4929 -> 0.3504   acc: 88.37% -> 90.70%             
client [99] (test)  loss: 0.4667 -> 0.4110   acc: 87.10% -> 90.32%             
client [20] (test)  loss: 0.5623 -> 0.3803   acc: 80.17% -> 88.43%             
client [39] (test)  loss: 0.4387 -> 0.3637   acc: 83.90% -> 88.98%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.3699 -> 0.3454   acc: 87.54% -> 86.56%             
client [62] (test)  loss: 0.1117 -> 0.0691   acc: 96.15% -> 96.98%             
client [71] (test)  loss: 0.2859 -> 0.2357   acc: 92.78% -> 92.78%             
client [97] (test)  loss: 0.4417 -> 0.1986   acc: 86.32% -> 94.10%             
client [30] (test)  loss: 0.2886 -> 0.2213   acc: 88.51% -> 90.88%             
client [88] (test)  loss: 0.4082 -> 0.2820   acc: 88.02% -> 91.71%             
client [60] (test)  loss: 0.2366 -> 0.2215   acc: 94.17% -> 92.92%             
client [82] (test)  loss: 0.6079 -> 0.6711   acc: 81.79% -> 77.15%             
client [91] (test)  loss: 0.3157 -> 0.2885   acc: 89.87% -> 89.87%             
client [57] (test)  loss: 0.2572 -> 0.1727   acc: 89.78% -> 94.89%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4032 -> 0.2989   acc: 89.83% -> 92.54%             
client [15] (test)  loss: 0.2577 -> 0.1456   acc: 92.70% -> 95.35%             
client [71] (test)  loss: 0.2877 -> 0.2363   acc: 92.78% -> 93.81%             
client [97] (test)  loss: 0.3461 -> 0.1948   acc: 89.62% -> 94.34%             
client [53] (test)  loss: 0.7007 -> 0.3628   acc: 73.26% -> 88.95%             
client [77] (test)  loss: 0.2515 -> 0.2186   acc: 92.27% -> 92.75%             
client [76] (test)  loss: 0.3372 -> 0.3383   acc: 89.31% -> 88.62%             
client [79] (test)  loss: 0.2930 -> 0.1412   acc: 90.00% -> 94.62%             
client [28] (test)  loss: 0.2432 -> 0.2154   acc: 93.46% -> 92.81%             
client [99] (test)  loss: 0.4627 -> 0.4220   acc: 87.10% -> 88.71%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.3813 -> 0.1890   acc: 88.92% -> 94.34%             
client [86] (test)  loss: 0.4973 -> 0.4126   acc: 86.60% -> 89.18%             
client [34] (test)  loss: 0.3761 -> 0.2665   acc: 85.90% -> 91.48%             
client [73] (test)  loss: 0.0506 -> 0.0510   acc: 98.80% -> 98.80%             
client [5] (test)  loss: 0.2661 -> 0.2543   acc: 90.33% -> 91.82%              
client [96] (test)  loss: 0.2281 -> 0.2026   acc: 93.40% -> 94.20%             
client [22] (test)  loss: 0.2938 -> 0.2751   acc: 88.28% -> 92.05%             
client [60] (test)  loss: 0.2254 -> 0.2018   acc: 91.67% -> 93.33%             
client [66] (test)  loss: 0.3150 -> 0.2364   acc: 89.78% -> 92.47%             
client [83] (test)  loss: 0.1050 -> 0.0710   acc: 97.29% -> 98.03%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4355 -> 0.3351   acc: 86.21% -> 88.97%             
client [65] (test)  loss: 0.3586 -> 0.3292   acc: 86.99% -> 89.02%             
client [95] (test)  loss: 0.3105 -> 0.2883   acc: 89.71% -> 90.07%             
client [17] (test)  loss: 0.3136 -> 0.2755   acc: 91.82% -> 92.57%             
client [8] (test)  loss: 0.3757 -> 0.2368   acc: 89.32% -> 92.71%              
client [35] (test)  loss: 0.4973 -> 0.3774   acc: 83.94% -> 88.53%             
client [98] (test)  loss: 0.5847 -> 0.3889   acc: 81.29% -> 86.84%             
client [53] (test)  loss: 0.6089 -> 0.3542   acc: 78.78% -> 88.95%             
client [43] (test)  loss: 0.1780 -> 0.1190   acc: 94.44% -> 96.21%             
client [64] (test)  loss: 0.4107 -> 0.3440   acc: 85.27% -> 86.43%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6210 -> 0.6463   acc: 80.68% -> 83.39%             
client [88] (test)  loss: 0.3279 -> 0.2621   acc: 89.40% -> 91.71%             
client [38] (test)  loss: 0.1952 -> 0.2165   acc: 94.62% -> 94.09%             
client [3] (test)  loss: 0.2687 -> 0.2579   acc: 87.38% -> 91.26%              
client [5] (test)  loss: 0.2868 -> 0.2560   acc: 90.71% -> 91.45%              
client [41] (test)  loss: 0.6055 -> 0.4041   acc: 83.49% -> 87.26%             
client [7] (test)  loss: 0.1501 -> 0.1482   acc: 96.07% -> 95.08%              
client [37] (test)  loss: 0.2036 -> 0.1778   acc: 93.88% -> 94.60%             
client [45] (test)  loss: 0.4194 -> 0.2385   acc: 84.28% -> 91.64%             
client [47] (test)  loss: 0.3988 -> 0.1913   acc: 89.07% -> 93.05%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4407 -> 0.4625   acc: 85.16% -> 85.16%             
client [11] (test)  loss: 0.3826 -> 0.3717   acc: 86.80% -> 88.96%             
client [37] (test)  loss: 0.2382 -> 0.1816   acc: 92.45% -> 94.96%             
client [41] (test)  loss: 0.4703 -> 0.3916   acc: 87.26% -> 87.50%             
client [95] (test)  loss: 0.2785 -> 0.2827   acc: 89.71% -> 91.91%             
client [53] (test)  loss: 0.6489 -> 0.3653   acc: 79.07% -> 88.95%             
client [22] (test)  loss: 0.2926 -> 0.2632   acc: 89.54% -> 92.47%             
client [25] (test)  loss: 0.3166 -> 0.1699   acc: 90.19% -> 95.33%             
client [69] (test)  loss: 0.3777 -> 0.3194   acc: 90.03% -> 91.17%             
client [46] (test)  loss: 0.3126 -> 0.2844   acc: 89.82% -> 90.42%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.2217 -> 0.1844   acc: 91.72% -> 94.04%             
client [69] (test)  loss: 0.3676 -> 0.3147   acc: 88.89% -> 91.45%             
client [82] (test)  loss: 0.6131 -> 0.6045   acc: 79.14% -> 82.78%             
client [45] (test)  loss: 0.4487 -> 0.2379   acc: 83.95% -> 91.64%             
client [7] (test)  loss: 0.1311 -> 0.1491   acc: 95.41% -> 95.74%              
client [50] (test)  loss: 0.3113 -> 0.2838   acc: 89.90% -> 91.75%             
client [35] (test)  loss: 0.5299 -> 0.3580   acc: 84.17% -> 90.14%             
client [24] (test)  loss: 0.3465 -> 0.2775   acc: 87.95% -> 89.73%             
client [15] (test)  loss: 0.3167 -> 0.1234   acc: 90.27% -> 95.35%             
client [58] (test)  loss: 0.2380 -> 0.2187   acc: 93.21% -> 94.14%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.3542 -> 0.3155   acc: 90.91% -> 90.64%             
client [76] (test)  loss: 0.4076 -> 0.3231   acc: 88.28% -> 90.00%             
client [67] (test)  loss: 0.4595 -> 0.2919   acc: 85.13% -> 89.87%             
client [37] (test)  loss: 0.2153 -> 0.1776   acc: 93.88% -> 94.60%             
client [58] (test)  loss: 0.2779 -> 0.2143   acc: 92.28% -> 94.44%             
client [64] (test)  loss: 0.7183 -> 0.3080   acc: 77.52% -> 87.98%             
client [77] (test)  loss: 0.3061 -> 0.2057   acc: 91.30% -> 92.75%             
client [55] (test)  loss: 0.1123 -> 0.0919   acc: 96.34% -> 97.65%             
client [12] (test)  loss: 0.4507 -> 0.3638   acc: 86.73% -> 88.78%             
client [89] (test)  loss: 0.4709 -> 0.4475   acc: 85.39% -> 86.89%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.6988 -> 0.5778   acc: 77.52% -> 83.06%             
client [51] (test)  loss: 0.4623 -> 0.4951   acc: 83.33% -> 83.95%             
client [8] (test)  loss: 0.3262 -> 0.2119   acc: 91.67% -> 94.01%              
client [18] (test)  loss: 0.3391 -> 0.2158   acc: 91.21% -> 93.64%             
client [94] (test)  loss: 0.1382 -> 0.0889   acc: 95.10% -> 98.04%             
client [81] (test)  loss: 0.1075 -> 0.1198   acc: 96.70% -> 96.26%             
client [3] (test)  loss: 0.2505 -> 0.2317   acc: 89.97% -> 90.94%              
client [11] (test)  loss: 0.3262 -> 0.3707   acc: 90.69% -> 90.04%             
client [95] (test)  loss: 0.2863 -> 0.2839   acc: 91.18% -> 91.54%             
client [67] (test)  loss: 0.4746 -> 0.2748   acc: 85.13% -> 92.09%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7056 -> 0.6712   acc: 81.36% -> 84.07%             
client [79] (test)  loss: 0.2456 -> 0.1550   acc: 94.62% -> 95.38%             
client [58] (test)  loss: 0.2610 -> 0.2214   acc: 93.21% -> 94.14%             
client [88] (test)  loss: 0.3616 -> 0.2436   acc: 87.56% -> 92.63%             
client [46] (test)  loss: 0.3079 -> 0.2799   acc: 88.62% -> 88.62%             
client [11] (test)  loss: 0.3599 -> 0.3674   acc: 90.04% -> 90.91%             
client [55] (test)  loss: 0.1249 -> 0.0932   acc: 95.30% -> 97.65%             
client [13] (test)  loss: 0.1726 -> 0.1224   acc: 94.71% -> 96.47%             
client [31] (test)  loss: 0.3899 -> 0.2799   acc: 90.17% -> 93.56%             
client [75] (test)  loss: 0.1044 -> 0.0595   acc: 97.42% -> 98.59%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5498 -> 0.4585   acc: 84.72% -> 88.65%             
client [7] (test)  loss: 0.1344 -> 0.1484   acc: 95.41% -> 96.39%              
client [57] (test)  loss: 0.1297 -> 0.1302   acc: 95.70% -> 96.77%             
client [13] (test)  loss: 0.1232 -> 0.1168   acc: 96.47% -> 96.98%             
client [43] (test)  loss: 0.1801 -> 0.1301   acc: 95.71% -> 96.72%             
client [91] (test)  loss: 0.3693 -> 0.2311   acc: 86.78% -> 90.75%             
client [10] (test)  loss: 0.0837 -> 0.0864   acc: 96.91% -> 96.47%             
client [64] (test)  loss: 0.3150 -> 0.3070   acc: 88.37% -> 86.82%             
client [82] (test)  loss: 0.6890 -> 0.5936   acc: 78.15% -> 83.44%             
client [22] (test)  loss: 0.3650 -> 0.2513   acc: 88.70% -> 92.05%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3742 -> 0.2254   acc: 88.43% -> 94.21%             
client [23] (test)  loss: 0.4736 -> 0.3737   acc: 85.86% -> 89.90%             
client [88] (test)  loss: 0.2897 -> 0.2487   acc: 92.17% -> 91.71%             
client [98] (test)  loss: 0.6110 -> 0.3554   acc: 79.53% -> 87.72%             
client [79] (test)  loss: 0.2149 -> 0.1461   acc: 95.38% -> 95.38%             
client [21] (test)  loss: 0.7510 -> 0.6951   acc: 80.34% -> 83.73%             
client [92] (test)  loss: 0.5898 -> 0.5113   acc: 82.86% -> 86.29%             
client [56] (test)  loss: 0.3390 -> 0.1883   acc: 90.72% -> 94.69%             
client [5] (test)  loss: 0.3102 -> 0.2775   acc: 91.45% -> 92.57%              
client [52] (test)  loss: 0.4721 -> 0.3370   acc: 84.59% -> 87.87%             
==================== FedPer_0.5 TEST RESULTS: ====================             
{                                                                              
    100: {'loss': '0.3591 -> 0.0000', 'accuracy': '88.27% -> 0.00%'},          
    200: {'loss': '0.3394 -> 0.0000', 'accuracy': '90.02% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_0.5 achieved 10.0%(13.73%) at epoch: 0                                  
FedPer_0.5 achieved 30.0%(31.80%) at epoch: 1                                  
FedPer_0.5 achieved 40.0%(46.81%) at epoch: 3                                  
FedPer_0.5 achieved 50.0%(52.11%) at epoch: 4                                  
FedPer_0.5 achieved 60.0%(62.67%) at epoch: 9                                  
FedPer_0.5 achieved 70.0%(71.34%) at epoch: 16                                 
FedPer_0.5 achieved 80.0%(80.50%) at epoch: 27                                 
FedPer_0.5 achieved 90.0%(90.26%) at epoch: 76                                 
Convergence (test_after):                                                      
FedPer_0.5 achieved 50.0%(59.82%) at epoch: 0                                  
FedPer_0.5 achieved 60.0%(60.67%) at epoch: 2                                  
FedPer_0.5 achieved 70.0%(70.93%) at epoch: 3                                  
FedPer_0.5 achieved 80.0%(81.33%) at epoch: 16                                 
FedPer_0.5 achieved 90.0%(90.94%) at epoch: 42                                 
