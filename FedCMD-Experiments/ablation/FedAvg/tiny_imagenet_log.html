==================== ALGORITHM: FedAvg ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.3029 -> 3.4541   acc: 0.86% -> 8.76%               
client [81] (test)  loss: 5.1925 -> 3.3157   acc: 2.67% -> 14.77%              
client [21] (test)  loss: 5.3432 -> 3.2869   acc: 2.00% -> 26.20%              
client [68] (test)  loss: 5.6125 -> 3.5158   acc: 0.49% -> 15.93%              
client [93] (test)  loss: 5.3274 -> 3.3032   acc: 0.74% -> 21.51%              
client [31] (test)  loss: 6.0228 -> 2.8218   acc: 1.22% -> 33.80%              
client [20] (test)  loss: 4.8650 -> 3.6361   acc: 7.27% -> 11.59%              
client [59] (test)  loss: 5.2567 -> 3.3734   acc: 0.70% -> 14.96%              
client [48] (test)  loss: 5.1932 -> 3.2104   acc: 2.41% -> 30.85%              
client [34] (test)  loss: 5.0230 -> 3.4396   acc: 2.78% -> 18.33%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.7159 -> 3.5836   acc: 0.27% -> 12.77%              
client [99] (test)  loss: 5.2893 -> 3.9988   acc: 2.25% -> 13.91%              
client [67] (test)  loss: 5.0463 -> 3.0528   acc: 1.59% -> 22.05%              
client [0] (test)  loss: 4.9600 -> 3.3207   acc: 6.27% -> 18.64%               
client [76] (test)  loss: 5.0814 -> 3.2417   acc: 2.73% -> 18.18%              
client [41] (test)  loss: 4.9817 -> 2.9776   acc: 2.14% -> 26.51%              
client [62] (test)  loss: 5.2908 -> 3.7538   acc: 1.20% -> 9.74%               
client [2] (test)  loss: 5.2118 -> 3.0006   acc: 1.30% -> 23.91%               
client [14] (test)  loss: 4.9881 -> 2.8266   acc: 1.07% -> 29.00%              
client [46] (test)  loss: 4.8223 -> 3.6740   acc: 3.60% -> 13.69%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.6646 -> 3.0469   acc: 3.84% -> 24.38%              
client [68] (test)  loss: 5.2013 -> 3.1606   acc: 2.60% -> 25.85%              
client [57] (test)  loss: 4.8708 -> 3.4512   acc: 6.36% -> 19.27%              
client [17] (test)  loss: 6.3982 -> 2.7303   acc: 1.11% -> 28.28%              
client [54] (test)  loss: 5.0340 -> 3.1934   acc: 3.09% -> 23.92%              
client [23] (test)  loss: 5.0814 -> 2.6752   acc: 3.01% -> 32.04%              
client [35] (test)  loss: 5.3178 -> 3.0275   acc: 3.41% -> 19.68%              
client [59] (test)  loss: 5.0282 -> 3.1202   acc: 1.58% -> 22.36%              
client [31] (test)  loss: 4.4045 -> 2.4404   acc: 6.97% -> 39.90%              
client [9] (test)  loss: 4.5742 -> 3.7821   acc: 9.27% -> 18.00%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.0502 -> 2.9128   acc: 3.80% -> 31.85%              
client [33] (test)  loss: 4.6365 -> 3.1203   acc: 8.18% -> 27.05%              
client [16] (test)  loss: 4.6543 -> 2.9936   acc: 5.83% -> 27.69%              
client [44] (test)  loss: 9.1977 -> 2.8613   acc: 2.74% -> 28.02%              
client [8] (test)  loss: 4.9209 -> 2.7272   acc: 3.66% -> 35.77%               
client [31] (test)  loss: 4.8927 -> 2.4215   acc: 5.05% -> 43.21%              
client [47] (test)  loss: 5.4358 -> 2.1571   acc: 3.07% -> 47.02%              
client [36] (test)  loss: 4.4101 -> 2.2918   acc: 11.96% -> 40.76%             
client [20] (test)  loss: 4.8234 -> 2.9866   acc: 7.44% -> 25.26%              
client [56] (test)  loss: 5.1362 -> 3.2469   acc: 4.09% -> 19.93%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 5.3691 -> 3.1788   acc: 1.99% -> 26.76%               
client [60] (test)  loss: 5.6809 -> 2.6592   acc: 3.45% -> 36.00%              
client [28] (test)  loss: 5.2223 -> 2.7181   acc: 6.33% -> 32.19%              
client [25] (test)  loss: 6.1203 -> 3.0801   acc: 6.09% -> 27.83%              
client [58] (test)  loss: 4.8809 -> 2.8994   acc: 5.12% -> 29.51%              
client [44] (test)  loss: 4.7804 -> 2.7814   acc: 6.92% -> 32.37%              
client [39] (test)  loss: 5.2029 -> 3.1303   acc: 3.96% -> 25.74%              
client [29] (test)  loss: 5.0051 -> 2.7548   acc: 14.80% -> 28.91%             
client [3] (test)  loss: 4.5253 -> 2.9168   acc: 8.17% -> 27.61%               
client [84] (test)  loss: 4.8448 -> 2.8569   acc: 6.21% -> 31.56%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 6.1542 -> 3.0862   acc: 2.80% -> 29.00%              
client [84] (test)  loss: 4.4524 -> 2.8217   acc: 11.88% -> 33.69%             
client [10] (test)  loss: 5.4506 -> 2.7378   acc: 6.53% -> 31.34%              
client [36] (test)  loss: 4.4191 -> 2.2487   acc: 7.25% -> 40.76%              
client [65] (test)  loss: 4.4513 -> 3.3384   acc: 8.42% -> 22.40%              
client [81] (test)  loss: 5.5060 -> 2.7540   acc: 7.30% -> 29.89%              
client [79] (test)  loss: 4.9880 -> 3.3491   acc: 3.85% -> 19.87%              
client [42] (test)  loss: 4.6562 -> 2.9345   acc: 6.26% -> 28.09%              
client [11] (test)  loss: 4.7333 -> 3.0757   acc: 6.06% -> 25.26%              
client [96] (test)  loss: 5.0231 -> 2.3428   acc: 4.86% -> 35.25%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 5.2202 -> 2.7084   acc: 5.72% -> 36.72%               
client [53] (test)  loss: 4.9765 -> 2.8667   acc: 6.98% -> 35.66%              
client [52] (test)  loss: 4.4725 -> 3.1462   acc: 15.07% -> 30.67%             
client [42] (test)  loss: 4.4150 -> 3.0385   acc: 10.91% -> 25.94%             
client [69] (test)  loss: 4.8727 -> 3.4917   acc: 7.45% -> 22.87%              
client [59] (test)  loss: 4.6439 -> 3.0062   acc: 7.39% -> 28.70%              
client [7] (test)  loss: 6.6550 -> 3.2705   acc: 4.49% -> 26.21%               
client [26] (test)  loss: 4.6098 -> 2.8092   acc: 13.49% -> 34.06%             
client [49] (test)  loss: 4.1728 -> 3.2126   acc: 9.79% -> 28.85%              
client [98] (test)  loss: 4.9964 -> 2.7395   acc: 6.05% -> 37.43%              
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.8539 -> 2.8306   acc: 9.26% -> 36.67%              
client [47] (test)  loss: 6.2190 -> 2.0988   acc: 3.07% -> 46.65%              
client [21] (test)  loss: 5.2042 -> 3.2154   acc: 5.20% -> 30.40%              
client [77] (test)  loss: 4.6860 -> 2.7626   acc: 5.50% -> 30.41%              
client [95] (test)  loss: 4.9442 -> 2.6542   acc: 11.58% -> 42.74%             
client [91] (test)  loss: 4.8214 -> 2.6927   acc: 9.98% -> 35.70%              
client [14] (test)  loss: 4.1440 -> 2.6034   acc: 12.46% -> 38.08%             
client [99] (test)  loss: 4.9362 -> 3.6333   acc: 6.34% -> 24.13%              
client [20] (test)  loss: 4.6962 -> 3.1765   acc: 7.79% -> 27.85%              
client [39] (test)  loss: 5.5146 -> 3.1943   acc: 4.95% -> 31.35%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.6727 -> 3.1281   acc: 14.72% -> 32.98%             
client [62] (test)  loss: 4.8199 -> 3.3949   acc: 6.84% -> 24.27%              
client [71] (test)  loss: 4.2749 -> 3.5293   acc: 12.08% -> 25.12%             
client [97] (test)  loss: 4.8690 -> 3.0451   acc: 9.92% -> 28.82%              
client [30] (test)  loss: 4.0770 -> 3.1551   acc: 16.94% -> 31.55%             
client [88] (test)  loss: 4.9700 -> 3.2694   acc: 11.95% -> 29.86%             
client [60] (test)  loss: 4.9823 -> 2.7911   acc: 3.82% -> 38.55%              
client [82] (test)  loss: 4.7529 -> 2.9511   acc: 9.09% -> 35.88%              
client [91] (test)  loss: 5.0307 -> 2.7502   acc: 8.80% -> 36.04%              
client [57] (test)  loss: 4.3894 -> 3.1539   acc: 12.18% -> 29.64%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.5346 -> 2.5193   acc: 10.63% -> 48.61%             
client [15] (test)  loss: 4.5595 -> 3.0206   acc: 11.36% -> 31.29%             
client [71] (test)  loss: 4.7858 -> 3.5493   acc: 10.14% -> 25.36%             
client [97] (test)  loss: 4.8875 -> 3.1810   acc: 8.21% -> 30.34%              
client [53] (test)  loss: 5.3213 -> 3.0380   acc: 5.62% -> 35.66%              
client [77] (test)  loss: 5.0102 -> 2.9134   acc: 9.62% -> 30.58%              
client [76] (test)  loss: 4.7819 -> 2.9706   acc: 11.27% -> 34.55%             
client [79] (test)  loss: 5.4575 -> 3.5569   acc: 7.05% -> 19.66%              
client [28] (test)  loss: 5.2170 -> 3.1100   acc: 5.97% -> 29.29%              
client [99] (test)  loss: 5.3496 -> 3.8414   acc: 6.54% -> 24.13%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.7440 -> 3.2996   acc: 9.35% -> 28.05%              
client [86] (test)  loss: 4.6216 -> 3.0351   acc: 12.76% -> 38.77%             
client [34] (test)  loss: 5.0670 -> 3.5061   acc: 7.19% -> 27.84%              
client [73] (test)  loss: 4.8014 -> 2.9363   acc: 10.81% -> 38.47%             
client [5] (test)  loss: 5.2872 -> 3.0171   acc: 6.85% -> 32.07%               
client [96] (test)  loss: 4.7500 -> 2.6021   acc: 11.15% -> 38.85%             
client [22] (test)  loss: 5.0935 -> 3.0747   acc: 9.27% -> 34.71%              
client [60] (test)  loss: 4.9787 -> 2.7337   acc: 6.36% -> 39.27%              
client [66] (test)  loss: 5.1098 -> 3.3465   acc: 6.77% -> 24.24%              
client [83] (test)  loss: 5.4346 -> 3.6195   acc: 9.11% -> 25.43%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.9006 -> 3.0516   acc: 13.45% -> 35.45%             
client [65] (test)  loss: 4.6779 -> 3.6238   acc: 13.98% -> 24.19%             
client [95] (test)  loss: 6.0136 -> 2.8832   acc: 7.37% -> 42.53%              
client [17] (test)  loss: 5.3340 -> 2.8518   acc: 14.38% -> 37.12%             
client [8] (test)  loss: 5.4270 -> 2.9630   acc: 6.04% -> 39.11%               
client [35] (test)  loss: 5.2099 -> 3.1579   acc: 7.63% -> 34.34%              
client [98] (test)  loss: 5.3825 -> 2.8747   acc: 6.99% -> 39.51%              
client [53] (test)  loss: 4.7200 -> 3.1603   acc: 11.82% -> 34.30%             
client [43] (test)  loss: 5.1725 -> 3.2553   acc: 9.74% -> 31.63%              
client [64] (test)  loss: 5.0826 -> 2.9967   acc: 4.79% -> 39.11%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.5169 -> 3.4452   acc: 6.20% -> 28.60%              
client [88] (test)  loss: 5.4038 -> 3.6507   acc: 9.22% -> 31.23%              
client [38] (test)  loss: 5.0803 -> 3.4965   acc: 9.23% -> 27.00%              
client [3] (test)  loss: 5.1383 -> 3.2464   acc: 7.52% -> 30.88%               
client [5] (test)  loss: 6.0190 -> 3.1722   acc: 5.95% -> 32.07%               
client [41] (test)  loss: 5.1767 -> 3.2156   acc: 6.41% -> 32.21%              
client [7] (test)  loss: 6.1273 -> 3.5468   acc: 7.18% -> 29.62%               
client [37] (test)  loss: 5.4652 -> 3.2655   acc: 6.17% -> 31.01%              
client [45] (test)  loss: 5.7368 -> 3.3087   acc: 9.13% -> 30.02%              
client [47] (test)  loss: 5.8653 -> 2.4321   acc: 3.80% -> 44.85%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.4433 -> 3.4915   acc: 8.20% -> 29.14%              
client [11] (test)  loss: 5.3317 -> 3.7799   acc: 9.17% -> 26.30%              
client [37] (test)  loss: 5.4977 -> 3.4327   acc: 5.68% -> 31.98%              
client [41] (test)  loss: 5.8717 -> 3.2034   acc: 5.16% -> 32.03%              
client [95] (test)  loss: 6.6875 -> 3.0738   acc: 6.74% -> 42.11%              
client [53] (test)  loss: 5.7257 -> 3.3185   acc: 8.33% -> 34.30%              
client [22] (test)  loss: 5.0765 -> 3.2664   acc: 12.23% -> 34.52%             
client [25] (test)  loss: 5.5375 -> 3.7873   acc: 7.48% -> 26.09%              
client [69] (test)  loss: 5.4217 -> 4.0694   acc: 8.24% -> 25.53%              
client [46] (test)  loss: 4.5267 -> 3.4808   acc: 14.05% -> 31.89%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.0776 -> 2.5887   acc: 9.22% -> 45.03%              
client [69] (test)  loss: 5.5780 -> 4.1961   acc: 8.24% -> 23.40%              
client [82] (test)  loss: 5.2400 -> 3.3648   acc: 7.63% -> 34.09%              
client [45] (test)  loss: 5.3555 -> 3.4760   acc: 12.37% -> 27.99%             
client [7] (test)  loss: 6.2438 -> 3.6653   acc: 5.39% -> 29.80%               
client [50] (test)  loss: 5.5805 -> 3.3214   acc: 7.08% -> 32.82%              
client [35] (test)  loss: 4.8311 -> 3.2369   acc: 9.64% -> 34.54%              
client [24] (test)  loss: 5.4479 -> 3.1751   acc: 11.51% -> 40.00%             
client [15] (test)  loss: 4.9485 -> 3.3091   acc: 13.29% -> 30.59%             
client [58] (test)  loss: 6.1129 -> 3.7955   acc: 7.60% -> 31.27%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 5.2441 -> 2.7263   acc: 10.28% -> 43.98%             
client [76] (test)  loss: 5.6787 -> 3.2311   acc: 10.18% -> 34.55%             
client [67] (test)  loss: 5.4410 -> 3.5669   acc: 8.99% -> 30.86%              
client [37] (test)  loss: 6.1633 -> 3.5571   acc: 5.68% -> 31.66%              
client [58] (test)  loss: 5.8075 -> 3.8982   acc: 8.48% -> 31.27%              
client [64] (test)  loss: 5.4418 -> 3.2633   acc: 5.61% -> 37.95%              
client [77] (test)  loss: 5.3431 -> 3.3116   acc: 8.93% -> 28.69%              
client [55] (test)  loss: 5.8566 -> 3.7155   acc: 7.85% -> 28.47%              
client [12] (test)  loss: 6.4333 -> 3.1325   acc: 4.13% -> 41.28%              
client [89] (test)  loss: 5.2732 -> 3.2462   acc: 11.57% -> 35.26%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.3512 -> 3.7304   acc: 11.52% -> 32.80%             
client [51] (test)  loss: 6.2896 -> 2.8400   acc: 9.82% -> 38.73%              
client [8] (test)  loss: 5.8693 -> 3.2855   acc: 5.88% -> 39.90%               
client [18] (test)  loss: 5.5190 -> 4.0650   acc: 6.98% -> 30.05%              
client [94] (test)  loss: 5.7368 -> 3.4566   acc: 10.93% -> 37.52%             
client [81] (test)  loss: 5.9157 -> 3.3550   acc: 7.83% -> 35.77%              
client [3] (test)  loss: 5.3611 -> 3.4005   acc: 10.13% -> 33.01%              
client [11] (test)  loss: 5.2678 -> 3.9550   acc: 9.00% -> 25.26%              
client [95] (test)  loss: 6.0566 -> 3.3024   acc: 9.47% -> 43.16%              
client [67] (test)  loss: 5.6940 -> 3.6757   acc: 6.35% -> 32.28%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.9292 -> 3.6229   acc: 6.80% -> 31.00%              
client [79] (test)  loss: 6.0915 -> 4.4150   acc: 7.05% -> 20.94%              
client [58] (test)  loss: 5.8712 -> 4.0088   acc: 6.89% -> 30.74%              
client [88] (test)  loss: 5.5244 -> 4.0228   acc: 13.31% -> 29.86%             
client [46] (test)  loss: 5.0726 -> 3.6792   acc: 13.33% -> 33.33%             
client [11] (test)  loss: 5.2451 -> 4.0446   acc: 9.34% -> 26.30%              
client [55] (test)  loss: 5.2606 -> 3.8594   acc: 12.04% -> 30.11%             
client [13] (test)  loss: 5.4312 -> 3.9156   acc: 13.82% -> 36.18%             
client [31] (test)  loss: 5.6620 -> 2.8206   acc: 8.89% -> 47.04%              
client [75] (test)  loss: 6.1059 -> 3.5915   acc: 9.39% -> 33.74%              
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.3089 -> 3.6786   acc: 14.03% -> 34.53%             
client [7] (test)  loss: 6.1977 -> 3.9743   acc: 7.36% -> 27.29%               
client [57] (test)  loss: 4.9212 -> 3.8113   acc: 14.55% -> 30.73%             
client [13] (test)  loss: 5.8397 -> 3.9833   acc: 12.12% -> 35.32%             
client [43] (test)  loss: 5.5681 -> 3.7328   acc: 8.79% -> 34.50%              
client [91] (test)  loss: 5.3471 -> 3.2024   acc: 15.91% -> 39.59%             
client [10] (test)  loss: 5.4651 -> 3.4283   acc: 12.50% -> 32.84%             
client [64] (test)  loss: 4.8759 -> 3.3695   acc: 10.73% -> 37.95%             
client [82] (test)  loss: 5.1718 -> 3.6862   acc: 11.36% -> 31.98%             
client [22] (test)  loss: 5.6554 -> 3.5292   acc: 11.83% -> 32.94%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.8013 -> 3.6824   acc: 9.86% -> 29.07%              
client [23] (test)  loss: 5.0440 -> 3.0662   acc: 12.04% -> 39.65%             
client [88] (test)  loss: 6.0028 -> 4.1185   acc: 12.46% -> 30.03%             
client [98] (test)  loss: 5.3901 -> 3.2832   acc: 11.15% -> 37.62%             
client [79] (test)  loss: 6.0539 -> 4.5797   acc: 6.84% -> 21.79%              
client [21] (test)  loss: 6.0423 -> 3.7589   acc: 5.20% -> 31.00%              
client [92] (test)  loss: 5.8428 -> 3.5132   acc: 7.79% -> 36.16%              
client [56] (test)  loss: 6.1295 -> 4.3241   acc: 7.47% -> 25.27%              
client [5] (test)  loss: 5.9016 -> 3.5215   acc: 7.39% -> 31.71%               
client [52] (test)  loss: 5.8689 -> 3.7917   acc: 9.75% -> 34.04%              
==================== FedAvg TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '5.0071 -> 0.0000', 'accuracy': '8.86% -> 0.00%'},           
    200: {'loss': '5.9542 -> 0.0000', 'accuracy': '8.70% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
FedAvg achieved 10.0%(10.75%) at epoch: 64                                     
Convergence (test_after):                                                      
FedAvg achieved 10.0%(15.54%) at epoch: 0                                      
FedAvg achieved 20.0%(21.25%) at epoch: 11                                     
FedAvg achieved 30.0%(32.73%) at epoch: 39                                     
