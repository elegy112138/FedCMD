==================== ALGORITHM: FedPer_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.5231 -> 1.3464   acc: 47.47% -> 47.47%             
client [81] (test)  loss: 0.6993 -> 0.5689   acc: 82.41% -> 87.04%             
client [21] (test)  loss: 2.4356 -> 0.6393   acc: 0.77% -> 74.65%              
client [68] (test)  loss: 1.2386 -> 0.6726   acc: 69.31% -> 86.80%             
client [93] (test)  loss: 1.0998 -> 0.4330   acc: 86.75% -> 91.57%             
client [31] (test)  loss: 1.2733 -> 0.6230   acc: 84.42% -> 84.42%             
client [20] (test)  loss: 0.5432 -> 0.3626   acc: 75.36% -> 87.68%             
client [59] (test)  loss: 2.1698 -> 0.3112   acc: 40.38% -> 87.50%             
client [48] (test)  loss: 0.5948 -> 0.2613   acc: 79.86% -> 94.20%             
client [34] (test)  loss: 0.8602 -> 0.4390   acc: 78.54% -> 85.84%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.0772 -> 0.0340   acc: 97.39% -> 99.00%             
client [99] (test)  loss: 0.9595 -> 0.7404   acc: 68.52% -> 77.78%             
client [67] (test)  loss: 1.8696 -> 1.5804   acc: 48.28% -> 58.62%             
client [0] (test)  loss: 0.1999 -> 0.0727   acc: 98.33% -> 97.91%              
client [76] (test)  loss: 0.7525 -> 0.4443   acc: 80.50% -> 84.91%             
client [41] (test)  loss: 0.9355 -> 0.2700   acc: 98.31% -> 98.31%             
client [62] (test)  loss: 2.1473 -> 0.6121   acc: 31.33% -> 70.67%             
client [2] (test)  loss: 2.1576 -> 0.1854   acc: 34.94% -> 93.04%              
client [14] (test)  loss: 0.5850 -> 0.3639   acc: 85.60% -> 92.80%             
client [46] (test)  loss: 0.2675 -> 0.2003   acc: 93.72% -> 93.99%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.3942 -> 0.1154   acc: 82.00% -> 97.33%             
client [68] (test)  loss: 0.5835 -> 0.1889   acc: 82.18% -> 93.40%             
client [57] (test)  loss: 0.4055 -> 0.2827   acc: 88.30% -> 92.55%             
client [17] (test)  loss: 0.3157 -> 0.2032   acc: 92.63% -> 94.99%             
client [54] (test)  loss: 0.0278 -> 0.0124   acc: 99.38% -> 100.00%            
client [23] (test)  loss: 2.5950 -> 0.8001   acc: 12.20% -> 72.56%             
client [35] (test)  loss: 0.7458 -> 0.6476   acc: 83.93% -> 83.93%             
client [59] (test)  loss: 0.3066 -> 0.1813   acc: 90.38% -> 92.95%             
client [31] (test)  loss: 0.6150 -> 0.5907   acc: 84.42% -> 84.42%             
client [9] (test)  loss: 0.0165 -> 0.0151   acc: 99.43% -> 99.59%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.1325 -> 0.1000   acc: 95.40% -> 97.14%             
client [33] (test)  loss: 0.3872 -> 0.5293   acc: 87.02% -> 81.25%             
client [16] (test)  loss: 1.0325 -> 1.0061   acc: 68.63% -> 68.63%             
client [44] (test)  loss: 0.1913 -> 0.0549   acc: 90.47% -> 97.67%             
client [8] (test)  loss: 0.4926 -> 0.4218   acc: 83.89% -> 85.23%              
client [31] (test)  loss: 0.6622 -> 0.5531   acc: 84.42% -> 85.71%             
client [47] (test)  loss: 0.6020 -> 0.5331   acc: 83.04% -> 84.21%             
client [36] (test)  loss: 0.9018 -> 0.1359   acc: 52.32% -> 98.68%             
client [20] (test)  loss: 0.1982 -> 0.1875   acc: 92.75% -> 93.48%             
client [56] (test)  loss: 1.0717 -> 0.5592   acc: 60.47% -> 83.72%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.1154 -> 0.0907   acc: 97.37% -> 97.37%              
client [60] (test)  loss: 0.2581 -> 0.0824   acc: 93.65% -> 97.68%             
client [28] (test)  loss: 0.2860 -> 0.2642   acc: 94.75% -> 94.29%             
client [25] (test)  loss: 0.1126 -> 0.1098   acc: 98.37% -> 96.34%             
client [58] (test)  loss: 0.3409 -> 0.2515   acc: 88.24% -> 94.12%             
client [44] (test)  loss: 0.0652 -> 0.0382   acc: 97.78% -> 98.52%             
client [39] (test)  loss: 0.8604 -> 0.6692   acc: 47.92% -> 66.67%             
client [29] (test)  loss: 0.7268 -> 0.3447   acc: 73.15% -> 85.96%             
client [3] (test)  loss: 0.1362 -> 0.0859   acc: 97.96% -> 97.96%              
client [84] (test)  loss: 0.0264 -> 0.0232   acc: 98.63% -> 100.00%            
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.4033 -> 0.2878   acc: 85.47% -> 90.26%             
client [84] (test)  loss: 0.0384 -> 0.0162   acc: 100.00% -> 100.00%           
client [10] (test)  loss: 0.5702 -> 0.1516   acc: 72.73% -> 96.10%             
client [36] (test)  loss: 0.4277 -> 0.0846   acc: 79.47% -> 98.68%             
client [65] (test)  loss: 0.2255 -> 0.1867   acc: 93.36% -> 94.73%             
client [81] (test)  loss: 0.2331 -> 0.3284   acc: 89.81% -> 89.81%             
client [79] (test)  loss: 0.5368 -> 0.4805   acc: 81.71% -> 84.15%             
client [42] (test)  loss: 0.2267 -> 0.1958   acc: 94.21% -> 94.59%             
client [11] (test)  loss: 0.3127 -> 0.2125   acc: 85.67% -> 91.64%             
client [96] (test)  loss: 0.3104 -> 0.2306   acc: 85.62% -> 89.97%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.4438 -> 0.3793   acc: 84.56% -> 87.92%              
client [53] (test)  loss: 0.0156 -> 0.0151   acc: 99.69% -> 99.69%             
client [52] (test)  loss: 0.1582 -> 0.1227   acc: 95.38% -> 95.38%             
client [42] (test)  loss: 0.1803 -> 0.1851   acc: 96.14% -> 95.37%             
client [69] (test)  loss: 0.0281 -> 0.0076   acc: 99.00% -> 99.80%             
client [59] (test)  loss: 0.1644 -> 0.0975   acc: 94.23% -> 96.15%             
client [7] (test)  loss: 0.3438 -> 0.0133   acc: 85.60% -> 99.84%              
client [26] (test)  loss: 0.0938 -> 0.1021   acc: 96.83% -> 97.62%             
client [49] (test)  loss: 0.0993 -> 0.0937   acc: 98.30% -> 98.30%             
client [98] (test)  loss: 0.2017 -> 0.1603   acc: 93.15% -> 94.15%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.1865 -> 0.1432   acc: 94.01% -> 94.58%             
client [47] (test)  loss: 0.6598 -> 0.5062   acc: 84.80% -> 87.72%             
client [21] (test)  loss: 0.2458 -> 0.2691   acc: 92.12% -> 91.19%             
client [77] (test)  loss: 0.9144 -> 0.9188   acc: 64.56% -> 65.82%             
client [95] (test)  loss: 0.1516 -> 0.0642   acc: 93.66% -> 97.89%             
client [91] (test)  loss: 0.5504 -> 0.0317   acc: 79.94% -> 99.36%             
client [14] (test)  loss: 0.2402 -> 0.2311   acc: 93.60% -> 93.60%             
client [99] (test)  loss: 0.7126 -> 0.6929   acc: 74.07% -> 78.70%             
client [20] (test)  loss: 0.1471 -> 0.1475   acc: 95.65% -> 94.93%             
client [39] (test)  loss: 0.6355 -> 0.4639   acc: 64.58% -> 75.00%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.1062 -> 0.1031   acc: 95.65% -> 95.65%             
client [62] (test)  loss: 0.5515 -> 0.2943   acc: 77.00% -> 89.33%             
client [71] (test)  loss: 0.1191 -> 0.1063   acc: 95.80% -> 95.80%             
client [97] (test)  loss: 0.6635 -> 0.6195   acc: 76.43% -> 79.29%             
client [30] (test)  loss: 0.3447 -> 0.3351   acc: 86.36% -> 88.64%             
client [88] (test)  loss: 0.1553 -> 0.1433   acc: 94.92% -> 94.35%             
client [60] (test)  loss: 0.1191 -> 0.0644   acc: 96.75% -> 98.30%             
client [82] (test)  loss: 0.5136 -> 0.3584   acc: 81.75% -> 91.24%             
client [91] (test)  loss: 0.0742 -> 0.0313   acc: 97.45% -> 99.36%             
client [57] (test)  loss: 0.1679 -> 0.1359   acc: 94.68% -> 94.68%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4995 -> 0.5257   acc: 90.91% -> 90.91%             
client [15] (test)  loss: 0.2374 -> 0.1868   acc: 91.75% -> 93.40%             
client [71] (test)  loss: 0.1475 -> 0.1059   acc: 94.68% -> 96.08%             
client [97] (test)  loss: 0.7236 -> 0.6565   acc: 77.86% -> 80.00%             
client [53] (test)  loss: 0.0183 -> 0.0150   acc: 99.54% -> 99.54%             
client [77] (test)  loss: 0.9161 -> 0.8603   acc: 62.66% -> 69.62%             
client [76] (test)  loss: 0.2520 -> 0.0839   acc: 89.94% -> 97.48%             
client [79] (test)  loss: 0.4275 -> 0.4304   acc: 87.80% -> 85.37%             
client [28] (test)  loss: 0.1776 -> 0.1983   acc: 94.75% -> 94.52%             
client [99] (test)  loss: 0.7318 -> 0.7187   acc: 79.63% -> 81.48%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.8519 -> 0.6770   acc: 70.71% -> 80.00%             
client [86] (test)  loss: 0.5655 -> 0.5046   acc: 82.64% -> 85.95%             
client [34] (test)  loss: 0.2277 -> 0.1626   acc: 90.99% -> 94.42%             
client [73] (test)  loss: 0.1292 -> 0.0423   acc: 94.69% -> 97.79%             
client [5] (test)  loss: 0.4030 -> 0.4985   acc: 84.92% -> 83.42%              
client [96] (test)  loss: 0.2691 -> 0.1637   acc: 90.97% -> 93.65%             
client [22] (test)  loss: 0.2535 -> 0.1244   acc: 89.13% -> 94.20%             
client [60] (test)  loss: 0.1567 -> 0.0602   acc: 94.12% -> 98.45%             
client [66] (test)  loss: 0.0070 -> 0.0011   acc: 100.00% -> 100.00%           
client [83] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1418 -> 0.0634   acc: 94.97% -> 98.74%             
client [65] (test)  loss: 0.3414 -> 0.1732   acc: 87.70% -> 94.73%             
client [95] (test)  loss: 0.0917 -> 0.0458   acc: 95.54% -> 98.12%             
client [17] (test)  loss: 0.2037 -> 0.1762   acc: 95.28% -> 96.46%             
client [8] (test)  loss: 0.3889 -> 0.3298   acc: 87.92% -> 89.26%              
client [35] (test)  loss: 0.3728 -> 0.3459   acc: 85.71% -> 83.93%             
client [98] (test)  loss: 0.1671 -> 0.1283   acc: 94.15% -> 95.44%             
client [53] (test)  loss: 0.0163 -> 0.0143   acc: 99.69% -> 99.69%             
client [43] (test)  loss: 0.6262 -> 0.4746   acc: 76.42% -> 82.97%             
client [64] (test)  loss: 0.0888 -> 0.0799   acc: 97.46% -> 97.94%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.2402 -> 0.2509   acc: 92.27% -> 91.65%             
client [88] (test)  loss: 0.1477 -> 0.1207   acc: 92.66% -> 93.79%             
client [38] (test)  loss: 0.2236 -> 0.2062   acc: 92.08% -> 93.07%             
client [3] (test)  loss: 0.0575 -> 0.0224   acc: 97.96% -> 100.00%             
client [5] (test)  loss: 0.4154 -> 0.4954   acc: 83.42% -> 83.42%              
client [41] (test)  loss: 0.0194 -> 0.0301   acc: 100.00% -> 98.31%            
client [7] (test)  loss: 0.0812 -> 0.0097   acc: 96.36% -> 99.84%              
client [37] (test)  loss: 0.4802 -> 0.1411   acc: 90.69% -> 97.04%             
client [45] (test)  loss: 0.2089 -> 0.1540   acc: 92.71% -> 93.92%             
client [47] (test)  loss: 0.5218 -> 0.4551   acc: 89.47% -> 90.06%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.3696 -> 0.4543   acc: 80.39% -> 86.27%             
client [11] (test)  loss: 0.1982 -> 0.1594   acc: 91.64% -> 93.13%             
client [37] (test)  loss: 0.3226 -> 0.1411   acc: 93.79% -> 96.76%             
client [41] (test)  loss: 0.0157 -> 0.0239   acc: 100.00% -> 98.31%            
client [95] (test)  loss: 0.0871 -> 0.0406   acc: 96.01% -> 98.36%             
client [53] (test)  loss: 0.0154 -> 0.0132   acc: 99.85% -> 99.69%             
client [22] (test)  loss: 0.1638 -> 0.1091   acc: 94.93% -> 95.65%             
client [25] (test)  loss: 0.1121 -> 0.0615   acc: 96.75% -> 97.97%             
client [69] (test)  loss: 0.0108 -> 0.0050   acc: 99.40% -> 99.80%             
client [46] (test)  loss: 0.1423 -> 0.1439   acc: 95.33% -> 96.13%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.4392 -> 0.4329   acc: 88.89% -> 90.06%             
client [69] (test)  loss: 0.0076 -> 0.0045   acc: 99.60% -> 99.80%             
client [82] (test)  loss: 0.4963 -> 0.3191   acc: 83.94% -> 90.51%             
client [45] (test)  loss: 0.1955 -> 0.1512   acc: 93.01% -> 93.92%             
client [7] (test)  loss: 0.0739 -> 0.0078   acc: 97.31% -> 99.84%              
client [50] (test)  loss: 0.4505 -> 0.3018   acc: 85.62% -> 91.50%             
client [35] (test)  loss: 0.3203 -> 0.3095   acc: 87.50% -> 85.71%             
client [24] (test)  loss: 0.0658 -> 0.0432   acc: 98.33% -> 98.00%             
client [15] (test)  loss: 0.2749 -> 0.1508   acc: 91.42% -> 95.38%             
client [58] (test)  loss: 0.1886 -> 0.1441   acc: 91.60% -> 94.96%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.1006 -> 0.0530   acc: 96.93% -> 98.29%             
client [76] (test)  loss: 0.1013 -> 0.0523   acc: 98.11% -> 98.74%             
client [67] (test)  loss: 0.1891 -> 0.1891   acc: 93.10% -> 89.66%             
client [37] (test)  loss: 0.3427 -> 0.1412   acc: 94.08% -> 96.76%             
client [58] (test)  loss: 0.1928 -> 0.1540   acc: 92.44% -> 94.12%             
client [64] (test)  loss: 0.1141 -> 0.0855   acc: 97.46% -> 97.62%             
client [77] (test)  loss: 0.7479 -> 0.7120   acc: 68.35% -> 71.52%             
client [55] (test)  loss: 0.0462 -> 0.0422   acc: 99.43% -> 99.24%             
client [12] (test)  loss: 0.4268 -> 0.4212   acc: 84.71% -> 83.53%             
client [89] (test)  loss: 0.1552 -> 0.0852   acc: 96.52% -> 97.49%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0063 -> 0.0036   acc: 100.00% -> 100.00%           
client [51] (test)  loss: 0.1659 -> 0.1253   acc: 94.59% -> 96.50%             
client [8] (test)  loss: 0.3280 -> 0.3165   acc: 90.60% -> 89.93%              
client [18] (test)  loss: 0.3735 -> 0.3244   acc: 87.32% -> 90.14%             
client [94] (test)  loss: 0.2666 -> 0.2832   acc: 91.06% -> 88.62%             
client [81] (test)  loss: 0.1613 -> 0.2951   acc: 93.52% -> 89.81%             
client [3] (test)  loss: 0.0239 -> 0.0178   acc: 98.98% -> 98.98%              
client [11] (test)  loss: 0.1884 -> 0.1475   acc: 93.73% -> 93.13%             
client [95] (test)  loss: 0.0656 -> 0.0348   acc: 97.65% -> 99.06%             
client [67] (test)  loss: 0.2023 -> 0.1940   acc: 93.10% -> 89.66%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.2629 -> 0.2409   acc: 92.12% -> 92.74%             
client [79] (test)  loss: 0.4009 -> 0.3974   acc: 85.98% -> 89.02%             
client [58] (test)  loss: 0.2007 -> 0.1586   acc: 90.76% -> 94.12%             
client [88] (test)  loss: 0.1325 -> 0.1016   acc: 94.92% -> 94.92%             
client [46] (test)  loss: 0.1772 -> 0.1476   acc: 95.46% -> 95.99%             
client [11] (test)  loss: 0.1584 -> 0.1451   acc: 94.03% -> 94.33%             
client [55] (test)  loss: 0.0486 -> 0.0473   acc: 99.24% -> 99.24%             
client [13] (test)  loss: 0.2864 -> 0.1755   acc: 90.37% -> 93.33%             
client [31] (test)  loss: 0.6453 -> 0.5913   acc: 90.91% -> 90.91%             
client [75] (test)  loss: 0.1519 -> 0.1386   acc: 94.34% -> 94.34%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1673 -> 0.0913   acc: 94.00% -> 96.36%             
client [7] (test)  loss: 0.0640 -> 0.0085   acc: 97.63% -> 99.84%              
client [57] (test)  loss: 0.1538 -> 0.0998   acc: 95.74% -> 97.87%             
client [13] (test)  loss: 0.3328 -> 0.1646   acc: 86.67% -> 94.81%             
client [43] (test)  loss: 0.6057 -> 0.4436   acc: 76.42% -> 85.59%             
client [91] (test)  loss: 0.0914 -> 0.0273   acc: 96.50% -> 99.04%             
client [10] (test)  loss: 0.2678 -> 0.1438   acc: 89.61% -> 97.40%             
client [64] (test)  loss: 0.1210 -> 0.0879   acc: 97.30% -> 97.62%             
client [82] (test)  loss: 0.5401 -> 0.3180   acc: 80.29% -> 90.51%             
client [22] (test)  loss: 0.1859 -> 0.0975   acc: 92.03% -> 97.10%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1133 -> 0.0813   acc: 96.38% -> 97.10%             
client [23] (test)  loss: 0.3943 -> 0.2121   acc: 83.54% -> 94.51%             
client [88] (test)  loss: 0.1659 -> 0.1135   acc: 93.22% -> 94.92%             
client [98] (test)  loss: 0.1407 -> 0.1201   acc: 95.72% -> 96.01%             
client [79] (test)  loss: 0.4036 -> 0.4151   acc: 87.20% -> 89.02%             
client [21] (test)  loss: 0.2727 -> 0.2461   acc: 91.65% -> 92.43%             
client [92] (test)  loss: 0.6074 -> 0.7723   acc: 80.95% -> 76.19%             
client [56] (test)  loss: 0.1892 -> 0.2015   acc: 90.70% -> 93.02%             
client [5] (test)  loss: 0.4608 -> 0.4796   acc: 84.92% -> 83.92%              
client [52] (test)  loss: 0.0910 -> 0.0666   acc: 95.65% -> 96.74%             
==================== FedPer_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '0.1891 -> 0.0000', 'accuracy': '93.50% -> 0.00%'},          
    200: {'loss': '0.1668 -> 0.0000', 'accuracy': '94.81% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_join_0.1 achieved 10.0%(14.85%) at epoch: 1                             
FedPer_join_0.1 achieved 20.0%(24.79%) at epoch: 2                             
FedPer_join_0.1 achieved 40.0%(41.84%) at epoch: 3                             
FedPer_join_0.1 achieved 50.0%(59.31%) at epoch: 7                             
FedPer_join_0.1 achieved 70.0%(71.60%) at epoch: 11                            
FedPer_join_0.1 achieved 80.0%(85.51%) at epoch: 22                            
FedPer_join_0.1 achieved 90.0%(90.34%) at epoch: 27                            
Convergence (test_after):                                                      
FedPer_join_0.1 achieved 70.0%(76.17%) at epoch: 0                             
FedPer_join_0.1 achieved 80.0%(82.34%) at epoch: 1                             
FedPer_join_0.1 achieved 90.0%(92.28%) at epoch: 2                             
