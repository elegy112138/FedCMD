==================== ALGORITHM: FedPer_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.5465 -> 0.7875   acc: 80.24% -> 74.32%             
client [81] (test)  loss: 0.1520 -> 0.1208   acc: 94.51% -> 95.78%             
client [21] (test)  loss: 27.1091 -> 0.9319   acc: 35.44% -> 64.03%            
client [68] (test)  loss: 0.5396 -> 0.4885   acc: 78.22% -> 79.61%             
client [93] (test)  loss: 1.0665 -> 0.4298   acc: 66.98% -> 83.93%             
client [31] (test)  loss: 2.0430 -> 1.7730   acc: 0.00% -> 40.74%              
client [20] (test)  loss: 0.5124 -> 0.3781   acc: 81.40% -> 87.88%             
client [59] (test)  loss: 55.7297 -> 1.1967   acc: 1.60% -> 53.70%             
client [48] (test)  loss: 1.4129 -> 1.3219   acc: 59.26% -> 59.26%             
client [34] (test)  loss: 0.0801 -> 0.0362   acc: 99.03% -> 99.28%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.6663 -> 1.3126   acc: 59.77% -> 58.62%             
client [99] (test)  loss: 0.3467 -> 0.2843   acc: 89.21% -> 90.14%             
client [67] (test)  loss: 0.4570 -> 0.4198   acc: 86.15% -> 85.79%             
client [0] (test)  loss: 0.5236 -> 0.4893   acc: 82.29% -> 82.86%              
client [76] (test)  loss: 2.0423 -> 0.9357   acc: 32.21% -> 62.33%             
client [41] (test)  loss: 1.2437 -> 1.9395   acc: 42.37% -> 31.49%             
client [62] (test)  loss: 69.4207 -> 0.7337   acc: 0.37% -> 75.79%             
client [2] (test)  loss: 28.4415 -> 0.9124   acc: 20.00% -> 90.00%             
client [14] (test)  loss: 1.5975 -> 1.9890   acc: 44.37% -> 39.31%             
client [46] (test)  loss: 0.0189 -> 0.0106   acc: 99.78% -> 99.78%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8311 -> 0.6633   acc: 62.16% -> 68.92%             
client [68] (test)  loss: 0.5060 -> 0.4556   acc: 79.08% -> 81.12%             
client [57] (test)  loss: 0.6645 -> 0.5918   acc: 85.00% -> 80.00%             
client [17] (test)  loss: 0.6744 -> 0.5928   acc: 83.92% -> 84.91%             
client [54] (test)  loss: 0.4907 -> 1.2624   acc: 84.16% -> 31.00%             
client [23] (test)  loss: 15.1728 -> 0.1005   acc: 61.74% -> 97.40%            
client [35] (test)  loss: 1.0103 -> 0.7674   acc: 67.44% -> 72.14%             
client [59] (test)  loss: 1.6561 -> 1.0935   acc: 43.90% -> 58.83%             
client [31] (test)  loss: 0.8872 -> 0.6861   acc: 64.20% -> 76.54%             
client [9] (test)  loss: 0.6733 -> 0.4027   acc: 68.70% -> 82.91%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9751 -> 0.9828   acc: 60.08% -> 69.77%             
client [33] (test)  loss: 0.0004 -> 0.0003   acc: 100.00% -> 100.00%           
client [16] (test)  loss: 0.9906 -> 0.8097   acc: 64.23% -> 69.92%             
client [44] (test)  loss: 0.6762 -> 0.4662   acc: 76.15% -> 84.46%             
client [8] (test)  loss: 0.2325 -> 0.1790   acc: 92.97% -> 94.30%              
client [31] (test)  loss: 0.7481 -> 0.6736   acc: 71.60% -> 79.01%             
client [47] (test)  loss: 0.6129 -> 0.8263   acc: 80.04% -> 67.18%             
client [36] (test)  loss: 0.6007 -> 0.5429   acc: 80.51% -> 80.91%             
client [20] (test)  loss: 0.6254 -> 0.3865   acc: 79.37% -> 88.50%             
client [56] (test)  loss: 1.1753 -> 1.4561   acc: 50.79% -> 41.21%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5596 -> 0.4005   acc: 84.39% -> 87.38%              
client [60] (test)  loss: 1.6259 -> 0.8484   acc: 56.92% -> 68.65%             
client [28] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%           
client [25] (test)  loss: 0.7623 -> 0.6106   acc: 75.78% -> 80.65%             
client [58] (test)  loss: 1.1475 -> 0.7813   acc: 57.32% -> 68.24%             
client [44] (test)  loss: 0.6039 -> 0.4308   acc: 79.48% -> 86.09%             
client [39] (test)  loss: 0.3879 -> 0.3617   acc: 86.95% -> 87.31%             
client [29] (test)  loss: 0.0248 -> 0.0237   acc: 99.78% -> 99.78%             
client [3] (test)  loss: 0.7995 -> 0.8783   acc: 63.65% -> 62.53%              
client [84] (test)  loss: 0.8923 -> 0.5042   acc: 82.83% -> 86.58%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.9723 -> 0.4638   acc: 67.92% -> 86.44%             
client [84] (test)  loss: 0.6401 -> 0.5342   acc: 84.28% -> 85.85%             
client [10] (test)  loss: 0.4692 -> 0.5258   acc: 83.97% -> 81.33%             
client [36] (test)  loss: 0.4872 -> 0.5498   acc: 82.09% -> 80.51%             
client [65] (test)  loss: 0.0009 -> 0.0004   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.1214 -> 0.1307   acc: 96.62% -> 95.88%             
client [79] (test)  loss: 0.6233 -> 0.5900   acc: 78.36% -> 79.29%             
client [42] (test)  loss: 0.5217 -> 0.5565   acc: 84.34% -> 80.78%             
client [11] (test)  loss: 0.1738 -> 0.1705   acc: 94.01% -> 94.21%             
client [96] (test)  loss: 0.9130 -> 0.7031   acc: 67.88% -> 76.56%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.1863 -> 0.1449   acc: 94.55% -> 95.39%              
client [53] (test)  loss: 0.2332 -> 0.2659   acc: 92.93% -> 91.31%             
client [52] (test)  loss: 0.6821 -> 1.0741   acc: 74.88% -> 65.22%             
client [42] (test)  loss: 0.5119 -> 0.5383   acc: 82.56% -> 82.56%             
client [69] (test)  loss: 1.2968 -> 1.3046   acc: 57.47% -> 60.92%             
client [59] (test)  loss: 2.2575 -> 1.2163   acc: 43.44% -> 57.16%             
client [7] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%            
client [26] (test)  loss: 0.8179 -> 0.6345   acc: 73.15% -> 77.33%             
client [49] (test)  loss: 0.6519 -> 0.7141   acc: 74.87% -> 72.51%             
client [98] (test)  loss: 0.6293 -> 0.7245   acc: 68.40% -> 71.57%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.6261 -> 0.7164   acc: 70.05% -> 71.57%             
client [47] (test)  loss: 1.0909 -> 0.6989   acc: 56.54% -> 74.28%             
client [21] (test)  loss: 0.6674 -> 0.4743   acc: 77.99% -> 86.58%             
client [77] (test)  loss: 0.6341 -> 0.6403   acc: 80.10% -> 80.39%             
client [95] (test)  loss: 0.2867 -> 0.2831   acc: 92.37% -> 92.55%             
client [91] (test)  loss: 0.8691 -> 0.8819   acc: 69.49% -> 70.80%             
client [14] (test)  loss: 1.2006 -> 1.1822   acc: 56.44% -> 59.05%             
client [99] (test)  loss: 0.3552 -> 0.2735   acc: 87.75% -> 90.22%             
client [20] (test)  loss: 0.4924 -> 0.3964   acc: 86.02% -> 88.95%             
client [39] (test)  loss: 0.5150 -> 0.3758   acc: 83.35% -> 87.92%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.9732 -> 1.4567   acc: 66.51% -> 59.00%             
client [62] (test)  loss: 0.2577 -> 0.2928   acc: 91.87% -> 91.55%             
client [71] (test)  loss: 1.1002 -> 1.0227   acc: 57.39% -> 58.39%             
client [97] (test)  loss: 0.7479 -> 0.6161   acc: 78.71% -> 78.39%             
client [30] (test)  loss: 0.6382 -> 0.3238   acc: 76.74% -> 89.86%             
client [88] (test)  loss: 0.8861 -> 0.4504   acc: 74.74% -> 83.66%             
client [60] (test)  loss: 0.8426 -> 0.8753   acc: 72.77% -> 68.08%             
client [82] (test)  loss: 1.1593 -> 1.0980   acc: 62.04% -> 61.26%             
client [91] (test)  loss: 0.9468 -> 0.9119   acc: 67.05% -> 69.41%             
client [57] (test)  loss: 0.4949 -> 0.5696   acc: 90.00% -> 80.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.3380 -> 0.7783   acc: 60.49% -> 77.78%             
client [15] (test)  loss: 0.4116 -> 0.3596   acc: 89.63% -> 90.43%             
client [71] (test)  loss: 0.8572 -> 1.0044   acc: 67.67% -> 61.53%             
client [97] (test)  loss: 0.7871 -> 0.5877   acc: 77.74% -> 79.35%             
client [53] (test)  loss: 0.2526 -> 0.2712   acc: 91.25% -> 91.97%             
client [77] (test)  loss: 0.6308 -> 0.5634   acc: 80.17% -> 82.31%             
client [76] (test)  loss: 1.0174 -> 0.9181   acc: 58.96% -> 65.43%             
client [79] (test)  loss: 0.6004 -> 0.6652   acc: 78.17% -> 78.17%             
client [28] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%           
client [99] (test)  loss: 0.2990 -> 0.3084   acc: 88.44% -> 88.91%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.8369 -> 0.5743   acc: 76.13% -> 79.68%             
client [86] (test)  loss: 0.3290 -> 0.4586   acc: 92.00% -> 92.00%             
client [34] (test)  loss: 0.0402 -> 0.0366   acc: 99.08% -> 99.37%             
client [73] (test)  loss: 0.3306 -> 0.4135   acc: 89.36% -> 87.92%             
client [5] (test)  loss: 0.5600 -> 0.5561   acc: 80.79% -> 82.97%              
client [96] (test)  loss: 0.7866 -> 0.7268   acc: 73.11% -> 76.23%             
client [22] (test)  loss: 0.5680 -> 0.4904   acc: 80.54% -> 85.75%             
client [60] (test)  loss: 0.8338 -> 0.9613   acc: 69.22% -> 70.19%             
client [66] (test)  loss: 1.0236 -> 0.9561   acc: 58.47% -> 62.66%             
client [83] (test)  loss: 0.0006 -> 0.0006   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0737 -> 0.9701   acc: 60.92% -> 64.08%             
client [65] (test)  loss: 0.0004 -> 0.0004   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.4390 -> 0.2995   acc: 85.93% -> 92.25%             
client [17] (test)  loss: 0.7599 -> 0.5977   acc: 66.79% -> 85.46%             
client [8] (test)  loss: 0.1626 -> 0.1518   acc: 95.52% -> 95.52%              
client [35] (test)  loss: 1.1465 -> 0.8251   acc: 61.48% -> 72.53%             
client [98] (test)  loss: 0.6355 -> 0.7058   acc: 73.60% -> 73.22%             
client [53] (test)  loss: 0.2311 -> 0.3008   acc: 92.03% -> 90.71%             
client [43] (test)  loss: 0.5898 -> 0.4950   acc: 79.66% -> 84.80%             
client [64] (test)  loss: 0.9660 -> 0.9291   acc: 71.54% -> 73.43%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5332 -> 0.4581   acc: 83.49% -> 87.92%             
client [88] (test)  loss: 0.6466 -> 0.5402   acc: 81.06% -> 80.97%             
client [38] (test)  loss: 0.1923 -> 0.1978   acc: 94.59% -> 94.90%             
client [3] (test)  loss: 0.8828 -> 0.9686   acc: 68.20% -> 67.79%              
client [5] (test)  loss: 0.6021 -> 0.6082   acc: 79.80% -> 79.87%              
client [41] (test)  loss: 1.2226 -> 1.1368   acc: 50.32% -> 62.01%             
client [7] (test)  loss: 0.0004 -> 0.0002   acc: 100.00% -> 100.00%            
client [37] (test)  loss: 0.3087 -> 0.2946   acc: 89.54% -> 90.79%             
client [45] (test)  loss: 0.6846 -> 0.5678   acc: 74.86% -> 80.73%             
client [47] (test)  loss: 1.4077 -> 0.7798   acc: 49.89% -> 74.28%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.2148 -> 0.9665   acc: 64.23% -> 68.29%             
client [11] (test)  loss: 0.2041 -> 0.2259   acc: 94.21% -> 92.81%             
client [37] (test)  loss: 0.3332 -> 0.2812   acc: 88.70% -> 89.96%             
client [41] (test)  loss: 1.2116 -> 1.1789   acc: 51.79% -> 61.53%             
client [95] (test)  loss: 0.3844 -> 0.3193   acc: 89.41% -> 91.72%             
client [53] (test)  loss: 0.2627 -> 0.2975   acc: 91.43% -> 89.75%             
client [22] (test)  loss: 0.5720 -> 0.5188   acc: 83.64% -> 85.47%             
client [25] (test)  loss: 0.7305 -> 0.9659   acc: 74.83% -> 76.47%             
client [69] (test)  loss: 1.4897 -> 1.3753   acc: 56.32% -> 56.32%             
client [46] (test)  loss: 0.0129 -> 0.0098   acc: 99.78% -> 99.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.0219 -> 0.7977   acc: 60.98% -> 73.84%             
client [69] (test)  loss: 1.5752 -> 1.3869   acc: 55.17% -> 59.77%             
client [82] (test)  loss: 0.8389 -> 1.3898   acc: 70.48% -> 58.04%             
client [45] (test)  loss: 0.6090 -> 0.5999   acc: 77.09% -> 79.05%             
client [7] (test)  loss: 0.0002 -> 0.0002   acc: 100.00% -> 100.00%            
client [50] (test)  loss: 0.8876 -> 0.8056   acc: 68.00% -> 66.00%             
client [35] (test)  loss: 0.8470 -> 0.8554   acc: 70.12% -> 72.33%             
client [24] (test)  loss: 0.7813 -> 0.7299   acc: 64.41% -> 68.02%             
client [15] (test)  loss: 0.4429 -> 0.3808   acc: 90.16% -> 90.69%             
client [58] (test)  loss: 0.8705 -> 1.0106   acc: 68.63% -> 67.70%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.8951 -> 0.9197   acc: 66.67% -> 62.96%             
client [76] (test)  loss: 1.0284 -> 1.0468   acc: 64.22% -> 62.40%             
client [67] (test)  loss: 0.5234 -> 0.4628   acc: 82.60% -> 85.92%             
client [37] (test)  loss: 0.3047 -> 0.2902   acc: 89.54% -> 90.38%             
client [58] (test)  loss: 1.2992 -> 1.0675   acc: 63.75% -> 67.47%             
client [64] (test)  loss: 0.8546 -> 0.9489   acc: 74.43% -> 73.80%             
client [77] (test)  loss: 0.5547 -> 0.5430   acc: 82.52% -> 82.81%             
client [55] (test)  loss: 0.4693 -> 0.3067   acc: 88.33% -> 92.58%             
client [12] (test)  loss: 0.8136 -> 0.7784   acc: 72.49% -> 75.09%             
client [89] (test)  loss: 1.3125 -> 0.8945   acc: 72.21% -> 73.79%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7513 -> 0.5839   acc: 82.59% -> 84.40%             
client [51] (test)  loss: 0.0868 -> 0.0903   acc: 97.81% -> 97.08%             
client [8] (test)  loss: 0.1737 -> 0.1543   acc: 94.06% -> 95.88%              
client [18] (test)  loss: 0.0993 -> 0.0955   acc: 96.90% -> 97.15%             
client [94] (test)  loss: 1.4233 -> 0.7959   acc: 50.49% -> 75.24%             
client [81] (test)  loss: 0.1447 -> 0.1312   acc: 96.81% -> 96.52%             
client [3] (test)  loss: 1.5446 -> 1.2305   acc: 56.44% -> 62.12%              
client [11] (test)  loss: 0.1908 -> 0.2006   acc: 95.08% -> 93.88%             
client [95] (test)  loss: 0.4468 -> 0.3583   acc: 87.94% -> 90.66%             
client [67] (test)  loss: 0.6265 -> 0.4769   acc: 76.99% -> 86.01%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5810 -> 0.4905   acc: 81.48% -> 87.25%             
client [79] (test)  loss: 0.7344 -> 0.7702   acc: 78.54% -> 77.43%             
client [58] (test)  loss: 1.1357 -> 1.0470   acc: 67.54% -> 67.54%             
client [88] (test)  loss: 0.5439 -> 0.5475   acc: 83.19% -> 82.17%             
client [46] (test)  loss: 0.0118 -> 0.0107   acc: 99.78% -> 99.78%             
client [11] (test)  loss: 0.3034 -> 0.2623   acc: 90.42% -> 92.68%             
client [55] (test)  loss: 0.5952 -> 0.3642   acc: 82.65% -> 92.52%             
client [13] (test)  loss: 0.3690 -> 0.4836   acc: 90.28% -> 89.01%             
client [31] (test)  loss: 0.9022 -> 0.8760   acc: 77.78% -> 77.78%             
client [75] (test)  loss: 1.1623 -> 1.4732   acc: 62.54% -> 56.44%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.7952 -> 0.9048   acc: 76.45% -> 66.57%             
client [7] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [57] (test)  loss: 0.5769 -> 0.5735   acc: 85.00% -> 85.00%             
client [13] (test)  loss: 0.3106 -> 0.4349   acc: 90.99% -> 90.22%             
client [43] (test)  loss: 0.6164 -> 0.5232   acc: 80.94% -> 83.51%             
client [91] (test)  loss: 0.8386 -> 0.7842   acc: 70.96% -> 72.68%             
client [10] (test)  loss: 0.5774 -> 0.6345   acc: 80.22% -> 81.63%             
client [64] (test)  loss: 1.4530 -> 1.0518   acc: 65.37% -> 71.03%             
client [82] (test)  loss: 1.0977 -> 1.2239   acc: 64.05% -> 63.83%             
client [22] (test)  loss: 0.6675 -> 0.5315   acc: 79.13% -> 84.91%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3804 -> 0.4165   acc: 89.57% -> 89.52%             
client [23] (test)  loss: 0.0811 -> 0.0813   acc: 97.82% -> 97.90%             
client [88] (test)  loss: 0.9884 -> 0.6165   acc: 77.99% -> 80.78%             
client [98] (test)  loss: 0.7182 -> 0.7737   acc: 74.49% -> 72.84%             
client [79] (test)  loss: 0.6912 -> 0.8010   acc: 79.66% -> 77.80%             
client [21] (test)  loss: 0.4743 -> 0.4866   acc: 88.32% -> 88.19%             
client [92] (test)  loss: 0.4237 -> 0.3889   acc: 88.74% -> 88.74%             
client [56] (test)  loss: 1.2967 -> 1.1752   acc: 59.04% -> 63.14%             
client [5] (test)  loss: 0.5685 -> 0.6782   acc: 79.67% -> 74.98%              
client [52] (test)  loss: 0.8521 -> 0.9045   acc: 75.22% -> 72.78%             
==================== FedPer_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '0.4904 -> 0.0000', 'accuracy': '83.47% -> 0.00%'},          
    200: {'loss': '0.5581 -> 0.0000', 'accuracy': '83.01% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedPer_join_0.1 achieved 40.0%(43.50%) at epoch: 2                             
FedPer_join_0.1 achieved 50.0%(59.01%) at epoch: 4                             
FedPer_join_0.1 achieved 70.0%(70.38%) at epoch: 7                             
FedPer_join_0.1 achieved 80.0%(82.73%) at epoch: 13                            
FedPer_join_0.1 achieved 90.0%(90.58%) at epoch: 40                            
Convergence (test_after):                                                      
FedPer_join_0.1 achieved 70.0%(78.83%) at epoch: 0                             
FedPer_join_0.1 achieved 80.0%(80.18%) at epoch: 1                             
FedPer_join_0.1 achieved 90.0%(91.48%) at epoch: 24                            
