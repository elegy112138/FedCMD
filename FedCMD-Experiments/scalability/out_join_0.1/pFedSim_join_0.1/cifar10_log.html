==================== ALGORITHM: pFedSim ====================                   
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'warmup_round': 0.5,                                                       
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.5917 -> 0.7395   acc: 9.69% -> 75.77%              
client [81] (test)  loss: 1.9721 -> 1.4318   acc: 0.00% -> 41.96%              
client [21] (test)  loss: 25.0006 -> 0.5935   acc: 1.40% -> 80.37%             
client [68] (test)  loss: 1.9794 -> 0.7736   acc: 1.28% -> 72.65%              
client [93] (test)  loss: 3.4249 -> 0.5299   acc: 10.68% -> 86.35%             
client [31] (test)  loss: 2.6529 -> 1.2966   acc: 0.00% -> 57.39%              
client [20] (test)  loss: 2.7516 -> 0.2650   acc: 0.00% -> 93.33%              
client [59] (test)  loss: 31.1665 -> 0.2167   acc: 1.01% -> 96.80%             
client [48] (test)  loss: 1.7972 -> 0.8142   acc: 6.98% -> 63.95%              
client [34] (test)  loss: 1.4025 -> 0.6191   acc: 68.40% -> 82.99%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.5640 -> 2.5680   acc: 59.85% -> 26.02%             
client [99] (test)  loss: 2.2864 -> 2.6248   acc: 18.82% -> 25.29%             
client [67] (test)  loss: 3.4469 -> 1.2303   acc: 9.76% -> 60.98%              
client [0] (test)  loss: 1.7722 -> 0.6282   acc: 1.57% -> 79.47%               
client [76] (test)  loss: 2.9565 -> 0.4753   acc: 26.21% -> 80.46%             
client [41] (test)  loss: 2.6232 -> 1.4439   acc: 7.32% -> 54.70%              
client [62] (test)  loss: 68.1929 -> 0.7789   acc: 0.00% -> 63.71%             
client [2] (test)  loss: 64.6972 -> 1.0140   acc: 0.00% -> 67.50%              
client [14] (test)  loss: 1.6386 -> 0.1269   acc: 36.73% -> 97.11%             
client [46] (test)  loss: 3.2040 -> 0.3960   acc: 6.16% -> 85.31%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3765 -> 0.7433   acc: 43.26% -> 74.29%             
client [68] (test)  loss: 3.0585 -> 0.5492   acc: 5.98% -> 82.48%              
client [57] (test)  loss: 1.5676 -> 0.5339   acc: 33.47% -> 76.00%             
client [17] (test)  loss: 2.1723 -> 0.1910   acc: 2.06% -> 94.51%              
client [54] (test)  loss: 3.0813 -> 0.6454   acc: 3.15% -> 72.68%              
client [23] (test)  loss: 139.9893 -> 1.2964   acc: 5.71% -> 57.14%            
client [35] (test)  loss: 3.8398 -> 0.5747   acc: 0.00% -> 85.92%              
client [59] (test)  loss: 4.7745 -> 0.1557   acc: 0.84% -> 96.80%              
client [31] (test)  loss: 3.3782 -> 1.0195   acc: 0.00% -> 57.39%              
client [9] (test)  loss: 4.0560 -> 0.2100   acc: 0.20% -> 94.01%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.0638 -> 0.8628   acc: 3.70% -> 74.07%              
client [33] (test)  loss: 3.4874 -> 0.5219   acc: 0.65% -> 87.58%              
client [16] (test)  loss: 5.0694 -> 0.4170   acc: 0.00% -> 88.27%              
client [44] (test)  loss: 9.4696 -> 0.0900   acc: 0.24% -> 98.66%              
client [8] (test)  loss: 1.8150 -> 0.0013   acc: 1.52% -> 100.00%              
client [31] (test)  loss: 6.6140 -> 0.9942   acc: 0.00% -> 57.95%              
client [47] (test)  loss: 0.6866 -> 0.5286   acc: 76.34% -> 82.44%             
client [36] (test)  loss: 2.4974 -> 0.3953   acc: 12.17% -> 86.96%             
client [20] (test)  loss: 3.3086 -> 0.2422   acc: 0.51% -> 94.87%              
client [56] (test)  loss: 3.2496 -> 0.3203   acc: 2.27% -> 92.05%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.8350 -> 0.3816   acc: 9.78% -> 88.89%               
client [60] (test)  loss: 3.6578 -> 0.2743   acc: 4.58% -> 91.25%              
client [28] (test)  loss: 3.9797 -> 0.8303   acc: 3.74% -> 72.73%              
client [25] (test)  loss: 1.4257 -> 0.6034   acc: 47.30% -> 77.78%             
client [58] (test)  loss: 5.1055 -> 0.7540   acc: 2.79% -> 72.07%              
client [44] (test)  loss: 4.5455 -> 0.0947   acc: 0.00% -> 98.66%              
client [39] (test)  loss: 2.2288 -> 0.3602   acc: 7.90% -> 85.11%              
client [29] (test)  loss: 3.4651 -> 0.4472   acc: 10.95% -> 86.19%             
client [3] (test)  loss: 2.8527 -> 0.2864   acc: 20.00% -> 90.32%              
client [84] (test)  loss: 1.7071 -> 0.7879   acc: 48.59% -> 75.71%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 6.2250 -> 0.8094   acc: 1.40% -> 77.10%              
client [84] (test)  loss: 2.3219 -> 0.8204   acc: 24.86% -> 75.14%             
client [10] (test)  loss: 3.7331 -> 0.5016   acc: 3.66% -> 80.35%              
client [36] (test)  loss: 2.2462 -> 0.3578   acc: 8.70% -> 87.83%              
client [65] (test)  loss: 1.4757 -> 0.3367   acc: 42.35% -> 86.67%             
client [81] (test)  loss: 2.6032 -> 1.1518   acc: 34.38% -> 54.46%             
client [79] (test)  loss: 1.7202 -> 0.7919   acc: 36.26% -> 74.27%             
client [42] (test)  loss: 3.6925 -> 0.0947   acc: 1.49% -> 97.12%              
client [11] (test)  loss: 6.5557 -> 0.7001   acc: 0.51% -> 73.42%              
client [96] (test)  loss: 2.1070 -> 0.7866   acc: 38.46% -> 71.15%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9320 -> 0.0009   acc: 76.43% -> 100.00%             
client [53] (test)  loss: 5.3129 -> 0.1780   acc: 5.61% -> 93.46%              
client [52] (test)  loss: 1.7657 -> 0.3802   acc: 32.04% -> 85.91%             
client [42] (test)  loss: 2.9695 -> 0.0840   acc: 3.94% -> 97.55%              
client [69] (test)  loss: 2.9482 -> 0.6493   acc: 12.27% -> 81.78%             
client [59] (test)  loss: 5.7424 -> 0.1621   acc: 0.34% -> 95.79%              
client [7] (test)  loss: 1.3952 -> 0.6907   acc: 43.06% -> 75.00%              
client [26] (test)  loss: 1.9466 -> 0.5748   acc: 32.89% -> 81.58%             
client [49] (test)  loss: 1.0127 -> 0.0307   acc: 38.76% -> 99.64%             
client [98] (test)  loss: 2.7288 -> 0.9716   acc: 20.90% -> 68.66%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.4460 -> 0.8944   acc: 32.84% -> 68.66%             
client [47] (test)  loss: 3.1870 -> 0.5159   acc: 14.34% -> 82.44%             
client [21] (test)  loss: 4.1922 -> 0.8075   acc: 0.93% -> 76.64%              
client [77] (test)  loss: 5.1777 -> 0.6586   acc: 0.44% -> 80.62%              
client [95] (test)  loss: 1.3938 -> 0.4356   acc: 65.76% -> 84.75%             
client [91] (test)  loss: 2.3857 -> 0.4575   acc: 6.00% -> 82.67%              
client [14] (test)  loss: 1.0090 -> 0.0680   acc: 69.39% -> 98.47%             
client [99] (test)  loss: 2.2420 -> 1.8297   acc: 34.12% -> 41.18%             
client [20] (test)  loss: 3.2531 -> 0.2329   acc: 14.87% -> 93.33%             
client [39] (test)  loss: 1.3390 -> 0.3954   acc: 25.23% -> 84.80%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.8115 -> 0.3513   acc: 14.86% -> 87.62%             
client [62] (test)  loss: 3.5050 -> 0.1848   acc: 4.03% -> 93.95%              
client [71] (test)  loss: 4.2775 -> 0.1120   acc: 10.57% -> 97.97%             
client [97] (test)  loss: 1.6983 -> 0.0011   acc: 48.91% -> 100.00%            
client [30] (test)  loss: 1.8731 -> 0.9578   acc: 32.00% -> 76.00%             
client [88] (test)  loss: 6.6182 -> 0.6628   acc: 2.90% -> 81.16%              
client [60] (test)  loss: 3.6740 -> 0.2473   acc: 3.75% -> 92.92%              
client [82] (test)  loss: 2.5460 -> 0.9742   acc: 26.97% -> 67.42%             
client [91] (test)  loss: 5.4432 -> 0.4470   acc: 4.67% -> 83.33%              
client [57] (test)  loss: 2.4118 -> 0.6324   acc: 30.32% -> 71.58%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.4517 -> 1.4025   acc: 23.86% -> 60.23%             
client [15] (test)  loss: 2.5986 -> 0.6218   acc: 6.02% -> 80.72%              
client [71] (test)  loss: 5.0997 -> 0.1300   acc: 2.03% -> 97.97%              
client [97] (test)  loss: 3.2570 -> 0.0013   acc: 4.36% -> 100.00%             
client [53] (test)  loss: 5.2820 -> 0.1587   acc: 1.87% -> 94.39%              
client [77] (test)  loss: 7.0479 -> 0.6262   acc: 0.88% -> 83.26%              
client [76] (test)  loss: 1.7828 -> 0.4141   acc: 38.62% -> 82.30%             
client [79] (test)  loss: 2.2353 -> 0.7561   acc: 34.50% -> 74.27%             
client [28] (test)  loss: 2.8458 -> 0.8648   acc: 11.76% -> 70.05%             
client [99] (test)  loss: 1.7278 -> 1.7093   acc: 41.18% -> 44.12%             
                               TRAINING EPOCH: 110                             
client [97] (test)  loss: 1.2983 -> 0.0008   acc: 63.07% -> 100.00%            
client [86] (test)  loss: 1.1438 -> 0.8036   acc: 63.35% -> 72.77%             
client [34] (test)  loss: 0.6866 -> 0.4589   acc: 75.35% -> 85.42%             
client [73] (test)  loss: 1.3879 -> 1.0152   acc: 59.09% -> 70.45%             
client [5] (test)  loss: 1.5674 -> 0.5678   acc: 43.01% -> 81.72%              
client [96] (test)  loss: 5.9287 -> 0.7290   acc: 0.00% -> 69.23%              
client [22] (test)  loss: 0.2387 -> 0.2834   acc: 93.23% -> 90.98%             
client [60] (test)  loss: 0.6220 -> 0.2368   acc: 78.33% -> 92.50%             
client [66] (test)  loss: 0.8882 -> 0.2813   acc: 74.54% -> 91.05%             
client [83] (test)  loss: 3.6717 -> 0.0010   acc: 13.65% -> 100.00%            
                               TRAINING EPOCH: 120                             
client [76] (test)  loss: 0.6456 -> 0.4461   acc: 75.40% -> 83.68%             
client [65] (test)  loss: 1.1915 -> 0.3493   acc: 63.14% -> 86.67%             
client [95] (test)  loss: 0.6275 -> 0.4722   acc: 81.02% -> 84.75%             
client [17] (test)  loss: 5.0510 -> 0.1325   acc: 0.00% -> 95.47%              
client [8] (test)  loss: 4.5860 -> 0.0006   acc: 3.42% -> 100.00%              
client [35] (test)  loss: 0.9868 -> 0.5591   acc: 69.01% -> 74.65%             
client [98] (test)  loss: 1.3974 -> 0.8236   acc: 50.75% -> 67.16%             
client [53] (test)  loss: 3.7590 -> 0.1515   acc: 14.95% -> 93.46%             
client [43] (test)  loss: 7.9556 -> 0.8803   acc: 1.24% -> 67.77%              
client [64] (test)  loss: 1.0623 -> 0.7290   acc: 74.07% -> 85.19%             
                               TRAINING EPOCH: 130                             
client [21] (test)  loss: 0.7033 -> 0.6422   acc: 75.70% -> 80.84%             
client [88] (test)  loss: 1.1514 -> 0.6240   acc: 63.77% -> 82.61%             
client [38] (test)  loss: 1.9942 -> 2.0740   acc: 40.00% -> 45.71%             
client [3] (test)  loss: 1.0107 -> 0.2797   acc: 71.29% -> 90.97%              
client [5] (test)  loss: 1.1717 -> 0.6598   acc: 66.67% -> 78.49%              
client [41] (test)  loss: 0.9567 -> 0.8043   acc: 65.16% -> 72.82%             
client [7] (test)  loss: 1.1274 -> 0.6152   acc: 65.28% -> 79.17%              
client [37] (test)  loss: 1.3486 -> 0.9073   acc: 46.84% -> 71.05%             
client [45] (test)  loss: 5.1322 -> 0.2713   acc: 0.17% -> 91.60%              
client [47] (test)  loss: 3.7477 -> 0.4936   acc: 4.30% -> 83.51%              
                               TRAINING EPOCH: 140                             
client [16] (test)  loss: 0.5912 -> 0.4425   acc: 81.01% -> 84.36%             
client [11] (test)  loss: 0.8663 -> 0.6643   acc: 68.35% -> 74.94%             
client [37] (test)  loss: 1.0557 -> 0.9312   acc: 60.53% -> 70.53%             
client [41] (test)  loss: 0.8662 -> 0.8033   acc: 66.55% -> 72.47%             
client [95] (test)  loss: 0.9299 -> 0.4856   acc: 73.22% -> 84.41%             
client [53] (test)  loss: 0.8710 -> 0.1149   acc: 62.62% -> 94.39%             
client [22] (test)  loss: 0.4603 -> 0.2675   acc: 84.96% -> 91.73%             
client [25] (test)  loss: 0.9802 -> 0.5951   acc: 60.63% -> 78.41%             
client [69] (test)  loss: 0.7163 -> 0.6356   acc: 74.72% -> 84.76%             
client [46] (test)  loss: 0.3163 -> 0.2398   acc: 90.52% -> 92.42%             
                               TRAINING EPOCH: 150                             
client [47] (test)  loss: 0.7427 -> 0.5198   acc: 75.63% -> 84.23%             
client [69] (test)  loss: 0.6941 -> 0.6878   acc: 77.32% -> 83.64%             
client [82] (test)  loss: 1.6733 -> 0.9130   acc: 41.01% -> 67.42%             
client [45] (test)  loss: 0.3629 -> 0.2994   acc: 88.85% -> 91.77%             
client [7] (test)  loss: 1.6753 -> 0.6515   acc: 55.56% -> 72.22%              
client [50] (test)  loss: 1.2123 -> 0.3156   acc: 71.98% -> 89.38%             
client [35] (test)  loss: 0.5188 -> 0.4593   acc: 88.73% -> 78.87%             
client [24] (test)  loss: 0.8592 -> 0.7870   acc: 68.34% -> 76.18%             
client [15] (test)  loss: 0.5574 -> 0.5978   acc: 79.52% -> 80.72%             
client [58] (test)  loss: 0.9611 -> 0.8297   acc: 66.48% -> 73.18%             
                               TRAINING EPOCH: 160                             
client [48] (test)  loss: 0.8453 -> 0.6548   acc: 77.91% -> 80.23%             
client [76] (test)  loss: 0.8769 -> 0.4981   acc: 71.26% -> 81.38%             
client [67] (test)  loss: 2.0973 -> 1.0910   acc: 39.02% -> 60.98%             
client [37] (test)  loss: 0.9558 -> 0.9156   acc: 64.21% -> 70.53%             
client [58] (test)  loss: 0.9572 -> 0.8357   acc: 67.04% -> 72.63%             
client [64] (test)  loss: 0.5963 -> 0.6533   acc: 81.48% -> 81.48%             
client [77] (test)  loss: 3.6760 -> 0.6153   acc: 48.90% -> 84.14%             
client [55] (test)  loss: 2.1371 -> 0.8792   acc: 34.92% -> 63.49%             
client [12] (test)  loss: 1.2510 -> 0.7029   acc: 65.87% -> 78.57%             
client [89] (test)  loss: 0.7221 -> 0.4627   acc: 76.36% -> 87.27%             
                               TRAINING EPOCH: 170                             
client [84] (test)  loss: 1.1621 -> 0.9079   acc: 64.41% -> 71.19%             
client [51] (test)  loss: 0.0095 -> 0.0010   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.0004 -> 0.0012   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.7830 -> 0.7348   acc: 69.02% -> 73.91%             
client [94] (test)  loss: 0.5606 -> 0.3190   acc: 78.85% -> 92.31%             
client [81] (test)  loss: 2.3229 -> 1.0696   acc: 44.64% -> 59.82%             
client [3] (test)  loss: 1.0905 -> 0.2842   acc: 70.65% -> 91.29%              
client [11] (test)  loss: 0.8724 -> 0.6713   acc: 68.86% -> 76.46%             
client [95] (test)  loss: 1.1498 -> 0.4915   acc: 67.80% -> 84.75%             
client [67] (test)  loss: 1.8267 -> 1.0732   acc: 43.90% -> 60.98%             
                               TRAINING EPOCH: 180                             
client [21] (test)  loss: 0.4952 -> 0.8208   acc: 82.24% -> 78.97%             
client [79] (test)  loss: 1.0515 -> 0.7852   acc: 63.16% -> 74.27%             
client [58] (test)  loss: 0.9650 -> 0.8557   acc: 70.39% -> 71.51%             
client [88] (test)  loss: 0.6275 -> 0.6290   acc: 79.71% -> 82.61%             
client [46] (test)  loss: 0.2393 -> 0.2435   acc: 91.94% -> 91.94%             
client [11] (test)  loss: 0.8925 -> 0.6720   acc: 68.61% -> 76.71%             
client [55] (test)  loss: 2.3743 -> 0.8941   acc: 31.75% -> 63.49%             
client [13] (test)  loss: 0.9314 -> 0.8398   acc: 64.45% -> 64.45%             
client [31] (test)  loss: 0.8282 -> 1.2762   acc: 67.05% -> 63.07%             
client [75] (test)  loss: 0.3878 -> 0.1937   acc: 90.03% -> 94.37%             
                               TRAINING EPOCH: 190                             
client [19] (test)  loss: 0.7267 -> 0.5885   acc: 71.79% -> 80.34%             
client [7] (test)  loss: 1.7387 -> 0.5842   acc: 55.56% -> 76.39%              
client [57] (test)  loss: 0.4889 -> 0.8185   acc: 78.74% -> 66.74%             
client [13] (test)  loss: 0.9346 -> 0.8330   acc: 64.74% -> 64.45%             
client [43] (test)  loss: 2.1298 -> 0.6585   acc: 54.55% -> 76.45%             
client [91] (test)  loss: 0.7097 -> 0.4272   acc: 78.67% -> 84.00%             
client [10] (test)  loss: 1.1343 -> 0.4563   acc: 61.66% -> 85.16%             
client [64] (test)  loss: 0.5816 -> 0.6250   acc: 81.48% -> 81.48%             
client [82] (test)  loss: 1.2087 -> 0.9318   acc: 57.30% -> 67.42%             
client [22] (test)  loss: 0.4426 -> 0.2824   acc: 89.47% -> 92.48%             
                               TRAINING EPOCH: 200                             
client [20] (test)  loss: 0.2129 -> 0.2181   acc: 94.36% -> 94.36%             
client [23] (test)  loss: 2.7141 -> 1.1564   acc: 17.14% -> 65.71%             
client [88] (test)  loss: 0.6279 -> 0.6253   acc: 81.16% -> 82.61%             
client [98] (test)  loss: 0.6662 -> 0.7238   acc: 73.13% -> 71.64%             
client [79] (test)  loss: 1.2495 -> 0.7909   acc: 59.06% -> 74.27%             
client [21] (test)  loss: 0.4603 -> 0.7834   acc: 84.11% -> 79.91%             
client [92] (test)  loss: 0.0636 -> 0.0589   acc: 99.07% -> 99.22%             
client [56] (test)  loss: 0.3415 -> 0.3207   acc: 92.05% -> 91.48%             
client [5] (test)  loss: 1.2386 -> 0.7262   acc: 65.59% -> 76.34%              
client [52] (test)  loss: 0.3313 -> 0.4282   acc: 89.32% -> 85.14%             
==================== pFedSim TEST RESULTS: ====================                
{                                                                              
    100: {'loss': '3.0828 -> 0.0000', 'accuracy': '19.39% -> 0.00%'},          
    200: {'loss': '0.4119 -> 0.0000', 'accuracy': '86.80% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedSim achieved 10.0%(17.79%) at epoch: 0                                     
pFedSim achieved 20.0%(24.01%) at epoch: 4                                     
pFedSim achieved 30.0%(32.62%) at epoch: 18                                    
pFedSim achieved 50.0%(54.65%) at epoch: 40                                    
pFedSim achieved 60.0%(62.93%) at epoch: 109                                   
pFedSim achieved 70.0%(72.52%) at epoch: 112                                   
pFedSim achieved 80.0%(80.62%) at epoch: 114                                   
pFedSim achieved 90.0%(95.29%) at epoch: 151                                   
Convergence (test_after):                                                      
pFedSim achieved 70.0%(75.11%) at epoch: 0                                     
pFedSim achieved 80.0%(86.48%) at epoch: 4                                     
pFedSim achieved 90.0%(93.02%) at epoch: 11                                    
