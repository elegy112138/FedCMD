==================== ALGORITHM: FedBN_join_0.1 ====================            
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.4918 -> 0.0064   acc: 87.04% -> 100.00%            
client [81] (test)  loss: 1.5660 -> 0.3821   acc: 38.18% -> 85.45%             
client [21] (test)  loss: 42.8329 -> 0.3345   acc: 26.81% -> 87.44%            
client [68] (test)  loss: 0.5489 -> 0.1613   acc: 93.73% -> 95.47%             
client [93] (test)  loss: 2.6436 -> 0.1697   acc: 8.00% -> 96.80%              
client [31] (test)  loss: 1.9978 -> 0.2853   acc: 21.67% -> 93.89%             
client [20] (test)  loss: 1.4599 -> 0.0750   acc: 53.00% -> 96.83%             
client [59] (test)  loss: 18.5027 -> 0.4162   acc: 33.87% -> 87.10%            
client [48] (test)  loss: 1.9407 -> 0.0917   acc: 0.00% -> 98.75%              
client [34] (test)  loss: 1.0330 -> 0.2607   acc: 82.35% -> 94.12%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.3681 -> 0.1947   acc: 46.93% -> 94.93%             
client [99] (test)  loss: 2.8871 -> 0.0823   acc: 9.94% -> 98.30%              
client [67] (test)  loss: 2.6557 -> 0.1547   acc: 9.67% -> 95.54%              
client [0] (test)  loss: 0.8529 -> 0.5227   acc: 75.70% -> 83.18%              
client [76] (test)  loss: 0.9523 -> 0.3162   acc: 78.95% -> 94.74%             
client [41] (test)  loss: 0.9805 -> 0.2806   acc: 70.21% -> 89.12%             
client [62] (test)  loss: 53.6315 -> 0.5676   acc: 38.10% -> 92.86%            
client [2] (test)  loss: 12.7182 -> 0.0009   acc: 45.22% -> 100.00%            
client [14] (test)  loss: 3.2195 -> 0.1021   acc: 5.37% -> 96.91%              
client [46] (test)  loss: 3.1066 -> 0.3046   acc: 7.05% -> 91.19%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9548 -> 0.4365   acc: 65.03% -> 83.16%             
client [68] (test)  loss: 0.5340 -> 0.1070   acc: 81.18% -> 96.52%             
client [57] (test)  loss: 0.6893 -> 0.0279   acc: 79.89% -> 99.25%             
client [17] (test)  loss: 1.2125 -> 0.1421   acc: 34.53% -> 95.30%             
client [54] (test)  loss: 0.4382 -> 0.2076   acc: 81.87% -> 92.23%             
client [23] (test)  loss: 10.1792 -> 0.1224   acc: 70.30% -> 96.99%            
client [35] (test)  loss: 1.1322 -> 0.1792   acc: 50.91% -> 93.94%             
client [59] (test)  loss: 0.9115 -> 0.2935   acc: 51.94% -> 90.32%             
client [31] (test)  loss: 0.8930 -> 0.1796   acc: 61.67% -> 95.00%             
client [9] (test)  loss: 0.4810 -> 0.0363   acc: 82.99% -> 98.55%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.6839 -> 0.1619   acc: 81.76% -> 95.59%             
client [33] (test)  loss: 0.3660 -> 0.0715   acc: 84.70% -> 97.03%             
client [16] (test)  loss: 0.8023 -> 0.0490   acc: 57.34% -> 98.95%             
client [44] (test)  loss: 1.0694 -> 0.1311   acc: 61.17% -> 95.60%             
client [8] (test)  loss: 0.7513 -> 0.0018   acc: 73.87% -> 100.00%             
client [31] (test)  loss: 0.8419 -> 0.1628   acc: 69.44% -> 94.44%             
client [47] (test)  loss: 0.4569 -> 0.0221   acc: 81.99% -> 99.45%             
client [36] (test)  loss: 0.1342 -> 0.0061   acc: 97.30% -> 99.88%             
client [20] (test)  loss: 1.0991 -> 0.0163   acc: 55.67% -> 99.00%             
client [56] (test)  loss: 0.7000 -> 0.2876   acc: 80.49% -> 90.65%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.6532 -> 0.0973   acc: 77.16% -> 96.89%              
client [60] (test)  loss: 2.1929 -> 0.0823   acc: 23.60% -> 97.68%             
client [28] (test)  loss: 0.2870 -> 0.0516   acc: 92.86% -> 97.32%             
client [25] (test)  loss: 1.4525 -> 0.0972   acc: 45.99% -> 96.52%             
client [58] (test)  loss: 1.5813 -> 0.0832   acc: 50.55% -> 97.45%             
client [44] (test)  loss: 1.2499 -> 0.1390   acc: 50.55% -> 95.60%             
client [39] (test)  loss: 0.3707 -> 0.1010   acc: 88.89% -> 94.44%             
client [29] (test)  loss: 1.9970 -> 0.2694   acc: 31.05% -> 89.50%             
client [3] (test)  loss: 0.5326 -> 0.1481   acc: 78.44% -> 94.93%              
client [84] (test)  loss: 1.9978 -> 0.0168   acc: 30.28% -> 99.54%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8164 -> 0.2151   acc: 67.39% -> 91.30%             
client [84] (test)  loss: 1.0912 -> 0.0193   acc: 50.46% -> 99.54%             
client [10] (test)  loss: 0.3679 -> 0.0579   acc: 90.58% -> 96.38%             
client [36] (test)  loss: 0.0629 -> 0.0052   acc: 98.65% -> 99.75%             
client [65] (test)  loss: 1.4679 -> 0.1888   acc: 33.33% -> 96.43%             
client [81] (test)  loss: 0.7152 -> 0.1480   acc: 77.27% -> 95.45%             
client [79] (test)  loss: 1.1869 -> 0.3483   acc: 53.32% -> 87.47%             
client [42] (test)  loss: 0.7735 -> 0.0323   acc: 70.67% -> 99.05%             
client [11] (test)  loss: 1.0520 -> 0.4355   acc: 57.11% -> 84.00%             
client [96] (test)  loss: 0.5359 -> 0.2237   acc: 80.90% -> 94.10%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.3996 -> 0.0016   acc: 88.29% -> 100.00%             
client [53] (test)  loss: 0.3528 -> 0.0334   acc: 87.66% -> 99.49%             
client [52] (test)  loss: 1.0588 -> 0.2556   acc: 55.81% -> 87.60%             
client [42] (test)  loss: 0.1735 -> 0.0322   acc: 95.90% -> 98.99%             
client [69] (test)  loss: 0.5986 -> 0.1443   acc: 81.07% -> 95.20%             
client [59] (test)  loss: 0.6985 -> 0.2492   acc: 73.23% -> 91.61%             
client [7] (test)  loss: 0.3613 -> 0.0483   acc: 87.85% -> 98.16%              
client [26] (test)  loss: 0.4249 -> 0.0091   acc: 88.95% -> 99.92%             
client [49] (test)  loss: 0.7442 -> 0.0021   acc: 78.13% -> 100.00%            
client [98] (test)  loss: 0.5483 -> 0.4711   acc: 84.00% -> 79.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8869 -> 0.2759   acc: 62.00% -> 89.00%             
client [47] (test)  loss: 0.5602 -> 0.0229   acc: 79.04% -> 99.08%             
client [21] (test)  loss: 0.5649 -> 0.1827   acc: 79.47% -> 93.24%             
client [77] (test)  loss: 0.1845 -> 0.0187   acc: 92.96% -> 99.72%             
client [95] (test)  loss: 0.6542 -> 0.1231   acc: 77.44% -> 95.49%             
client [91] (test)  loss: 0.8003 -> 0.1064   acc: 65.62% -> 96.88%             
client [14] (test)  loss: 0.1391 -> 0.0915   acc: 96.91% -> 97.85%             
client [99] (test)  loss: 0.1320 -> 0.0727   acc: 97.16% -> 98.01%             
client [20] (test)  loss: 2.4946 -> 0.0107   acc: 6.33% -> 99.50%              
client [39] (test)  loss: 0.2250 -> 0.0996   acc: 97.22% -> 97.22%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.7576 -> 0.2554   acc: 70.54% -> 87.60%             
client [62] (test)  loss: 0.7083 -> 0.2728   acc: 73.81% -> 92.86%             
client [71] (test)  loss: 0.2394 -> 0.0395   acc: 92.04% -> 98.19%             
client [97] (test)  loss: 0.2065 -> 0.0550   acc: 94.25% -> 99.01%             
client [30] (test)  loss: 0.1724 -> 0.1130   acc: 95.13% -> 96.63%             
client [88] (test)  loss: 1.4295 -> 0.3635   acc: 43.65% -> 87.29%             
client [60] (test)  loss: 1.2183 -> 0.0741   acc: 50.10% -> 98.07%             
client [82] (test)  loss: 1.5135 -> 0.0252   acc: 47.44% -> 99.68%             
client [91] (test)  loss: 0.7308 -> 0.0383   acc: 59.38% -> 100.00%            
client [57] (test)  loss: 1.1663 -> 0.0252   acc: 58.46% -> 99.25%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6659 -> 0.1186   acc: 77.22% -> 94.44%             
client [15] (test)  loss: 0.5164 -> 0.1909   acc: 79.83% -> 92.14%             
client [71] (test)  loss: 0.2633 -> 0.0406   acc: 91.32% -> 98.37%             
client [97] (test)  loss: 0.3831 -> 0.0535   acc: 89.00% -> 99.18%             
client [53] (test)  loss: 0.2865 -> 0.0326   acc: 90.39% -> 99.29%             
client [77] (test)  loss: 0.0294 -> 0.0120   acc: 99.15% -> 99.72%             
client [76] (test)  loss: 0.2560 -> 0.1487   acc: 86.84% -> 94.74%             
client [79] (test)  loss: 0.9376 -> 0.3400   acc: 58.23% -> 87.47%             
client [28] (test)  loss: 0.3221 -> 0.0310   acc: 86.61% -> 100.00%            
client [99] (test)  loss: 0.8640 -> 0.0656   acc: 64.49% -> 98.01%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.5074 -> 0.0533   acc: 81.61% -> 99.01%             
client [86] (test)  loss: 0.2676 -> 0.0976   acc: 94.74% -> 98.25%             
client [34] (test)  loss: 0.1327 -> 0.0802   acc: 98.53% -> 95.59%             
client [73] (test)  loss: 0.8184 -> 0.0301   acc: 70.00% -> 99.29%             
client [5] (test)  loss: 0.5827 -> 0.0464   acc: 78.17% -> 99.13%              
client [96] (test)  loss: 0.5331 -> 0.2054   acc: 82.30% -> 94.66%             
client [22] (test)  loss: 0.6414 -> 0.0898   acc: 78.30% -> 97.17%             
client [60] (test)  loss: 0.5979 -> 0.0751   acc: 78.34% -> 97.87%             
client [66] (test)  loss: 1.1962 -> 0.0046   acc: 68.72% -> 100.00%            
client [83] (test)  loss: 0.4288 -> 0.0368   acc: 84.99% -> 98.94%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.1647 -> 0.1441   acc: 97.37% -> 94.74%             
client [65] (test)  loss: 0.7263 -> 0.1727   acc: 70.24% -> 95.24%             
client [95] (test)  loss: 0.1934 -> 0.1116   acc: 94.74% -> 96.24%             
client [17] (test)  loss: 0.3986 -> 0.1134   acc: 90.33% -> 95.58%             
client [8] (test)  loss: 0.5378 -> 0.0012   acc: 83.56% -> 100.00%             
client [35] (test)  loss: 0.4193 -> 0.1685   acc: 86.06% -> 94.55%             
client [98] (test)  loss: 0.5884 -> 0.2238   acc: 79.00% -> 91.00%             
client [53] (test)  loss: 0.1757 -> 0.0287   acc: 94.34% -> 99.19%             
client [43] (test)  loss: 1.0467 -> 0.1250   acc: 60.00% -> 95.56%             
client [64] (test)  loss: 0.2783 -> 0.1136   acc: 91.76% -> 96.18%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.4313 -> 0.1574   acc: 84.54% -> 93.24%             
client [88] (test)  loss: 0.8621 -> 0.3348   acc: 67.96% -> 87.85%             
client [38] (test)  loss: 0.8506 -> 0.3777   acc: 69.70% -> 87.88%             
client [3] (test)  loss: 0.4750 -> 0.1369   acc: 82.07% -> 95.47%              
client [5] (test)  loss: 1.0125 -> 0.0495   acc: 63.10% -> 98.91%              
client [41] (test)  loss: 0.3777 -> 0.1839   acc: 88.47% -> 93.01%             
client [7] (test)  loss: 0.5743 -> 0.0353   acc: 78.08% -> 98.71%              
client [37] (test)  loss: 0.5050 -> 0.1179   acc: 79.90% -> 94.85%             
client [45] (test)  loss: 0.4384 -> 0.3089   acc: 83.33% -> 85.90%             
client [47] (test)  loss: 0.8355 -> 0.0205   acc: 68.93% -> 98.90%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.7043 -> 0.0348   acc: 44.76% -> 98.95%             
client [11] (test)  loss: 2.4588 -> 0.3108   acc: 20.22% -> 87.56%             
client [37] (test)  loss: 2.9068 -> 0.1334   acc: 8.76% -> 93.81%              
client [41] (test)  loss: 1.0688 -> 0.1742   acc: 61.79% -> 93.39%             
client [95] (test)  loss: 0.5249 -> 0.1404   acc: 82.71% -> 95.49%             
client [53] (test)  loss: 0.3441 -> 0.0344   acc: 89.08% -> 99.19%             
client [22] (test)  loss: 1.6404 -> 0.0820   acc: 34.43% -> 97.64%             
client [25] (test)  loss: 0.8237 -> 0.0733   acc: 73.87% -> 97.21%             
client [69] (test)  loss: 0.7036 -> 0.1251   acc: 77.60% -> 94.93%             
client [46] (test)  loss: 0.3431 -> 0.2678   acc: 91.19% -> 90.75%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.3610 -> 0.0233   acc: 85.66% -> 98.90%             
client [69] (test)  loss: 1.0649 -> 0.1267   acc: 69.07% -> 94.40%             
client [82] (test)  loss: 0.5913 -> 0.0246   acc: 75.48% -> 99.68%             
client [45] (test)  loss: 0.5519 -> 0.2969   acc: 85.90% -> 88.46%             
client [7] (test)  loss: 0.4443 -> 0.0394   acc: 82.50% -> 98.71%              
client [50] (test)  loss: 1.0287 -> 0.0023   acc: 49.33% -> 100.00%            
client [35] (test)  loss: 0.5682 -> 0.1700   acc: 79.39% -> 95.76%             
client [24] (test)  loss: 0.6722 -> 0.4256   acc: 74.87% -> 84.46%             
client [15] (test)  loss: 0.8529 -> 0.1926   acc: 66.03% -> 92.57%             
client [58] (test)  loss: 0.3080 -> 0.0622   acc: 89.05% -> 97.81%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2341 -> 0.0522   acc: 93.12% -> 98.12%             
client [76] (test)  loss: 0.2350 -> 0.1292   acc: 94.74% -> 97.37%             
client [67] (test)  loss: 0.9655 -> 0.1150   acc: 62.50% -> 95.98%             
client [37] (test)  loss: 0.2878 -> 0.1341   acc: 89.18% -> 94.33%             
client [58] (test)  loss: 0.2511 -> 0.0698   acc: 91.97% -> 97.81%             
client [64] (test)  loss: 0.3093 -> 0.1194   acc: 89.12% -> 96.47%             
client [77] (test)  loss: 0.0519 -> 0.0167   acc: 98.87% -> 99.44%             
client [55] (test)  loss: 0.1016 -> 0.0083   acc: 97.32% -> 99.71%             
client [12] (test)  loss: 2.0308 -> 0.3301   acc: 31.23% -> 89.59%             
client [89] (test)  loss: 1.0145 -> 0.6489   acc: 64.29% -> 85.71%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.2494 -> 0.0230   acc: 92.20% -> 99.08%             
client [51] (test)  loss: 0.5134 -> 0.0125   acc: 82.31% -> 99.49%             
client [8] (test)  loss: 0.6261 -> 0.0013   acc: 81.76% -> 100.00%             
client [18] (test)  loss: 0.0705 -> 0.0074   acc: 99.03% -> 99.76%             
client [94] (test)  loss: 0.2751 -> 0.1374   acc: 91.84% -> 95.74%             
client [81] (test)  loss: 0.6136 -> 0.0553   acc: 79.09% -> 98.18%             
client [3] (test)  loss: 0.3026 -> 0.1381   acc: 88.77% -> 95.47%              
client [11] (test)  loss: 1.2769 -> 0.3424   acc: 55.56% -> 86.89%             
client [95] (test)  loss: 0.4684 -> 0.1190   acc: 87.97% -> 96.24%             
client [67] (test)  loss: 0.6900 -> 0.1142   acc: 74.85% -> 96.13%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7415 -> 0.1401   acc: 74.88% -> 93.00%             
client [79] (test)  loss: 0.8797 -> 0.2781   acc: 65.60% -> 89.43%             
client [58] (test)  loss: 0.1399 -> 0.0686   acc: 96.53% -> 97.63%             
client [88] (test)  loss: 0.8825 -> 0.3740   acc: 62.43% -> 86.19%             
client [46] (test)  loss: 1.1359 -> 0.2901   acc: 57.27% -> 89.87%             
client [11] (test)  loss: 1.0705 -> 0.3548   acc: 61.11% -> 88.00%             
client [55] (test)  loss: 0.0255 -> 0.0092   acc: 99.62% -> 99.71%             
client [13] (test)  loss: 0.3165 -> 0.0017   acc: 90.71% -> 100.00%            
client [31] (test)  loss: 0.5390 -> 0.1095   acc: 84.44% -> 94.44%             
client [75] (test)  loss: 0.5943 -> 0.2229   acc: 79.66% -> 91.53%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.4185 -> 0.2500   acc: 82.68% -> 88.19%             
client [7] (test)  loss: 0.2582 -> 0.0347   acc: 92.63% -> 98.53%              
client [57] (test)  loss: 0.2633 -> 0.0255   acc: 91.54% -> 99.44%             
client [13] (test)  loss: 0.7241 -> 0.0016   acc: 66.94% -> 100.00%            
client [43] (test)  loss: 0.5549 -> 0.1199   acc: 79.26% -> 94.81%             
client [91] (test)  loss: 0.2831 -> 0.0776   acc: 90.62% -> 96.88%             
client [10] (test)  loss: 0.1136 -> 0.0424   acc: 94.93% -> 97.10%             
client [64] (test)  loss: 0.3472 -> 0.1250   acc: 86.76% -> 96.76%             
client [82] (test)  loss: 0.2654 -> 0.0264   acc: 91.83% -> 99.68%             
client [22] (test)  loss: 0.5669 -> 0.1022   acc: 79.25% -> 96.70%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.3372 -> 0.0168   acc: 46.83% -> 99.50%             
client [23] (test)  loss: 1.1395 -> 0.0806   acc: 57.52% -> 97.37%             
client [88] (test)  loss: 1.3383 -> 0.4108   acc: 58.01% -> 82.87%             
client [98] (test)  loss: 0.7393 -> 0.2521   acc: 73.00% -> 91.00%             
client [79] (test)  loss: 1.0983 -> 0.2764   acc: 61.67% -> 90.42%             
client [21] (test)  loss: 0.2694 -> 0.1395   acc: 88.65% -> 92.75%             
client [92] (test)  loss: 0.2645 -> 0.1166   acc: 92.12% -> 95.21%             
client [56] (test)  loss: 1.8963 -> 0.2884   acc: 30.49% -> 89.43%             
client [5] (test)  loss: 0.7691 -> 0.0579   acc: 72.93% -> 98.91%              
client [52] (test)  loss: 0.3874 -> 0.2196   acc: 89.92% -> 91.47%             
==================== FedBN_join_0.1 TEST RESULTS: ====================         
{                                                                              
    100: {'loss': '0.6289 -> 0.0000', 'accuracy': '76.46% -> 0.00%'},          
    200: {'loss': '0.6432 -> 0.0000', 'accuracy': '76.96% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedBN_join_0.1 achieved 10.0%(11.19%) at epoch: 0                              
FedBN_join_0.1 achieved 30.0%(36.20%) at epoch: 4                              
FedBN_join_0.1 achieved 50.0%(50.15%) at epoch: 8                              
FedBN_join_0.1 achieved 60.0%(61.55%) at epoch: 11                             
FedBN_join_0.1 achieved 70.0%(70.52%) at epoch: 13                             
FedBN_join_0.1 achieved 80.0%(84.24%) at epoch: 48                             
FedBN_join_0.1 achieved 90.0%(92.29%) at epoch: 67                             
Convergence (test_after):                                                      
FedBN_join_0.1 achieved 70.0%(79.84%) at epoch: 0                              
FedBN_join_0.1 achieved 90.0%(92.79%) at epoch: 2                              
