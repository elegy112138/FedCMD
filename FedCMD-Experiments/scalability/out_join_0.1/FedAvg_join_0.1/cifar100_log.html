==================== ALGORITHM: FedAvg_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.7842 -> 2.3927   acc: 0.00% -> 31.97%              
client [81] (test)  loss: 4.5056 -> 2.7966   acc: 0.00% -> 27.22%              
client [21] (test)  loss: 48.3145 -> 2.5408   acc: 0.29% -> 27.95%             
client [68] (test)  loss: 4.5363 -> 2.2613   acc: 4.79% -> 34.82%              
client [93] (test)  loss: 4.8446 -> 3.1271   acc: 1.02% -> 16.67%              
client [31] (test)  loss: 4.6061 -> 2.5878   acc: 0.64% -> 23.47%              
client [20] (test)  loss: 4.2218 -> 1.6268   acc: 5.92% -> 49.67%              
client [59] (test)  loss: 43.3160 -> 2.2941   acc: 0.32% -> 40.97%             
client [48] (test)  loss: 4.4385 -> 3.0770   acc: 3.59% -> 19.28%              
client [34] (test)  loss: 4.3537 -> 2.9427   acc: 6.29% -> 11.92%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.4127 -> 1.7262   acc: 1.70% -> 55.24%              
client [99] (test)  loss: 4.9869 -> 3.1541   acc: 0.32% -> 19.75%              
client [67] (test)  loss: 4.4077 -> 2.1722   acc: 1.57% -> 37.30%              
client [0] (test)  loss: 4.3099 -> 2.8418   acc: 3.15% -> 22.97%               
client [76] (test)  loss: 5.0084 -> 2.4534   acc: 0.33% -> 39.53%              
client [41] (test)  loss: 4.8530 -> 2.8220   acc: 0.33% -> 19.00%              
client [62] (test)  loss: 132.3344 -> 2.5691   acc: 0.00% -> 29.18%            
client [2] (test)  loss: 114.2861 -> 2.9989   acc: 3.08% -> 26.15%             
client [14] (test)  loss: 4.9264 -> 3.0069   acc: 0.00% -> 26.47%              
client [46] (test)  loss: 5.0502 -> 2.4872   acc: 0.80% -> 37.60%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.0984 -> 2.7488   acc: 6.46% -> 29.66%              
client [68] (test)  loss: 4.8172 -> 2.0805   acc: 4.79% -> 38.66%              
client [57] (test)  loss: 5.0726 -> 2.7275   acc: 2.64% -> 28.38%              
client [17] (test)  loss: 7.2100 -> 2.4052   acc: 0.00% -> 29.21%              
client [54] (test)  loss: 4.4349 -> 2.7997   acc: 5.98% -> 22.83%              
client [23] (test)  loss: 188.8764 -> 2.5684   acc: 2.73% -> 26.56%            
client [35] (test)  loss: 5.2890 -> 1.9469   acc: 0.00% -> 44.33%              
client [59] (test)  loss: 4.6527 -> 1.9902   acc: 4.19% -> 45.48%              
client [31] (test)  loss: 3.6444 -> 2.4168   acc: 19.94% -> 33.12%             
client [9] (test)  loss: 4.6552 -> 2.5954   acc: 4.23% -> 22.36%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.4055 -> 2.3402   acc: 1.40% -> 37.82%              
client [33] (test)  loss: 4.6360 -> 2.7364   acc: 4.10% -> 41.04%              
client [16] (test)  loss: 4.7998 -> 3.4781   acc: 5.63% -> 13.52%              
client [44] (test)  loss: 5.3562 -> 2.9425   acc: 0.00% -> 14.38%              
client [8] (test)  loss: 4.6711 -> 2.2238   acc: 6.09% -> 38.46%               
client [31] (test)  loss: 4.1212 -> 2.2044   acc: 8.36% -> 36.66%              
client [47] (test)  loss: 4.2546 -> 2.4800   acc: 6.02% -> 31.20%              
client [36] (test)  loss: 4.6676 -> 2.8792   acc: 2.08% -> 20.83%              
client [20] (test)  loss: 4.5923 -> 1.7243   acc: 10.20% -> 45.72%             
client [56] (test)  loss: 4.5390 -> 3.3271   acc: 2.97% -> 18.32%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.8886 -> 1.8714   acc: 5.41% -> 45.86%               
client [60] (test)  loss: 4.8669 -> 2.7216   acc: 3.21% -> 27.56%              
client [28] (test)  loss: 5.7411 -> 2.3802   acc: 3.14% -> 36.59%              
client [25] (test)  loss: 5.5877 -> 2.1975   acc: 0.84% -> 42.62%              
client [58] (test)  loss: 4.9379 -> 2.5937   acc: 2.22% -> 25.32%              
client [44] (test)  loss: 5.6161 -> 2.6408   acc: 0.98% -> 21.24%              
client [39] (test)  loss: 4.3719 -> 2.6272   acc: 6.47% -> 25.89%              
client [29] (test)  loss: 5.2070 -> 2.3566   acc: 4.00% -> 35.43%              
client [3] (test)  loss: 4.0706 -> 2.2886   acc: 8.56% -> 32.42%               
client [84] (test)  loss: 4.2293 -> 2.3219   acc: 6.52% -> 40.37%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 6.3987 -> 2.1640   acc: 3.75% -> 37.18%              
client [84] (test)  loss: 4.1373 -> 2.3443   acc: 13.04% -> 38.51%             
client [10] (test)  loss: 3.9765 -> 2.4623   acc: 4.76% -> 36.51%              
client [36] (test)  loss: 4.6809 -> 2.6504   acc: 3.12% -> 27.78%              
client [65] (test)  loss: 4.0074 -> 3.0694   acc: 5.67% -> 22.67%              
client [81] (test)  loss: 4.0901 -> 2.2986   acc: 12.03% -> 39.24%             
client [79] (test)  loss: 3.9345 -> 1.8008   acc: 22.03% -> 51.13%             
client [42] (test)  loss: 4.8612 -> 2.3993   acc: 2.61% -> 38.11%              
client [11] (test)  loss: 4.3366 -> 2.4760   acc: 3.99% -> 35.58%              
client [96] (test)  loss: 6.1767 -> 1.9727   acc: 0.62% -> 47.37%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.0358 -> 2.0577   acc: 8.33% -> 45.51%               
client [53] (test)  loss: 5.1136 -> 2.2088   acc: 3.89% -> 41.92%              
client [52] (test)  loss: 4.3714 -> 2.7173   acc: 4.32% -> 39.53%              
client [42] (test)  loss: 4.7951 -> 2.2686   acc: 4.56% -> 41.04%              
client [69] (test)  loss: 3.9614 -> 1.6938   acc: 15.01% -> 58.36%             
client [59] (test)  loss: 4.4448 -> 1.7803   acc: 6.77% -> 50.00%              
client [7] (test)  loss: 4.3920 -> 2.0378   acc: 3.88% -> 41.10%               
client [26] (test)  loss: 3.9453 -> 2.5958   acc: 5.38% -> 29.23%              
client [49] (test)  loss: 3.8709 -> 2.1846   acc: 8.33% -> 43.10%              
client [98] (test)  loss: 3.8349 -> 3.1411   acc: 10.31% -> 25.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.7457 -> 2.9338   acc: 9.06% -> 27.19%              
client [47] (test)  loss: 4.3704 -> 2.3939   acc: 7.52% -> 32.71%              
client [21] (test)  loss: 4.2971 -> 2.0503   acc: 8.93% -> 40.63%              
client [77] (test)  loss: 3.9056 -> 2.1546   acc: 10.34% -> 46.08%             
client [95] (test)  loss: 4.3542 -> 2.0684   acc: 9.57% -> 46.53%              
client [91] (test)  loss: 3.7110 -> 2.4208   acc: 7.72% -> 36.98%              
client [14] (test)  loss: 3.6180 -> 2.3080   acc: 12.94% -> 41.18%             
client [99] (test)  loss: 4.4991 -> 3.3797   acc: 6.37% -> 27.71%              
client [20] (test)  loss: 4.6131 -> 1.7449   acc: 5.59% -> 43.09%              
client [39] (test)  loss: 5.1227 -> 2.9946   acc: 3.56% -> 16.18%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.7698 -> 2.5757   acc: 11.63% -> 41.20%             
client [62] (test)  loss: 3.8176 -> 2.2714   acc: 13.11% -> 38.03%             
client [71] (test)  loss: 3.7644 -> 2.6931   acc: 15.91% -> 29.22%             
client [97] (test)  loss: 3.8665 -> 2.5059   acc: 11.21% -> 29.74%             
client [30] (test)  loss: 3.6210 -> 2.3960   acc: 15.19% -> 30.06%             
client [88] (test)  loss: 4.3043 -> 2.0620   acc: 6.62% -> 45.03%              
client [60] (test)  loss: 4.2969 -> 2.3418   acc: 2.56% -> 39.74%              
client [82] (test)  loss: 4.6531 -> 2.1621   acc: 7.96% -> 40.48%              
client [91] (test)  loss: 3.6274 -> 2.2022   acc: 12.86% -> 42.77%             
client [57] (test)  loss: 3.9556 -> 2.1625   acc: 9.57% -> 44.55%              
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.6820 -> 1.9123   acc: 15.43% -> 45.02%             
client [15] (test)  loss: 4.5952 -> 2.2898   acc: 4.11% -> 39.24%              
client [71] (test)  loss: 4.3148 -> 2.6648   acc: 6.82% -> 30.19%              
client [97] (test)  loss: 3.7767 -> 2.4685   acc: 15.95% -> 31.90%             
client [53] (test)  loss: 4.5081 -> 2.0774   acc: 8.98% -> 46.11%              
client [77] (test)  loss: 3.5952 -> 2.3571   acc: 15.05% -> 43.89%             
client [76] (test)  loss: 4.2007 -> 2.3615   acc: 5.98% -> 35.22%              
client [79] (test)  loss: 4.0497 -> 1.5954   acc: 5.37% -> 55.08%              
client [28] (test)  loss: 4.6447 -> 2.3517   acc: 5.57% -> 40.42%              
client [99] (test)  loss: 4.2900 -> 3.4213   acc: 11.46% -> 27.07%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.6613 -> 2.3886   acc: 21.12% -> 34.05%             
client [86] (test)  loss: 6.4196 -> 2.5523   acc: 3.88% -> 33.13%              
client [34] (test)  loss: 4.3422 -> 2.2845   acc: 6.62% -> 33.77%              
client [73] (test)  loss: 3.6234 -> 2.6165   acc: 13.00% -> 35.33%             
client [5] (test)  loss: 3.7185 -> 1.9357   acc: 10.86% -> 44.09%              
client [96] (test)  loss: 4.2628 -> 1.8730   acc: 6.19% -> 47.06%              
client [22] (test)  loss: 4.1055 -> 2.5699   acc: 6.23% -> 32.71%              
client [60] (test)  loss: 4.2192 -> 2.3718   acc: 1.28% -> 42.95%              
client [66] (test)  loss: 4.6105 -> 2.2195   acc: 2.27% -> 37.86%              
client [83] (test)  loss: 5.4521 -> 1.7338   acc: 4.30% -> 50.66%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.4923 -> 2.3873   acc: 16.94% -> 36.54%             
client [65] (test)  loss: 4.2046 -> 2.5736   acc: 8.10% -> 36.44%              
client [95] (test)  loss: 3.2917 -> 1.9513   acc: 19.47% -> 50.83%             
client [17] (test)  loss: 4.9605 -> 2.4505   acc: 7.30% -> 30.16%              
client [8] (test)  loss: 4.4067 -> 1.9781   acc: 7.69% -> 49.04%               
client [35] (test)  loss: 5.0002 -> 1.8274   acc: 4.00% -> 45.67%              
client [98] (test)  loss: 3.9007 -> 2.6002   acc: 12.50% -> 34.06%             
client [53] (test)  loss: 3.6085 -> 2.0728   acc: 14.07% -> 45.21%             
client [43] (test)  loss: 5.1934 -> 2.1979   acc: 5.15% -> 41.21%              
client [64] (test)  loss: 4.0912 -> 2.0450   acc: 8.12% -> 48.18%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 4.4733 -> 1.9551   acc: 6.92% -> 42.94%              
client [88] (test)  loss: 4.5926 -> 2.0325   acc: 8.94% -> 46.69%              
client [38] (test)  loss: 4.9260 -> 2.0608   acc: 5.95% -> 42.49%              
client [3] (test)  loss: 4.5361 -> 1.8106   acc: 10.09% -> 45.57%              
client [5] (test)  loss: 4.0662 -> 1.9008   acc: 7.67% -> 46.65%               
client [41] (test)  loss: 4.6079 -> 2.1705   acc: 4.33% -> 41.67%              
client [7] (test)  loss: 4.1302 -> 1.8316   acc: 6.15% -> 47.25%               
client [37] (test)  loss: 5.0695 -> 2.6021   acc: 4.82% -> 33.44%              
client [45] (test)  loss: 4.8621 -> 1.9914   acc: 4.33% -> 46.00%              
client [47] (test)  loss: 5.1200 -> 2.3067   acc: 4.14% -> 39.85%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 4.0716 -> 2.2693   acc: 8.45% -> 39.15%              
client [11] (test)  loss: 3.5857 -> 2.3036   acc: 14.11% -> 44.48%             
client [37] (test)  loss: 5.5234 -> 2.4339   acc: 3.54% -> 37.62%              
client [41] (test)  loss: 4.3157 -> 2.1553   acc: 7.67% -> 42.33%              
client [95] (test)  loss: 3.7519 -> 1.9551   acc: 13.20% -> 50.83%             
client [53] (test)  loss: 4.2385 -> 2.0820   acc: 10.78% -> 46.11%             
client [22] (test)  loss: 3.5120 -> 2.3341   acc: 17.13% -> 38.01%             
client [25] (test)  loss: 4.9861 -> 1.9624   acc: 7.59% -> 48.10%              
client [69] (test)  loss: 4.3672 -> 1.3582   acc: 19.55% -> 68.27%             
client [46] (test)  loss: 3.7329 -> 1.8379   acc: 13.60% -> 58.00%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.5851 -> 2.2280   acc: 7.89% -> 40.23%              
client [69] (test)  loss: 4.2918 -> 1.3188   acc: 19.26% -> 70.82%             
client [82] (test)  loss: 4.9753 -> 2.4099   acc: 4.84% -> 37.02%              
client [45] (test)  loss: 4.4602 -> 1.9765   acc: 7.33% -> 47.33%              
client [7] (test)  loss: 3.8541 -> 1.7151   acc: 10.68% -> 48.87%              
client [50] (test)  loss: 6.3485 -> 1.8477   acc: 3.58% -> 52.33%              
client [35] (test)  loss: 3.4440 -> 1.8405   acc: 21.33% -> 45.00%             
client [24] (test)  loss: 4.1255 -> 2.0604   acc: 12.93% -> 48.29%             
client [15] (test)  loss: 4.9296 -> 2.2820   acc: 7.91% -> 37.66%              
client [58] (test)  loss: 4.3932 -> 2.3392   acc: 11.39% -> 34.18%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.3821 -> 2.2892   acc: 18.63% -> 42.16%             
client [76] (test)  loss: 3.5349 -> 2.2448   acc: 14.95% -> 42.52%             
client [67] (test)  loss: 5.4982 -> 1.6631   acc: 6.27% -> 49.84%              
client [37] (test)  loss: 4.7712 -> 2.8111   acc: 6.43% -> 34.73%              
client [58] (test)  loss: 4.1125 -> 2.0626   acc: 11.71% -> 43.67%             
client [64] (test)  loss: 4.1636 -> 2.0042   acc: 11.76% -> 52.10%             
client [77] (test)  loss: 3.4794 -> 2.0075   acc: 15.99% -> 47.65%             
client [55] (test)  loss: 2.9418 -> 1.7574   acc: 34.78% -> 55.28%             
client [12] (test)  loss: 3.3727 -> 1.8651   acc: 24.67% -> 50.99%             
client [89] (test)  loss: 3.7402 -> 2.5123   acc: 16.82% -> 39.76%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.8457 -> 2.3056   acc: 21.43% -> 45.03%             
client [51] (test)  loss: 5.3666 -> 2.2283   acc: 3.59% -> 39.22%              
client [8] (test)  loss: 3.5105 -> 2.0202   acc: 17.31% -> 50.64%              
client [18] (test)  loss: 5.6818 -> 1.5762   acc: 7.55% -> 59.90%              
client [94] (test)  loss: 3.8807 -> 2.0870   acc: 13.14% -> 46.47%             
client [81] (test)  loss: 3.5052 -> 2.0679   acc: 19.94% -> 52.85%             
client [3] (test)  loss: 3.5001 -> 1.7672   acc: 20.80% -> 51.99%              
client [11] (test)  loss: 3.9616 -> 2.2567   acc: 13.19% -> 45.71%             
client [95] (test)  loss: 3.6265 -> 1.9357   acc: 12.87% -> 50.50%             
client [67] (test)  loss: 4.4958 -> 1.7131   acc: 10.03% -> 52.04%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.1306 -> 1.9547   acc: 10.95% -> 47.84%             
client [79] (test)  loss: 3.3398 -> 1.5749   acc: 23.45% -> 59.60%             
client [58] (test)  loss: 4.1078 -> 2.1164   acc: 15.51% -> 45.89%             
client [88] (test)  loss: 4.7701 -> 1.9313   acc: 11.26% -> 51.66%             
client [46] (test)  loss: 3.9540 -> 1.8233   acc: 16.80% -> 59.20%             
client [11] (test)  loss: 3.5167 -> 2.2186   acc: 20.55% -> 46.93%             
client [55] (test)  loss: 3.3405 -> 1.7683   acc: 26.71% -> 58.39%             
client [13] (test)  loss: 4.2542 -> 1.9339   acc: 7.29% -> 50.15%              
client [31] (test)  loss: 3.5052 -> 2.0349   acc: 22.83% -> 45.02%             
client [75] (test)  loss: 3.5636 -> 1.4852   acc: 19.27% -> 62.46%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.6374 -> 2.6104   acc: 14.98% -> 37.13%             
client [7] (test)  loss: 4.2866 -> 1.8623   acc: 9.71% -> 47.90%               
client [57] (test)  loss: 3.5682 -> 2.0113   acc: 23.76% -> 52.15%             
client [13] (test)  loss: 4.9483 -> 1.9526   acc: 8.21% -> 50.15%              
client [43] (test)  loss: 5.3859 -> 2.1593   acc: 3.94% -> 45.45%              
client [91] (test)  loss: 4.3430 -> 1.9734   acc: 12.22% -> 51.45%             
client [10] (test)  loss: 3.8004 -> 1.9583   acc: 13.89% -> 48.41%             
client [64] (test)  loss: 3.3438 -> 2.1738   acc: 19.61% -> 47.62%             
client [82] (test)  loss: 5.5307 -> 2.6471   acc: 3.11% -> 32.53%              
client [22] (test)  loss: 4.2667 -> 2.2425   acc: 10.90% -> 43.30%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.8038 -> 1.1035   acc: 9.54% -> 69.41%              
client [23] (test)  loss: 5.2186 -> 2.2835   acc: 7.81% -> 43.36%              
client [88] (test)  loss: 3.9204 -> 2.0164   acc: 16.56% -> 52.65%             
client [98] (test)  loss: 3.6843 -> 2.2095   acc: 19.06% -> 43.75%             
client [79] (test)  loss: 2.9772 -> 1.5147   acc: 38.98% -> 65.54%             
client [21] (test)  loss: 5.1563 -> 2.0538   acc: 10.09% -> 47.55%             
client [92] (test)  loss: 3.7200 -> 2.3031   acc: 21.76% -> 43.93%             
client [56] (test)  loss: 4.6917 -> 2.0628   acc: 14.85% -> 55.94%             
client [5] (test)  loss: 4.0095 -> 1.8678   acc: 16.61% -> 46.96%              
client [52] (test)  loss: 3.9261 -> 2.2582   acc: 25.25% -> 51.16%             
==================== FedAvg_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '4.3172 -> 0.0000', 'accuracy': '8.23% -> 0.00%'},           
    200: {'loss': '4.3289 -> 0.0000', 'accuracy': '13.61% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedAvg_join_0.1 achieved 10.0%(10.67%) at epoch: 85                            
Convergence (test_after):                                                      
FedAvg_join_0.1 achieved 10.0%(18.39%) at epoch: 0                             
FedAvg_join_0.1 achieved 20.0%(26.76%) at epoch: 1                             
FedAvg_join_0.1 achieved 30.0%(34.81%) at epoch: 14                            
FedAvg_join_0.1 achieved 40.0%(42.08%) at epoch: 40                            
FedAvg_join_0.1 achieved 50.0%(52.47%) at epoch: 104                           
