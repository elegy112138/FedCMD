==================== ALGORITHM: FedRep_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 0.7309 -> 1.3356   acc: 72.11% -> 59.77%             
client [81] (test)  loss: 0.2645 -> 0.1848   acc: 92.50% -> 94.46%             
client [21] (test)  loss: 25.6893 -> 2.1606   acc: 1.21% -> 35.97%             
client [68] (test)  loss: 0.6054 -> 0.5270   acc: 77.89% -> 77.89%             
client [93] (test)  loss: 1.0904 -> 0.9629   acc: 66.72% -> 68.18%             
client [31] (test)  loss: 2.1358 -> 1.2466   acc: 8.64% -> 51.85%              
client [20] (test)  loss: 0.7078 -> 0.9687   acc: 71.93% -> 69.33%             
client [59] (test)  loss: 11.0597 -> 1.3693   acc: 27.58% -> 44.37%            
client [48] (test)  loss: 1.9814 -> 1.9032   acc: 48.15% -> 48.15%             
client [34] (test)  loss: 0.0572 -> 0.0496   acc: 99.18% -> 99.18%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.1366 -> 1.6011   acc: 22.99% -> 50.57%             
client [99] (test)  loss: 0.3845 -> 0.3344   acc: 89.21% -> 89.21%             
client [67] (test)  loss: 0.7739 -> 0.9092   acc: 72.35% -> 64.83%             
client [0] (test)  loss: 0.6068 -> 0.5807   acc: 77.62% -> 78.95%              
client [76] (test)  loss: 1.9476 -> 0.9585   acc: 31.74% -> 65.57%             
client [41] (test)  loss: 1.3148 -> 1.2288   acc: 44.16% -> 47.89%             
client [62] (test)  loss: 52.1076 -> 0.3860   acc: 0.80% -> 86.61%             
client [2] (test)  loss: 21.7107 -> 1.4227   acc: 6.67% -> 90.00%              
client [14] (test)  loss: 1.2906 -> 2.2652   acc: 51.71% -> 31.32%             
client [46] (test)  loss: 0.0173 -> 0.0147   acc: 99.78% -> 99.78%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9219 -> 0.7774   acc: 51.80% -> 63.96%             
client [68] (test)  loss: 0.5557 -> 0.5290   acc: 78.36% -> 78.36%             
client [57] (test)  loss: 1.2633 -> 1.0795   acc: 65.00% -> 70.00%             
client [17] (test)  loss: 0.7006 -> 0.5046   acc: 84.19% -> 84.80%             
client [54] (test)  loss: 0.5814 -> 0.5226   acc: 78.83% -> 81.48%             
client [23] (test)  loss: 5.5894 -> 0.1577   acc: 59.90% -> 97.40%             
client [35] (test)  loss: 1.0356 -> 1.0722   acc: 64.36% -> 60.81%             
client [59] (test)  loss: 1.4243 -> 1.2032   acc: 39.04% -> 53.10%             
client [31] (test)  loss: 0.9223 -> 2.2923   acc: 64.20% -> 40.74%             
client [9] (test)  loss: 0.5188 -> 0.3045   acc: 73.41% -> 85.59%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.9819 -> 0.9465   acc: 59.82% -> 64.48%             
client [33] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%           
client [16] (test)  loss: 0.9193 -> 0.8936   acc: 63.41% -> 58.54%             
client [44] (test)  loss: 5.1766 -> 0.8495   acc: 20.09% -> 71.14%             
client [8] (test)  loss: 0.2123 -> 0.1967   acc: 94.06% -> 94.42%              
client [31] (test)  loss: 0.9847 -> 2.2288   acc: 62.96% -> 40.74%             
client [47] (test)  loss: 0.8619 -> 0.6719   acc: 67.41% -> 76.50%             
client [36] (test)  loss: 0.8161 -> 0.9798   acc: 64.57% -> 57.68%             
client [20] (test)  loss: 0.4264 -> 0.8016   acc: 84.84% -> 74.69%             
client [56] (test)  loss: 0.9082 -> 0.9452   acc: 54.94% -> 48.76%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5776 -> 0.9438   acc: 83.39% -> 63.79%              
client [60] (test)  loss: 1.1170 -> 0.8846   acc: 57.78% -> 65.33%             
client [28] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [25] (test)  loss: 0.9527 -> 0.7366   acc: 70.07% -> 76.36%             
client [58] (test)  loss: 0.8749 -> 0.9972   acc: 58.87% -> 54.61%             
client [44] (test)  loss: 0.5428 -> 0.5732   acc: 79.68% -> 78.43%             
client [39] (test)  loss: 0.4368 -> 0.5271   acc: 82.89% -> 80.05%             
client [29] (test)  loss: 0.0220 -> 0.0204   acc: 99.78% -> 99.78%             
client [3] (test)  loss: 0.7827 -> 0.7286   acc: 61.23% -> 63.18%              
client [84] (test)  loss: 0.5740 -> 0.5091   acc: 83.07% -> 85.37%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.8437 -> 3.3355   acc: 71.54% -> 36.51%             
client [84] (test)  loss: 0.5374 -> 0.4981   acc: 83.80% -> 85.49%             
client [10] (test)  loss: 0.5724 -> 0.4760   acc: 80.28% -> 83.42%             
client [36] (test)  loss: 0.5517 -> 0.7766   acc: 79.53% -> 70.47%             
client [65] (test)  loss: 0.0009 -> 0.0003   acc: 100.00% -> 100.00%           
client [81] (test)  loss: 0.1523 -> 0.1215   acc: 94.95% -> 95.54%             
client [79] (test)  loss: 0.6388 -> 0.5973   acc: 76.31% -> 79.29%             
client [42] (test)  loss: 0.5540 -> 0.7584   acc: 81.14% -> 69.40%             
client [11] (test)  loss: 0.2729 -> 0.2181   acc: 90.88% -> 91.68%             
client [96] (test)  loss: 0.6880 -> 0.6934   acc: 74.83% -> 72.98%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.2045 -> 0.1833   acc: 93.45% -> 94.42%              
client [53] (test)  loss: 0.2889 -> 0.3223   acc: 91.97% -> 88.98%             
client [52] (test)  loss: 0.5977 -> 1.2479   acc: 75.31% -> 46.60%             
client [42] (test)  loss: 0.5276 -> 0.6729   acc: 82.92% -> 72.95%             
client [69] (test)  loss: 1.3634 -> 1.4285   acc: 57.47% -> 49.43%             
client [59] (test)  loss: 1.2636 -> 1.1215   acc: 50.43% -> 55.56%             
client [7] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [26] (test)  loss: 0.6292 -> 0.6976   acc: 76.11% -> 73.92%             
client [49] (test)  loss: 0.6644 -> 0.6673   acc: 72.36% -> 70.21%             
client [98] (test)  loss: 0.6340 -> 0.6478   acc: 65.61% -> 68.65%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5906 -> 0.6279   acc: 69.67% -> 68.65%             
client [47] (test)  loss: 0.6732 -> 0.9399   acc: 75.61% -> 66.96%             
client [21] (test)  loss: 0.5738 -> 3.2891   acc: 82.68% -> 36.51%             
client [77] (test)  loss: 0.4407 -> 0.5309   acc: 83.24% -> 80.03%             
client [95] (test)  loss: 0.3208 -> 0.3075   acc: 93.02% -> 93.08%             
client [91] (test)  loss: 1.0062 -> 1.8270   acc: 62.72% -> 44.37%             
client [14] (test)  loss: 1.2334 -> 1.8588   acc: 53.83% -> 41.35%             
client [99] (test)  loss: 0.3798 -> 0.3079   acc: 87.98% -> 88.98%             
client [20] (test)  loss: 0.3521 -> 0.5634   acc: 87.99% -> 82.07%             
client [39] (test)  loss: 0.3931 -> 0.4668   acc: 85.03% -> 81.93%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.5450 -> 1.1122   acc: 77.13% -> 53.78%             
client [62] (test)  loss: 0.3451 -> 0.6209   acc: 86.91% -> 78.45%             
client [71] (test)  loss: 0.8815 -> 0.8655   acc: 65.60% -> 66.60%             
client [97] (test)  loss: 0.6513 -> 1.1347   acc: 78.39% -> 51.29%             
client [30] (test)  loss: 0.4565 -> 0.3879   acc: 81.31% -> 83.70%             
client [88] (test)  loss: 0.4053 -> 0.4147   acc: 85.61% -> 84.96%             
client [60] (test)  loss: 0.7418 -> 0.7351   acc: 71.74% -> 72.08%             
client [82] (test)  loss: 0.8731 -> 0.8354   acc: 65.90% -> 68.26%             
client [91] (test)  loss: 1.4118 -> 1.5901   acc: 51.14% -> 48.29%             
client [57] (test)  loss: 0.7552 -> 0.8615   acc: 85.00% -> 75.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.5976 -> 0.7359   acc: 79.01% -> 77.78%             
client [15] (test)  loss: 0.4444 -> 0.4181   acc: 86.70% -> 88.30%             
client [71] (test)  loss: 0.9123 -> 0.8676   acc: 63.45% -> 65.88%             
client [97] (test)  loss: 0.6344 -> 1.2373   acc: 78.71% -> 50.00%             
client [53] (test)  loss: 0.2698 -> 0.3050   acc: 91.91% -> 89.51%             
client [77] (test)  loss: 0.4260 -> 0.5297   acc: 83.95% -> 80.17%             
client [76] (test)  loss: 1.0784 -> 0.8787   acc: 59.10% -> 63.95%             
client [79] (test)  loss: 0.5994 -> 0.5716   acc: 79.85% -> 80.22%             
client [28] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [99] (test)  loss: 0.3762 -> 0.2936   acc: 86.13% -> 89.21%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.6616 -> 1.6155   acc: 78.39% -> 36.45%             
client [86] (test)  loss: 0.3937 -> 0.3691   acc: 86.00% -> 88.00%             
client [34] (test)  loss: 0.0370 -> 0.0344   acc: 99.18% -> 99.23%             
client [73] (test)  loss: 0.3241 -> 0.3172   acc: 89.74% -> 90.26%             
client [5] (test)  loss: 0.5478 -> 1.2798   acc: 80.07% -> 47.72%              
client [96] (test)  loss: 0.7375 -> 1.1293   acc: 72.91% -> 65.96%             
client [22] (test)  loss: 0.5468 -> 0.7915   acc: 83.22% -> 75.18%             
client [60] (test)  loss: 0.7004 -> 0.8217   acc: 74.31% -> 67.11%             
client [66] (test)  loss: 0.9731 -> 0.9971   acc: 59.21% -> 58.80%             
client [83] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.0365 -> 0.9075   acc: 59.70% -> 61.25%             
client [65] (test)  loss: 0.0004 -> 0.0004   acc: 100.00% -> 100.00%           
client [95] (test)  loss: 0.3146 -> 0.2958   acc: 93.02% -> 92.96%             
client [17] (test)  loss: 0.5834 -> 0.4862   acc: 82.99% -> 85.02%             
client [8] (test)  loss: 0.2040 -> 0.1639   acc: 94.42% -> 95.39%              
client [35] (test)  loss: 0.7107 -> 0.7519   acc: 74.45% -> 71.66%             
client [98] (test)  loss: 0.5726 -> 0.6107   acc: 72.21% -> 70.81%             
client [53] (test)  loss: 0.2893 -> 0.2540   acc: 90.77% -> 91.85%             
client [43] (test)  loss: 0.6462 -> 0.6331   acc: 78.59% -> 78.80%             
client [64] (test)  loss: 0.7918 -> 0.7996   acc: 73.17% -> 72.92%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6013 -> 1.7761   acc: 80.54% -> 44.83%             
client [88] (test)  loss: 0.4579 -> 0.3958   acc: 82.54% -> 85.42%             
client [38] (test)  loss: 0.2058 -> 0.1902   acc: 94.71% -> 94.90%             
client [3] (test)  loss: 0.9044 -> 0.7793   acc: 54.31% -> 63.12%              
client [5] (test)  loss: 0.5961 -> 0.9624   acc: 77.56% -> 60.66%              
client [41] (test)  loss: 1.0387 -> 1.0881   acc: 59.09% -> 53.25%             
client [7] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [37] (test)  loss: 0.3179 -> 0.3353   acc: 90.38% -> 90.38%             
client [45] (test)  loss: 0.7043 -> 0.6647   acc: 69.55% -> 70.67%             
client [47] (test)  loss: 0.7417 -> 0.9984   acc: 73.17% -> 69.40%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8406 -> 0.8922   acc: 73.17% -> 65.04%             
client [11] (test)  loss: 0.3184 -> 0.1523   acc: 85.96% -> 94.61%             
client [37] (test)  loss: 0.3130 -> 0.3140   acc: 90.79% -> 89.96%             
client [41] (test)  loss: 1.0145 -> 1.1499   acc: 59.74% -> 49.19%             
client [95] (test)  loss: 0.3578 -> 0.2864   acc: 92.67% -> 92.96%             
client [53] (test)  loss: 0.5489 -> 0.2423   acc: 77.05% -> 92.33%             
client [22] (test)  loss: 0.5394 -> 0.7626   acc: 83.36% -> 76.73%             
client [25] (test)  loss: 0.8557 -> 0.6448   acc: 70.97% -> 79.90%             
client [69] (test)  loss: 1.3603 -> 1.2990   acc: 57.47% -> 59.77%             
client [46] (test)  loss: 0.0120 -> 0.0116   acc: 99.78% -> 99.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6338 -> 0.9509   acc: 77.61% -> 70.51%             
client [69] (test)  loss: 1.2821 -> 1.2870   acc: 58.62% -> 60.92%             
client [82] (test)  loss: 0.7969 -> 0.8589   acc: 68.55% -> 67.26%             
client [45] (test)  loss: 0.6645 -> 0.6648   acc: 71.51% -> 72.91%             
client [7] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [50] (test)  loss: 0.8484 -> 0.8699   acc: 68.00% -> 68.00%             
client [35] (test)  loss: 0.7006 -> 0.7791   acc: 75.02% -> 71.76%             
client [24] (test)  loss: 0.6661 -> 0.6927   acc: 70.72% -> 68.02%             
client [15] (test)  loss: 0.3930 -> 0.4126   acc: 89.10% -> 88.83%             
client [58] (test)  loss: 0.7420 -> 1.0726   acc: 68.63% -> 54.84%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.1034 -> 1.0805   acc: 59.26% -> 55.56%             
client [76] (test)  loss: 0.8454 -> 0.9860   acc: 67.45% -> 58.89%             
client [67] (test)  loss: 0.5079 -> 0.3780   acc: 80.18% -> 87.24%             
client [37] (test)  loss: 0.3093 -> 0.3093   acc: 90.38% -> 89.96%             
client [58] (test)  loss: 0.7214 -> 1.0537   acc: 70.10% -> 54.84%             
client [64] (test)  loss: 0.7666 -> 0.7684   acc: 75.19% -> 75.44%             
client [77] (test)  loss: 0.5014 -> 0.5005   acc: 81.03% -> 81.60%             
client [55] (test)  loss: 0.3413 -> 0.3049   acc: 88.30% -> 91.64%             
client [12] (test)  loss: 0.7321 -> 0.7267   acc: 77.94% -> 76.33%             
client [89] (test)  loss: 0.6577 -> 0.7229   acc: 73.05% -> 70.00%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.4972 -> 0.5068   acc: 85.61% -> 85.85%             
client [51] (test)  loss: 0.1049 -> 0.1165   acc: 96.35% -> 97.45%             
client [8] (test)  loss: 0.1716 -> 0.1557   acc: 95.27% -> 95.39%              
client [18] (test)  loss: 0.0915 -> 0.1009   acc: 97.40% -> 97.82%             
client [94] (test)  loss: 0.7792 -> 1.2880   acc: 75.24% -> 56.31%             
client [81] (test)  loss: 0.1277 -> 0.1151   acc: 95.59% -> 96.32%             
client [3] (test)  loss: 0.7391 -> 0.8166   acc: 64.42% -> 62.65%              
client [11] (test)  loss: 0.1511 -> 0.1468   acc: 95.14% -> 94.41%             
client [95] (test)  loss: 0.3239 -> 0.2859   acc: 92.96% -> 92.96%             
client [67] (test)  loss: 0.3919 -> 0.3717   acc: 87.06% -> 87.47%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.4292 -> 0.5092   acc: 87.65% -> 84.43%             
client [79] (test)  loss: 0.5687 -> 0.5592   acc: 80.22% -> 80.78%             
client [58] (test)  loss: 0.7649 -> 1.0384   acc: 67.62% -> 56.24%             
client [88] (test)  loss: 0.4748 -> 0.3986   acc: 82.82% -> 84.03%             
client [46] (test)  loss: 0.0117 -> 0.0115   acc: 99.78% -> 99.78%             
client [11] (test)  loss: 0.1852 -> 0.1743   acc: 93.28% -> 93.61%             
client [55] (test)  loss: 0.2863 -> 0.3116   acc: 91.85% -> 91.47%             
client [13] (test)  loss: 0.4257 -> 0.6508   acc: 79.57% -> 79.47%             
client [31] (test)  loss: 0.6512 -> 0.7705   acc: 76.54% -> 70.37%             
client [75] (test)  loss: 1.0060 -> 0.9278   acc: 62.87% -> 63.04%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5771 -> 0.5688   acc: 77.31% -> 78.52%             
client [7] (test)  loss: 0.0001 -> 0.0001   acc: 100.00% -> 100.00%            
client [57] (test)  loss: 0.7416 -> 0.7741   acc: 80.00% -> 75.00%             
client [13] (test)  loss: 0.2007 -> 0.5212   acc: 91.99% -> 82.05%             
client [43] (test)  loss: 0.5512 -> 0.6330   acc: 80.73% -> 76.02%             
client [91] (test)  loss: 0.9161 -> 0.7697   acc: 66.80% -> 70.55%             
client [10] (test)  loss: 0.4452 -> 0.4346   acc: 84.28% -> 85.20%             
client [64] (test)  loss: 0.7453 -> 0.7506   acc: 76.20% -> 75.44%             
client [82] (test)  loss: 0.7635 -> 0.8246   acc: 70.55% -> 68.98%             
client [22] (test)  loss: 0.5411 -> 0.8400   acc: 83.36% -> 74.61%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.3231 -> 0.3586   acc: 88.56% -> 86.98%             
client [23] (test)  loss: 0.1045 -> 0.0964   acc: 97.40% -> 97.40%             
client [88] (test)  loss: 0.4766 -> 0.4038   acc: 82.08% -> 84.49%             
client [98] (test)  loss: 0.5577 -> 0.5714   acc: 72.84% -> 73.35%             
client [79] (test)  loss: 0.5772 -> 0.5536   acc: 80.04% -> 80.97%             
client [21] (test)  loss: 0.4518 -> 0.4982   acc: 86.58% -> 84.83%             
client [92] (test)  loss: 0.3360 -> 0.3381   acc: 88.74% -> 89.35%             
client [56] (test)  loss: 0.8071 -> 0.8976   acc: 63.78% -> 57.66%             
client [5] (test)  loss: 0.4883 -> 0.5979   acc: 83.04% -> 79.34%              
client [52] (test)  loss: 0.5056 -> 1.0114   acc: 79.95% -> 60.33%             
==================== FedRep_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '0.4236 -> 0.0000', 'accuracy': '84.25% -> 0.00%'},          
    200: {'loss': '0.3849 -> 0.0000', 'accuracy': '85.81% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_join_0.1 achieved 10.0%(14.35%) at epoch: 1                             
FedRep_join_0.1 achieved 30.0%(39.64%) at epoch: 2                             
FedRep_join_0.1 achieved 60.0%(65.81%) at epoch: 4                             
FedRep_join_0.1 achieved 70.0%(72.49%) at epoch: 7                             
FedRep_join_0.1 achieved 80.0%(88.12%) at epoch: 13                            
FedRep_join_0.1 achieved 90.0%(91.00%) at epoch: 24                            
Convergence (test_after):                                                      
FedRep_join_0.1 achieved 70.0%(78.26%) at epoch: 0                             
FedRep_join_0.1 achieved 80.0%(83.02%) at epoch: 5                             
FedRep_join_0.1 achieved 90.0%(91.03%) at epoch: 24                            
