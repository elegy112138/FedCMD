==================== ALGORITHM: FedRep ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'cifar10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.1365 -> 1.0060   acc: 52.42% -> 62.11%             
client [81] (test)  loss: 1.5972 -> 1.5021   acc: 35.71% -> 39.73%             
client [21] (test)  loss: 6.6201 -> 0.7145   acc: 32.24% -> 80.37%             
client [68] (test)  loss: 1.0726 -> 0.9718   acc: 57.69% -> 57.69%             
client [93] (test)  loss: 0.5572 -> 0.5626   acc: 86.35% -> 86.35%             
client [31] (test)  loss: 1.8382 -> 0.8710   acc: 57.39% -> 57.39%             
client [20] (test)  loss: 0.3314 -> 0.3055   acc: 93.33% -> 93.33%             
client [59] (test)  loss: 76.0300 -> 0.2581   acc: 0.51% -> 96.80%             
client [48] (test)  loss: 1.0816 -> 1.0203   acc: 62.79% -> 62.79%             
client [34] (test)  loss: 1.0237 -> 0.8820   acc: 68.40% -> 70.14%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.2450 -> 1.0899   acc: 60.22% -> 59.85%             
client [99] (test)  loss: 2.1050 -> 2.0807   acc: 19.41% -> 19.41%             
client [67] (test)  loss: 1.5001 -> 1.3614   acc: 63.41% -> 63.41%             
client [0] (test)  loss: 0.8592 -> 0.7623   acc: 72.10% -> 72.79%              
client [76] (test)  loss: 0.6508 -> 0.6135   acc: 61.61% -> 68.28%             
client [41] (test)  loss: 1.4167 -> 1.3068   acc: 52.96% -> 52.96%             
client [62] (test)  loss: 52.9271 -> 0.4312   acc: 0.00% -> 80.85%             
client [2] (test)  loss: 44.7632 -> 1.6089   acc: 0.00% -> 62.50%              
client [14] (test)  loss: 0.0946 -> 0.1473   acc: 98.13% -> 98.13%             
client [46] (test)  loss: 0.6035 -> 0.5783   acc: 66.82% -> 80.57%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.9137 -> 0.9143   acc: 71.63% -> 65.36%             
client [68] (test)  loss: 0.9763 -> 0.7645   acc: 59.40% -> 77.35%             
client [57] (test)  loss: 0.6128 -> 0.7273   acc: 70.32% -> 48.63%             
client [17] (test)  loss: 0.3269 -> 0.2587   acc: 92.72% -> 92.72%             
client [54] (test)  loss: 0.5672 -> 0.5392   acc: 80.79% -> 80.79%             
client [23] (test)  loss: 19.0285 -> 1.9378   acc: 31.43% -> 17.14%            
client [35] (test)  loss: 0.8489 -> 0.7759   acc: 70.42% -> 70.42%             
client [59] (test)  loss: 0.1953 -> 0.2136   acc: 96.80% -> 96.80%             
client [31] (test)  loss: 0.9226 -> 0.8710   acc: 57.39% -> 57.39%             
client [9] (test)  loss: 0.2733 -> 0.2377   acc: 93.21% -> 93.21%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.1204 -> 1.0762   acc: 62.96% -> 55.56%             
client [33] (test)  loss: 0.4577 -> 0.4468   acc: 86.93% -> 86.93%             
client [16] (test)  loss: 0.5006 -> 0.5021   acc: 88.27% -> 88.27%             
client [44] (test)  loss: 0.1553 -> 0.0904   acc: 98.66% -> 98.66%             
client [8] (test)  loss: 0.0001 -> 0.0002   acc: 100.00% -> 100.00%            
client [31] (test)  loss: 0.9490 -> 0.8909   acc: 57.39% -> 57.39%             
client [47] (test)  loss: 0.9013 -> 0.8191   acc: 74.19% -> 74.19%             
client [36] (test)  loss: 0.7526 -> 0.5901   acc: 72.17% -> 80.87%             
client [20] (test)  loss: 0.2784 -> 0.2710   acc: 93.33% -> 93.33%             
client [56] (test)  loss: 0.3257 -> 0.3438   acc: 94.32% -> 94.32%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.4967 -> 0.4776   acc: 86.22% -> 86.22%              
client [60] (test)  loss: 0.3849 -> 0.3035   acc: 92.92% -> 92.92%             
client [28] (test)  loss: 1.1814 -> 1.0261   acc: 64.71% -> 64.71%             
client [25] (test)  loss: 0.7357 -> 0.6763   acc: 76.51% -> 76.51%             
client [58] (test)  loss: 1.0341 -> 0.9811   acc: 68.72% -> 68.72%             
client [44] (test)  loss: 0.1042 -> 0.0798   acc: 98.66% -> 98.66%             
client [39] (test)  loss: 0.4090 -> 0.3964   acc: 83.59% -> 84.19%             
client [29] (test)  loss: 0.8402 -> 0.6450   acc: 83.81% -> 86.19%             
client [3] (test)  loss: 0.4743 -> 0.5382   acc: 80.65% -> 86.13%              
client [84] (test)  loss: 1.2701 -> 1.8224   acc: 55.93% -> 44.07%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.6377 -> 0.5677   acc: 80.37% -> 80.37%             
client [84] (test)  loss: 1.0363 -> 1.5233   acc: 64.41% -> 49.72%             
client [10] (test)  loss: 0.5775 -> 0.6176   acc: 72.64% -> 72.06%             
client [36] (test)  loss: 0.5322 -> 0.4715   acc: 88.70% -> 86.09%             
client [65] (test)  loss: 0.5435 -> 0.5042   acc: 83.14% -> 83.53%             
client [81] (test)  loss: 1.2596 -> 1.3381   acc: 56.25% -> 45.54%             
client [79] (test)  loss: 0.9716 -> 0.9677   acc: 65.50% -> 60.82%             
client [42] (test)  loss: 0.1384 -> 0.1365   acc: 97.23% -> 97.23%             
client [11] (test)  loss: 1.0202 -> 0.9138   acc: 63.54% -> 64.05%             
client [96] (test)  loss: 1.2568 -> 1.2140   acc: 50.00% -> 48.08%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.0002 -> 0.0001   acc: 100.00% -> 100.00%            
client [53] (test)  loss: 0.2863 -> 0.3020   acc: 91.59% -> 91.59%             
client [52] (test)  loss: 0.7318 -> 0.6178   acc: 81.42% -> 84.52%             
client [42] (test)  loss: 0.1339 -> 0.1337   acc: 97.23% -> 97.23%             
client [69] (test)  loss: 0.8406 -> 1.5276   acc: 68.77% -> 46.10%             
client [59] (test)  loss: 0.1930 -> 0.1875   acc: 96.80% -> 96.80%             
client [7] (test)  loss: 0.9429 -> 1.0091   acc: 54.17% -> 48.61%              
client [26] (test)  loss: 0.6265 -> 0.9176   acc: 84.21% -> 61.84%             
client [49] (test)  loss: 0.0302 -> 0.0307   acc: 99.64% -> 99.64%             
client [98] (test)  loss: 0.8783 -> 0.8385   acc: 68.66% -> 68.66%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8648 -> 0.8225   acc: 68.66% -> 68.66%             
client [47] (test)  loss: 0.8485 -> 0.7997   acc: 78.49% -> 75.63%             
client [21] (test)  loss: 0.7501 -> 0.5418   acc: 80.37% -> 80.37%             
client [77] (test)  loss: 0.6560 -> 0.8006   acc: 78.85% -> 70.48%             
client [95] (test)  loss: 0.7224 -> 0.6296   acc: 75.93% -> 78.31%             
client [91] (test)  loss: 0.6908 -> 0.9837   acc: 76.00% -> 66.00%             
client [14] (test)  loss: 0.0587 -> 0.0475   acc: 98.13% -> 98.30%             
client [99] (test)  loss: 1.7610 -> 2.7351   acc: 32.94% -> 20.59%             
client [20] (test)  loss: 0.2269 -> 0.2476   acc: 94.87% -> 95.38%             
client [39] (test)  loss: 0.4251 -> 0.3727   acc: 85.71% -> 85.41%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.6726 -> 0.4828   acc: 80.96% -> 85.45%             
client [62] (test)  loss: 0.2221 -> 0.6768   acc: 93.55% -> 73.39%             
client [71] (test)  loss: 0.0960 -> 0.0917   acc: 97.97% -> 97.97%             
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [30] (test)  loss: 1.0012 -> 1.0127   acc: 72.00% -> 72.00%             
client [88] (test)  loss: 0.7546 -> 0.7942   acc: 81.16% -> 81.16%             
client [60] (test)  loss: 0.2637 -> 0.2642   acc: 92.92% -> 92.92%             
client [82] (test)  loss: 1.3135 -> 1.6729   acc: 51.12% -> 35.39%             
client [91] (test)  loss: 0.5986 -> 0.9882   acc: 75.33% -> 66.67%             
client [57] (test)  loss: 0.6093 -> 0.8763   acc: 70.32% -> 43.58%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.9972 -> 0.9943   acc: 57.39% -> 57.39%             
client [15] (test)  loss: 0.7420 -> 1.0828   acc: 68.67% -> 61.45%             
client [71] (test)  loss: 0.0945 -> 0.0921   acc: 97.97% -> 97.97%             
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [53] (test)  loss: 0.2516 -> 0.2888   acc: 91.59% -> 91.59%             
client [77] (test)  loss: 0.7060 -> 0.8955   acc: 77.53% -> 67.40%             
client [76] (test)  loss: 0.5192 -> 0.5130   acc: 76.09% -> 76.32%             
client [79] (test)  loss: 0.9106 -> 0.8992   acc: 63.74% -> 62.57%             
client [28] (test)  loss: 0.9262 -> 0.9371   acc: 66.31% -> 66.84%             
client [99] (test)  loss: 1.6539 -> 2.9390   acc: 32.94% -> 21.18%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [86] (test)  loss: 1.0697 -> 1.3588   acc: 58.64% -> 50.79%             
client [34] (test)  loss: 0.6181 -> 0.5478   acc: 79.51% -> 82.64%             
client [73] (test)  loss: 1.1787 -> 1.6047   acc: 54.55% -> 43.18%             
client [5] (test)  loss: 0.4456 -> 1.3387   acc: 87.10% -> 45.16%              
client [96] (test)  loss: 1.0858 -> 1.1400   acc: 54.81% -> 52.88%             
client [22] (test)  loss: 0.3298 -> 0.7467   acc: 89.47% -> 72.93%             
client [60] (test)  loss: 0.2686 -> 0.2605   acc: 93.33% -> 92.50%             
client [66] (test)  loss: 0.3461 -> 0.4920   acc: 89.11% -> 84.32%             
client [83] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.4980 -> 0.5324   acc: 77.01% -> 75.40%             
client [65] (test)  loss: 0.4483 -> 0.4625   acc: 85.49% -> 85.88%             
client [95] (test)  loss: 0.7231 -> 0.6000   acc: 75.93% -> 78.64%             
client [17] (test)  loss: 0.1973 -> 0.1729   acc: 94.51% -> 94.51%             
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [35] (test)  loss: 0.5756 -> 0.5570   acc: 84.51% -> 84.51%             
client [98] (test)  loss: 0.8756 -> 0.8005   acc: 68.66% -> 68.66%             
client [53] (test)  loss: 0.2635 -> 0.2770   acc: 93.46% -> 92.52%             
client [43] (test)  loss: 0.8645 -> 0.9477   acc: 61.16% -> 68.60%             
client [64] (test)  loss: 0.7089 -> 0.6994   acc: 70.37% -> 74.07%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.6087 -> 0.5245   acc: 78.50% -> 80.84%             
client [88] (test)  loss: 0.7998 -> 0.8535   acc: 75.36% -> 81.16%             
client [38] (test)  loss: 1.4768 -> 1.5285   acc: 40.00% -> 28.57%             
client [3] (test)  loss: 0.2843 -> 0.3919   acc: 91.29% -> 87.74%              
client [5] (test)  loss: 0.4544 -> 1.3179   acc: 86.02% -> 48.39%              
client [41] (test)  loss: 0.8527 -> 1.0201   acc: 66.20% -> 61.67%             
client [7] (test)  loss: 0.8079 -> 1.1880   acc: 56.94% -> 40.28%              
client [37] (test)  loss: 0.8639 -> 0.9405   acc: 69.47% -> 69.47%             
client [45] (test)  loss: 0.3965 -> 0.2815   acc: 90.57% -> 91.42%             
client [47] (test)  loss: 0.5833 -> 0.6954   acc: 81.36% -> 78.49%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.4531 -> 0.4560   acc: 88.27% -> 88.27%             
client [11] (test)  loss: 0.8550 -> 0.8376   acc: 67.59% -> 70.13%             
client [37] (test)  loss: 0.8504 -> 0.9086   acc: 71.05% -> 67.37%             
client [41] (test)  loss: 0.8812 -> 0.8794   acc: 66.20% -> 66.90%             
client [95] (test)  loss: 1.0913 -> 0.5657   acc: 61.02% -> 78.31%             
client [53] (test)  loss: 0.2270 -> 0.2678   acc: 92.52% -> 93.46%             
client [22] (test)  loss: 0.3276 -> 0.8300   acc: 88.72% -> 69.17%             
client [25] (test)  loss: 0.6262 -> 0.6068   acc: 77.14% -> 77.30%             
client [69] (test)  loss: 0.7062 -> 2.9613   acc: 75.09% -> 27.88%             
client [46] (test)  loss: 0.3827 -> 0.6439   acc: 84.83% -> 70.62%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.5793 -> 0.6769   acc: 81.00% -> 78.49%             
client [69] (test)  loss: 0.7430 -> 3.5114   acc: 74.72% -> 25.28%             
client [82] (test)  loss: 1.0966 -> 1.3122   acc: 61.80% -> 48.31%             
client [45] (test)  loss: 0.3491 -> 0.2706   acc: 91.25% -> 91.77%             
client [7] (test)  loss: 0.7458 -> 1.2974   acc: 62.50% -> 37.50%              
client [50] (test)  loss: 0.5762 -> 0.4077   acc: 78.17% -> 82.60%             
client [35] (test)  loss: 0.5677 -> 0.5173   acc: 85.92% -> 85.92%             
client [24] (test)  loss: 0.6718 -> 0.7297   acc: 76.65% -> 74.45%             
client [15] (test)  loss: 0.6554 -> 0.9799   acc: 73.49% -> 63.86%             
client [58] (test)  loss: 0.8466 -> 0.8467   acc: 74.30% -> 72.63%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.6817 -> 0.8056   acc: 75.58% -> 69.77%             
client [76] (test)  loss: 0.4809 -> 0.6860   acc: 80.00% -> 65.29%             
client [67] (test)  loss: 1.2531 -> 1.4139   acc: 63.41% -> 60.98%             
client [37] (test)  loss: 0.8556 -> 1.0104   acc: 70.53% -> 64.21%             
client [58] (test)  loss: 0.8604 -> 0.8969   acc: 71.51% -> 70.95%             
client [64] (test)  loss: 0.6707 -> 0.6618   acc: 62.96% -> 70.37%             
client [77] (test)  loss: 0.6954 -> 1.1046   acc: 77.53% -> 62.56%             
client [55] (test)  loss: 1.2957 -> 1.0036   acc: 50.79% -> 69.84%             
client [12] (test)  loss: 0.7491 -> 0.7831   acc: 73.02% -> 71.43%             
client [89] (test)  loss: 0.5605 -> 0.6427   acc: 83.64% -> 81.82%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.1123 -> 1.5813   acc: 59.32% -> 53.67%             
client [51] (test)  loss: 0.0000 -> 0.0001   acc: 100.00% -> 100.00%           
client [8] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%            
client [18] (test)  loss: 0.8581 -> 1.3114   acc: 62.50% -> 44.57%             
client [94] (test)  loss: 0.7666 -> 0.9241   acc: 71.15% -> 59.62%             
client [81] (test)  loss: 1.1508 -> 1.7469   acc: 58.48% -> 39.29%             
client [3] (test)  loss: 0.3251 -> 0.2760   acc: 90.00% -> 90.97%              
client [11] (test)  loss: 0.9600 -> 0.8127   acc: 63.04% -> 68.86%             
client [95] (test)  loss: 0.9100 -> 0.5089   acc: 67.46% -> 79.32%             
client [67] (test)  loss: 1.4668 -> 1.4287   acc: 60.98% -> 60.98%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.5963 -> 0.4962   acc: 78.97% -> 85.05%             
client [79] (test)  loss: 0.8500 -> 0.9306   acc: 65.50% -> 61.99%             
client [58] (test)  loss: 0.8378 -> 0.8944   acc: 73.18% -> 70.95%             
client [88] (test)  loss: 0.7247 -> 0.7928   acc: 79.71% -> 81.16%             
client [46] (test)  loss: 0.2691 -> 0.4649   acc: 89.57% -> 79.15%             
client [11] (test)  loss: 0.8379 -> 0.8204   acc: 70.89% -> 68.86%             
client [55] (test)  loss: 1.1057 -> 1.0263   acc: 61.90% -> 68.25%             
client [13] (test)  loss: 0.9178 -> 1.0169   acc: 61.27% -> 55.20%             
client [31] (test)  loss: 0.8445 -> 1.1239   acc: 57.39% -> 57.39%             
client [75] (test)  loss: 0.2518 -> 0.2674   acc: 91.82% -> 91.05%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5884 -> 0.6113   acc: 84.62% -> 82.91%             
client [7] (test)  loss: 0.5759 -> 0.8175   acc: 72.22% -> 56.94%              
client [57] (test)  loss: 0.5173 -> 0.8320   acc: 74.95% -> 49.89%             
client [13] (test)  loss: 0.8764 -> 0.9661   acc: 61.27% -> 56.94%             
client [43] (test)  loss: 0.7987 -> 1.0309   acc: 69.83% -> 57.02%             
client [91] (test)  loss: 0.5109 -> 1.0023   acc: 80.00% -> 66.67%             
client [10] (test)  loss: 0.5044 -> 0.9527   acc: 78.81% -> 72.06%             
client [64] (test)  loss: 0.6437 -> 0.6519   acc: 77.78% -> 74.07%             
client [82] (test)  loss: 1.0514 -> 1.3417   acc: 59.55% -> 53.93%             
client [22] (test)  loss: 0.3059 -> 0.5293   acc: 91.73% -> 79.70%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.1943 -> 0.2325   acc: 94.87% -> 93.85%             
client [23] (test)  loss: 1.6213 -> 2.1971   acc: 51.43% -> 31.43%             
client [88] (test)  loss: 0.7386 -> 0.8099   acc: 78.26% -> 81.16%             
client [98] (test)  loss: 0.7654 -> 0.7405   acc: 68.66% -> 68.66%             
client [79] (test)  loss: 0.8753 -> 0.9534   acc: 64.91% -> 64.33%             
client [21] (test)  loss: 0.5670 -> 0.4722   acc: 78.97% -> 85.05%             
client [92] (test)  loss: 0.0510 -> 0.0510   acc: 99.22% -> 99.22%             
client [56] (test)  loss: 0.3950 -> 0.3778   acc: 94.32% -> 94.32%             
client [5] (test)  loss: 0.4028 -> 1.4644   acc: 83.87% -> 50.54%              
client [52] (test)  loss: 0.4310 -> 0.5957   acc: 85.91% -> 78.64%             
==================== FedRep TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.4816 -> 0.0000', 'accuracy': '83.31% -> 0.00%'},          
    200: {'loss': '0.4088 -> 0.0000', 'accuracy': '85.91% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep achieved 10.0%(17.79%) at epoch: 0                                      
FedRep achieved 20.0%(27.68%) at epoch: 2                                      
FedRep achieved 30.0%(37.37%) at epoch: 3                                      
FedRep achieved 50.0%(51.29%) at epoch: 4                                      
FedRep achieved 60.0%(61.50%) at epoch: 7                                      
FedRep achieved 70.0%(75.60%) at epoch: 13                                     
FedRep achieved 80.0%(80.73%) at epoch: 17                                     
FedRep achieved 90.0%(90.02%) at epoch: 39                                     
Convergence (test_after):                                                      
FedRep achieved 70.0%(74.10%) at epoch: 0                                      
FedRep achieved 80.0%(83.91%) at epoch: 4                                      
FedRep achieved 90.0%(92.24%) at epoch: 11                                     
