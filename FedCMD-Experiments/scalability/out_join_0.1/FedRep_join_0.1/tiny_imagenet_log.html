==================== ALGORITHM: FedRep_join_0.1 ====================           
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'train_body_epoch': 1,                                                     
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 3.5650 -> 3.4254   acc: 7.39% -> 7.39%               
client [81] (test)  loss: 3.5182 -> 3.4091   acc: 9.61% -> 21.53%              
client [21] (test)  loss: 5.3386 -> 3.6186   acc: 0.20% -> 17.40%              
client [68] (test)  loss: 3.7773 -> 3.5548   acc: 7.80% -> 13.50%              
client [93] (test)  loss: 3.9445 -> 3.6765   acc: 12.32% -> 12.32%             
client [31] (test)  loss: 4.6273 -> 3.1238   acc: 21.78% -> 21.78%             
client [20] (test)  loss: 4.2632 -> 3.6869   acc: 3.29% -> 3.29%               
client [59] (test)  loss: 5.3423 -> 3.6034   acc: 0.00% -> 8.45%               
client [48] (test)  loss: 3.4757 -> 3.1608   acc: 27.13% -> 27.57%             
client [34] (test)  loss: 3.7919 -> 3.6974   acc: 12.76% -> 14.39%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.4953 -> 3.9694   acc: 4.26% -> 4.79%               
client [99] (test)  loss: 4.3298 -> 4.2017   acc: 6.13% -> 7.77%               
client [67] (test)  loss: 3.4901 -> 3.3920   acc: 11.64% -> 13.23%             
client [0] (test)  loss: 3.6334 -> 3.5196   acc: 10.57% -> 11.47%              
client [76] (test)  loss: 3.6242 -> 3.4501   acc: 8.91% -> 12.91%              
client [41] (test)  loss: 3.3877 -> 3.1306   acc: 21.00% -> 26.51%             
client [62] (test)  loss: 5.2657 -> 3.7267   acc: 0.00% -> 8.55%               
client [2] (test)  loss: 5.2476 -> 3.2812   acc: 0.00% -> 11.30%               
client [14] (test)  loss: 3.1153 -> 2.9771   acc: 14.59% -> 17.08%             
client [46] (test)  loss: 3.8336 -> 3.6999   acc: 6.31% -> 6.67%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 3.4450 -> 3.3284   acc: 13.70% -> 24.38%             
client [68] (test)  loss: 3.6178 -> 3.4012   acc: 12.68% -> 17.07%             
client [57] (test)  loss: 3.8339 -> 3.7406   acc: 13.64% -> 12.00%             
client [17] (test)  loss: 3.3791 -> 3.0262   acc: 15.64% -> 20.70%             
client [54] (test)  loss: 3.3612 -> 3.2171   acc: 20.52% -> 26.23%             
client [23] (test)  loss: 5.3777 -> 3.0168   acc: 0.00% -> 20.71%              
client [35] (test)  loss: 3.2567 -> 3.1155   acc: 16.87% -> 22.49%             
client [59] (test)  loss: 3.4659 -> 3.3212   acc: 11.80% -> 17.78%             
client [31] (test)  loss: 3.1208 -> 2.8293   acc: 26.13% -> 33.45%             
client [9] (test)  loss: 5.9197 -> 4.1397   acc: 7.09% -> 8.36%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.9463 -> 2.8190   acc: 25.08% -> 28.05%             
client [33] (test)  loss: 3.4264 -> 3.3746   acc: 17.50% -> 20.91%             
client [16] (test)  loss: 3.7711 -> 3.3814   acc: 6.92% -> 14.03%              
client [44] (test)  loss: 4.9463 -> 3.2928   acc: 6.92% -> 18.84%              
client [8] (test)  loss: 3.1389 -> 3.1757   acc: 24.17% -> 20.35%              
client [31] (test)  loss: 3.0273 -> 2.7798   acc: 28.75% -> 35.89%             
client [47] (test)  loss: 3.0826 -> 2.5029   acc: 32.91% -> 38.34%             
client [36] (test)  loss: 2.7947 -> 2.5683   acc: 32.25% -> 33.51%             
client [20] (test)  loss: 4.5522 -> 3.4449   acc: 8.65% -> 12.80%              
client [56] (test)  loss: 3.5978 -> 3.4951   acc: 11.57% -> 15.30%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.1002 -> 3.4843   acc: 18.63% -> 19.17%              
client [60] (test)  loss: 3.3185 -> 2.9595   acc: 21.09% -> 27.09%             
client [28] (test)  loss: 3.5188 -> 3.1892   acc: 16.64% -> 25.50%             
client [25] (test)  loss: 3.9531 -> 3.4041   acc: 14.96% -> 18.26%             
client [58] (test)  loss: 3.4596 -> 3.4414   acc: 18.55% -> 19.08%             
client [44] (test)  loss: 3.3652 -> 3.1926   acc: 16.10% -> 21.74%             
client [39] (test)  loss: 3.6785 -> 3.5275   acc: 14.52% -> 21.12%             
client [29] (test)  loss: 3.3889 -> 2.9077   acc: 15.14% -> 19.56%             
client [3] (test)  loss: 3.5781 -> 3.2131   acc: 8.99% -> 16.34%               
client [84] (test)  loss: 3.4361 -> 3.2938   acc: 18.79% -> 20.39%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.0673 -> 3.2379   acc: 18.60% -> 26.80%             
client [84] (test)  loss: 3.3772 -> 3.2604   acc: 20.21% -> 22.34%             
client [10] (test)  loss: 3.1948 -> 3.0392   acc: 19.22% -> 22.76%             
client [36] (test)  loss: 2.5412 -> 2.5696   acc: 34.60% -> 35.51%             
client [65] (test)  loss: 3.4205 -> 3.4525   acc: 16.67% -> 16.13%             
client [81] (test)  loss: 3.5629 -> 3.1671   acc: 13.70% -> 20.11%             
client [79] (test)  loss: 3.5692 -> 3.4993   acc: 14.32% -> 17.74%             
client [42] (test)  loss: 3.3356 -> 3.2006   acc: 19.68% -> 23.26%             
client [11] (test)  loss: 5.7036 -> 3.8378   acc: 3.98% -> 6.23%               
client [96] (test)  loss: 3.0472 -> 2.7208   acc: 17.99% -> 25.00%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.0869 -> 3.1095   acc: 25.91% -> 24.64%              
client [53] (test)  loss: 3.5811 -> 3.5092   acc: 17.83% -> 20.54%             
client [52] (test)  loss: 3.4256 -> 3.5046   acc: 20.74% -> 18.97%             
client [42] (test)  loss: 3.2767 -> 3.1846   acc: 22.18% -> 23.43%             
client [69] (test)  loss: 3.7600 -> 3.8072   acc: 12.77% -> 13.83%             
client [59] (test)  loss: 3.3244 -> 3.1726   acc: 19.37% -> 22.01%             
client [7] (test)  loss: 4.1083 -> 3.4171   acc: 16.70% -> 24.06%              
client [26] (test)  loss: 3.2885 -> 3.2809   acc: 20.07% -> 19.73%             
client [49] (test)  loss: 3.2723 -> 3.2318   acc: 21.85% -> 20.80%             
client [98] (test)  loss: 2.9037 -> 2.7419   acc: 26.09% -> 32.14%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.0659 -> 2.7517   acc: 25.52% -> 32.33%             
client [47] (test)  loss: 2.6629 -> 2.3470   acc: 40.14% -> 42.31%             
client [21] (test)  loss: 3.2045 -> 3.1964   acc: 28.80% -> 28.40%             
client [77] (test)  loss: 3.6118 -> 3.1092   acc: 13.06% -> 15.12%             
client [95] (test)  loss: 3.0101 -> 2.9706   acc: 35.58% -> 34.74%             
client [91] (test)  loss: 2.9615 -> 2.7828   acc: 21.66% -> 25.38%             
client [14] (test)  loss: 2.7064 -> 2.7243   acc: 28.65% -> 28.83%             
client [99] (test)  loss: 4.2542 -> 4.2363   acc: 14.11% -> 17.18%             
client [20] (test)  loss: 3.9085 -> 3.2591   acc: 12.28% -> 19.72%             
client [39] (test)  loss: 3.6966 -> 3.5273   acc: 18.81% -> 21.78%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.4387 -> 3.4968   acc: 21.45% -> 20.39%             
client [62] (test)  loss: 3.7314 -> 3.4775   acc: 10.26% -> 16.75%             
client [71] (test)  loss: 3.5763 -> 3.5328   acc: 17.39% -> 19.81%             
client [97] (test)  loss: 3.3323 -> 3.2005   acc: 17.75% -> 19.66%             
client [30] (test)  loss: 3.2804 -> 3.3229   acc: 21.58% -> 21.58%             
client [88] (test)  loss: 3.4067 -> 3.3246   acc: 21.33% -> 23.04%             
client [60] (test)  loss: 3.0340 -> 2.8807   acc: 24.91% -> 29.45%             
client [82] (test)  loss: 3.4559 -> 3.2683   acc: 19.81% -> 27.27%             
client [91] (test)  loss: 2.8776 -> 2.7463   acc: 24.53% -> 26.73%             
client [57] (test)  loss: 3.5448 -> 3.4266   acc: 18.73% -> 20.18%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.9957 -> 2.7140   acc: 36.41% -> 38.85%             
client [15] (test)  loss: 3.2185 -> 3.1168   acc: 26.92% -> 28.32%             
client [71] (test)  loss: 3.5721 -> 3.5343   acc: 16.18% -> 19.81%             
client [97] (test)  loss: 3.2857 -> 3.2043   acc: 18.89% -> 20.80%             
client [53] (test)  loss: 3.3903 -> 3.3320   acc: 25.58% -> 27.13%             
client [77] (test)  loss: 3.4891 -> 3.1287   acc: 14.43% -> 14.95%             
client [76] (test)  loss: 3.2504 -> 3.3348   acc: 21.64% -> 21.27%             
client [79] (test)  loss: 3.6724 -> 3.4741   acc: 14.53% -> 16.88%             
client [28] (test)  loss: 3.2772 -> 3.1453   acc: 26.94% -> 25.32%             
client [99] (test)  loss: 4.3865 -> 4.3241   acc: 16.56% -> 19.43%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.2295 -> 3.1945   acc: 20.23% -> 22.14%             
client [86] (test)  loss: 2.8950 -> 2.8546   acc: 30.37% -> 30.21%             
client [34] (test)  loss: 3.4649 -> 3.3979   acc: 20.42% -> 22.74%             
client [73] (test)  loss: 2.8195 -> 2.8416   acc: 32.59% -> 32.75%             
client [5] (test)  loss: 3.0572 -> 2.9968   acc: 23.78% -> 25.77%              
client [96] (test)  loss: 2.7865 -> 2.6296   acc: 23.92% -> 28.06%             
client [22] (test)  loss: 3.1423 -> 3.2330   acc: 28.01% -> 27.42%             
client [60] (test)  loss: 3.0296 -> 2.9398   acc: 26.36% -> 29.45%             
client [66] (test)  loss: 3.2404 -> 3.1805   acc: 21.93% -> 22.28%             
client [83] (test)  loss: 3.7729 -> 3.7415   acc: 18.60% -> 16.13%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.3110 -> 3.3227   acc: 22.55% -> 22.91%             
client [65] (test)  loss: 3.3563 -> 3.4077   acc: 16.85% -> 18.28%             
client [95] (test)  loss: 3.1063 -> 2.9786   acc: 37.47% -> 37.05%             
client [17] (test)  loss: 3.2009 -> 2.8338   acc: 24.01% -> 25.91%             
client [8] (test)  loss: 3.0973 -> 2.9860   acc: 27.50% -> 29.41%              
client [35] (test)  loss: 3.0696 -> 3.0042   acc: 22.89% -> 23.29%             
client [98] (test)  loss: 2.8220 -> 2.8139   acc: 30.62% -> 31.76%             
client [53] (test)  loss: 3.1759 -> 3.2550   acc: 30.04% -> 30.62%             
client [43] (test)  loss: 3.1569 -> 3.1066   acc: 24.12% -> 23.48%             
client [64] (test)  loss: 2.9068 -> 2.7942   acc: 30.69% -> 30.53%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.2620 -> 3.1666   acc: 27.40% -> 27.40%             
client [88] (test)  loss: 3.4440 -> 3.4820   acc: 21.67% -> 23.55%             
client [38] (test)  loss: 3.4198 -> 3.4024   acc: 17.77% -> 19.86%             
client [3] (test)  loss: 3.1001 -> 3.0083   acc: 24.18% -> 24.67%              
client [5] (test)  loss: 3.0135 -> 3.0193   acc: 23.06% -> 25.05%              
client [41] (test)  loss: 2.9248 -> 2.8734   acc: 24.91% -> 28.29%             
client [7] (test)  loss: 3.5960 -> 3.4042   acc: 18.49% -> 24.60%              
client [37] (test)  loss: 3.2359 -> 3.3113   acc: 21.43% -> 22.40%             
client [45] (test)  loss: 3.4838 -> 3.2828   acc: 23.94% -> 25.76%             
client [47] (test)  loss: 2.5950 -> 2.2942   acc: 42.31% -> 43.40%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.4236 -> 3.3041   acc: 19.85% -> 24.04%             
client [11] (test)  loss: 3.8458 -> 3.5234   acc: 13.32% -> 15.22%             
client [37] (test)  loss: 3.1761 -> 3.4097   acc: 24.84% -> 22.08%             
client [41] (test)  loss: 2.9141 -> 2.8898   acc: 27.58% -> 28.29%             
client [95] (test)  loss: 2.9878 -> 3.0094   acc: 37.47% -> 38.11%             
client [53] (test)  loss: 3.3543 -> 3.2617   acc: 28.29% -> 31.01%             
client [22] (test)  loss: 3.1654 -> 3.2606   acc: 27.22% -> 27.02%             
client [25] (test)  loss: 3.3453 -> 3.3285   acc: 24.87% -> 23.83%             
client [69] (test)  loss: 3.8406 -> 3.8612   acc: 18.35% -> 17.82%             
client [46] (test)  loss: 3.3961 -> 3.3405   acc: 16.76% -> 18.02%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.4281 -> 2.3218   acc: 42.31% -> 43.22%             
client [69] (test)  loss: 3.8690 -> 3.8929   acc: 17.82% -> 18.09%             
client [82] (test)  loss: 3.3995 -> 3.2694   acc: 23.54% -> 30.03%             
client [45] (test)  loss: 3.3574 -> 3.3228   acc: 25.96% -> 26.37%             
client [7] (test)  loss: 3.6264 -> 3.4440   acc: 19.75% -> 23.70%              
client [50] (test)  loss: 3.3235 -> 3.6420   acc: 22.80% -> 21.07%             
client [35] (test)  loss: 3.0922 -> 3.0672   acc: 21.69% -> 23.69%             
client [24] (test)  loss: 3.5585 -> 3.4563   acc: 21.10% -> 21.92%             
client [15] (test)  loss: 3.2883 -> 3.2073   acc: 26.75% -> 29.37%             
client [58] (test)  loss: 3.4108 -> 3.4865   acc: 21.55% -> 22.61%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 3.1945 -> 2.9956   acc: 35.23% -> 37.64%             
client [76] (test)  loss: 3.4026 -> 3.3030   acc: 24.91% -> 23.45%             
client [67] (test)  loss: 3.1331 -> 3.1108   acc: 25.40% -> 24.34%             
client [37] (test)  loss: 3.3655 -> 3.5360   acc: 23.86% -> 21.27%             
client [58] (test)  loss: 3.5059 -> 3.5242   acc: 22.44% -> 21.91%             
client [64] (test)  loss: 3.0216 -> 2.8805   acc: 29.54% -> 30.69%             
client [77] (test)  loss: 3.2401 -> 3.2121   acc: 20.27% -> 19.76%             
client [55] (test)  loss: 4.1580 -> 3.5218   acc: 16.61% -> 21.35%             
client [12] (test)  loss: 3.2059 -> 2.9766   acc: 29.51% -> 32.57%             
client [89] (test)  loss: 3.7374 -> 3.3941   acc: 22.24% -> 26.04%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.2420 -> 3.3928   acc: 28.72% -> 25.71%             
client [51] (test)  loss: 2.8267 -> 2.7091   acc: 30.00% -> 33.82%             
client [8] (test)  loss: 3.1091 -> 3.1322   acc: 30.68% -> 30.52%              
client [18] (test)  loss: 3.5634 -> 3.5815   acc: 21.11% -> 22.90%             
client [94] (test)  loss: 3.5192 -> 3.2486   acc: 24.95% -> 26.23%             
client [81] (test)  loss: 3.4727 -> 3.2302   acc: 19.04% -> 22.42%             
client [3] (test)  loss: 3.1611 -> 3.0585   acc: 23.69% -> 24.02%              
client [11] (test)  loss: 3.7792 -> 3.5514   acc: 17.30% -> 16.26%             
client [95] (test)  loss: 3.2071 -> 3.1907   acc: 37.68% -> 37.26%             
client [67] (test)  loss: 3.2021 -> 3.1068   acc: 24.69% -> 24.87%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.3816 -> 3.2445   acc: 27.20% -> 28.00%             
client [79] (test)  loss: 3.8484 -> 3.7300   acc: 14.32% -> 18.16%             
client [58] (test)  loss: 3.5205 -> 3.5775   acc: 23.67% -> 21.91%             
client [88] (test)  loss: 3.6257 -> 3.5629   acc: 23.04% -> 24.91%             
client [46] (test)  loss: 3.5526 -> 3.4804   acc: 19.10% -> 19.46%             
client [11] (test)  loss: 3.6380 -> 3.5595   acc: 18.69% -> 16.44%             
client [55] (test)  loss: 3.6575 -> 3.5768   acc: 20.99% -> 22.63%             
client [13] (test)  loss: 3.3518 -> 3.4177   acc: 28.33% -> 31.57%             
client [31] (test)  loss: 3.0090 -> 2.7316   acc: 38.68% -> 40.94%             
client [75] (test)  loss: 3.2037 -> 3.1678   acc: 28.87% -> 29.74%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.8366 -> 3.4570   acc: 19.42% -> 28.60%             
client [7] (test)  loss: 3.7151 -> 3.6198   acc: 20.47% -> 23.88%              
client [57] (test)  loss: 3.6915 -> 3.5742   acc: 22.91% -> 25.82%             
client [13] (test)  loss: 3.4380 -> 3.4987   acc: 28.33% -> 30.72%             
client [43] (test)  loss: 3.2891 -> 3.1413   acc: 25.24% -> 26.68%             
client [91] (test)  loss: 3.0404 -> 2.7674   acc: 29.78% -> 31.47%             
client [10] (test)  loss: 3.2690 -> 3.1897   acc: 23.88% -> 27.24%             
client [64] (test)  loss: 3.0269 -> 3.0051   acc: 30.69% -> 31.02%             
client [82] (test)  loss: 3.4284 -> 3.3376   acc: 29.55% -> 30.36%             
client [22] (test)  loss: 3.3065 -> 3.3913   acc: 27.61% -> 28.21%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 3.2785 -> 3.2325   acc: 24.57% -> 24.05%             
client [23] (test)  loss: 2.6723 -> 2.6541   acc: 34.34% -> 34.69%             
client [88] (test)  loss: 3.7061 -> 3.6244   acc: 23.21% -> 24.57%             
client [98] (test)  loss: 2.8761 -> 2.8856   acc: 34.97% -> 34.40%             
client [79] (test)  loss: 3.8449 -> 3.8214   acc: 16.45% -> 16.88%             
client [21] (test)  loss: 3.3717 -> 3.3057   acc: 24.20% -> 27.40%             
client [92] (test)  loss: 3.3416 -> 3.3638   acc: 25.78% -> 25.95%             
client [56] (test)  loss: 3.6321 -> 3.6902   acc: 19.75% -> 20.46%             
client [5] (test)  loss: 3.2439 -> 3.1766   acc: 24.86% -> 25.95%              
client [52] (test)  loss: 3.4041 -> 3.6866   acc: 27.30% -> 22.34%             
==================== FedRep_join_0.1 TEST RESULTS: ====================        
{                                                                              
    100: {'loss': '3.3028 -> 0.0000', 'accuracy': '22.95% -> 0.00%'},          
    200: {'loss': '3.3867 -> 0.0000', 'accuracy': '26.01% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedRep_join_0.1 achieved 10.0%(11.85%) at epoch: 7                             
FedRep_join_0.1 achieved 20.0%(21.12%) at epoch: 60                            
Convergence (test_after):                                                      
FedRep_join_0.1 achieved 10.0%(14.30%) at epoch: 0                             
FedRep_join_0.1 achieved 20.0%(20.75%) at epoch: 27                            
